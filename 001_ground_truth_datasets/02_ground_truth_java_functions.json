[
  {
    "id": 0,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 0,
    "human_patch": "https://github.com/alibaba/fastjson/commit/f5903fa56497c00ed0703ac875b511f9bd5f1d8e",
    "cve_id": "CVE-2017-18349",
    "cwe_id": "CWE-20",
    "filename": "src/main/java/com/alibaba/fastjson/serializer/ObjectArrayCodec.java",
    "is_vulnerable": 0,
    "class_name": "ObjectArrayCodec",
    "subclass_name": null,
    "function_name": "write(JSONSerializer serializer, Object object, Object fieldName, Type fieldType, int features) throws IOException",
    "function_body": "{\r\n        SerializeWriter out = serializer.out;\r\n\r\n        Object[] array = (Object[]) object;\r\n\r\n        if (object == null) {\r\n            out.writeNull(SerializerFeature.WriteNullListAsEmpty);\r\n            return;\r\n        }\r\n\r\n        int size = array.length;\r\n\r\n        int end = size - 1;\r\n\r\n        if (end == -1) {\r\n            out.append(\"[]\");\r\n            return;\r\n        }\r\n\r\n        SerialContext context = serializer.context;\r\n        serializer.setContext(context, object, fieldName, 0);\r\n\r\n        try {\r\n            Class<?> preClazz = null;\r\n            ObjectSerializer preWriter = null;\r\n            out.append('[');\r\n\r\n            if (out.isEnabled(SerializerFeature.PrettyFormat)) {\r\n                serializer.incrementIndent();\r\n                serializer.println();\r\n                for (int i = 0; i < size; ++i) {\r\n                    if (i != 0) {\r\n                        out.write(',');\r\n                        serializer.println();\r\n                    }\r\n                    serializer.write(array[i]);\r\n                }\r\n                serializer.decrementIdent();\r\n                serializer.println();\r\n                out.write(']');\r\n                return;\r\n            }\r\n\r\n            for (int i = 0; i < end; ++i) {\r\n                Object item = array[i];\r\n\r\n                if (item == null) {\r\n                    out.append(\"null,\");\r\n                } else {\r\n                    if (serializer.containsReference(item)) {\r\n                        serializer.writeReference(item);\r\n                    } else {\r\n                        Class<?> clazz = item.getClass();\r\n\r\n                        if (clazz == preClazz) {\r\n                            preWriter.write(serializer, item, null, null, 0);\r\n                        } else {\r\n                            preClazz = clazz;\r\n                            preWriter = serializer.getObjectWriter(clazz);\r\n\r\n                            preWriter.write(serializer, item, null, null, 0);\r\n                        }\r\n                    }\r\n                    out.append(',');\r\n                }\r\n            }\r\n\r\n            Object item = array[end];\r\n\r\n            if (item == null) {\r\n                out.append(\"null]\");\r\n            } else {\r\n                if (serializer.containsReference(item)) {\r\n                    serializer.writeReference(item);\r\n                } else {\r\n                    serializer.writeWithFieldName(item, end);\r\n                }\r\n                out.append(']');\r\n            }\r\n        } finally {\r\n            serializer.context = context;\r\n        }\r\n    }"
  },
  {
    "id": 0,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 1,
    "human_patch": "https://github.com/alibaba/fastjson/commit/f5903fa56497c00ed0703ac875b511f9bd5f1d8e",
    "cve_id": "CVE-2017-18349",
    "cwe_id": "CWE-20",
    "filename": "src/main/java/com/alibaba/fastjson/serializer/ObjectArrayCodec.java",
    "is_vulnerable": 1,
    "class_name": "ObjectArrayCodec",
    "subclass_name": null,
    "function_name": "deserialze(DefaultJSONParser parser, Type type, Object fieldName)",
    "function_body": "{\r\n        final JSONLexer lexer = parser.lexer;\r\n        if (lexer.token() == JSONToken.NULL) {\r\n            lexer.nextToken(JSONToken.COMMA);\r\n            return null;\r\n        }\r\n\r\n        if (lexer.token() == JSONToken.LITERAL_STRING) {\r\n            byte[] bytes = lexer.bytesValue();\r\n            lexer.nextToken(JSONToken.COMMA);\r\n            return (T) bytes;\r\n        }\r\n\r\n        Class componentClass;\r\n        Type componentType;\r\n        if (type instanceof GenericArrayType) {\r\n            GenericArrayType clazz = (GenericArrayType) type;\r\n            componentType = clazz.getGenericComponentType();\r\n            if (componentType instanceof TypeVariable) {\r\n                TypeVariable typeVar = (TypeVariable) componentType;\r\n                Type objType = parser.getContext().type;\r\n                if (objType instanceof ParameterizedType) {\r\n                    ParameterizedType objParamType = (ParameterizedType) objType;\r\n                    Type objRawType = objParamType.getRawType();\r\n                    Type actualType = null;\r\n                    if (objRawType instanceof Class) {\r\n                        TypeVariable[] objTypeParams = ((Class) objRawType).getTypeParameters();\r\n                        for (int i = 0; i < objTypeParams.length; ++i) {\r\n                            if (objTypeParams[i].getName().equals(typeVar.getName())) {\r\n                                actualType = objParamType.getActualTypeArguments()[i];\r\n                            }\r\n                        }\r\n                    }\r\n                    if (actualType instanceof Class) {\r\n                        componentClass = (Class) actualType;\r\n                    } else {\r\n                        componentClass = Object.class;\r\n                    }\r\n                } else {\r\n                    componentClass = TypeUtils.getClass(typeVar.getBounds()[0]);\r\n                }\r\n            } else {\r\n                componentClass = TypeUtils.getClass(componentType);\r\n            }\r\n        } else {\r\n            Class clazz = (Class) type;\r\n            componentType = componentClass = clazz.getComponentType();\r\n        }\r\n        JSONArray array = new JSONArray();\r\n        parser.parseArray(componentClass, array, fieldName);\r\n\r\n        return (T) toObjectArray(parser, componentClass, array);\r\n    }"
  },
  {
    "id": 0,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 2,
    "human_patch": "https://github.com/alibaba/fastjson/commit/f5903fa56497c00ed0703ac875b511f9bd5f1d8e",
    "cve_id": "CVE-2017-18349",
    "cwe_id": "CWE-20",
    "filename": "src/main/java/com/alibaba/fastjson/serializer/ObjectArrayCodec.java",
    "is_vulnerable": 0,
    "class_name": "ObjectArrayCodec",
    "subclass_name": null,
    "function_name": "toObjectArray(DefaultJSONParser parser, Class<?> componentType, JSONArray array)",
    "function_body": "{\r\n        if (array == null) {\r\n            return null;\r\n        }\r\n\r\n        int size = array.size();\r\n\r\n        Object objArray = Array.newInstance(componentType, size);\r\n        for (int i = 0; i < size; ++i) {\r\n            Object value = array.get(i);\r\n\r\n            if (value == array) {\r\n                Array.set(objArray, i, objArray);\r\n                continue;\r\n            }\r\n\r\n            if (componentType.isArray()) {\r\n                Object element;\r\n                if (componentType.isInstance(value)) {\r\n                    element = value;\r\n                } else {\r\n                    element = toObjectArray(parser, componentType, (JSONArray) value);\r\n                }\r\n\r\n                Array.set(objArray, i, element);\r\n            } else {\r\n                Object element = null;\r\n                if (value instanceof JSONArray) {\r\n                    boolean contains = false;\r\n                    JSONArray valueArray = (JSONArray) value;\r\n                    int valueArraySize = valueArray.size();\r\n                    for (int y = 0; y < valueArraySize; ++y) {\r\n                        Object valueItem = valueArray.get(y);\r\n                        if (valueItem == array) {\r\n                            valueArray.set(i, objArray);\r\n                            contains = true;\r\n                        }\r\n                    }\r\n                    if (contains) {\r\n                        element = valueArray.toArray();\r\n                    }\r\n                }\r\n\r\n                if (element == null) {\r\n                    element = TypeUtils.cast(value, componentType, parser.getConfig());\r\n                }\r\n                Array.set(objArray, i, element);\r\n\r\n            }\r\n        }\r\n\r\n        array.setRelatedArray(objArray);\r\n        array.setComponentType(componentType);\r\n        return (T) objArray; \n    }"
  },
  {
    "id": 0,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 3,
    "human_patch": "https://github.com/alibaba/fastjson/commit/f5903fa56497c00ed0703ac875b511f9bd5f1d8e",
    "cve_id": "CVE-2017-18349",
    "cwe_id": "CWE-20",
    "filename": "src/main/java/com/alibaba/fastjson/serializer/ObjectArrayCodec.java",
    "is_vulnerable": 0,
    "class_name": "ObjectArrayCodec",
    "subclass_name": null,
    "function_name": "getFastMatchToken()",
    "function_body": "{\r\n        return JSONToken.LBRACKET;\r\n    }"
  },
  {
    "id": 0,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 0,
    "human_patch": "https://github.com/alibaba/fastjson/commit/f5903fa56497c00ed0703ac875b511f9bd5f1d8e",
    "cve_id": "CVE-2017-18349",
    "cwe_id": "CWE-20",
    "filename": "src/test/java/com/alibaba/json/bvt/bug/Issue1005.java",
    "is_vulnerable": 1,
    "class_name": "Issue1005",
    "subclass_name": null,
    "function_name": "test_for_issue() throws Exception",
    "function_body": "{\n        Model model = JSON.parseObject(\"{\\\"values\\\":[1,2,3]}\", Model.class);\n        assertNotNull(model.values);\n        assertEquals(3, model.values.size());\n        assertEquals(Byte.class, model.values.get(0).getClass());\n        assertEquals(Byte.class, model.values.get(1).getClass());\n        assertEquals(Byte.class, model.values.get(2).getClass());\n    }"
  },
  {
    "id": 1,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 0,
    "human_patch": "https://github.com/apache/xmlgraphics-batik/commit/660ef628d637af636ea113243fe73f170ac43958",
    "cve_id": "CVE-2017-5662",
    "cwe_id": "CWE-611",
    "filename": "batik-dom/src/main/java/org/apache/batik/dom/util/SAXDocumentFactory.java",
    "is_vulnerable": 0,
    "class_name": "SAXDocumentFactory",
    "subclass_name": "PreInfo",
    "function_name": "createNode(Document doc)",
    "function_body": null
  },
  {
    "id": 1,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 1,
    "human_patch": "https://github.com/apache/xmlgraphics-batik/commit/660ef628d637af636ea113243fe73f170ac43958",
    "cve_id": "CVE-2017-5662",
    "cwe_id": "CWE-611",
    "filename": "batik-dom/src/main/java/org/apache/batik/dom/util/SAXDocumentFactory.java",
    "is_vulnerable": 0,
    "class_name": "SAXDocumentFactory",
    "subclass_name": "ProcessingInstructionInfo",
    "function_name": "createNode(Document doc)",
    "function_body": "{\n            return doc.createProcessingInstruction(target, data);\n        }"
  },
  {
    "id": 1,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 2,
    "human_patch": "https://github.com/apache/xmlgraphics-batik/commit/660ef628d637af636ea113243fe73f170ac43958",
    "cve_id": "CVE-2017-5662",
    "cwe_id": "CWE-611",
    "filename": "batik-dom/src/main/java/org/apache/batik/dom/util/SAXDocumentFactory.java",
    "is_vulnerable": 0,
    "class_name": "SAXDocumentFactory",
    "subclass_name": "CommentInfo",
    "function_name": "createNode(Document doc)",
    "function_body": "{\n            return doc.createComment(comment);\n        }"
  },
  {
    "id": 1,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 3,
    "human_patch": "https://github.com/apache/xmlgraphics-batik/commit/660ef628d637af636ea113243fe73f170ac43958",
    "cve_id": "CVE-2017-5662",
    "cwe_id": "CWE-611",
    "filename": "batik-dom/src/main/java/org/apache/batik/dom/util/SAXDocumentFactory.java",
    "is_vulnerable": 0,
    "class_name": "SAXDocumentFactory",
    "subclass_name": "CDataInfo",
    "function_name": "createNode(Document doc)",
    "function_body": "{\n            return doc.createCDATASection(cdata);\n        }"
  },
  {
    "id": 1,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 4,
    "human_patch": "https://github.com/apache/xmlgraphics-batik/commit/660ef628d637af636ea113243fe73f170ac43958",
    "cve_id": "CVE-2017-5662",
    "cwe_id": "CWE-611",
    "filename": "batik-dom/src/main/java/org/apache/batik/dom/util/SAXDocumentFactory.java",
    "is_vulnerable": 0,
    "class_name": "SAXDocumentFactory",
    "subclass_name": "TextInfo",
    "function_name": "createNode(Document doc)",
    "function_body": "{\n            return doc.createTextNode(text);\n        }"
  },
  {
    "id": 1,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 5,
    "human_patch": "https://github.com/apache/xmlgraphics-batik/commit/660ef628d637af636ea113243fe73f170ac43958",
    "cve_id": "CVE-2017-5662",
    "cwe_id": "CWE-611",
    "filename": "batik-dom/src/main/java/org/apache/batik/dom/util/SAXDocumentFactory.java",
    "is_vulnerable": 0,
    "class_name": "SAXDocumentFactory",
    "subclass_name": null,
    "function_name": "createDocument(String ns, String root, String uri) throws IOException",
    "function_body": "{\n        return createDocument(ns, root, uri, new InputSource(uri));\n    }"
  },
  {
    "id": 1,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 6,
    "human_patch": "https://github.com/apache/xmlgraphics-batik/commit/660ef628d637af636ea113243fe73f170ac43958",
    "cve_id": "CVE-2017-5662",
    "cwe_id": "CWE-611",
    "filename": "batik-dom/src/main/java/org/apache/batik/dom/util/SAXDocumentFactory.java",
    "is_vulnerable": 0,
    "class_name": "SAXDocumentFactory",
    "subclass_name": null,
    "function_name": "createDocument(String uri) throws IOException",
    "function_body": "{\n        return createDocument(new InputSource(uri));\n    }"
  },
  {
    "id": 1,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 7,
    "human_patch": "https://github.com/apache/xmlgraphics-batik/commit/660ef628d637af636ea113243fe73f170ac43958",
    "cve_id": "CVE-2017-5662",
    "cwe_id": "CWE-611",
    "filename": "batik-dom/src/main/java/org/apache/batik/dom/util/SAXDocumentFactory.java",
    "is_vulnerable": 0,
    "class_name": "SAXDocumentFactory",
    "subclass_name": null,
    "function_name": "createDocument(String ns, String root, String uri,\n                                   InputStream is) throws IOException",
    "function_body": "{\n        InputSource inp = new InputSource(is);\n        inp.setSystemId(uri);\n        return createDocument(ns, root, uri, inp);\n    }"
  },
  {
    "id": 1,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 8,
    "human_patch": "https://github.com/apache/xmlgraphics-batik/commit/660ef628d637af636ea113243fe73f170ac43958",
    "cve_id": "CVE-2017-5662",
    "cwe_id": "CWE-611",
    "filename": "batik-dom/src/main/java/org/apache/batik/dom/util/SAXDocumentFactory.java",
    "is_vulnerable": 0,
    "class_name": "SAXDocumentFactory",
    "subclass_name": null,
    "function_name": "createDocument(String uri, InputStream is) throws IOException",
    "function_body": "{\n        InputSource inp = new InputSource(is);\n        inp.setSystemId(uri);\n        return createDocument(inp);\n    }"
  },
  {
    "id": 1,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 9,
    "human_patch": "https://github.com/apache/xmlgraphics-batik/commit/660ef628d637af636ea113243fe73f170ac43958",
    "cve_id": "CVE-2017-5662",
    "cwe_id": "CWE-611",
    "filename": "batik-dom/src/main/java/org/apache/batik/dom/util/SAXDocumentFactory.java",
    "is_vulnerable": 0,
    "class_name": "SAXDocumentFactory",
    "subclass_name": null,
    "function_name": "createDocument(String ns, String root, String uri,\n                                   Reader r) throws IOException",
    "function_body": "{\n        InputSource inp = new InputSource(r);\n        inp.setSystemId(uri);\n        return createDocument(ns, root, uri, inp);\n    }"
  },
  {
    "id": 1,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 10,
    "human_patch": "https://github.com/apache/xmlgraphics-batik/commit/660ef628d637af636ea113243fe73f170ac43958",
    "cve_id": "CVE-2017-5662",
    "cwe_id": "CWE-611",
    "filename": "batik-dom/src/main/java/org/apache/batik/dom/util/SAXDocumentFactory.java",
    "is_vulnerable": 0,
    "class_name": "SAXDocumentFactory",
    "subclass_name": null,
    "function_name": "createDocument(String ns, String root, String uri,\n                                   XMLReader r) throws IOException",
    "function_body": "{\n        r.setContentHandler(this);\n        r.setDTDHandler(this);\n        r.setEntityResolver(this);\n        try {\n            r.parse(uri);\n        } catch (SAXException e) {\n            Exception ex = e.getException();\n            if (ex != null && ex instanceof InterruptedIOException) {\n                throw (InterruptedIOException) ex;\n            }\n            throw new SAXIOException(e);\n        }\n        currentNode = null;\n        Document ret = document;\n        document = null;\n        doctype = null;\n        return ret;\n    }"
  },
  {
    "id": 1,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 11,
    "human_patch": "https://github.com/apache/xmlgraphics-batik/commit/660ef628d637af636ea113243fe73f170ac43958",
    "cve_id": "CVE-2017-5662",
    "cwe_id": "CWE-611",
    "filename": "batik-dom/src/main/java/org/apache/batik/dom/util/SAXDocumentFactory.java",
    "is_vulnerable": 0,
    "class_name": "SAXDocumentFactory",
    "subclass_name": null,
    "function_name": "createDocument(String uri, Reader r) throws IOException",
    "function_body": "{\n        InputSource inp = new InputSource(r);\n        inp.setSystemId(uri);\n        return createDocument(inp);\n    }"
  },
  {
    "id": 1,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 12,
    "human_patch": "https://github.com/apache/xmlgraphics-batik/commit/660ef628d637af636ea113243fe73f170ac43958",
    "cve_id": "CVE-2017-5662",
    "cwe_id": "CWE-611",
    "filename": "batik-dom/src/main/java/org/apache/batik/dom/util/SAXDocumentFactory.java",
    "is_vulnerable": 0,
    "class_name": "SAXDocumentFactory",
    "subclass_name": null,
    "function_name": "createDocument(String ns, String root, String uri,\n                                      InputSource is) throws IOException",
    "function_body": "{\n        Document ret = createDocument(is);\n        Element docElem = ret.getDocumentElement();\n\n        String lname = root;\n        String nsURI = ns;\n        if (ns == null) {\n            int idx = lname.indexOf(':');\n            String nsp = (idx == -1 || idx == lname.length()-1)\n                ? \"\"\n                : lname.substring(0, idx);\n            nsURI = namespaces.get(nsp);\n            if (idx != -1 && idx != lname.length()-1) {\n                lname = lname.substring(idx+1);\n            }\n        }\n\n\n        String docElemNS = docElem.getNamespaceURI();\n        if ((docElemNS != nsURI) &&\n            ((docElemNS == null) || (!docElemNS.equals(nsURI))))\n            throw new IOException\n                (\"Root element namespace does not match that requested:\\n\" +\n                 \"Requested: \" + nsURI + \"\\n\" +\n                 \"Found: \" + docElemNS);\n\n        if (docElemNS != null) {\n            if (!docElem.getLocalName().equals(lname))\n                throw new IOException\n                    (\"Root element does not match that requested:\\n\" +\n                     \"Requested: \" + lname + \"\\n\" +\n                     \"Found: \" + docElem.getLocalName());\n        } else {\n            if (!docElem.getNodeName().equals(lname))\n                throw new IOException\n                    (\"Root element does not match that requested:\\n\" +\n                     \"Requested: \" + lname + \"\\n\" +\n                     \"Found: \" + docElem.getNodeName());\n        }\n\n        return ret;\n    }"
  },
  {
    "id": 1,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 13,
    "human_patch": "https://github.com/apache/xmlgraphics-batik/commit/660ef628d637af636ea113243fe73f170ac43958",
    "cve_id": "CVE-2017-5662",
    "cwe_id": "CWE-611",
    "filename": "batik-dom/src/main/java/org/apache/batik/dom/util/SAXDocumentFactory.java",
    "is_vulnerable": 1,
    "class_name": "SAXDocumentFactory",
    "subclass_name": null,
    "function_name": "createDocument(InputSource is) throws IOException",
    "function_body": "{\n        try {\n            if (parserClassName != null) {\n                parser = XMLReaderFactory.createXMLReader(parserClassName);\n            } else {\n                SAXParser saxParser;\n                try {\n                    saxParser = saxFactory.newSAXParser();\n                } catch (ParserConfigurationException pce) {\n                    throw new IOException(\"Could not create SAXParser: \"\n                            + pce.getMessage());\n                }\n                parser = saxParser.getXMLReader();\n            }\n\n            parser.setContentHandler(this);\n            parser.setDTDHandler(this);\n            parser.setEntityResolver(this);\n            parser.setErrorHandler((errorHandler == null) ?\n                                   this : errorHandler);\n\n            parser.setFeature(\"http://xml.org/sax/features/namespaces\",\n                              true);\n            parser.setFeature(\"http://xml.org/sax/features/namespace-prefixes\",\n                              true);\n            parser.setFeature(\"http://xml.org/sax/features/validation\",\n                              isValidating);\n            parser.setFeature(\"http://xml.org/sax/features/external-general-entities\", false);\n            parser.setFeature(\"http://xml.org/sax/features/external-parameter-entities\", false);\n            parser.setProperty(\"http://xml.org/sax/properties/lexical-handler\",\n                               this);\n            parser.parse(is);\n        } catch (SAXException e) {\n            Exception ex = e.getException();\n            if (ex != null && ex instanceof InterruptedIOException) {\n                throw (InterruptedIOException)ex;\n            }\n            throw new SAXIOException(e);\n        }\n\n        currentNode  = null;\n        Document ret = document;\n        document     = null;\n        doctype      = null;\n        locator      = null;\n        parser       = null;\n        return ret;\n    }"
  },
  {
    "id": 1,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 14,
    "human_patch": "https://github.com/apache/xmlgraphics-batik/commit/660ef628d637af636ea113243fe73f170ac43958",
    "cve_id": "CVE-2017-5662",
    "cwe_id": "CWE-611",
    "filename": "batik-dom/src/main/java/org/apache/batik/dom/util/SAXDocumentFactory.java",
    "is_vulnerable": 0,
    "class_name": "SAXDocumentFactory",
    "subclass_name": null,
    "function_name": "getDocumentDescriptor()",
    "function_body": "{\n        return documentDescriptor;\n    }"
  },
  {
    "id": 1,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 15,
    "human_patch": "https://github.com/apache/xmlgraphics-batik/commit/660ef628d637af636ea113243fe73f170ac43958",
    "cve_id": "CVE-2017-5662",
    "cwe_id": "CWE-611",
    "filename": "batik-dom/src/main/java/org/apache/batik/dom/util/SAXDocumentFactory.java",
    "is_vulnerable": 0,
    "class_name": "SAXDocumentFactory",
    "subclass_name": null,
    "function_name": "setDocumentLocator(Locator l)",
    "function_body": "{\n        locator = l;\n    }"
  },
  {
    "id": 1,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 16,
    "human_patch": "https://github.com/apache/xmlgraphics-batik/commit/660ef628d637af636ea113243fe73f170ac43958",
    "cve_id": "CVE-2017-5662",
    "cwe_id": "CWE-611",
    "filename": "batik-dom/src/main/java/org/apache/batik/dom/util/SAXDocumentFactory.java",
    "is_vulnerable": 0,
    "class_name": "SAXDocumentFactory",
    "subclass_name": null,
    "function_name": "setValidating(boolean isValidating)",
    "function_body": "{\n        this.isValidating = isValidating;\n    }"
  },
  {
    "id": 1,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 17,
    "human_patch": "https://github.com/apache/xmlgraphics-batik/commit/660ef628d637af636ea113243fe73f170ac43958",
    "cve_id": "CVE-2017-5662",
    "cwe_id": "CWE-611",
    "filename": "batik-dom/src/main/java/org/apache/batik/dom/util/SAXDocumentFactory.java",
    "is_vulnerable": 0,
    "class_name": "SAXDocumentFactory",
    "subclass_name": null,
    "function_name": "isValidating()",
    "function_body": "{\n        return isValidating;\n    }"
  },
  {
    "id": 1,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 18,
    "human_patch": "https://github.com/apache/xmlgraphics-batik/commit/660ef628d637af636ea113243fe73f170ac43958",
    "cve_id": "CVE-2017-5662",
    "cwe_id": "CWE-611",
    "filename": "batik-dom/src/main/java/org/apache/batik/dom/util/SAXDocumentFactory.java",
    "is_vulnerable": 0,
    "class_name": "SAXDocumentFactory",
    "subclass_name": null,
    "function_name": "setErrorHandler(ErrorHandler eh)",
    "function_body": "{\n        errorHandler = eh;\n    }"
  },
  {
    "id": 1,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 19,
    "human_patch": "https://github.com/apache/xmlgraphics-batik/commit/660ef628d637af636ea113243fe73f170ac43958",
    "cve_id": "CVE-2017-5662",
    "cwe_id": "CWE-611",
    "filename": "batik-dom/src/main/java/org/apache/batik/dom/util/SAXDocumentFactory.java",
    "is_vulnerable": 0,
    "class_name": "SAXDocumentFactory",
    "subclass_name": null,
    "function_name": "getDOMImplementation(String ver)",
    "function_body": "{\n        return implementation;\n    }"
  },
  {
    "id": 1,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 20,
    "human_patch": "https://github.com/apache/xmlgraphics-batik/commit/660ef628d637af636ea113243fe73f170ac43958",
    "cve_id": "CVE-2017-5662",
    "cwe_id": "CWE-611",
    "filename": "batik-dom/src/main/java/org/apache/batik/dom/util/SAXDocumentFactory.java",
    "is_vulnerable": 0,
    "class_name": "SAXDocumentFactory",
    "subclass_name": null,
    "function_name": "fatalError(SAXParseException ex) throws SAXException",
    "function_body": "{\n        throw ex;\n    }"
  },
  {
    "id": 1,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 21,
    "human_patch": "https://github.com/apache/xmlgraphics-batik/commit/660ef628d637af636ea113243fe73f170ac43958",
    "cve_id": "CVE-2017-5662",
    "cwe_id": "CWE-611",
    "filename": "batik-dom/src/main/java/org/apache/batik/dom/util/SAXDocumentFactory.java",
    "is_vulnerable": 0,
    "class_name": "SAXDocumentFactory",
    "subclass_name": null,
    "function_name": "error(SAXParseException ex) throws SAXException",
    "function_body": "{\n        throw ex;\n    }"
  },
  {
    "id": 1,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 22,
    "human_patch": "https://github.com/apache/xmlgraphics-batik/commit/660ef628d637af636ea113243fe73f170ac43958",
    "cve_id": "CVE-2017-5662",
    "cwe_id": "CWE-611",
    "filename": "batik-dom/src/main/java/org/apache/batik/dom/util/SAXDocumentFactory.java",
    "is_vulnerable": 0,
    "class_name": "SAXDocumentFactory",
    "subclass_name": null,
    "function_name": "warning(SAXParseException ex) throws SAXException",
    "function_body": "{\n    }"
  },
  {
    "id": 1,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 23,
    "human_patch": "https://github.com/apache/xmlgraphics-batik/commit/660ef628d637af636ea113243fe73f170ac43958",
    "cve_id": "CVE-2017-5662",
    "cwe_id": "CWE-611",
    "filename": "batik-dom/src/main/java/org/apache/batik/dom/util/SAXDocumentFactory.java",
    "is_vulnerable": 0,
    "class_name": "SAXDocumentFactory",
    "subclass_name": null,
    "function_name": "startDocument() throws SAXException",
    "function_body": "{\n        preInfo    = new LinkedList();\n        namespaces = new HashTableStack();\n        namespaces.put(\"xml\", XMLSupport.XML_NAMESPACE_URI);\n        namespaces.put(\"xmlns\", XMLSupport.XMLNS_NAMESPACE_URI);\n        namespaces.put(\"\", null);\n\n        inDTD        = false;\n        inCDATA      = false;\n        inProlog     = true;\n        currentNode  = null;\n        document     = null;\n        doctype      = null;\n        isStandalone = false;\n        xmlVersion   = XMLConstants.XML_VERSION_10;\n\n        stringBuffer.setLength(0);\n        stringContent = false;\n\n        if (createDocumentDescriptor) {\n            documentDescriptor = new DocumentDescriptor();\n        } else {\n            documentDescriptor = null;\n        }\n    }"
  },
  {
    "id": 1,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 24,
    "human_patch": "https://github.com/apache/xmlgraphics-batik/commit/660ef628d637af636ea113243fe73f170ac43958",
    "cve_id": "CVE-2017-5662",
    "cwe_id": "CWE-611",
    "filename": "batik-dom/src/main/java/org/apache/batik/dom/util/SAXDocumentFactory.java",
    "is_vulnerable": 0,
    "class_name": "SAXDocumentFactory",
    "subclass_name": null,
    "function_name": "startElement(String     uri,\n                             String     localName,\n                             String     rawName,\n                             Attributes attributes) throws SAXException",
    "function_body": "{\n        \n        if (HaltingThread.hasBeenHalted()) {\n            throw new SAXException(new InterruptedIOException());\n        }\n\n        if (inProlog) {\n            inProlog = false;\n            if (parser != null) {\n                try {\n                    isStandalone = parser.getFeature\n                        (\"http://xml.org/sax/features/is-standalone\");\n                } catch (SAXNotRecognizedException ex) {\n                }\n                try {\n                    xmlVersion = (String) parser.getProperty\n                        (\"http://xml.org/sax/properties/document-xml-version\");\n                } catch (SAXNotRecognizedException ex) {\n                }\n            }\n        }\n\n        \n        int len = attributes.getLength();\n        namespaces.push();\n        String version = null;\n        for (int i = 0; i < len; i++) {\n            String aname = attributes.getQName(i);\n            int slen = aname.length();\n            if (slen < 5)\n                continue;\n            if (aname.equals(\"version\")) {\n                version = attributes.getValue(i);\n                continue;\n            }\n            if (!aname.startsWith(\"xmlns\"))\n                continue;\n            if (slen == 5) {\n                String ns = attributes.getValue(i);\n                if (ns.length() == 0)\n                    ns = null;\n                namespaces.put(\"\", ns);\n            } else if (aname.charAt(5) == ':') {\n                String ns = attributes.getValue(i);\n                if (ns.length() == 0) {\n                    ns = null;\n                }\n                namespaces.put(aname.substring(6), ns);\n            }\n        }\n\n        \n        appendStringData();\n\n        \n        Element e;\n        int idx = rawName.indexOf(':');\n        String nsp = (idx == -1 || idx == rawName.length()-1)\n            ? \"\"\n            : rawName.substring(0, idx);\n        String nsURI = namespaces.get(nsp);\n        if (currentNode == null) {\n            implementation = getDOMImplementation(version);\n            document = implementation.createDocument(nsURI, rawName, doctype);\n            Iterator i = preInfo.iterator();\n            currentNode = e = document.getDocumentElement();\n            while (i.hasNext()) {\n                PreInfo pi = (PreInfo)i.next();\n                Node n = pi.createNode(document);\n                document.insertBefore(n, e);\n            }\n            preInfo = null;\n        } else {\n            e = document.createElementNS(nsURI, rawName);\n            currentNode.appendChild(e);\n            currentNode = e;\n        }\n\n        \n        if (createDocumentDescriptor && locator != null) {\n            documentDescriptor.setLocation(e,\n                                           locator.getLineNumber(),\n                                           locator.getColumnNumber());\n        }\n\n        \n        for (int i = 0; i < len; i++) {\n            String aname = attributes.getQName(i);\n            if (aname.equals(\"xmlns\")) {\n                e.setAttributeNS(XMLSupport.XMLNS_NAMESPACE_URI,\n                                 aname,\n                                 attributes.getValue(i));\n            } else {\n                idx = aname.indexOf(':');\n                nsURI = (idx == -1)\n                    ? null\n                    : namespaces.get(aname.substring(0, idx));\n                e.setAttributeNS(nsURI, aname, attributes.getValue(i));\n            }\n        }\n    }"
  },
  {
    "id": 1,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 25,
    "human_patch": "https://github.com/apache/xmlgraphics-batik/commit/660ef628d637af636ea113243fe73f170ac43958",
    "cve_id": "CVE-2017-5662",
    "cwe_id": "CWE-611",
    "filename": "batik-dom/src/main/java/org/apache/batik/dom/util/SAXDocumentFactory.java",
    "is_vulnerable": 0,
    "class_name": "SAXDocumentFactory",
    "subclass_name": null,
    "function_name": "endElement(String uri, String localName, String rawName) throws SAXException",
    "function_body": "{\n        appendStringData(); \n\n        if (currentNode != null)\n            currentNode = currentNode.getParentNode();\n        namespaces.pop();\n    }"
  },
  {
    "id": 1,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 26,
    "human_patch": "https://github.com/apache/xmlgraphics-batik/commit/660ef628d637af636ea113243fe73f170ac43958",
    "cve_id": "CVE-2017-5662",
    "cwe_id": "CWE-611",
    "filename": "batik-dom/src/main/java/org/apache/batik/dom/util/SAXDocumentFactory.java",
    "is_vulnerable": 0,
    "class_name": "SAXDocumentFactory",
    "subclass_name": null,
    "function_name": "appendStringData()",
    "function_body": "{\n        if (!stringContent) return;\n\n        String str = stringBuffer.toString();\n        stringBuffer.setLength(0); \n        stringContent = false;\n        if (currentNode == null) {\n            if (inCDATA) preInfo.add(new CDataInfo(str));\n            else         preInfo.add(new TextInfo(str));\n        } else {\n            Node n;\n            if (inCDATA) n = document.createCDATASection(str);\n            else         n = document.createTextNode(str);\n            currentNode.appendChild(n);\n        }\n    }"
  },
  {
    "id": 1,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 27,
    "human_patch": "https://github.com/apache/xmlgraphics-batik/commit/660ef628d637af636ea113243fe73f170ac43958",
    "cve_id": "CVE-2017-5662",
    "cwe_id": "CWE-611",
    "filename": "batik-dom/src/main/java/org/apache/batik/dom/util/SAXDocumentFactory.java",
    "is_vulnerable": 0,
    "class_name": "SAXDocumentFactory",
    "subclass_name": null,
    "function_name": "characters(char[] ch, int start, int length) throws SAXException",
    "function_body": "{\n        stringBuffer.append(ch, start, length);\n        stringContent = true;\n    }"
  },
  {
    "id": 1,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 28,
    "human_patch": "https://github.com/apache/xmlgraphics-batik/commit/660ef628d637af636ea113243fe73f170ac43958",
    "cve_id": "CVE-2017-5662",
    "cwe_id": "CWE-611",
    "filename": "batik-dom/src/main/java/org/apache/batik/dom/util/SAXDocumentFactory.java",
    "is_vulnerable": 0,
    "class_name": "SAXDocumentFactory",
    "subclass_name": null,
    "function_name": "ignorableWhitespace(char[] ch,\n                                    int start,\n                                    int length) throws SAXException",
    "function_body": "{\n        stringBuffer.append(ch, start, length);\n        stringContent = true;\n    }"
  },
  {
    "id": 1,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 29,
    "human_patch": "https://github.com/apache/xmlgraphics-batik/commit/660ef628d637af636ea113243fe73f170ac43958",
    "cve_id": "CVE-2017-5662",
    "cwe_id": "CWE-611",
    "filename": "batik-dom/src/main/java/org/apache/batik/dom/util/SAXDocumentFactory.java",
    "is_vulnerable": 0,
    "class_name": "SAXDocumentFactory",
    "subclass_name": null,
    "function_name": "processingInstruction(String target, String data) throws SAXException",
    "function_body": "{\n        if (inDTD)\n            return;\n\n        appendStringData(); \n\n        if (currentNode == null)\n            preInfo.add(new ProcessingInstructionInfo(target, data));\n        else\n            currentNode.appendChild\n                (document.createProcessingInstruction(target, data));\n    }"
  },
  {
    "id": 1,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 30,
    "human_patch": "https://github.com/apache/xmlgraphics-batik/commit/660ef628d637af636ea113243fe73f170ac43958",
    "cve_id": "CVE-2017-5662",
    "cwe_id": "CWE-611",
    "filename": "batik-dom/src/main/java/org/apache/batik/dom/util/SAXDocumentFactory.java",
    "is_vulnerable": 0,
    "class_name": "SAXDocumentFactory",
    "subclass_name": null,
    "function_name": "startDTD(String name, String publicId, String systemId) throws SAXException",
    "function_body": "{\n        appendStringData(); \n        doctype = implementation.createDocumentType(name, publicId, systemId);\n        inDTD = true;\n    }"
  },
  {
    "id": 1,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 31,
    "human_patch": "https://github.com/apache/xmlgraphics-batik/commit/660ef628d637af636ea113243fe73f170ac43958",
    "cve_id": "CVE-2017-5662",
    "cwe_id": "CWE-611",
    "filename": "batik-dom/src/main/java/org/apache/batik/dom/util/SAXDocumentFactory.java",
    "is_vulnerable": 0,
    "class_name": "SAXDocumentFactory",
    "subclass_name": null,
    "function_name": "endDTD() throws SAXException",
    "function_body": "{\n        inDTD = false;\n    }"
  },
  {
    "id": 1,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 32,
    "human_patch": "https://github.com/apache/xmlgraphics-batik/commit/660ef628d637af636ea113243fe73f170ac43958",
    "cve_id": "CVE-2017-5662",
    "cwe_id": "CWE-611",
    "filename": "batik-dom/src/main/java/org/apache/batik/dom/util/SAXDocumentFactory.java",
    "is_vulnerable": 0,
    "class_name": "SAXDocumentFactory",
    "subclass_name": null,
    "function_name": "startEntity(String name) throws SAXException",
    "function_body": "{\n    }"
  },
  {
    "id": 1,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 33,
    "human_patch": "https://github.com/apache/xmlgraphics-batik/commit/660ef628d637af636ea113243fe73f170ac43958",
    "cve_id": "CVE-2017-5662",
    "cwe_id": "CWE-611",
    "filename": "batik-dom/src/main/java/org/apache/batik/dom/util/SAXDocumentFactory.java",
    "is_vulnerable": 0,
    "class_name": "SAXDocumentFactory",
    "subclass_name": null,
    "function_name": "endEntity(String name) throws SAXException",
    "function_body": "{\n    }"
  },
  {
    "id": 1,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 34,
    "human_patch": "https://github.com/apache/xmlgraphics-batik/commit/660ef628d637af636ea113243fe73f170ac43958",
    "cve_id": "CVE-2017-5662",
    "cwe_id": "CWE-611",
    "filename": "batik-dom/src/main/java/org/apache/batik/dom/util/SAXDocumentFactory.java",
    "is_vulnerable": 0,
    "class_name": "SAXDocumentFactory",
    "subclass_name": null,
    "function_name": "startCDATA() throws SAXException",
    "function_body": "{\n        appendStringData(); \n        inCDATA       = true;\n        stringContent = true; \n    }"
  },
  {
    "id": 1,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 35,
    "human_patch": "https://github.com/apache/xmlgraphics-batik/commit/660ef628d637af636ea113243fe73f170ac43958",
    "cve_id": "CVE-2017-5662",
    "cwe_id": "CWE-611",
    "filename": "batik-dom/src/main/java/org/apache/batik/dom/util/SAXDocumentFactory.java",
    "is_vulnerable": 0,
    "class_name": "SAXDocumentFactory",
    "subclass_name": null,
    "function_name": "endCDATA() throws SAXException",
    "function_body": "{\n        appendStringData(); \n        inCDATA = false;\n    }"
  },
  {
    "id": 1,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 36,
    "human_patch": "https://github.com/apache/xmlgraphics-batik/commit/660ef628d637af636ea113243fe73f170ac43958",
    "cve_id": "CVE-2017-5662",
    "cwe_id": "CWE-611",
    "filename": "batik-dom/src/main/java/org/apache/batik/dom/util/SAXDocumentFactory.java",
    "is_vulnerable": 0,
    "class_name": "SAXDocumentFactory",
    "subclass_name": null,
    "function_name": "comment(char[] ch, int start, int length) throws SAXException",
    "function_body": "{\n        if (inDTD) return;\n        appendStringData();\n\n        String str = new String(ch, start, length);\n        if (currentNode == null) {\n            preInfo.add(new CommentInfo(str));\n        } else {\n            currentNode.appendChild(document.createComment(str));\n        }\n    }"
  },
  {
    "id": 2,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 0,
    "human_patch": "https://github.com/apache/camel/commit/7d19340bcdb42f7aae584d9c5003ac4f7ddaee36",
    "cve_id": "CVE-2015-0263",
    "cwe_id": "Not Mapping",
    "filename": "camel-core/src/main/java/org/apache/camel/converter/jaxp/XmlConverter.java",
    "is_vulnerable": 0,
    "class_name": "XmlConverter",
    "subclass_name": null,
    "function_name": "defaultOutputProperties()",
    "function_body": "{\n        Properties properties = new Properties();\n        properties.put(OutputKeys.ENCODING, defaultCharset);\n        properties.put(OutputKeys.OMIT_XML_DECLARATION, \"yes\");\n        return properties;\n    }"
  },
  {
    "id": 2,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 1,
    "human_patch": "https://github.com/apache/camel/commit/7d19340bcdb42f7aae584d9c5003ac4f7ddaee36",
    "cve_id": "CVE-2015-0263",
    "cwe_id": "Not Mapping",
    "filename": "camel-core/src/main/java/org/apache/camel/converter/jaxp/XmlConverter.java",
    "is_vulnerable": 0,
    "class_name": "XmlConverter",
    "subclass_name": null,
    "function_name": "toResult(Source source, Result result) throws TransformerException",
    "function_body": "{\n        toResult(source, result, defaultOutputProperties());\n    }"
  },
  {
    "id": 2,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 2,
    "human_patch": "https://github.com/apache/camel/commit/7d19340bcdb42f7aae584d9c5003ac4f7ddaee36",
    "cve_id": "CVE-2015-0263",
    "cwe_id": "Not Mapping",
    "filename": "camel-core/src/main/java/org/apache/camel/converter/jaxp/XmlConverter.java",
    "is_vulnerable": 0,
    "class_name": "XmlConverter",
    "subclass_name": null,
    "function_name": "toResult(Source source, Result result, Properties outputProperties) throws TransformerException",
    "function_body": "{\n        if (source == null) {\n            return;\n        }\n\n        Transformer transformer = createTransformer();\n        if (transformer == null) {\n            throw new TransformerException(\"Could not create a transformer - JAXP is misconfigured!\");\n        }\n        transformer.setOutputProperties(outputProperties);\n        transformer.transform(source, result);\n    }"
  },
  {
    "id": 2,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 3,
    "human_patch": "https://github.com/apache/camel/commit/7d19340bcdb42f7aae584d9c5003ac4f7ddaee36",
    "cve_id": "CVE-2015-0263",
    "cwe_id": "Not Mapping",
    "filename": "camel-core/src/main/java/org/apache/camel/converter/jaxp/XmlConverter.java",
    "is_vulnerable": 0,
    "class_name": "XmlConverter",
    "subclass_name": null,
    "function_name": "toBoolean(NodeList list)",
    "function_body": "{\n        return list.getLength() > 0;\n    }"
  },
  {
    "id": 2,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 4,
    "human_patch": "https://github.com/apache/camel/commit/7d19340bcdb42f7aae584d9c5003ac4f7ddaee36",
    "cve_id": "CVE-2015-0263",
    "cwe_id": "Not Mapping",
    "filename": "camel-core/src/main/java/org/apache/camel/converter/jaxp/XmlConverter.java",
    "is_vulnerable": 0,
    "class_name": "XmlConverter",
    "subclass_name": null,
    "function_name": "toBytesSource(byte[] data)",
    "function_body": "{\n        return new BytesSource(data);\n    }"
  },
  {
    "id": 2,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 5,
    "human_patch": "https://github.com/apache/camel/commit/7d19340bcdb42f7aae584d9c5003ac4f7ddaee36",
    "cve_id": "CVE-2015-0263",
    "cwe_id": "Not Mapping",
    "filename": "camel-core/src/main/java/org/apache/camel/converter/jaxp/XmlConverter.java",
    "is_vulnerable": 0,
    "class_name": "XmlConverter",
    "subclass_name": null,
    "function_name": "toStringSource(String data)",
    "function_body": "{\n        return new StringSource(data);\n    }"
  },
  {
    "id": 2,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 6,
    "human_patch": "https://github.com/apache/camel/commit/7d19340bcdb42f7aae584d9c5003ac4f7ddaee36",
    "cve_id": "CVE-2015-0263",
    "cwe_id": "Not Mapping",
    "filename": "camel-core/src/main/java/org/apache/camel/converter/jaxp/XmlConverter.java",
    "is_vulnerable": 0,
    "class_name": "XmlConverter",
    "subclass_name": null,
    "function_name": "toSource(Document document)",
    "function_body": "{\n        return new DOMSource(document);\n    }"
  },
  {
    "id": 2,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 7,
    "human_patch": "https://github.com/apache/camel/commit/7d19340bcdb42f7aae584d9c5003ac4f7ddaee36",
    "cve_id": "CVE-2015-0263",
    "cwe_id": "Not Mapping",
    "filename": "camel-core/src/main/java/org/apache/camel/converter/jaxp/XmlConverter.java",
    "is_vulnerable": 0,
    "class_name": "XmlConverter",
    "subclass_name": null,
    "function_name": "toSource(Node node) throws ParserConfigurationException, TransformerException",
    "function_body": "{\n        return toDOMSource(node);\n    }"
  },
  {
    "id": 2,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 8,
    "human_patch": "https://github.com/apache/camel/commit/7d19340bcdb42f7aae584d9c5003ac4f7ddaee36",
    "cve_id": "CVE-2015-0263",
    "cwe_id": "Not Mapping",
    "filename": "camel-core/src/main/java/org/apache/camel/converter/jaxp/XmlConverter.java",
    "is_vulnerable": 0,
    "class_name": "XmlConverter",
    "subclass_name": null,
    "function_name": "toDOMSource(Node node) throws ParserConfigurationException, TransformerException",
    "function_body": "{\n        Document document = toDOMDocument(node);\n        return new DOMSource(document);\n    }"
  },
  {
    "id": 2,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 9,
    "human_patch": "https://github.com/apache/camel/commit/7d19340bcdb42f7aae584d9c5003ac4f7ddaee36",
    "cve_id": "CVE-2015-0263",
    "cwe_id": "Not Mapping",
    "filename": "camel-core/src/main/java/org/apache/camel/converter/jaxp/XmlConverter.java",
    "is_vulnerable": 0,
    "class_name": "XmlConverter",
    "subclass_name": null,
    "function_name": "toDOMSource(Document document)",
    "function_body": "{\n        return new DOMSource(document);\n    }"
  },
  {
    "id": 2,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 10,
    "human_patch": "https://github.com/apache/camel/commit/7d19340bcdb42f7aae584d9c5003ac4f7ddaee36",
    "cve_id": "CVE-2015-0263",
    "cwe_id": "Not Mapping",
    "filename": "camel-core/src/main/java/org/apache/camel/converter/jaxp/XmlConverter.java",
    "is_vulnerable": 0,
    "class_name": "XmlConverter",
    "subclass_name": null,
    "function_name": "toSource(String data)",
    "function_body": "{\n        return new StringSource(data);\n    }"
  },
  {
    "id": 2,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 11,
    "human_patch": "https://github.com/apache/camel/commit/7d19340bcdb42f7aae584d9c5003ac4f7ddaee36",
    "cve_id": "CVE-2015-0263",
    "cwe_id": "Not Mapping",
    "filename": "camel-core/src/main/java/org/apache/camel/converter/jaxp/XmlConverter.java",
    "is_vulnerable": 0,
    "class_name": "XmlConverter",
    "subclass_name": null,
    "function_name": "toString(Source source) throws TransformerException",
    "function_body": "{\n        return toString(source, null);\n    }"
  },
  {
    "id": 2,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 12,
    "human_patch": "https://github.com/apache/camel/commit/7d19340bcdb42f7aae584d9c5003ac4f7ddaee36",
    "cve_id": "CVE-2015-0263",
    "cwe_id": "Not Mapping",
    "filename": "camel-core/src/main/java/org/apache/camel/converter/jaxp/XmlConverter.java",
    "is_vulnerable": 0,
    "class_name": "XmlConverter",
    "subclass_name": null,
    "function_name": "toString(Source source, Exchange exchange) throws TransformerException",
    "function_body": "{\n        if (source == null) {\n            return null;\n        } else if (source instanceof StringSource) {\n            return ((StringSource) source).getText();\n        } else if (source instanceof BytesSource) {\n            return new String(((BytesSource) source).getData());\n        } else {\n            StringWriter buffer = new StringWriter();\n            if (exchange != null) {\n                \n                Properties properties = ObjectHelper.getCamelPropertiesWithPrefix(OUTPUT_PROPERTIES_PREFIX, exchange.getContext());\n                if (properties.size() > 0) {\n                    toResult(source, new StreamResult(buffer), properties);\n                    return buffer.toString();\n                }\n            }\n            \n            toResult(source, new StreamResult(buffer));\n            return buffer.toString();\n        }\n    }"
  },
  {
    "id": 2,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 13,
    "human_patch": "https://github.com/apache/camel/commit/7d19340bcdb42f7aae584d9c5003ac4f7ddaee36",
    "cve_id": "CVE-2015-0263",
    "cwe_id": "Not Mapping",
    "filename": "camel-core/src/main/java/org/apache/camel/converter/jaxp/XmlConverter.java",
    "is_vulnerable": 0,
    "class_name": "XmlConverter",
    "subclass_name": null,
    "function_name": "toByteArray(Source source, Exchange exchange) throws TransformerException",
    "function_body": "{\n        if (source instanceof BytesSource) {\n            return ((BytesSource)source).getData();\n        } else {\n            ByteArrayOutputStream buffer = new ByteArrayOutputStream();\n            if (exchange != null) {\n                \n                Properties properties = ObjectHelper.getCamelPropertiesWithPrefix(OUTPUT_PROPERTIES_PREFIX,\n                                                                                  exchange.getContext());\n                if (properties.size() > 0) {\n                    toResult(source, new StreamResult(buffer), properties);\n                    return buffer.toByteArray();\n                }\n            }\n            \n            toResult(source, new StreamResult(buffer));\n            return buffer.toByteArray();\n        }\n    }"
  },
  {
    "id": 2,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 14,
    "human_patch": "https://github.com/apache/camel/commit/7d19340bcdb42f7aae584d9c5003ac4f7ddaee36",
    "cve_id": "CVE-2015-0263",
    "cwe_id": "Not Mapping",
    "filename": "camel-core/src/main/java/org/apache/camel/converter/jaxp/XmlConverter.java",
    "is_vulnerable": 0,
    "class_name": "XmlConverter",
    "subclass_name": null,
    "function_name": "toString(Node node) throws TransformerException",
    "function_body": "{\n        return toString(node, null);\n    }"
  },
  {
    "id": 2,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 15,
    "human_patch": "https://github.com/apache/camel/commit/7d19340bcdb42f7aae584d9c5003ac4f7ddaee36",
    "cve_id": "CVE-2015-0263",
    "cwe_id": "Not Mapping",
    "filename": "camel-core/src/main/java/org/apache/camel/converter/jaxp/XmlConverter.java",
    "is_vulnerable": 0,
    "class_name": "XmlConverter",
    "subclass_name": null,
    "function_name": "toString(Node node, Exchange exchange) throws TransformerException",
    "function_body": "{\n        return toString(new DOMSource(node), exchange);\n    }"
  },
  {
    "id": 2,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 16,
    "human_patch": "https://github.com/apache/camel/commit/7d19340bcdb42f7aae584d9c5003ac4f7ddaee36",
    "cve_id": "CVE-2015-0263",
    "cwe_id": "Not Mapping",
    "filename": "camel-core/src/main/java/org/apache/camel/converter/jaxp/XmlConverter.java",
    "is_vulnerable": 0,
    "class_name": "XmlConverter",
    "subclass_name": null,
    "function_name": "toDOMSource(Source source) throws ParserConfigurationException, IOException, SAXException, TransformerException",
    "function_body": "{\n        return toDOMSource(source, (Exchange)null);\n    }"
  },
  {
    "id": 2,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 17,
    "human_patch": "https://github.com/apache/camel/commit/7d19340bcdb42f7aae584d9c5003ac4f7ddaee36",
    "cve_id": "CVE-2015-0263",
    "cwe_id": "Not Mapping",
    "filename": "camel-core/src/main/java/org/apache/camel/converter/jaxp/XmlConverter.java",
    "is_vulnerable": 0,
    "class_name": "XmlConverter",
    "subclass_name": null,
    "function_name": "toDOMSource(Source source, Exchange exchange) throws ParserConfigurationException, IOException, SAXException, TransformerException",
    "function_body": "{\n        if (source instanceof DOMSource) {\n            return (DOMSource) source;\n        } else if (source instanceof SAXSource) {\n            return toDOMSourceFromSAX((SAXSource) source);\n        } else if (source instanceof StreamSource) {\n            return toDOMSourceFromStream((StreamSource) source, exchange);\n        } else if (source instanceof StAXSource) {\n            return toDOMSourceFromStAX((StAXSource)source);\n        } else {\n            return null;\n        }\n    }"
  },
  {
    "id": 2,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 18,
    "human_patch": "https://github.com/apache/camel/commit/7d19340bcdb42f7aae584d9c5003ac4f7ddaee36",
    "cve_id": "CVE-2015-0263",
    "cwe_id": "Not Mapping",
    "filename": "camel-core/src/main/java/org/apache/camel/converter/jaxp/XmlConverter.java",
    "is_vulnerable": 0,
    "class_name": "XmlConverter",
    "subclass_name": null,
    "function_name": "toDOMSource(String text) throws ParserConfigurationException, IOException, SAXException, TransformerException",
    "function_body": "{\n        Source source = toSource(text);\n        return toDOMSourceFromStream((StreamSource) source);\n    }"
  },
  {
    "id": 2,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 19,
    "human_patch": "https://github.com/apache/camel/commit/7d19340bcdb42f7aae584d9c5003ac4f7ddaee36",
    "cve_id": "CVE-2015-0263",
    "cwe_id": "Not Mapping",
    "filename": "camel-core/src/main/java/org/apache/camel/converter/jaxp/XmlConverter.java",
    "is_vulnerable": 0,
    "class_name": "XmlConverter",
    "subclass_name": null,
    "function_name": "toDOMSource(byte[] bytes) throws IOException, SAXException, ParserConfigurationException",
    "function_body": "{\n        InputStream is = new ByteArrayInputStream(bytes);\n        try {\n            return toDOMSource(is);\n        } finally {\n            IOHelper.close(is);\n        }\n    }"
  },
  {
    "id": 2,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 20,
    "human_patch": "https://github.com/apache/camel/commit/7d19340bcdb42f7aae584d9c5003ac4f7ddaee36",
    "cve_id": "CVE-2015-0263",
    "cwe_id": "Not Mapping",
    "filename": "camel-core/src/main/java/org/apache/camel/converter/jaxp/XmlConverter.java",
    "is_vulnerable": 0,
    "class_name": "XmlConverter",
    "subclass_name": null,
    "function_name": "toSAXSource(String source) throws IOException, SAXException, TransformerException",
    "function_body": "{\n        return toSAXSource(source, null);\n    }"
  },
  {
    "id": 2,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 21,
    "human_patch": "https://github.com/apache/camel/commit/7d19340bcdb42f7aae584d9c5003ac4f7ddaee36",
    "cve_id": "CVE-2015-0263",
    "cwe_id": "Not Mapping",
    "filename": "camel-core/src/main/java/org/apache/camel/converter/jaxp/XmlConverter.java",
    "is_vulnerable": 0,
    "class_name": "XmlConverter",
    "subclass_name": null,
    "function_name": "toSAXSource(String source, Exchange exchange) throws IOException, SAXException, TransformerException",
    "function_body": "{\n        return toSAXSource(toSource(source), exchange);\n    }"
  },
  {
    "id": 2,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 22,
    "human_patch": "https://github.com/apache/camel/commit/7d19340bcdb42f7aae584d9c5003ac4f7ddaee36",
    "cve_id": "CVE-2015-0263",
    "cwe_id": "Not Mapping",
    "filename": "camel-core/src/main/java/org/apache/camel/converter/jaxp/XmlConverter.java",
    "is_vulnerable": 0,
    "class_name": "XmlConverter",
    "subclass_name": null,
    "function_name": "toStAXSource(String source, Exchange exchange) throws XMLStreamException",
    "function_body": "{\n        XMLStreamReader r = new StaxConverter().createXMLStreamReader(new StringReader(source));\n        return new StAXSource(r);\n    }"
  },
  {
    "id": 2,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 23,
    "human_patch": "https://github.com/apache/camel/commit/7d19340bcdb42f7aae584d9c5003ac4f7ddaee36",
    "cve_id": "CVE-2015-0263",
    "cwe_id": "Not Mapping",
    "filename": "camel-core/src/main/java/org/apache/camel/converter/jaxp/XmlConverter.java",
    "is_vulnerable": 0,
    "class_name": "XmlConverter",
    "subclass_name": null,
    "function_name": "toStAXSource(byte[] in, Exchange exchange) throws XMLStreamException",
    "function_body": "{\n        XMLStreamReader r = new StaxConverter().createXMLStreamReader(new ByteArrayInputStream(in), exchange);\n        return new StAXSource(r);\n    }"
  },
  {
    "id": 2,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 24,
    "human_patch": "https://github.com/apache/camel/commit/7d19340bcdb42f7aae584d9c5003ac4f7ddaee36",
    "cve_id": "CVE-2015-0263",
    "cwe_id": "Not Mapping",
    "filename": "camel-core/src/main/java/org/apache/camel/converter/jaxp/XmlConverter.java",
    "is_vulnerable": 0,
    "class_name": "XmlConverter",
    "subclass_name": null,
    "function_name": "toSAXSource(InputStream source) throws IOException, SAXException, TransformerException",
    "function_body": "{\n        return toSAXSource(source, null);\n    }"
  },
  {
    "id": 2,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 25,
    "human_patch": "https://github.com/apache/camel/commit/7d19340bcdb42f7aae584d9c5003ac4f7ddaee36",
    "cve_id": "CVE-2015-0263",
    "cwe_id": "Not Mapping",
    "filename": "camel-core/src/main/java/org/apache/camel/converter/jaxp/XmlConverter.java",
    "is_vulnerable": 0,
    "class_name": "XmlConverter",
    "subclass_name": null,
    "function_name": "toSAXSource(InputStream source, Exchange exchange) throws IOException, SAXException, TransformerException",
    "function_body": "{\n        return toSAXSource(toStreamSource(source), exchange);\n    }"
  },
  {
    "id": 2,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 26,
    "human_patch": "https://github.com/apache/camel/commit/7d19340bcdb42f7aae584d9c5003ac4f7ddaee36",
    "cve_id": "CVE-2015-0263",
    "cwe_id": "Not Mapping",
    "filename": "camel-core/src/main/java/org/apache/camel/converter/jaxp/XmlConverter.java",
    "is_vulnerable": 0,
    "class_name": "XmlConverter",
    "subclass_name": null,
    "function_name": "toSAXSource(byte[] in, Exchange exchange) throws IOException, SAXException, TransformerException",
    "function_body": "{\n        return toSAXSource(toStreamSource(in, exchange), exchange);\n    }"
  },
  {
    "id": 2,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 27,
    "human_patch": "https://github.com/apache/camel/commit/7d19340bcdb42f7aae584d9c5003ac4f7ddaee36",
    "cve_id": "CVE-2015-0263",
    "cwe_id": "Not Mapping",
    "filename": "camel-core/src/main/java/org/apache/camel/converter/jaxp/XmlConverter.java",
    "is_vulnerable": 0,
    "class_name": "XmlConverter",
    "subclass_name": null,
    "function_name": "toStAXSource(InputStream source, Exchange exchange) throws XMLStreamException",
    "function_body": "{\n        XMLStreamReader r = new StaxConverter().createXMLStreamReader(source, exchange);\n        return new StAXSource(r);\n    }"
  },
  {
    "id": 2,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 28,
    "human_patch": "https://github.com/apache/camel/commit/7d19340bcdb42f7aae584d9c5003ac4f7ddaee36",
    "cve_id": "CVE-2015-0263",
    "cwe_id": "Not Mapping",
    "filename": "camel-core/src/main/java/org/apache/camel/converter/jaxp/XmlConverter.java",
    "is_vulnerable": 0,
    "class_name": "XmlConverter",
    "subclass_name": null,
    "function_name": "toSAXSource(File file, Exchange exchange) throws IOException, SAXException, TransformerException",
    "function_body": "{\n        InputStream is = IOHelper.buffered(new FileInputStream(file));\n        return toSAXSource(is, exchange);\n    }"
  },
  {
    "id": 2,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 29,
    "human_patch": "https://github.com/apache/camel/commit/7d19340bcdb42f7aae584d9c5003ac4f7ddaee36",
    "cve_id": "CVE-2015-0263",
    "cwe_id": "Not Mapping",
    "filename": "camel-core/src/main/java/org/apache/camel/converter/jaxp/XmlConverter.java",
    "is_vulnerable": 0,
    "class_name": "XmlConverter",
    "subclass_name": null,
    "function_name": "toStAXSource(File file, Exchange exchange) throws FileNotFoundException, XMLStreamException",
    "function_body": "{\n        InputStream is = IOHelper.buffered(new FileInputStream(file));\n        XMLStreamReader r = new StaxConverter().createXMLStreamReader(is, exchange);\n        return new StAXSource(r);\n    }"
  },
  {
    "id": 2,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 30,
    "human_patch": "https://github.com/apache/camel/commit/7d19340bcdb42f7aae584d9c5003ac4f7ddaee36",
    "cve_id": "CVE-2015-0263",
    "cwe_id": "Not Mapping",
    "filename": "camel-core/src/main/java/org/apache/camel/converter/jaxp/XmlConverter.java",
    "is_vulnerable": 0,
    "class_name": "XmlConverter",
    "subclass_name": null,
    "function_name": "toSAXSource(Source source) throws IOException, SAXException, TransformerException",
    "function_body": "{\n        return toSAXSource(source, null);\n    }"
  },
  {
    "id": 2,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 31,
    "human_patch": "https://github.com/apache/camel/commit/7d19340bcdb42f7aae584d9c5003ac4f7ddaee36",
    "cve_id": "CVE-2015-0263",
    "cwe_id": "Not Mapping",
    "filename": "camel-core/src/main/java/org/apache/camel/converter/jaxp/XmlConverter.java",
    "is_vulnerable": 0,
    "class_name": "XmlConverter",
    "subclass_name": null,
    "function_name": "toSAXSource(Source source, Exchange exchange) throws IOException, SAXException, TransformerException",
    "function_body": "{\n        if (source instanceof SAXSource) {\n            return (SAXSource) source;\n        } else if (source instanceof DOMSource) {\n            return toSAXSourceFromDOM((DOMSource) source, exchange);\n        } else if (source instanceof StreamSource) {\n            return toSAXSourceFromStream((StreamSource) source, exchange);\n        } else if (source instanceof StAXSource) {\n            return toSAXSourceFromStAX((StAXSource) source, exchange);\n        } else {\n            return null;\n        }\n    }"
  },
  {
    "id": 2,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 32,
    "human_patch": "https://github.com/apache/camel/commit/7d19340bcdb42f7aae584d9c5003ac4f7ddaee36",
    "cve_id": "CVE-2015-0263",
    "cwe_id": "Not Mapping",
    "filename": "camel-core/src/main/java/org/apache/camel/converter/jaxp/XmlConverter.java",
    "is_vulnerable": 0,
    "class_name": "XmlConverter",
    "subclass_name": null,
    "function_name": "toStreamSource(Source source) throws TransformerException",
    "function_body": "{\n        return toStreamSource(source, null);\n    }"
  },
  {
    "id": 2,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 33,
    "human_patch": "https://github.com/apache/camel/commit/7d19340bcdb42f7aae584d9c5003ac4f7ddaee36",
    "cve_id": "CVE-2015-0263",
    "cwe_id": "Not Mapping",
    "filename": "camel-core/src/main/java/org/apache/camel/converter/jaxp/XmlConverter.java",
    "is_vulnerable": 0,
    "class_name": "XmlConverter",
    "subclass_name": null,
    "function_name": "toStreamSource(Source source, Exchange exchange) throws TransformerException",
    "function_body": "{\n        if (source instanceof StreamSource) {\n            return (StreamSource) source;\n        } else if (source instanceof DOMSource) {\n            return toStreamSourceFromDOM((DOMSource) source, exchange);\n        } else if (source instanceof SAXSource) {\n            return toStreamSourceFromSAX((SAXSource) source, exchange);\n        } else if (source instanceof StAXSource) {\n            return toStreamSourceFromStAX((StAXSource) source, exchange);\n        } else {\n            return null;\n        }\n    }"
  },
  {
    "id": 2,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 34,
    "human_patch": "https://github.com/apache/camel/commit/7d19340bcdb42f7aae584d9c5003ac4f7ddaee36",
    "cve_id": "CVE-2015-0263",
    "cwe_id": "Not Mapping",
    "filename": "camel-core/src/main/java/org/apache/camel/converter/jaxp/XmlConverter.java",
    "is_vulnerable": 0,
    "class_name": "XmlConverter",
    "subclass_name": null,
    "function_name": "toStreamSource(InputStream in) throws TransformerException",
    "function_body": "{\n        return new StreamSource(in);\n    }"
  },
  {
    "id": 2,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 35,
    "human_patch": "https://github.com/apache/camel/commit/7d19340bcdb42f7aae584d9c5003ac4f7ddaee36",
    "cve_id": "CVE-2015-0263",
    "cwe_id": "Not Mapping",
    "filename": "camel-core/src/main/java/org/apache/camel/converter/jaxp/XmlConverter.java",
    "is_vulnerable": 0,
    "class_name": "XmlConverter",
    "subclass_name": null,
    "function_name": "toStreamSource(Reader in) throws TransformerException",
    "function_body": "{\n        return new StreamSource(in);\n    }"
  },
  {
    "id": 2,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 36,
    "human_patch": "https://github.com/apache/camel/commit/7d19340bcdb42f7aae584d9c5003ac4f7ddaee36",
    "cve_id": "CVE-2015-0263",
    "cwe_id": "Not Mapping",
    "filename": "camel-core/src/main/java/org/apache/camel/converter/jaxp/XmlConverter.java",
    "is_vulnerable": 0,
    "class_name": "XmlConverter",
    "subclass_name": null,
    "function_name": "toStreamSource(File in) throws TransformerException",
    "function_body": "{\n        return new StreamSource(in);\n    }"
  },
  {
    "id": 2,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 37,
    "human_patch": "https://github.com/apache/camel/commit/7d19340bcdb42f7aae584d9c5003ac4f7ddaee36",
    "cve_id": "CVE-2015-0263",
    "cwe_id": "Not Mapping",
    "filename": "camel-core/src/main/java/org/apache/camel/converter/jaxp/XmlConverter.java",
    "is_vulnerable": 0,
    "class_name": "XmlConverter",
    "subclass_name": null,
    "function_name": "toStreamSource(byte[] in, Exchange exchange) throws TransformerException",
    "function_body": "{\n        InputStream is = exchange.getContext().getTypeConverter().convertTo(InputStream.class, exchange, in);\n        return new StreamSource(is);\n    }"
  },
  {
    "id": 2,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 38,
    "human_patch": "https://github.com/apache/camel/commit/7d19340bcdb42f7aae584d9c5003ac4f7ddaee36",
    "cve_id": "CVE-2015-0263",
    "cwe_id": "Not Mapping",
    "filename": "camel-core/src/main/java/org/apache/camel/converter/jaxp/XmlConverter.java",
    "is_vulnerable": 0,
    "class_name": "XmlConverter",
    "subclass_name": null,
    "function_name": "toStreamSource(ByteBuffer in, Exchange exchange) throws TransformerException",
    "function_body": "{\n        InputStream is = exchange.getContext().getTypeConverter().convertTo(InputStream.class, exchange, in);\n        return new StreamSource(is);\n    }"
  },
  {
    "id": 2,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 39,
    "human_patch": "https://github.com/apache/camel/commit/7d19340bcdb42f7aae584d9c5003ac4f7ddaee36",
    "cve_id": "CVE-2015-0263",
    "cwe_id": "Not Mapping",
    "filename": "camel-core/src/main/java/org/apache/camel/converter/jaxp/XmlConverter.java",
    "is_vulnerable": 0,
    "class_name": "XmlConverter",
    "subclass_name": null,
    "function_name": "toStreamSourceFromSAX(SAXSource source) throws TransformerException",
    "function_body": "{\n        return toStreamSourceFromSAX(source, null);\n    }"
  },
  {
    "id": 2,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 40,
    "human_patch": "https://github.com/apache/camel/commit/7d19340bcdb42f7aae584d9c5003ac4f7ddaee36",
    "cve_id": "CVE-2015-0263",
    "cwe_id": "Not Mapping",
    "filename": "camel-core/src/main/java/org/apache/camel/converter/jaxp/XmlConverter.java",
    "is_vulnerable": 0,
    "class_name": "XmlConverter",
    "subclass_name": null,
    "function_name": "toStreamSourceFromSAX(SAXSource source, Exchange exchange) throws TransformerException",
    "function_body": "{\n        InputSource inputSource = source.getInputSource();\n        if (inputSource != null) {\n            if (inputSource.getCharacterStream() != null) {\n                return new StreamSource(inputSource.getCharacterStream());\n            }\n            if (inputSource.getByteStream() != null) {\n                return new StreamSource(inputSource.getByteStream());\n            }\n        }\n        String result = toString(source, exchange);\n        return new StringSource(result);\n    }"
  },
  {
    "id": 2,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 41,
    "human_patch": "https://github.com/apache/camel/commit/7d19340bcdb42f7aae584d9c5003ac4f7ddaee36",
    "cve_id": "CVE-2015-0263",
    "cwe_id": "Not Mapping",
    "filename": "camel-core/src/main/java/org/apache/camel/converter/jaxp/XmlConverter.java",
    "is_vulnerable": 0,
    "class_name": "XmlConverter",
    "subclass_name": null,
    "function_name": "toStreamSourceFromDOM(DOMSource source) throws TransformerException",
    "function_body": "{\n        return toStreamSourceFromDOM(source, null);\n    }"
  },
  {
    "id": 2,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 42,
    "human_patch": "https://github.com/apache/camel/commit/7d19340bcdb42f7aae584d9c5003ac4f7ddaee36",
    "cve_id": "CVE-2015-0263",
    "cwe_id": "Not Mapping",
    "filename": "camel-core/src/main/java/org/apache/camel/converter/jaxp/XmlConverter.java",
    "is_vulnerable": 0,
    "class_name": "XmlConverter",
    "subclass_name": null,
    "function_name": "toStreamSourceFromDOM(DOMSource source, Exchange exchange) throws TransformerException",
    "function_body": "{\n        String result = toString(source, exchange);\n        return new StringSource(result);\n    }"
  },
  {
    "id": 2,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 43,
    "human_patch": "https://github.com/apache/camel/commit/7d19340bcdb42f7aae584d9c5003ac4f7ddaee36",
    "cve_id": "CVE-2015-0263",
    "cwe_id": "Not Mapping",
    "filename": "camel-core/src/main/java/org/apache/camel/converter/jaxp/XmlConverter.java",
    "is_vulnerable": 0,
    "class_name": "XmlConverter",
    "subclass_name": null,
    "function_name": "toStreamSourceFromStAX(StAXSource source, Exchange exchange) throws TransformerException",
    "function_body": "{\n        String result = toString(source, exchange);\n        return new StringSource(result);\n    }"
  },
  {
    "id": 2,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 44,
    "human_patch": "https://github.com/apache/camel/commit/7d19340bcdb42f7aae584d9c5003ac4f7ddaee36",
    "cve_id": "CVE-2015-0263",
    "cwe_id": "Not Mapping",
    "filename": "camel-core/src/main/java/org/apache/camel/converter/jaxp/XmlConverter.java",
    "is_vulnerable": 0,
    "class_name": "XmlConverter",
    "subclass_name": null,
    "function_name": "toSAXSourceFromStream(StreamSource source) throws SAXException",
    "function_body": "{\n        return toSAXSourceFromStream(source, null);\n    }"
  },
  {
    "id": 2,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 45,
    "human_patch": "https://github.com/apache/camel/commit/7d19340bcdb42f7aae584d9c5003ac4f7ddaee36",
    "cve_id": "CVE-2015-0263",
    "cwe_id": "Not Mapping",
    "filename": "camel-core/src/main/java/org/apache/camel/converter/jaxp/XmlConverter.java",
    "is_vulnerable": 1,
    "class_name": "XmlConverter",
    "subclass_name": null,
    "function_name": "toSAXSourceFromStream(StreamSource source, Exchange exchange) throws SAXException",
    "function_body": "{\n        InputSource inputSource;\n        if (source.getReader() != null) {\n            inputSource = new InputSource(source.getReader());\n        } else {\n            inputSource = new InputSource(source.getInputStream());\n        }\n        inputSource.setSystemId(source.getSystemId());\n        inputSource.setPublicId(source.getPublicId());\n        XMLReader xmlReader = null;\n        SAXParserFactory sfactory = null;\n        \n        try {\n            \n            if (exchange != null) {\n                sfactory = exchange.getProperty(Exchange.SAXPARSER_FACTORY, SAXParserFactory.class);\n            }\n            if (sfactory == null) {\n                sfactory = SAXParserFactory.newInstance();\n                try {\n                    sfactory.setFeature(javax.xml.XMLConstants.FEATURE_SECURE_PROCESSING, true);\n                } catch (Exception e) {\n                    LOG.warn(\"SAXParser doesn't support the feature {} with value {}, due to {}.\", new Object[]{javax.xml.XMLConstants.FEATURE_SECURE_PROCESSING, \"true\", e});\n                }\n            }\n            sfactory.setNamespaceAware(true);\n            SAXParser parser = sfactory.newSAXParser();\n            xmlReader = parser.getXMLReader();\n        } catch (Exception ex) {\n            LOG.warn(\"Cannot create the SAXParser XMLReader, due to {}\", ex);\n        }\n        return new SAXSource(xmlReader, inputSource);\n    }"
  },
  {
    "id": 2,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 46,
    "human_patch": "https://github.com/apache/camel/commit/7d19340bcdb42f7aae584d9c5003ac4f7ddaee36",
    "cve_id": "CVE-2015-0263",
    "cwe_id": "Not Mapping",
    "filename": "camel-core/src/main/java/org/apache/camel/converter/jaxp/XmlConverter.java",
    "is_vulnerable": 0,
    "class_name": "XmlConverter",
    "subclass_name": null,
    "function_name": "toReaderFromSource(Source src) throws TransformerException",
    "function_body": "{\n        return toReaderFromSource(src, null);\n    }"
  },
  {
    "id": 2,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 47,
    "human_patch": "https://github.com/apache/camel/commit/7d19340bcdb42f7aae584d9c5003ac4f7ddaee36",
    "cve_id": "CVE-2015-0263",
    "cwe_id": "Not Mapping",
    "filename": "camel-core/src/main/java/org/apache/camel/converter/jaxp/XmlConverter.java",
    "is_vulnerable": 0,
    "class_name": "XmlConverter",
    "subclass_name": null,
    "function_name": "toReaderFromSource(Source src, Exchange exchange) throws TransformerException",
    "function_body": "{\n        StreamSource stSrc = toStreamSource(src, exchange);\n        Reader r = stSrc.getReader();\n        if (r == null) {\n            r = new InputStreamReader(stSrc.getInputStream());\n        }\n        return r;\n    }"
  },
  {
    "id": 2,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 48,
    "human_patch": "https://github.com/apache/camel/commit/7d19340bcdb42f7aae584d9c5003ac4f7ddaee36",
    "cve_id": "CVE-2015-0263",
    "cwe_id": "Not Mapping",
    "filename": "camel-core/src/main/java/org/apache/camel/converter/jaxp/XmlConverter.java",
    "is_vulnerable": 0,
    "class_name": "XmlConverter",
    "subclass_name": null,
    "function_name": "toDOMSource(InputStream is) throws ParserConfigurationException, IOException, SAXException",
    "function_body": "{\n        return toDOMSource(is, null);\n    }"
  },
  {
    "id": 2,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 49,
    "human_patch": "https://github.com/apache/camel/commit/7d19340bcdb42f7aae584d9c5003ac4f7ddaee36",
    "cve_id": "CVE-2015-0263",
    "cwe_id": "Not Mapping",
    "filename": "camel-core/src/main/java/org/apache/camel/converter/jaxp/XmlConverter.java",
    "is_vulnerable": 0,
    "class_name": "XmlConverter",
    "subclass_name": null,
    "function_name": "toDOMSource(InputStream is, Exchange exchange) throws ParserConfigurationException, IOException, SAXException",
    "function_body": "{\n        InputSource source = new InputSource(is);\n        String systemId = source.getSystemId();\n        DocumentBuilder builder = getDocumentBuilderFactory(exchange).newDocumentBuilder();\n        Document document = builder.parse(source);\n        return new DOMSource(document, systemId);\n    }"
  },
  {
    "id": 2,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 50,
    "human_patch": "https://github.com/apache/camel/commit/7d19340bcdb42f7aae584d9c5003ac4f7ddaee36",
    "cve_id": "CVE-2015-0263",
    "cwe_id": "Not Mapping",
    "filename": "camel-core/src/main/java/org/apache/camel/converter/jaxp/XmlConverter.java",
    "is_vulnerable": 0,
    "class_name": "XmlConverter",
    "subclass_name": null,
    "function_name": "toDOMSource(File file) throws ParserConfigurationException, IOException, SAXException",
    "function_body": "{\n        return toDOMSource(file, null);\n    }"
  },
  {
    "id": 2,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 51,
    "human_patch": "https://github.com/apache/camel/commit/7d19340bcdb42f7aae584d9c5003ac4f7ddaee36",
    "cve_id": "CVE-2015-0263",
    "cwe_id": "Not Mapping",
    "filename": "camel-core/src/main/java/org/apache/camel/converter/jaxp/XmlConverter.java",
    "is_vulnerable": 0,
    "class_name": "XmlConverter",
    "subclass_name": null,
    "function_name": "toDOMSource(File file, Exchange exchange) throws ParserConfigurationException, IOException, SAXException",
    "function_body": "{\n        InputStream is = IOHelper.buffered(new FileInputStream(file));\n        return toDOMSource(is, exchange);\n    }"
  },
  {
    "id": 2,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 52,
    "human_patch": "https://github.com/apache/camel/commit/7d19340bcdb42f7aae584d9c5003ac4f7ddaee36",
    "cve_id": "CVE-2015-0263",
    "cwe_id": "Not Mapping",
    "filename": "camel-core/src/main/java/org/apache/camel/converter/jaxp/XmlConverter.java",
    "is_vulnerable": 0,
    "class_name": "XmlConverter",
    "subclass_name": null,
    "function_name": "toDOMSourceFromStream(StreamSource source) throws ParserConfigurationException, IOException, SAXException",
    "function_body": "{\n        return toDOMSourceFromStream(source, null);\n    }"
  },
  {
    "id": 2,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 53,
    "human_patch": "https://github.com/apache/camel/commit/7d19340bcdb42f7aae584d9c5003ac4f7ddaee36",
    "cve_id": "CVE-2015-0263",
    "cwe_id": "Not Mapping",
    "filename": "camel-core/src/main/java/org/apache/camel/converter/jaxp/XmlConverter.java",
    "is_vulnerable": 0,
    "class_name": "XmlConverter",
    "subclass_name": null,
    "function_name": "toDOMSourceFromStream(StreamSource source, Exchange exchange) throws ParserConfigurationException, IOException, SAXException",
    "function_body": "{\n        Document document;\n        String systemId = source.getSystemId();\n\n        DocumentBuilder builder = getDocumentBuilderFactory(exchange).newDocumentBuilder();\n        Reader reader = source.getReader();\n        if (reader != null) {\n            document = builder.parse(new InputSource(reader));\n        } else {\n            InputStream inputStream = source.getInputStream();\n            if (inputStream != null) {\n                InputSource inputsource = new InputSource(inputStream);\n                inputsource.setSystemId(systemId);\n                document = builder.parse(inputsource);\n            } else {\n                throw new IOException(\"No input stream or reader available on StreamSource: \" + source);\n            }\n        }\n        return new DOMSource(document, systemId);\n    }"
  },
  {
    "id": 2,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 54,
    "human_patch": "https://github.com/apache/camel/commit/7d19340bcdb42f7aae584d9c5003ac4f7ddaee36",
    "cve_id": "CVE-2015-0263",
    "cwe_id": "Not Mapping",
    "filename": "camel-core/src/main/java/org/apache/camel/converter/jaxp/XmlConverter.java",
    "is_vulnerable": 0,
    "class_name": "XmlConverter",
    "subclass_name": null,
    "function_name": "toSAXSourceFromDOM(DOMSource source) throws TransformerException",
    "function_body": "{\n        return toSAXSourceFromDOM(source, null);\n    }"
  },
  {
    "id": 2,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 55,
    "human_patch": "https://github.com/apache/camel/commit/7d19340bcdb42f7aae584d9c5003ac4f7ddaee36",
    "cve_id": "CVE-2015-0263",
    "cwe_id": "Not Mapping",
    "filename": "camel-core/src/main/java/org/apache/camel/converter/jaxp/XmlConverter.java",
    "is_vulnerable": 0,
    "class_name": "XmlConverter",
    "subclass_name": null,
    "function_name": "toSAXSourceFromDOM(DOMSource source, Exchange exchange) throws TransformerException",
    "function_body": "{\n        String str = toString(source, exchange);\n        StringReader reader = new StringReader(str);\n        return new SAXSource(new InputSource(reader));\n    }"
  },
  {
    "id": 2,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 56,
    "human_patch": "https://github.com/apache/camel/commit/7d19340bcdb42f7aae584d9c5003ac4f7ddaee36",
    "cve_id": "CVE-2015-0263",
    "cwe_id": "Not Mapping",
    "filename": "camel-core/src/main/java/org/apache/camel/converter/jaxp/XmlConverter.java",
    "is_vulnerable": 0,
    "class_name": "XmlConverter",
    "subclass_name": null,
    "function_name": "toSAXSourceFromStAX(StAXSource source, Exchange exchange) throws TransformerException",
    "function_body": "{\n        String str = toString(source, exchange);\n        StringReader reader = new StringReader(str);\n        return new SAXSource(new InputSource(reader));\n    }"
  },
  {
    "id": 2,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 57,
    "human_patch": "https://github.com/apache/camel/commit/7d19340bcdb42f7aae584d9c5003ac4f7ddaee36",
    "cve_id": "CVE-2015-0263",
    "cwe_id": "Not Mapping",
    "filename": "camel-core/src/main/java/org/apache/camel/converter/jaxp/XmlConverter.java",
    "is_vulnerable": 0,
    "class_name": "XmlConverter",
    "subclass_name": null,
    "function_name": "toDOMSourceFromSAX(SAXSource source) throws IOException, SAXException, ParserConfigurationException, TransformerException",
    "function_body": "{\n        return new DOMSource(toDOMNodeFromSAX(source));\n    }"
  },
  {
    "id": 2,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 58,
    "human_patch": "https://github.com/apache/camel/commit/7d19340bcdb42f7aae584d9c5003ac4f7ddaee36",
    "cve_id": "CVE-2015-0263",
    "cwe_id": "Not Mapping",
    "filename": "camel-core/src/main/java/org/apache/camel/converter/jaxp/XmlConverter.java",
    "is_vulnerable": 0,
    "class_name": "XmlConverter",
    "subclass_name": null,
    "function_name": "toDOMSourceFromStAX(StAXSource source) throws IOException, SAXException, ParserConfigurationException, TransformerException",
    "function_body": "{\n        return new DOMSource(toDOMNodeFromStAX(source));\n    }"
  },
  {
    "id": 2,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 59,
    "human_patch": "https://github.com/apache/camel/commit/7d19340bcdb42f7aae584d9c5003ac4f7ddaee36",
    "cve_id": "CVE-2015-0263",
    "cwe_id": "Not Mapping",
    "filename": "camel-core/src/main/java/org/apache/camel/converter/jaxp/XmlConverter.java",
    "is_vulnerable": 0,
    "class_name": "XmlConverter",
    "subclass_name": null,
    "function_name": "toDOMNodeFromSAX(SAXSource source) throws ParserConfigurationException, IOException, SAXException, TransformerException",
    "function_body": "{\n        DOMResult result = new DOMResult();\n        toResult(source, result);\n        return result.getNode();\n    }"
  },
  {
    "id": 2,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 60,
    "human_patch": "https://github.com/apache/camel/commit/7d19340bcdb42f7aae584d9c5003ac4f7ddaee36",
    "cve_id": "CVE-2015-0263",
    "cwe_id": "Not Mapping",
    "filename": "camel-core/src/main/java/org/apache/camel/converter/jaxp/XmlConverter.java",
    "is_vulnerable": 0,
    "class_name": "XmlConverter",
    "subclass_name": null,
    "function_name": "toDOMNodeFromStAX(StAXSource source) throws ParserConfigurationException, IOException, SAXException, TransformerException",
    "function_body": "{\n        DOMResult result = new DOMResult();\n        toResult(source, result);\n        return result.getNode();\n    }"
  },
  {
    "id": 2,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 61,
    "human_patch": "https://github.com/apache/camel/commit/7d19340bcdb42f7aae584d9c5003ac4f7ddaee36",
    "cve_id": "CVE-2015-0263",
    "cwe_id": "Not Mapping",
    "filename": "camel-core/src/main/java/org/apache/camel/converter/jaxp/XmlConverter.java",
    "is_vulnerable": 0,
    "class_name": "XmlConverter",
    "subclass_name": null,
    "function_name": "toDOMNodeFromSingleNodeList(NodeList nl)",
    "function_body": "{\n        return nl.getLength() == 1 ? nl.item(0) : null;\n    }"
  },
  {
    "id": 2,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 62,
    "human_patch": "https://github.com/apache/camel/commit/7d19340bcdb42f7aae584d9c5003ac4f7ddaee36",
    "cve_id": "CVE-2015-0263",
    "cwe_id": "Not Mapping",
    "filename": "camel-core/src/main/java/org/apache/camel/converter/jaxp/XmlConverter.java",
    "is_vulnerable": 0,
    "class_name": "XmlConverter",
    "subclass_name": null,
    "function_name": "toDOMDocumentFromSingleNodeList(NodeList nl) throws ParserConfigurationException, TransformerException",
    "function_body": "{\n        if (nl.getLength() == 1) {\n            return toDOMDocument(nl.item(0));\n        } else if (nl instanceof Node) {\n            \n            \n            return toDOMDocument((Node) nl);\n        } else {\n            return null;\n        }\n    }"
  },
  {
    "id": 2,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 63,
    "human_patch": "https://github.com/apache/camel/commit/7d19340bcdb42f7aae584d9c5003ac4f7ddaee36",
    "cve_id": "CVE-2015-0263",
    "cwe_id": "Not Mapping",
    "filename": "camel-core/src/main/java/org/apache/camel/converter/jaxp/XmlConverter.java",
    "is_vulnerable": 0,
    "class_name": "XmlConverter",
    "subclass_name": null,
    "function_name": "toDOMNode(Source source) throws TransformerException, ParserConfigurationException, IOException, SAXException",
    "function_body": "{\n        DOMSource domSrc = toDOMSource(source);\n        return domSrc != null ? domSrc.getNode() : null;\n    }"
  },
  {
    "id": 2,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 64,
    "human_patch": "https://github.com/apache/camel/commit/7d19340bcdb42f7aae584d9c5003ac4f7ddaee36",
    "cve_id": "CVE-2015-0263",
    "cwe_id": "Not Mapping",
    "filename": "camel-core/src/main/java/org/apache/camel/converter/jaxp/XmlConverter.java",
    "is_vulnerable": 0,
    "class_name": "XmlConverter",
    "subclass_name": null,
    "function_name": "toDOMElement(Source source) throws TransformerException, ParserConfigurationException, IOException, SAXException",
    "function_body": "{\n        Node node = toDOMNode(source);\n        return toDOMElement(node);\n    }"
  },
  {
    "id": 2,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 65,
    "human_patch": "https://github.com/apache/camel/commit/7d19340bcdb42f7aae584d9c5003ac4f7ddaee36",
    "cve_id": "CVE-2015-0263",
    "cwe_id": "Not Mapping",
    "filename": "camel-core/src/main/java/org/apache/camel/converter/jaxp/XmlConverter.java",
    "is_vulnerable": 0,
    "class_name": "XmlConverter",
    "subclass_name": null,
    "function_name": "toDOMElement(Node node) throws TransformerException",
    "function_body": "{\n        \n        if (node instanceof Document) {\n            return ((Document) node).getDocumentElement();\n            \n        } else if (node instanceof Element) {\n            return (Element) node;\n            \n        } else {\n            throw new TransformerException(\"Unable to convert DOM node to an Element\");\n        }\n    }"
  },
  {
    "id": 2,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 66,
    "human_patch": "https://github.com/apache/camel/commit/7d19340bcdb42f7aae584d9c5003ac4f7ddaee36",
    "cve_id": "CVE-2015-0263",
    "cwe_id": "Not Mapping",
    "filename": "camel-core/src/main/java/org/apache/camel/converter/jaxp/XmlConverter.java",
    "is_vulnerable": 0,
    "class_name": "XmlConverter",
    "subclass_name": null,
    "function_name": "toDOMDocument(byte[] data) throws IOException, SAXException, ParserConfigurationException",
    "function_body": "{\n        return toDOMDocument(data, null);\n    }"
  },
  {
    "id": 2,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 67,
    "human_patch": "https://github.com/apache/camel/commit/7d19340bcdb42f7aae584d9c5003ac4f7ddaee36",
    "cve_id": "CVE-2015-0263",
    "cwe_id": "Not Mapping",
    "filename": "camel-core/src/main/java/org/apache/camel/converter/jaxp/XmlConverter.java",
    "is_vulnerable": 0,
    "class_name": "XmlConverter",
    "subclass_name": null,
    "function_name": "toDOMDocument(byte[] data, Exchange exchange) throws IOException, SAXException, ParserConfigurationException",
    "function_body": "{\n        DocumentBuilder documentBuilder = getDocumentBuilderFactory(exchange).newDocumentBuilder();\n        return documentBuilder.parse(new ByteArrayInputStream(data));\n    }"
  },
  {
    "id": 2,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 68,
    "human_patch": "https://github.com/apache/camel/commit/7d19340bcdb42f7aae584d9c5003ac4f7ddaee36",
    "cve_id": "CVE-2015-0263",
    "cwe_id": "Not Mapping",
    "filename": "camel-core/src/main/java/org/apache/camel/converter/jaxp/XmlConverter.java",
    "is_vulnerable": 0,
    "class_name": "XmlConverter",
    "subclass_name": null,
    "function_name": "toDOMDocument(InputStream in) throws IOException, SAXException, ParserConfigurationException",
    "function_body": "{\n        return toDOMDocument(in, null);\n    }"
  },
  {
    "id": 2,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 69,
    "human_patch": "https://github.com/apache/camel/commit/7d19340bcdb42f7aae584d9c5003ac4f7ddaee36",
    "cve_id": "CVE-2015-0263",
    "cwe_id": "Not Mapping",
    "filename": "camel-core/src/main/java/org/apache/camel/converter/jaxp/XmlConverter.java",
    "is_vulnerable": 0,
    "class_name": "XmlConverter",
    "subclass_name": null,
    "function_name": "toDOMDocument(InputStream in, Exchange exchange) throws IOException, SAXException, ParserConfigurationException",
    "function_body": "{\n        DocumentBuilder documentBuilder = getDocumentBuilderFactory(exchange).newDocumentBuilder();\n        return documentBuilder.parse(in);\n    }"
  },
  {
    "id": 2,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 70,
    "human_patch": "https://github.com/apache/camel/commit/7d19340bcdb42f7aae584d9c5003ac4f7ddaee36",
    "cve_id": "CVE-2015-0263",
    "cwe_id": "Not Mapping",
    "filename": "camel-core/src/main/java/org/apache/camel/converter/jaxp/XmlConverter.java",
    "is_vulnerable": 0,
    "class_name": "XmlConverter",
    "subclass_name": null,
    "function_name": "toDOMDocument(Reader in) throws IOException, SAXException, ParserConfigurationException",
    "function_body": "{\n        return toDOMDocument(new InputSource(in));\n    }"
  },
  {
    "id": 2,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 71,
    "human_patch": "https://github.com/apache/camel/commit/7d19340bcdb42f7aae584d9c5003ac4f7ddaee36",
    "cve_id": "CVE-2015-0263",
    "cwe_id": "Not Mapping",
    "filename": "camel-core/src/main/java/org/apache/camel/converter/jaxp/XmlConverter.java",
    "is_vulnerable": 0,
    "class_name": "XmlConverter",
    "subclass_name": null,
    "function_name": "toDOMDocument(Reader in, Exchange exchange) throws IOException, SAXException, ParserConfigurationException",
    "function_body": "{\n        return toDOMDocument(new InputSource(in), exchange);\n    }"
  },
  {
    "id": 2,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 72,
    "human_patch": "https://github.com/apache/camel/commit/7d19340bcdb42f7aae584d9c5003ac4f7ddaee36",
    "cve_id": "CVE-2015-0263",
    "cwe_id": "Not Mapping",
    "filename": "camel-core/src/main/java/org/apache/camel/converter/jaxp/XmlConverter.java",
    "is_vulnerable": 0,
    "class_name": "XmlConverter",
    "subclass_name": null,
    "function_name": "toDOMDocument(InputSource in) throws IOException, SAXException, ParserConfigurationException",
    "function_body": "{\n        return toDOMDocument(in, (Exchange)null);\n    }"
  },
  {
    "id": 2,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 73,
    "human_patch": "https://github.com/apache/camel/commit/7d19340bcdb42f7aae584d9c5003ac4f7ddaee36",
    "cve_id": "CVE-2015-0263",
    "cwe_id": "Not Mapping",
    "filename": "camel-core/src/main/java/org/apache/camel/converter/jaxp/XmlConverter.java",
    "is_vulnerable": 0,
    "class_name": "XmlConverter",
    "subclass_name": null,
    "function_name": "toDOMDocument(InputSource in, Exchange exchange) throws IOException, SAXException, ParserConfigurationException",
    "function_body": "{\n        DocumentBuilder documentBuilder = getDocumentBuilderFactory(exchange).newDocumentBuilder();\n        return documentBuilder.parse(in);\n    }"
  },
  {
    "id": 2,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 74,
    "human_patch": "https://github.com/apache/camel/commit/7d19340bcdb42f7aae584d9c5003ac4f7ddaee36",
    "cve_id": "CVE-2015-0263",
    "cwe_id": "Not Mapping",
    "filename": "camel-core/src/main/java/org/apache/camel/converter/jaxp/XmlConverter.java",
    "is_vulnerable": 0,
    "class_name": "XmlConverter",
    "subclass_name": null,
    "function_name": "toDOMDocument(String text) throws IOException, SAXException, ParserConfigurationException",
    "function_body": "{\n        return toDOMDocument(new StringReader(text));\n    }"
  },
  {
    "id": 2,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 75,
    "human_patch": "https://github.com/apache/camel/commit/7d19340bcdb42f7aae584d9c5003ac4f7ddaee36",
    "cve_id": "CVE-2015-0263",
    "cwe_id": "Not Mapping",
    "filename": "camel-core/src/main/java/org/apache/camel/converter/jaxp/XmlConverter.java",
    "is_vulnerable": 0,
    "class_name": "XmlConverter",
    "subclass_name": null,
    "function_name": "toDOMDocument(String text, Exchange exchange) throws IOException, SAXException, ParserConfigurationException",
    "function_body": "{\n        return toDOMDocument(new StringReader(text), exchange);\n    }"
  },
  {
    "id": 2,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 76,
    "human_patch": "https://github.com/apache/camel/commit/7d19340bcdb42f7aae584d9c5003ac4f7ddaee36",
    "cve_id": "CVE-2015-0263",
    "cwe_id": "Not Mapping",
    "filename": "camel-core/src/main/java/org/apache/camel/converter/jaxp/XmlConverter.java",
    "is_vulnerable": 0,
    "class_name": "XmlConverter",
    "subclass_name": null,
    "function_name": "toDOMDocument(File file) throws IOException, SAXException, ParserConfigurationException",
    "function_body": "{\n        return toDOMDocument(file, null);\n    }"
  },
  {
    "id": 2,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 77,
    "human_patch": "https://github.com/apache/camel/commit/7d19340bcdb42f7aae584d9c5003ac4f7ddaee36",
    "cve_id": "CVE-2015-0263",
    "cwe_id": "Not Mapping",
    "filename": "camel-core/src/main/java/org/apache/camel/converter/jaxp/XmlConverter.java",
    "is_vulnerable": 0,
    "class_name": "XmlConverter",
    "subclass_name": null,
    "function_name": "toDOMDocument(File file, Exchange exchange) throws IOException, SAXException, ParserConfigurationException",
    "function_body": "{\n        DocumentBuilder documentBuilder = getDocumentBuilderFactory(exchange).newDocumentBuilder();\n        return documentBuilder.parse(file);\n    }"
  },
  {
    "id": 2,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 78,
    "human_patch": "https://github.com/apache/camel/commit/7d19340bcdb42f7aae584d9c5003ac4f7ddaee36",
    "cve_id": "CVE-2015-0263",
    "cwe_id": "Not Mapping",
    "filename": "camel-core/src/main/java/org/apache/camel/converter/jaxp/XmlConverter.java",
    "is_vulnerable": 0,
    "class_name": "XmlConverter",
    "subclass_name": null,
    "function_name": "toDOMDocument(Source source) throws TransformerException, ParserConfigurationException, IOException, SAXException",
    "function_body": "{\n        Node node = toDOMNode(source);\n        return toDOMDocument(node);\n    }"
  },
  {
    "id": 2,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 79,
    "human_patch": "https://github.com/apache/camel/commit/7d19340bcdb42f7aae584d9c5003ac4f7ddaee36",
    "cve_id": "CVE-2015-0263",
    "cwe_id": "Not Mapping",
    "filename": "camel-core/src/main/java/org/apache/camel/converter/jaxp/XmlConverter.java",
    "is_vulnerable": 0,
    "class_name": "XmlConverter",
    "subclass_name": null,
    "function_name": "toDOMDocument(final Node node) throws ParserConfigurationException, TransformerException",
    "function_body": "{\n        ObjectHelper.notNull(node, \"node\");\n\n        \n        if (node instanceof Document) {\n            return (Document) node;\n            \n        } else if (node instanceof Element) {\n            Element elem = (Element) node;\n            \n            if (elem.getOwnerDocument().getDocumentElement() == elem) {\n                return elem.getOwnerDocument();\n                \n            } else {\n                Document doc = createDocument();\n                \n                \n                synchronized (node.getOwnerDocument()) {\n                    doc.appendChild(doc.importNode(node, true));\n                }\n                return doc;\n            }\n            \n        } else {\n            throw new TransformerException(\"Unable to convert DOM node to a Document: \" + node);\n        }\n    }"
  },
  {
    "id": 2,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 80,
    "human_patch": "https://github.com/apache/camel/commit/7d19340bcdb42f7aae584d9c5003ac4f7ddaee36",
    "cve_id": "CVE-2015-0263",
    "cwe_id": "Not Mapping",
    "filename": "camel-core/src/main/java/org/apache/camel/converter/jaxp/XmlConverter.java",
    "is_vulnerable": 0,
    "class_name": "XmlConverter",
    "subclass_name": null,
    "function_name": "toInputStream(DOMSource source) throws TransformerException, IOException",
    "function_body": "{\n        return toInputStream(source, null);\n    }"
  },
  {
    "id": 2,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 81,
    "human_patch": "https://github.com/apache/camel/commit/7d19340bcdb42f7aae584d9c5003ac4f7ddaee36",
    "cve_id": "CVE-2015-0263",
    "cwe_id": "Not Mapping",
    "filename": "camel-core/src/main/java/org/apache/camel/converter/jaxp/XmlConverter.java",
    "is_vulnerable": 0,
    "class_name": "XmlConverter",
    "subclass_name": null,
    "function_name": "toInputStream(DOMSource source, Exchange exchange) throws TransformerException, IOException",
    "function_body": "{\n        return new ByteArrayInputStream(toByteArray(source, exchange));\n    }"
  },
  {
    "id": 2,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 82,
    "human_patch": "https://github.com/apache/camel/commit/7d19340bcdb42f7aae584d9c5003ac4f7ddaee36",
    "cve_id": "CVE-2015-0263",
    "cwe_id": "Not Mapping",
    "filename": "camel-core/src/main/java/org/apache/camel/converter/jaxp/XmlConverter.java",
    "is_vulnerable": 0,
    "class_name": "XmlConverter",
    "subclass_name": null,
    "function_name": "toInputStream(Document dom) throws TransformerException, IOException",
    "function_body": "{\n        return toInputStream(dom, null);\n    }"
  },
  {
    "id": 2,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 83,
    "human_patch": "https://github.com/apache/camel/commit/7d19340bcdb42f7aae584d9c5003ac4f7ddaee36",
    "cve_id": "CVE-2015-0263",
    "cwe_id": "Not Mapping",
    "filename": "camel-core/src/main/java/org/apache/camel/converter/jaxp/XmlConverter.java",
    "is_vulnerable": 0,
    "class_name": "XmlConverter",
    "subclass_name": null,
    "function_name": "toInputStream(Document dom, Exchange exchange) throws TransformerException, IOException",
    "function_body": "{\n        return toInputStream(new DOMSource(dom), exchange);\n    }"
  },
  {
    "id": 2,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 84,
    "human_patch": "https://github.com/apache/camel/commit/7d19340bcdb42f7aae584d9c5003ac4f7ddaee36",
    "cve_id": "CVE-2015-0263",
    "cwe_id": "Not Mapping",
    "filename": "camel-core/src/main/java/org/apache/camel/converter/jaxp/XmlConverter.java",
    "is_vulnerable": 0,
    "class_name": "XmlConverter",
    "subclass_name": null,
    "function_name": "toInputSource(InputStream is, Exchange exchange)",
    "function_body": "{\n        return new InputSource(is);\n    }"
  },
  {
    "id": 2,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 85,
    "human_patch": "https://github.com/apache/camel/commit/7d19340bcdb42f7aae584d9c5003ac4f7ddaee36",
    "cve_id": "CVE-2015-0263",
    "cwe_id": "Not Mapping",
    "filename": "camel-core/src/main/java/org/apache/camel/converter/jaxp/XmlConverter.java",
    "is_vulnerable": 0,
    "class_name": "XmlConverter",
    "subclass_name": null,
    "function_name": "toInputSource(File file, Exchange exchange) throws FileNotFoundException",
    "function_body": "{\n        InputStream is = IOHelper.buffered(new FileInputStream(file));\n        return new InputSource(is);\n    }"
  },
  {
    "id": 2,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 86,
    "human_patch": "https://github.com/apache/camel/commit/7d19340bcdb42f7aae584d9c5003ac4f7ddaee36",
    "cve_id": "CVE-2015-0263",
    "cwe_id": "Not Mapping",
    "filename": "camel-core/src/main/java/org/apache/camel/converter/jaxp/XmlConverter.java",
    "is_vulnerable": 0,
    "class_name": "XmlConverter",
    "subclass_name": null,
    "function_name": "getDocumentBuilderFactory()",
    "function_body": "{\n        if (documentBuilderFactory == null) {\n            documentBuilderFactory = createDocumentBuilderFactory();\n        }\n        return documentBuilderFactory;\n    }"
  },
  {
    "id": 2,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 87,
    "human_patch": "https://github.com/apache/camel/commit/7d19340bcdb42f7aae584d9c5003ac4f7ddaee36",
    "cve_id": "CVE-2015-0263",
    "cwe_id": "Not Mapping",
    "filename": "camel-core/src/main/java/org/apache/camel/converter/jaxp/XmlConverter.java",
    "is_vulnerable": 0,
    "class_name": "XmlConverter",
    "subclass_name": null,
    "function_name": "setDocumentBuilderFactory(DocumentBuilderFactory documentBuilderFactory)",
    "function_body": "{\n        this.documentBuilderFactory = documentBuilderFactory;\n    }"
  },
  {
    "id": 2,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 88,
    "human_patch": "https://github.com/apache/camel/commit/7d19340bcdb42f7aae584d9c5003ac4f7ddaee36",
    "cve_id": "CVE-2015-0263",
    "cwe_id": "Not Mapping",
    "filename": "camel-core/src/main/java/org/apache/camel/converter/jaxp/XmlConverter.java",
    "is_vulnerable": 0,
    "class_name": "XmlConverter",
    "subclass_name": null,
    "function_name": "getTransformerFactory()",
    "function_body": "{\n        if (transformerFactory == null) {\n            transformerFactory = createTransformerFactory();\n        }\n        return transformerFactory;\n    }"
  },
  {
    "id": 2,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 89,
    "human_patch": "https://github.com/apache/camel/commit/7d19340bcdb42f7aae584d9c5003ac4f7ddaee36",
    "cve_id": "CVE-2015-0263",
    "cwe_id": "Not Mapping",
    "filename": "camel-core/src/main/java/org/apache/camel/converter/jaxp/XmlConverter.java",
    "is_vulnerable": 0,
    "class_name": "XmlConverter",
    "subclass_name": null,
    "function_name": "setTransformerFactory(TransformerFactory transformerFactory)",
    "function_body": "{\n        this.transformerFactory = transformerFactory;\n    }"
  },
  {
    "id": 2,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 90,
    "human_patch": "https://github.com/apache/camel/commit/7d19340bcdb42f7aae584d9c5003ac4f7ddaee36",
    "cve_id": "CVE-2015-0263",
    "cwe_id": "Not Mapping",
    "filename": "camel-core/src/main/java/org/apache/camel/converter/jaxp/XmlConverter.java",
    "is_vulnerable": 0,
    "class_name": "XmlConverter",
    "subclass_name": null,
    "function_name": "setupFeatures(DocumentBuilderFactory factory)",
    "function_body": "{\n        Properties properties = System.getProperties();\n        List<String> features = new ArrayList<String>();\n        for (Map.Entry<Object, Object> prop : properties.entrySet()) {\n            String key = (String) prop.getKey();\n            if (key.startsWith(XmlConverter.DOCUMENT_BUILDER_FACTORY_FEATURE)) {\n                String uri = ObjectHelper.after(key, \":\");\n                Boolean value = Boolean.valueOf((String)prop.getValue());\n                try {\n                    factory.setFeature(uri, value);\n                    features.add(\"feature \" + uri + \" value \" + value);\n                } catch (ParserConfigurationException e) {\n                    LOG.warn(\"DocumentBuilderFactory doesn't support the feature {} with value {}, due to {}.\", new Object[]{uri, value, e});\n                }\n            }\n        }\n        if (features.size() > 0) {\n            StringBuilder featureString = new StringBuilder();\n            \n            for (String feature : features) {\n                if (featureString.length() != 0) {\n                    featureString.append(\", \");\n                }\n                featureString.append(feature);\n            }\n            LOG.info(\"DocumentBuilderFactory has been set with features {{}}.\", featureString.toString());\n        }\n\n    }"
  },
  {
    "id": 2,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 91,
    "human_patch": "https://github.com/apache/camel/commit/7d19340bcdb42f7aae584d9c5003ac4f7ddaee36",
    "cve_id": "CVE-2015-0263",
    "cwe_id": "Not Mapping",
    "filename": "camel-core/src/main/java/org/apache/camel/converter/jaxp/XmlConverter.java",
    "is_vulnerable": 0,
    "class_name": "XmlConverter",
    "subclass_name": null,
    "function_name": "getDocumentBuilderFactory(Exchange exchange)",
    "function_body": "{\n        DocumentBuilderFactory answer = getDocumentBuilderFactory();\n        \n        if (exchange != null) {\n            DocumentBuilderFactory factory = exchange.getProperty(Exchange.DOCUMENT_BUILDER_FACTORY, DocumentBuilderFactory.class);\n            if (factory != null) {\n                answer = factory;\n            }\n        }\n        return answer;\n    }"
  },
  {
    "id": 2,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 92,
    "human_patch": "https://github.com/apache/camel/commit/7d19340bcdb42f7aae584d9c5003ac4f7ddaee36",
    "cve_id": "CVE-2015-0263",
    "cwe_id": "Not Mapping",
    "filename": "camel-core/src/main/java/org/apache/camel/converter/jaxp/XmlConverter.java",
    "is_vulnerable": 0,
    "class_name": "XmlConverter",
    "subclass_name": null,
    "function_name": "createDocumentBuilderFactory()",
    "function_body": "{\n        DocumentBuilderFactory factory = DocumentBuilderFactory.newInstance();\n        factory.setNamespaceAware(true);\n        factory.setIgnoringElementContentWhitespace(true);\n        factory.setIgnoringComments(true);\n        try {\n            \n            factory.setFeature(\"http://xml.org/sax/features/external-general-entities\", false);\n        } catch (ParserConfigurationException e) {\n            LOG.warn(\"DocumentBuilderFactory doesn't support the feature {} with value {}, due to {}.\"\n                     , new Object[]{\"http://xml.org/sax/features/external-general-entities\", false, e});\n        }\n        \n        try {\n            Class<?> smClass = ObjectHelper.loadClass(\"org.apache.xerces.util.SecurityManager\");\n            if (smClass != null) {\n                Object sm = smClass.newInstance();\n                \n                factory.setAttribute(\"http://apache.org/xml/properties/security-manager\", sm);\n            }\n        } catch (Exception e) {\n            LOG.warn(\"DocumentBuilderFactory doesn't support the attribute {}, due to {}.\"\n                     , new Object[]{\"http://apache.org/xml/properties/security-manager\", e});\n        }\n        \n        setupFeatures(factory);\n        return factory;\n    }"
  },
  {
    "id": 2,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 93,
    "human_patch": "https://github.com/apache/camel/commit/7d19340bcdb42f7aae584d9c5003ac4f7ddaee36",
    "cve_id": "CVE-2015-0263",
    "cwe_id": "Not Mapping",
    "filename": "camel-core/src/main/java/org/apache/camel/converter/jaxp/XmlConverter.java",
    "is_vulnerable": 0,
    "class_name": "XmlConverter",
    "subclass_name": null,
    "function_name": "createDocumentBuilder() throws ParserConfigurationException",
    "function_body": "{\n        DocumentBuilderFactory factory = getDocumentBuilderFactory();\n        return factory.newDocumentBuilder();\n    }"
  },
  {
    "id": 2,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 94,
    "human_patch": "https://github.com/apache/camel/commit/7d19340bcdb42f7aae584d9c5003ac4f7ddaee36",
    "cve_id": "CVE-2015-0263",
    "cwe_id": "Not Mapping",
    "filename": "camel-core/src/main/java/org/apache/camel/converter/jaxp/XmlConverter.java",
    "is_vulnerable": 0,
    "class_name": "XmlConverter",
    "subclass_name": null,
    "function_name": "createDocument() throws ParserConfigurationException",
    "function_body": "{\n        DocumentBuilder builder = createDocumentBuilder();\n        return builder.newDocument();\n    }"
  },
  {
    "id": 2,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 95,
    "human_patch": "https://github.com/apache/camel/commit/7d19340bcdb42f7aae584d9c5003ac4f7ddaee36",
    "cve_id": "CVE-2015-0263",
    "cwe_id": "Not Mapping",
    "filename": "camel-core/src/main/java/org/apache/camel/converter/jaxp/XmlConverter.java",
    "is_vulnerable": 0,
    "class_name": "XmlConverter",
    "subclass_name": null,
    "function_name": "createTransfomer() throws TransformerConfigurationException",
    "function_body": "{\n        return createTransformer();\n    }"
  },
  {
    "id": 2,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 96,
    "human_patch": "https://github.com/apache/camel/commit/7d19340bcdb42f7aae584d9c5003ac4f7ddaee36",
    "cve_id": "CVE-2015-0263",
    "cwe_id": "Not Mapping",
    "filename": "camel-core/src/main/java/org/apache/camel/converter/jaxp/XmlConverter.java",
    "is_vulnerable": 0,
    "class_name": "XmlConverter",
    "subclass_name": null,
    "function_name": "createTransformer() throws TransformerConfigurationException",
    "function_body": "{\n        TransformerFactory factory = getTransformerFactory();\n        return factory.newTransformer();\n    }"
  },
  {
    "id": 2,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 97,
    "human_patch": "https://github.com/apache/camel/commit/7d19340bcdb42f7aae584d9c5003ac4f7ddaee36",
    "cve_id": "CVE-2015-0263",
    "cwe_id": "Not Mapping",
    "filename": "camel-core/src/main/java/org/apache/camel/converter/jaxp/XmlConverter.java",
    "is_vulnerable": 0,
    "class_name": "XmlConverter",
    "subclass_name": null,
    "function_name": "createTransformerFactory()",
    "function_body": "{\n        TransformerFactory factory = TransformerFactory.newInstance();\n        \n        try {\n            factory.setFeature(javax.xml.XMLConstants.FEATURE_SECURE_PROCESSING, true);\n        } catch (TransformerConfigurationException e) {\n            LOG.warn(\"TransformerFactory doesn't support the feature {} with value {}, due to {}.\", new Object[]{javax.xml.XMLConstants.FEATURE_SECURE_PROCESSING, \"true\", e});\n        }\n        factory.setErrorListener(new XmlErrorListener());\n        return factory;\n    }"
  },
  {
    "id": 2,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 0,
    "human_patch": "https://github.com/apache/camel/commit/7d19340bcdb42f7aae584d9c5003ac4f7ddaee36",
    "cve_id": "CVE-2015-0263",
    "cwe_id": "Not Mapping",
    "filename": "camel-core/src/test/java/org/apache/camel/component/xslt/XsltDTDTest.java",
    "is_vulnerable": 0,
    "class_name": "XsltDTDTest",
    "subclass_name": null,
    "function_name": "testSendingStringMessage() throws Exception",
    "function_body": "{\n        sendEntityMessage(MESSAGE);\n    }"
  },
  {
    "id": 2,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 1,
    "human_patch": "https://github.com/apache/camel/commit/7d19340bcdb42f7aae584d9c5003ac4f7ddaee36",
    "cve_id": "CVE-2015-0263",
    "cwe_id": "Not Mapping",
    "filename": "camel-core/src/test/java/org/apache/camel/component/xslt/XsltDTDTest.java",
    "is_vulnerable": 0,
    "class_name": "XsltDTDTest",
    "subclass_name": null,
    "function_name": "testSendingInputStreamMessage() throws Exception",
    "function_body": "{\n        InputStream is = IOConverter.toInputStream(MESSAGE, new DefaultExchange(context));\n        sendEntityMessage(is);   \n    }"
  },
  {
    "id": 2,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 2,
    "human_patch": "https://github.com/apache/camel/commit/7d19340bcdb42f7aae584d9c5003ac4f7ddaee36",
    "cve_id": "CVE-2015-0263",
    "cwe_id": "Not Mapping",
    "filename": "camel-core/src/test/java/org/apache/camel/component/xslt/XsltDTDTest.java",
    "is_vulnerable": 1,
    "class_name": "XsltDTDTest",
    "subclass_name": null,
    "function_name": "sendEntityMessage(Object message) throws Exception",
    "function_body": "{\n        \n        MockEndpoint endpoint = getMockEndpoint(\"mock:result\");\n        endpoint.reset();\n        endpoint.expectedMessageCount(1);\n        \n        template.sendBody(\"direct:start1\", message);\n\n        assertMockEndpointsSatisfied();\n        \n        List<Exchange> list = endpoint.getReceivedExchanges();\n        Exchange exchange = list.get(0);\n        String xml = exchange.getIn().getBody(String.class);\n        assertTrue(\"Get a wrong transformed message\", xml.indexOf(\"<transformed subject=\\\"\\\">\") > 0);\n        \n        \n        \n        try {\n            template.sendBody(\"direct:start2\", message);\n            fail(\"Expect an exception here\");\n        } catch (Exception ex) {\n            \n            assertTrue(\"Get a wrong exception\", ex instanceof CamelExecutionException);\n            \n            assertTrue(\"Get a wrong exception cause\", ex.getCause() instanceof TransformerException);\n        }\n        \n    }"
  },
  {
    "id": 2,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 3,
    "human_patch": "https://github.com/apache/camel/commit/7d19340bcdb42f7aae584d9c5003ac4f7ddaee36",
    "cve_id": "CVE-2015-0263",
    "cwe_id": "Not Mapping",
    "filename": "camel-core/src/test/java/org/apache/camel/component/xslt/XsltDTDTest.java",
    "is_vulnerable": 0,
    "class_name": "XsltDTDTest",
    "subclass_name": null,
    "function_name": "createRouteBuilder() throws Exception",
    "function_body": "{\n        return new RouteBuilder() {\n            @Override\n            public void configure() throws Exception {\n                \n                from(\"direct:start1\")\n                    .to(\"xslt:org/apache/camel/component/xslt/transform_dtd.xsl\")\n                    .to(\"mock:result\");\n                \n                from(\"direct:start2\")\n                    .to(\"xslt:org/apache/camel/component/xslt/transform_dtd.xsl?allowStAX=false\")\n                    .to(\"mock:result\");\n            }\n        };\n    }"
  },
  {
    "id": 2,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 4,
    "human_patch": "https://github.com/apache/camel/commit/7d19340bcdb42f7aae584d9c5003ac4f7ddaee36",
    "cve_id": "CVE-2015-0263",
    "cwe_id": "Not Mapping",
    "filename": "camel-core/src/test/java/org/apache/camel/component/xslt/XsltDTDTest.java",
    "is_vulnerable": 0,
    "class_name": "XsltDTDTest",
    "subclass_name": null,
    "function_name": "configure() throws Exception",
    "function_body": "{\n                \n                from(\"direct:start1\")\n                    .to(\"xslt:org/apache/camel/component/xslt/transform_dtd.xsl\")\n                    .to(\"mock:result\");\n                \n                from(\"direct:start2\")\n                    .to(\"xslt:org/apache/camel/component/xslt/transform_dtd.xsl?allowStAX=false\")\n                    .to(\"mock:result\");\n            }"
  },
  {
    "id": 3,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 0,
    "human_patch": "https://github.com/apache/camel/commit/1df559649a96a1ca0368373387e542f46e4820da",
    "cve_id": "CVE-2015-0264",
    "cwe_id": "Not Mapping",
    "filename": "camel-core/src/main/java/org/apache/camel/builder/xml/XPathBuilder.java",
    "is_vulnerable": 0,
    "class_name": "XPathBuilder",
    "subclass_name": null,
    "function_name": "xpath(String text)",
    "function_body": "{\n        return new XPathBuilder(text);\n    }"
  },
  {
    "id": 3,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 1,
    "human_patch": "https://github.com/apache/camel/commit/1df559649a96a1ca0368373387e542f46e4820da",
    "cve_id": "CVE-2015-0264",
    "cwe_id": "Not Mapping",
    "filename": "camel-core/src/main/java/org/apache/camel/builder/xml/XPathBuilder.java",
    "is_vulnerable": 0,
    "class_name": "XPathBuilder",
    "subclass_name": null,
    "function_name": "xpath(String text, Class<?> resultType)",
    "function_body": "{\n        XPathBuilder builder = new XPathBuilder(text);\n        builder.setResultType(resultType);\n        return builder;\n    }"
  },
  {
    "id": 3,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 2,
    "human_patch": "https://github.com/apache/camel/commit/1df559649a96a1ca0368373387e542f46e4820da",
    "cve_id": "CVE-2015-0264",
    "cwe_id": "Not Mapping",
    "filename": "camel-core/src/main/java/org/apache/camel/builder/xml/XPathBuilder.java",
    "is_vulnerable": 0,
    "class_name": "XPathBuilder",
    "subclass_name": null,
    "function_name": "toString()",
    "function_body": "{\n        return \"XPath: \" + text;\n    }"
  },
  {
    "id": 3,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 3,
    "human_patch": "https://github.com/apache/camel/commit/1df559649a96a1ca0368373387e542f46e4820da",
    "cve_id": "CVE-2015-0264",
    "cwe_id": "Not Mapping",
    "filename": "camel-core/src/main/java/org/apache/camel/builder/xml/XPathBuilder.java",
    "is_vulnerable": 0,
    "class_name": "XPathBuilder",
    "subclass_name": null,
    "function_name": "matches(Exchange exchange)",
    "function_body": "{\n        try {\n            Object booleanResult = evaluateAs(exchange, XPathConstants.BOOLEAN);\n            return exchange.getContext().getTypeConverter().convertTo(Boolean.class, booleanResult);\n        } finally {\n            \n            this.exchange.remove();\n        }\n    }"
  },
  {
    "id": 3,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 4,
    "human_patch": "https://github.com/apache/camel/commit/1df559649a96a1ca0368373387e542f46e4820da",
    "cve_id": "CVE-2015-0264",
    "cwe_id": "Not Mapping",
    "filename": "camel-core/src/main/java/org/apache/camel/builder/xml/XPathBuilder.java",
    "is_vulnerable": 0,
    "class_name": "XPathBuilder",
    "subclass_name": null,
    "function_name": "evaluate(Exchange exchange, Class<T> type)",
    "function_body": "{\n        try {\n            Object result = evaluate(exchange);\n            return exchange.getContext().getTypeConverter().convertTo(type, exchange, result);\n        } finally {\n            \n            this.exchange.remove();\n        }\n    }"
  },
  {
    "id": 3,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 5,
    "human_patch": "https://github.com/apache/camel/commit/1df559649a96a1ca0368373387e542f46e4820da",
    "cve_id": "CVE-2015-0264",
    "cwe_id": "Not Mapping",
    "filename": "camel-core/src/main/java/org/apache/camel/builder/xml/XPathBuilder.java",
    "is_vulnerable": 0,
    "class_name": "XPathBuilder",
    "subclass_name": null,
    "function_name": "matches(CamelContext context, Object body)",
    "function_body": "{\n        ObjectHelper.notNull(context, \"CamelContext\");\n\n        \n        Exchange dummy = new DefaultExchange(context);\n        dummy.getIn().setBody(body);\n\n        try {\n            return matches(dummy);\n        } finally {\n            \n            exchange.remove();\n        }\n    }"
  },
  {
    "id": 3,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 6,
    "human_patch": "https://github.com/apache/camel/commit/1df559649a96a1ca0368373387e542f46e4820da",
    "cve_id": "CVE-2015-0264",
    "cwe_id": "Not Mapping",
    "filename": "camel-core/src/main/java/org/apache/camel/builder/xml/XPathBuilder.java",
    "is_vulnerable": 0,
    "class_name": "XPathBuilder",
    "subclass_name": null,
    "function_name": "evaluate(CamelContext context, Object body, Class<T> type)",
    "function_body": "{\n        ObjectHelper.notNull(context, \"CamelContext\");\n\n        \n        Exchange dummy = new DefaultExchange(context);\n        dummy.getIn().setBody(body);\n\n        try {\n            return evaluate(dummy, type);\n        } finally {\n            \n            exchange.remove();\n        }\n    }"
  },
  {
    "id": 3,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 7,
    "human_patch": "https://github.com/apache/camel/commit/1df559649a96a1ca0368373387e542f46e4820da",
    "cve_id": "CVE-2015-0264",
    "cwe_id": "Not Mapping",
    "filename": "camel-core/src/main/java/org/apache/camel/builder/xml/XPathBuilder.java",
    "is_vulnerable": 0,
    "class_name": "XPathBuilder",
    "subclass_name": null,
    "function_name": "evaluate(CamelContext context, Object body)",
    "function_body": "{\n        ObjectHelper.notNull(context, \"CamelContext\");\n\n        \n        Exchange dummy = new DefaultExchange(context);\n        dummy.getIn().setBody(body);\n\n        setResultQName(XPathConstants.STRING);\n        try {\n            return evaluate(dummy, String.class);\n        } finally {\n            \n            this.exchange.remove();\n        }\n    }"
  },
  {
    "id": 3,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 8,
    "human_patch": "https://github.com/apache/camel/commit/1df559649a96a1ca0368373387e542f46e4820da",
    "cve_id": "CVE-2015-0264",
    "cwe_id": "Not Mapping",
    "filename": "camel-core/src/main/java/org/apache/camel/builder/xml/XPathBuilder.java",
    "is_vulnerable": 0,
    "class_name": "XPathBuilder",
    "subclass_name": null,
    "function_name": "booleanResult()",
    "function_body": "{\n        resultQName = XPathConstants.BOOLEAN;\n        return this;\n    }"
  },
  {
    "id": 3,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 9,
    "human_patch": "https://github.com/apache/camel/commit/1df559649a96a1ca0368373387e542f46e4820da",
    "cve_id": "CVE-2015-0264",
    "cwe_id": "Not Mapping",
    "filename": "camel-core/src/main/java/org/apache/camel/builder/xml/XPathBuilder.java",
    "is_vulnerable": 0,
    "class_name": "XPathBuilder",
    "subclass_name": null,
    "function_name": "nodeResult()",
    "function_body": "{\n        resultQName = XPathConstants.NODE;\n        return this;\n    }"
  },
  {
    "id": 3,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 10,
    "human_patch": "https://github.com/apache/camel/commit/1df559649a96a1ca0368373387e542f46e4820da",
    "cve_id": "CVE-2015-0264",
    "cwe_id": "Not Mapping",
    "filename": "camel-core/src/main/java/org/apache/camel/builder/xml/XPathBuilder.java",
    "is_vulnerable": 0,
    "class_name": "XPathBuilder",
    "subclass_name": null,
    "function_name": "nodeSetResult()",
    "function_body": "{\n        resultQName = XPathConstants.NODESET;\n        return this;\n    }"
  },
  {
    "id": 3,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 11,
    "human_patch": "https://github.com/apache/camel/commit/1df559649a96a1ca0368373387e542f46e4820da",
    "cve_id": "CVE-2015-0264",
    "cwe_id": "Not Mapping",
    "filename": "camel-core/src/main/java/org/apache/camel/builder/xml/XPathBuilder.java",
    "is_vulnerable": 0,
    "class_name": "XPathBuilder",
    "subclass_name": null,
    "function_name": "numberResult()",
    "function_body": "{\n        resultQName = XPathConstants.NUMBER;\n        return this;\n    }"
  },
  {
    "id": 3,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 12,
    "human_patch": "https://github.com/apache/camel/commit/1df559649a96a1ca0368373387e542f46e4820da",
    "cve_id": "CVE-2015-0264",
    "cwe_id": "Not Mapping",
    "filename": "camel-core/src/main/java/org/apache/camel/builder/xml/XPathBuilder.java",
    "is_vulnerable": 0,
    "class_name": "XPathBuilder",
    "subclass_name": null,
    "function_name": "stringResult()",
    "function_body": "{\n        resultQName = XPathConstants.STRING;\n        return this;\n    }"
  },
  {
    "id": 3,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 13,
    "human_patch": "https://github.com/apache/camel/commit/1df559649a96a1ca0368373387e542f46e4820da",
    "cve_id": "CVE-2015-0264",
    "cwe_id": "Not Mapping",
    "filename": "camel-core/src/main/java/org/apache/camel/builder/xml/XPathBuilder.java",
    "is_vulnerable": 0,
    "class_name": "XPathBuilder",
    "subclass_name": null,
    "function_name": "resultType(Class<?> resultType)",
    "function_body": "{\n        setResultType(resultType);\n        return this;\n    }"
  },
  {
    "id": 3,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 14,
    "human_patch": "https://github.com/apache/camel/commit/1df559649a96a1ca0368373387e542f46e4820da",
    "cve_id": "CVE-2015-0264",
    "cwe_id": "Not Mapping",
    "filename": "camel-core/src/main/java/org/apache/camel/builder/xml/XPathBuilder.java",
    "is_vulnerable": 0,
    "class_name": "XPathBuilder",
    "subclass_name": null,
    "function_name": "objectModel(String uri)",
    "function_body": "{\n        \n        \n        \n        this.objectModelUri = uri;\n        return this;\n    }"
  },
  {
    "id": 3,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 15,
    "human_patch": "https://github.com/apache/camel/commit/1df559649a96a1ca0368373387e542f46e4820da",
    "cve_id": "CVE-2015-0264",
    "cwe_id": "Not Mapping",
    "filename": "camel-core/src/main/java/org/apache/camel/builder/xml/XPathBuilder.java",
    "is_vulnerable": 0,
    "class_name": "XPathBuilder",
    "subclass_name": null,
    "function_name": "saxon()",
    "function_body": "{\n        this.objectModelUri = SAXON_OBJECT_MODEL_URI;\n        return this;\n    }"
  },
  {
    "id": 3,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 16,
    "human_patch": "https://github.com/apache/camel/commit/1df559649a96a1ca0368373387e542f46e4820da",
    "cve_id": "CVE-2015-0264",
    "cwe_id": "Not Mapping",
    "filename": "camel-core/src/main/java/org/apache/camel/builder/xml/XPathBuilder.java",
    "is_vulnerable": 0,
    "class_name": "XPathBuilder",
    "subclass_name": null,
    "function_name": "functionResolver(XPathFunctionResolver functionResolver)",
    "function_body": "{\n        this.functionResolver = functionResolver;\n        return this;\n    }"
  },
  {
    "id": 3,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 17,
    "human_patch": "https://github.com/apache/camel/commit/1df559649a96a1ca0368373387e542f46e4820da",
    "cve_id": "CVE-2015-0264",
    "cwe_id": "Not Mapping",
    "filename": "camel-core/src/main/java/org/apache/camel/builder/xml/XPathBuilder.java",
    "is_vulnerable": 0,
    "class_name": "XPathBuilder",
    "subclass_name": null,
    "function_name": "namespace(String prefix, String uri)",
    "function_body": "{\n        namespaces.put(prefix, uri);\n        return this;\n    }"
  },
  {
    "id": 3,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 18,
    "human_patch": "https://github.com/apache/camel/commit/1df559649a96a1ca0368373387e542f46e4820da",
    "cve_id": "CVE-2015-0264",
    "cwe_id": "Not Mapping",
    "filename": "camel-core/src/main/java/org/apache/camel/builder/xml/XPathBuilder.java",
    "is_vulnerable": 0,
    "class_name": "XPathBuilder",
    "subclass_name": null,
    "function_name": "namespaces(Namespaces namespaces)",
    "function_body": "{\n        namespaces.configure(this);\n        return this;\n    }"
  },
  {
    "id": 3,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 19,
    "human_patch": "https://github.com/apache/camel/commit/1df559649a96a1ca0368373387e542f46e4820da",
    "cve_id": "CVE-2015-0264",
    "cwe_id": "Not Mapping",
    "filename": "camel-core/src/main/java/org/apache/camel/builder/xml/XPathBuilder.java",
    "is_vulnerable": 0,
    "class_name": "XPathBuilder",
    "subclass_name": null,
    "function_name": "variable(String name, Object value)",
    "function_body": "{\n        getVariableResolver().addVariable(name, value);\n        return this;\n    }"
  },
  {
    "id": 3,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 20,
    "human_patch": "https://github.com/apache/camel/commit/1df559649a96a1ca0368373387e542f46e4820da",
    "cve_id": "CVE-2015-0264",
    "cwe_id": "Not Mapping",
    "filename": "camel-core/src/main/java/org/apache/camel/builder/xml/XPathBuilder.java",
    "is_vulnerable": 0,
    "class_name": "XPathBuilder",
    "subclass_name": null,
    "function_name": "documentType(Class<?> documentType)",
    "function_body": "{\n        setDocumentType(documentType);\n        return this;\n    }"
  },
  {
    "id": 3,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 21,
    "human_patch": "https://github.com/apache/camel/commit/1df559649a96a1ca0368373387e542f46e4820da",
    "cve_id": "CVE-2015-0264",
    "cwe_id": "Not Mapping",
    "filename": "camel-core/src/main/java/org/apache/camel/builder/xml/XPathBuilder.java",
    "is_vulnerable": 0,
    "class_name": "XPathBuilder",
    "subclass_name": null,
    "function_name": "factory(XPathFactory xpathFactory)",
    "function_body": "{\n        setXPathFactory(xpathFactory);\n        return this;\n    }"
  },
  {
    "id": 3,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 22,
    "human_patch": "https://github.com/apache/camel/commit/1df559649a96a1ca0368373387e542f46e4820da",
    "cve_id": "CVE-2015-0264",
    "cwe_id": "Not Mapping",
    "filename": "camel-core/src/main/java/org/apache/camel/builder/xml/XPathBuilder.java",
    "is_vulnerable": 0,
    "class_name": "XPathBuilder",
    "subclass_name": null,
    "function_name": "logNamespaces()",
    "function_body": "{\n        setLogNamespaces(true);\n        return this;\n    }"
  },
  {
    "id": 3,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 23,
    "human_patch": "https://github.com/apache/camel/commit/1df559649a96a1ca0368373387e542f46e4820da",
    "cve_id": "CVE-2015-0264",
    "cwe_id": "Not Mapping",
    "filename": "camel-core/src/main/java/org/apache/camel/builder/xml/XPathBuilder.java",
    "is_vulnerable": 0,
    "class_name": "XPathBuilder",
    "subclass_name": null,
    "function_name": "getXPathFactory()",
    "function_body": "{\n        return xpathFactory;\n    }"
  },
  {
    "id": 3,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 24,
    "human_patch": "https://github.com/apache/camel/commit/1df559649a96a1ca0368373387e542f46e4820da",
    "cve_id": "CVE-2015-0264",
    "cwe_id": "Not Mapping",
    "filename": "camel-core/src/main/java/org/apache/camel/builder/xml/XPathBuilder.java",
    "is_vulnerable": 0,
    "class_name": "XPathBuilder",
    "subclass_name": null,
    "function_name": "setXPathFactory(XPathFactory xpathFactory)",
    "function_body": "{\n        this.xpathFactory = xpathFactory;\n    }"
  },
  {
    "id": 3,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 25,
    "human_patch": "https://github.com/apache/camel/commit/1df559649a96a1ca0368373387e542f46e4820da",
    "cve_id": "CVE-2015-0264",
    "cwe_id": "Not Mapping",
    "filename": "camel-core/src/main/java/org/apache/camel/builder/xml/XPathBuilder.java",
    "is_vulnerable": 0,
    "class_name": "XPathBuilder",
    "subclass_name": null,
    "function_name": "getDocumentType()",
    "function_body": "{\n        return documentType;\n    }"
  },
  {
    "id": 3,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 26,
    "human_patch": "https://github.com/apache/camel/commit/1df559649a96a1ca0368373387e542f46e4820da",
    "cve_id": "CVE-2015-0264",
    "cwe_id": "Not Mapping",
    "filename": "camel-core/src/main/java/org/apache/camel/builder/xml/XPathBuilder.java",
    "is_vulnerable": 0,
    "class_name": "XPathBuilder",
    "subclass_name": null,
    "function_name": "setDocumentType(Class<?> documentType)",
    "function_body": "{\n        this.documentType = documentType;\n    }"
  },
  {
    "id": 3,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 27,
    "human_patch": "https://github.com/apache/camel/commit/1df559649a96a1ca0368373387e542f46e4820da",
    "cve_id": "CVE-2015-0264",
    "cwe_id": "Not Mapping",
    "filename": "camel-core/src/main/java/org/apache/camel/builder/xml/XPathBuilder.java",
    "is_vulnerable": 0,
    "class_name": "XPathBuilder",
    "subclass_name": null,
    "function_name": "getText()",
    "function_body": "{\n        return text;\n    }"
  },
  {
    "id": 3,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 28,
    "human_patch": "https://github.com/apache/camel/commit/1df559649a96a1ca0368373387e542f46e4820da",
    "cve_id": "CVE-2015-0264",
    "cwe_id": "Not Mapping",
    "filename": "camel-core/src/main/java/org/apache/camel/builder/xml/XPathBuilder.java",
    "is_vulnerable": 0,
    "class_name": "XPathBuilder",
    "subclass_name": null,
    "function_name": "getResultQName()",
    "function_body": "{\n        return resultQName;\n    }"
  },
  {
    "id": 3,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 29,
    "human_patch": "https://github.com/apache/camel/commit/1df559649a96a1ca0368373387e542f46e4820da",
    "cve_id": "CVE-2015-0264",
    "cwe_id": "Not Mapping",
    "filename": "camel-core/src/main/java/org/apache/camel/builder/xml/XPathBuilder.java",
    "is_vulnerable": 0,
    "class_name": "XPathBuilder",
    "subclass_name": null,
    "function_name": "setResultQName(QName resultQName)",
    "function_body": "{\n        this.resultQName = resultQName;\n    }"
  },
  {
    "id": 3,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 30,
    "human_patch": "https://github.com/apache/camel/commit/1df559649a96a1ca0368373387e542f46e4820da",
    "cve_id": "CVE-2015-0264",
    "cwe_id": "Not Mapping",
    "filename": "camel-core/src/main/java/org/apache/camel/builder/xml/XPathBuilder.java",
    "is_vulnerable": 0,
    "class_name": "XPathBuilder",
    "subclass_name": null,
    "function_name": "getHeaderName()",
    "function_body": "{\n        return headerName;\n    }"
  },
  {
    "id": 3,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 31,
    "human_patch": "https://github.com/apache/camel/commit/1df559649a96a1ca0368373387e542f46e4820da",
    "cve_id": "CVE-2015-0264",
    "cwe_id": "Not Mapping",
    "filename": "camel-core/src/main/java/org/apache/camel/builder/xml/XPathBuilder.java",
    "is_vulnerable": 0,
    "class_name": "XPathBuilder",
    "subclass_name": null,
    "function_name": "setHeaderName(String headerName)",
    "function_body": "{\n        this.headerName = headerName;\n    }"
  },
  {
    "id": 3,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 32,
    "human_patch": "https://github.com/apache/camel/commit/1df559649a96a1ca0368373387e542f46e4820da",
    "cve_id": "CVE-2015-0264",
    "cwe_id": "Not Mapping",
    "filename": "camel-core/src/main/java/org/apache/camel/builder/xml/XPathBuilder.java",
    "is_vulnerable": 0,
    "class_name": "XPathBuilder",
    "subclass_name": null,
    "function_name": "getNamespaceContext()",
    "function_body": "{\n        return namespaceContext;\n    }"
  },
  {
    "id": 3,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 33,
    "human_patch": "https://github.com/apache/camel/commit/1df559649a96a1ca0368373387e542f46e4820da",
    "cve_id": "CVE-2015-0264",
    "cwe_id": "Not Mapping",
    "filename": "camel-core/src/main/java/org/apache/camel/builder/xml/XPathBuilder.java",
    "is_vulnerable": 0,
    "class_name": "XPathBuilder",
    "subclass_name": null,
    "function_name": "setNamespaceContext(DefaultNamespaceContext namespaceContext)",
    "function_body": "{\n        this.namespaceContext = namespaceContext;\n    }"
  },
  {
    "id": 3,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 34,
    "human_patch": "https://github.com/apache/camel/commit/1df559649a96a1ca0368373387e542f46e4820da",
    "cve_id": "CVE-2015-0264",
    "cwe_id": "Not Mapping",
    "filename": "camel-core/src/main/java/org/apache/camel/builder/xml/XPathBuilder.java",
    "is_vulnerable": 0,
    "class_name": "XPathBuilder",
    "subclass_name": null,
    "function_name": "getFunctionResolver()",
    "function_body": "{\n        return functionResolver;\n    }"
  },
  {
    "id": 3,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 35,
    "human_patch": "https://github.com/apache/camel/commit/1df559649a96a1ca0368373387e542f46e4820da",
    "cve_id": "CVE-2015-0264",
    "cwe_id": "Not Mapping",
    "filename": "camel-core/src/main/java/org/apache/camel/builder/xml/XPathBuilder.java",
    "is_vulnerable": 0,
    "class_name": "XPathBuilder",
    "subclass_name": null,
    "function_name": "setFunctionResolver(XPathFunctionResolver functionResolver)",
    "function_body": "{\n        this.functionResolver = functionResolver;\n    }"
  },
  {
    "id": 3,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 36,
    "human_patch": "https://github.com/apache/camel/commit/1df559649a96a1ca0368373387e542f46e4820da",
    "cve_id": "CVE-2015-0264",
    "cwe_id": "Not Mapping",
    "filename": "camel-core/src/main/java/org/apache/camel/builder/xml/XPathBuilder.java",
    "is_vulnerable": 0,
    "class_name": "XPathBuilder",
    "subclass_name": null,
    "function_name": "setNamespaces(Map<String, String> namespaces)",
    "function_body": "{\n        this.namespaces.clear();\n        this.namespaces.putAll(namespaces);\n    }"
  },
  {
    "id": 3,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 37,
    "human_patch": "https://github.com/apache/camel/commit/1df559649a96a1ca0368373387e542f46e4820da",
    "cve_id": "CVE-2015-0264",
    "cwe_id": "Not Mapping",
    "filename": "camel-core/src/main/java/org/apache/camel/builder/xml/XPathBuilder.java",
    "is_vulnerable": 0,
    "class_name": "XPathBuilder",
    "subclass_name": null,
    "function_name": "getBodyFunction()",
    "function_body": "{\n        return bodyFunction;\n    }"
  },
  {
    "id": 3,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 38,
    "human_patch": "https://github.com/apache/camel/commit/1df559649a96a1ca0368373387e542f46e4820da",
    "cve_id": "CVE-2015-0264",
    "cwe_id": "Not Mapping",
    "filename": "camel-core/src/main/java/org/apache/camel/builder/xml/XPathBuilder.java",
    "is_vulnerable": 0,
    "class_name": "XPathBuilder",
    "subclass_name": null,
    "function_name": "createBodyFunction()",
    "function_body": "{\n        return new XPathFunction() {\n            @SuppressWarnings(\"rawtypes\")\n            public Object evaluate(List list) throws XPathFunctionException {\n                return exchange.get().getIn().getBody();\n            }\n        };\n    }"
  },
  {
    "id": 3,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 39,
    "human_patch": "https://github.com/apache/camel/commit/1df559649a96a1ca0368373387e542f46e4820da",
    "cve_id": "CVE-2015-0264",
    "cwe_id": "Not Mapping",
    "filename": "camel-core/src/main/java/org/apache/camel/builder/xml/XPathBuilder.java",
    "is_vulnerable": 0,
    "class_name": "XPathBuilder",
    "subclass_name": null,
    "function_name": "evaluate(List list) throws XPathFunctionException",
    "function_body": "{\n                return exchange.get().getIn().getBody();\n            }"
  },
  {
    "id": 3,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 40,
    "human_patch": "https://github.com/apache/camel/commit/1df559649a96a1ca0368373387e542f46e4820da",
    "cve_id": "CVE-2015-0264",
    "cwe_id": "Not Mapping",
    "filename": "camel-core/src/main/java/org/apache/camel/builder/xml/XPathBuilder.java",
    "is_vulnerable": 0,
    "class_name": "XPathBuilder",
    "subclass_name": null,
    "function_name": "setBodyFunction(XPathFunction bodyFunction)",
    "function_body": "{\n        this.bodyFunction = bodyFunction;\n    }"
  },
  {
    "id": 3,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 41,
    "human_patch": "https://github.com/apache/camel/commit/1df559649a96a1ca0368373387e542f46e4820da",
    "cve_id": "CVE-2015-0264",
    "cwe_id": "Not Mapping",
    "filename": "camel-core/src/main/java/org/apache/camel/builder/xml/XPathBuilder.java",
    "is_vulnerable": 0,
    "class_name": "XPathBuilder",
    "subclass_name": null,
    "function_name": "getHeaderFunction()",
    "function_body": "{\n        return headerFunction;\n    }"
  },
  {
    "id": 3,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 42,
    "human_patch": "https://github.com/apache/camel/commit/1df559649a96a1ca0368373387e542f46e4820da",
    "cve_id": "CVE-2015-0264",
    "cwe_id": "Not Mapping",
    "filename": "camel-core/src/main/java/org/apache/camel/builder/xml/XPathBuilder.java",
    "is_vulnerable": 0,
    "class_name": "XPathBuilder",
    "subclass_name": null,
    "function_name": "createHeaderFunction()",
    "function_body": "{\n        return new XPathFunction() {\n            @SuppressWarnings(\"rawtypes\")\n            public Object evaluate(List list) throws XPathFunctionException {\n                if (!list.isEmpty()) {\n                    Object value = list.get(0);\n                    if (value != null) {\n                        String text = exchange.get().getContext().getTypeConverter().convertTo(String.class, value);\n                        return exchange.get().getIn().getHeader(text);\n                    }\n                }\n                return null;\n            }\n        };\n    }"
  },
  {
    "id": 3,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 43,
    "human_patch": "https://github.com/apache/camel/commit/1df559649a96a1ca0368373387e542f46e4820da",
    "cve_id": "CVE-2015-0264",
    "cwe_id": "Not Mapping",
    "filename": "camel-core/src/main/java/org/apache/camel/builder/xml/XPathBuilder.java",
    "is_vulnerable": 1,
    "class_name": "XPathBuilder",
    "subclass_name": null,
    "function_name": "evaluate(List list) throws XPathFunctionException",
    "function_body": "{\n                if (!list.isEmpty()) {\n                    Object value = list.get(0);\n                    if (value != null) {\n                        String text = exchange.get().getContext().getTypeConverter().convertTo(String.class, value);\n                        return exchange.get().getIn().getHeader(text);\n                    }\n                }\n                return null;\n            }"
  },
  {
    "id": 3,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 44,
    "human_patch": "https://github.com/apache/camel/commit/1df559649a96a1ca0368373387e542f46e4820da",
    "cve_id": "CVE-2015-0264",
    "cwe_id": "Not Mapping",
    "filename": "camel-core/src/main/java/org/apache/camel/builder/xml/XPathBuilder.java",
    "is_vulnerable": 0,
    "class_name": "XPathBuilder",
    "subclass_name": null,
    "function_name": "setHeaderFunction(XPathFunction headerFunction)",
    "function_body": "{\n        this.headerFunction = headerFunction;\n    }"
  },
  {
    "id": 3,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 45,
    "human_patch": "https://github.com/apache/camel/commit/1df559649a96a1ca0368373387e542f46e4820da",
    "cve_id": "CVE-2015-0264",
    "cwe_id": "Not Mapping",
    "filename": "camel-core/src/main/java/org/apache/camel/builder/xml/XPathBuilder.java",
    "is_vulnerable": 0,
    "class_name": "XPathBuilder",
    "subclass_name": null,
    "function_name": "getOutBodyFunction()",
    "function_body": "{\n        return outBodyFunction;\n    }"
  },
  {
    "id": 3,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 46,
    "human_patch": "https://github.com/apache/camel/commit/1df559649a96a1ca0368373387e542f46e4820da",
    "cve_id": "CVE-2015-0264",
    "cwe_id": "Not Mapping",
    "filename": "camel-core/src/main/java/org/apache/camel/builder/xml/XPathBuilder.java",
    "is_vulnerable": 0,
    "class_name": "XPathBuilder",
    "subclass_name": null,
    "function_name": "createOutBodyFunction()",
    "function_body": "{\n        return new XPathFunction() {\n            @SuppressWarnings(\"rawtypes\")\n            public Object evaluate(List list) throws XPathFunctionException {\n                if (exchange.get() != null && exchange.get().hasOut()) {\n                    return exchange.get().getOut().getBody();\n                }\n                return null;\n            }\n        };\n    }"
  },
  {
    "id": 3,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 47,
    "human_patch": "https://github.com/apache/camel/commit/1df559649a96a1ca0368373387e542f46e4820da",
    "cve_id": "CVE-2015-0264",
    "cwe_id": "Not Mapping",
    "filename": "camel-core/src/main/java/org/apache/camel/builder/xml/XPathBuilder.java",
    "is_vulnerable": 1,
    "class_name": "XPathBuilder",
    "subclass_name": null,
    "function_name": "evaluate(List list) throws XPathFunctionException",
    "function_body": "{\n                if (exchange.get() != null && exchange.get().hasOut()) {\n                    return exchange.get().getOut().getBody();\n                }\n                return null;\n            }"
  },
  {
    "id": 3,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 48,
    "human_patch": "https://github.com/apache/camel/commit/1df559649a96a1ca0368373387e542f46e4820da",
    "cve_id": "CVE-2015-0264",
    "cwe_id": "Not Mapping",
    "filename": "camel-core/src/main/java/org/apache/camel/builder/xml/XPathBuilder.java",
    "is_vulnerable": 0,
    "class_name": "XPathBuilder",
    "subclass_name": null,
    "function_name": "setOutBodyFunction(XPathFunction outBodyFunction)",
    "function_body": "{\n        this.outBodyFunction = outBodyFunction;\n    }"
  },
  {
    "id": 3,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 49,
    "human_patch": "https://github.com/apache/camel/commit/1df559649a96a1ca0368373387e542f46e4820da",
    "cve_id": "CVE-2015-0264",
    "cwe_id": "Not Mapping",
    "filename": "camel-core/src/main/java/org/apache/camel/builder/xml/XPathBuilder.java",
    "is_vulnerable": 0,
    "class_name": "XPathBuilder",
    "subclass_name": null,
    "function_name": "getOutHeaderFunction()",
    "function_body": "{\n        return outHeaderFunction;\n    }"
  },
  {
    "id": 3,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 50,
    "human_patch": "https://github.com/apache/camel/commit/1df559649a96a1ca0368373387e542f46e4820da",
    "cve_id": "CVE-2015-0264",
    "cwe_id": "Not Mapping",
    "filename": "camel-core/src/main/java/org/apache/camel/builder/xml/XPathBuilder.java",
    "is_vulnerable": 0,
    "class_name": "XPathBuilder",
    "subclass_name": null,
    "function_name": "createOutHeaderFunction()",
    "function_body": "{\n        return new XPathFunction() {\n            @SuppressWarnings(\"rawtypes\")\n            public Object evaluate(List list) throws XPathFunctionException {\n                if (exchange.get() != null && !list.isEmpty()) {\n                    Object value = list.get(0);\n                    if (value != null) {\n                        String text = exchange.get().getContext().getTypeConverter().convertTo(String.class, value);\n                        return exchange.get().getOut().getHeader(text);\n                    }\n                }\n                return null;\n            }\n        };\n    }"
  },
  {
    "id": 3,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 51,
    "human_patch": "https://github.com/apache/camel/commit/1df559649a96a1ca0368373387e542f46e4820da",
    "cve_id": "CVE-2015-0264",
    "cwe_id": "Not Mapping",
    "filename": "camel-core/src/main/java/org/apache/camel/builder/xml/XPathBuilder.java",
    "is_vulnerable": 1,
    "class_name": "XPathBuilder",
    "subclass_name": null,
    "function_name": "evaluate(List list) throws XPathFunctionException",
    "function_body": "{\n                if (exchange.get() != null && !list.isEmpty()) {\n                    Object value = list.get(0);\n                    if (value != null) {\n                        String text = exchange.get().getContext().getTypeConverter().convertTo(String.class, value);\n                        return exchange.get().getOut().getHeader(text);\n                    }\n                }\n                return null;\n            }"
  },
  {
    "id": 3,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 52,
    "human_patch": "https://github.com/apache/camel/commit/1df559649a96a1ca0368373387e542f46e4820da",
    "cve_id": "CVE-2015-0264",
    "cwe_id": "Not Mapping",
    "filename": "camel-core/src/main/java/org/apache/camel/builder/xml/XPathBuilder.java",
    "is_vulnerable": 0,
    "class_name": "XPathBuilder",
    "subclass_name": null,
    "function_name": "setOutHeaderFunction(XPathFunction outHeaderFunction)",
    "function_body": "{\n        this.outHeaderFunction = outHeaderFunction;\n    }"
  },
  {
    "id": 3,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 53,
    "human_patch": "https://github.com/apache/camel/commit/1df559649a96a1ca0368373387e542f46e4820da",
    "cve_id": "CVE-2015-0264",
    "cwe_id": "Not Mapping",
    "filename": "camel-core/src/main/java/org/apache/camel/builder/xml/XPathBuilder.java",
    "is_vulnerable": 0,
    "class_name": "XPathBuilder",
    "subclass_name": null,
    "function_name": "getPropertiesFunction()",
    "function_body": "{\n        return propertiesFunction;\n    }"
  },
  {
    "id": 3,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 54,
    "human_patch": "https://github.com/apache/camel/commit/1df559649a96a1ca0368373387e542f46e4820da",
    "cve_id": "CVE-2015-0264",
    "cwe_id": "Not Mapping",
    "filename": "camel-core/src/main/java/org/apache/camel/builder/xml/XPathBuilder.java",
    "is_vulnerable": 0,
    "class_name": "XPathBuilder",
    "subclass_name": null,
    "function_name": "createPropertiesFunction()",
    "function_body": "{\n        return new XPathFunction() {\n            @SuppressWarnings(\"rawtypes\")\n            public Object evaluate(List list) throws XPathFunctionException {\n                if (!list.isEmpty()) {\n                    Object value = list.get(0);\n                    if (value != null) {\n                        String text = exchange.get().getContext().getTypeConverter().convertTo(String.class, value);\n                        try {\n                            \n                            Object answer = exchange.get().getContext().resolvePropertyPlaceholders(\"{{\" + text + \"}}\");\n                            return answer;\n                        } catch (Exception e) {\n                            throw new XPathFunctionException(e);\n                        }\n                    }\n                }\n                return null;\n            }\n        };\n    }"
  },
  {
    "id": 3,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 55,
    "human_patch": "https://github.com/apache/camel/commit/1df559649a96a1ca0368373387e542f46e4820da",
    "cve_id": "CVE-2015-0264",
    "cwe_id": "Not Mapping",
    "filename": "camel-core/src/main/java/org/apache/camel/builder/xml/XPathBuilder.java",
    "is_vulnerable": 1,
    "class_name": "XPathBuilder",
    "subclass_name": null,
    "function_name": "evaluate(List list) throws XPathFunctionException",
    "function_body": "{\n                if (!list.isEmpty()) {\n                    Object value = list.get(0);\n                    if (value != null) {\n                        String text = exchange.get().getContext().getTypeConverter().convertTo(String.class, value);\n                        try {\n                            \n                            Object answer = exchange.get().getContext().resolvePropertyPlaceholders(\"{{\" + text + \"}}\");\n                            return answer;\n                        } catch (Exception e) {\n                            throw new XPathFunctionException(e);\n                        }\n                    }\n                }\n                return null;\n            }"
  },
  {
    "id": 3,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 56,
    "human_patch": "https://github.com/apache/camel/commit/1df559649a96a1ca0368373387e542f46e4820da",
    "cve_id": "CVE-2015-0264",
    "cwe_id": "Not Mapping",
    "filename": "camel-core/src/main/java/org/apache/camel/builder/xml/XPathBuilder.java",
    "is_vulnerable": 0,
    "class_name": "XPathBuilder",
    "subclass_name": null,
    "function_name": "setPropertiesFunction(XPathFunction propertiesFunction)",
    "function_body": "{\n        this.propertiesFunction = propertiesFunction;\n    }"
  },
  {
    "id": 3,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 57,
    "human_patch": "https://github.com/apache/camel/commit/1df559649a96a1ca0368373387e542f46e4820da",
    "cve_id": "CVE-2015-0264",
    "cwe_id": "Not Mapping",
    "filename": "camel-core/src/main/java/org/apache/camel/builder/xml/XPathBuilder.java",
    "is_vulnerable": 0,
    "class_name": "XPathBuilder",
    "subclass_name": null,
    "function_name": "getSimpleFunction()",
    "function_body": "{\n        return simpleFunction;\n    }"
  },
  {
    "id": 3,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 58,
    "human_patch": "https://github.com/apache/camel/commit/1df559649a96a1ca0368373387e542f46e4820da",
    "cve_id": "CVE-2015-0264",
    "cwe_id": "Not Mapping",
    "filename": "camel-core/src/main/java/org/apache/camel/builder/xml/XPathBuilder.java",
    "is_vulnerable": 0,
    "class_name": "XPathBuilder",
    "subclass_name": null,
    "function_name": "createSimpleFunction()",
    "function_body": "{\n        return new XPathFunction() {\n            @SuppressWarnings(\"rawtypes\")\n            public Object evaluate(List list) throws XPathFunctionException {\n                if (!list.isEmpty()) {\n                    Object value = list.get(0);\n                    if (value != null) {\n                        String text = exchange.get().getContext().getTypeConverter().convertTo(String.class, value);\n                        Language simple = exchange.get().getContext().resolveLanguage(\"simple\");\n                        Expression exp = simple.createExpression(text);\n                        Object answer = exp.evaluate(exchange.get(), Object.class);\n                        return answer;\n                    }\n                }\n                return null;\n            }\n        };\n    }"
  },
  {
    "id": 3,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 59,
    "human_patch": "https://github.com/apache/camel/commit/1df559649a96a1ca0368373387e542f46e4820da",
    "cve_id": "CVE-2015-0264",
    "cwe_id": "Not Mapping",
    "filename": "camel-core/src/main/java/org/apache/camel/builder/xml/XPathBuilder.java",
    "is_vulnerable": 1,
    "class_name": "XPathBuilder",
    "subclass_name": null,
    "function_name": "evaluate(List list) throws XPathFunctionException",
    "function_body": "{\n                if (!list.isEmpty()) {\n                    Object value = list.get(0);\n                    if (value != null) {\n                        String text = exchange.get().getContext().getTypeConverter().convertTo(String.class, value);\n                        Language simple = exchange.get().getContext().resolveLanguage(\"simple\");\n                        Expression exp = simple.createExpression(text);\n                        Object answer = exp.evaluate(exchange.get(), Object.class);\n                        return answer;\n                    }\n                }\n                return null;\n            }"
  },
  {
    "id": 3,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 60,
    "human_patch": "https://github.com/apache/camel/commit/1df559649a96a1ca0368373387e542f46e4820da",
    "cve_id": "CVE-2015-0264",
    "cwe_id": "Not Mapping",
    "filename": "camel-core/src/main/java/org/apache/camel/builder/xml/XPathBuilder.java",
    "is_vulnerable": 0,
    "class_name": "XPathBuilder",
    "subclass_name": null,
    "function_name": "setSimpleFunction(XPathFunction simpleFunction)",
    "function_body": "{\n        this.simpleFunction = simpleFunction;\n    }"
  },
  {
    "id": 3,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 61,
    "human_patch": "https://github.com/apache/camel/commit/1df559649a96a1ca0368373387e542f46e4820da",
    "cve_id": "CVE-2015-0264",
    "cwe_id": "Not Mapping",
    "filename": "camel-core/src/main/java/org/apache/camel/builder/xml/XPathBuilder.java",
    "is_vulnerable": 0,
    "class_name": "XPathBuilder",
    "subclass_name": null,
    "function_name": "getResultType()",
    "function_body": "{\n        return resultType;\n    }"
  },
  {
    "id": 3,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 62,
    "human_patch": "https://github.com/apache/camel/commit/1df559649a96a1ca0368373387e542f46e4820da",
    "cve_id": "CVE-2015-0264",
    "cwe_id": "Not Mapping",
    "filename": "camel-core/src/main/java/org/apache/camel/builder/xml/XPathBuilder.java",
    "is_vulnerable": 0,
    "class_name": "XPathBuilder",
    "subclass_name": null,
    "function_name": "setResultType(Class<?> resultType)",
    "function_body": "{\n        this.resultType = resultType;\n        if (Number.class.isAssignableFrom(resultType)) {\n            numberResult();\n        } else if (String.class.isAssignableFrom(resultType)) {\n            stringResult();\n        } else if (Boolean.class.isAssignableFrom(resultType)) {\n            booleanResult();\n        } else if (Node.class.isAssignableFrom(resultType)) {\n            nodeResult();\n        } else if (NodeList.class.isAssignableFrom(resultType)) {\n            nodeSetResult();\n        }\n    }"
  },
  {
    "id": 3,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 63,
    "human_patch": "https://github.com/apache/camel/commit/1df559649a96a1ca0368373387e542f46e4820da",
    "cve_id": "CVE-2015-0264",
    "cwe_id": "Not Mapping",
    "filename": "camel-core/src/main/java/org/apache/camel/builder/xml/XPathBuilder.java",
    "is_vulnerable": 0,
    "class_name": "XPathBuilder",
    "subclass_name": null,
    "function_name": "setLogNamespaces(boolean logNamespaces)",
    "function_body": "{\n        this.logNamespaces = logNamespaces;\n    }"
  },
  {
    "id": 3,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 64,
    "human_patch": "https://github.com/apache/camel/commit/1df559649a96a1ca0368373387e542f46e4820da",
    "cve_id": "CVE-2015-0264",
    "cwe_id": "Not Mapping",
    "filename": "camel-core/src/main/java/org/apache/camel/builder/xml/XPathBuilder.java",
    "is_vulnerable": 0,
    "class_name": "XPathBuilder",
    "subclass_name": null,
    "function_name": "isLogNamespaces()",
    "function_body": "{\n        return logNamespaces;\n    }"
  },
  {
    "id": 3,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 65,
    "human_patch": "https://github.com/apache/camel/commit/1df559649a96a1ca0368373387e542f46e4820da",
    "cve_id": "CVE-2015-0264",
    "cwe_id": "Not Mapping",
    "filename": "camel-core/src/main/java/org/apache/camel/builder/xml/XPathBuilder.java",
    "is_vulnerable": 0,
    "class_name": "XPathBuilder",
    "subclass_name": null,
    "function_name": "getObjectModelUri()",
    "function_body": "{\n        return objectModelUri;\n    }"
  },
  {
    "id": 3,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 66,
    "human_patch": "https://github.com/apache/camel/commit/1df559649a96a1ca0368373387e542f46e4820da",
    "cve_id": "CVE-2015-0264",
    "cwe_id": "Not Mapping",
    "filename": "camel-core/src/main/java/org/apache/camel/builder/xml/XPathBuilder.java",
    "is_vulnerable": 0,
    "class_name": "XPathBuilder",
    "subclass_name": null,
    "function_name": "enableSaxon()",
    "function_body": "{\n        this.setObjectModelUri(SAXON_OBJECT_MODEL_URI);\n    }"
  },
  {
    "id": 3,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 67,
    "human_patch": "https://github.com/apache/camel/commit/1df559649a96a1ca0368373387e542f46e4820da",
    "cve_id": "CVE-2015-0264",
    "cwe_id": "Not Mapping",
    "filename": "camel-core/src/main/java/org/apache/camel/builder/xml/XPathBuilder.java",
    "is_vulnerable": 0,
    "class_name": "XPathBuilder",
    "subclass_name": null,
    "function_name": "setObjectModelUri(String objectModelUri)",
    "function_body": "{\n        this.objectModelUri = objectModelUri;\n    }"
  },
  {
    "id": 3,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 68,
    "human_patch": "https://github.com/apache/camel/commit/1df559649a96a1ca0368373387e542f46e4820da",
    "cve_id": "CVE-2015-0264",
    "cwe_id": "Not Mapping",
    "filename": "camel-core/src/main/java/org/apache/camel/builder/xml/XPathBuilder.java",
    "is_vulnerable": 0,
    "class_name": "XPathBuilder",
    "subclass_name": null,
    "function_name": "evaluate(Exchange exchange)",
    "function_body": "{\n        Object answer = evaluateAs(exchange, resultQName);\n        if (resultType != null) {\n            return ExchangeHelper.convertToType(exchange, resultType, answer);\n        }\n        return answer;\n    }"
  },
  {
    "id": 3,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 69,
    "human_patch": "https://github.com/apache/camel/commit/1df559649a96a1ca0368373387e542f46e4820da",
    "cve_id": "CVE-2015-0264",
    "cwe_id": "Not Mapping",
    "filename": "camel-core/src/main/java/org/apache/camel/builder/xml/XPathBuilder.java",
    "is_vulnerable": 0,
    "class_name": "XPathBuilder",
    "subclass_name": null,
    "function_name": "evaluateAs(Exchange exchange, QName resultQName)",
    "function_body": "{\n        \n        XPathExpression xpathExpression = pool.poll();\n        if (xpathExpression == null) {\n            LOG.trace(\"Creating new XPathExpression as none was available from pool\");\n            \n            try {\n                xpathExpression = createXPathExpression();\n            } catch (XPathExpressionException e) {\n                throw new InvalidXPathExpression(getText(), e);\n            } catch (Exception e) {\n                throw new RuntimeExpressionException(\"Cannot create xpath expression\", e);\n            }\n        } else {\n            LOG.trace(\"Acquired XPathExpression from pool\");\n        }\n        try {\n            if (logNamespaces && LOG.isInfoEnabled()) {\n                logNamespaces(exchange);\n            }\n            return doInEvaluateAs(xpathExpression, exchange, resultQName);\n        } finally {\n            \n            pool.add(xpathExpression);\n            LOG.trace(\"Released XPathExpression back to pool\");\n        }\n    }"
  },
  {
    "id": 3,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 70,
    "human_patch": "https://github.com/apache/camel/commit/1df559649a96a1ca0368373387e542f46e4820da",
    "cve_id": "CVE-2015-0264",
    "cwe_id": "Not Mapping",
    "filename": "camel-core/src/main/java/org/apache/camel/builder/xml/XPathBuilder.java",
    "is_vulnerable": 0,
    "class_name": "XPathBuilder",
    "subclass_name": null,
    "function_name": "logNamespaces(Exchange exchange)",
    "function_body": "{\n        InputStream is = null;\n        NodeList answer = null;\n        XPathExpression xpathExpression = null;\n\n        try {\n            xpathExpression = poolLogNamespaces.poll();\n            if (xpathExpression == null) {\n                xpathExpression = createTraceNamespaceExpression();\n            }\n\n            \n            Object document;\n            if (isInputStreamNeeded(exchange)) {\n                is = exchange.getIn().getBody(InputStream.class);\n                document = getDocument(exchange, is);\n            } else {\n                Object body = exchange.getIn().getBody();\n                document = getDocument(exchange, body);\n            }\n            \n            if (document instanceof InputSource) {\n                InputSource inputSource = (InputSource) document;\n                answer = (NodeList) xpathExpression.evaluate(inputSource, XPathConstants.NODESET);\n            } else if (document instanceof DOMSource) {\n                DOMSource source = (DOMSource) document;\n                answer = (NodeList) xpathExpression.evaluate(source.getNode(), XPathConstants.NODESET);\n            } else {\n                answer = (NodeList) xpathExpression.evaluate(document, XPathConstants.NODESET);\n            }\n        } catch (Exception e) {\n            LOG.warn(\"Unable to trace discovered namespaces in XPath expression\", e);\n        } finally {\n            \n            IOHelper.close(is);\n            poolLogNamespaces.add(xpathExpression);\n        }\n\n        if (answer != null) {\n            logDiscoveredNamespaces(answer);\n        }\n    }"
  },
  {
    "id": 3,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 71,
    "human_patch": "https://github.com/apache/camel/commit/1df559649a96a1ca0368373387e542f46e4820da",
    "cve_id": "CVE-2015-0264",
    "cwe_id": "Not Mapping",
    "filename": "camel-core/src/main/java/org/apache/camel/builder/xml/XPathBuilder.java",
    "is_vulnerable": 0,
    "class_name": "XPathBuilder",
    "subclass_name": null,
    "function_name": "logDiscoveredNamespaces(NodeList namespaces)",
    "function_body": "{\n        Map<String, HashSet<String>> map = new LinkedHashMap<String, HashSet<String>>();\n        for (int i = 0; i < namespaces.getLength(); i++) {\n            Node n = namespaces.item(i);\n            if (n.getNodeName().equals(\"xmlns:xml\")) {\n                \n                continue;\n            }\n\n            String prefix = namespaces.item(i).getNodeName();\n            if (prefix.equals(\"xmlns\")) {\n                prefix = \"DEFAULT\";\n            }\n\n            \n            if (!map.containsKey(prefix)) {\n                map.put(prefix, new HashSet<String>());\n            }\n            map.get(prefix).add(namespaces.item(i).getNodeValue());\n        }\n\n        LOG.info(\"Namespaces discovered in message: {}.\", map);\n    }"
  },
  {
    "id": 3,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 72,
    "human_patch": "https://github.com/apache/camel/commit/1df559649a96a1ca0368373387e542f46e4820da",
    "cve_id": "CVE-2015-0264",
    "cwe_id": "Not Mapping",
    "filename": "camel-core/src/main/java/org/apache/camel/builder/xml/XPathBuilder.java",
    "is_vulnerable": 0,
    "class_name": "XPathBuilder",
    "subclass_name": null,
    "function_name": "doInEvaluateAs(XPathExpression xpathExpression, Exchange exchange, QName resultQName)",
    "function_body": "{\n        LOG.trace(\"Evaluating exchange: {} as: {}\", exchange, resultQName);\n\n        Object answer;\n\n        \n        this.exchange.set(exchange);\n\n        \n        InputStream is = null;\n        try {\n            Object document;\n\n            \n            if (ObjectHelper.isNotEmpty(getHeaderName())) {\n                String headerName = getHeaderName();\n                \n                if (isInputStreamNeeded(exchange, headerName)) {\n                    is = exchange.getIn().getHeader(headerName, InputStream.class);\n                    document = getDocument(exchange, is);\n                } else {\n                    Object headerObject = exchange.getIn().getHeader(getHeaderName());\n                    document = getDocument(exchange, headerObject);\n                }\n            } else {\n                \n                if (isInputStreamNeeded(exchange)) {\n                    is = exchange.getIn().getBody(InputStream.class);\n                    document = getDocument(exchange, is);\n                } else {\n                    Object body = exchange.getIn().getBody();\n                    document = getDocument(exchange, body);\n                }\n            }\n\n            if (resultQName != null) {\n                if (document instanceof InputSource) {\n                    InputSource inputSource = (InputSource) document;\n                    answer = xpathExpression.evaluate(inputSource, resultQName);\n                } else if (document instanceof DOMSource) {\n                    DOMSource source = (DOMSource) document;\n                    answer = xpathExpression.evaluate(source.getNode(), resultQName);\n                } else {\n                    answer = xpathExpression.evaluate(document, resultQName);\n                }\n            } else {\n                if (document instanceof InputSource) {\n                    InputSource inputSource = (InputSource) document;\n                    answer = xpathExpression.evaluate(inputSource);\n                } else if (document instanceof DOMSource) {\n                    DOMSource source = (DOMSource) document;\n                    answer = xpathExpression.evaluate(source.getNode());\n                } else {\n                    answer = xpathExpression.evaluate(document);\n                }\n            }\n        } catch (XPathExpressionException e) {\n            String message = getText();\n            if (ObjectHelper.isNotEmpty(getHeaderName())) {\n                message = message + \" with headerName \" + getHeaderName();\n            }\n            throw new InvalidXPathExpression(message, e);\n        } finally {\n            \n            IOHelper.close(is);\n        }\n\n        if (LOG.isTraceEnabled()) {\n            LOG.trace(\"Done evaluating exchange: {} as: {} with result: {}\", new Object[]{exchange, resultQName, answer});\n        }\n        return answer;\n    }"
  },
  {
    "id": 3,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 73,
    "human_patch": "https://github.com/apache/camel/commit/1df559649a96a1ca0368373387e542f46e4820da",
    "cve_id": "CVE-2015-0264",
    "cwe_id": "Not Mapping",
    "filename": "camel-core/src/main/java/org/apache/camel/builder/xml/XPathBuilder.java",
    "is_vulnerable": 0,
    "class_name": "XPathBuilder",
    "subclass_name": null,
    "function_name": "createXPathExpression() throws XPathExpressionException, XPathFactoryConfigurationException",
    "function_body": "{\n        \n        try {\n            start();\n        } catch (Exception e) {\n            throw new RuntimeExpressionException(\"Error starting XPathBuilder\", e);\n        }\n\n        \n        XPath xPath = getXPathFactory().newXPath();\n\n        if (!logNamespaces && LOG.isTraceEnabled()) {\n            LOG.trace(\"Creating new XPath expression in pool. Namespaces on XPath expression: {}\", getNamespaceContext().toString());\n        } else if (logNamespaces && LOG.isInfoEnabled()) {\n            LOG.info(\"Creating new XPath expression in pool. Namespaces on XPath expression: {}\", getNamespaceContext().toString());\n        }\n        xPath.setNamespaceContext(getNamespaceContext());\n        xPath.setXPathVariableResolver(getVariableResolver());\n\n        XPathFunctionResolver parentResolver = getFunctionResolver();\n        if (parentResolver == null) {\n            parentResolver = xPath.getXPathFunctionResolver();\n        }\n        xPath.setXPathFunctionResolver(createDefaultFunctionResolver(parentResolver));\n        return xPath.compile(text);\n    }"
  },
  {
    "id": 3,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 74,
    "human_patch": "https://github.com/apache/camel/commit/1df559649a96a1ca0368373387e542f46e4820da",
    "cve_id": "CVE-2015-0264",
    "cwe_id": "Not Mapping",
    "filename": "camel-core/src/main/java/org/apache/camel/builder/xml/XPathBuilder.java",
    "is_vulnerable": 0,
    "class_name": "XPathBuilder",
    "subclass_name": null,
    "function_name": "createTraceNamespaceExpression() throws XPathFactoryConfigurationException, XPathExpressionException",
    "function_body": "{\n        \n        XPath xPath = getXPathFactory().newXPath();\n        return xPath.compile(OBTAIN_ALL_NS_XPATH);\n    }"
  },
  {
    "id": 3,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 75,
    "human_patch": "https://github.com/apache/camel/commit/1df559649a96a1ca0368373387e542f46e4820da",
    "cve_id": "CVE-2015-0264",
    "cwe_id": "Not Mapping",
    "filename": "camel-core/src/main/java/org/apache/camel/builder/xml/XPathBuilder.java",
    "is_vulnerable": 0,
    "class_name": "XPathBuilder",
    "subclass_name": null,
    "function_name": "createNamespaceContext(XPathFactory factory)",
    "function_body": "{\n        DefaultNamespaceContext context = new DefaultNamespaceContext(factory);\n        populateDefaultNamespaces(context);\n        return context;\n    }"
  },
  {
    "id": 3,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 76,
    "human_patch": "https://github.com/apache/camel/commit/1df559649a96a1ca0368373387e542f46e4820da",
    "cve_id": "CVE-2015-0264",
    "cwe_id": "Not Mapping",
    "filename": "camel-core/src/main/java/org/apache/camel/builder/xml/XPathBuilder.java",
    "is_vulnerable": 0,
    "class_name": "XPathBuilder",
    "subclass_name": null,
    "function_name": "populateDefaultNamespaces(DefaultNamespaceContext context)",
    "function_body": "{\n        setNamespaceIfNotPresent(context, \"in\", IN_NAMESPACE);\n        setNamespaceIfNotPresent(context, \"out\", OUT_NAMESPACE);\n        setNamespaceIfNotPresent(context, \"env\", Namespaces.ENVIRONMENT_VARIABLES);\n        setNamespaceIfNotPresent(context, \"system\", Namespaces.SYSTEM_PROPERTIES_NAMESPACE);\n        setNamespaceIfNotPresent(context, \"function\", Namespaces.FUNCTION_NAMESPACE);\n    }"
  },
  {
    "id": 3,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 77,
    "human_patch": "https://github.com/apache/camel/commit/1df559649a96a1ca0368373387e542f46e4820da",
    "cve_id": "CVE-2015-0264",
    "cwe_id": "Not Mapping",
    "filename": "camel-core/src/main/java/org/apache/camel/builder/xml/XPathBuilder.java",
    "is_vulnerable": 0,
    "class_name": "XPathBuilder",
    "subclass_name": null,
    "function_name": "setNamespaceIfNotPresent(DefaultNamespaceContext context, String prefix, String uri)",
    "function_body": "{\n        if (context != null) {\n            String current = context.getNamespaceURI(prefix);\n            if (current == null) {\n                context.add(prefix, uri);\n            }\n        }\n    }"
  },
  {
    "id": 3,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 78,
    "human_patch": "https://github.com/apache/camel/commit/1df559649a96a1ca0368373387e542f46e4820da",
    "cve_id": "CVE-2015-0264",
    "cwe_id": "Not Mapping",
    "filename": "camel-core/src/main/java/org/apache/camel/builder/xml/XPathBuilder.java",
    "is_vulnerable": 0,
    "class_name": "XPathBuilder",
    "subclass_name": null,
    "function_name": "createDefaultFunctionResolver(final XPathFunctionResolver parent)",
    "function_body": "{\n        return new XPathFunctionResolver() {\n            public XPathFunction resolveFunction(QName qName, int argumentCount) {\n                XPathFunction answer = null;\n                if (parent != null) {\n                    answer = parent.resolveFunction(qName, argumentCount);\n                }\n                if (answer == null) {\n                    if (isMatchingNamespaceOrEmptyNamespace(qName.getNamespaceURI(), IN_NAMESPACE)\n                            || isMatchingNamespaceOrEmptyNamespace(qName.getNamespaceURI(), DEFAULT_NAMESPACE)) {\n                        String localPart = qName.getLocalPart();\n                        if (localPart.equals(\"body\") && argumentCount == 0) {\n                            return getBodyFunction();\n                        }\n                        if (localPart.equals(\"header\") && argumentCount == 1) {\n                            return getHeaderFunction();\n                        }\n                    }\n                    if (isMatchingNamespaceOrEmptyNamespace(qName.getNamespaceURI(), OUT_NAMESPACE)) {\n                        String localPart = qName.getLocalPart();\n                        if (localPart.equals(\"body\") && argumentCount == 0) {\n                            return getOutBodyFunction();\n                        }\n                        if (localPart.equals(\"header\") && argumentCount == 1) {\n                            return getOutHeaderFunction();\n                        }\n                    }\n                    if (isMatchingNamespaceOrEmptyNamespace(qName.getNamespaceURI(), FUNCTION_NAMESPACE)) {\n                        String localPart = qName.getLocalPart();\n                        if (localPart.equals(\"properties\") && argumentCount == 1) {\n                            return getPropertiesFunction();\n                        }\n                        if (localPart.equals(\"simple\") && argumentCount == 1) {\n                            return getSimpleFunction();\n                        }\n                    }\n                }\n                return answer;\n            }\n        };\n    }"
  },
  {
    "id": 3,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 79,
    "human_patch": "https://github.com/apache/camel/commit/1df559649a96a1ca0368373387e542f46e4820da",
    "cve_id": "CVE-2015-0264",
    "cwe_id": "Not Mapping",
    "filename": "camel-core/src/main/java/org/apache/camel/builder/xml/XPathBuilder.java",
    "is_vulnerable": 0,
    "class_name": "XPathBuilder",
    "subclass_name": null,
    "function_name": "resolveFunction(QName qName, int argumentCount)",
    "function_body": "{\n                XPathFunction answer = null;\n                if (parent != null) {\n                    answer = parent.resolveFunction(qName, argumentCount);\n                }\n                if (answer == null) {\n                    if (isMatchingNamespaceOrEmptyNamespace(qName.getNamespaceURI(), IN_NAMESPACE)\n                            || isMatchingNamespaceOrEmptyNamespace(qName.getNamespaceURI(), DEFAULT_NAMESPACE)) {\n                        String localPart = qName.getLocalPart();\n                        if (localPart.equals(\"body\") && argumentCount == 0) {\n                            return getBodyFunction();\n                        }\n                        if (localPart.equals(\"header\") && argumentCount == 1) {\n                            return getHeaderFunction();\n                        }\n                    }\n                    if (isMatchingNamespaceOrEmptyNamespace(qName.getNamespaceURI(), OUT_NAMESPACE)) {\n                        String localPart = qName.getLocalPart();\n                        if (localPart.equals(\"body\") && argumentCount == 0) {\n                            return getOutBodyFunction();\n                        }\n                        if (localPart.equals(\"header\") && argumentCount == 1) {\n                            return getOutHeaderFunction();\n                        }\n                    }\n                    if (isMatchingNamespaceOrEmptyNamespace(qName.getNamespaceURI(), FUNCTION_NAMESPACE)) {\n                        String localPart = qName.getLocalPart();\n                        if (localPart.equals(\"properties\") && argumentCount == 1) {\n                            return getPropertiesFunction();\n                        }\n                        if (localPart.equals(\"simple\") && argumentCount == 1) {\n                            return getSimpleFunction();\n                        }\n                    }\n                }\n                return answer;\n            }"
  },
  {
    "id": 3,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 80,
    "human_patch": "https://github.com/apache/camel/commit/1df559649a96a1ca0368373387e542f46e4820da",
    "cve_id": "CVE-2015-0264",
    "cwe_id": "Not Mapping",
    "filename": "camel-core/src/main/java/org/apache/camel/builder/xml/XPathBuilder.java",
    "is_vulnerable": 0,
    "class_name": "XPathBuilder",
    "subclass_name": null,
    "function_name": "isInputStreamNeeded(Exchange exchange)",
    "function_body": "{\n        Object body = exchange.getIn().getBody();\n        return isInputStreamNeededForObject(exchange, body);\n    }"
  },
  {
    "id": 3,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 81,
    "human_patch": "https://github.com/apache/camel/commit/1df559649a96a1ca0368373387e542f46e4820da",
    "cve_id": "CVE-2015-0264",
    "cwe_id": "Not Mapping",
    "filename": "camel-core/src/main/java/org/apache/camel/builder/xml/XPathBuilder.java",
    "is_vulnerable": 0,
    "class_name": "XPathBuilder",
    "subclass_name": null,
    "function_name": "isInputStreamNeeded(Exchange exchange, String headerName)",
    "function_body": "{\n        Object header = exchange.getIn().getHeader(headerName);\n        return isInputStreamNeededForObject(exchange, header);\n    }"
  },
  {
    "id": 3,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 82,
    "human_patch": "https://github.com/apache/camel/commit/1df559649a96a1ca0368373387e542f46e4820da",
    "cve_id": "CVE-2015-0264",
    "cwe_id": "Not Mapping",
    "filename": "camel-core/src/main/java/org/apache/camel/builder/xml/XPathBuilder.java",
    "is_vulnerable": 0,
    "class_name": "XPathBuilder",
    "subclass_name": null,
    "function_name": "isInputStreamNeededForObject(Exchange exchange, Object obj)",
    "function_body": "{\n        if (obj == null) {\n            return false;\n        }\n\n        if (obj instanceof WrappedFile) {\n            obj = ((WrappedFile<?>) obj).getFile();\n        }\n        if (obj instanceof File) {\n            \n            return true;\n        }\n\n        \n        return false;\n    }"
  },
  {
    "id": 3,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 83,
    "human_patch": "https://github.com/apache/camel/commit/1df559649a96a1ca0368373387e542f46e4820da",
    "cve_id": "CVE-2015-0264",
    "cwe_id": "Not Mapping",
    "filename": "camel-core/src/main/java/org/apache/camel/builder/xml/XPathBuilder.java",
    "is_vulnerable": 0,
    "class_name": "XPathBuilder",
    "subclass_name": null,
    "function_name": "getDocument(Exchange exchange, Object body)",
    "function_body": "{\n        try {\n            return doGetDocument(exchange, body);\n        } catch (Exception e) {\n            throw ObjectHelper.wrapRuntimeCamelException(e);\n        } finally {\n            \n            MessageHelper.resetStreamCache(exchange.getIn());\n        }\n    }"
  },
  {
    "id": 3,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 84,
    "human_patch": "https://github.com/apache/camel/commit/1df559649a96a1ca0368373387e542f46e4820da",
    "cve_id": "CVE-2015-0264",
    "cwe_id": "Not Mapping",
    "filename": "camel-core/src/main/java/org/apache/camel/builder/xml/XPathBuilder.java",
    "is_vulnerable": 1,
    "class_name": "XPathBuilder",
    "subclass_name": null,
    "function_name": "doGetDocument(Exchange exchange, Object body) throws Exception",
    "function_body": "{\n        if (body == null) {\n            return null;\n        }\n\n        Object answer = null;\n\n        Class<?> type = getDocumentType();\n        Exception cause = null;\n        if (type != null) {\n            \n            try {\n                answer = exchange.getContext().getTypeConverter().convertTo(type, exchange, body);\n            } catch (Exception e) {\n                \n                cause = e;\n            }\n        }\n\n        \n        if (answer == null) {\n            \n            if (body instanceof WrappedFile) {\n                \n                InputStream is = exchange.getContext().getTypeConverter().convertTo(InputStream.class, exchange, body);\n                answer = new InputSource(is);\n            } else if (body instanceof BeanInvocation) {\n                \n                BeanInvocation bi = exchange.getContext().getTypeConverter().convertTo(BeanInvocation.class, exchange, body);\n                if (bi.getArgs() != null && bi.getArgs().length == 1 && bi.getArgs()[0] == null) {\n                    \n                    answer = null;\n                }\n            } else if (body instanceof String) {\n                answer = new InputSource(new StringReader((String) body));\n            }\n        }\n\n        if (type == null && answer == null) {\n            \n            answer = body;\n        } else if (answer == null) {\n            \n            if (cause != null) {\n                throw cause;\n            } else {\n                throw new NoTypeConversionAvailableException(body, type);\n            }\n        }\n\n        return answer;\n    }"
  },
  {
    "id": 3,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 85,
    "human_patch": "https://github.com/apache/camel/commit/1df559649a96a1ca0368373387e542f46e4820da",
    "cve_id": "CVE-2015-0264",
    "cwe_id": "Not Mapping",
    "filename": "camel-core/src/main/java/org/apache/camel/builder/xml/XPathBuilder.java",
    "is_vulnerable": 0,
    "class_name": "XPathBuilder",
    "subclass_name": null,
    "function_name": "getVariableResolver()",
    "function_body": "{\n        return variableResolver;\n    }"
  },
  {
    "id": 3,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 86,
    "human_patch": "https://github.com/apache/camel/commit/1df559649a96a1ca0368373387e542f46e4820da",
    "cve_id": "CVE-2015-0264",
    "cwe_id": "Not Mapping",
    "filename": "camel-core/src/main/java/org/apache/camel/builder/xml/XPathBuilder.java",
    "is_vulnerable": 0,
    "class_name": "XPathBuilder",
    "subclass_name": null,
    "function_name": "doStart() throws Exception",
    "function_body": "{\n        if (xpathFactory == null) {\n            xpathFactory = createXPathFactory();\n        }\n        if (namespaceContext == null) {\n            namespaceContext = createNamespaceContext(xpathFactory);\n        }\n        for (Map.Entry<String, String> entry : namespaces.entrySet()) {\n            namespaceContext.add(entry.getKey(), entry.getValue());\n        }\n\n        \n        if (bodyFunction == null) {\n            bodyFunction = createBodyFunction();\n        }\n        if (headerFunction == null) {\n            headerFunction = createHeaderFunction();\n        }\n        if (outBodyFunction == null) {\n            outBodyFunction = createOutBodyFunction();\n        }\n        if (outHeaderFunction == null) {\n            outHeaderFunction = createOutHeaderFunction();\n        }\n        if (propertiesFunction == null) {\n            propertiesFunction = createPropertiesFunction();\n        }\n        if (simpleFunction == null) {\n            simpleFunction = createSimpleFunction();\n        }\n    }"
  },
  {
    "id": 3,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 87,
    "human_patch": "https://github.com/apache/camel/commit/1df559649a96a1ca0368373387e542f46e4820da",
    "cve_id": "CVE-2015-0264",
    "cwe_id": "Not Mapping",
    "filename": "camel-core/src/main/java/org/apache/camel/builder/xml/XPathBuilder.java",
    "is_vulnerable": 0,
    "class_name": "XPathBuilder",
    "subclass_name": null,
    "function_name": "doStop() throws Exception",
    "function_body": "{\n        pool.clear();\n        poolLogNamespaces.clear();\n    }"
  },
  {
    "id": 3,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 88,
    "human_patch": "https://github.com/apache/camel/commit/1df559649a96a1ca0368373387e542f46e4820da",
    "cve_id": "CVE-2015-0264",
    "cwe_id": "Not Mapping",
    "filename": "camel-core/src/main/java/org/apache/camel/builder/xml/XPathBuilder.java",
    "is_vulnerable": 0,
    "class_name": "XPathBuilder",
    "subclass_name": null,
    "function_name": "createXPathFactory() throws XPathFactoryConfigurationException",
    "function_body": "{\n        if (objectModelUri != null) {\n            xpathFactory = XPathFactory.newInstance(objectModelUri);\n            LOG.info(\"Using objectModelUri \" + objectModelUri + \" when created XPathFactory {}\", xpathFactory);\n            return xpathFactory;\n        }\n\n        if (defaultXPathFactory == null) {\n            defaultXPathFactory = createDefaultXPathFactory();\n        }\n        return defaultXPathFactory;\n    }"
  },
  {
    "id": 3,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 89,
    "human_patch": "https://github.com/apache/camel/commit/1df559649a96a1ca0368373387e542f46e4820da",
    "cve_id": "CVE-2015-0264",
    "cwe_id": "Not Mapping",
    "filename": "camel-core/src/main/java/org/apache/camel/builder/xml/XPathBuilder.java",
    "is_vulnerable": 0,
    "class_name": "XPathBuilder",
    "subclass_name": null,
    "function_name": "createDefaultXPathFactory() throws XPathFactoryConfigurationException",
    "function_body": "{\n        XPathFactory factory = null;\n\n        \n        Properties properties = System.getProperties();\n        for (Map.Entry<Object, Object> prop : properties.entrySet()) {\n            String key = (String) prop.getKey();\n            if (key.startsWith(XPathFactory.DEFAULT_PROPERTY_NAME)) {\n                String uri = ObjectHelper.after(key, \":\");\n                if (uri != null) {\n                    factory = XPathFactory.newInstance(uri);\n                    LOG.info(\"Using system property {} with value {} when created default XPathFactory {}\", new Object[]{key, uri, factory});\n                }\n            }\n        }\n\n        if (factory == null) {\n            factory = XPathFactory.newInstance();\n            LOG.info(\"Created default XPathFactory {}\", factory);\n        }\n\n        return factory;\n    }"
  },
  {
    "id": 3,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 0,
    "human_patch": "https://github.com/apache/camel/commit/1df559649a96a1ca0368373387e542f46e4820da",
    "cve_id": "CVE-2015-0264",
    "cwe_id": "Not Mapping",
    "filename": "camel-core/src/test/java/org/apache/camel/builder/xml/XPathFeatureTest.java",
    "is_vulnerable": 0,
    "class_name": "XPathFeatureTest",
    "subclass_name": null,
    "function_name": "isUseRouteBuilder()",
    "function_body": "{\n        return false;\n    }"
  },
  {
    "id": 3,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 1,
    "human_patch": "https://github.com/apache/camel/commit/1df559649a96a1ca0368373387e542f46e4820da",
    "cve_id": "CVE-2015-0264",
    "cwe_id": "Not Mapping",
    "filename": "camel-core/src/test/java/org/apache/camel/builder/xml/XPathFeatureTest.java",
    "is_vulnerable": 0,
    "class_name": "XPathFeatureTest",
    "subclass_name": null,
    "function_name": "testXPathResult() throws Exception",
    "function_body": "{\n        String result = (String)xpath(\"/\").stringResult().evaluate(createExchange(XML_DATA));\n        assertEquals(\"Get a wrong result\", \"  \", result);\n    }"
  },
  {
    "id": 3,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 2,
    "human_patch": "https://github.com/apache/camel/commit/1df559649a96a1ca0368373387e542f46e4820da",
    "cve_id": "CVE-2015-0264",
    "cwe_id": "Not Mapping",
    "filename": "camel-core/src/test/java/org/apache/camel/builder/xml/XPathFeatureTest.java",
    "is_vulnerable": 1,
    "class_name": "XPathFeatureTest",
    "subclass_name": null,
    "function_name": "testXPath() throws Exception",
    "function_body": "{\n        \n        \n        System.setProperty(DOM_BUILER_FACTORY_FEATRUE + \":\" \n            + \"http://xml.org/sax/features/external-general-entities\", \"true\");\n        try {\n            xpath(\"/\").stringResult().evaluate(createExchange(XML_DATA));\n            fail(\"Expect an Exception here\");\n        } catch (Exception ex) {\n            assertTrue(\"Get a wrong exception cause.\", ex instanceof InvalidXPathExpression);\n            assertTrue(\"Get a wrong exception cause.\", ex.getCause() instanceof XPathExpressionException);\n            assertTrue(\"Get a wrong exception cause.\", ex.getCause().getCause() instanceof FileNotFoundException);\n        } finally {\n            System.clearProperty(DOM_BUILER_FACTORY_FEATRUE + \":\" \n                + \"http://xml.org/sax/features/external-general-entities\");\n        }\n    }"
  },
  {
    "id": 3,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 3,
    "human_patch": "https://github.com/apache/camel/commit/1df559649a96a1ca0368373387e542f46e4820da",
    "cve_id": "CVE-2015-0264",
    "cwe_id": "Not Mapping",
    "filename": "camel-core/src/test/java/org/apache/camel/builder/xml/XPathFeatureTest.java",
    "is_vulnerable": 0,
    "class_name": "XPathFeatureTest",
    "subclass_name": null,
    "function_name": "createExchange(Object xml)",
    "function_body": "{\n        Exchange exchange = createExchangeWithBody(context, xml);\n        return exchange;\n    }"
  },
  {
    "id": 3,
    "sub_id": 2,
    "code_id": 0,
    "function_id": 0,
    "human_patch": "https://github.com/apache/camel/commit/1df559649a96a1ca0368373387e542f46e4820da",
    "cve_id": "CVE-2015-0264",
    "cwe_id": "Not Mapping",
    "filename": "components/camel-saxon/src/test/java/org/apache/camel/component/xslt/SaxonXsltDTDTest.java",
    "is_vulnerable": 0,
    "class_name": "SaxonXsltDTDTest",
    "subclass_name": null,
    "function_name": "testSendingStringMessage() throws Exception",
    "function_body": "{\n        sendEntityMessage(MESSAGE);\n    }"
  },
  {
    "id": 3,
    "sub_id": 2,
    "code_id": 0,
    "function_id": 1,
    "human_patch": "https://github.com/apache/camel/commit/1df559649a96a1ca0368373387e542f46e4820da",
    "cve_id": "CVE-2015-0264",
    "cwe_id": "Not Mapping",
    "filename": "components/camel-saxon/src/test/java/org/apache/camel/component/xslt/SaxonXsltDTDTest.java",
    "is_vulnerable": 0,
    "class_name": "SaxonXsltDTDTest",
    "subclass_name": null,
    "function_name": "testSendingInputStreamMessage() throws Exception",
    "function_body": "{\n        InputStream is = IOConverter.toInputStream(MESSAGE, new DefaultExchange(context));\n        sendEntityMessage(is);   \n    }"
  },
  {
    "id": 3,
    "sub_id": 2,
    "code_id": 0,
    "function_id": 2,
    "human_patch": "https://github.com/apache/camel/commit/1df559649a96a1ca0368373387e542f46e4820da",
    "cve_id": "CVE-2015-0264",
    "cwe_id": "Not Mapping",
    "filename": "components/camel-saxon/src/test/java/org/apache/camel/component/xslt/SaxonXsltDTDTest.java",
    "is_vulnerable": 1,
    "class_name": "SaxonXsltDTDTest",
    "subclass_name": null,
    "function_name": "sendEntityMessage(Object message) throws Exception",
    "function_body": "{\n        \n        MockEndpoint endpoint = getMockEndpoint(\"mock:result\");\n        endpoint.reset();\n        endpoint.expectedMessageCount(1);\n        \n        template.sendBody(\"direct:start1\", message);\n\n        assertMockEndpointsSatisfied();\n        \n        List<Exchange> list = endpoint.getReceivedExchanges();\n        Exchange exchange = list.get(0);\n        String xml = exchange.getIn().getBody(String.class);\n        assertTrue(\"Get a wrong transformed message\", xml.indexOf(\"<transformed subject=\\\"\\\">\") > 0);\n        \n        \n        \n        try {\n            template.sendBody(\"direct:start2\", message);\n            fail(\"Expect an exception here\");\n        } catch (Exception ex) {\n            \n            assertTrue(\"Get a wrong exception\", ex instanceof CamelExecutionException);\n            \n            assertTrue(\"Get a wrong exception cause\", ex.getCause() instanceof TransformerException);\n        }\n        \n    }"
  },
  {
    "id": 3,
    "sub_id": 2,
    "code_id": 0,
    "function_id": 3,
    "human_patch": "https://github.com/apache/camel/commit/1df559649a96a1ca0368373387e542f46e4820da",
    "cve_id": "CVE-2015-0264",
    "cwe_id": "Not Mapping",
    "filename": "components/camel-saxon/src/test/java/org/apache/camel/component/xslt/SaxonXsltDTDTest.java",
    "is_vulnerable": 0,
    "class_name": "SaxonXsltDTDTest",
    "subclass_name": null,
    "function_name": "createRouteBuilder() throws Exception",
    "function_body": "{\n        return new RouteBuilder() {\n            @Override\n            public void configure() throws Exception {\n                \n                from(\"direct:start1\")\n                    .to(\"xslt:org/apache/camel/component/xslt/transform_dtd.xsl\")\n                    .to(\"mock:result\");\n                \n                from(\"direct:start2\")\n                    .to(\"xslt:org/apache/camel/component/xslt/transform_dtd.xsl?allowStAX=false\")\n                    .to(\"mock:result\");\n            }\n        };\n    }"
  },
  {
    "id": 3,
    "sub_id": 2,
    "code_id": 0,
    "function_id": 4,
    "human_patch": "https://github.com/apache/camel/commit/1df559649a96a1ca0368373387e542f46e4820da",
    "cve_id": "CVE-2015-0264",
    "cwe_id": "Not Mapping",
    "filename": "components/camel-saxon/src/test/java/org/apache/camel/component/xslt/SaxonXsltDTDTest.java",
    "is_vulnerable": 0,
    "class_name": "SaxonXsltDTDTest",
    "subclass_name": null,
    "function_name": "configure() throws Exception",
    "function_body": "{\n                \n                from(\"direct:start1\")\n                    .to(\"xslt:org/apache/camel/component/xslt/transform_dtd.xsl\")\n                    .to(\"mock:result\");\n                \n                from(\"direct:start2\")\n                    .to(\"xslt:org/apache/camel/component/xslt/transform_dtd.xsl?allowStAX=false\")\n                    .to(\"mock:result\");\n            }"
  },
  {
    "id": 4,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 0,
    "human_patch": "https://github.com/apache/commons-compress/commit/a080293da69f3fe3d11d5214432e1469ee195870",
    "cve_id": "APACHE-COMMONS-001",
    "cwe_id": "Not Mapping",
    "filename": "src/main/java/org/apache/commons/compress/archivers/examples/Expander.java",
    "is_vulnerable": 0,
    "class_name": "Expander",
    "subclass_name": "ArchiveEntrySupplier",
    "function_name": "getNextReadableEntry() throws IOException",
    "function_body": null
  },
  {
    "id": 4,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 1,
    "human_patch": "https://github.com/apache/commons-compress/commit/a080293da69f3fe3d11d5214432e1469ee195870",
    "cve_id": "APACHE-COMMONS-001",
    "cwe_id": "Not Mapping",
    "filename": "src/main/java/org/apache/commons/compress/archivers/examples/Expander.java",
    "is_vulnerable": 0,
    "class_name": "Expander",
    "subclass_name": "EntryWriter",
    "function_name": "writeEntryDataTo(ArchiveEntry entry, OutputStream out) throws IOException",
    "function_body": null
  },
  {
    "id": 4,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 2,
    "human_patch": "https://github.com/apache/commons-compress/commit/a080293da69f3fe3d11d5214432e1469ee195870",
    "cve_id": "APACHE-COMMONS-001",
    "cwe_id": "Not Mapping",
    "filename": "src/main/java/org/apache/commons/compress/archivers/examples/Expander.java",
    "is_vulnerable": 0,
    "class_name": "Expander",
    "subclass_name": null,
    "function_name": "expand(File archive, File targetDirectory) throws IOException, ArchiveException",
    "function_body": "{\n        String format = null;\n        try (InputStream i = new BufferedInputStream(Files.newInputStream(archive.toPath()))) {\n            format = new ArchiveStreamFactory().detect(i);\n        }\n        expand(format, archive, targetDirectory);\n    }"
  },
  {
    "id": 4,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 3,
    "human_patch": "https://github.com/apache/commons-compress/commit/a080293da69f3fe3d11d5214432e1469ee195870",
    "cve_id": "APACHE-COMMONS-001",
    "cwe_id": "Not Mapping",
    "filename": "src/main/java/org/apache/commons/compress/archivers/examples/Expander.java",
    "is_vulnerable": 0,
    "class_name": "Expander",
    "subclass_name": null,
    "function_name": "expand(String format, File archive, File targetDirectory) throws IOException, ArchiveException",
    "function_body": "{\n        if (prefersSeekableByteChannel(format)) {\n            try (SeekableByteChannel c = FileChannel.open(archive.toPath(), StandardOpenOption.READ)) {\n                expand(format, c, targetDirectory);\n            }\n            return;\n        }\n        try (InputStream i = new BufferedInputStream(Files.newInputStream(archive.toPath()))) {\n            expand(format, i, targetDirectory);\n        }\n    }"
  },
  {
    "id": 4,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 4,
    "human_patch": "https://github.com/apache/commons-compress/commit/a080293da69f3fe3d11d5214432e1469ee195870",
    "cve_id": "APACHE-COMMONS-001",
    "cwe_id": "Not Mapping",
    "filename": "src/main/java/org/apache/commons/compress/archivers/examples/Expander.java",
    "is_vulnerable": 0,
    "class_name": "Expander",
    "subclass_name": null,
    "function_name": "expand(InputStream archive, File targetDirectory) throws IOException, ArchiveException",
    "function_body": "{\n        expand(new ArchiveStreamFactory().createArchiveInputStream(archive), targetDirectory);\n    }"
  },
  {
    "id": 4,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 5,
    "human_patch": "https://github.com/apache/commons-compress/commit/a080293da69f3fe3d11d5214432e1469ee195870",
    "cve_id": "APACHE-COMMONS-001",
    "cwe_id": "Not Mapping",
    "filename": "src/main/java/org/apache/commons/compress/archivers/examples/Expander.java",
    "is_vulnerable": 0,
    "class_name": "Expander",
    "subclass_name": null,
    "function_name": "expand(String format, InputStream archive, File targetDirectory) throws IOException, ArchiveException",
    "function_body": "{\n        expand(new ArchiveStreamFactory().createArchiveInputStream(format, archive), targetDirectory);\n    }"
  },
  {
    "id": 4,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 6,
    "human_patch": "https://github.com/apache/commons-compress/commit/a080293da69f3fe3d11d5214432e1469ee195870",
    "cve_id": "APACHE-COMMONS-001",
    "cwe_id": "Not Mapping",
    "filename": "src/main/java/org/apache/commons/compress/archivers/examples/Expander.java",
    "is_vulnerable": 0,
    "class_name": "Expander",
    "subclass_name": null,
    "function_name": "expand(String format, SeekableByteChannel archive, File targetDirectory) throws IOException, ArchiveException",
    "function_body": "{\n        if (!prefersSeekableByteChannel(format)) {\n            expand(format, Channels.newInputStream(archive), targetDirectory);\n        } else if (ArchiveStreamFactory.ZIP.equalsIgnoreCase(format)) {\n            expand(new ZipFile(archive), targetDirectory);\n        } else if (ArchiveStreamFactory.SEVEN_Z.equalsIgnoreCase(format)) {\n            expand(new SevenZFile(archive), targetDirectory);\n        } else {\n            \n            throw new ArchiveException(\"don't know how to handle format \" + format);\n        }\n    }"
  },
  {
    "id": 4,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 7,
    "human_patch": "https://github.com/apache/commons-compress/commit/a080293da69f3fe3d11d5214432e1469ee195870",
    "cve_id": "APACHE-COMMONS-001",
    "cwe_id": "Not Mapping",
    "filename": "src/main/java/org/apache/commons/compress/archivers/examples/Expander.java",
    "is_vulnerable": 0,
    "class_name": "Expander",
    "subclass_name": null,
    "function_name": "expand(final ArchiveInputStream archive, File targetDirectory) throws IOException, ArchiveException",
    "function_body": "{\n        expand(new ArchiveEntrySupplier() {\n            @Override\n            public ArchiveEntry getNextReadableEntry() throws IOException {\n                ArchiveEntry next = archive.getNextEntry();\n                while (next != null && !archive.canReadEntryData(next)) {\n                    next = archive.getNextEntry();\n                }\n                return next;\n            }\n        }, new EntryWriter() {\n            @Override\n            public void writeEntryDataTo(ArchiveEntry entry, OutputStream out) throws IOException {\n                IOUtils.copy(archive, out);\n            }\n        }, targetDirectory);\n    }"
  },
  {
    "id": 4,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 8,
    "human_patch": "https://github.com/apache/commons-compress/commit/a080293da69f3fe3d11d5214432e1469ee195870",
    "cve_id": "APACHE-COMMONS-001",
    "cwe_id": "Not Mapping",
    "filename": "src/main/java/org/apache/commons/compress/archivers/examples/Expander.java",
    "is_vulnerable": 0,
    "class_name": "Expander",
    "subclass_name": null,
    "function_name": "getNextReadableEntry() throws IOException",
    "function_body": "{\n                ArchiveEntry next = archive.getNextEntry();\n                while (next != null && !archive.canReadEntryData(next)) {\n                    next = archive.getNextEntry();\n                }\n                return next;\n            }"
  },
  {
    "id": 4,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 9,
    "human_patch": "https://github.com/apache/commons-compress/commit/a080293da69f3fe3d11d5214432e1469ee195870",
    "cve_id": "APACHE-COMMONS-001",
    "cwe_id": "Not Mapping",
    "filename": "src/main/java/org/apache/commons/compress/archivers/examples/Expander.java",
    "is_vulnerable": 0,
    "class_name": "Expander",
    "subclass_name": null,
    "function_name": "writeEntryDataTo(ArchiveEntry entry, OutputStream out) throws IOException",
    "function_body": "{\n                IOUtils.copy(archive, out);\n            }"
  },
  {
    "id": 4,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 10,
    "human_patch": "https://github.com/apache/commons-compress/commit/a080293da69f3fe3d11d5214432e1469ee195870",
    "cve_id": "APACHE-COMMONS-001",
    "cwe_id": "Not Mapping",
    "filename": "src/main/java/org/apache/commons/compress/archivers/examples/Expander.java",
    "is_vulnerable": 0,
    "class_name": "Expander",
    "subclass_name": null,
    "function_name": "expand(final ZipFile archive, File targetDirectory) throws IOException, ArchiveException",
    "function_body": "{\n        final Enumeration<ZipArchiveEntry> entries = archive.getEntries();\n        expand(new ArchiveEntrySupplier() {\n            @Override\n            public ArchiveEntry getNextReadableEntry() throws IOException {\n                ZipArchiveEntry next = entries.hasMoreElements() ? entries.nextElement() : null;\n                while (next != null && !archive.canReadEntryData(next)) {\n                    next = entries.hasMoreElements() ? entries.nextElement() : null;\n                }\n                return next;\n            }\n        }, new EntryWriter() {\n            @Override\n            public void writeEntryDataTo(ArchiveEntry entry, OutputStream out) throws IOException {\n                try (InputStream in = archive.getInputStream((ZipArchiveEntry) entry)) {\n                    IOUtils.copy(in, out);\n                }\n            }\n        }, targetDirectory);\n    }"
  },
  {
    "id": 4,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 11,
    "human_patch": "https://github.com/apache/commons-compress/commit/a080293da69f3fe3d11d5214432e1469ee195870",
    "cve_id": "APACHE-COMMONS-001",
    "cwe_id": "Not Mapping",
    "filename": "src/main/java/org/apache/commons/compress/archivers/examples/Expander.java",
    "is_vulnerable": 1,
    "class_name": "Expander",
    "subclass_name": null,
    "function_name": "getNextReadableEntry() throws IOException",
    "function_body": "{\n                ZipArchiveEntry next = entries.hasMoreElements() ? entries.nextElement() : null;\n                while (next != null && !archive.canReadEntryData(next)) {\n                    next = entries.hasMoreElements() ? entries.nextElement() : null;\n                }\n                return next;\n            }"
  },
  {
    "id": 4,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 12,
    "human_patch": "https://github.com/apache/commons-compress/commit/a080293da69f3fe3d11d5214432e1469ee195870",
    "cve_id": "APACHE-COMMONS-001",
    "cwe_id": "Not Mapping",
    "filename": "src/main/java/org/apache/commons/compress/archivers/examples/Expander.java",
    "is_vulnerable": 1,
    "class_name": "Expander",
    "subclass_name": null,
    "function_name": "writeEntryDataTo(ArchiveEntry entry, OutputStream out) throws IOException",
    "function_body": "{\n                try (InputStream in = archive.getInputStream((ZipArchiveEntry) entry)) {\n                    IOUtils.copy(in, out);\n                }\n            }"
  },
  {
    "id": 4,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 13,
    "human_patch": "https://github.com/apache/commons-compress/commit/a080293da69f3fe3d11d5214432e1469ee195870",
    "cve_id": "APACHE-COMMONS-001",
    "cwe_id": "Not Mapping",
    "filename": "src/main/java/org/apache/commons/compress/archivers/examples/Expander.java",
    "is_vulnerable": 0,
    "class_name": "Expander",
    "subclass_name": null,
    "function_name": "expand(final SevenZFile archive, File targetDirectory) throws IOException, ArchiveException",
    "function_body": "{\n        expand(new ArchiveEntrySupplier() {\n            @Override\n            public ArchiveEntry getNextReadableEntry() throws IOException {\n                return archive.getNextEntry();\n            }\n        }, new EntryWriter() {\n            @Override\n            public void writeEntryDataTo(ArchiveEntry entry, OutputStream out) throws IOException {\n                final byte[] buffer = new byte[8024];\n                int n = 0;\n                long count = 0;\n                while (-1 != (n = archive.read(buffer))) {\n                    out.write(buffer, 0, n);\n                    count += n;\n                }\n            }\n        }, targetDirectory);\n    }"
  },
  {
    "id": 4,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 14,
    "human_patch": "https://github.com/apache/commons-compress/commit/a080293da69f3fe3d11d5214432e1469ee195870",
    "cve_id": "APACHE-COMMONS-001",
    "cwe_id": "Not Mapping",
    "filename": "src/main/java/org/apache/commons/compress/archivers/examples/Expander.java",
    "is_vulnerable": 1,
    "class_name": "Expander",
    "subclass_name": null,
    "function_name": "getNextReadableEntry() throws IOException",
    "function_body": "{\n                return archive.getNextEntry();\n            }"
  },
  {
    "id": 4,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 15,
    "human_patch": "https://github.com/apache/commons-compress/commit/a080293da69f3fe3d11d5214432e1469ee195870",
    "cve_id": "APACHE-COMMONS-001",
    "cwe_id": "Not Mapping",
    "filename": "src/main/java/org/apache/commons/compress/archivers/examples/Expander.java",
    "is_vulnerable": 1,
    "class_name": "Expander",
    "subclass_name": null,
    "function_name": "writeEntryDataTo(ArchiveEntry entry, OutputStream out) throws IOException",
    "function_body": "{\n                final byte[] buffer = new byte[8024];\n                int n = 0;\n                long count = 0;\n                while (-1 != (n = archive.read(buffer))) {\n                    out.write(buffer, 0, n);\n                    count += n;\n                }\n            }"
  },
  {
    "id": 4,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 16,
    "human_patch": "https://github.com/apache/commons-compress/commit/a080293da69f3fe3d11d5214432e1469ee195870",
    "cve_id": "APACHE-COMMONS-001",
    "cwe_id": "Not Mapping",
    "filename": "src/main/java/org/apache/commons/compress/archivers/examples/Expander.java",
    "is_vulnerable": 0,
    "class_name": "Expander",
    "subclass_name": null,
    "function_name": "prefersSeekableByteChannel(String format)",
    "function_body": "{\n        return ArchiveStreamFactory.ZIP.equalsIgnoreCase(format) || ArchiveStreamFactory.SEVEN_Z.equalsIgnoreCase(format);\n    }"
  },
  {
    "id": 4,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 17,
    "human_patch": "https://github.com/apache/commons-compress/commit/a080293da69f3fe3d11d5214432e1469ee195870",
    "cve_id": "APACHE-COMMONS-001",
    "cwe_id": "Not Mapping",
    "filename": "src/main/java/org/apache/commons/compress/archivers/examples/Expander.java",
    "is_vulnerable": 1,
    "class_name": "Expander",
    "subclass_name": null,
    "function_name": "expand(ArchiveEntrySupplier supplier, EntryWriter writer, File targetDirectory) throws IOException",
    "function_body": "{\n        String targetDirPath = targetDirectory.getCanonicalPath();\n        ArchiveEntry nextEntry = supplier.getNextReadableEntry();\n        while (nextEntry != null) {\n            File f = new File(targetDirectory, nextEntry.getName());\n            if (!f.getCanonicalPath().startsWith(targetDirPath)) {\n                throw new IOException(\"expanding \" + nextEntry.getName()\n                    + \" would create file outside of \" + targetDirectory);\n            }\n            if (nextEntry.isDirectory()) {\n                if (!f.isDirectory() && !f.mkdirs()) {\n                    throw new IOException(\"failed to create directory \" + f);\n                }\n            } else {\n                File parent = f.getParentFile();\n                if (!parent.isDirectory() && !parent.mkdirs()) {\n                    throw new IOException(\"failed to create directory \" + parent);\n                }\n                try (OutputStream o = Files.newOutputStream(f.toPath())) {\n                    writer.writeEntryDataTo(nextEntry, o);\n                }\n            }\n            nextEntry = supplier.getNextReadableEntry();\n        }\n    }"
  },
  {
    "id": 4,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 0,
    "human_patch": "https://github.com/apache/commons-compress/commit/a080293da69f3fe3d11d5214432e1469ee195870",
    "cve_id": "APACHE-COMMONS-001",
    "cwe_id": "Not Mapping",
    "filename": "src/test/java/org/apache/commons/compress/archivers/examples/ExpanderTest.java",
    "is_vulnerable": 0,
    "class_name": "ExpanderTest",
    "subclass_name": null,
    "function_name": "sevenZTwoFileVersion() throws IOException, ArchiveException",
    "function_body": "{\n        setup7z();\n        new Expander().expand(\"7z\", archive, resultDir);\n        verifyTargetDir();\n    }"
  },
  {
    "id": 4,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 1,
    "human_patch": "https://github.com/apache/commons-compress/commit/a080293da69f3fe3d11d5214432e1469ee195870",
    "cve_id": "APACHE-COMMONS-001",
    "cwe_id": "Not Mapping",
    "filename": "src/test/java/org/apache/commons/compress/archivers/examples/ExpanderTest.java",
    "is_vulnerable": 0,
    "class_name": "ExpanderTest",
    "subclass_name": null,
    "function_name": "sevenZTwoFileVersionWithAutoDetection() throws IOException, ArchiveException",
    "function_body": "{\n        setup7z();\n        new Expander().expand(archive, resultDir);\n        verifyTargetDir();\n    }"
  },
  {
    "id": 4,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 2,
    "human_patch": "https://github.com/apache/commons-compress/commit/a080293da69f3fe3d11d5214432e1469ee195870",
    "cve_id": "APACHE-COMMONS-001",
    "cwe_id": "Not Mapping",
    "filename": "src/test/java/org/apache/commons/compress/archivers/examples/ExpanderTest.java",
    "is_vulnerable": 0,
    "class_name": "ExpanderTest",
    "subclass_name": null,
    "function_name": "sevenZInputStreamVersion() throws IOException, ArchiveException",
    "function_body": "{\n        setup7z();\n        try (InputStream i = new BufferedInputStream(Files.newInputStream(archive.toPath()))) {\n            new Expander().expand(\"7z\", i, resultDir);\n        }\n    }"
  },
  {
    "id": 4,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 3,
    "human_patch": "https://github.com/apache/commons-compress/commit/a080293da69f3fe3d11d5214432e1469ee195870",
    "cve_id": "APACHE-COMMONS-001",
    "cwe_id": "Not Mapping",
    "filename": "src/test/java/org/apache/commons/compress/archivers/examples/ExpanderTest.java",
    "is_vulnerable": 0,
    "class_name": "ExpanderTest",
    "subclass_name": null,
    "function_name": "sevenZInputStreamVersionWithAutoDetection() throws IOException, ArchiveException",
    "function_body": "{\n        setup7z();\n        try (InputStream i = new BufferedInputStream(Files.newInputStream(archive.toPath()))) {\n            new Expander().expand(i, resultDir);\n        }\n    }"
  },
  {
    "id": 4,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 4,
    "human_patch": "https://github.com/apache/commons-compress/commit/a080293da69f3fe3d11d5214432e1469ee195870",
    "cve_id": "APACHE-COMMONS-001",
    "cwe_id": "Not Mapping",
    "filename": "src/test/java/org/apache/commons/compress/archivers/examples/ExpanderTest.java",
    "is_vulnerable": 0,
    "class_name": "ExpanderTest",
    "subclass_name": null,
    "function_name": "sevenZChannelVersion() throws IOException, ArchiveException",
    "function_body": "{\n        setup7z();\n        try (SeekableByteChannel c = FileChannel.open(archive.toPath(), StandardOpenOption.READ)) {\n            new Expander().expand(\"7z\", c, resultDir);\n        }\n        verifyTargetDir();\n    }"
  },
  {
    "id": 4,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 5,
    "human_patch": "https://github.com/apache/commons-compress/commit/a080293da69f3fe3d11d5214432e1469ee195870",
    "cve_id": "APACHE-COMMONS-001",
    "cwe_id": "Not Mapping",
    "filename": "src/test/java/org/apache/commons/compress/archivers/examples/ExpanderTest.java",
    "is_vulnerable": 0,
    "class_name": "ExpanderTest",
    "subclass_name": null,
    "function_name": "sevenZFileVersion() throws IOException, ArchiveException",
    "function_body": "{\n        setup7z();\n        try (SevenZFile f = new SevenZFile(archive)) {\n            new Expander().expand(f, resultDir);\n        }\n        verifyTargetDir();\n    }"
  },
  {
    "id": 4,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 6,
    "human_patch": "https://github.com/apache/commons-compress/commit/a080293da69f3fe3d11d5214432e1469ee195870",
    "cve_id": "APACHE-COMMONS-001",
    "cwe_id": "Not Mapping",
    "filename": "src/test/java/org/apache/commons/compress/archivers/examples/ExpanderTest.java",
    "is_vulnerable": 0,
    "class_name": "ExpanderTest",
    "subclass_name": null,
    "function_name": "zipFileVersion() throws IOException, ArchiveException",
    "function_body": "{\n        setupZip();\n        try (ZipFile f = new ZipFile(archive)) {\n            new Expander().expand(f, resultDir);\n        }\n        verifyTargetDir();\n    }"
  },
  {
    "id": 4,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 7,
    "human_patch": "https://github.com/apache/commons-compress/commit/a080293da69f3fe3d11d5214432e1469ee195870",
    "cve_id": "APACHE-COMMONS-001",
    "cwe_id": "Not Mapping",
    "filename": "src/test/java/org/apache/commons/compress/archivers/examples/ExpanderTest.java",
    "is_vulnerable": 0,
    "class_name": "ExpanderTest",
    "subclass_name": null,
    "function_name": "fileCantEscapeViaAbsolutePath() throws IOException, ArchiveException",
    "function_body": "{\n        setupZip(\"/tmp/foo\");\n        try (ZipFile f = new ZipFile(archive)) {\n            new Expander().expand(f, resultDir);\n        }\n        assertHelloWorld(\"tmp/foo\", \"1\");\n    }"
  },
  {
    "id": 4,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 8,
    "human_patch": "https://github.com/apache/commons-compress/commit/a080293da69f3fe3d11d5214432e1469ee195870",
    "cve_id": "APACHE-COMMONS-001",
    "cwe_id": "Not Mapping",
    "filename": "src/test/java/org/apache/commons/compress/archivers/examples/ExpanderTest.java",
    "is_vulnerable": 0,
    "class_name": "ExpanderTest",
    "subclass_name": null,
    "function_name": "fileCantEscapeDoubleDotPath() throws IOException, ArchiveException",
    "function_body": "{\n        thrown.expect(IOException.class);\n        thrown.expectMessage(\"expanding ../foo would create file outside of\");\n        setupZip(\"../foo\");\n        try (ZipFile f = new ZipFile(archive)) {\n            new Expander().expand(f, resultDir);\n        }\n    }"
  },
  {
    "id": 4,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 9,
    "human_patch": "https://github.com/apache/commons-compress/commit/a080293da69f3fe3d11d5214432e1469ee195870",
    "cve_id": "APACHE-COMMONS-001",
    "cwe_id": "Not Mapping",
    "filename": "src/test/java/org/apache/commons/compress/archivers/examples/ExpanderTest.java",
    "is_vulnerable": 0,
    "class_name": "ExpanderTest",
    "subclass_name": null,
    "function_name": "setup7z() throws IOException, ArchiveException",
    "function_body": "{\n        archive = new File(dir, \"test.7z\");\n        File dummy = new File(dir, \"x\");\n        try (OutputStream o = Files.newOutputStream(dummy.toPath())) {\n            o.write(new byte[14]);\n        }\n        try (SevenZOutputFile aos = new SevenZOutputFile(archive)) {\n            aos.putArchiveEntry(aos.createArchiveEntry(dir, \"a\"));\n            aos.closeArchiveEntry();\n            aos.putArchiveEntry(aos.createArchiveEntry(dir, \"a/b\"));\n            aos.closeArchiveEntry();\n            aos.putArchiveEntry(aos.createArchiveEntry(dir, \"a/b/c\"));\n            aos.closeArchiveEntry();\n            aos.putArchiveEntry(aos.createArchiveEntry(dummy, \"a/b/d.txt\"));\n            aos.write(\"Hello, world 1\".getBytes(StandardCharsets.UTF_8));\n            aos.closeArchiveEntry();\n            aos.putArchiveEntry(aos.createArchiveEntry(dummy, \"a/b/c/e.txt\"));\n            aos.write(\"Hello, world 2\".getBytes(StandardCharsets.UTF_8));\n            aos.closeArchiveEntry();\n            aos.finish();\n        }\n    }"
  },
  {
    "id": 4,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 10,
    "human_patch": "https://github.com/apache/commons-compress/commit/a080293da69f3fe3d11d5214432e1469ee195870",
    "cve_id": "APACHE-COMMONS-001",
    "cwe_id": "Not Mapping",
    "filename": "src/test/java/org/apache/commons/compress/archivers/examples/ExpanderTest.java",
    "is_vulnerable": 0,
    "class_name": "ExpanderTest",
    "subclass_name": null,
    "function_name": "setupZip() throws IOException, ArchiveException",
    "function_body": "{\n        archive = new File(dir, \"test.zip\");\n        File dummy = new File(dir, \"x\");\n        try (OutputStream o = Files.newOutputStream(dummy.toPath())) {\n            o.write(new byte[14]);\n        }\n        try (ArchiveOutputStream aos = new ArchiveStreamFactory()\n             .createArchiveOutputStream(\"zip\", Files.newOutputStream(archive.toPath()))) {\n            aos.putArchiveEntry(aos.createArchiveEntry(dir, \"a\"));\n            aos.closeArchiveEntry();\n            aos.putArchiveEntry(aos.createArchiveEntry(dir, \"a/b\"));\n            aos.closeArchiveEntry();\n            aos.putArchiveEntry(aos.createArchiveEntry(dir, \"a/b/c\"));\n            aos.closeArchiveEntry();\n            aos.putArchiveEntry(aos.createArchiveEntry(dummy, \"a/b/d.txt\"));\n            aos.write(\"Hello, world 1\".getBytes(StandardCharsets.UTF_8));\n            aos.closeArchiveEntry();\n            aos.putArchiveEntry(aos.createArchiveEntry(dummy, \"a/b/c/e.txt\"));\n            aos.write(\"Hello, world 2\".getBytes(StandardCharsets.UTF_8));\n            aos.closeArchiveEntry();\n            aos.finish();\n        }\n    }"
  },
  {
    "id": 4,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 11,
    "human_patch": "https://github.com/apache/commons-compress/commit/a080293da69f3fe3d11d5214432e1469ee195870",
    "cve_id": "APACHE-COMMONS-001",
    "cwe_id": "Not Mapping",
    "filename": "src/test/java/org/apache/commons/compress/archivers/examples/ExpanderTest.java",
    "is_vulnerable": 0,
    "class_name": "ExpanderTest",
    "subclass_name": null,
    "function_name": "setupZip(String entry) throws IOException, ArchiveException",
    "function_body": "{\n        archive = new File(dir, \"test.zip\");\n        File dummy = new File(dir, \"x\");\n        try (OutputStream o = Files.newOutputStream(dummy.toPath())) {\n            o.write(new byte[14]);\n        }\n        try (ArchiveOutputStream aos = new ArchiveStreamFactory()\n             .createArchiveOutputStream(\"zip\", Files.newOutputStream(archive.toPath()))) {\n            aos.putArchiveEntry(aos.createArchiveEntry(dummy, entry));\n            aos.write(\"Hello, world 1\".getBytes(StandardCharsets.UTF_8));\n            aos.closeArchiveEntry();\n            aos.finish();\n        }\n    }"
  },
  {
    "id": 4,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 12,
    "human_patch": "https://github.com/apache/commons-compress/commit/a080293da69f3fe3d11d5214432e1469ee195870",
    "cve_id": "APACHE-COMMONS-001",
    "cwe_id": "Not Mapping",
    "filename": "src/test/java/org/apache/commons/compress/archivers/examples/ExpanderTest.java",
    "is_vulnerable": 0,
    "class_name": "ExpanderTest",
    "subclass_name": null,
    "function_name": "verifyTargetDir() throws IOException",
    "function_body": "{\n        Assert.assertTrue(\"a has not been created\", new File(resultDir, \"a\").isDirectory());\n        Assert.assertTrue(\"a/b has not been created\", new File(resultDir, \"a/b\").isDirectory());\n        Assert.assertTrue(\"a/b/c has not been created\", new File(resultDir, \"a/b/c\").isDirectory());\n        assertHelloWorld(\"a/b/d.txt\", \"1\");\n        assertHelloWorld(\"a/b/c/e.txt\", \"2\");\n    }"
  },
  {
    "id": 4,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 13,
    "human_patch": "https://github.com/apache/commons-compress/commit/a080293da69f3fe3d11d5214432e1469ee195870",
    "cve_id": "APACHE-COMMONS-001",
    "cwe_id": "Not Mapping",
    "filename": "src/test/java/org/apache/commons/compress/archivers/examples/ExpanderTest.java",
    "is_vulnerable": 0,
    "class_name": "ExpanderTest",
    "subclass_name": null,
    "function_name": "assertHelloWorld(String fileName, String suffix) throws IOException",
    "function_body": "{\n        Assert.assertTrue(fileName + \" does not exist\", new File(resultDir, fileName).isFile());\n        byte[] expected = (\"Hello, world \" + suffix).getBytes(StandardCharsets.UTF_8);\n        try (InputStream is = Files.newInputStream(new File(resultDir, fileName).toPath())) {\n            byte[] actual = IOUtils.toByteArray(is);\n            Assert.assertArrayEquals(expected, actual);\n        }\n    }"
  },
  {
    "id": 5,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 0,
    "human_patch": "https://github.com/apache/commons-compress/commit/2a2f1dc48e22a34ddb72321a4db211da91aa933b",
    "cve_id": "CVE-2018-1324",
    "cwe_id": "CWE-835",
    "filename": "src/main/java/org/apache/commons/compress/archivers/zip/X0017_StrongEncryptionHeader.java",
    "is_vulnerable": 0,
    "class_name": "X0017_StrongEncryptionHeader",
    "subclass_name": null,
    "function_name": "getRecordCount()",
    "function_body": "{\n        return rcount;\n    }"
  },
  {
    "id": 5,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 1,
    "human_patch": "https://github.com/apache/commons-compress/commit/2a2f1dc48e22a34ddb72321a4db211da91aa933b",
    "cve_id": "CVE-2018-1324",
    "cwe_id": "CWE-835",
    "filename": "src/main/java/org/apache/commons/compress/archivers/zip/X0017_StrongEncryptionHeader.java",
    "is_vulnerable": 0,
    "class_name": "X0017_StrongEncryptionHeader",
    "subclass_name": null,
    "function_name": "getHashAlgorithm()",
    "function_body": "{\n        return hashAlg;\n    }"
  },
  {
    "id": 5,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 2,
    "human_patch": "https://github.com/apache/commons-compress/commit/2a2f1dc48e22a34ddb72321a4db211da91aa933b",
    "cve_id": "CVE-2018-1324",
    "cwe_id": "CWE-835",
    "filename": "src/main/java/org/apache/commons/compress/archivers/zip/X0017_StrongEncryptionHeader.java",
    "is_vulnerable": 0,
    "class_name": "X0017_StrongEncryptionHeader",
    "subclass_name": null,
    "function_name": "getEncryptionAlgorithm()",
    "function_body": "{\n        return algId;\n    }"
  },
  {
    "id": 5,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 3,
    "human_patch": "https://github.com/apache/commons-compress/commit/2a2f1dc48e22a34ddb72321a4db211da91aa933b",
    "cve_id": "CVE-2018-1324",
    "cwe_id": "CWE-835",
    "filename": "src/main/java/org/apache/commons/compress/archivers/zip/X0017_StrongEncryptionHeader.java",
    "is_vulnerable": 1,
    "class_name": "X0017_StrongEncryptionHeader",
    "subclass_name": null,
    "function_name": "parseCentralDirectoryFormat(final byte[] data, final int offset, final int length)",
    "function_body": "{\n        this.format = ZipShort.getValue(data, offset);\n        this.algId = EncryptionAlgorithm.getAlgorithmByCode(ZipShort.getValue(data, offset + 2));\n        this.bitlen = ZipShort.getValue(data, offset + 4);\n        this.flags = ZipShort.getValue(data, offset + 6);\n        this.rcount = ZipLong.getValue(data, offset + 8);\n\n        if (rcount > 0) {\n            this.hashAlg = HashAlgorithm.getAlgorithmByCode(ZipShort.getValue(data, offset + 12));\n            this.hashSize = ZipShort.getValue(data, offset + 14);\n            \n            for (int i = 0; i < this.rcount; i++) {\n                for (int j = 0; j < this.hashSize; j++) {\n                    \n                }\n            }\n        }\n    }"
  },
  {
    "id": 5,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 4,
    "human_patch": "https://github.com/apache/commons-compress/commit/2a2f1dc48e22a34ddb72321a4db211da91aa933b",
    "cve_id": "CVE-2018-1324",
    "cwe_id": "CWE-835",
    "filename": "src/main/java/org/apache/commons/compress/archivers/zip/X0017_StrongEncryptionHeader.java",
    "is_vulnerable": 0,
    "class_name": "X0017_StrongEncryptionHeader",
    "subclass_name": null,
    "function_name": "parseFileFormat(final byte[] data, final int offset, final int length)",
    "function_body": "{\n        final int ivSize = ZipShort.getValue(data, offset);\n        this.ivData = new byte[ivSize];\n        System.arraycopy(data, offset + 4, this.ivData, 0, ivSize);\n\n        this.format = ZipShort.getValue(data, offset + ivSize + 6);\n        this.algId = EncryptionAlgorithm.getAlgorithmByCode(ZipShort.getValue(data, offset + ivSize + 8));\n        this.bitlen = ZipShort.getValue(data, offset + ivSize + 10);\n        this.flags = ZipShort.getValue(data, offset + ivSize + 12);\n\n        final int erdSize = ZipShort.getValue(data, offset + ivSize + 14);\n        this.erdData = new byte[erdSize];\n        System.arraycopy(data, offset + ivSize + 16, this.erdData, 0, erdSize);\n\n        this.rcount = ZipLong.getValue(data, offset + ivSize + 16 + erdSize);\n        System.out.println(\"rcount: \" + rcount);\n        if (rcount == 0) {\n            final int vSize = ZipShort.getValue(data, offset + ivSize + 20 + erdSize);\n            this.vData = new byte[vSize - 4];\n            this.vCRC32 = new byte[4];\n            System.arraycopy(data, offset + ivSize + 22 + erdSize , this.vData, 0, vSize - 4);\n            System.arraycopy(data, offset + ivSize + 22 + erdSize + vSize - 4, vCRC32, 0, 4);\n        } else {\n            this.hashAlg = HashAlgorithm.getAlgorithmByCode(ZipShort.getValue(data, offset + ivSize + 20 + erdSize));\n            this.hashSize = ZipShort.getValue(data, offset + ivSize + 22 + erdSize);\n            final int resize = ZipShort.getValue(data, offset + ivSize + 24 + erdSize);\n            this.recipientKeyHash = new byte[this.hashSize];\n            this.keyBlob = new byte[resize - this.hashSize];\n            System.arraycopy(data, offset + ivSize + 24 + erdSize, this.recipientKeyHash, 0, this.hashSize);\n            System.arraycopy(data, offset + ivSize + 24 + erdSize + this.hashSize, this.keyBlob, 0, resize - this.hashSize);\n\n            final int vSize = ZipShort.getValue(data, offset + ivSize + 26 + erdSize + resize);\n            this.vData = new byte[vSize - 4];\n            this.vCRC32 = new byte[4];\n            System.arraycopy(data, offset + ivSize + 22 + erdSize + resize, this.vData, 0, vSize - 4);\n            System.arraycopy(data, offset + ivSize + 22 + erdSize + resize + vSize - 4, vCRC32, 0, 4);\n        }\n\n        \n    }"
  },
  {
    "id": 5,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 5,
    "human_patch": "https://github.com/apache/commons-compress/commit/2a2f1dc48e22a34ddb72321a4db211da91aa933b",
    "cve_id": "CVE-2018-1324",
    "cwe_id": "CWE-835",
    "filename": "src/main/java/org/apache/commons/compress/archivers/zip/X0017_StrongEncryptionHeader.java",
    "is_vulnerable": 0,
    "class_name": "X0017_StrongEncryptionHeader",
    "subclass_name": null,
    "function_name": "parseFromLocalFileData(final byte[] data, final int offset, final int length)",
    "function_body": "{\n        super.parseFromLocalFileData(data, offset, length);\n        parseFileFormat(data, offset, length);\n    }"
  },
  {
    "id": 5,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 6,
    "human_patch": "https://github.com/apache/commons-compress/commit/2a2f1dc48e22a34ddb72321a4db211da91aa933b",
    "cve_id": "CVE-2018-1324",
    "cwe_id": "CWE-835",
    "filename": "src/main/java/org/apache/commons/compress/archivers/zip/X0017_StrongEncryptionHeader.java",
    "is_vulnerable": 0,
    "class_name": "X0017_StrongEncryptionHeader",
    "subclass_name": null,
    "function_name": "parseFromCentralDirectoryData(final byte[] data, final int offset, final int length)",
    "function_body": "{\n        super.parseFromCentralDirectoryData(data, offset, length);\n        parseCentralDirectoryFormat(data, offset, length);\n    }"
  },
  {
    "id": 6,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 0,
    "human_patch": "https://github.com/apache/commons-compress/commit/a41ce6892cb0590b2e658704434ac0dbcb6834c8",
    "cve_id": "CVE-2018-11771",
    "cwe_id": "CWE-835",
    "filename": "src/main/java/org/apache/commons/compress/archivers/zip/ZipArchiveInputStream.java",
    "is_vulnerable": 0,
    "class_name": "ZipArchiveInputStream",
    "subclass_name": null,
    "function_name": "getNextZipEntry() throws IOException",
    "function_body": "{\n        uncompressedCount = 0;\n\n        boolean firstEntry = true;\n        if (closed || hitCentralDirectory) {\n            return null;\n        }\n        if (current != null) {\n            closeEntry();\n            firstEntry = false;\n        }\n\n        long currentHeaderOffset = getBytesRead();\n        try {\n            if (firstEntry) {\n                \n                \n                \n                \n                readFirstLocalFileHeader(lfhBuf);\n            } else {\n                readFully(lfhBuf);\n            }\n        } catch (final EOFException e) {\n            return null;\n        }\n\n        final ZipLong sig = new ZipLong(lfhBuf);\n        if (!sig.equals(ZipLong.LFH_SIG)) {\n            if (sig.equals(ZipLong.CFH_SIG) || sig.equals(ZipLong.AED_SIG) || isApkSigningBlock(lfhBuf)) {\n                hitCentralDirectory = true;\n                skipRemainderOfArchive();\n                return null;\n            }\n            throw new ZipException(String.format(\"Unexpected record signature: 0X%X\", sig.getValue()));\n        }\n\n        int off = WORD;\n        current = new CurrentEntry();\n\n        final int versionMadeBy = ZipShort.getValue(lfhBuf, off);\n        off += SHORT;\n        current.entry.setPlatform((versionMadeBy >> ZipFile.BYTE_SHIFT) & ZipFile.NIBLET_MASK);\n\n        final GeneralPurposeBit gpFlag = GeneralPurposeBit.parse(lfhBuf, off);\n        final boolean hasUTF8Flag = gpFlag.usesUTF8ForNames();\n        final ZipEncoding entryEncoding = hasUTF8Flag ? ZipEncodingHelper.UTF8_ZIP_ENCODING : zipEncoding;\n        current.hasDataDescriptor = gpFlag.usesDataDescriptor();\n        current.entry.setGeneralPurposeBit(gpFlag);\n\n        off += SHORT;\n\n        current.entry.setMethod(ZipShort.getValue(lfhBuf, off));\n        off += SHORT;\n\n        final long time = ZipUtil.dosToJavaTime(ZipLong.getValue(lfhBuf, off));\n        current.entry.setTime(time);\n        off += WORD;\n\n        ZipLong size = null, cSize = null;\n        if (!current.hasDataDescriptor) {\n            current.entry.setCrc(ZipLong.getValue(lfhBuf, off));\n            off += WORD;\n\n            cSize = new ZipLong(lfhBuf, off);\n            off += WORD;\n\n            size = new ZipLong(lfhBuf, off);\n            off += WORD;\n        } else {\n            off += 3 * WORD;\n        }\n\n        final int fileNameLen = ZipShort.getValue(lfhBuf, off);\n\n        off += SHORT;\n\n        final int extraLen = ZipShort.getValue(lfhBuf, off);\n        off += SHORT; \n\n        final byte[] fileName = new byte[fileNameLen];\n        readFully(fileName);\n        current.entry.setName(entryEncoding.decode(fileName), fileName);\n        if (hasUTF8Flag) {\n            current.entry.setNameSource(ZipArchiveEntry.NameSource.NAME_WITH_EFS_FLAG);\n        }\n\n        final byte[] extraData = new byte[extraLen];\n        readFully(extraData);\n        current.entry.setExtra(extraData);\n\n        if (!hasUTF8Flag && useUnicodeExtraFields) {\n            ZipUtil.setNameAndCommentFromExtraFields(current.entry, fileName, null);\n        }\n\n        processZip64Extra(size, cSize);\n\n        current.entry.setLocalHeaderOffset(currentHeaderOffset);\n        current.entry.setDataOffset(getBytesRead());\n        current.entry.setStreamContiguous(true);\n\n        ZipMethod m = ZipMethod.getMethodByCode(current.entry.getMethod());\n        if (current.entry.getCompressedSize() != ArchiveEntry.SIZE_UNKNOWN) {\n            if (ZipUtil.canHandleEntryData(current.entry) && m != ZipMethod.STORED && m != ZipMethod.DEFLATED) {\n                InputStream bis = new BoundedInputStream(in, current.entry.getCompressedSize());\n                switch (m) {\n                case UNSHRINKING:\n                    current.in = new UnshrinkingInputStream(bis);\n                    break;\n                case IMPLODING:\n                    current.in = new ExplodingInputStream(\n                        current.entry.getGeneralPurposeBit().getSlidingDictionarySize(),\n                        current.entry.getGeneralPurposeBit().getNumberOfShannonFanoTrees(),\n                        bis);\n                    break;\n                case BZIP2:\n                    current.in = new BZip2CompressorInputStream(bis);\n                    break;\n                case ENHANCED_DEFLATED:\n                    current.in = new Deflate64CompressorInputStream(bis);\n                    break;\n                default:\n                    \n                    \n                    \n                    break;\n                }\n            }\n        } else if (m == ZipMethod.ENHANCED_DEFLATED) {\n            current.in = new Deflate64CompressorInputStream(in);\n        }\n\n        entriesRead++;\n        return current.entry;\n    }"
  },
  {
    "id": 6,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 1,
    "human_patch": "https://github.com/apache/commons-compress/commit/a41ce6892cb0590b2e658704434ac0dbcb6834c8",
    "cve_id": "CVE-2018-11771",
    "cwe_id": "CWE-835",
    "filename": "src/main/java/org/apache/commons/compress/archivers/zip/ZipArchiveInputStream.java",
    "is_vulnerable": 0,
    "class_name": "ZipArchiveInputStream",
    "subclass_name": null,
    "function_name": "readFirstLocalFileHeader(final byte[] lfh) throws IOException",
    "function_body": "{\n        readFully(lfh);\n        final ZipLong sig = new ZipLong(lfh);\n        if (sig.equals(ZipLong.DD_SIG)) {\n            throw new UnsupportedZipFeatureException(UnsupportedZipFeatureException.Feature.SPLITTING);\n        }\n\n        if (sig.equals(ZipLong.SINGLE_SEGMENT_SPLIT_MARKER)) {\n            \n            \n            final byte[] missedLfhBytes = new byte[4];\n            readFully(missedLfhBytes);\n            System.arraycopy(lfh, 4, lfh, 0, LFH_LEN - 4);\n            System.arraycopy(missedLfhBytes, 0, lfh, LFH_LEN - 4, 4);\n        }\n    }"
  },
  {
    "id": 6,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 2,
    "human_patch": "https://github.com/apache/commons-compress/commit/a41ce6892cb0590b2e658704434ac0dbcb6834c8",
    "cve_id": "CVE-2018-11771",
    "cwe_id": "CWE-835",
    "filename": "src/main/java/org/apache/commons/compress/archivers/zip/ZipArchiveInputStream.java",
    "is_vulnerable": 0,
    "class_name": "ZipArchiveInputStream",
    "subclass_name": null,
    "function_name": "processZip64Extra(final ZipLong size, final ZipLong cSize)",
    "function_body": "{\n        final Zip64ExtendedInformationExtraField z64 =\n            (Zip64ExtendedInformationExtraField)\n            current.entry.getExtraField(Zip64ExtendedInformationExtraField.HEADER_ID);\n        current.usesZip64 = z64 != null;\n        if (!current.hasDataDescriptor) {\n            if (z64 != null \n                    && (cSize.equals(ZipLong.ZIP64_MAGIC) || size.equals(ZipLong.ZIP64_MAGIC)) ) {\n                current.entry.setCompressedSize(z64.getCompressedSize().getLongValue());\n                current.entry.setSize(z64.getSize().getLongValue());\n            } else {\n                current.entry.setCompressedSize(cSize.getValue());\n                current.entry.setSize(size.getValue());\n            }\n        }\n    }"
  },
  {
    "id": 6,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 3,
    "human_patch": "https://github.com/apache/commons-compress/commit/a41ce6892cb0590b2e658704434ac0dbcb6834c8",
    "cve_id": "CVE-2018-11771",
    "cwe_id": "CWE-835",
    "filename": "src/main/java/org/apache/commons/compress/archivers/zip/ZipArchiveInputStream.java",
    "is_vulnerable": 0,
    "class_name": "ZipArchiveInputStream",
    "subclass_name": null,
    "function_name": "getNextEntry() throws IOException",
    "function_body": "{\n        return getNextZipEntry();\n    }"
  },
  {
    "id": 6,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 4,
    "human_patch": "https://github.com/apache/commons-compress/commit/a41ce6892cb0590b2e658704434ac0dbcb6834c8",
    "cve_id": "CVE-2018-11771",
    "cwe_id": "CWE-835",
    "filename": "src/main/java/org/apache/commons/compress/archivers/zip/ZipArchiveInputStream.java",
    "is_vulnerable": 0,
    "class_name": "ZipArchiveInputStream",
    "subclass_name": null,
    "function_name": "canReadEntryData(final ArchiveEntry ae)",
    "function_body": "{\n        if (ae instanceof ZipArchiveEntry) {\n            final ZipArchiveEntry ze = (ZipArchiveEntry) ae;\n            return ZipUtil.canHandleEntryData(ze)\n                && supportsDataDescriptorFor(ze)\n                && supportsCompressedSizeFor(ze);\n        }\n        return false;\n    }"
  },
  {
    "id": 6,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 5,
    "human_patch": "https://github.com/apache/commons-compress/commit/a41ce6892cb0590b2e658704434ac0dbcb6834c8",
    "cve_id": "CVE-2018-11771",
    "cwe_id": "CWE-835",
    "filename": "src/main/java/org/apache/commons/compress/archivers/zip/ZipArchiveInputStream.java",
    "is_vulnerable": 0,
    "class_name": "ZipArchiveInputStream",
    "subclass_name": null,
    "function_name": "read(final byte[] buffer, final int offset, final int length) throws IOException",
    "function_body": "{\n        if (closed) {\n            throw new IOException(\"The stream is closed\");\n        }\n\n        if (current == null) {\n            return -1;\n        }\n\n        \n        if (offset > buffer.length || length < 0 || offset < 0 || buffer.length - offset < length) {\n            throw new ArrayIndexOutOfBoundsException();\n        }\n\n        ZipUtil.checkRequestedFeatures(current.entry);\n        if (!supportsDataDescriptorFor(current.entry)) {\n            throw new UnsupportedZipFeatureException(UnsupportedZipFeatureException.Feature.DATA_DESCRIPTOR,\n                    current.entry);\n        }\n        if (!supportsCompressedSizeFor(current.entry)) {\n            throw new UnsupportedZipFeatureException(UnsupportedZipFeatureException.Feature.UNKNOWN_COMPRESSED_SIZE,\n                    current.entry);\n        }\n\n        int read;\n        if (current.entry.getMethod() == ZipArchiveOutputStream.STORED) {\n            read = readStored(buffer, offset, length);\n        } else if (current.entry.getMethod() == ZipArchiveOutputStream.DEFLATED) {\n            read = readDeflated(buffer, offset, length);\n        } else if (current.entry.getMethod() == ZipMethod.UNSHRINKING.getCode()\n                || current.entry.getMethod() == ZipMethod.IMPLODING.getCode()\n                || current.entry.getMethod() == ZipMethod.ENHANCED_DEFLATED.getCode()\n                || current.entry.getMethod() == ZipMethod.BZIP2.getCode()) {\n            read = current.in.read(buffer, offset, length);\n        } else {\n            throw new UnsupportedZipFeatureException(ZipMethod.getMethodByCode(current.entry.getMethod()),\n                    current.entry);\n        }\n\n        if (read >= 0) {\n            current.crc.update(buffer, offset, read);\n            uncompressedCount += read;\n        }\n\n        return read;\n    }"
  },
  {
    "id": 6,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 6,
    "human_patch": "https://github.com/apache/commons-compress/commit/a41ce6892cb0590b2e658704434ac0dbcb6834c8",
    "cve_id": "CVE-2018-11771",
    "cwe_id": "CWE-835",
    "filename": "src/main/java/org/apache/commons/compress/archivers/zip/ZipArchiveInputStream.java",
    "is_vulnerable": 0,
    "class_name": "ZipArchiveInputStream",
    "subclass_name": null,
    "function_name": "getCompressedCount()",
    "function_body": "{\n        if (current.entry.getMethod() == ZipArchiveOutputStream.STORED) {\n            return current.bytesRead;\n        } else if (current.entry.getMethod() == ZipArchiveOutputStream.DEFLATED) {\n            return getBytesInflated();\n        } else if (current.entry.getMethod() == ZipMethod.UNSHRINKING.getCode()) {\n            return ((UnshrinkingInputStream) current.in).getCompressedCount();\n        } else if (current.entry.getMethod() == ZipMethod.IMPLODING.getCode()) {\n            return ((ExplodingInputStream) current.in).getCompressedCount();\n        } else if (current.entry.getMethod() == ZipMethod.ENHANCED_DEFLATED.getCode()) {\n            return ((Deflate64CompressorInputStream) current.in).getCompressedCount();\n        } else if (current.entry.getMethod() == ZipMethod.BZIP2.getCode()) {\n            return ((BZip2CompressorInputStream) current.in).getCompressedCount();\n        } else {\n            return -1;\n        }\n    }"
  },
  {
    "id": 6,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 7,
    "human_patch": "https://github.com/apache/commons-compress/commit/a41ce6892cb0590b2e658704434ac0dbcb6834c8",
    "cve_id": "CVE-2018-11771",
    "cwe_id": "CWE-835",
    "filename": "src/main/java/org/apache/commons/compress/archivers/zip/ZipArchiveInputStream.java",
    "is_vulnerable": 0,
    "class_name": "ZipArchiveInputStream",
    "subclass_name": null,
    "function_name": "getUncompressedCount()",
    "function_body": "{\n        return uncompressedCount;\n    }"
  },
  {
    "id": 6,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 8,
    "human_patch": "https://github.com/apache/commons-compress/commit/a41ce6892cb0590b2e658704434ac0dbcb6834c8",
    "cve_id": "CVE-2018-11771",
    "cwe_id": "CWE-835",
    "filename": "src/main/java/org/apache/commons/compress/archivers/zip/ZipArchiveInputStream.java",
    "is_vulnerable": 1,
    "class_name": "ZipArchiveInputStream",
    "subclass_name": null,
    "function_name": "readStored(final byte[] buffer, final int offset, final int length) throws IOException",
    "function_body": "{\n\n        if (current.hasDataDescriptor) {\n            if (lastStoredEntry == null) {\n                readStoredEntry();\n            }\n            return lastStoredEntry.read(buffer, offset, length);\n        }\n\n        final long csize = current.entry.getSize();\n        if (current.bytesRead >= csize) {\n            return -1;\n        }\n\n        if (buf.position() >= buf.limit()) {\n            buf.position(0);\n            final int l = in.read(buf.array());\n            if (l == -1) {\n                return -1;\n            }\n            buf.limit(l);\n\n            count(l);\n            current.bytesReadFromStream += l;\n        }\n\n        int toRead = Math.min(buf.remaining(), length);\n        if ((csize - current.bytesRead) < toRead) {\n            \n            toRead = (int) (csize - current.bytesRead);\n        }\n        buf.get(buffer, offset, toRead);\n        current.bytesRead += toRead;\n        return toRead;\n    }"
  },
  {
    "id": 6,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 9,
    "human_patch": "https://github.com/apache/commons-compress/commit/a41ce6892cb0590b2e658704434ac0dbcb6834c8",
    "cve_id": "CVE-2018-11771",
    "cwe_id": "CWE-835",
    "filename": "src/main/java/org/apache/commons/compress/archivers/zip/ZipArchiveInputStream.java",
    "is_vulnerable": 0,
    "class_name": "ZipArchiveInputStream",
    "subclass_name": null,
    "function_name": "readDeflated(final byte[] buffer, final int offset, final int length) throws IOException",
    "function_body": "{\n        final int read = readFromInflater(buffer, offset, length);\n        if (read <= 0) {\n            if (inf.finished()) {\n                return -1;\n            } else if (inf.needsDictionary()) {\n                throw new ZipException(\"This archive needs a preset dictionary\"\n                                       + \" which is not supported by Commons\"\n                                       + \" Compress.\");\n            } else if (read == -1) {\n                throw new IOException(\"Truncated ZIP file\");\n            }\n        }\n        return read;\n    }"
  },
  {
    "id": 6,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 10,
    "human_patch": "https://github.com/apache/commons-compress/commit/a41ce6892cb0590b2e658704434ac0dbcb6834c8",
    "cve_id": "CVE-2018-11771",
    "cwe_id": "CWE-835",
    "filename": "src/main/java/org/apache/commons/compress/archivers/zip/ZipArchiveInputStream.java",
    "is_vulnerable": 0,
    "class_name": "ZipArchiveInputStream",
    "subclass_name": null,
    "function_name": "readFromInflater(final byte[] buffer, final int offset, final int length) throws IOException",
    "function_body": "{\n        int read = 0;\n        do {\n            if (inf.needsInput()) {\n                final int l = fill();\n                if (l > 0) {\n                    current.bytesReadFromStream += buf.limit();\n                } else if (l == -1) {\n                    return -1;\n                } else {\n                    break;\n                }\n            }\n            try {\n                read = inf.inflate(buffer, offset, length);\n            } catch (final DataFormatException e) {\n                throw (IOException) new ZipException(e.getMessage()).initCause(e);\n            }\n        } while (read == 0 && inf.needsInput());\n        return read;\n    }"
  },
  {
    "id": 6,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 11,
    "human_patch": "https://github.com/apache/commons-compress/commit/a41ce6892cb0590b2e658704434ac0dbcb6834c8",
    "cve_id": "CVE-2018-11771",
    "cwe_id": "CWE-835",
    "filename": "src/main/java/org/apache/commons/compress/archivers/zip/ZipArchiveInputStream.java",
    "is_vulnerable": 0,
    "class_name": "ZipArchiveInputStream",
    "subclass_name": null,
    "function_name": "close() throws IOException",
    "function_body": "{\n        if (!closed) {\n            closed = true;\n            try {\n                in.close();\n            } finally {\n                inf.end();\n            }\n        }\n    }"
  },
  {
    "id": 6,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 12,
    "human_patch": "https://github.com/apache/commons-compress/commit/a41ce6892cb0590b2e658704434ac0dbcb6834c8",
    "cve_id": "CVE-2018-11771",
    "cwe_id": "CWE-835",
    "filename": "src/main/java/org/apache/commons/compress/archivers/zip/ZipArchiveInputStream.java",
    "is_vulnerable": 0,
    "class_name": "ZipArchiveInputStream",
    "subclass_name": null,
    "function_name": "skip(final long value) throws IOException",
    "function_body": "{\n        if (value >= 0) {\n            long skipped = 0;\n            while (skipped < value) {\n                final long rem = value - skipped;\n                final int x = read(skipBuf, 0, (int) (skipBuf.length > rem ? rem : skipBuf.length));\n                if (x == -1) {\n                    return skipped;\n                }\n                skipped += x;\n            }\n            return skipped;\n        }\n        throw new IllegalArgumentException();\n    }"
  },
  {
    "id": 6,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 13,
    "human_patch": "https://github.com/apache/commons-compress/commit/a41ce6892cb0590b2e658704434ac0dbcb6834c8",
    "cve_id": "CVE-2018-11771",
    "cwe_id": "CWE-835",
    "filename": "src/main/java/org/apache/commons/compress/archivers/zip/ZipArchiveInputStream.java",
    "is_vulnerable": 0,
    "class_name": "ZipArchiveInputStream",
    "subclass_name": null,
    "function_name": "matches(final byte[] signature, final int length)",
    "function_body": "{\n        if (length < ZipArchiveOutputStream.LFH_SIG.length) {\n            return false;\n        }\n\n        return checksig(signature, ZipArchiveOutputStream.LFH_SIG) \n            || checksig(signature, ZipArchiveOutputStream.EOCD_SIG) \n            || checksig(signature, ZipArchiveOutputStream.DD_SIG) \n            || checksig(signature, ZipLong.SINGLE_SEGMENT_SPLIT_MARKER.getBytes());\n    }"
  },
  {
    "id": 6,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 14,
    "human_patch": "https://github.com/apache/commons-compress/commit/a41ce6892cb0590b2e658704434ac0dbcb6834c8",
    "cve_id": "CVE-2018-11771",
    "cwe_id": "CWE-835",
    "filename": "src/main/java/org/apache/commons/compress/archivers/zip/ZipArchiveInputStream.java",
    "is_vulnerable": 0,
    "class_name": "ZipArchiveInputStream",
    "subclass_name": null,
    "function_name": "checksig(final byte[] signature, final byte[] expected)",
    "function_body": "{\n        for (int i = 0; i < expected.length; i++) {\n            if (signature[i] != expected[i]) {\n                return false;\n            }\n        }\n        return true;\n    }"
  },
  {
    "id": 6,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 15,
    "human_patch": "https://github.com/apache/commons-compress/commit/a41ce6892cb0590b2e658704434ac0dbcb6834c8",
    "cve_id": "CVE-2018-11771",
    "cwe_id": "CWE-835",
    "filename": "src/main/java/org/apache/commons/compress/archivers/zip/ZipArchiveInputStream.java",
    "is_vulnerable": 0,
    "class_name": "ZipArchiveInputStream",
    "subclass_name": null,
    "function_name": "closeEntry() throws IOException",
    "function_body": "{\n        if (closed) {\n            throw new IOException(\"The stream is closed\");\n        }\n        if (current == null) {\n            return;\n        }\n\n        \n        if (currentEntryHasOutstandingBytes()) {\n            drainCurrentEntryData();\n        } else {\n            \n            skip(Long.MAX_VALUE); \n\n            final long inB = current.entry.getMethod() == ZipArchiveOutputStream.DEFLATED\n                       ? getBytesInflated() : current.bytesRead;\n\n            \n            \n            final int diff = (int) (current.bytesReadFromStream - inB);\n\n            \n            if (diff > 0) {\n                pushback(buf.array(), buf.limit() - diff, diff);\n                current.bytesReadFromStream -= diff;\n            }\n\n            \n            if (currentEntryHasOutstandingBytes()) {\n                drainCurrentEntryData();\n            }\n        }\n\n        if (lastStoredEntry == null && current.hasDataDescriptor) {\n            readDataDescriptor();\n        }\n\n        inf.reset();\n        buf.clear().flip();\n        current = null;\n        lastStoredEntry = null;\n    }"
  },
  {
    "id": 6,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 16,
    "human_patch": "https://github.com/apache/commons-compress/commit/a41ce6892cb0590b2e658704434ac0dbcb6834c8",
    "cve_id": "CVE-2018-11771",
    "cwe_id": "CWE-835",
    "filename": "src/main/java/org/apache/commons/compress/archivers/zip/ZipArchiveInputStream.java",
    "is_vulnerable": 0,
    "class_name": "ZipArchiveInputStream",
    "subclass_name": null,
    "function_name": "currentEntryHasOutstandingBytes()",
    "function_body": "{\n        return current.bytesReadFromStream <= current.entry.getCompressedSize()\n                && !current.hasDataDescriptor;\n    }"
  },
  {
    "id": 6,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 17,
    "human_patch": "https://github.com/apache/commons-compress/commit/a41ce6892cb0590b2e658704434ac0dbcb6834c8",
    "cve_id": "CVE-2018-11771",
    "cwe_id": "CWE-835",
    "filename": "src/main/java/org/apache/commons/compress/archivers/zip/ZipArchiveInputStream.java",
    "is_vulnerable": 0,
    "class_name": "ZipArchiveInputStream",
    "subclass_name": null,
    "function_name": "drainCurrentEntryData() throws IOException",
    "function_body": "{\n        long remaining = current.entry.getCompressedSize() - current.bytesReadFromStream;\n        while (remaining > 0) {\n            final long n = in.read(buf.array(), 0, (int) Math.min(buf.capacity(), remaining));\n            if (n < 0) {\n                throw new EOFException(\"Truncated ZIP entry: \"\n                                       + ArchiveUtils.sanitize(current.entry.getName()));\n            }\n            count(n);\n            remaining -= n;\n        }\n    }"
  },
  {
    "id": 6,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 18,
    "human_patch": "https://github.com/apache/commons-compress/commit/a41ce6892cb0590b2e658704434ac0dbcb6834c8",
    "cve_id": "CVE-2018-11771",
    "cwe_id": "CWE-835",
    "filename": "src/main/java/org/apache/commons/compress/archivers/zip/ZipArchiveInputStream.java",
    "is_vulnerable": 0,
    "class_name": "ZipArchiveInputStream",
    "subclass_name": null,
    "function_name": "getBytesInflated()",
    "function_body": "{\n        long inB = inf.getBytesRead();\n        if (current.bytesReadFromStream >= TWO_EXP_32) {\n            while (inB + TWO_EXP_32 <= current.bytesReadFromStream) {\n                inB += TWO_EXP_32;\n            }\n        }\n        return inB;\n    }"
  },
  {
    "id": 6,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 19,
    "human_patch": "https://github.com/apache/commons-compress/commit/a41ce6892cb0590b2e658704434ac0dbcb6834c8",
    "cve_id": "CVE-2018-11771",
    "cwe_id": "CWE-835",
    "filename": "src/main/java/org/apache/commons/compress/archivers/zip/ZipArchiveInputStream.java",
    "is_vulnerable": 0,
    "class_name": "ZipArchiveInputStream",
    "subclass_name": null,
    "function_name": "fill() throws IOException",
    "function_body": "{\n        if (closed) {\n            throw new IOException(\"The stream is closed\");\n        }\n        final int length = in.read(buf.array());\n        if (length > 0) {\n            buf.limit(length);\n            count(buf.limit());\n            inf.setInput(buf.array(), 0, buf.limit());\n        }\n        return length;\n    }"
  },
  {
    "id": 6,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 20,
    "human_patch": "https://github.com/apache/commons-compress/commit/a41ce6892cb0590b2e658704434ac0dbcb6834c8",
    "cve_id": "CVE-2018-11771",
    "cwe_id": "CWE-835",
    "filename": "src/main/java/org/apache/commons/compress/archivers/zip/ZipArchiveInputStream.java",
    "is_vulnerable": 0,
    "class_name": "ZipArchiveInputStream",
    "subclass_name": null,
    "function_name": "readFully(final byte[] b) throws IOException",
    "function_body": "{\n        readFully(b, 0);\n    }"
  },
  {
    "id": 6,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 21,
    "human_patch": "https://github.com/apache/commons-compress/commit/a41ce6892cb0590b2e658704434ac0dbcb6834c8",
    "cve_id": "CVE-2018-11771",
    "cwe_id": "CWE-835",
    "filename": "src/main/java/org/apache/commons/compress/archivers/zip/ZipArchiveInputStream.java",
    "is_vulnerable": 0,
    "class_name": "ZipArchiveInputStream",
    "subclass_name": null,
    "function_name": "readFully(final byte[] b, final int off) throws IOException",
    "function_body": "{\n        final int len = b.length - off;\n        final int count = IOUtils.readFully(in, b, off, len);\n        count(count);\n        if (count < len) {\n            throw new EOFException();\n        }\n    }"
  },
  {
    "id": 6,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 22,
    "human_patch": "https://github.com/apache/commons-compress/commit/a41ce6892cb0590b2e658704434ac0dbcb6834c8",
    "cve_id": "CVE-2018-11771",
    "cwe_id": "CWE-835",
    "filename": "src/main/java/org/apache/commons/compress/archivers/zip/ZipArchiveInputStream.java",
    "is_vulnerable": 0,
    "class_name": "ZipArchiveInputStream",
    "subclass_name": null,
    "function_name": "readDataDescriptor() throws IOException",
    "function_body": "{\n        readFully(wordBuf);\n        ZipLong val = new ZipLong(wordBuf);\n        if (ZipLong.DD_SIG.equals(val)) {\n            \n            readFully(wordBuf);\n            val = new ZipLong(wordBuf);\n        }\n        current.entry.setCrc(val.getValue());\n\n        \n        \n        \n        \n        \n\n        \n        \n        \n        \n        \n        readFully(twoDwordBuf);\n        final ZipLong potentialSig = new ZipLong(twoDwordBuf, DWORD);\n        if (potentialSig.equals(ZipLong.CFH_SIG) || potentialSig.equals(ZipLong.LFH_SIG)) {\n            pushback(twoDwordBuf, DWORD, DWORD);\n            current.entry.setCompressedSize(ZipLong.getValue(twoDwordBuf));\n            current.entry.setSize(ZipLong.getValue(twoDwordBuf, WORD));\n        } else {\n            current.entry.setCompressedSize(ZipEightByteInteger.getLongValue(twoDwordBuf));\n            current.entry.setSize(ZipEightByteInteger.getLongValue(twoDwordBuf, DWORD));\n        }\n    }"
  },
  {
    "id": 6,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 23,
    "human_patch": "https://github.com/apache/commons-compress/commit/a41ce6892cb0590b2e658704434ac0dbcb6834c8",
    "cve_id": "CVE-2018-11771",
    "cwe_id": "CWE-835",
    "filename": "src/main/java/org/apache/commons/compress/archivers/zip/ZipArchiveInputStream.java",
    "is_vulnerable": 0,
    "class_name": "ZipArchiveInputStream",
    "subclass_name": null,
    "function_name": "supportsDataDescriptorFor(final ZipArchiveEntry entry)",
    "function_body": "{\n        return !entry.getGeneralPurposeBit().usesDataDescriptor()\n\n                || (allowStoredEntriesWithDataDescriptor && entry.getMethod() == ZipEntry.STORED)\n                || entry.getMethod() == ZipEntry.DEFLATED\n                || entry.getMethod() == ZipMethod.ENHANCED_DEFLATED.getCode();\n    }"
  },
  {
    "id": 6,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 24,
    "human_patch": "https://github.com/apache/commons-compress/commit/a41ce6892cb0590b2e658704434ac0dbcb6834c8",
    "cve_id": "CVE-2018-11771",
    "cwe_id": "CWE-835",
    "filename": "src/main/java/org/apache/commons/compress/archivers/zip/ZipArchiveInputStream.java",
    "is_vulnerable": 0,
    "class_name": "ZipArchiveInputStream",
    "subclass_name": null,
    "function_name": "supportsCompressedSizeFor(final ZipArchiveEntry entry)",
    "function_body": "{\n        return entry.getCompressedSize() != ArchiveEntry.SIZE_UNKNOWN\n            || entry.getMethod() == ZipEntry.DEFLATED\n            || entry.getMethod() == ZipMethod.ENHANCED_DEFLATED.getCode()\n            || (entry.getGeneralPurposeBit().usesDataDescriptor()\n                && allowStoredEntriesWithDataDescriptor\n                && entry.getMethod() == ZipEntry.STORED);\n    }"
  },
  {
    "id": 6,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 25,
    "human_patch": "https://github.com/apache/commons-compress/commit/a41ce6892cb0590b2e658704434ac0dbcb6834c8",
    "cve_id": "CVE-2018-11771",
    "cwe_id": "CWE-835",
    "filename": "src/main/java/org/apache/commons/compress/archivers/zip/ZipArchiveInputStream.java",
    "is_vulnerable": 0,
    "class_name": "ZipArchiveInputStream",
    "subclass_name": null,
    "function_name": "readStoredEntry() throws IOException",
    "function_body": "{\n        final ByteArrayOutputStream bos = new ByteArrayOutputStream();\n        int off = 0;\n        boolean done = false;\n\n        \n        final int ddLen = current.usesZip64 ? WORD + 2 * DWORD : 3 * WORD;\n\n        while (!done) {\n            final int r = in.read(buf.array(), off, ZipArchiveOutputStream.BUFFER_SIZE - off);\n            if (r <= 0) {\n                \n                \n                throw new IOException(\"Truncated ZIP file\");\n            }\n            if (r + off < 4) {\n                \n                off += r;\n                continue;\n            }\n\n            done = bufferContainsSignature(bos, off, r, ddLen);\n            if (!done) {\n                off = cacheBytesRead(bos, off, r, ddLen);\n            }\n        }\n\n        final byte[] b = bos.toByteArray();\n        lastStoredEntry = new ByteArrayInputStream(b);\n    }"
  },
  {
    "id": 6,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 26,
    "human_patch": "https://github.com/apache/commons-compress/commit/a41ce6892cb0590b2e658704434ac0dbcb6834c8",
    "cve_id": "CVE-2018-11771",
    "cwe_id": "CWE-835",
    "filename": "src/main/java/org/apache/commons/compress/archivers/zip/ZipArchiveInputStream.java",
    "is_vulnerable": 0,
    "class_name": "ZipArchiveInputStream",
    "subclass_name": null,
    "function_name": "bufferContainsSignature(final ByteArrayOutputStream bos, final int offset, final int lastRead, final int expectedDDLen) throws IOException",
    "function_body": "{\n\n        boolean done = false;\n        int readTooMuch = 0;\n        for (int i = 0; !done && i < offset + lastRead - 4; i++) {\n            if (buf.array()[i] == LFH[0] && buf.array()[i + 1] == LFH[1]) {\n                if ((buf.array()[i + 2] == LFH[2] && buf.array()[i + 3] == LFH[3])\n                    || (buf.array()[i] == CFH[2] && buf.array()[i + 3] == CFH[3])) {\n                    \n                    readTooMuch = offset + lastRead - i - expectedDDLen;\n                    done = true;\n                }\n                else if (buf.array()[i + 2] == DD[2] && buf.array()[i + 3] == DD[3]) {\n                    \n                    readTooMuch = offset + lastRead - i;\n                    done = true;\n                }\n                if (done) {\n                    \n                    \n                    \n                    \n                    pushback(buf.array(), offset + lastRead - readTooMuch, readTooMuch);\n                    bos.write(buf.array(), 0, i);\n                    readDataDescriptor();\n                }\n            }\n        }\n        return done;\n    }"
  },
  {
    "id": 6,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 27,
    "human_patch": "https://github.com/apache/commons-compress/commit/a41ce6892cb0590b2e658704434ac0dbcb6834c8",
    "cve_id": "CVE-2018-11771",
    "cwe_id": "CWE-835",
    "filename": "src/main/java/org/apache/commons/compress/archivers/zip/ZipArchiveInputStream.java",
    "is_vulnerable": 0,
    "class_name": "ZipArchiveInputStream",
    "subclass_name": null,
    "function_name": "cacheBytesRead(final ByteArrayOutputStream bos, int offset, final int lastRead, final int expecteDDLen)",
    "function_body": "{\n        final int cacheable = offset + lastRead - expecteDDLen - 3;\n        if (cacheable > 0) {\n            bos.write(buf.array(), 0, cacheable);\n            System.arraycopy(buf.array(), cacheable, buf.array(), 0, expecteDDLen + 3);\n            offset = expecteDDLen + 3;\n        } else {\n            offset += lastRead;\n        }\n        return offset;\n    }"
  },
  {
    "id": 6,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 28,
    "human_patch": "https://github.com/apache/commons-compress/commit/a41ce6892cb0590b2e658704434ac0dbcb6834c8",
    "cve_id": "CVE-2018-11771",
    "cwe_id": "CWE-835",
    "filename": "src/main/java/org/apache/commons/compress/archivers/zip/ZipArchiveInputStream.java",
    "is_vulnerable": 0,
    "class_name": "ZipArchiveInputStream",
    "subclass_name": null,
    "function_name": "pushback(final byte[] buf, final int offset, final int length) throws IOException",
    "function_body": "{\n        ((PushbackInputStream) in).unread(buf, offset, length);\n        pushedBackBytes(length);\n    }"
  },
  {
    "id": 6,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 29,
    "human_patch": "https://github.com/apache/commons-compress/commit/a41ce6892cb0590b2e658704434ac0dbcb6834c8",
    "cve_id": "CVE-2018-11771",
    "cwe_id": "CWE-835",
    "filename": "src/main/java/org/apache/commons/compress/archivers/zip/ZipArchiveInputStream.java",
    "is_vulnerable": 0,
    "class_name": "ZipArchiveInputStream",
    "subclass_name": null,
    "function_name": "skipRemainderOfArchive() throws IOException",
    "function_body": "{\n        \n        \n        \n        realSkip((long) entriesRead * CFH_LEN - LFH_LEN);\n        findEocdRecord();\n        realSkip((long) ZipFile.MIN_EOCD_SIZE - WORD  - SHORT );\n        readFully(shortBuf);\n        \n        realSkip(ZipShort.getValue(shortBuf));\n    }"
  },
  {
    "id": 6,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 30,
    "human_patch": "https://github.com/apache/commons-compress/commit/a41ce6892cb0590b2e658704434ac0dbcb6834c8",
    "cve_id": "CVE-2018-11771",
    "cwe_id": "CWE-835",
    "filename": "src/main/java/org/apache/commons/compress/archivers/zip/ZipArchiveInputStream.java",
    "is_vulnerable": 0,
    "class_name": "ZipArchiveInputStream",
    "subclass_name": null,
    "function_name": "findEocdRecord() throws IOException",
    "function_body": "{\n        int currentByte = -1;\n        boolean skipReadCall = false;\n        while (skipReadCall || (currentByte = readOneByte()) > -1) {\n            skipReadCall = false;\n            if (!isFirstByteOfEocdSig(currentByte)) {\n                continue;\n            }\n            currentByte = readOneByte();\n            if (currentByte != ZipArchiveOutputStream.EOCD_SIG[1]) {\n                if (currentByte == -1) {\n                    break;\n                }\n                skipReadCall = isFirstByteOfEocdSig(currentByte);\n                continue;\n            }\n            currentByte = readOneByte();\n            if (currentByte != ZipArchiveOutputStream.EOCD_SIG[2]) {\n                if (currentByte == -1) {\n                    break;\n                }\n                skipReadCall = isFirstByteOfEocdSig(currentByte);\n                continue;\n            }\n            currentByte = readOneByte();\n            if (currentByte == -1\n                || currentByte == ZipArchiveOutputStream.EOCD_SIG[3]) {\n                break;\n            }\n            skipReadCall = isFirstByteOfEocdSig(currentByte);\n        }\n    }"
  },
  {
    "id": 6,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 31,
    "human_patch": "https://github.com/apache/commons-compress/commit/a41ce6892cb0590b2e658704434ac0dbcb6834c8",
    "cve_id": "CVE-2018-11771",
    "cwe_id": "CWE-835",
    "filename": "src/main/java/org/apache/commons/compress/archivers/zip/ZipArchiveInputStream.java",
    "is_vulnerable": 0,
    "class_name": "ZipArchiveInputStream",
    "subclass_name": null,
    "function_name": "realSkip(final long value) throws IOException",
    "function_body": "{\n        if (value >= 0) {\n            long skipped = 0;\n            while (skipped < value) {\n                final long rem = value - skipped;\n                final int x = in.read(skipBuf, 0, (int) (skipBuf.length > rem ? rem : skipBuf.length));\n                if (x == -1) {\n                    return;\n                }\n                count(x);\n                skipped += x;\n            }\n            return;\n        }\n        throw new IllegalArgumentException();\n    }"
  },
  {
    "id": 6,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 32,
    "human_patch": "https://github.com/apache/commons-compress/commit/a41ce6892cb0590b2e658704434ac0dbcb6834c8",
    "cve_id": "CVE-2018-11771",
    "cwe_id": "CWE-835",
    "filename": "src/main/java/org/apache/commons/compress/archivers/zip/ZipArchiveInputStream.java",
    "is_vulnerable": 0,
    "class_name": "ZipArchiveInputStream",
    "subclass_name": null,
    "function_name": "readOneByte() throws IOException",
    "function_body": "{\n        final int b = in.read();\n        if (b != -1) {\n            count(1);\n        }\n        return b;\n    }"
  },
  {
    "id": 6,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 33,
    "human_patch": "https://github.com/apache/commons-compress/commit/a41ce6892cb0590b2e658704434ac0dbcb6834c8",
    "cve_id": "CVE-2018-11771",
    "cwe_id": "CWE-835",
    "filename": "src/main/java/org/apache/commons/compress/archivers/zip/ZipArchiveInputStream.java",
    "is_vulnerable": 0,
    "class_name": "ZipArchiveInputStream",
    "subclass_name": null,
    "function_name": "isFirstByteOfEocdSig(final int b)",
    "function_body": "{\n        return b == ZipArchiveOutputStream.EOCD_SIG[0];\n    }"
  },
  {
    "id": 6,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 34,
    "human_patch": "https://github.com/apache/commons-compress/commit/a41ce6892cb0590b2e658704434ac0dbcb6834c8",
    "cve_id": "CVE-2018-11771",
    "cwe_id": "CWE-835",
    "filename": "src/main/java/org/apache/commons/compress/archivers/zip/ZipArchiveInputStream.java",
    "is_vulnerable": 0,
    "class_name": "ZipArchiveInputStream",
    "subclass_name": null,
    "function_name": "isApkSigningBlock(byte[] suspectLocalFileHeader) throws IOException",
    "function_body": "{\n        \n        BigInteger len = ZipEightByteInteger.getValue(suspectLocalFileHeader);\n        \n        \n        BigInteger toSkip = len.add(BigInteger.valueOf(DWORD - suspectLocalFileHeader.length\n            - APK_SIGNING_BLOCK_MAGIC.length));\n        byte[] magic = new byte[APK_SIGNING_BLOCK_MAGIC.length];\n\n        try {\n            if (toSkip.signum() < 0) {\n                \n                int off = suspectLocalFileHeader.length + toSkip.intValue();\n                \n                if (off < DWORD) {\n                    return false;\n                }\n                int bytesInBuffer = Math.abs(toSkip.intValue());\n                System.arraycopy(suspectLocalFileHeader, off, magic, 0, Math.min(bytesInBuffer, magic.length));\n                if (bytesInBuffer < magic.length) {\n                    readFully(magic, bytesInBuffer);\n                }\n            } else {\n                while (toSkip.compareTo(LONG_MAX) > 0) {\n                    realSkip(Long.MAX_VALUE);\n                    toSkip = toSkip.add(LONG_MAX.negate());\n                }\n                realSkip(toSkip.longValue());\n                readFully(magic);\n            }\n        } catch (EOFException ex) {\n            \n            return false;\n        }\n        return Arrays.equals(magic, APK_SIGNING_BLOCK_MAGIC);\n    }"
  },
  {
    "id": 6,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 35,
    "human_patch": "https://github.com/apache/commons-compress/commit/a41ce6892cb0590b2e658704434ac0dbcb6834c8",
    "cve_id": "CVE-2018-11771",
    "cwe_id": "CWE-835",
    "filename": "src/main/java/org/apache/commons/compress/archivers/zip/ZipArchiveInputStream.java",
    "is_vulnerable": 0,
    "class_name": "ZipArchiveInputStream",
    "subclass_name": "BoundedInputStream",
    "function_name": "read() throws IOException",
    "function_body": "{\n            if (max >= 0 && pos >= max) {\n                return -1;\n            }\n            final int result = in.read();\n            pos++;\n            count(1);\n            current.bytesReadFromStream++;\n            return result;\n        }"
  },
  {
    "id": 6,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 36,
    "human_patch": "https://github.com/apache/commons-compress/commit/a41ce6892cb0590b2e658704434ac0dbcb6834c8",
    "cve_id": "CVE-2018-11771",
    "cwe_id": "CWE-835",
    "filename": "src/main/java/org/apache/commons/compress/archivers/zip/ZipArchiveInputStream.java",
    "is_vulnerable": 0,
    "class_name": "ZipArchiveInputStream",
    "subclass_name": "BoundedInputStream",
    "function_name": "read(final byte[] b) throws IOException",
    "function_body": "{\n            return this.read(b, 0, b.length);\n        }"
  },
  {
    "id": 6,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 37,
    "human_patch": "https://github.com/apache/commons-compress/commit/a41ce6892cb0590b2e658704434ac0dbcb6834c8",
    "cve_id": "CVE-2018-11771",
    "cwe_id": "CWE-835",
    "filename": "src/main/java/org/apache/commons/compress/archivers/zip/ZipArchiveInputStream.java",
    "is_vulnerable": 0,
    "class_name": "ZipArchiveInputStream",
    "subclass_name": "BoundedInputStream",
    "function_name": "read(final byte[] b, final int off, final int len) throws IOException",
    "function_body": "{\n            if (max >= 0 && pos >= max) {\n                return -1;\n            }\n            final long maxRead = max >= 0 ? Math.min(len, max - pos) : len;\n            final int bytesRead = in.read(b, off, (int) maxRead);\n\n            if (bytesRead == -1) {\n                return -1;\n            }\n\n            pos += bytesRead;\n            count(bytesRead);\n            current.bytesReadFromStream += bytesRead;\n            return bytesRead;\n        }"
  },
  {
    "id": 6,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 38,
    "human_patch": "https://github.com/apache/commons-compress/commit/a41ce6892cb0590b2e658704434ac0dbcb6834c8",
    "cve_id": "CVE-2018-11771",
    "cwe_id": "CWE-835",
    "filename": "src/main/java/org/apache/commons/compress/archivers/zip/ZipArchiveInputStream.java",
    "is_vulnerable": 0,
    "class_name": "ZipArchiveInputStream",
    "subclass_name": "BoundedInputStream",
    "function_name": "skip(final long n) throws IOException",
    "function_body": "{\n            final long toSkip = max >= 0 ? Math.min(n, max - pos) : n;\n            final long skippedBytes = IOUtils.skip(in, toSkip);\n            pos += skippedBytes;\n            return skippedBytes;\n        }"
  },
  {
    "id": 6,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 39,
    "human_patch": "https://github.com/apache/commons-compress/commit/a41ce6892cb0590b2e658704434ac0dbcb6834c8",
    "cve_id": "CVE-2018-11771",
    "cwe_id": "CWE-835",
    "filename": "src/main/java/org/apache/commons/compress/archivers/zip/ZipArchiveInputStream.java",
    "is_vulnerable": 0,
    "class_name": "ZipArchiveInputStream",
    "subclass_name": "BoundedInputStream",
    "function_name": "available() throws IOException",
    "function_body": "{\n            if (max >= 0 && pos >= max) {\n                return 0;\n            }\n            return in.available();\n        }"
  },
  {
    "id": 6,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 0,
    "human_patch": "https://github.com/apache/commons-compress/commit/a41ce6892cb0590b2e658704434ac0dbcb6834c8",
    "cve_id": "CVE-2018-11771",
    "cwe_id": "CWE-835",
    "filename": "src/test/java/org/apache/commons/compress/archivers/zip/Maven221MultiVolumeTest.java",
    "is_vulnerable": 1,
    "class_name": "Maven221MultiVolumeTest",
    "subclass_name": null,
    "function_name": "testRead7ZipMultiVolumeArchiveForStream() throws IOException",
    "function_body": "{\n\n        final FileInputStream archive =\n            new FileInputStream(getFile(\"apache-maven-2.2.1.zip.001\"));\n        ZipArchiveInputStream zi = null;\n        try {\n            zi = new ZipArchiveInputStream(archive,null,false);\n\n            \n            \n            for (final String element : ENTRIES) {\n                assertEquals(element, zi.getNextEntry().getName());\n            }\n\n            \n            final ArchiveEntry lastEntry = zi.getNextEntry();\n            assertEquals(LAST_ENTRY_NAME, lastEntry.getName());\n            final byte [] buffer = new byte [4096];\n\n            \n            \n            \n            \n            try {\n                while (zi.read(buffer) > 0) { }\n                fail(\"shouldn't be able to read from truncated entry\");\n            } catch (final IOException e) {\n                assertEquals(\"Truncated ZIP file\", e.getMessage());\n            }\n\n            \n            \n            try {\n                zi.getNextEntry();\n                fail(\"shouldn't be able to read another entry from truncated\"\n                     + \" file\");\n            } catch (final IOException e) {\n                \n            }\n        } finally {\n            if (zi != null) {\n                zi.close();\n            }\n        }\n    }"
  },
  {
    "id": 6,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 1,
    "human_patch": "https://github.com/apache/commons-compress/commit/a41ce6892cb0590b2e658704434ac0dbcb6834c8",
    "cve_id": "CVE-2018-11771",
    "cwe_id": "CWE-835",
    "filename": "src/test/java/org/apache/commons/compress/archivers/zip/Maven221MultiVolumeTest.java",
    "is_vulnerable": 0,
    "class_name": "Maven221MultiVolumeTest",
    "subclass_name": null,
    "function_name": "testRead7ZipMultiVolumeArchiveForFile() throws IOException",
    "function_body": "{\n        final File file = getFile(\"apache-maven-2.2.1.zip.001\");\n        ZipFile zf = new ZipFile(file);\n        zf.close();\n    }"
  },
  {
    "id": 6,
    "sub_id": 2,
    "code_id": 0,
    "function_id": 0,
    "human_patch": "https://github.com/apache/commons-compress/commit/a41ce6892cb0590b2e658704434ac0dbcb6834c8",
    "cve_id": "CVE-2018-11771",
    "cwe_id": "CWE-835",
    "filename": "src/test/java/org/apache/commons/compress/archivers/zip/ZipArchiveInputStreamTest.java",
    "is_vulnerable": 0,
    "class_name": "ZipArchiveInputStreamTest",
    "subclass_name": null,
    "function_name": "winzipBackSlashWorkaround() throws Exception",
    "function_body": "{\n        ZipArchiveInputStream in = null;\n        try {\n            in = new ZipArchiveInputStream(new FileInputStream(getFile(\"test-winzip.zip\")));\n            ZipArchiveEntry zae = in.getNextZipEntry();\n            zae = in.getNextZipEntry();\n            zae = in.getNextZipEntry();\n            assertEquals(\"\\u00e4/\", zae.getName());\n        } finally {\n            if (in != null) {\n                in.close();\n            }\n        }\n    }"
  },
  {
    "id": 6,
    "sub_id": 2,
    "code_id": 0,
    "function_id": 1,
    "human_patch": "https://github.com/apache/commons-compress/commit/a41ce6892cb0590b2e658704434ac0dbcb6834c8",
    "cve_id": "CVE-2018-11771",
    "cwe_id": "CWE-835",
    "filename": "src/test/java/org/apache/commons/compress/archivers/zip/ZipArchiveInputStreamTest.java",
    "is_vulnerable": 0,
    "class_name": "ZipArchiveInputStreamTest",
    "subclass_name": null,
    "function_name": "properUseOfInflater() throws Exception",
    "function_body": "{\n        ZipFile zf = null;\n        ZipArchiveInputStream in = null;\n        try {\n            zf = new ZipFile(getFile(\"COMPRESS-189.zip\"));\n            final ZipArchiveEntry zae = zf.getEntry(\"USD0558682-20080101.ZIP\");\n            in = new ZipArchiveInputStream(new BufferedInputStream(zf.getInputStream(zae)));\n            ZipArchiveEntry innerEntry;\n            while ((innerEntry = in.getNextZipEntry()) != null) {\n                if (innerEntry.getName().endsWith(\"XML\")) {\n                    assertTrue(0 < in.read());\n                }\n            }\n        } finally {\n            if (zf != null) {\n                zf.close();\n            }\n            if (in != null) {\n                in.close();\n            }\n        }\n    }"
  },
  {
    "id": 6,
    "sub_id": 2,
    "code_id": 0,
    "function_id": 2,
    "human_patch": "https://github.com/apache/commons-compress/commit/a41ce6892cb0590b2e658704434ac0dbcb6834c8",
    "cve_id": "CVE-2018-11771",
    "cwe_id": "CWE-835",
    "filename": "src/test/java/org/apache/commons/compress/archivers/zip/ZipArchiveInputStreamTest.java",
    "is_vulnerable": 0,
    "class_name": "ZipArchiveInputStreamTest",
    "subclass_name": null,
    "function_name": "shouldConsumeArchiveCompletely() throws Exception",
    "function_body": "{\n        final InputStream is = ZipArchiveInputStreamTest.class\n            .getResourceAsStream(\"/archive_with_trailer.zip\");\n        final ZipArchiveInputStream zip = new ZipArchiveInputStream(is);\n        while (zip.getNextZipEntry() != null) {\n            \n        }\n        final byte[] expected = new byte[] {\n            'H', 'e', 'l', 'l', 'o', ',', ' ', 'w', 'o', 'r', 'l', 'd', '!', '\\n'\n        };\n        final byte[] actual = new byte[expected.length];\n        is.read(actual);\n        assertArrayEquals(expected, actual);\n        zip.close();\n    }"
  },
  {
    "id": 6,
    "sub_id": 2,
    "code_id": 0,
    "function_id": 3,
    "human_patch": "https://github.com/apache/commons-compress/commit/a41ce6892cb0590b2e658704434ac0dbcb6834c8",
    "cve_id": "CVE-2018-11771",
    "cwe_id": "CWE-835",
    "filename": "src/test/java/org/apache/commons/compress/archivers/zip/ZipArchiveInputStreamTest.java",
    "is_vulnerable": 0,
    "class_name": "ZipArchiveInputStreamTest",
    "subclass_name": null,
    "function_name": "shouldReadNestedZip() throws IOException",
    "function_body": "{\n        ZipArchiveInputStream in = null;\n        try {\n            in = new ZipArchiveInputStream(new FileInputStream(getFile(\"COMPRESS-219.zip\")));\n            extractZipInputStream(in);\n        } finally {\n            if (in != null) {\n                in.close();\n            }\n        }\n    }"
  },
  {
    "id": 6,
    "sub_id": 2,
    "code_id": 0,
    "function_id": 4,
    "human_patch": "https://github.com/apache/commons-compress/commit/a41ce6892cb0590b2e658704434ac0dbcb6834c8",
    "cve_id": "CVE-2018-11771",
    "cwe_id": "CWE-835",
    "filename": "src/test/java/org/apache/commons/compress/archivers/zip/ZipArchiveInputStreamTest.java",
    "is_vulnerable": 0,
    "class_name": "ZipArchiveInputStreamTest",
    "subclass_name": null,
    "function_name": "extractZipInputStream(final ZipArchiveInputStream in) throws IOException",
    "function_body": "{\n        ZipArchiveEntry zae = in.getNextZipEntry();\n        while (zae != null) {\n            if (zae.getName().endsWith(\".zip\")) {\n                extractZipInputStream(new ZipArchiveInputStream(in));\n            }\n            zae = in.getNextZipEntry();\n        }\n    }"
  },
  {
    "id": 6,
    "sub_id": 2,
    "code_id": 0,
    "function_id": 5,
    "human_patch": "https://github.com/apache/commons-compress/commit/a41ce6892cb0590b2e658704434ac0dbcb6834c8",
    "cve_id": "CVE-2018-11771",
    "cwe_id": "CWE-835",
    "filename": "src/test/java/org/apache/commons/compress/archivers/zip/ZipArchiveInputStreamTest.java",
    "is_vulnerable": 0,
    "class_name": "ZipArchiveInputStreamTest",
    "subclass_name": null,
    "function_name": "testUnshrinkEntry() throws Exception",
    "function_body": "{\n        final ZipArchiveInputStream in = new ZipArchiveInputStream(new FileInputStream(getFile(\"SHRUNK.ZIP\")));\n\n        ZipArchiveEntry entry = in.getNextZipEntry();\n        assertEquals(\"method\", ZipMethod.UNSHRINKING.getCode(), entry.getMethod());\n        assertTrue(in.canReadEntryData(entry));\n\n        FileInputStream original = new FileInputStream(getFile(\"test1.xml\"));\n        try {\n            assertArrayEquals(IOUtils.toByteArray(original), IOUtils.toByteArray(in));\n        } finally {\n            original.close();\n        }\n\n        entry = in.getNextZipEntry();\n        assertEquals(\"method\", ZipMethod.UNSHRINKING.getCode(), entry.getMethod());\n        assertTrue(in.canReadEntryData(entry));\n\n        original = new FileInputStream(getFile(\"test2.xml\"));\n        try {\n            assertArrayEquals(IOUtils.toByteArray(original), IOUtils.toByteArray(in));\n        } finally {\n            original.close();\n        }\n    }"
  },
  {
    "id": 6,
    "sub_id": 2,
    "code_id": 0,
    "function_id": 6,
    "human_patch": "https://github.com/apache/commons-compress/commit/a41ce6892cb0590b2e658704434ac0dbcb6834c8",
    "cve_id": "CVE-2018-11771",
    "cwe_id": "CWE-835",
    "filename": "src/test/java/org/apache/commons/compress/archivers/zip/ZipArchiveInputStreamTest.java",
    "is_vulnerable": 0,
    "class_name": "ZipArchiveInputStreamTest",
    "subclass_name": null,
    "function_name": "testReadingOfFirstStoredEntry() throws Exception",
    "function_body": "{\n\n        try (ZipArchiveInputStream in = new ZipArchiveInputStream(new FileInputStream(getFile(\"COMPRESS-264.zip\")))) {\n            final ZipArchiveEntry ze = in.getNextZipEntry();\n            assertEquals(5, ze.getSize());\n            assertArrayEquals(new byte[] { 'd', 'a', 't', 'a', '\\n' },\n                    IOUtils.toByteArray(in));\n        }\n    }"
  },
  {
    "id": 6,
    "sub_id": 2,
    "code_id": 0,
    "function_id": 7,
    "human_patch": "https://github.com/apache/commons-compress/commit/a41ce6892cb0590b2e658704434ac0dbcb6834c8",
    "cve_id": "CVE-2018-11771",
    "cwe_id": "CWE-835",
    "filename": "src/test/java/org/apache/commons/compress/archivers/zip/ZipArchiveInputStreamTest.java",
    "is_vulnerable": 0,
    "class_name": "ZipArchiveInputStreamTest",
    "subclass_name": null,
    "function_name": "testMessageWithCorruptFileName() throws Exception",
    "function_body": "{\n        try (ZipArchiveInputStream in = new ZipArchiveInputStream(new FileInputStream(getFile(\"COMPRESS-351.zip\")))) {\n            ZipArchiveEntry ze = in.getNextZipEntry();\n            while (ze != null) {\n                ze = in.getNextZipEntry();\n            }\n            fail(\"expected EOFException\");\n        } catch (final EOFException ex) {\n            final String m = ex.getMessage();\n            assertTrue(m.startsWith(\"Truncated ZIP entry: ?2016\")); \n        }\n    }"
  },
  {
    "id": 6,
    "sub_id": 2,
    "code_id": 0,
    "function_id": 8,
    "human_patch": "https://github.com/apache/commons-compress/commit/a41ce6892cb0590b2e658704434ac0dbcb6834c8",
    "cve_id": "CVE-2018-11771",
    "cwe_id": "CWE-835",
    "filename": "src/test/java/org/apache/commons/compress/archivers/zip/ZipArchiveInputStreamTest.java",
    "is_vulnerable": 0,
    "class_name": "ZipArchiveInputStreamTest",
    "subclass_name": null,
    "function_name": "testUnzipBZip2CompressedEntry() throws Exception",
    "function_body": "{\n\n        try (ZipArchiveInputStream in = new ZipArchiveInputStream(new FileInputStream(getFile(\"bzip2-zip.zip\")))) {\n            final ZipArchiveEntry ze = in.getNextZipEntry();\n            assertEquals(42, ze.getSize());\n            final byte[] expected = new byte[42];\n            Arrays.fill(expected, (byte) 'a');\n            assertArrayEquals(expected, IOUtils.toByteArray(in));\n        }\n    }"
  },
  {
    "id": 6,
    "sub_id": 2,
    "code_id": 0,
    "function_id": 9,
    "human_patch": "https://github.com/apache/commons-compress/commit/a41ce6892cb0590b2e658704434ac0dbcb6834c8",
    "cve_id": "CVE-2018-11771",
    "cwe_id": "CWE-835",
    "filename": "src/test/java/org/apache/commons/compress/archivers/zip/ZipArchiveInputStreamTest.java",
    "is_vulnerable": 0,
    "class_name": "ZipArchiveInputStreamTest",
    "subclass_name": null,
    "function_name": "readDeflate64CompressedStream() throws Exception",
    "function_body": "{\n        final File input = getFile(\"COMPRESS-380/COMPRESS-380-input\");\n        final File archive = getFile(\"COMPRESS-380/COMPRESS-380.zip\");\n        try (FileInputStream in = new FileInputStream(input);\n             ZipArchiveInputStream zin = new ZipArchiveInputStream(new FileInputStream(archive))) {\n            byte[] orig = IOUtils.toByteArray(in);\n            ZipArchiveEntry e = zin.getNextZipEntry();\n            byte[] fromZip = IOUtils.toByteArray(zin);\n            assertArrayEquals(orig, fromZip);\n        }\n    }"
  },
  {
    "id": 6,
    "sub_id": 2,
    "code_id": 0,
    "function_id": 10,
    "human_patch": "https://github.com/apache/commons-compress/commit/a41ce6892cb0590b2e658704434ac0dbcb6834c8",
    "cve_id": "CVE-2018-11771",
    "cwe_id": "CWE-835",
    "filename": "src/test/java/org/apache/commons/compress/archivers/zip/ZipArchiveInputStreamTest.java",
    "is_vulnerable": 0,
    "class_name": "ZipArchiveInputStreamTest",
    "subclass_name": null,
    "function_name": "readDeflate64CompressedStreamWithDataDescriptor() throws Exception",
    "function_body": "{\n        \n        final File archive = getFile(\"COMPRESS-380/COMPRESS-380-dd.zip\");\n        try (ZipArchiveInputStream zin = new ZipArchiveInputStream(new FileInputStream(archive))) {\n            ZipArchiveEntry e = zin.getNextZipEntry();\n            assertEquals(-1, e.getSize());\n            assertEquals(ZipMethod.ENHANCED_DEFLATED.getCode(), e.getMethod());\n            byte[] fromZip = IOUtils.toByteArray(zin);\n            byte[] expected = new byte[] {\n                'M', 'a', 'n', 'i', 'f', 'e', 's', 't', '-', 'V', 'e', 'r', 's', 'i', 'o', 'n', ':', ' ', '1', '.', '0',\n                '\\r', '\\n', '\\r', '\\n'\n            };\n            assertArrayEquals(expected, fromZip);\n            zin.getNextZipEntry();\n            assertEquals(25, e.getSize());\n        }\n    }"
  },
  {
    "id": 6,
    "sub_id": 2,
    "code_id": 0,
    "function_id": 11,
    "human_patch": "https://github.com/apache/commons-compress/commit/a41ce6892cb0590b2e658704434ac0dbcb6834c8",
    "cve_id": "CVE-2018-11771",
    "cwe_id": "CWE-835",
    "filename": "src/test/java/org/apache/commons/compress/archivers/zip/ZipArchiveInputStreamTest.java",
    "is_vulnerable": 0,
    "class_name": "ZipArchiveInputStreamTest",
    "subclass_name": null,
    "function_name": "testWithBytesAfterData() throws Exception",
    "function_body": "{\n        final int expectedNumEntries = 2;\n        final InputStream is = ZipArchiveInputStreamTest.class\n                .getResourceAsStream(\"/archive_with_bytes_after_data.zip\");\n        final ZipArchiveInputStream zip = new ZipArchiveInputStream(is);\n\n        try {\n            int actualNumEntries = 0;\n            ZipArchiveEntry zae = zip.getNextZipEntry();\n            while (zae != null) {\n                actualNumEntries++;\n                readEntry(zip, zae);\n                zae = zip.getNextZipEntry();\n            }\n            assertEquals(expectedNumEntries, actualNumEntries);\n        } finally {\n            zip.close();\n        }\n    }"
  },
  {
    "id": 6,
    "sub_id": 2,
    "code_id": 0,
    "function_id": 12,
    "human_patch": "https://github.com/apache/commons-compress/commit/a41ce6892cb0590b2e658704434ac0dbcb6834c8",
    "cve_id": "CVE-2018-11771",
    "cwe_id": "CWE-835",
    "filename": "src/test/java/org/apache/commons/compress/archivers/zip/ZipArchiveInputStreamTest.java",
    "is_vulnerable": 0,
    "class_name": "ZipArchiveInputStreamTest",
    "subclass_name": null,
    "function_name": "testThrowOnInvalidEntry() throws Exception",
    "function_body": "{\n        final InputStream is = ZipArchiveInputStreamTest.class\n                .getResourceAsStream(\"/invalid-zip.zip\");\n        final ZipArchiveInputStream zip = new ZipArchiveInputStream(is);\n\n        try {\n            zip.getNextZipEntry();\n            fail(\"IOException expected\");\n        } catch (ZipException expected) {\n            assertTrue(expected.getMessage().contains(\"Unexpected record signature\"));\n        } finally {\n            zip.close();\n        }\n    }"
  },
  {
    "id": 6,
    "sub_id": 2,
    "code_id": 0,
    "function_id": 13,
    "human_patch": "https://github.com/apache/commons-compress/commit/a41ce6892cb0590b2e658704434ac0dbcb6834c8",
    "cve_id": "CVE-2018-11771",
    "cwe_id": "CWE-835",
    "filename": "src/test/java/org/apache/commons/compress/archivers/zip/ZipArchiveInputStreamTest.java",
    "is_vulnerable": 0,
    "class_name": "ZipArchiveInputStreamTest",
    "subclass_name": null,
    "function_name": "testOffsets() throws Exception",
    "function_body": "{\n        \n        try (InputStream archiveStream = ZipArchiveInputStream.class.getResourceAsStream(\"/mixed.zip\");\n             ZipArchiveInputStream zipStream =  new ZipArchiveInputStream((archiveStream))\n        ) {\n            ZipArchiveEntry inflatedEntry = zipStream.getNextZipEntry();\n            Assert.assertEquals(\"inflated.txt\", inflatedEntry.getName());\n            Assert.assertEquals(0x0000, inflatedEntry.getLocalHeaderOffset());\n            Assert.assertEquals(0x0046, inflatedEntry.getDataOffset());\n            ZipArchiveEntry storedEntry = zipStream.getNextZipEntry();\n            Assert.assertEquals(\"stored.txt\", storedEntry.getName());\n            Assert.assertEquals(0x5892, storedEntry.getLocalHeaderOffset());\n            Assert.assertEquals(0x58d6, storedEntry.getDataOffset());\n            Assert.assertNull(zipStream.getNextZipEntry());\n        }\n    }"
  },
  {
    "id": 6,
    "sub_id": 2,
    "code_id": 0,
    "function_id": 14,
    "human_patch": "https://github.com/apache/commons-compress/commit/a41ce6892cb0590b2e658704434ac0dbcb6834c8",
    "cve_id": "CVE-2018-11771",
    "cwe_id": "CWE-835",
    "filename": "src/test/java/org/apache/commons/compress/archivers/zip/ZipArchiveInputStreamTest.java",
    "is_vulnerable": 0,
    "class_name": "ZipArchiveInputStreamTest",
    "subclass_name": null,
    "function_name": "nameSourceDefaultsToName() throws Exception",
    "function_body": "{\n        nameSource(\"bla.zip\", \"test1.xml\", ZipArchiveEntry.NameSource.NAME);\n    }"
  },
  {
    "id": 6,
    "sub_id": 2,
    "code_id": 0,
    "function_id": 15,
    "human_patch": "https://github.com/apache/commons-compress/commit/a41ce6892cb0590b2e658704434ac0dbcb6834c8",
    "cve_id": "CVE-2018-11771",
    "cwe_id": "CWE-835",
    "filename": "src/test/java/org/apache/commons/compress/archivers/zip/ZipArchiveInputStreamTest.java",
    "is_vulnerable": 0,
    "class_name": "ZipArchiveInputStreamTest",
    "subclass_name": null,
    "function_name": "nameSourceIsSetToUnicodeExtraField() throws Exception",
    "function_body": "{\n        nameSource(\"utf8-winzip-test.zip\", \"\\u20AC_for_Dollar.txt\",\n                   ZipArchiveEntry.NameSource.UNICODE_EXTRA_FIELD);\n    }"
  },
  {
    "id": 6,
    "sub_id": 2,
    "code_id": 0,
    "function_id": 16,
    "human_patch": "https://github.com/apache/commons-compress/commit/a41ce6892cb0590b2e658704434ac0dbcb6834c8",
    "cve_id": "CVE-2018-11771",
    "cwe_id": "CWE-835",
    "filename": "src/test/java/org/apache/commons/compress/archivers/zip/ZipArchiveInputStreamTest.java",
    "is_vulnerable": 0,
    "class_name": "ZipArchiveInputStreamTest",
    "subclass_name": null,
    "function_name": "nameSourceIsSetToEFS() throws Exception",
    "function_body": "{\n        nameSource(\"utf8-7zip-test.zip\", \"\\u20AC_for_Dollar.txt\", 3,\n                   ZipArchiveEntry.NameSource.NAME_WITH_EFS_FLAG);\n    }"
  },
  {
    "id": 6,
    "sub_id": 2,
    "code_id": 0,
    "function_id": 17,
    "human_patch": "https://github.com/apache/commons-compress/commit/a41ce6892cb0590b2e658704434ac0dbcb6834c8",
    "cve_id": "CVE-2018-11771",
    "cwe_id": "CWE-835",
    "filename": "src/test/java/org/apache/commons/compress/archivers/zip/ZipArchiveInputStreamTest.java",
    "is_vulnerable": 0,
    "class_name": "ZipArchiveInputStreamTest",
    "subclass_name": null,
    "function_name": "properlyMarksEntriesAsUnreadableIfUncompressedSizeIsUnknown() throws Exception",
    "function_body": "{\n        \n        try (ZipArchiveInputStream zis = new ZipArchiveInputStream(new ByteArrayInputStream(new byte[0]))) {\n            ZipArchiveEntry e = new ZipArchiveEntry(\"test\");\n            e.setMethod(ZipMethod.DEFLATED.getCode());\n            assertTrue(zis.canReadEntryData(e));\n            e.setMethod(ZipMethod.ENHANCED_DEFLATED.getCode());\n            assertTrue(zis.canReadEntryData(e));\n            e.setMethod(ZipMethod.BZIP2.getCode());\n            assertFalse(zis.canReadEntryData(e));\n        }\n    }"
  },
  {
    "id": 6,
    "sub_id": 2,
    "code_id": 0,
    "function_id": 18,
    "human_patch": "https://github.com/apache/commons-compress/commit/a41ce6892cb0590b2e658704434ac0dbcb6834c8",
    "cve_id": "CVE-2018-11771",
    "cwe_id": "CWE-835",
    "filename": "src/test/java/org/apache/commons/compress/archivers/zip/ZipArchiveInputStreamTest.java",
    "is_vulnerable": 0,
    "class_name": "ZipArchiveInputStreamTest",
    "subclass_name": null,
    "function_name": "singleByteReadConsistentlyReturnsMinusOneAtEofUsingDeflate() throws Exception",
    "function_body": "{\n        singleByteReadConsistentlyReturnsMinusOneAtEof(getFile(\"bla.zip\"));\n    }"
  },
  {
    "id": 6,
    "sub_id": 2,
    "code_id": 0,
    "function_id": 19,
    "human_patch": "https://github.com/apache/commons-compress/commit/a41ce6892cb0590b2e658704434ac0dbcb6834c8",
    "cve_id": "CVE-2018-11771",
    "cwe_id": "CWE-835",
    "filename": "src/test/java/org/apache/commons/compress/archivers/zip/ZipArchiveInputStreamTest.java",
    "is_vulnerable": 0,
    "class_name": "ZipArchiveInputStreamTest",
    "subclass_name": null,
    "function_name": "singleByteReadConsistentlyReturnsMinusOneAtEofUsingStore() throws Exception",
    "function_body": "{\n        singleByteReadConsistentlyReturnsMinusOneAtEof(getFile(\"COMPRESS-264.zip\"));\n    }"
  },
  {
    "id": 6,
    "sub_id": 2,
    "code_id": 0,
    "function_id": 20,
    "human_patch": "https://github.com/apache/commons-compress/commit/a41ce6892cb0590b2e658704434ac0dbcb6834c8",
    "cve_id": "CVE-2018-11771",
    "cwe_id": "CWE-835",
    "filename": "src/test/java/org/apache/commons/compress/archivers/zip/ZipArchiveInputStreamTest.java",
    "is_vulnerable": 0,
    "class_name": "ZipArchiveInputStreamTest",
    "subclass_name": null,
    "function_name": "singleByteReadConsistentlyReturnsMinusOneAtEofUsingUnshrink() throws Exception",
    "function_body": "{\n        singleByteReadConsistentlyReturnsMinusOneAtEof(getFile(\"SHRUNK.ZIP\"));\n    }"
  },
  {
    "id": 6,
    "sub_id": 2,
    "code_id": 0,
    "function_id": 21,
    "human_patch": "https://github.com/apache/commons-compress/commit/a41ce6892cb0590b2e658704434ac0dbcb6834c8",
    "cve_id": "CVE-2018-11771",
    "cwe_id": "CWE-835",
    "filename": "src/test/java/org/apache/commons/compress/archivers/zip/ZipArchiveInputStreamTest.java",
    "is_vulnerable": 0,
    "class_name": "ZipArchiveInputStreamTest",
    "subclass_name": null,
    "function_name": "singleByteReadConsistentlyReturnsMinusOneAtEofUsingExplode() throws Exception",
    "function_body": "{\n        singleByteReadConsistentlyReturnsMinusOneAtEof(getFile(\"imploding-8Kdict-3trees.zip\"));\n    }"
  },
  {
    "id": 6,
    "sub_id": 2,
    "code_id": 0,
    "function_id": 22,
    "human_patch": "https://github.com/apache/commons-compress/commit/a41ce6892cb0590b2e658704434ac0dbcb6834c8",
    "cve_id": "CVE-2018-11771",
    "cwe_id": "CWE-835",
    "filename": "src/test/java/org/apache/commons/compress/archivers/zip/ZipArchiveInputStreamTest.java",
    "is_vulnerable": 0,
    "class_name": "ZipArchiveInputStreamTest",
    "subclass_name": null,
    "function_name": "singleByteReadConsistentlyReturnsMinusOneAtEofUsingDeflate64() throws Exception",
    "function_body": "{\n        singleByteReadConsistentlyReturnsMinusOneAtEof(getFile(\"COMPRESS-380/COMPRESS-380.zip\"));\n    }"
  },
  {
    "id": 6,
    "sub_id": 2,
    "code_id": 0,
    "function_id": 23,
    "human_patch": "https://github.com/apache/commons-compress/commit/a41ce6892cb0590b2e658704434ac0dbcb6834c8",
    "cve_id": "CVE-2018-11771",
    "cwe_id": "CWE-835",
    "filename": "src/test/java/org/apache/commons/compress/archivers/zip/ZipArchiveInputStreamTest.java",
    "is_vulnerable": 0,
    "class_name": "ZipArchiveInputStreamTest",
    "subclass_name": null,
    "function_name": "singleByteReadConsistentlyReturnsMinusOneAtEofUsingBzip2() throws Exception",
    "function_body": "{\n        singleByteReadConsistentlyReturnsMinusOneAtEof(getFile(\"bzip2-zip.zip\"));\n    }"
  },
  {
    "id": 6,
    "sub_id": 2,
    "code_id": 0,
    "function_id": 24,
    "human_patch": "https://github.com/apache/commons-compress/commit/a41ce6892cb0590b2e658704434ac0dbcb6834c8",
    "cve_id": "CVE-2018-11771",
    "cwe_id": "CWE-835",
    "filename": "src/test/java/org/apache/commons/compress/archivers/zip/ZipArchiveInputStreamTest.java",
    "is_vulnerable": 0,
    "class_name": "ZipArchiveInputStreamTest",
    "subclass_name": null,
    "function_name": "singleByteReadConsistentlyReturnsMinusOneAtEof(File file) throws Exception",
    "function_body": "{\n        try (FileInputStream in = new FileInputStream(file);\n             ZipArchiveInputStream archive = new ZipArchiveInputStream(in)) {\n            ArchiveEntry e = archive.getNextEntry();\n            IOUtils.toByteArray(archive);\n            assertEquals(-1, archive.read());\n            assertEquals(-1, archive.read());\n        }\n    }"
  },
  {
    "id": 6,
    "sub_id": 2,
    "code_id": 0,
    "function_id": 25,
    "human_patch": "https://github.com/apache/commons-compress/commit/a41ce6892cb0590b2e658704434ac0dbcb6834c8",
    "cve_id": "CVE-2018-11771",
    "cwe_id": "CWE-835",
    "filename": "src/test/java/org/apache/commons/compress/archivers/zip/ZipArchiveInputStreamTest.java",
    "is_vulnerable": 0,
    "class_name": "ZipArchiveInputStreamTest",
    "subclass_name": null,
    "function_name": "multiByteReadConsistentlyReturnsMinusOneAtEofUsingDeflate() throws Exception",
    "function_body": "{\n        multiByteReadConsistentlyReturnsMinusOneAtEof(getFile(\"bla.zip\"));\n    }"
  },
  {
    "id": 6,
    "sub_id": 2,
    "code_id": 0,
    "function_id": 26,
    "human_patch": "https://github.com/apache/commons-compress/commit/a41ce6892cb0590b2e658704434ac0dbcb6834c8",
    "cve_id": "CVE-2018-11771",
    "cwe_id": "CWE-835",
    "filename": "src/test/java/org/apache/commons/compress/archivers/zip/ZipArchiveInputStreamTest.java",
    "is_vulnerable": 0,
    "class_name": "ZipArchiveInputStreamTest",
    "subclass_name": null,
    "function_name": "multiByteReadConsistentlyReturnsMinusOneAtEofUsingStore() throws Exception",
    "function_body": "{\n        multiByteReadConsistentlyReturnsMinusOneAtEof(getFile(\"COMPRESS-264.zip\"));\n    }"
  },
  {
    "id": 6,
    "sub_id": 2,
    "code_id": 0,
    "function_id": 27,
    "human_patch": "https://github.com/apache/commons-compress/commit/a41ce6892cb0590b2e658704434ac0dbcb6834c8",
    "cve_id": "CVE-2018-11771",
    "cwe_id": "CWE-835",
    "filename": "src/test/java/org/apache/commons/compress/archivers/zip/ZipArchiveInputStreamTest.java",
    "is_vulnerable": 0,
    "class_name": "ZipArchiveInputStreamTest",
    "subclass_name": null,
    "function_name": "multiByteReadConsistentlyReturnsMinusOneAtEofUsingUnshrink() throws Exception",
    "function_body": "{\n        multiByteReadConsistentlyReturnsMinusOneAtEof(getFile(\"SHRUNK.ZIP\"));\n    }"
  },
  {
    "id": 6,
    "sub_id": 2,
    "code_id": 0,
    "function_id": 28,
    "human_patch": "https://github.com/apache/commons-compress/commit/a41ce6892cb0590b2e658704434ac0dbcb6834c8",
    "cve_id": "CVE-2018-11771",
    "cwe_id": "CWE-835",
    "filename": "src/test/java/org/apache/commons/compress/archivers/zip/ZipArchiveInputStreamTest.java",
    "is_vulnerable": 0,
    "class_name": "ZipArchiveInputStreamTest",
    "subclass_name": null,
    "function_name": "multiByteReadConsistentlyReturnsMinusOneAtEofUsingExplode() throws Exception",
    "function_body": "{\n        multiByteReadConsistentlyReturnsMinusOneAtEof(getFile(\"imploding-8Kdict-3trees.zip\"));\n    }"
  },
  {
    "id": 6,
    "sub_id": 2,
    "code_id": 0,
    "function_id": 29,
    "human_patch": "https://github.com/apache/commons-compress/commit/a41ce6892cb0590b2e658704434ac0dbcb6834c8",
    "cve_id": "CVE-2018-11771",
    "cwe_id": "CWE-835",
    "filename": "src/test/java/org/apache/commons/compress/archivers/zip/ZipArchiveInputStreamTest.java",
    "is_vulnerable": 0,
    "class_name": "ZipArchiveInputStreamTest",
    "subclass_name": null,
    "function_name": "multiByteReadConsistentlyReturnsMinusOneAtEofUsingDeflate64() throws Exception",
    "function_body": "{\n        multiByteReadConsistentlyReturnsMinusOneAtEof(getFile(\"COMPRESS-380/COMPRESS-380.zip\"));\n    }"
  },
  {
    "id": 6,
    "sub_id": 2,
    "code_id": 0,
    "function_id": 30,
    "human_patch": "https://github.com/apache/commons-compress/commit/a41ce6892cb0590b2e658704434ac0dbcb6834c8",
    "cve_id": "CVE-2018-11771",
    "cwe_id": "CWE-835",
    "filename": "src/test/java/org/apache/commons/compress/archivers/zip/ZipArchiveInputStreamTest.java",
    "is_vulnerable": 0,
    "class_name": "ZipArchiveInputStreamTest",
    "subclass_name": null,
    "function_name": "multiByteReadConsistentlyReturnsMinusOneAtEofUsingBzip2() throws Exception",
    "function_body": "{\n        multiByteReadConsistentlyReturnsMinusOneAtEof(getFile(\"bzip2-zip.zip\"));\n    }"
  },
  {
    "id": 6,
    "sub_id": 2,
    "code_id": 0,
    "function_id": 31,
    "human_patch": "https://github.com/apache/commons-compress/commit/a41ce6892cb0590b2e658704434ac0dbcb6834c8",
    "cve_id": "CVE-2018-11771",
    "cwe_id": "CWE-835",
    "filename": "src/test/java/org/apache/commons/compress/archivers/zip/ZipArchiveInputStreamTest.java",
    "is_vulnerable": 0,
    "class_name": "ZipArchiveInputStreamTest",
    "subclass_name": null,
    "function_name": "multiByteReadConsistentlyReturnsMinusOneAtEof(File file) throws Exception",
    "function_body": "{\n        byte[] buf = new byte[2];\n        try (FileInputStream in = new FileInputStream(getFile(\"bla.zip\"));\n             ZipArchiveInputStream archive = new ZipArchiveInputStream(in)) {\n            ArchiveEntry e = archive.getNextEntry();\n            IOUtils.toByteArray(archive);\n            assertEquals(-1, archive.read(buf));\n            assertEquals(-1, archive.read(buf));\n        }\n    }"
  },
  {
    "id": 6,
    "sub_id": 2,
    "code_id": 0,
    "function_id": 32,
    "human_patch": "https://github.com/apache/commons-compress/commit/a41ce6892cb0590b2e658704434ac0dbcb6834c8",
    "cve_id": "CVE-2018-11771",
    "cwe_id": "CWE-835",
    "filename": "src/test/java/org/apache/commons/compress/archivers/zip/ZipArchiveInputStreamTest.java",
    "is_vulnerable": 0,
    "class_name": "ZipArchiveInputStreamTest",
    "subclass_name": null,
    "function_name": "readEntry(ZipArchiveInputStream zip, ZipArchiveEntry zae) throws IOException",
    "function_body": "{\n        final int len = (int)zae.getSize();\n        final byte[] buff = new byte[len];\n        zip.read(buff, 0, len);\n\n        return buff;\n    }"
  },
  {
    "id": 6,
    "sub_id": 2,
    "code_id": 0,
    "function_id": 33,
    "human_patch": "https://github.com/apache/commons-compress/commit/a41ce6892cb0590b2e658704434ac0dbcb6834c8",
    "cve_id": "CVE-2018-11771",
    "cwe_id": "CWE-835",
    "filename": "src/test/java/org/apache/commons/compress/archivers/zip/ZipArchiveInputStreamTest.java",
    "is_vulnerable": 0,
    "class_name": "ZipArchiveInputStreamTest",
    "subclass_name": null,
    "function_name": "nameSource(String archive, String entry, ZipArchiveEntry.NameSource expected) throws Exception",
    "function_body": "{\n        nameSource(archive, entry, 1, expected);\n    }"
  },
  {
    "id": 6,
    "sub_id": 2,
    "code_id": 0,
    "function_id": 34,
    "human_patch": "https://github.com/apache/commons-compress/commit/a41ce6892cb0590b2e658704434ac0dbcb6834c8",
    "cve_id": "CVE-2018-11771",
    "cwe_id": "CWE-835",
    "filename": "src/test/java/org/apache/commons/compress/archivers/zip/ZipArchiveInputStreamTest.java",
    "is_vulnerable": 0,
    "class_name": "ZipArchiveInputStreamTest",
    "subclass_name": null,
    "function_name": "nameSource(String archive, String entry, int entryNo, ZipArchiveEntry.NameSource expected) throws Exception",
    "function_body": "{\n        try (ZipArchiveInputStream zis = new ZipArchiveInputStream(new FileInputStream(getFile(archive)))) {\n            ZipArchiveEntry ze;\n            do {\n                ze = zis.getNextZipEntry();\n            } while (--entryNo > 0);\n            assertEquals(entry, ze.getName());\n            assertEquals(expected, ze.getNameSource());\n        }\n    }"
  },
  {
    "id": 7,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 0,
    "human_patch": "https://github.com/apache/commons-compress/commit/4ad5d80a6272e007f64a6ac66829ca189a8093b9",
    "cve_id": "CVE-2019-12402",
    "cwe_id": "CWE-835",
    "filename": "src/main/java/org/apache/commons/compress/archivers/zip/NioZipEncoding.java",
    "is_vulnerable": 0,
    "class_name": "NioZipEncoding",
    "subclass_name": null,
    "function_name": "getCharset()",
    "function_body": "{\n        return charset;\n    }"
  },
  {
    "id": 7,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 1,
    "human_patch": "https://github.com/apache/commons-compress/commit/4ad5d80a6272e007f64a6ac66829ca189a8093b9",
    "cve_id": "CVE-2019-12402",
    "cwe_id": "CWE-835",
    "filename": "src/main/java/org/apache/commons/compress/archivers/zip/NioZipEncoding.java",
    "is_vulnerable": 0,
    "class_name": "NioZipEncoding",
    "subclass_name": null,
    "function_name": "canEncode(final String name)",
    "function_body": "{\n        final CharsetEncoder enc = newEncoder();\n\n        return enc.canEncode(name);\n    }"
  },
  {
    "id": 7,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 2,
    "human_patch": "https://github.com/apache/commons-compress/commit/4ad5d80a6272e007f64a6ac66829ca189a8093b9",
    "cve_id": "CVE-2019-12402",
    "cwe_id": "CWE-835",
    "filename": "src/main/java/org/apache/commons/compress/archivers/zip/NioZipEncoding.java",
    "is_vulnerable": 1,
    "class_name": "NioZipEncoding",
    "subclass_name": null,
    "function_name": "encode(final String name)",
    "function_body": "{\n        final CharsetEncoder enc = newEncoder();\n\n        final CharBuffer cb = CharBuffer.wrap(name);\n        CharBuffer tmp = null;\n        ByteBuffer out = ByteBuffer.allocate(estimateInitialBufferSize(enc, cb.remaining()));\n\n        while (cb.remaining() > 0) {\n            final CoderResult res = enc.encode(cb, out, false);\n\n            if (res.isUnmappable() || res.isMalformed()) {\n\n                \n                \n\n                int spaceForSurrogate = estimateIncrementalEncodingSize(enc, 6 * res.length());\n                if (spaceForSurrogate > out.remaining()) {\n                    \n                    \n                    \n                    int charCount = 0;\n                    for (int i = cb.position() ; i < cb.limit(); i++) {\n                        charCount += !enc.canEncode(cb.get(i)) ? 6 : 1;\n                    }\n                    int totalExtraSpace = estimateIncrementalEncodingSize(enc, charCount);\n                    out = ZipEncodingHelper.growBufferBy(out, totalExtraSpace - out.remaining());\n                }\n                if (tmp == null) {\n                    tmp = CharBuffer.allocate(6);\n                }\n                for (int i = 0; i < res.length(); ++i) {\n                    out = encodeFully(enc, encodeSurrogate(tmp, cb.get()), out);\n                }\n\n            } else if (res.isOverflow()) {\n                int increment = estimateIncrementalEncodingSize(enc, cb.remaining());\n                out = ZipEncodingHelper.growBufferBy(out, increment);\n            }\n        }\n        \n        enc.encode(cb, out, true);\n        \n\n        out.limit(out.position());\n        out.rewind();\n        return out;\n    }"
  },
  {
    "id": 7,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 3,
    "human_patch": "https://github.com/apache/commons-compress/commit/4ad5d80a6272e007f64a6ac66829ca189a8093b9",
    "cve_id": "CVE-2019-12402",
    "cwe_id": "CWE-835",
    "filename": "src/main/java/org/apache/commons/compress/archivers/zip/NioZipEncoding.java",
    "is_vulnerable": 0,
    "class_name": "NioZipEncoding",
    "subclass_name": null,
    "function_name": "decode(final byte[] data) throws IOException",
    "function_body": "{\n        return newDecoder()\n            .decode(ByteBuffer.wrap(data)).toString();\n    }"
  },
  {
    "id": 7,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 4,
    "human_patch": "https://github.com/apache/commons-compress/commit/4ad5d80a6272e007f64a6ac66829ca189a8093b9",
    "cve_id": "CVE-2019-12402",
    "cwe_id": "CWE-835",
    "filename": "src/main/java/org/apache/commons/compress/archivers/zip/NioZipEncoding.java",
    "is_vulnerable": 0,
    "class_name": "NioZipEncoding",
    "subclass_name": null,
    "function_name": "encodeFully(CharsetEncoder enc, CharBuffer cb, ByteBuffer out)",
    "function_body": "{\n        ByteBuffer o = out;\n        while (cb.hasRemaining()) {\n            CoderResult result = enc.encode(cb, o, false);\n            if (result.isOverflow()) {\n                int increment = estimateIncrementalEncodingSize(enc, cb.remaining());\n                o = ZipEncodingHelper.growBufferBy(o, increment);\n            }\n        }\n        return o;\n    }"
  },
  {
    "id": 7,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 5,
    "human_patch": "https://github.com/apache/commons-compress/commit/4ad5d80a6272e007f64a6ac66829ca189a8093b9",
    "cve_id": "CVE-2019-12402",
    "cwe_id": "CWE-835",
    "filename": "src/main/java/org/apache/commons/compress/archivers/zip/NioZipEncoding.java",
    "is_vulnerable": 0,
    "class_name": "NioZipEncoding",
    "subclass_name": null,
    "function_name": "encodeSurrogate(CharBuffer cb, char c)",
    "function_body": "{\n        cb.position(0).limit(6);\n        cb.put('%');\n        cb.put('U');\n\n        cb.put(HEX_CHARS[(c >> 12) & 0x0f]);\n        cb.put(HEX_CHARS[(c >> 8) & 0x0f]);\n        cb.put(HEX_CHARS[(c >> 4) & 0x0f]);\n        cb.put(HEX_CHARS[c & 0x0f]);\n        cb.flip();\n        return cb;\n    }"
  },
  {
    "id": 7,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 6,
    "human_patch": "https://github.com/apache/commons-compress/commit/4ad5d80a6272e007f64a6ac66829ca189a8093b9",
    "cve_id": "CVE-2019-12402",
    "cwe_id": "CWE-835",
    "filename": "src/main/java/org/apache/commons/compress/archivers/zip/NioZipEncoding.java",
    "is_vulnerable": 0,
    "class_name": "NioZipEncoding",
    "subclass_name": null,
    "function_name": "newEncoder()",
    "function_body": "{\n        if (useReplacement) {\n            return charset.newEncoder()\n                .onMalformedInput(CodingErrorAction.REPLACE)\n                .onUnmappableCharacter(CodingErrorAction.REPLACE)\n                .replaceWith(REPLACEMENT_BYTES);\n        } else {\n            return charset.newEncoder()\n                .onMalformedInput(CodingErrorAction.REPORT)\n                .onUnmappableCharacter(CodingErrorAction.REPORT);\n        }\n    }"
  },
  {
    "id": 7,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 7,
    "human_patch": "https://github.com/apache/commons-compress/commit/4ad5d80a6272e007f64a6ac66829ca189a8093b9",
    "cve_id": "CVE-2019-12402",
    "cwe_id": "CWE-835",
    "filename": "src/main/java/org/apache/commons/compress/archivers/zip/NioZipEncoding.java",
    "is_vulnerable": 0,
    "class_name": "NioZipEncoding",
    "subclass_name": null,
    "function_name": "newDecoder()",
    "function_body": "{\n        if (!useReplacement) {\n            return this.charset.newDecoder()\n                .onMalformedInput(CodingErrorAction.REPORT)\n                .onUnmappableCharacter(CodingErrorAction.REPORT);\n        } else {\n            return  charset.newDecoder()\n                .onMalformedInput(CodingErrorAction.REPLACE)\n                .onUnmappableCharacter(CodingErrorAction.REPLACE)\n                .replaceWith(REPLACEMENT_STRING);\n        }\n    }"
  },
  {
    "id": 7,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 8,
    "human_patch": "https://github.com/apache/commons-compress/commit/4ad5d80a6272e007f64a6ac66829ca189a8093b9",
    "cve_id": "CVE-2019-12402",
    "cwe_id": "CWE-835",
    "filename": "src/main/java/org/apache/commons/compress/archivers/zip/NioZipEncoding.java",
    "is_vulnerable": 0,
    "class_name": "NioZipEncoding",
    "subclass_name": null,
    "function_name": "estimateInitialBufferSize(CharsetEncoder enc, int charChount)",
    "function_body": "{\n        float first = enc.maxBytesPerChar();\n        float rest = (charChount - 1) * enc.averageBytesPerChar();\n        return (int) Math.ceil(first + rest);\n    }"
  },
  {
    "id": 7,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 9,
    "human_patch": "https://github.com/apache/commons-compress/commit/4ad5d80a6272e007f64a6ac66829ca189a8093b9",
    "cve_id": "CVE-2019-12402",
    "cwe_id": "CWE-835",
    "filename": "src/main/java/org/apache/commons/compress/archivers/zip/NioZipEncoding.java",
    "is_vulnerable": 0,
    "class_name": "NioZipEncoding",
    "subclass_name": null,
    "function_name": "estimateIncrementalEncodingSize(CharsetEncoder enc, int charCount)",
    "function_body": "{\n        return (int) Math.ceil(charCount * enc.averageBytesPerChar());\n    }"
  },
  {
    "id": 8,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 0,
    "human_patch": "https://github.com/apache/commons-configuration/commit/add7375cf37fd316d4838c6c56b054fc293b4641",
    "cve_id": "CVE-2020-1953",
    "cwe_id": "Not Mapping",
    "filename": "src/main/java/org/apache/commons/configuration2/YAMLConfiguration.java",
    "is_vulnerable": 1,
    "class_name": "YAMLConfiguration",
    "subclass_name": null,
    "function_name": "read(final Reader in) throws ConfigurationException",
    "function_body": "{\n        try\n        {\n            final Yaml yaml = new Yaml();\n            final Map<String, Object> map = (Map) yaml.load(in);\n            load(map);\n        }\n        catch (final Exception e)\n        {\n            rethrowException(e);\n        }\n    }"
  },
  {
    "id": 8,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 1,
    "human_patch": "https://github.com/apache/commons-configuration/commit/add7375cf37fd316d4838c6c56b054fc293b4641",
    "cve_id": "CVE-2020-1953",
    "cwe_id": "Not Mapping",
    "filename": "src/main/java/org/apache/commons/configuration2/YAMLConfiguration.java",
    "is_vulnerable": 1,
    "class_name": "YAMLConfiguration",
    "subclass_name": null,
    "function_name": "read(final Reader in, final LoaderOptions options) throws ConfigurationException",
    "function_body": "{\n        try\n        {\n            final Yaml yaml = new Yaml(options);\n            final Map<String, Object> map = (Map) yaml.load(in);\n            load(map);\n        }\n        catch (final Exception e)\n        {\n            rethrowException(e);\n        }\n    }"
  },
  {
    "id": 8,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 2,
    "human_patch": "https://github.com/apache/commons-configuration/commit/add7375cf37fd316d4838c6c56b054fc293b4641",
    "cve_id": "CVE-2020-1953",
    "cwe_id": "Not Mapping",
    "filename": "src/main/java/org/apache/commons/configuration2/YAMLConfiguration.java",
    "is_vulnerable": 0,
    "class_name": "YAMLConfiguration",
    "subclass_name": null,
    "function_name": "write(final Writer out) throws ConfigurationException, IOException",
    "function_body": "{\n        final DumperOptions options = new DumperOptions();\n        options.setDefaultFlowStyle(DumperOptions.FlowStyle.BLOCK);\n        dump(out, options);\n    }"
  },
  {
    "id": 8,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 3,
    "human_patch": "https://github.com/apache/commons-configuration/commit/add7375cf37fd316d4838c6c56b054fc293b4641",
    "cve_id": "CVE-2020-1953",
    "cwe_id": "Not Mapping",
    "filename": "src/main/java/org/apache/commons/configuration2/YAMLConfiguration.java",
    "is_vulnerable": 0,
    "class_name": "YAMLConfiguration",
    "subclass_name": null,
    "function_name": "dump(final Writer out, final DumperOptions options) throws ConfigurationException, IOException",
    "function_body": "{\n        final Yaml yaml = new Yaml(options);\n        yaml.dump(constructMap(getNodeModel().getNodeHandler().getRootNode()),\n                out);\n    }"
  },
  {
    "id": 8,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 4,
    "human_patch": "https://github.com/apache/commons-configuration/commit/add7375cf37fd316d4838c6c56b054fc293b4641",
    "cve_id": "CVE-2020-1953",
    "cwe_id": "Not Mapping",
    "filename": "src/main/java/org/apache/commons/configuration2/YAMLConfiguration.java",
    "is_vulnerable": 1,
    "class_name": "YAMLConfiguration",
    "subclass_name": null,
    "function_name": "read(final InputStream in) throws ConfigurationException",
    "function_body": "{\n        try\n        {\n            final Yaml yaml = new Yaml();\n            final Map<String, Object> map = (Map) yaml.load(in);\n            load(map);\n        }\n        catch (final Exception e)\n        {\n            rethrowException(e);\n        }\n    }"
  },
  {
    "id": 8,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 5,
    "human_patch": "https://github.com/apache/commons-configuration/commit/add7375cf37fd316d4838c6c56b054fc293b4641",
    "cve_id": "CVE-2020-1953",
    "cwe_id": "Not Mapping",
    "filename": "src/main/java/org/apache/commons/configuration2/YAMLConfiguration.java",
    "is_vulnerable": 1,
    "class_name": "YAMLConfiguration",
    "subclass_name": null,
    "function_name": "read(final InputStream in, final LoaderOptions options) throws ConfigurationException",
    "function_body": "{\n        try\n        {\n            final Yaml yaml = new Yaml(options);\n            final Map<String, Object> map = (Map) yaml.load(in);\n            load(map);\n        }\n        catch (final Exception e)\n        {\n            rethrowException(e);\n        }\n    }"
  },
  {
    "id": 8,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 0,
    "human_patch": "https://github.com/apache/commons-configuration/commit/add7375cf37fd316d4838c6c56b054fc293b4641",
    "cve_id": "CVE-2020-1953",
    "cwe_id": "Not Mapping",
    "filename": "src/test/java/org/apache/commons/configuration2/TestYAMLConfiguration.java",
    "is_vulnerable": 0,
    "class_name": "TestYAMLConfiguration",
    "subclass_name": null,
    "function_name": "setUp() throws Exception",
    "function_body": "{\n        yamlConfiguration = new YAMLConfiguration();\n        yamlConfiguration.read(new FileReader(testYaml));\n    }"
  },
  {
    "id": 8,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 1,
    "human_patch": "https://github.com/apache/commons-configuration/commit/add7375cf37fd316d4838c6c56b054fc293b4641",
    "cve_id": "CVE-2020-1953",
    "cwe_id": "Not Mapping",
    "filename": "src/test/java/org/apache/commons/configuration2/TestYAMLConfiguration.java",
    "is_vulnerable": 0,
    "class_name": "TestYAMLConfiguration",
    "subclass_name": null,
    "function_name": "testGetProperty_simple()",
    "function_body": "{\n        assertEquals(\"value1\", yamlConfiguration.getProperty(\"key1\"));\n    }"
  },
  {
    "id": 8,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 2,
    "human_patch": "https://github.com/apache/commons-configuration/commit/add7375cf37fd316d4838c6c56b054fc293b4641",
    "cve_id": "CVE-2020-1953",
    "cwe_id": "Not Mapping",
    "filename": "src/test/java/org/apache/commons/configuration2/TestYAMLConfiguration.java",
    "is_vulnerable": 0,
    "class_name": "TestYAMLConfiguration",
    "subclass_name": null,
    "function_name": "testGetProperty_nested()",
    "function_body": "{\n        assertEquals(\"value23\", yamlConfiguration.getProperty(\"key2.key3\"));\n    }"
  },
  {
    "id": 8,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 3,
    "human_patch": "https://github.com/apache/commons-configuration/commit/add7375cf37fd316d4838c6c56b054fc293b4641",
    "cve_id": "CVE-2020-1953",
    "cwe_id": "Not Mapping",
    "filename": "src/test/java/org/apache/commons/configuration2/TestYAMLConfiguration.java",
    "is_vulnerable": 0,
    "class_name": "TestYAMLConfiguration",
    "subclass_name": null,
    "function_name": "testGetProperty_nested_with_list()",
    "function_body": "{\n        assertEquals(Arrays.asList(\"col1\", \"col2\"),\n                yamlConfiguration.getProperty(\"key4.key5\"));\n    }"
  },
  {
    "id": 8,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 4,
    "human_patch": "https://github.com/apache/commons-configuration/commit/add7375cf37fd316d4838c6c56b054fc293b4641",
    "cve_id": "CVE-2020-1953",
    "cwe_id": "Not Mapping",
    "filename": "src/test/java/org/apache/commons/configuration2/TestYAMLConfiguration.java",
    "is_vulnerable": 0,
    "class_name": "TestYAMLConfiguration",
    "subclass_name": null,
    "function_name": "testGetProperty_subset()",
    "function_body": "{\n        final Configuration subset = yamlConfiguration.subset(\"key4\");\n        assertEquals(Arrays.asList(\"col1\", \"col2\"), subset.getProperty(\"key5\"));\n    }"
  },
  {
    "id": 8,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 5,
    "human_patch": "https://github.com/apache/commons-configuration/commit/add7375cf37fd316d4838c6c56b054fc293b4641",
    "cve_id": "CVE-2020-1953",
    "cwe_id": "Not Mapping",
    "filename": "src/test/java/org/apache/commons/configuration2/TestYAMLConfiguration.java",
    "is_vulnerable": 0,
    "class_name": "TestYAMLConfiguration",
    "subclass_name": null,
    "function_name": "testGetProperty_very_nested_properties()",
    "function_body": "{\n        final Object property =\n                yamlConfiguration.getProperty(\"very.nested.properties\");\n        assertEquals(Arrays.asList(\"nested1\", \"nested2\", \"nested3\"), property);\n    }"
  },
  {
    "id": 8,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 6,
    "human_patch": "https://github.com/apache/commons-configuration/commit/add7375cf37fd316d4838c6c56b054fc293b4641",
    "cve_id": "CVE-2020-1953",
    "cwe_id": "Not Mapping",
    "filename": "src/test/java/org/apache/commons/configuration2/TestYAMLConfiguration.java",
    "is_vulnerable": 0,
    "class_name": "TestYAMLConfiguration",
    "subclass_name": null,
    "function_name": "testGetProperty_integer()",
    "function_body": "{\n        final Object property = yamlConfiguration.getProperty(\"int1\");\n        assertTrue(\"property should be an Integer\",\n                property instanceof Integer);\n        assertEquals(37, property);\n    }"
  },
  {
    "id": 8,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 7,
    "human_patch": "https://github.com/apache/commons-configuration/commit/add7375cf37fd316d4838c6c56b054fc293b4641",
    "cve_id": "CVE-2020-1953",
    "cwe_id": "Not Mapping",
    "filename": "src/test/java/org/apache/commons/configuration2/TestYAMLConfiguration.java",
    "is_vulnerable": 0,
    "class_name": "TestYAMLConfiguration",
    "subclass_name": null,
    "function_name": "testSave() throws IOException, ConfigurationException",
    "function_body": "{\n        \n        final StringWriter sw = new StringWriter();\n        yamlConfiguration.write(sw);\n        final String output = sw.toString();\n\n        \n        final Map parsed = new Yaml().loadAs(output, Map.class);\n        assertEquals(6, parsed.entrySet().size());\n        assertEquals(\"value1\", parsed.get(\"key1\"));\n\n        final Map key2 = (Map) parsed.get(\"key2\");\n        assertEquals(\"value23\", key2.get(\"key3\"));\n\n        final List<String> key5 =\n                (List<String>) ((Map) parsed.get(\"key4\")).get(\"key5\");\n        assertEquals(2, key5.size());\n        assertEquals(\"col1\", key5.get(0));\n        assertEquals(\"col2\", key5.get(1));\n    }"
  },
  {
    "id": 8,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 8,
    "human_patch": "https://github.com/apache/commons-configuration/commit/add7375cf37fd316d4838c6c56b054fc293b4641",
    "cve_id": "CVE-2020-1953",
    "cwe_id": "Not Mapping",
    "filename": "src/test/java/org/apache/commons/configuration2/TestYAMLConfiguration.java",
    "is_vulnerable": 0,
    "class_name": "TestYAMLConfiguration",
    "subclass_name": null,
    "function_name": "testGetProperty_dictionary()",
    "function_body": "{\n        assertEquals(\"Martin D'vloper\",\n                yamlConfiguration.getProperty(\"martin.name\"));\n        assertEquals(\"Developer\", yamlConfiguration.getProperty(\"martin.job\"));\n        assertEquals(\"Elite\", yamlConfiguration.getProperty(\"martin.skill\"));\n    }"
  },
  {
    "id": 8,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 9,
    "human_patch": "https://github.com/apache/commons-configuration/commit/add7375cf37fd316d4838c6c56b054fc293b4641",
    "cve_id": "CVE-2020-1953",
    "cwe_id": "Not Mapping",
    "filename": "src/test/java/org/apache/commons/configuration2/TestYAMLConfiguration.java",
    "is_vulnerable": 0,
    "class_name": "TestYAMLConfiguration",
    "subclass_name": null,
    "function_name": "testCopyConstructor()",
    "function_body": "{\n        final BaseHierarchicalConfiguration c = new BaseHierarchicalConfiguration();\n        c.addProperty(\"foo\", \"bar\");\n\n        yamlConfiguration = new YAMLConfiguration(c);\n        assertEquals(\"bar\", yamlConfiguration.getString(\"foo\"));\n    }"
  },
  {
    "id": 9,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 0,
    "human_patch": "https://github.com/apache/commons-fileupload/commit/163a6061fbc077d4b6e4787d26857c2baba495d1",
    "cve_id": "CVE-2013-2186",
    "cwe_id": "CWE-20",
    "filename": "src/main/java/org/apache/commons/fileupload/disk/DiskFileItem.java",
    "is_vulnerable": 0,
    "class_name": "DiskFileItem",
    "subclass_name": null,
    "function_name": "getInputStream() throws IOException",
    "function_body": "{\n        if (!isInMemory()) {\n            return new FileInputStream(dfos.getFile());\n        }\n\n        if (cachedContent == null) {\n            cachedContent = dfos.getData();\n        }\n        return new ByteArrayInputStream(cachedContent);\n    }"
  },
  {
    "id": 9,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 1,
    "human_patch": "https://github.com/apache/commons-fileupload/commit/163a6061fbc077d4b6e4787d26857c2baba495d1",
    "cve_id": "CVE-2013-2186",
    "cwe_id": "CWE-20",
    "filename": "src/main/java/org/apache/commons/fileupload/disk/DiskFileItem.java",
    "is_vulnerable": 0,
    "class_name": "DiskFileItem",
    "subclass_name": null,
    "function_name": "getContentType()",
    "function_body": "{\n        return contentType;\n    }"
  },
  {
    "id": 9,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 2,
    "human_patch": "https://github.com/apache/commons-fileupload/commit/163a6061fbc077d4b6e4787d26857c2baba495d1",
    "cve_id": "CVE-2013-2186",
    "cwe_id": "CWE-20",
    "filename": "src/main/java/org/apache/commons/fileupload/disk/DiskFileItem.java",
    "is_vulnerable": 0,
    "class_name": "DiskFileItem",
    "subclass_name": null,
    "function_name": "getCharSet()",
    "function_body": "{\n        ParameterParser parser = new ParameterParser();\n        parser.setLowerCaseNames(true);\n        \n        Map<String, String> params = parser.parse(getContentType(), ';');\n        return params.get(\"charset\");\n    }"
  },
  {
    "id": 9,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 3,
    "human_patch": "https://github.com/apache/commons-fileupload/commit/163a6061fbc077d4b6e4787d26857c2baba495d1",
    "cve_id": "CVE-2013-2186",
    "cwe_id": "CWE-20",
    "filename": "src/main/java/org/apache/commons/fileupload/disk/DiskFileItem.java",
    "is_vulnerable": 0,
    "class_name": "DiskFileItem",
    "subclass_name": null,
    "function_name": "getName()",
    "function_body": "{\n        return Streams.checkFileName(fileName);\n    }"
  },
  {
    "id": 9,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 4,
    "human_patch": "https://github.com/apache/commons-fileupload/commit/163a6061fbc077d4b6e4787d26857c2baba495d1",
    "cve_id": "CVE-2013-2186",
    "cwe_id": "CWE-20",
    "filename": "src/main/java/org/apache/commons/fileupload/disk/DiskFileItem.java",
    "is_vulnerable": 0,
    "class_name": "DiskFileItem",
    "subclass_name": null,
    "function_name": "isInMemory()",
    "function_body": "{\n        if (cachedContent != null) {\n            return true;\n        }\n        return dfos.isInMemory();\n    }"
  },
  {
    "id": 9,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 5,
    "human_patch": "https://github.com/apache/commons-fileupload/commit/163a6061fbc077d4b6e4787d26857c2baba495d1",
    "cve_id": "CVE-2013-2186",
    "cwe_id": "CWE-20",
    "filename": "src/main/java/org/apache/commons/fileupload/disk/DiskFileItem.java",
    "is_vulnerable": 0,
    "class_name": "DiskFileItem",
    "subclass_name": null,
    "function_name": "getSize()",
    "function_body": "{\n        if (size >= 0) {\n            return size;\n        } else if (cachedContent != null) {\n            return cachedContent.length;\n        } else if (dfos.isInMemory()) {\n            return dfos.getData().length;\n        } else {\n            return dfos.getFile().length();\n        }\n    }"
  },
  {
    "id": 9,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 6,
    "human_patch": "https://github.com/apache/commons-fileupload/commit/163a6061fbc077d4b6e4787d26857c2baba495d1",
    "cve_id": "CVE-2013-2186",
    "cwe_id": "CWE-20",
    "filename": "src/main/java/org/apache/commons/fileupload/disk/DiskFileItem.java",
    "is_vulnerable": 0,
    "class_name": "DiskFileItem",
    "subclass_name": null,
    "function_name": "get()",
    "function_body": "{\n        if (isInMemory()) {\n            if (cachedContent == null) {\n                cachedContent = dfos.getData();\n            }\n            return cachedContent;\n        }\n\n        byte[] fileData = new byte[(int) getSize()];\n        InputStream fis = null;\n\n        try {\n            fis = new BufferedInputStream(new FileInputStream(dfos.getFile()));\n            fis.read(fileData);\n        } catch (IOException e) {\n            fileData = null;\n        } finally {\n            if (fis != null) {\n                try {\n                    fis.close();\n                } catch (IOException e) {\n                    \n                }\n            }\n        }\n\n        return fileData;\n    }"
  },
  {
    "id": 9,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 7,
    "human_patch": "https://github.com/apache/commons-fileupload/commit/163a6061fbc077d4b6e4787d26857c2baba495d1",
    "cve_id": "CVE-2013-2186",
    "cwe_id": "CWE-20",
    "filename": "src/main/java/org/apache/commons/fileupload/disk/DiskFileItem.java",
    "is_vulnerable": 0,
    "class_name": "DiskFileItem",
    "subclass_name": null,
    "function_name": "getString(final String charset) throws UnsupportedEncodingException",
    "function_body": "{\n        return new String(get(), charset);\n    }"
  },
  {
    "id": 9,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 8,
    "human_patch": "https://github.com/apache/commons-fileupload/commit/163a6061fbc077d4b6e4787d26857c2baba495d1",
    "cve_id": "CVE-2013-2186",
    "cwe_id": "CWE-20",
    "filename": "src/main/java/org/apache/commons/fileupload/disk/DiskFileItem.java",
    "is_vulnerable": 0,
    "class_name": "DiskFileItem",
    "subclass_name": null,
    "function_name": "getString()",
    "function_body": "{\n        byte[] rawdata = get();\n        String charset = getCharSet();\n        if (charset == null) {\n            charset = DEFAULT_CHARSET;\n        }\n        try {\n            return new String(rawdata, charset);\n        } catch (UnsupportedEncodingException e) {\n            return new String(rawdata);\n        }\n    }"
  },
  {
    "id": 9,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 9,
    "human_patch": "https://github.com/apache/commons-fileupload/commit/163a6061fbc077d4b6e4787d26857c2baba495d1",
    "cve_id": "CVE-2013-2186",
    "cwe_id": "CWE-20",
    "filename": "src/main/java/org/apache/commons/fileupload/disk/DiskFileItem.java",
    "is_vulnerable": 0,
    "class_name": "DiskFileItem",
    "subclass_name": null,
    "function_name": "write(File file) throws Exception",
    "function_body": "{\n        if (isInMemory()) {\n            FileOutputStream fout = null;\n            try {\n                fout = new FileOutputStream(file);\n                fout.write(get());\n            } finally {\n                if (fout != null) {\n                    fout.close();\n                }\n            }\n        } else {\n            File outputFile = getStoreLocation();\n            if (outputFile != null) {\n                \n                size = outputFile.length();\n                \n                if (!outputFile.renameTo(file)) {\n                    BufferedInputStream in = null;\n                    BufferedOutputStream out = null;\n                    try {\n                        in = new BufferedInputStream(\n                            new FileInputStream(outputFile));\n                        out = new BufferedOutputStream(\n                                new FileOutputStream(file));\n                        IOUtils.copy(in, out);\n                    } finally {\n                        if (in != null) {\n                            try {\n                                in.close();\n                            } catch (IOException e) {\n                                \n                            }\n                        }\n                        if (out != null) {\n                            try {\n                                out.close();\n                            } catch (IOException e) {\n                                \n                            }\n                        }\n                    }\n                }\n            } else {\n                \n                throw new FileUploadException(\n                    \"Cannot write uploaded file to disk!\");\n            }\n        }\n    }"
  },
  {
    "id": 9,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 10,
    "human_patch": "https://github.com/apache/commons-fileupload/commit/163a6061fbc077d4b6e4787d26857c2baba495d1",
    "cve_id": "CVE-2013-2186",
    "cwe_id": "CWE-20",
    "filename": "src/main/java/org/apache/commons/fileupload/disk/DiskFileItem.java",
    "is_vulnerable": 0,
    "class_name": "DiskFileItem",
    "subclass_name": null,
    "function_name": "delete()",
    "function_body": "{\n        cachedContent = null;\n        File outputFile = getStoreLocation();\n        if (outputFile != null && outputFile.exists()) {\n            outputFile.delete();\n        }\n    }"
  },
  {
    "id": 9,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 11,
    "human_patch": "https://github.com/apache/commons-fileupload/commit/163a6061fbc077d4b6e4787d26857c2baba495d1",
    "cve_id": "CVE-2013-2186",
    "cwe_id": "CWE-20",
    "filename": "src/main/java/org/apache/commons/fileupload/disk/DiskFileItem.java",
    "is_vulnerable": 0,
    "class_name": "DiskFileItem",
    "subclass_name": null,
    "function_name": "getFieldName()",
    "function_body": "{\n        return fieldName;\n    }"
  },
  {
    "id": 9,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 12,
    "human_patch": "https://github.com/apache/commons-fileupload/commit/163a6061fbc077d4b6e4787d26857c2baba495d1",
    "cve_id": "CVE-2013-2186",
    "cwe_id": "CWE-20",
    "filename": "src/main/java/org/apache/commons/fileupload/disk/DiskFileItem.java",
    "is_vulnerable": 0,
    "class_name": "DiskFileItem",
    "subclass_name": null,
    "function_name": "setFieldName(String fieldName)",
    "function_body": "{\n        this.fieldName = fieldName;\n    }"
  },
  {
    "id": 9,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 13,
    "human_patch": "https://github.com/apache/commons-fileupload/commit/163a6061fbc077d4b6e4787d26857c2baba495d1",
    "cve_id": "CVE-2013-2186",
    "cwe_id": "CWE-20",
    "filename": "src/main/java/org/apache/commons/fileupload/disk/DiskFileItem.java",
    "is_vulnerable": 0,
    "class_name": "DiskFileItem",
    "subclass_name": null,
    "function_name": "isFormField()",
    "function_body": "{\n        return isFormField;\n    }"
  },
  {
    "id": 9,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 14,
    "human_patch": "https://github.com/apache/commons-fileupload/commit/163a6061fbc077d4b6e4787d26857c2baba495d1",
    "cve_id": "CVE-2013-2186",
    "cwe_id": "CWE-20",
    "filename": "src/main/java/org/apache/commons/fileupload/disk/DiskFileItem.java",
    "is_vulnerable": 0,
    "class_name": "DiskFileItem",
    "subclass_name": null,
    "function_name": "setFormField(boolean state)",
    "function_body": "{\n        isFormField = state;\n    }"
  },
  {
    "id": 9,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 15,
    "human_patch": "https://github.com/apache/commons-fileupload/commit/163a6061fbc077d4b6e4787d26857c2baba495d1",
    "cve_id": "CVE-2013-2186",
    "cwe_id": "CWE-20",
    "filename": "src/main/java/org/apache/commons/fileupload/disk/DiskFileItem.java",
    "is_vulnerable": 0,
    "class_name": "DiskFileItem",
    "subclass_name": null,
    "function_name": "getOutputStream() throws IOException",
    "function_body": "{\n        if (dfos == null) {\n            File outputFile = getTempFile();\n            dfos = new DeferredFileOutputStream(sizeThreshold, outputFile);\n        }\n        return dfos;\n    }"
  },
  {
    "id": 9,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 16,
    "human_patch": "https://github.com/apache/commons-fileupload/commit/163a6061fbc077d4b6e4787d26857c2baba495d1",
    "cve_id": "CVE-2013-2186",
    "cwe_id": "CWE-20",
    "filename": "src/main/java/org/apache/commons/fileupload/disk/DiskFileItem.java",
    "is_vulnerable": 0,
    "class_name": "DiskFileItem",
    "subclass_name": null,
    "function_name": "getStoreLocation()",
    "function_body": "{\n        if (dfos == null) {\n            return null;\n        }\n        return dfos.getFile();\n    }"
  },
  {
    "id": 9,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 17,
    "human_patch": "https://github.com/apache/commons-fileupload/commit/163a6061fbc077d4b6e4787d26857c2baba495d1",
    "cve_id": "CVE-2013-2186",
    "cwe_id": "CWE-20",
    "filename": "src/main/java/org/apache/commons/fileupload/disk/DiskFileItem.java",
    "is_vulnerable": 0,
    "class_name": "DiskFileItem",
    "subclass_name": null,
    "function_name": "finalize()",
    "function_body": "{\n        File outputFile = dfos.getFile();\n\n        if (outputFile != null && outputFile.exists()) {\n            outputFile.delete();\n        }\n    }"
  },
  {
    "id": 9,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 18,
    "human_patch": "https://github.com/apache/commons-fileupload/commit/163a6061fbc077d4b6e4787d26857c2baba495d1",
    "cve_id": "CVE-2013-2186",
    "cwe_id": "CWE-20",
    "filename": "src/main/java/org/apache/commons/fileupload/disk/DiskFileItem.java",
    "is_vulnerable": 0,
    "class_name": "DiskFileItem",
    "subclass_name": null,
    "function_name": "getTempFile()",
    "function_body": "{\n        if (tempFile == null) {\n            File tempDir = repository;\n            if (tempDir == null) {\n                tempDir = new File(System.getProperty(\"java.io.tmpdir\"));\n            }\n\n            String tempFileName = format(\"upload_%s_%s.tmp\", UID, getUniqueId());\n\n            tempFile = new File(tempDir, tempFileName);\n        }\n        return tempFile;\n    }"
  },
  {
    "id": 9,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 19,
    "human_patch": "https://github.com/apache/commons-fileupload/commit/163a6061fbc077d4b6e4787d26857c2baba495d1",
    "cve_id": "CVE-2013-2186",
    "cwe_id": "CWE-20",
    "filename": "src/main/java/org/apache/commons/fileupload/disk/DiskFileItem.java",
    "is_vulnerable": 0,
    "class_name": "DiskFileItem",
    "subclass_name": null,
    "function_name": "getUniqueId()",
    "function_body": "{\n        final int limit = 100000000;\n        int current = COUNTER.getAndIncrement();\n        String id = Integer.toString(current);\n\n        \n        \n        if (current < limit) {\n            id = (\"00000000\" + id).substring(id.length());\n        }\n        return id;\n    }"
  },
  {
    "id": 9,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 20,
    "human_patch": "https://github.com/apache/commons-fileupload/commit/163a6061fbc077d4b6e4787d26857c2baba495d1",
    "cve_id": "CVE-2013-2186",
    "cwe_id": "CWE-20",
    "filename": "src/main/java/org/apache/commons/fileupload/disk/DiskFileItem.java",
    "is_vulnerable": 0,
    "class_name": "DiskFileItem",
    "subclass_name": null,
    "function_name": "toString()",
    "function_body": "{\n        return format(\"name=%s, StoreLocation=%s, size=%s bytes, isFormField=%s, FieldName=%s\",\n                      getName(), getStoreLocation(), getSize(), isFormField(), getFieldName());\n    }"
  },
  {
    "id": 9,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 21,
    "human_patch": "https://github.com/apache/commons-fileupload/commit/163a6061fbc077d4b6e4787d26857c2baba495d1",
    "cve_id": "CVE-2013-2186",
    "cwe_id": "CWE-20",
    "filename": "src/main/java/org/apache/commons/fileupload/disk/DiskFileItem.java",
    "is_vulnerable": 0,
    "class_name": "DiskFileItem",
    "subclass_name": null,
    "function_name": "writeObject(ObjectOutputStream out) throws IOException",
    "function_body": "{\n        \n        if (dfos.isInMemory()) {\n            cachedContent = get();\n        } else {\n            cachedContent = null;\n            dfosFile = dfos.getFile();\n        }\n\n        \n        out.defaultWriteObject();\n    }"
  },
  {
    "id": 9,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 22,
    "human_patch": "https://github.com/apache/commons-fileupload/commit/163a6061fbc077d4b6e4787d26857c2baba495d1",
    "cve_id": "CVE-2013-2186",
    "cwe_id": "CWE-20",
    "filename": "src/main/java/org/apache/commons/fileupload/disk/DiskFileItem.java",
    "is_vulnerable": 1,
    "class_name": "DiskFileItem",
    "subclass_name": null,
    "function_name": "readObject(ObjectInputStream in) throws IOException, ClassNotFoundException",
    "function_body": "{\n        \n        in.defaultReadObject();\n\n        OutputStream output = getOutputStream();\n        if (cachedContent != null) {\n            output.write(cachedContent);\n        } else {\n            FileInputStream input = new FileInputStream(dfosFile);\n            IOUtils.copy(input, output);\n            dfosFile.delete();\n            dfosFile = null;\n        }\n        output.close();\n\n        cachedContent = null;\n    }"
  },
  {
    "id": 9,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 23,
    "human_patch": "https://github.com/apache/commons-fileupload/commit/163a6061fbc077d4b6e4787d26857c2baba495d1",
    "cve_id": "CVE-2013-2186",
    "cwe_id": "CWE-20",
    "filename": "src/main/java/org/apache/commons/fileupload/disk/DiskFileItem.java",
    "is_vulnerable": 0,
    "class_name": "DiskFileItem",
    "subclass_name": null,
    "function_name": "getHeaders()",
    "function_body": "{\n        return headers;\n    }"
  },
  {
    "id": 9,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 24,
    "human_patch": "https://github.com/apache/commons-fileupload/commit/163a6061fbc077d4b6e4787d26857c2baba495d1",
    "cve_id": "CVE-2013-2186",
    "cwe_id": "CWE-20",
    "filename": "src/main/java/org/apache/commons/fileupload/disk/DiskFileItem.java",
    "is_vulnerable": 0,
    "class_name": "DiskFileItem",
    "subclass_name": null,
    "function_name": "setHeaders(FileItemHeaders pHeaders)",
    "function_body": "{\n        headers = pHeaders;\n    }"
  },
  {
    "id": 9,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 0,
    "human_patch": "https://github.com/apache/commons-fileupload/commit/163a6061fbc077d4b6e4787d26857c2baba495d1",
    "cve_id": "CVE-2013-2186",
    "cwe_id": "CWE-20",
    "filename": "src/test/java/org/apache/commons/fileupload/DiskFileItemSerializeTest.java",
    "is_vulnerable": 1,
    "class_name": "DiskFileItemSerializeTest",
    "subclass_name": null,
    "function_name": "testBelowThreshold() throws Exception",
    "function_body": "{\n        \n        byte[] testFieldValueBytes = createContentBytes(threshold - 1);\n        FileItem item = createFileItem(testFieldValueBytes);\n\n        \n        assertTrue(\"Initial: in memory\", item.isInMemory());\n        assertEquals(\"Initial: size\", item.getSize(), testFieldValueBytes.length);\n        compareBytes(\"Initial\", item.get(), testFieldValueBytes);\n\n        \n        FileItem newItem = (FileItem)serializeDeserialize(item);\n\n        \n        assertTrue(\"Check in memory\", newItem.isInMemory());\n        compareBytes(\"Check\", testFieldValueBytes, newItem.get());\n\n        \n        compareFileItems(item, newItem);\n    }"
  },
  {
    "id": 9,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 1,
    "human_patch": "https://github.com/apache/commons-fileupload/commit/163a6061fbc077d4b6e4787d26857c2baba495d1",
    "cve_id": "CVE-2013-2186",
    "cwe_id": "CWE-20",
    "filename": "src/test/java/org/apache/commons/fileupload/DiskFileItemSerializeTest.java",
    "is_vulnerable": 1,
    "class_name": "DiskFileItemSerializeTest",
    "subclass_name": null,
    "function_name": "testThreshold() throws Exception",
    "function_body": "{\n        \n        byte[] testFieldValueBytes = createContentBytes(threshold);\n        FileItem item = createFileItem(testFieldValueBytes);\n\n        \n        assertTrue(\"Initial: in memory\", item.isInMemory());\n        assertEquals(\"Initial: size\", item.getSize(), testFieldValueBytes.length);\n        compareBytes(\"Initial\", item.get(), testFieldValueBytes);\n\n\n        \n        FileItem newItem = (FileItem)serializeDeserialize(item);\n\n        \n        assertTrue(\"Check in memory\", newItem.isInMemory());\n        compareBytes(\"Check\", testFieldValueBytes, newItem.get());\n\n        \n        compareFileItems(item, newItem);\n    }"
  },
  {
    "id": 9,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 2,
    "human_patch": "https://github.com/apache/commons-fileupload/commit/163a6061fbc077d4b6e4787d26857c2baba495d1",
    "cve_id": "CVE-2013-2186",
    "cwe_id": "CWE-20",
    "filename": "src/test/java/org/apache/commons/fileupload/DiskFileItemSerializeTest.java",
    "is_vulnerable": 0,
    "class_name": "DiskFileItemSerializeTest",
    "subclass_name": null,
    "function_name": "testAboveThreshold() throws Exception",
    "function_body": "{\n        \n        byte[] testFieldValueBytes = createContentBytes(threshold + 1);\n        FileItem item = createFileItem(testFieldValueBytes);\n\n        \n        assertFalse(\"Initial: in memory\", item.isInMemory());\n        assertEquals(\"Initial: size\", item.getSize(), testFieldValueBytes.length);\n        compareBytes(\"Initial\", item.get(), testFieldValueBytes);\n\n        \n        FileItem newItem = (FileItem)serializeDeserialize(item);\n\n        \n        assertFalse(\"Check in memory\", newItem.isInMemory());\n        compareBytes(\"Check\", testFieldValueBytes, newItem.get());\n\n        \n        compareFileItems(item, newItem);\n    }"
  },
  {
    "id": 9,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 3,
    "human_patch": "https://github.com/apache/commons-fileupload/commit/163a6061fbc077d4b6e4787d26857c2baba495d1",
    "cve_id": "CVE-2013-2186",
    "cwe_id": "CWE-20",
    "filename": "src/test/java/org/apache/commons/fileupload/DiskFileItemSerializeTest.java",
    "is_vulnerable": 0,
    "class_name": "DiskFileItemSerializeTest",
    "subclass_name": null,
    "function_name": "compareFileItems(FileItem origItem, FileItem newItem)",
    "function_body": "{\n        assertTrue(\"Compare: is in Memory\",   origItem.isInMemory()   == newItem.isInMemory());\n        assertTrue(\"Compare: is Form Field\",  origItem.isFormField()  == newItem.isFormField());\n        assertEquals(\"Compare: Field Name\",   origItem.getFieldName(),   newItem.getFieldName());\n        assertEquals(\"Compare: Content Type\", origItem.getContentType(), newItem.getContentType());\n        assertEquals(\"Compare: File Name\",    origItem.getName(),        newItem.getName());\n    }"
  },
  {
    "id": 9,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 4,
    "human_patch": "https://github.com/apache/commons-fileupload/commit/163a6061fbc077d4b6e4787d26857c2baba495d1",
    "cve_id": "CVE-2013-2186",
    "cwe_id": "CWE-20",
    "filename": "src/test/java/org/apache/commons/fileupload/DiskFileItemSerializeTest.java",
    "is_vulnerable": 0,
    "class_name": "DiskFileItemSerializeTest",
    "subclass_name": null,
    "function_name": "compareBytes(String text, byte[] origBytes, byte[] newBytes)",
    "function_body": "{\n        assertNotNull(\"origBytes must not be null\", origBytes);\n        assertNotNull(\"newBytes must not be null\", newBytes);\n        assertEquals(text + \" byte[] length\", origBytes.length, newBytes.length);\n        for (int i = 0; i < origBytes.length; i++) {\n            assertEquals(text + \" byte[\" + i + \"]\", origBytes[i], newBytes[i]);\n        }\n    }"
  },
  {
    "id": 9,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 5,
    "human_patch": "https://github.com/apache/commons-fileupload/commit/163a6061fbc077d4b6e4787d26857c2baba495d1",
    "cve_id": "CVE-2013-2186",
    "cwe_id": "CWE-20",
    "filename": "src/test/java/org/apache/commons/fileupload/DiskFileItemSerializeTest.java",
    "is_vulnerable": 0,
    "class_name": "DiskFileItemSerializeTest",
    "subclass_name": null,
    "function_name": "createContentBytes(int size)",
    "function_body": "{\n        StringBuilder buffer = new StringBuilder(size);\n        byte count = 0;\n        for (int i = 0; i < size; i++) {\n            buffer.append(count+\"\");\n            count++;\n            if (count > 9) {\n                count = 0;\n            }\n        }\n        return buffer.toString().getBytes();\n    }"
  },
  {
    "id": 9,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 6,
    "human_patch": "https://github.com/apache/commons-fileupload/commit/163a6061fbc077d4b6e4787d26857c2baba495d1",
    "cve_id": "CVE-2013-2186",
    "cwe_id": "CWE-20",
    "filename": "src/test/java/org/apache/commons/fileupload/DiskFileItemSerializeTest.java",
    "is_vulnerable": 1,
    "class_name": "DiskFileItemSerializeTest",
    "subclass_name": null,
    "function_name": "createFileItem(byte[] contentBytes)",
    "function_body": "{\n        FileItemFactory factory = new DiskFileItemFactory(threshold, null);\n        String textFieldName = \"textField\";\n\n        FileItem item = factory.createItem(\n                textFieldName,\n                textContentType,\n                true,\n                \"My File Name\"\n        );\n        try {\n            OutputStream os = item.getOutputStream();\n            os.write(contentBytes);\n            os.close();\n        } catch(IOException e) {\n            fail(\"Unexpected IOException\" + e);\n        }\n\n        return item;\n\n    }"
  },
  {
    "id": 9,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 7,
    "human_patch": "https://github.com/apache/commons-fileupload/commit/163a6061fbc077d4b6e4787d26857c2baba495d1",
    "cve_id": "CVE-2013-2186",
    "cwe_id": "CWE-20",
    "filename": "src/test/java/org/apache/commons/fileupload/DiskFileItemSerializeTest.java",
    "is_vulnerable": 1,
    "class_name": "DiskFileItemSerializeTest",
    "subclass_name": null,
    "function_name": "serializeDeserialize(Object target)",
    "function_body": "{\n        \n        ByteArrayOutputStream baos = new ByteArrayOutputStream();\n        try {\n            ObjectOutputStream oos = new ObjectOutputStream(baos);\n            oos.writeObject(target);\n            oos.flush();\n            oos.close();\n        } catch (Exception e) {\n            fail(\"Exception during serialization: \" + e);\n        }\n\n        \n        Object result = null;\n        try {\n            ByteArrayInputStream bais =\n                new ByteArrayInputStream(baos.toByteArray());\n            ObjectInputStream ois = new ObjectInputStream(bais);\n            result = ois.readObject();\n            bais.close();\n        } catch (Exception e) {\n            fail(\"Exception during deserialization: \" + e);\n        }\n        return result;\n    }"
  },
  {
    "id": 10,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 0,
    "human_patch": "https://github.com/apache/commons-fileupload/commit/c61ff05b3241cb14d989b67209e57aa71540417a",
    "cve_id": "CVE-2014-0050",
    "cwe_id": "CWE-264",
    "filename": "src/main/java/org/apache/commons/fileupload/FileUploadBase.java",
    "is_vulnerable": 0,
    "class_name": "FileUploadBase",
    "subclass_name": null,
    "function_name": "isMultipartContent(RequestContext ctx)",
    "function_body": "{\n        String contentType = ctx.getContentType();\n        if (contentType == null) {\n            return false;\n        }\n        if (contentType.toLowerCase(Locale.ENGLISH).startsWith(MULTIPART)) {\n            return true;\n        }\n        return false;\n    }"
  },
  {
    "id": 10,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 1,
    "human_patch": "https://github.com/apache/commons-fileupload/commit/c61ff05b3241cb14d989b67209e57aa71540417a",
    "cve_id": "CVE-2014-0050",
    "cwe_id": "CWE-264",
    "filename": "src/main/java/org/apache/commons/fileupload/FileUploadBase.java",
    "is_vulnerable": 0,
    "class_name": "FileUploadBase",
    "subclass_name": null,
    "function_name": "isMultipartContent(HttpServletRequest req)",
    "function_body": "{\n        return ServletFileUpload.isMultipartContent(req);\n    }"
  },
  {
    "id": 10,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 2,
    "human_patch": "https://github.com/apache/commons-fileupload/commit/c61ff05b3241cb14d989b67209e57aa71540417a",
    "cve_id": "CVE-2014-0050",
    "cwe_id": "CWE-264",
    "filename": "src/main/java/org/apache/commons/fileupload/FileUploadBase.java",
    "is_vulnerable": 0,
    "class_name": "FileUploadBase",
    "subclass_name": null,
    "function_name": "getFileItemFactory()",
    "function_body": null
  },
  {
    "id": 10,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 3,
    "human_patch": "https://github.com/apache/commons-fileupload/commit/c61ff05b3241cb14d989b67209e57aa71540417a",
    "cve_id": "CVE-2014-0050",
    "cwe_id": "CWE-264",
    "filename": "src/main/java/org/apache/commons/fileupload/FileUploadBase.java",
    "is_vulnerable": 0,
    "class_name": "FileUploadBase",
    "subclass_name": null,
    "function_name": "setFileItemFactory(FileItemFactory factory)",
    "function_body": null
  },
  {
    "id": 10,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 4,
    "human_patch": "https://github.com/apache/commons-fileupload/commit/c61ff05b3241cb14d989b67209e57aa71540417a",
    "cve_id": "CVE-2014-0050",
    "cwe_id": "CWE-264",
    "filename": "src/main/java/org/apache/commons/fileupload/FileUploadBase.java",
    "is_vulnerable": 0,
    "class_name": "FileUploadBase",
    "subclass_name": null,
    "function_name": "getSizeMax()",
    "function_body": "{\n        return sizeMax;\n    }"
  },
  {
    "id": 10,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 5,
    "human_patch": "https://github.com/apache/commons-fileupload/commit/c61ff05b3241cb14d989b67209e57aa71540417a",
    "cve_id": "CVE-2014-0050",
    "cwe_id": "CWE-264",
    "filename": "src/main/java/org/apache/commons/fileupload/FileUploadBase.java",
    "is_vulnerable": 0,
    "class_name": "FileUploadBase",
    "subclass_name": null,
    "function_name": "setSizeMax(long sizeMax)",
    "function_body": "{\n        this.sizeMax = sizeMax;\n    }"
  },
  {
    "id": 10,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 6,
    "human_patch": "https://github.com/apache/commons-fileupload/commit/c61ff05b3241cb14d989b67209e57aa71540417a",
    "cve_id": "CVE-2014-0050",
    "cwe_id": "CWE-264",
    "filename": "src/main/java/org/apache/commons/fileupload/FileUploadBase.java",
    "is_vulnerable": 0,
    "class_name": "FileUploadBase",
    "subclass_name": null,
    "function_name": "getFileSizeMax()",
    "function_body": "{\n        return fileSizeMax;\n    }"
  },
  {
    "id": 10,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 7,
    "human_patch": "https://github.com/apache/commons-fileupload/commit/c61ff05b3241cb14d989b67209e57aa71540417a",
    "cve_id": "CVE-2014-0050",
    "cwe_id": "CWE-264",
    "filename": "src/main/java/org/apache/commons/fileupload/FileUploadBase.java",
    "is_vulnerable": 0,
    "class_name": "FileUploadBase",
    "subclass_name": null,
    "function_name": "setFileSizeMax(long fileSizeMax)",
    "function_body": "{\n        this.fileSizeMax = fileSizeMax;\n    }"
  },
  {
    "id": 10,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 8,
    "human_patch": "https://github.com/apache/commons-fileupload/commit/c61ff05b3241cb14d989b67209e57aa71540417a",
    "cve_id": "CVE-2014-0050",
    "cwe_id": "CWE-264",
    "filename": "src/main/java/org/apache/commons/fileupload/FileUploadBase.java",
    "is_vulnerable": 0,
    "class_name": "FileUploadBase",
    "subclass_name": null,
    "function_name": "getHeaderEncoding()",
    "function_body": "{\n        return headerEncoding;\n    }"
  },
  {
    "id": 10,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 9,
    "human_patch": "https://github.com/apache/commons-fileupload/commit/c61ff05b3241cb14d989b67209e57aa71540417a",
    "cve_id": "CVE-2014-0050",
    "cwe_id": "CWE-264",
    "filename": "src/main/java/org/apache/commons/fileupload/FileUploadBase.java",
    "is_vulnerable": 0,
    "class_name": "FileUploadBase",
    "subclass_name": null,
    "function_name": "setHeaderEncoding(String encoding)",
    "function_body": "{\n        headerEncoding = encoding;\n    }"
  },
  {
    "id": 10,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 10,
    "human_patch": "https://github.com/apache/commons-fileupload/commit/c61ff05b3241cb14d989b67209e57aa71540417a",
    "cve_id": "CVE-2014-0050",
    "cwe_id": "CWE-264",
    "filename": "src/main/java/org/apache/commons/fileupload/FileUploadBase.java",
    "is_vulnerable": 0,
    "class_name": "FileUploadBase",
    "subclass_name": null,
    "function_name": "parseRequest(HttpServletRequest req) throws FileUploadException",
    "function_body": "{\n        return parseRequest(new ServletRequestContext(req));\n    }"
  },
  {
    "id": 10,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 11,
    "human_patch": "https://github.com/apache/commons-fileupload/commit/c61ff05b3241cb14d989b67209e57aa71540417a",
    "cve_id": "CVE-2014-0050",
    "cwe_id": "CWE-264",
    "filename": "src/main/java/org/apache/commons/fileupload/FileUploadBase.java",
    "is_vulnerable": 0,
    "class_name": "FileUploadBase",
    "subclass_name": null,
    "function_name": "getItemIterator(RequestContext ctx) throws FileUploadException, IOException",
    "function_body": "{\n        try {\n            return new FileItemIteratorImpl(ctx);\n        } catch (FileUploadIOException e) {\n            \n            throw (FileUploadException) e.getCause();\n        }\n    }"
  },
  {
    "id": 10,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 12,
    "human_patch": "https://github.com/apache/commons-fileupload/commit/c61ff05b3241cb14d989b67209e57aa71540417a",
    "cve_id": "CVE-2014-0050",
    "cwe_id": "CWE-264",
    "filename": "src/main/java/org/apache/commons/fileupload/FileUploadBase.java",
    "is_vulnerable": 0,
    "class_name": "FileUploadBase",
    "subclass_name": null,
    "function_name": "parseRequest(RequestContext ctx) throws FileUploadException",
    "function_body": "{\n        List<FileItem> items = new ArrayList<FileItem>();\n        boolean successful = false;\n        try {\n            FileItemIterator iter = getItemIterator(ctx);\n            FileItemFactory fac = getFileItemFactory();\n            if (fac == null) {\n                throw new NullPointerException(\"No FileItemFactory has been set.\");\n            }\n            while (iter.hasNext()) {\n                final FileItemStream item = iter.next();\n                \n                final String fileName = ((FileItemIteratorImpl.FileItemStreamImpl) item).name;\n                FileItem fileItem = fac.createItem(item.getFieldName(), item.getContentType(),\n                                                   item.isFormField(), fileName);\n                items.add(fileItem);\n                try {\n                    Streams.copy(item.openStream(), fileItem.getOutputStream(), true);\n                } catch (FileUploadIOException e) {\n                    throw (FileUploadException) e.getCause();\n                } catch (IOException e) {\n                    throw new IOFileUploadException(format(\"Processing of %s request failed. %s\",\n                                                           MULTIPART_FORM_DATA, e.getMessage()), e);\n                }\n                final FileItemHeaders fih = item.getHeaders();\n                fileItem.setHeaders(fih);\n            }\n            successful = true;\n            return items;\n        } catch (FileUploadIOException e) {\n            throw (FileUploadException) e.getCause();\n        } catch (IOException e) {\n            throw new FileUploadException(e.getMessage(), e);\n        } finally {\n            if (!successful) {\n                for (FileItem fileItem : items) {\n                    try {\n                        fileItem.delete();\n                    } catch (Throwable e) {\n                        \n                    }\n                }\n            }\n        }\n    }"
  },
  {
    "id": 10,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 13,
    "human_patch": "https://github.com/apache/commons-fileupload/commit/c61ff05b3241cb14d989b67209e57aa71540417a",
    "cve_id": "CVE-2014-0050",
    "cwe_id": "CWE-264",
    "filename": "src/main/java/org/apache/commons/fileupload/FileUploadBase.java",
    "is_vulnerable": 0,
    "class_name": "FileUploadBase",
    "subclass_name": null,
    "function_name": "parseParameterMap(RequestContext ctx) throws FileUploadException",
    "function_body": "{\n        final List<FileItem> items = parseRequest(ctx);\n        final Map<String, List<FileItem>> itemsMap = new HashMap<String, List<FileItem>>(items.size());\n\n        for (FileItem fileItem : items) {\n            String fieldName = fileItem.getFieldName();\n            List<FileItem> mappedItems = itemsMap.get(fieldName);\n\n            if (mappedItems == null) {\n                mappedItems = new ArrayList<FileItem>();\n                itemsMap.put(fieldName, mappedItems);\n            }\n\n            mappedItems.add(fileItem);\n        }\n\n        return itemsMap;\n    }"
  },
  {
    "id": 10,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 14,
    "human_patch": "https://github.com/apache/commons-fileupload/commit/c61ff05b3241cb14d989b67209e57aa71540417a",
    "cve_id": "CVE-2014-0050",
    "cwe_id": "CWE-264",
    "filename": "src/main/java/org/apache/commons/fileupload/FileUploadBase.java",
    "is_vulnerable": 0,
    "class_name": "FileUploadBase",
    "subclass_name": null,
    "function_name": "getBoundary(String contentType)",
    "function_body": "{\n        ParameterParser parser = new ParameterParser();\n        parser.setLowerCaseNames(true);\n        \n        Map<String, String> params = parser.parse(contentType, new char[] {';', ','});\n        String boundaryStr = params.get(\"boundary\");\n\n        if (boundaryStr == null) {\n            return null;\n        }\n        byte[] boundary;\n        try {\n            boundary = boundaryStr.getBytes(\"ISO-8859-1\");\n        } catch (UnsupportedEncodingException e) {\n            boundary = boundaryStr.getBytes(); \n        }\n        return boundary;\n    }"
  },
  {
    "id": 10,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 15,
    "human_patch": "https://github.com/apache/commons-fileupload/commit/c61ff05b3241cb14d989b67209e57aa71540417a",
    "cve_id": "CVE-2014-0050",
    "cwe_id": "CWE-264",
    "filename": "src/main/java/org/apache/commons/fileupload/FileUploadBase.java",
    "is_vulnerable": 0,
    "class_name": "FileUploadBase",
    "subclass_name": null,
    "function_name": "getFileName(Map<String, String> headers)",
    "function_body": "{\n        return getFileName(getHeader(headers, CONTENT_DISPOSITION));\n    }"
  },
  {
    "id": 10,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 16,
    "human_patch": "https://github.com/apache/commons-fileupload/commit/c61ff05b3241cb14d989b67209e57aa71540417a",
    "cve_id": "CVE-2014-0050",
    "cwe_id": "CWE-264",
    "filename": "src/main/java/org/apache/commons/fileupload/FileUploadBase.java",
    "is_vulnerable": 0,
    "class_name": "FileUploadBase",
    "subclass_name": null,
    "function_name": "getFileName(FileItemHeaders headers)",
    "function_body": "{\n        return getFileName(headers.getHeader(CONTENT_DISPOSITION));\n    }"
  },
  {
    "id": 10,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 17,
    "human_patch": "https://github.com/apache/commons-fileupload/commit/c61ff05b3241cb14d989b67209e57aa71540417a",
    "cve_id": "CVE-2014-0050",
    "cwe_id": "CWE-264",
    "filename": "src/main/java/org/apache/commons/fileupload/FileUploadBase.java",
    "is_vulnerable": 0,
    "class_name": "FileUploadBase",
    "subclass_name": null,
    "function_name": "getFileName(String pContentDisposition)",
    "function_body": "{\n        String fileName = null;\n        if (pContentDisposition != null) {\n            String cdl = pContentDisposition.toLowerCase(Locale.ENGLISH);\n            if (cdl.startsWith(FORM_DATA) || cdl.startsWith(ATTACHMENT)) {\n                ParameterParser parser = new ParameterParser();\n                parser.setLowerCaseNames(true);\n                \n                Map<String, String> params = parser.parse(pContentDisposition, ';');\n                if (params.containsKey(\"filename\")) {\n                    fileName = params.get(\"filename\");\n                    if (fileName != null) {\n                        fileName = fileName.trim();\n                    } else {\n                        \n                        \n                        \n                        fileName = \"\";\n                    }\n                }\n            }\n        }\n        return fileName;\n    }"
  },
  {
    "id": 10,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 18,
    "human_patch": "https://github.com/apache/commons-fileupload/commit/c61ff05b3241cb14d989b67209e57aa71540417a",
    "cve_id": "CVE-2014-0050",
    "cwe_id": "CWE-264",
    "filename": "src/main/java/org/apache/commons/fileupload/FileUploadBase.java",
    "is_vulnerable": 0,
    "class_name": "FileUploadBase",
    "subclass_name": null,
    "function_name": "getFieldName(FileItemHeaders headers)",
    "function_body": "{\n        return getFieldName(headers.getHeader(CONTENT_DISPOSITION));\n    }"
  },
  {
    "id": 10,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 19,
    "human_patch": "https://github.com/apache/commons-fileupload/commit/c61ff05b3241cb14d989b67209e57aa71540417a",
    "cve_id": "CVE-2014-0050",
    "cwe_id": "CWE-264",
    "filename": "src/main/java/org/apache/commons/fileupload/FileUploadBase.java",
    "is_vulnerable": 0,
    "class_name": "FileUploadBase",
    "subclass_name": null,
    "function_name": "getFieldName(String pContentDisposition)",
    "function_body": "{\n        String fieldName = null;\n        if (pContentDisposition != null\n                && pContentDisposition.toLowerCase(Locale.ENGLISH).startsWith(FORM_DATA)) {\n            ParameterParser parser = new ParameterParser();\n            parser.setLowerCaseNames(true);\n            \n            Map<String, String> params = parser.parse(pContentDisposition, ';');\n            fieldName = params.get(\"name\");\n            if (fieldName != null) {\n                fieldName = fieldName.trim();\n            }\n        }\n        return fieldName;\n    }"
  },
  {
    "id": 10,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 20,
    "human_patch": "https://github.com/apache/commons-fileupload/commit/c61ff05b3241cb14d989b67209e57aa71540417a",
    "cve_id": "CVE-2014-0050",
    "cwe_id": "CWE-264",
    "filename": "src/main/java/org/apache/commons/fileupload/FileUploadBase.java",
    "is_vulnerable": 0,
    "class_name": "FileUploadBase",
    "subclass_name": null,
    "function_name": "getFieldName(Map<String, String> headers)",
    "function_body": "{\n        return getFieldName(getHeader(headers, CONTENT_DISPOSITION));\n    }"
  },
  {
    "id": 10,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 21,
    "human_patch": "https://github.com/apache/commons-fileupload/commit/c61ff05b3241cb14d989b67209e57aa71540417a",
    "cve_id": "CVE-2014-0050",
    "cwe_id": "CWE-264",
    "filename": "src/main/java/org/apache/commons/fileupload/FileUploadBase.java",
    "is_vulnerable": 0,
    "class_name": "FileUploadBase",
    "subclass_name": null,
    "function_name": "createItem(Map<String, String> headers,\n                                  boolean isFormField) throws FileUploadException",
    "function_body": "{\n        return getFileItemFactory().createItem(getFieldName(headers),\n                getHeader(headers, CONTENT_TYPE),\n                isFormField,\n                getFileName(headers));\n    }"
  },
  {
    "id": 10,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 22,
    "human_patch": "https://github.com/apache/commons-fileupload/commit/c61ff05b3241cb14d989b67209e57aa71540417a",
    "cve_id": "CVE-2014-0050",
    "cwe_id": "CWE-264",
    "filename": "src/main/java/org/apache/commons/fileupload/FileUploadBase.java",
    "is_vulnerable": 0,
    "class_name": "FileUploadBase",
    "subclass_name": null,
    "function_name": "getParsedHeaders(String headerPart)",
    "function_body": "{\n        final int len = headerPart.length();\n        FileItemHeadersImpl headers = newFileItemHeaders();\n        int start = 0;\n        for (;;) {\n            int end = parseEndOfLine(headerPart, start);\n            if (start == end) {\n                break;\n            }\n            StringBuilder header = new StringBuilder(headerPart.substring(start, end));\n            start = end + 2;\n            while (start < len) {\n                int nonWs = start;\n                while (nonWs < len) {\n                    char c = headerPart.charAt(nonWs);\n                    if (c != ' '  &&  c != '\\t') {\n                        break;\n                    }\n                    ++nonWs;\n                }\n                if (nonWs == start) {\n                    break;\n                }\n                \n                end = parseEndOfLine(headerPart, nonWs);\n                header.append(\" \").append(headerPart.substring(nonWs, end));\n                start = end + 2;\n            }\n            parseHeaderLine(headers, header.toString());\n        }\n        return headers;\n    }"
  },
  {
    "id": 10,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 23,
    "human_patch": "https://github.com/apache/commons-fileupload/commit/c61ff05b3241cb14d989b67209e57aa71540417a",
    "cve_id": "CVE-2014-0050",
    "cwe_id": "CWE-264",
    "filename": "src/main/java/org/apache/commons/fileupload/FileUploadBase.java",
    "is_vulnerable": 0,
    "class_name": "FileUploadBase",
    "subclass_name": null,
    "function_name": "newFileItemHeaders()",
    "function_body": "{\n        return new FileItemHeadersImpl();\n    }"
  },
  {
    "id": 10,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 24,
    "human_patch": "https://github.com/apache/commons-fileupload/commit/c61ff05b3241cb14d989b67209e57aa71540417a",
    "cve_id": "CVE-2014-0050",
    "cwe_id": "CWE-264",
    "filename": "src/main/java/org/apache/commons/fileupload/FileUploadBase.java",
    "is_vulnerable": 0,
    "class_name": "FileUploadBase",
    "subclass_name": null,
    "function_name": "parseHeaders(String headerPart)",
    "function_body": "{\n        FileItemHeaders headers = getParsedHeaders(headerPart);\n        Map<String, String> result = new HashMap<String, String>();\n        for (Iterator<String> iter = headers.getHeaderNames();  iter.hasNext();) {\n            String headerName = iter.next();\n            Iterator<String> iter2 = headers.getHeaders(headerName);\n            StringBuilder headerValue = new StringBuilder(iter2.next());\n            while (iter2.hasNext()) {\n                headerValue.append(\",\").append(iter2.next());\n            }\n            result.put(headerName, headerValue.toString());\n        }\n        return result;\n    }"
  },
  {
    "id": 10,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 25,
    "human_patch": "https://github.com/apache/commons-fileupload/commit/c61ff05b3241cb14d989b67209e57aa71540417a",
    "cve_id": "CVE-2014-0050",
    "cwe_id": "CWE-264",
    "filename": "src/main/java/org/apache/commons/fileupload/FileUploadBase.java",
    "is_vulnerable": 0,
    "class_name": "FileUploadBase",
    "subclass_name": null,
    "function_name": "parseEndOfLine(String headerPart, int end)",
    "function_body": "{\n        int index = end;\n        for (;;) {\n            int offset = headerPart.indexOf('\\r', index);\n            if (offset == -1  ||  offset + 1 >= headerPart.length()) {\n                throw new IllegalStateException(\n                    \"Expected headers to be terminated by an empty line.\");\n            }\n            if (headerPart.charAt(offset + 1) == '\\n') {\n                return offset;\n            }\n            index = offset + 1;\n        }\n    }"
  },
  {
    "id": 10,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 26,
    "human_patch": "https://github.com/apache/commons-fileupload/commit/c61ff05b3241cb14d989b67209e57aa71540417a",
    "cve_id": "CVE-2014-0050",
    "cwe_id": "CWE-264",
    "filename": "src/main/java/org/apache/commons/fileupload/FileUploadBase.java",
    "is_vulnerable": 0,
    "class_name": "FileUploadBase",
    "subclass_name": null,
    "function_name": "parseHeaderLine(FileItemHeadersImpl headers, String header)",
    "function_body": "{\n        final int colonOffset = header.indexOf(':');\n        if (colonOffset == -1) {\n            \n            return;\n        }\n        String headerName = header.substring(0, colonOffset).trim();\n        String headerValue =\n            header.substring(header.indexOf(':') + 1).trim();\n        headers.addHeader(headerName, headerValue);\n    }"
  },
  {
    "id": 10,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 27,
    "human_patch": "https://github.com/apache/commons-fileupload/commit/c61ff05b3241cb14d989b67209e57aa71540417a",
    "cve_id": "CVE-2014-0050",
    "cwe_id": "CWE-264",
    "filename": "src/main/java/org/apache/commons/fileupload/FileUploadBase.java",
    "is_vulnerable": 0,
    "class_name": "FileUploadBase",
    "subclass_name": null,
    "function_name": "getHeader(Map<String, String> headers,\n            String name)",
    "function_body": "{\n        return headers.get(name.toLowerCase(Locale.ENGLISH));\n    }"
  },
  {
    "id": 10,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 28,
    "human_patch": "https://github.com/apache/commons-fileupload/commit/c61ff05b3241cb14d989b67209e57aa71540417a",
    "cve_id": "CVE-2014-0050",
    "cwe_id": "CWE-264",
    "filename": "src/main/java/org/apache/commons/fileupload/FileUploadBase.java",
    "is_vulnerable": 0,
    "class_name": "FileUploadBase",
    "subclass_name": "FileItemIteratorImpl",
    "function_name": "raiseError(long pSizeMax, long pCount) throws IOException",
    "function_body": "{\n                            itemStream.close(true);\n                            FileSizeLimitExceededException e =\n                                new FileSizeLimitExceededException(\n                                    format(\"The field %s exceeds its maximum permitted size of %s bytes.\",\n                                           fieldName, Long.valueOf(pSizeMax)),\n                                    pCount, pSizeMax);\n                            e.setFieldName(fieldName);\n                            e.setFileName(name);\n                            throw new FileUploadIOException(e);\n                        }"
  },
  {
    "id": 10,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 29,
    "human_patch": "https://github.com/apache/commons-fileupload/commit/c61ff05b3241cb14d989b67209e57aa71540417a",
    "cve_id": "CVE-2014-0050",
    "cwe_id": "CWE-264",
    "filename": "src/main/java/org/apache/commons/fileupload/FileUploadBase.java",
    "is_vulnerable": 0,
    "class_name": "FileUploadBase",
    "subclass_name": "FileItemIteratorImpl",
    "function_name": "getContentType()",
    "function_body": "{\n                return contentType;\n            }"
  },
  {
    "id": 10,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 30,
    "human_patch": "https://github.com/apache/commons-fileupload/commit/c61ff05b3241cb14d989b67209e57aa71540417a",
    "cve_id": "CVE-2014-0050",
    "cwe_id": "CWE-264",
    "filename": "src/main/java/org/apache/commons/fileupload/FileUploadBase.java",
    "is_vulnerable": 0,
    "class_name": "FileUploadBase",
    "subclass_name": "FileItemIteratorImpl",
    "function_name": "getFieldName()",
    "function_body": "{\n                return fieldName;\n            }"
  },
  {
    "id": 10,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 31,
    "human_patch": "https://github.com/apache/commons-fileupload/commit/c61ff05b3241cb14d989b67209e57aa71540417a",
    "cve_id": "CVE-2014-0050",
    "cwe_id": "CWE-264",
    "filename": "src/main/java/org/apache/commons/fileupload/FileUploadBase.java",
    "is_vulnerable": 0,
    "class_name": "FileUploadBase",
    "subclass_name": "FileItemIteratorImpl",
    "function_name": "getName()",
    "function_body": "{\n                return Streams.checkFileName(name);\n            }"
  },
  {
    "id": 10,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 32,
    "human_patch": "https://github.com/apache/commons-fileupload/commit/c61ff05b3241cb14d989b67209e57aa71540417a",
    "cve_id": "CVE-2014-0050",
    "cwe_id": "CWE-264",
    "filename": "src/main/java/org/apache/commons/fileupload/FileUploadBase.java",
    "is_vulnerable": 0,
    "class_name": "FileUploadBase",
    "subclass_name": "FileItemIteratorImpl",
    "function_name": "isFormField()",
    "function_body": "{\n                return formField;\n            }"
  },
  {
    "id": 10,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 33,
    "human_patch": "https://github.com/apache/commons-fileupload/commit/c61ff05b3241cb14d989b67209e57aa71540417a",
    "cve_id": "CVE-2014-0050",
    "cwe_id": "CWE-264",
    "filename": "src/main/java/org/apache/commons/fileupload/FileUploadBase.java",
    "is_vulnerable": 0,
    "class_name": "FileUploadBase",
    "subclass_name": "FileItemIteratorImpl",
    "function_name": "openStream() throws IOException",
    "function_body": "{\n                if (opened) {\n                    throw new IllegalStateException(\n                            \"The stream was already opened.\");\n                }\n                if (((Closeable) stream).isClosed()) {\n                    throw new FileItemStream.ItemSkippedException();\n                }\n                return stream;\n            }"
  },
  {
    "id": 10,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 34,
    "human_patch": "https://github.com/apache/commons-fileupload/commit/c61ff05b3241cb14d989b67209e57aa71540417a",
    "cve_id": "CVE-2014-0050",
    "cwe_id": "CWE-264",
    "filename": "src/main/java/org/apache/commons/fileupload/FileUploadBase.java",
    "is_vulnerable": 0,
    "class_name": "FileUploadBase",
    "subclass_name": "FileItemIteratorImpl",
    "function_name": "close() throws IOException",
    "function_body": "{\n                stream.close();\n            }"
  },
  {
    "id": 10,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 35,
    "human_patch": "https://github.com/apache/commons-fileupload/commit/c61ff05b3241cb14d989b67209e57aa71540417a",
    "cve_id": "CVE-2014-0050",
    "cwe_id": "CWE-264",
    "filename": "src/main/java/org/apache/commons/fileupload/FileUploadBase.java",
    "is_vulnerable": 0,
    "class_name": "FileUploadBase",
    "subclass_name": "FileItemIteratorImpl",
    "function_name": "getHeaders()",
    "function_body": "{\n                return headers;\n            }"
  },
  {
    "id": 10,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 36,
    "human_patch": "https://github.com/apache/commons-fileupload/commit/c61ff05b3241cb14d989b67209e57aa71540417a",
    "cve_id": "CVE-2014-0050",
    "cwe_id": "CWE-264",
    "filename": "src/main/java/org/apache/commons/fileupload/FileUploadBase.java",
    "is_vulnerable": 0,
    "class_name": "FileUploadBase",
    "subclass_name": "FileItemIteratorImpl",
    "function_name": "setHeaders(FileItemHeaders pHeaders)",
    "function_body": "{\n                headers = pHeaders;\n            }"
  },
  {
    "id": 10,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 37,
    "human_patch": "https://github.com/apache/commons-fileupload/commit/c61ff05b3241cb14d989b67209e57aa71540417a",
    "cve_id": "CVE-2014-0050",
    "cwe_id": "CWE-264",
    "filename": "src/main/java/org/apache/commons/fileupload/FileUploadBase.java",
    "is_vulnerable": 1,
    "class_name": "FileUploadBase",
    "subclass_name": "FileItemIteratorImpl",
    "function_name": "raiseError(long pSizeMax, long pCount) throws IOException",
    "function_body": "{\n                        FileUploadException ex = new SizeLimitExceededException(\n                        format(\"the request was rejected because its size (%s) exceeds the configured maximum (%s)\",\n                                Long.valueOf(pCount), Long.valueOf(pSizeMax)),\n                               pCount, pSizeMax);\n                        throw new FileUploadIOException(ex);\n                    }"
  },
  {
    "id": 10,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 38,
    "human_patch": "https://github.com/apache/commons-fileupload/commit/c61ff05b3241cb14d989b67209e57aa71540417a",
    "cve_id": "CVE-2014-0050",
    "cwe_id": "CWE-264",
    "filename": "src/main/java/org/apache/commons/fileupload/FileUploadBase.java",
    "is_vulnerable": 0,
    "class_name": "FileUploadBase",
    "subclass_name": "FileItemIteratorImpl",
    "function_name": "findNextItem() throws IOException",
    "function_body": "{\n            if (eof) {\n                return false;\n            }\n            if (currentItem != null) {\n                currentItem.close();\n                currentItem = null;\n            }\n            for (;;) {\n                boolean nextPart;\n                if (skipPreamble) {\n                    nextPart = multi.skipPreamble();\n                } else {\n                    nextPart = multi.readBoundary();\n                }\n                if (!nextPart) {\n                    if (currentFieldName == null) {\n                        \n                        eof = true;\n                        return false;\n                    }\n                    \n                    multi.setBoundary(boundary);\n                    currentFieldName = null;\n                    continue;\n                }\n                FileItemHeaders headers = getParsedHeaders(multi.readHeaders());\n                if (currentFieldName == null) {\n                    \n                    String fieldName = getFieldName(headers);\n                    if (fieldName != null) {\n                        String subContentType = headers.getHeader(CONTENT_TYPE);\n                        if (subContentType != null\n                                &&  subContentType.toLowerCase(Locale.ENGLISH)\n                                        .startsWith(MULTIPART_MIXED)) {\n                            currentFieldName = fieldName;\n                            \n                            byte[] subBoundary = getBoundary(subContentType);\n                            multi.setBoundary(subBoundary);\n                            skipPreamble = true;\n                            continue;\n                        }\n                        String fileName = getFileName(headers);\n                        currentItem = new FileItemStreamImpl(fileName,\n                                fieldName, headers.getHeader(CONTENT_TYPE),\n                                fileName == null, getContentLength(headers));\n                        currentItem.setHeaders(headers);\n                        notifier.noteItem();\n                        itemValid = true;\n                        return true;\n                    }\n                } else {\n                    String fileName = getFileName(headers);\n                    if (fileName != null) {\n                        currentItem = new FileItemStreamImpl(fileName,\n                                currentFieldName,\n                                headers.getHeader(CONTENT_TYPE),\n                                false, getContentLength(headers));\n                        currentItem.setHeaders(headers);\n                        notifier.noteItem();\n                        itemValid = true;\n                        return true;\n                    }\n                }\n                multi.discardBodyData();\n            }\n        }"
  },
  {
    "id": 10,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 39,
    "human_patch": "https://github.com/apache/commons-fileupload/commit/c61ff05b3241cb14d989b67209e57aa71540417a",
    "cve_id": "CVE-2014-0050",
    "cwe_id": "CWE-264",
    "filename": "src/main/java/org/apache/commons/fileupload/FileUploadBase.java",
    "is_vulnerable": 0,
    "class_name": "FileUploadBase",
    "subclass_name": "FileItemIteratorImpl",
    "function_name": "getContentLength(FileItemHeaders pHeaders)",
    "function_body": "{\n            try {\n                return Long.parseLong(pHeaders.getHeader(CONTENT_LENGTH));\n            } catch (Exception e) {\n                return -1;\n            }\n        }"
  },
  {
    "id": 10,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 40,
    "human_patch": "https://github.com/apache/commons-fileupload/commit/c61ff05b3241cb14d989b67209e57aa71540417a",
    "cve_id": "CVE-2014-0050",
    "cwe_id": "CWE-264",
    "filename": "src/main/java/org/apache/commons/fileupload/FileUploadBase.java",
    "is_vulnerable": 0,
    "class_name": "FileUploadBase",
    "subclass_name": "FileItemIteratorImpl",
    "function_name": "hasNext() throws FileUploadException, IOException",
    "function_body": "{\n            if (eof) {\n                return false;\n            }\n            if (itemValid) {\n                return true;\n            }\n            try {\n                return findNextItem();\n            } catch (FileUploadIOException e) {\n                \n                throw (FileUploadException) e.getCause();\n            }\n        }"
  },
  {
    "id": 10,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 41,
    "human_patch": "https://github.com/apache/commons-fileupload/commit/c61ff05b3241cb14d989b67209e57aa71540417a",
    "cve_id": "CVE-2014-0050",
    "cwe_id": "CWE-264",
    "filename": "src/main/java/org/apache/commons/fileupload/FileUploadBase.java",
    "is_vulnerable": 0,
    "class_name": "FileUploadBase",
    "subclass_name": "FileItemIteratorImpl",
    "function_name": "next() throws FileUploadException, IOException",
    "function_body": "{\n            if (eof  ||  (!itemValid && !hasNext())) {\n                throw new NoSuchElementException();\n            }\n            itemValid = false;\n            return currentItem;\n        }"
  },
  {
    "id": 10,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 42,
    "human_patch": "https://github.com/apache/commons-fileupload/commit/c61ff05b3241cb14d989b67209e57aa71540417a",
    "cve_id": "CVE-2014-0050",
    "cwe_id": "CWE-264",
    "filename": "src/main/java/org/apache/commons/fileupload/FileUploadBase.java",
    "is_vulnerable": 0,
    "class_name": "FileUploadBase",
    "subclass_name": "FileUploadIOException",
    "function_name": "getCause()",
    "function_body": "{\n            return cause;\n        }"
  },
  {
    "id": 10,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 43,
    "human_patch": "https://github.com/apache/commons-fileupload/commit/c61ff05b3241cb14d989b67209e57aa71540417a",
    "cve_id": "CVE-2014-0050",
    "cwe_id": "CWE-264",
    "filename": "src/main/java/org/apache/commons/fileupload/FileUploadBase.java",
    "is_vulnerable": 0,
    "class_name": "FileUploadBase",
    "subclass_name": "IOFileUploadException",
    "function_name": "getCause()",
    "function_body": "{\n            return cause;\n        }"
  },
  {
    "id": 10,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 44,
    "human_patch": "https://github.com/apache/commons-fileupload/commit/c61ff05b3241cb14d989b67209e57aa71540417a",
    "cve_id": "CVE-2014-0050",
    "cwe_id": "CWE-264",
    "filename": "src/main/java/org/apache/commons/fileupload/FileUploadBase.java",
    "is_vulnerable": 0,
    "class_name": "FileUploadBase",
    "subclass_name": "SizeException",
    "function_name": "getActualSize()",
    "function_body": "{\n            return actual;\n        }"
  },
  {
    "id": 10,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 45,
    "human_patch": "https://github.com/apache/commons-fileupload/commit/c61ff05b3241cb14d989b67209e57aa71540417a",
    "cve_id": "CVE-2014-0050",
    "cwe_id": "CWE-264",
    "filename": "src/main/java/org/apache/commons/fileupload/FileUploadBase.java",
    "is_vulnerable": 0,
    "class_name": "FileUploadBase",
    "subclass_name": "SizeException",
    "function_name": "getPermittedSize()",
    "function_body": "{\n            return permitted;\n        }"
  },
  {
    "id": 10,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 46,
    "human_patch": "https://github.com/apache/commons-fileupload/commit/c61ff05b3241cb14d989b67209e57aa71540417a",
    "cve_id": "CVE-2014-0050",
    "cwe_id": "CWE-264",
    "filename": "src/main/java/org/apache/commons/fileupload/FileUploadBase.java",
    "is_vulnerable": 0,
    "class_name": "FileUploadBase",
    "subclass_name": "FileSizeLimitExceededException",
    "function_name": "getFileName()",
    "function_body": "{\n            return fileName;\n        }"
  },
  {
    "id": 10,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 47,
    "human_patch": "https://github.com/apache/commons-fileupload/commit/c61ff05b3241cb14d989b67209e57aa71540417a",
    "cve_id": "CVE-2014-0050",
    "cwe_id": "CWE-264",
    "filename": "src/main/java/org/apache/commons/fileupload/FileUploadBase.java",
    "is_vulnerable": 0,
    "class_name": "FileUploadBase",
    "subclass_name": "FileSizeLimitExceededException",
    "function_name": "setFileName(String pFileName)",
    "function_body": "{\n            fileName = pFileName;\n        }"
  },
  {
    "id": 10,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 48,
    "human_patch": "https://github.com/apache/commons-fileupload/commit/c61ff05b3241cb14d989b67209e57aa71540417a",
    "cve_id": "CVE-2014-0050",
    "cwe_id": "CWE-264",
    "filename": "src/main/java/org/apache/commons/fileupload/FileUploadBase.java",
    "is_vulnerable": 0,
    "class_name": "FileUploadBase",
    "subclass_name": "FileSizeLimitExceededException",
    "function_name": "getFieldName()",
    "function_body": "{\n            return fieldName;\n        }"
  },
  {
    "id": 10,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 49,
    "human_patch": "https://github.com/apache/commons-fileupload/commit/c61ff05b3241cb14d989b67209e57aa71540417a",
    "cve_id": "CVE-2014-0050",
    "cwe_id": "CWE-264",
    "filename": "src/main/java/org/apache/commons/fileupload/FileUploadBase.java",
    "is_vulnerable": 0,
    "class_name": "FileUploadBase",
    "subclass_name": "FileSizeLimitExceededException",
    "function_name": "setFieldName(String pFieldName)",
    "function_body": "{\n            fieldName = pFieldName;\n        }"
  },
  {
    "id": 10,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 50,
    "human_patch": "https://github.com/apache/commons-fileupload/commit/c61ff05b3241cb14d989b67209e57aa71540417a",
    "cve_id": "CVE-2014-0050",
    "cwe_id": "CWE-264",
    "filename": "src/main/java/org/apache/commons/fileupload/FileUploadBase.java",
    "is_vulnerable": 0,
    "class_name": "FileUploadBase",
    "subclass_name": null,
    "function_name": "getProgressListener()",
    "function_body": "{\n        return listener;\n    }"
  },
  {
    "id": 10,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 51,
    "human_patch": "https://github.com/apache/commons-fileupload/commit/c61ff05b3241cb14d989b67209e57aa71540417a",
    "cve_id": "CVE-2014-0050",
    "cwe_id": "CWE-264",
    "filename": "src/main/java/org/apache/commons/fileupload/FileUploadBase.java",
    "is_vulnerable": 0,
    "class_name": "FileUploadBase",
    "subclass_name": null,
    "function_name": "setProgressListener(ProgressListener pListener)",
    "function_body": "{\n        listener = pListener;\n    }"
  },
  {
    "id": 10,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 0,
    "human_patch": "https://github.com/apache/commons-fileupload/commit/c61ff05b3241cb14d989b67209e57aa71540417a",
    "cve_id": "CVE-2014-0050",
    "cwe_id": "CWE-264",
    "filename": "src/main/java/org/apache/commons/fileupload/MultipartStream.java",
    "is_vulnerable": 0,
    "class_name": "MultipartStream",
    "subclass_name": "ProgressNotifier",
    "function_name": "noteBytesRead(int pBytes)",
    "function_body": "{\n            \n            bytesRead += pBytes;\n            notifyListener();\n        }"
  },
  {
    "id": 10,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 1,
    "human_patch": "https://github.com/apache/commons-fileupload/commit/c61ff05b3241cb14d989b67209e57aa71540417a",
    "cve_id": "CVE-2014-0050",
    "cwe_id": "CWE-264",
    "filename": "src/main/java/org/apache/commons/fileupload/MultipartStream.java",
    "is_vulnerable": 0,
    "class_name": "MultipartStream",
    "subclass_name": "ProgressNotifier",
    "function_name": "noteItem()",
    "function_body": "{\n            ++items;\n            notifyListener();\n        }"
  },
  {
    "id": 10,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 2,
    "human_patch": "https://github.com/apache/commons-fileupload/commit/c61ff05b3241cb14d989b67209e57aa71540417a",
    "cve_id": "CVE-2014-0050",
    "cwe_id": "CWE-264",
    "filename": "src/main/java/org/apache/commons/fileupload/MultipartStream.java",
    "is_vulnerable": 0,
    "class_name": "MultipartStream",
    "subclass_name": "ProgressNotifier",
    "function_name": "notifyListener()",
    "function_body": "{\n            if (listener != null) {\n                listener.update(bytesRead, contentLength, items);\n            }\n        }"
  },
  {
    "id": 10,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 3,
    "human_patch": "https://github.com/apache/commons-fileupload/commit/c61ff05b3241cb14d989b67209e57aa71540417a",
    "cve_id": "CVE-2014-0050",
    "cwe_id": "CWE-264",
    "filename": "src/main/java/org/apache/commons/fileupload/MultipartStream.java",
    "is_vulnerable": 0,
    "class_name": "MultipartStream",
    "subclass_name": null,
    "function_name": "getHeaderEncoding()",
    "function_body": "{\n        return headerEncoding;\n    }"
  },
  {
    "id": 10,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 4,
    "human_patch": "https://github.com/apache/commons-fileupload/commit/c61ff05b3241cb14d989b67209e57aa71540417a",
    "cve_id": "CVE-2014-0050",
    "cwe_id": "CWE-264",
    "filename": "src/main/java/org/apache/commons/fileupload/MultipartStream.java",
    "is_vulnerable": 0,
    "class_name": "MultipartStream",
    "subclass_name": null,
    "function_name": "setHeaderEncoding(String encoding)",
    "function_body": "{\n        headerEncoding = encoding;\n    }"
  },
  {
    "id": 10,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 5,
    "human_patch": "https://github.com/apache/commons-fileupload/commit/c61ff05b3241cb14d989b67209e57aa71540417a",
    "cve_id": "CVE-2014-0050",
    "cwe_id": "CWE-264",
    "filename": "src/main/java/org/apache/commons/fileupload/MultipartStream.java",
    "is_vulnerable": 0,
    "class_name": "MultipartStream",
    "subclass_name": null,
    "function_name": "readByte() throws IOException",
    "function_body": "{\n        \n        if (head == tail) {\n            head = 0;\n            \n            tail = input.read(buffer, head, bufSize);\n            if (tail == -1) {\n                \n                throw new IOException(\"No more data is available\");\n            }\n            if (notifier != null) {\n                notifier.noteBytesRead(tail);\n            }\n        }\n        return buffer[head++];\n    }"
  },
  {
    "id": 10,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 6,
    "human_patch": "https://github.com/apache/commons-fileupload/commit/c61ff05b3241cb14d989b67209e57aa71540417a",
    "cve_id": "CVE-2014-0050",
    "cwe_id": "CWE-264",
    "filename": "src/main/java/org/apache/commons/fileupload/MultipartStream.java",
    "is_vulnerable": 0,
    "class_name": "MultipartStream",
    "subclass_name": null,
    "function_name": "readBoundary() throws FileUploadIOException, MalformedStreamException",
    "function_body": "{\n        byte[] marker = new byte[2];\n        boolean nextChunk = false;\n\n        head += boundaryLength;\n        try {\n            marker[0] = readByte();\n            if (marker[0] == LF) {\n                \n                \n                \n                \n                \n                \n                return true;\n            }\n\n            marker[1] = readByte();\n            if (arrayequals(marker, STREAM_TERMINATOR, 2)) {\n                nextChunk = false;\n            } else if (arrayequals(marker, FIELD_SEPARATOR, 2)) {\n                nextChunk = true;\n            } else {\n                throw new MalformedStreamException(\n                \"Unexpected characters follow a boundary\");\n            }\n        } catch (FileUploadIOException e) {\n            \n            throw e;\n        } catch (IOException e) {\n            throw new MalformedStreamException(\"Stream ended unexpectedly\");\n        }\n        return nextChunk;\n    }"
  },
  {
    "id": 10,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 7,
    "human_patch": "https://github.com/apache/commons-fileupload/commit/c61ff05b3241cb14d989b67209e57aa71540417a",
    "cve_id": "CVE-2014-0050",
    "cwe_id": "CWE-264",
    "filename": "src/main/java/org/apache/commons/fileupload/MultipartStream.java",
    "is_vulnerable": 0,
    "class_name": "MultipartStream",
    "subclass_name": null,
    "function_name": "setBoundary(byte[] boundary) throws IllegalBoundaryException",
    "function_body": "{\n        if (boundary.length != boundaryLength - BOUNDARY_PREFIX.length) {\n            throw new IllegalBoundaryException(\n            \"The length of a boundary token can not be changed\");\n        }\n        System.arraycopy(boundary, 0, this.boundary, BOUNDARY_PREFIX.length,\n                boundary.length);\n    }"
  },
  {
    "id": 10,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 8,
    "human_patch": "https://github.com/apache/commons-fileupload/commit/c61ff05b3241cb14d989b67209e57aa71540417a",
    "cve_id": "CVE-2014-0050",
    "cwe_id": "CWE-264",
    "filename": "src/main/java/org/apache/commons/fileupload/MultipartStream.java",
    "is_vulnerable": 0,
    "class_name": "MultipartStream",
    "subclass_name": null,
    "function_name": "readHeaders() throws FileUploadIOException, MalformedStreamException",
    "function_body": "{\n        int i = 0;\n        byte b;\n        \n        ByteArrayOutputStream baos = new ByteArrayOutputStream();\n        int size = 0;\n        while (i < HEADER_SEPARATOR.length) {\n            try {\n                b = readByte();\n            } catch (FileUploadIOException e) {\n                \n                throw e;\n            } catch (IOException e) {\n                throw new MalformedStreamException(\"Stream ended unexpectedly\");\n            }\n            if (++size > HEADER_PART_SIZE_MAX) {\n                throw new MalformedStreamException(\n                        format(\"Header section has more than %s bytes (maybe it is not properly terminated)\",\n                               Integer.valueOf(HEADER_PART_SIZE_MAX)));\n            }\n            if (b == HEADER_SEPARATOR[i]) {\n                i++;\n            } else {\n                i = 0;\n            }\n            baos.write(b);\n        }\n\n        String headers = null;\n        if (headerEncoding != null) {\n            try {\n                headers = baos.toString(headerEncoding);\n            } catch (UnsupportedEncodingException e) {\n                \n                \n                headers = baos.toString();\n            }\n        } else {\n            headers = baos.toString();\n        }\n\n        return headers;\n    }"
  },
  {
    "id": 10,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 9,
    "human_patch": "https://github.com/apache/commons-fileupload/commit/c61ff05b3241cb14d989b67209e57aa71540417a",
    "cve_id": "CVE-2014-0050",
    "cwe_id": "CWE-264",
    "filename": "src/main/java/org/apache/commons/fileupload/MultipartStream.java",
    "is_vulnerable": 0,
    "class_name": "MultipartStream",
    "subclass_name": null,
    "function_name": "readBodyData(OutputStream output) throws MalformedStreamException, IOException",
    "function_body": "{\n        final InputStream istream = newInputStream();\n        return (int) Streams.copy(istream, output, false);\n    }"
  },
  {
    "id": 10,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 10,
    "human_patch": "https://github.com/apache/commons-fileupload/commit/c61ff05b3241cb14d989b67209e57aa71540417a",
    "cve_id": "CVE-2014-0050",
    "cwe_id": "CWE-264",
    "filename": "src/main/java/org/apache/commons/fileupload/MultipartStream.java",
    "is_vulnerable": 0,
    "class_name": "MultipartStream",
    "subclass_name": null,
    "function_name": "newInputStream()",
    "function_body": "{\n        return new ItemInputStream();\n    }"
  },
  {
    "id": 10,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 11,
    "human_patch": "https://github.com/apache/commons-fileupload/commit/c61ff05b3241cb14d989b67209e57aa71540417a",
    "cve_id": "CVE-2014-0050",
    "cwe_id": "CWE-264",
    "filename": "src/main/java/org/apache/commons/fileupload/MultipartStream.java",
    "is_vulnerable": 0,
    "class_name": "MultipartStream",
    "subclass_name": null,
    "function_name": "discardBodyData() throws MalformedStreamException, IOException",
    "function_body": "{\n        return readBodyData(null);\n    }"
  },
  {
    "id": 10,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 12,
    "human_patch": "https://github.com/apache/commons-fileupload/commit/c61ff05b3241cb14d989b67209e57aa71540417a",
    "cve_id": "CVE-2014-0050",
    "cwe_id": "CWE-264",
    "filename": "src/main/java/org/apache/commons/fileupload/MultipartStream.java",
    "is_vulnerable": 0,
    "class_name": "MultipartStream",
    "subclass_name": null,
    "function_name": "skipPreamble() throws IOException",
    "function_body": "{\n        \n        System.arraycopy(boundary, 2, boundary, 0, boundary.length - 2);\n        boundaryLength = boundary.length - 2;\n        try {\n            \n            discardBodyData();\n\n            \n            \n            return readBoundary();\n        } catch (MalformedStreamException e) {\n            return false;\n        } finally {\n            \n            System.arraycopy(boundary, 0, boundary, 2, boundary.length - 2);\n            boundaryLength = boundary.length;\n            boundary[0] = CR;\n            boundary[1] = LF;\n        }\n    }"
  },
  {
    "id": 10,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 13,
    "human_patch": "https://github.com/apache/commons-fileupload/commit/c61ff05b3241cb14d989b67209e57aa71540417a",
    "cve_id": "CVE-2014-0050",
    "cwe_id": "CWE-264",
    "filename": "src/main/java/org/apache/commons/fileupload/MultipartStream.java",
    "is_vulnerable": 0,
    "class_name": "MultipartStream",
    "subclass_name": null,
    "function_name": "arrayequals(byte[] a,\n            byte[] b,\n            int count)",
    "function_body": "{\n        for (int i = 0; i < count; i++) {\n            if (a[i] != b[i]) {\n                return false;\n            }\n        }\n        return true;\n    }"
  },
  {
    "id": 10,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 14,
    "human_patch": "https://github.com/apache/commons-fileupload/commit/c61ff05b3241cb14d989b67209e57aa71540417a",
    "cve_id": "CVE-2014-0050",
    "cwe_id": "CWE-264",
    "filename": "src/main/java/org/apache/commons/fileupload/MultipartStream.java",
    "is_vulnerable": 0,
    "class_name": "MultipartStream",
    "subclass_name": null,
    "function_name": "findByte(byte value,\n            int pos)",
    "function_body": "{\n        for (int i = pos; i < tail; i++) {\n            if (buffer[i] == value) {\n                return i;\n            }\n        }\n\n        return -1;\n    }"
  },
  {
    "id": 10,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 15,
    "human_patch": "https://github.com/apache/commons-fileupload/commit/c61ff05b3241cb14d989b67209e57aa71540417a",
    "cve_id": "CVE-2014-0050",
    "cwe_id": "CWE-264",
    "filename": "src/main/java/org/apache/commons/fileupload/MultipartStream.java",
    "is_vulnerable": 0,
    "class_name": "MultipartStream",
    "subclass_name": null,
    "function_name": "findSeparator()",
    "function_body": "{\n        int first;\n        int match = 0;\n        int maxpos = tail - boundaryLength;\n        for (first = head;\n        (first <= maxpos) && (match != boundaryLength);\n        first++) {\n            first = findByte(boundary[0], first);\n            if (first == -1 || (first > maxpos)) {\n                return -1;\n            }\n            for (match = 1; match < boundaryLength; match++) {\n                if (buffer[first + match] != boundary[match]) {\n                    break;\n                }\n            }\n        }\n        if (match == boundaryLength) {\n            return first - 1;\n        }\n        return -1;\n    }"
  },
  {
    "id": 10,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 16,
    "human_patch": "https://github.com/apache/commons-fileupload/commit/c61ff05b3241cb14d989b67209e57aa71540417a",
    "cve_id": "CVE-2014-0050",
    "cwe_id": "CWE-264",
    "filename": "src/main/java/org/apache/commons/fileupload/MultipartStream.java",
    "is_vulnerable": 0,
    "class_name": "MultipartStream",
    "subclass_name": "ItemInputStream",
    "function_name": "findSeparator()",
    "function_body": "{\n            pos = MultipartStream.this.findSeparator();\n            if (pos == -1) {\n                if (tail - head > keepRegion) {\n                    pad = keepRegion;\n                } else {\n                    pad = tail - head;\n                }\n            }\n        }"
  },
  {
    "id": 10,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 17,
    "human_patch": "https://github.com/apache/commons-fileupload/commit/c61ff05b3241cb14d989b67209e57aa71540417a",
    "cve_id": "CVE-2014-0050",
    "cwe_id": "CWE-264",
    "filename": "src/main/java/org/apache/commons/fileupload/MultipartStream.java",
    "is_vulnerable": 0,
    "class_name": "MultipartStream",
    "subclass_name": "ItemInputStream",
    "function_name": "getBytesRead()",
    "function_body": "{\n            return total;\n        }"
  },
  {
    "id": 10,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 18,
    "human_patch": "https://github.com/apache/commons-fileupload/commit/c61ff05b3241cb14d989b67209e57aa71540417a",
    "cve_id": "CVE-2014-0050",
    "cwe_id": "CWE-264",
    "filename": "src/main/java/org/apache/commons/fileupload/MultipartStream.java",
    "is_vulnerable": 0,
    "class_name": "MultipartStream",
    "subclass_name": "ItemInputStream",
    "function_name": "available() throws IOException",
    "function_body": "{\n            if (pos == -1) {\n                return tail - head - pad;\n            }\n            return pos - head;\n        }"
  },
  {
    "id": 10,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 19,
    "human_patch": "https://github.com/apache/commons-fileupload/commit/c61ff05b3241cb14d989b67209e57aa71540417a",
    "cve_id": "CVE-2014-0050",
    "cwe_id": "CWE-264",
    "filename": "src/main/java/org/apache/commons/fileupload/MultipartStream.java",
    "is_vulnerable": 0,
    "class_name": "MultipartStream",
    "subclass_name": "ItemInputStream",
    "function_name": "read() throws IOException",
    "function_body": "{\n            if (closed) {\n                throw new FileItemStream.ItemSkippedException();\n            }\n            if (available() == 0 && makeAvailable() == 0) {\n                return -1;\n            }\n            ++total;\n            int b = buffer[head++];\n            if (b >= 0) {\n                return b;\n            }\n            return b + BYTE_POSITIVE_OFFSET;\n        }"
  },
  {
    "id": 10,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 20,
    "human_patch": "https://github.com/apache/commons-fileupload/commit/c61ff05b3241cb14d989b67209e57aa71540417a",
    "cve_id": "CVE-2014-0050",
    "cwe_id": "CWE-264",
    "filename": "src/main/java/org/apache/commons/fileupload/MultipartStream.java",
    "is_vulnerable": 0,
    "class_name": "MultipartStream",
    "subclass_name": "ItemInputStream",
    "function_name": "read(byte[] b, int off, int len) throws IOException",
    "function_body": "{\n            if (closed) {\n                throw new FileItemStream.ItemSkippedException();\n            }\n            if (len == 0) {\n                return 0;\n            }\n            int res = available();\n            if (res == 0) {\n                res = makeAvailable();\n                if (res == 0) {\n                    return -1;\n                }\n            }\n            res = Math.min(res, len);\n            System.arraycopy(buffer, head, b, off, res);\n            head += res;\n            total += res;\n            return res;\n        }"
  },
  {
    "id": 10,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 21,
    "human_patch": "https://github.com/apache/commons-fileupload/commit/c61ff05b3241cb14d989b67209e57aa71540417a",
    "cve_id": "CVE-2014-0050",
    "cwe_id": "CWE-264",
    "filename": "src/main/java/org/apache/commons/fileupload/MultipartStream.java",
    "is_vulnerable": 0,
    "class_name": "MultipartStream",
    "subclass_name": "ItemInputStream",
    "function_name": "close() throws IOException",
    "function_body": "{\n            close(false);\n        }"
  },
  {
    "id": 10,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 22,
    "human_patch": "https://github.com/apache/commons-fileupload/commit/c61ff05b3241cb14d989b67209e57aa71540417a",
    "cve_id": "CVE-2014-0050",
    "cwe_id": "CWE-264",
    "filename": "src/main/java/org/apache/commons/fileupload/MultipartStream.java",
    "is_vulnerable": 0,
    "class_name": "MultipartStream",
    "subclass_name": "ItemInputStream",
    "function_name": "close(boolean pCloseUnderlying) throws IOException",
    "function_body": "{\n            if (closed) {\n                return;\n            }\n            if (pCloseUnderlying) {\n                closed = true;\n                input.close();\n            } else {\n                for (;;) {\n                    int av = available();\n                    if (av == 0) {\n                        av = makeAvailable();\n                        if (av == 0) {\n                            break;\n                        }\n                    }\n                    skip(av);\n                }\n            }\n            closed = true;\n        }"
  },
  {
    "id": 10,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 23,
    "human_patch": "https://github.com/apache/commons-fileupload/commit/c61ff05b3241cb14d989b67209e57aa71540417a",
    "cve_id": "CVE-2014-0050",
    "cwe_id": "CWE-264",
    "filename": "src/main/java/org/apache/commons/fileupload/MultipartStream.java",
    "is_vulnerable": 0,
    "class_name": "MultipartStream",
    "subclass_name": "ItemInputStream",
    "function_name": "skip(long bytes) throws IOException",
    "function_body": "{\n            if (closed) {\n                throw new FileItemStream.ItemSkippedException();\n            }\n            int av = available();\n            if (av == 0) {\n                av = makeAvailable();\n                if (av == 0) {\n                    return 0;\n                }\n            }\n            long res = Math.min(av, bytes);\n            head += res;\n            return res;\n        }"
  },
  {
    "id": 10,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 24,
    "human_patch": "https://github.com/apache/commons-fileupload/commit/c61ff05b3241cb14d989b67209e57aa71540417a",
    "cve_id": "CVE-2014-0050",
    "cwe_id": "CWE-264",
    "filename": "src/main/java/org/apache/commons/fileupload/MultipartStream.java",
    "is_vulnerable": 0,
    "class_name": "MultipartStream",
    "subclass_name": "ItemInputStream",
    "function_name": "makeAvailable() throws IOException",
    "function_body": "{\n            if (pos != -1) {\n                return 0;\n            }\n\n            \n            total += tail - head - pad;\n            System.arraycopy(buffer, tail - pad, buffer, 0, pad);\n\n            \n            head = 0;\n            tail = pad;\n\n            for (;;) {\n                int bytesRead = input.read(buffer, tail, bufSize - tail);\n                if (bytesRead == -1) {\n                    \n                    \n                    \n                    final String msg = \"Stream ended unexpectedly\";\n                    throw new MalformedStreamException(msg);\n                }\n                if (notifier != null) {\n                    notifier.noteBytesRead(bytesRead);\n                }\n                tail += bytesRead;\n\n                findSeparator();\n                int av = available();\n\n                if (av > 0 || pos != -1) {\n                    return av;\n                }\n            }\n        }"
  },
  {
    "id": 10,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 25,
    "human_patch": "https://github.com/apache/commons-fileupload/commit/c61ff05b3241cb14d989b67209e57aa71540417a",
    "cve_id": "CVE-2014-0050",
    "cwe_id": "CWE-264",
    "filename": "src/main/java/org/apache/commons/fileupload/MultipartStream.java",
    "is_vulnerable": 0,
    "class_name": "MultipartStream",
    "subclass_name": "ItemInputStream",
    "function_name": "isClosed()",
    "function_body": "{\n            return closed;\n        }"
  },
  {
    "id": 10,
    "sub_id": 2,
    "code_id": 0,
    "function_id": 0,
    "human_patch": "https://github.com/apache/commons-fileupload/commit/c61ff05b3241cb14d989b67209e57aa71540417a",
    "cve_id": "CVE-2014-0050",
    "cwe_id": "CWE-264",
    "filename": "src/test/java/org/apache/commons/fileupload/MultipartStreamTest.java",
    "is_vulnerable": 1,
    "class_name": "MultipartStreamTest",
    "subclass_name": null,
    "function_name": "testThreeParamConstructor() throws Exception",
    "function_body": "{\n        final String strData = \"foobar\";\n        final byte[] contents = strData.getBytes();\n        InputStream input = new ByteArrayInputStream(contents);\n        byte[] boundary = BOUNDARY_TEXT.getBytes();\n        int iBufSize = boundary.length;\n        MultipartStream ms = new MultipartStream(\n                input,\n                boundary,\n                iBufSize,\n                new MultipartStream.ProgressNotifier(null, contents.length));\n        assertNotNull(ms);\n    }"
  },
  {
    "id": 10,
    "sub_id": 2,
    "code_id": 0,
    "function_id": 1,
    "human_patch": "https://github.com/apache/commons-fileupload/commit/c61ff05b3241cb14d989b67209e57aa71540417a",
    "cve_id": "CVE-2014-0050",
    "cwe_id": "CWE-264",
    "filename": "src/test/java/org/apache/commons/fileupload/MultipartStreamTest.java",
    "is_vulnerable": 0,
    "class_name": "MultipartStreamTest",
    "subclass_name": null,
    "function_name": "testTwoParamConstructor() throws Exception",
    "function_body": "{\n        final String strData = \"foobar\";\n        final byte[] contents = strData.getBytes();\n        InputStream input = new ByteArrayInputStream(contents);\n        byte[] boundary = BOUNDARY_TEXT.getBytes();\n        MultipartStream ms = new MultipartStream(\n                input,\n                boundary,\n                new MultipartStream.ProgressNotifier(null, contents.length));\n        assertNotNull(ms);\n    }"
  },
  {
    "id": 11,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 0,
    "human_patch": "https://github.com/apache/commons-imaging/commit/6a79d35d6654d895d0a4b73b3a9282ec9aaeeb06",
    "cve_id": "CVE-2018-17202",
    "cwe_id": "CWE-835",
    "filename": "src/main/java/org/apache/commons/imaging/formats/jpeg/decoder/JpegDecoder.java",
    "is_vulnerable": 0,
    "class_name": "JpegDecoder",
    "subclass_name": null,
    "function_name": "beginSOS()",
    "function_body": "{\n        return true;\n    }"
  },
  {
    "id": 11,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 1,
    "human_patch": "https://github.com/apache/commons-imaging/commit/6a79d35d6654d895d0a4b73b3a9282ec9aaeeb06",
    "cve_id": "CVE-2018-17202",
    "cwe_id": "CWE-835",
    "filename": "src/main/java/org/apache/commons/imaging/formats/jpeg/decoder/JpegDecoder.java",
    "is_vulnerable": 0,
    "class_name": "JpegDecoder",
    "subclass_name": null,
    "function_name": "visitSOS(final int marker, final byte[] markerBytes, final byte[] imageData)",
    "function_body": "{\n        final ByteArrayInputStream is = new ByteArrayInputStream(imageData);\n        try {\n            final int segmentLength = read2Bytes(\"segmentLength\", is, \"Not a Valid JPEG File\", getByteOrder());\n            final byte[] sosSegmentBytes = readBytes(\"SosSegment\",\n                    is, segmentLength - 2, \"Not a Valid JPEG File\");\n            sosSegment = new SosSegment(marker, sosSegmentBytes);\n\n            int hMax = 0;\n            int vMax = 0;\n            for (int i = 0; i < sofnSegment.numberOfComponents; i++) {\n                hMax = Math.max(hMax,\n                        sofnSegment.getComponents(i).horizontalSamplingFactor);\n                vMax = Math.max(vMax,\n                        sofnSegment.getComponents(i).verticalSamplingFactor);\n            }\n            final int hSize = 8 * hMax;\n            final int vSize = 8 * vMax;\n\n            final JpegInputStream bitInputStream = new JpegInputStream(is);\n            final int xMCUs = (sofnSegment.width + hSize - 1) / hSize;\n            final int yMCUs = (sofnSegment.height + vSize - 1) / vSize;\n            final Block[] mcu = allocateMCUMemory();\n            final Block[] scaledMCU = new Block[mcu.length];\n            for (int i = 0; i < scaledMCU.length; i++) {\n                scaledMCU[i] = new Block(hSize, vSize);\n            }\n            final int[] preds = new int[sofnSegment.numberOfComponents];\n            ColorModel colorModel;\n            WritableRaster raster;\n            if (sofnSegment.numberOfComponents == 3) {\n                colorModel = new DirectColorModel(24, 0x00ff0000, 0x0000ff00,\n                        0x000000ff);\n                raster = Raster.createPackedRaster(DataBuffer.TYPE_INT,\n                        sofnSegment.width, sofnSegment.height, new int[] {\n                                0x00ff0000, 0x0000ff00, 0x000000ff }, null);\n            } else if (sofnSegment.numberOfComponents == 1) {\n                colorModel = new DirectColorModel(24, 0x00ff0000, 0x0000ff00,\n                        0x000000ff);\n                raster = Raster.createPackedRaster(DataBuffer.TYPE_INT,\n                        sofnSegment.width, sofnSegment.height, new int[] {\n                                0x00ff0000, 0x0000ff00, 0x000000ff }, null);\n                \n                \n                \n                \n                \n                \n            } else {\n                throw new ImageReadException(sofnSegment.numberOfComponents\n                        + \" components are invalid or unsupported\");\n            }\n            final DataBuffer dataBuffer = raster.getDataBuffer();\n\n            for (int y1 = 0; y1 < vSize * yMCUs; y1 += vSize) {\n                for (int x1 = 0; x1 < hSize * xMCUs; x1 += hSize) {\n                    readMCU(bitInputStream, preds, mcu);\n                    rescaleMCU(mcu, hSize, vSize, scaledMCU);\n                    int srcRowOffset = 0;\n                    int dstRowOffset = y1 * sofnSegment.width + x1;\n                    for (int y2 = 0; y2 < vSize && y1 + y2 < sofnSegment.height; y2++) {\n                        for (int x2 = 0; x2 < hSize\n                                && x1 + x2 < sofnSegment.width; x2++) {\n                            if (scaledMCU.length == 3) {\n                                final int Y = scaledMCU[0].samples[srcRowOffset + x2];\n                                final int Cb = scaledMCU[1].samples[srcRowOffset + x2];\n                                final int Cr = scaledMCU[2].samples[srcRowOffset + x2];\n                                final int rgb = YCbCrConverter.convertYCbCrToRGB(Y,\n                                        Cb, Cr);\n                                dataBuffer.setElem(dstRowOffset + x2, rgb);\n                            } else if (mcu.length == 1) {\n                                final int Y = scaledMCU[0].samples[srcRowOffset + x2];\n                                dataBuffer.setElem(dstRowOffset + x2, (Y << 16)\n                                        | (Y << 8) | Y);\n                            } else {\n                                throw new ImageReadException(\n                                        \"Unsupported JPEG with \" + mcu.length\n                                                + \" components\");\n                            }\n                        }\n                        srcRowOffset += hSize;\n                        dstRowOffset += sofnSegment.width;\n                    }\n                }\n            }\n            image = new BufferedImage(colorModel, raster,\n                    colorModel.isAlphaPremultiplied(), new Properties());\n            \n            \n            \n            \n            \n            \n        } catch (final ImageReadException imageReadEx) {\n            imageReadException = imageReadEx;\n        } catch (final IOException ioEx) {\n            ioException = ioEx;\n        } catch (final RuntimeException ex) {\n            \n            imageReadException = new ImageReadException(\"Error parsing JPEG\",\n                    ex);\n        }\n    }"
  },
  {
    "id": 11,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 2,
    "human_patch": "https://github.com/apache/commons-imaging/commit/6a79d35d6654d895d0a4b73b3a9282ec9aaeeb06",
    "cve_id": "CVE-2018-17202",
    "cwe_id": "CWE-835",
    "filename": "src/main/java/org/apache/commons/imaging/formats/jpeg/decoder/JpegDecoder.java",
    "is_vulnerable": 0,
    "class_name": "JpegDecoder",
    "subclass_name": null,
    "function_name": "visitSegment(final int marker, final byte[] markerBytes,\n            final int segmentLength, final byte[] segmentLengthBytes, final byte[] segmentData) throws ImageReadException, IOException",
    "function_body": "{\n        final int[] sofnSegments = {\n                JpegConstants.SOF0_MARKER,\n                JpegConstants.SOF1_MARKER,\n                JpegConstants.SOF2_MARKER,\n                JpegConstants.SOF3_MARKER,\n                JpegConstants.SOF5_MARKER,\n                JpegConstants.SOF6_MARKER,\n                JpegConstants.SOF7_MARKER,\n                JpegConstants.SOF9_MARKER,\n                JpegConstants.SOF10_MARKER,\n                JpegConstants.SOF11_MARKER,\n                JpegConstants.SOF13_MARKER,\n                JpegConstants.SOF14_MARKER,\n                JpegConstants.SOF15_MARKER,\n        };\n\n        if (Arrays.binarySearch(sofnSegments, marker) >= 0) {\n            if (marker != JpegConstants.SOF0_MARKER) {\n                throw new ImageReadException(\"Only sequential, baseline JPEGs \"\n                        + \"are supported at the moment\");\n            }\n            sofnSegment = new SofnSegment(marker, segmentData);\n        } else if (marker == JpegConstants.DQT_MARKER) {\n            final DqtSegment dqtSegment = new DqtSegment(marker, segmentData);\n            for (int i = 0; i < dqtSegment.quantizationTables.size(); i++) {\n                final DqtSegment.QuantizationTable table = dqtSegment.quantizationTables.get(i);\n                if (0 > table.destinationIdentifier\n                        || table.destinationIdentifier >= quantizationTables.length) {\n                    throw new ImageReadException(\n                            \"Invalid quantization table identifier \"\n                                    + table.destinationIdentifier);\n                }\n                quantizationTables[table.destinationIdentifier] = table;\n                final int[] quantizationMatrixInt = new int[64];\n                ZigZag.zigZagToBlock(table.getElements(), quantizationMatrixInt);\n                final float[] quantizationMatrixFloat = new float[64];\n                for (int j = 0; j < 64; j++) {\n                    quantizationMatrixFloat[j] = quantizationMatrixInt[j];\n                }\n                Dct.scaleDequantizationMatrix(quantizationMatrixFloat);\n                scaledQuantizationTables[table.destinationIdentifier] = quantizationMatrixFloat;\n            }\n        } else if (marker == JpegConstants.DHT_MARKER) {\n            final DhtSegment dhtSegment = new DhtSegment(marker, segmentData);\n            for (int i = 0; i < dhtSegment.huffmanTables.size(); i++) {\n                final DhtSegment.HuffmanTable table = dhtSegment.huffmanTables.get(i);\n                DhtSegment.HuffmanTable[] tables;\n                if (table.tableClass == 0) {\n                    tables = huffmanDCTables;\n                } else if (table.tableClass == 1) {\n                    tables = huffmanACTables;\n                } else {\n                    throw new ImageReadException(\"Invalid huffman table class \"\n                            + table.tableClass);\n                }\n                if (0 > table.destinationIdentifier\n                        || table.destinationIdentifier >= tables.length) {\n                    throw new ImageReadException(\n                            \"Invalid huffman table identifier \"\n                                    + table.destinationIdentifier);\n                }\n                tables[table.destinationIdentifier] = table;\n            }\n        }\n        return true;\n    }"
  },
  {
    "id": 11,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 3,
    "human_patch": "https://github.com/apache/commons-imaging/commit/6a79d35d6654d895d0a4b73b3a9282ec9aaeeb06",
    "cve_id": "CVE-2018-17202",
    "cwe_id": "CWE-835",
    "filename": "src/main/java/org/apache/commons/imaging/formats/jpeg/decoder/JpegDecoder.java",
    "is_vulnerable": 0,
    "class_name": "JpegDecoder",
    "subclass_name": null,
    "function_name": "rescaleMCU(final Block[] dataUnits, final int hSize, final int vSize, final Block[] ret)",
    "function_body": "{\n        for (int i = 0; i < dataUnits.length; i++) {\n            final Block dataUnit = dataUnits[i];\n            if (dataUnit.width == hSize && dataUnit.height == vSize) {\n                System.arraycopy(dataUnit.samples, 0, ret[i].samples, 0, hSize\n                        * vSize);\n            } else {\n                final int hScale = hSize / dataUnit.width;\n                final int vScale = vSize / dataUnit.height;\n                if (hScale == 2 && vScale == 2) {\n                    int srcRowOffset = 0;\n                    int dstRowOffset = 0;\n                    for (int y = 0; y < dataUnit.height; y++) {\n                        for (int x = 0; x < hSize; x++) {\n                            final int sample = dataUnit.samples[srcRowOffset + (x >> 1)];\n                            ret[i].samples[dstRowOffset + x] = sample;\n                            ret[i].samples[dstRowOffset + hSize + x] = sample;\n                        }\n                        srcRowOffset += dataUnit.width;\n                        dstRowOffset += 2 * hSize;\n                    }\n                } else {\n                    \n                    int dstRowOffset = 0;\n                    for (int y = 0; y < vSize; y++) {\n                        for (int x = 0; x < hSize; x++) {\n                            ret[i].samples[dstRowOffset + x] = dataUnit.samples[(y / vScale)\n                                    * dataUnit.width + (x / hScale)];\n                        }\n                        dstRowOffset += hSize;\n                    }\n                }\n            }\n        }\n    }"
  },
  {
    "id": 11,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 4,
    "human_patch": "https://github.com/apache/commons-imaging/commit/6a79d35d6654d895d0a4b73b3a9282ec9aaeeb06",
    "cve_id": "CVE-2018-17202",
    "cwe_id": "CWE-835",
    "filename": "src/main/java/org/apache/commons/imaging/formats/jpeg/decoder/JpegDecoder.java",
    "is_vulnerable": 0,
    "class_name": "JpegDecoder",
    "subclass_name": null,
    "function_name": "allocateMCUMemory() throws ImageReadException",
    "function_body": "{\n        final Block[] mcu = new Block[sosSegment.numberOfComponents];\n        for (int i = 0; i < sosSegment.numberOfComponents; i++) {\n            final SosSegment.Component scanComponent = sosSegment.getComponents(i);\n            SofnSegment.Component frameComponent = null;\n            for (int j = 0; j < sofnSegment.numberOfComponents; j++) {\n                if (sofnSegment.getComponents(j).componentIdentifier == scanComponent.scanComponentSelector) {\n                    frameComponent = sofnSegment.getComponents(j);\n                    break;\n                }\n            }\n            if (frameComponent == null) {\n                throw new ImageReadException(\"Invalid component\");\n            }\n            final Block fullBlock = new Block(\n                    8 * frameComponent.horizontalSamplingFactor,\n                    8 * frameComponent.verticalSamplingFactor);\n            mcu[i] = fullBlock;\n        }\n        return mcu;\n    }"
  },
  {
    "id": 11,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 5,
    "human_patch": "https://github.com/apache/commons-imaging/commit/6a79d35d6654d895d0a4b73b3a9282ec9aaeeb06",
    "cve_id": "CVE-2018-17202",
    "cwe_id": "CWE-835",
    "filename": "src/main/java/org/apache/commons/imaging/formats/jpeg/decoder/JpegDecoder.java",
    "is_vulnerable": 0,
    "class_name": "JpegDecoder",
    "subclass_name": null,
    "function_name": "readMCU(final JpegInputStream is, final int[] preds, final Block[] mcu) throws IOException, ImageReadException",
    "function_body": "{\n        for (int i = 0; i < sosSegment.numberOfComponents; i++) {\n            final SosSegment.Component scanComponent = sosSegment.getComponents(i);\n            SofnSegment.Component frameComponent = null;\n            for (int j = 0; j < sofnSegment.numberOfComponents; j++) {\n                if (sofnSegment.getComponents(j).componentIdentifier == scanComponent.scanComponentSelector) {\n                    frameComponent = sofnSegment.getComponents(j);\n                    break;\n                }\n            }\n            if (frameComponent == null) {\n                throw new ImageReadException(\"Invalid component\");\n            }\n            final Block fullBlock = mcu[i];\n            for (int y = 0; y < frameComponent.verticalSamplingFactor; y++) {\n                for (int x = 0; x < frameComponent.horizontalSamplingFactor; x++) {\n                    Arrays.fill(zz, 0);\n                    \n                    final int t = decode(\n                            is,\n                            huffmanDCTables[scanComponent.dcCodingTableSelector]);\n                    int diff = receive(t, is);\n                    diff = extend(diff, t);\n                    zz[0] = preds[i] + diff;\n                    preds[i] = zz[0];\n\n                    \n                    int k = 1;\n                    while (true) {\n                        final int rs = decode(\n                                is,\n                                huffmanACTables[scanComponent.acCodingTableSelector]);\n                        final int ssss = rs & 0xf;\n                        final int rrrr = rs >> 4;\n                        final int r = rrrr;\n\n                        if (ssss == 0) {\n                            if (r == 15) {\n                                k += 16;\n                            } else {\n                                break;\n                            }\n                        } else {\n                            k += r;\n\n                            \n                            zz[k] = receive(ssss, is);\n                            zz[k] = extend(zz[k], ssss);\n\n                            if (k == 63) {\n                                break;\n                            } else {\n                                k++;\n                            }\n                        }\n                    }\n\n                    final int shift = (1 << (sofnSegment.precision - 1));\n                    final int max = (1 << sofnSegment.precision) - 1;\n\n                    final float[] scaledQuantizationTable = scaledQuantizationTables[frameComponent.quantTabDestSelector];\n                    ZigZag.zigZagToBlock(zz, blockInt);\n                    for (int j = 0; j < 64; j++) {\n                        block[j] = blockInt[j] * scaledQuantizationTable[j];\n                    }\n                    Dct.inverseDCT8x8(block);\n\n                    int dstRowOffset = 8 * y * 8\n                            * frameComponent.horizontalSamplingFactor + 8 * x;\n                    int srcNext = 0;\n                    for (int yy = 0; yy < 8; yy++) {\n                        for (int xx = 0; xx < 8; xx++) {\n                            float sample = block[srcNext++];\n                            sample += shift;\n                            int result;\n                            if (sample < 0) {\n                                result = 0;\n                            } else if (sample > max) {\n                                result = max;\n                            } else {\n                                result = fastRound(sample);\n                            }\n                            fullBlock.samples[dstRowOffset + xx] = result;\n                        }\n                        dstRowOffset += 8 * frameComponent.horizontalSamplingFactor;\n                    }\n                }\n            }\n        }\n    }"
  },
  {
    "id": 11,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 6,
    "human_patch": "https://github.com/apache/commons-imaging/commit/6a79d35d6654d895d0a4b73b3a9282ec9aaeeb06",
    "cve_id": "CVE-2018-17202",
    "cwe_id": "CWE-835",
    "filename": "src/main/java/org/apache/commons/imaging/formats/jpeg/decoder/JpegDecoder.java",
    "is_vulnerable": 0,
    "class_name": "JpegDecoder",
    "subclass_name": null,
    "function_name": "fastRound(final float x)",
    "function_body": "{\n        return (int) (x + 0.5f);\n    }"
  },
  {
    "id": 11,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 7,
    "human_patch": "https://github.com/apache/commons-imaging/commit/6a79d35d6654d895d0a4b73b3a9282ec9aaeeb06",
    "cve_id": "CVE-2018-17202",
    "cwe_id": "CWE-835",
    "filename": "src/main/java/org/apache/commons/imaging/formats/jpeg/decoder/JpegDecoder.java",
    "is_vulnerable": 1,
    "class_name": "JpegDecoder",
    "subclass_name": null,
    "function_name": "extend(int v, final int t)",
    "function_body": "{\n        \n        int vt = (1 << (t - 1));\n        while (v < vt) {\n            vt = (-1 << t) + 1;\n            v += vt;\n        }\n        return v;\n    }"
  },
  {
    "id": 11,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 8,
    "human_patch": "https://github.com/apache/commons-imaging/commit/6a79d35d6654d895d0a4b73b3a9282ec9aaeeb06",
    "cve_id": "CVE-2018-17202",
    "cwe_id": "CWE-835",
    "filename": "src/main/java/org/apache/commons/imaging/formats/jpeg/decoder/JpegDecoder.java",
    "is_vulnerable": 0,
    "class_name": "JpegDecoder",
    "subclass_name": null,
    "function_name": "receive(final int ssss, final JpegInputStream is) throws IOException,\n            ImageReadException",
    "function_body": "{\n        \n        int i = 0;\n        int v = 0;\n        while (i != ssss) {\n            i++;\n            v = (v << 1) + is.nextBit();\n        }\n        return v;\n    }"
  },
  {
    "id": 11,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 9,
    "human_patch": "https://github.com/apache/commons-imaging/commit/6a79d35d6654d895d0a4b73b3a9282ec9aaeeb06",
    "cve_id": "CVE-2018-17202",
    "cwe_id": "CWE-835",
    "filename": "src/main/java/org/apache/commons/imaging/formats/jpeg/decoder/JpegDecoder.java",
    "is_vulnerable": 0,
    "class_name": "JpegDecoder",
    "subclass_name": null,
    "function_name": "decode(final JpegInputStream is, final DhtSegment.HuffmanTable huffmanTable) throws IOException, ImageReadException",
    "function_body": "{\n        \n        int i = 1;\n        int code = is.nextBit();\n        while (code > huffmanTable.getMaxCode(i)) {\n            i++;\n            code = (code << 1) | is.nextBit();\n        }\n        int j = huffmanTable.getValPtr(i);\n        j += code - huffmanTable.getMinCode(i);\n        return huffmanTable.getHuffVal(j);\n    }"
  },
  {
    "id": 11,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 10,
    "human_patch": "https://github.com/apache/commons-imaging/commit/6a79d35d6654d895d0a4b73b3a9282ec9aaeeb06",
    "cve_id": "CVE-2018-17202",
    "cwe_id": "CWE-835",
    "filename": "src/main/java/org/apache/commons/imaging/formats/jpeg/decoder/JpegDecoder.java",
    "is_vulnerable": 0,
    "class_name": "JpegDecoder",
    "subclass_name": null,
    "function_name": "decode(final ByteSource byteSource) throws IOException,\n            ImageReadException",
    "function_body": "{\n        final JpegUtils jpegUtils = new JpegUtils();\n        jpegUtils.traverseJFIF(byteSource, this);\n        if (imageReadException != null) {\n            throw imageReadException;\n        }\n        if (ioException != null) {\n            throw ioException;\n        }\n        return image;\n    }"
  },
  {
    "id": 12,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 0,
    "human_patch": "https://github.com/apache/commons-imaging/commit/f5574bfe285edd79207fe8c30f53cb0af06e26bb",
    "cve_id": "CVE-2018-17201",
    "cwe_id": "CWE-835",
    "filename": "src/main/java/org/apache/commons/imaging/formats/rgbe/RgbeInfo.java",
    "is_vulnerable": 0,
    "class_name": "RgbeInfo",
    "subclass_name": null,
    "function_name": "getMetadata() throws IOException, ImageReadException",
    "function_body": "{\n        if (null == metadata) {\n            readMetadata();\n        }\n\n        return metadata;\n    }"
  },
  {
    "id": 12,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 1,
    "human_patch": "https://github.com/apache/commons-imaging/commit/f5574bfe285edd79207fe8c30f53cb0af06e26bb",
    "cve_id": "CVE-2018-17201",
    "cwe_id": "CWE-835",
    "filename": "src/main/java/org/apache/commons/imaging/formats/rgbe/RgbeInfo.java",
    "is_vulnerable": 0,
    "class_name": "RgbeInfo",
    "subclass_name": null,
    "function_name": "getWidth() throws IOException, ImageReadException",
    "function_body": "{\n        if (-1 == width) {\n            readDimensions();\n        }\n\n        return width;\n    }"
  },
  {
    "id": 12,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 2,
    "human_patch": "https://github.com/apache/commons-imaging/commit/f5574bfe285edd79207fe8c30f53cb0af06e26bb",
    "cve_id": "CVE-2018-17201",
    "cwe_id": "CWE-835",
    "filename": "src/main/java/org/apache/commons/imaging/formats/rgbe/RgbeInfo.java",
    "is_vulnerable": 0,
    "class_name": "RgbeInfo",
    "subclass_name": null,
    "function_name": "getHeight() throws IOException, ImageReadException",
    "function_body": "{\n        if (-1 == height) {\n            readDimensions();\n        }\n\n        return height;\n    }"
  },
  {
    "id": 12,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 3,
    "human_patch": "https://github.com/apache/commons-imaging/commit/f5574bfe285edd79207fe8c30f53cb0af06e26bb",
    "cve_id": "CVE-2018-17201",
    "cwe_id": "CWE-835",
    "filename": "src/main/java/org/apache/commons/imaging/formats/rgbe/RgbeInfo.java",
    "is_vulnerable": 0,
    "class_name": "RgbeInfo",
    "subclass_name": null,
    "function_name": "close() throws IOException",
    "function_body": "{\n        in.close();\n    }"
  },
  {
    "id": 12,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 4,
    "human_patch": "https://github.com/apache/commons-imaging/commit/f5574bfe285edd79207fe8c30f53cb0af06e26bb",
    "cve_id": "CVE-2018-17201",
    "cwe_id": "CWE-835",
    "filename": "src/main/java/org/apache/commons/imaging/formats/rgbe/RgbeInfo.java",
    "is_vulnerable": 0,
    "class_name": "RgbeInfo",
    "subclass_name": null,
    "function_name": "readDimensions() throws IOException, ImageReadException",
    "function_body": "{\n        getMetadata(); \n\n        final InfoHeaderReader reader = new InfoHeaderReader(in);\n        final String resolution = reader.readNextLine();\n        final Matcher matcher = RESOLUTION_STRING.matcher(resolution);\n\n        if (!matcher.matches()) {\n            throw new ImageReadException(\n                    \"Invalid HDR resolution string. Only \\\"-Y N +X M\\\" is supported. Found \\\"\"\n                            + resolution + \"\\\"\");\n        }\n\n        height = Integer.parseInt(matcher.group(1));\n        width = Integer.parseInt(matcher.group(2));\n    }"
  },
  {
    "id": 12,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 5,
    "human_patch": "https://github.com/apache/commons-imaging/commit/f5574bfe285edd79207fe8c30f53cb0af06e26bb",
    "cve_id": "CVE-2018-17201",
    "cwe_id": "CWE-835",
    "filename": "src/main/java/org/apache/commons/imaging/formats/rgbe/RgbeInfo.java",
    "is_vulnerable": 0,
    "class_name": "RgbeInfo",
    "subclass_name": null,
    "function_name": "readMetadata() throws IOException, ImageReadException",
    "function_body": "{\n        BinaryFunctions.readAndVerifyBytes(in, HEADER, \"Not a valid HDR: Incorrect Header\");\n\n        final InfoHeaderReader reader = new InfoHeaderReader(in);\n\n        if (reader.readNextLine().length() != 0) {\n            throw new ImageReadException(\"Not a valid HDR: Incorrect Header\");\n        }\n\n        metadata = new GenericImageMetadata();\n\n        String info = reader.readNextLine();\n\n        while (info.length() != 0) {\n            final int equals = info.indexOf('=');\n\n            if (equals > 0) {\n                final String variable = info.substring(0, equals);\n                final String value = info.substring(equals + 1);\n\n                if (\"FORMAT\".equals(value) && !\"32-bit_rle_rgbe\".equals(value)) {\n                    throw new ImageReadException(\"Only 32-bit_rle_rgbe images are supported, trying to read \" + value);\n                }\n\n                metadata.add(variable, value);\n            } else {\n                metadata.add(\"<command>\", info);\n            }\n\n            info = reader.readNextLine();\n        }\n    }"
  },
  {
    "id": 12,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 6,
    "human_patch": "https://github.com/apache/commons-imaging/commit/f5574bfe285edd79207fe8c30f53cb0af06e26bb",
    "cve_id": "CVE-2018-17201",
    "cwe_id": "CWE-835",
    "filename": "src/main/java/org/apache/commons/imaging/formats/rgbe/RgbeInfo.java",
    "is_vulnerable": 0,
    "class_name": "RgbeInfo",
    "subclass_name": null,
    "function_name": "getPixelData() throws IOException, ImageReadException",
    "function_body": "{\n        \n        \n        final int ht = getHeight();\n        final int wd = getWidth();\n\n        if (wd >= 32768) {\n            throw new ImageReadException(\"Scan lines must be less than 32768 bytes long\");\n        }\n\n        final byte[] scanLineBytes = ByteConversions.toBytes((short) wd,\n                ByteOrder.BIG_ENDIAN);\n        final byte[] rgbe = new byte[wd * 4];\n        final float[][] out = new float[3][wd * ht];\n\n        for (int i = 0; i < ht; i++) {\n            BinaryFunctions.readAndVerifyBytes(in, TWO_TWO, \"Scan line \" + i + \" expected to start with 0x2 0x2\");\n            BinaryFunctions.readAndVerifyBytes(in, scanLineBytes, \"Scan line \" + i + \" length expected\");\n\n            decompress(in, rgbe);\n\n            for (int channel = 0; channel < 3; channel++) {\n                final int channelOffset = channel * wd;\n                final int eOffset = 3 * wd;\n\n                for (int p = 0; p < wd; p++) {\n                    final int mantissa = rgbe[p + eOffset] & 0xff;\n                    final int pos = p + i * wd;\n\n                    if (0 == mantissa) {\n                        out[channel][pos] = 0;\n                    } else {\n                        final float mult = (float) Math.pow(2, mantissa - (128 + 8));\n                        out[channel][pos] = ((rgbe[p + channelOffset] & 0xff) + 0.5f) * mult;\n                    }\n                }\n            }\n        }\n\n        return out;\n    }"
  },
  {
    "id": 12,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 7,
    "human_patch": "https://github.com/apache/commons-imaging/commit/f5574bfe285edd79207fe8c30f53cb0af06e26bb",
    "cve_id": "CVE-2018-17201",
    "cwe_id": "CWE-835",
    "filename": "src/main/java/org/apache/commons/imaging/formats/rgbe/RgbeInfo.java",
    "is_vulnerable": 0,
    "class_name": "RgbeInfo",
    "subclass_name": null,
    "function_name": "decompress(final InputStream in, final byte[] out) throws IOException",
    "function_body": "{\n        int position = 0;\n        final int total = out.length;\n\n        while (position < total) {\n            final int n = in.read();\n\n            if (n > 128) {\n                final int value = in.read();\n\n                for (int i = 0; i < (n & 0x7f); i++) {\n                    out[position++] = (byte) value;\n                }\n            } else {\n                for (int i = 0; i < n; i++) {\n                    out[position++] = (byte) in.read();\n                }\n            }\n        }\n    }"
  },
  {
    "id": 12,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 0,
    "human_patch": "https://github.com/apache/commons-imaging/commit/f5574bfe285edd79207fe8c30f53cb0af06e26bb",
    "cve_id": "CVE-2018-17201",
    "cwe_id": "CWE-835",
    "filename": "src/test/java/org/apache/commons/imaging/formats/rgbe/RgbeReadTest.java",
    "is_vulnerable": 0,
    "class_name": "RgbeReadTest",
    "subclass_name": null,
    "function_name": "test() throws IOException, ImageReadException",
    "function_body": "{\n        Debug.debug(\"start\");\n\n        final List<File> images = getRgbeImages();\n\n        for (final File imageFile : images) {\n\n            Debug.debug(\"imageFile\", imageFile);\n\n            final ImageMetadata metadata = Imaging.getMetadata(imageFile);\n            assertNotNull(metadata);\n\n            final ImageInfo imageInfo = Imaging.getImageInfo(imageFile);\n            assertNotNull(imageInfo);\n\n            final BufferedImage image = Imaging.getBufferedImage(imageFile);\n            assertNotNull(image);\n        }\n    }"
  },
  {
    "id": 13,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 0,
    "human_patch": "https://github.com/apache/commons-io/commit/2736b6fe0b3fa22ec8e2b4184897ecadb021fc78",
    "cve_id": "CVE-2021-29425",
    "cwe_id": "CWE-20",
    "filename": "src/main/java/org/apache/commons/io/FilenameUtils.java",
    "is_vulnerable": 0,
    "class_name": "FilenameUtils",
    "subclass_name": null,
    "function_name": "isSystemWindows()",
    "function_body": "{\n        return SYSTEM_SEPARATOR == WINDOWS_SEPARATOR;\n    }"
  },
  {
    "id": 13,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 1,
    "human_patch": "https://github.com/apache/commons-io/commit/2736b6fe0b3fa22ec8e2b4184897ecadb021fc78",
    "cve_id": "CVE-2021-29425",
    "cwe_id": "CWE-20",
    "filename": "src/main/java/org/apache/commons/io/FilenameUtils.java",
    "is_vulnerable": 0,
    "class_name": "FilenameUtils",
    "subclass_name": null,
    "function_name": "isSeparator(final char ch)",
    "function_body": "{\n        return ch == UNIX_SEPARATOR || ch == WINDOWS_SEPARATOR;\n    }"
  },
  {
    "id": 13,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 2,
    "human_patch": "https://github.com/apache/commons-io/commit/2736b6fe0b3fa22ec8e2b4184897ecadb021fc78",
    "cve_id": "CVE-2021-29425",
    "cwe_id": "CWE-20",
    "filename": "src/main/java/org/apache/commons/io/FilenameUtils.java",
    "is_vulnerable": 0,
    "class_name": "FilenameUtils",
    "subclass_name": null,
    "function_name": "normalize(final String fileName)",
    "function_body": "{\n        return doNormalize(fileName, SYSTEM_SEPARATOR, true);\n    }"
  },
  {
    "id": 13,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 3,
    "human_patch": "https://github.com/apache/commons-io/commit/2736b6fe0b3fa22ec8e2b4184897ecadb021fc78",
    "cve_id": "CVE-2021-29425",
    "cwe_id": "CWE-20",
    "filename": "src/main/java/org/apache/commons/io/FilenameUtils.java",
    "is_vulnerable": 0,
    "class_name": "FilenameUtils",
    "subclass_name": null,
    "function_name": "normalize(final String fileName, final boolean unixSeparator)",
    "function_body": "{\n        final char separator = unixSeparator ? UNIX_SEPARATOR : WINDOWS_SEPARATOR;\n        return doNormalize(fileName, separator, true);\n    }"
  },
  {
    "id": 13,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 4,
    "human_patch": "https://github.com/apache/commons-io/commit/2736b6fe0b3fa22ec8e2b4184897ecadb021fc78",
    "cve_id": "CVE-2021-29425",
    "cwe_id": "CWE-20",
    "filename": "src/main/java/org/apache/commons/io/FilenameUtils.java",
    "is_vulnerable": 0,
    "class_name": "FilenameUtils",
    "subclass_name": null,
    "function_name": "normalizeNoEndSeparator(final String fileName)",
    "function_body": "{\n        return doNormalize(fileName, SYSTEM_SEPARATOR, false);\n    }"
  },
  {
    "id": 13,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 5,
    "human_patch": "https://github.com/apache/commons-io/commit/2736b6fe0b3fa22ec8e2b4184897ecadb021fc78",
    "cve_id": "CVE-2021-29425",
    "cwe_id": "CWE-20",
    "filename": "src/main/java/org/apache/commons/io/FilenameUtils.java",
    "is_vulnerable": 0,
    "class_name": "FilenameUtils",
    "subclass_name": null,
    "function_name": "normalizeNoEndSeparator(final String fileName, final boolean unixSeparator)",
    "function_body": "{\n         final char separator = unixSeparator ? UNIX_SEPARATOR : WINDOWS_SEPARATOR;\n        return doNormalize(fileName, separator, false);\n    }"
  },
  {
    "id": 13,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 6,
    "human_patch": "https://github.com/apache/commons-io/commit/2736b6fe0b3fa22ec8e2b4184897ecadb021fc78",
    "cve_id": "CVE-2021-29425",
    "cwe_id": "CWE-20",
    "filename": "src/main/java/org/apache/commons/io/FilenameUtils.java",
    "is_vulnerable": 0,
    "class_name": "FilenameUtils",
    "subclass_name": null,
    "function_name": "doNormalize(final String fileName, final char separator, final boolean keepSeparator)",
    "function_body": "{\n        if (fileName == null) {\n            return null;\n        }\n\n        failIfNullBytePresent(fileName);\n\n        int size = fileName.length();\n        if (size == 0) {\n            return fileName;\n        }\n        final int prefix = getPrefixLength(fileName);\n        if (prefix < 0) {\n            return null;\n        }\n\n        final char[] array = new char[size + 2];  \n        fileName.getChars(0, fileName.length(), array, 0);\n\n        \n        final char otherSeparator = separator == SYSTEM_SEPARATOR ? OTHER_SEPARATOR : SYSTEM_SEPARATOR;\n        for (int i = 0; i < array.length; i++) {\n            if (array[i] == otherSeparator) {\n                array[i] = separator;\n            }\n        }\n\n        \n        boolean lastIsDirectory = true;\n        if (array[size - 1] != separator) {\n            array[size++] = separator;\n            lastIsDirectory = false;\n        }\n\n        \n        for (int i = prefix + 1; i < size; i++) {\n            if (array[i] == separator && array[i - 1] == separator) {\n                System.arraycopy(array, i, array, i - 1, size - i);\n                size--;\n                i--;\n            }\n        }\n\n        \n        for (int i = prefix + 1; i < size; i++) {\n            if (array[i] == separator && array[i - 1] == '.' &&\n                    (i == prefix + 1 || array[i - 2] == separator)) {\n                if (i == size - 1) {\n                    lastIsDirectory = true;\n                }\n                System.arraycopy(array, i + 1, array, i - 1, size - i);\n                size -=2;\n                i--;\n            }\n        }\n\n        \n        outer:\n        for (int i = prefix + 2; i < size; i++) {\n            if (array[i] == separator && array[i - 1] == '.' && array[i - 2] == '.' &&\n                    (i == prefix + 2 || array[i - 3] == separator)) {\n                if (i == prefix + 2) {\n                    return null;\n                }\n                if (i == size - 1) {\n                    lastIsDirectory = true;\n                }\n                int j;\n                for (j = i - 4 ; j >= prefix; j--) {\n                    if (array[j] == separator) {\n                        \n                        System.arraycopy(array, i + 1, array, j + 1, size - i);\n                        size -= i - j;\n                        i = j + 1;\n                        continue outer;\n                    }\n                }\n                \n                System.arraycopy(array, i + 1, array, prefix, size - i);\n                size -= i + 1 - prefix;\n                i = prefix + 1;\n            }\n        }\n\n        if (size <= 0) {  \n            return EMPTY_STRING;\n        }\n        if (size <= prefix) {  \n            return new String(array, 0, size);\n        }\n        if (lastIsDirectory && keepSeparator) {\n            return new String(array, 0, size);  \n        }\n        return new String(array, 0, size - 1);  \n    }"
  },
  {
    "id": 13,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 7,
    "human_patch": "https://github.com/apache/commons-io/commit/2736b6fe0b3fa22ec8e2b4184897ecadb021fc78",
    "cve_id": "CVE-2021-29425",
    "cwe_id": "CWE-20",
    "filename": "src/main/java/org/apache/commons/io/FilenameUtils.java",
    "is_vulnerable": 0,
    "class_name": "FilenameUtils",
    "subclass_name": null,
    "function_name": "concat(final String basePath, final String fullFileNameToAdd)",
    "function_body": "{\n        final int prefix = getPrefixLength(fullFileNameToAdd);\n        if (prefix < 0) {\n            return null;\n        }\n        if (prefix > 0) {\n            return normalize(fullFileNameToAdd);\n        }\n        if (basePath == null) {\n            return null;\n        }\n        final int len = basePath.length();\n        if (len == 0) {\n            return normalize(fullFileNameToAdd);\n        }\n        final char ch = basePath.charAt(len - 1);\n        if (isSeparator(ch)) {\n            return normalize(basePath + fullFileNameToAdd);\n        }\n        return normalize(basePath + '/' + fullFileNameToAdd);\n    }"
  },
  {
    "id": 13,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 8,
    "human_patch": "https://github.com/apache/commons-io/commit/2736b6fe0b3fa22ec8e2b4184897ecadb021fc78",
    "cve_id": "CVE-2021-29425",
    "cwe_id": "CWE-20",
    "filename": "src/main/java/org/apache/commons/io/FilenameUtils.java",
    "is_vulnerable": 0,
    "class_name": "FilenameUtils",
    "subclass_name": null,
    "function_name": "directoryContains(final String canonicalParent, final String canonicalChild) throws IOException",
    "function_body": "{\n\n        \n        if (canonicalParent == null) {\n            throw new IllegalArgumentException(\"Directory must not be null\");\n        }\n\n        if (canonicalChild == null) {\n            return false;\n        }\n\n        if (IOCase.SYSTEM.checkEquals(canonicalParent, canonicalChild)) {\n            return false;\n        }\n\n        return IOCase.SYSTEM.checkStartsWith(canonicalChild, canonicalParent);\n    }"
  },
  {
    "id": 13,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 9,
    "human_patch": "https://github.com/apache/commons-io/commit/2736b6fe0b3fa22ec8e2b4184897ecadb021fc78",
    "cve_id": "CVE-2021-29425",
    "cwe_id": "CWE-20",
    "filename": "src/main/java/org/apache/commons/io/FilenameUtils.java",
    "is_vulnerable": 0,
    "class_name": "FilenameUtils",
    "subclass_name": null,
    "function_name": "separatorsToUnix(final String path)",
    "function_body": "{\n        if (path == null || path.indexOf(WINDOWS_SEPARATOR) == NOT_FOUND) {\n            return path;\n        }\n        return path.replace(WINDOWS_SEPARATOR, UNIX_SEPARATOR);\n    }"
  },
  {
    "id": 13,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 10,
    "human_patch": "https://github.com/apache/commons-io/commit/2736b6fe0b3fa22ec8e2b4184897ecadb021fc78",
    "cve_id": "CVE-2021-29425",
    "cwe_id": "CWE-20",
    "filename": "src/main/java/org/apache/commons/io/FilenameUtils.java",
    "is_vulnerable": 0,
    "class_name": "FilenameUtils",
    "subclass_name": null,
    "function_name": "separatorsToWindows(final String path)",
    "function_body": "{\n        if (path == null || path.indexOf(UNIX_SEPARATOR) == NOT_FOUND) {\n            return path;\n        }\n        return path.replace(UNIX_SEPARATOR, WINDOWS_SEPARATOR);\n    }"
  },
  {
    "id": 13,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 11,
    "human_patch": "https://github.com/apache/commons-io/commit/2736b6fe0b3fa22ec8e2b4184897ecadb021fc78",
    "cve_id": "CVE-2021-29425",
    "cwe_id": "CWE-20",
    "filename": "src/main/java/org/apache/commons/io/FilenameUtils.java",
    "is_vulnerable": 0,
    "class_name": "FilenameUtils",
    "subclass_name": null,
    "function_name": "separatorsToSystem(final String path)",
    "function_body": "{\n        if (path == null) {\n            return null;\n        }\n        return isSystemWindows() ? separatorsToWindows(path) : separatorsToUnix(path);\n    }"
  },
  {
    "id": 13,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 12,
    "human_patch": "https://github.com/apache/commons-io/commit/2736b6fe0b3fa22ec8e2b4184897ecadb021fc78",
    "cve_id": "CVE-2021-29425",
    "cwe_id": "CWE-20",
    "filename": "src/main/java/org/apache/commons/io/FilenameUtils.java",
    "is_vulnerable": 1,
    "class_name": "FilenameUtils",
    "subclass_name": null,
    "function_name": "getPrefixLength(final String fileName)",
    "function_body": "{\n        if (fileName == null) {\n            return NOT_FOUND;\n        }\n        final int len = fileName.length();\n        if (len == 0) {\n            return 0;\n        }\n        char ch0 = fileName.charAt(0);\n        if (ch0 == ':') {\n            return NOT_FOUND;\n        }\n        if (len == 1) {\n            if (ch0 == '~') {\n                return 2;  \n            }\n            return isSeparator(ch0) ? 1 : 0;\n        }\n        if (ch0 == '~') {\n            int posUnix = fileName.indexOf(UNIX_SEPARATOR, 1);\n            int posWin = fileName.indexOf(WINDOWS_SEPARATOR, 1);\n            if (posUnix == NOT_FOUND && posWin == NOT_FOUND) {\n                return len + 1;  \n            }\n            posUnix = posUnix == NOT_FOUND ? posWin : posUnix;\n            posWin = posWin == NOT_FOUND ? posUnix : posWin;\n            return Math.min(posUnix, posWin) + 1;\n        }\n        final char ch1 = fileName.charAt(1);\n        if (ch1 == ':') {\n            ch0 = Character.toUpperCase(ch0);\n            if (ch0 >= 'A' && ch0 <= 'Z') {\n                if (len == 2 || isSeparator(fileName.charAt(2)) == false) {\n                    return 2;\n                }\n                return 3;\n            } else if (ch0 == UNIX_SEPARATOR) {\n                return 1;\n            }\n            return NOT_FOUND;\n\n        } else if (isSeparator(ch0) && isSeparator(ch1)) {\n            int posUnix = fileName.indexOf(UNIX_SEPARATOR, 2);\n            int posWin = fileName.indexOf(WINDOWS_SEPARATOR, 2);\n            if (posUnix == NOT_FOUND && posWin == NOT_FOUND || posUnix == 2 || posWin == 2) {\n                return NOT_FOUND;\n            }\n            posUnix = posUnix == NOT_FOUND ? posWin : posUnix;\n            posWin = posWin == NOT_FOUND ? posUnix : posWin;\n            return Math.min(posUnix, posWin) + 1;\n        } else {\n            return isSeparator(ch0) ? 1 : 0;\n        }\n    }"
  },
  {
    "id": 13,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 13,
    "human_patch": "https://github.com/apache/commons-io/commit/2736b6fe0b3fa22ec8e2b4184897ecadb021fc78",
    "cve_id": "CVE-2021-29425",
    "cwe_id": "CWE-20",
    "filename": "src/main/java/org/apache/commons/io/FilenameUtils.java",
    "is_vulnerable": 0,
    "class_name": "FilenameUtils",
    "subclass_name": null,
    "function_name": "indexOfLastSeparator(final String fileName)",
    "function_body": "{\n        if (fileName == null) {\n            return NOT_FOUND;\n        }\n        final int lastUnixPos = fileName.lastIndexOf(UNIX_SEPARATOR);\n        final int lastWindowsPos = fileName.lastIndexOf(WINDOWS_SEPARATOR);\n        return Math.max(lastUnixPos, lastWindowsPos);\n    }"
  },
  {
    "id": 13,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 14,
    "human_patch": "https://github.com/apache/commons-io/commit/2736b6fe0b3fa22ec8e2b4184897ecadb021fc78",
    "cve_id": "CVE-2021-29425",
    "cwe_id": "CWE-20",
    "filename": "src/main/java/org/apache/commons/io/FilenameUtils.java",
    "is_vulnerable": 0,
    "class_name": "FilenameUtils",
    "subclass_name": null,
    "function_name": "indexOfExtension(final String fileName) throws IllegalArgumentException",
    "function_body": "{\n        if (fileName == null) {\n            return NOT_FOUND;\n        }\n        if (isSystemWindows()) {\n            \n            final int offset = fileName.indexOf(':', getAdsCriticalOffset(fileName));\n            if (offset != -1) {\n                throw new IllegalArgumentException(\"NTFS ADS separator (':') in file name is forbidden.\");\n            }\n        }\n        final int extensionPos = fileName.lastIndexOf(EXTENSION_SEPARATOR);\n        final int lastSeparator = indexOfLastSeparator(fileName);\n        return lastSeparator > extensionPos ? NOT_FOUND : extensionPos;\n    }"
  },
  {
    "id": 13,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 15,
    "human_patch": "https://github.com/apache/commons-io/commit/2736b6fe0b3fa22ec8e2b4184897ecadb021fc78",
    "cve_id": "CVE-2021-29425",
    "cwe_id": "CWE-20",
    "filename": "src/main/java/org/apache/commons/io/FilenameUtils.java",
    "is_vulnerable": 0,
    "class_name": "FilenameUtils",
    "subclass_name": null,
    "function_name": "getPrefix(final String fileName)",
    "function_body": "{\n        if (fileName == null) {\n            return null;\n        }\n        final int len = getPrefixLength(fileName);\n        if (len < 0) {\n            return null;\n        }\n        if (len > fileName.length()) {\n            failIfNullBytePresent(fileName + UNIX_SEPARATOR);\n            return fileName + UNIX_SEPARATOR;\n        }\n        final String path = fileName.substring(0, len);\n        failIfNullBytePresent(path);\n        return path;\n    }"
  },
  {
    "id": 13,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 16,
    "human_patch": "https://github.com/apache/commons-io/commit/2736b6fe0b3fa22ec8e2b4184897ecadb021fc78",
    "cve_id": "CVE-2021-29425",
    "cwe_id": "CWE-20",
    "filename": "src/main/java/org/apache/commons/io/FilenameUtils.java",
    "is_vulnerable": 0,
    "class_name": "FilenameUtils",
    "subclass_name": null,
    "function_name": "getPath(final String fileName)",
    "function_body": "{\n        return doGetPath(fileName, 1);\n    }"
  },
  {
    "id": 13,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 17,
    "human_patch": "https://github.com/apache/commons-io/commit/2736b6fe0b3fa22ec8e2b4184897ecadb021fc78",
    "cve_id": "CVE-2021-29425",
    "cwe_id": "CWE-20",
    "filename": "src/main/java/org/apache/commons/io/FilenameUtils.java",
    "is_vulnerable": 0,
    "class_name": "FilenameUtils",
    "subclass_name": null,
    "function_name": "getPathNoEndSeparator(final String fileName)",
    "function_body": "{\n        return doGetPath(fileName, 0);\n    }"
  },
  {
    "id": 13,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 18,
    "human_patch": "https://github.com/apache/commons-io/commit/2736b6fe0b3fa22ec8e2b4184897ecadb021fc78",
    "cve_id": "CVE-2021-29425",
    "cwe_id": "CWE-20",
    "filename": "src/main/java/org/apache/commons/io/FilenameUtils.java",
    "is_vulnerable": 0,
    "class_name": "FilenameUtils",
    "subclass_name": null,
    "function_name": "doGetPath(final String fileName, final int separatorAdd)",
    "function_body": "{\n        if (fileName == null) {\n            return null;\n        }\n        final int prefix = getPrefixLength(fileName);\n        if (prefix < 0) {\n            return null;\n        }\n        final int index = indexOfLastSeparator(fileName);\n        final int endIndex = index+separatorAdd;\n        if (prefix >= fileName.length() || index < 0 || prefix >= endIndex) {\n            return EMPTY_STRING;\n        }\n        final String path = fileName.substring(prefix, endIndex);\n        failIfNullBytePresent(path);\n        return path;\n    }"
  },
  {
    "id": 13,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 19,
    "human_patch": "https://github.com/apache/commons-io/commit/2736b6fe0b3fa22ec8e2b4184897ecadb021fc78",
    "cve_id": "CVE-2021-29425",
    "cwe_id": "CWE-20",
    "filename": "src/main/java/org/apache/commons/io/FilenameUtils.java",
    "is_vulnerable": 0,
    "class_name": "FilenameUtils",
    "subclass_name": null,
    "function_name": "getFullPath(final String fileName)",
    "function_body": "{\n        return doGetFullPath(fileName, true);\n    }"
  },
  {
    "id": 13,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 20,
    "human_patch": "https://github.com/apache/commons-io/commit/2736b6fe0b3fa22ec8e2b4184897ecadb021fc78",
    "cve_id": "CVE-2021-29425",
    "cwe_id": "CWE-20",
    "filename": "src/main/java/org/apache/commons/io/FilenameUtils.java",
    "is_vulnerable": 0,
    "class_name": "FilenameUtils",
    "subclass_name": null,
    "function_name": "getFullPathNoEndSeparator(final String fileName)",
    "function_body": "{\n        return doGetFullPath(fileName, false);\n    }"
  },
  {
    "id": 13,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 21,
    "human_patch": "https://github.com/apache/commons-io/commit/2736b6fe0b3fa22ec8e2b4184897ecadb021fc78",
    "cve_id": "CVE-2021-29425",
    "cwe_id": "CWE-20",
    "filename": "src/main/java/org/apache/commons/io/FilenameUtils.java",
    "is_vulnerable": 0,
    "class_name": "FilenameUtils",
    "subclass_name": null,
    "function_name": "doGetFullPath(final String fileName, final boolean includeSeparator)",
    "function_body": "{\n        if (fileName == null) {\n            return null;\n        }\n        final int prefix = getPrefixLength(fileName);\n        if (prefix < 0) {\n            return null;\n        }\n        if (prefix >= fileName.length()) {\n            if (includeSeparator) {\n                return getPrefix(fileName);  \n            }\n            return fileName;\n        }\n        final int index = indexOfLastSeparator(fileName);\n        if (index < 0) {\n            return fileName.substring(0, prefix);\n        }\n        int end = index + (includeSeparator ?  1 : 0);\n        if (end == 0) {\n            end++;\n        }\n        return fileName.substring(0, end);\n    }"
  },
  {
    "id": 13,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 22,
    "human_patch": "https://github.com/apache/commons-io/commit/2736b6fe0b3fa22ec8e2b4184897ecadb021fc78",
    "cve_id": "CVE-2021-29425",
    "cwe_id": "CWE-20",
    "filename": "src/main/java/org/apache/commons/io/FilenameUtils.java",
    "is_vulnerable": 0,
    "class_name": "FilenameUtils",
    "subclass_name": null,
    "function_name": "getName(final String fileName)",
    "function_body": "{\n        if (fileName == null) {\n            return null;\n        }\n        failIfNullBytePresent(fileName);\n        final int index = indexOfLastSeparator(fileName);\n        return fileName.substring(index + 1);\n    }"
  },
  {
    "id": 13,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 23,
    "human_patch": "https://github.com/apache/commons-io/commit/2736b6fe0b3fa22ec8e2b4184897ecadb021fc78",
    "cve_id": "CVE-2021-29425",
    "cwe_id": "CWE-20",
    "filename": "src/main/java/org/apache/commons/io/FilenameUtils.java",
    "is_vulnerable": 0,
    "class_name": "FilenameUtils",
    "subclass_name": null,
    "function_name": "failIfNullBytePresent(final String path)",
    "function_body": "{\n        final int len = path.length();\n        for (int i = 0; i < len; i++) {\n            if (path.charAt(i) == 0) {\n                throw new IllegalArgumentException(\"Null byte present in file/path name. There are no \" +\n                        \"known legitimate use cases for such data, but several injection attacks may use it\");\n            }\n        }\n    }"
  },
  {
    "id": 13,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 24,
    "human_patch": "https://github.com/apache/commons-io/commit/2736b6fe0b3fa22ec8e2b4184897ecadb021fc78",
    "cve_id": "CVE-2021-29425",
    "cwe_id": "CWE-20",
    "filename": "src/main/java/org/apache/commons/io/FilenameUtils.java",
    "is_vulnerable": 0,
    "class_name": "FilenameUtils",
    "subclass_name": null,
    "function_name": "getBaseName(final String fileName)",
    "function_body": "{\n        return removeExtension(getName(fileName));\n    }"
  },
  {
    "id": 13,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 25,
    "human_patch": "https://github.com/apache/commons-io/commit/2736b6fe0b3fa22ec8e2b4184897ecadb021fc78",
    "cve_id": "CVE-2021-29425",
    "cwe_id": "CWE-20",
    "filename": "src/main/java/org/apache/commons/io/FilenameUtils.java",
    "is_vulnerable": 0,
    "class_name": "FilenameUtils",
    "subclass_name": null,
    "function_name": "getExtension(final String fileName) throws IllegalArgumentException",
    "function_body": "{\n        if (fileName == null) {\n            return null;\n        }\n        final int index = indexOfExtension(fileName);\n        if (index == NOT_FOUND) {\n            return EMPTY_STRING;\n        }\n        return fileName.substring(index + 1);\n    }"
  },
  {
    "id": 13,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 26,
    "human_patch": "https://github.com/apache/commons-io/commit/2736b6fe0b3fa22ec8e2b4184897ecadb021fc78",
    "cve_id": "CVE-2021-29425",
    "cwe_id": "CWE-20",
    "filename": "src/main/java/org/apache/commons/io/FilenameUtils.java",
    "is_vulnerable": 0,
    "class_name": "FilenameUtils",
    "subclass_name": null,
    "function_name": "getAdsCriticalOffset(String fileName)",
    "function_body": "{\n        \n        int offset1 = fileName.lastIndexOf(SYSTEM_SEPARATOR);\n        int offset2 = fileName.lastIndexOf(OTHER_SEPARATOR);\n        if (offset1 == -1) {\n            if (offset2 == -1) {\n                return 0;\n            }\n            return offset2 + 1;\n        }\n        if (offset2 == -1) {\n            return offset1 + 1;\n        }\n        return Math.max(offset1, offset2) + 1;\n    }"
  },
  {
    "id": 13,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 27,
    "human_patch": "https://github.com/apache/commons-io/commit/2736b6fe0b3fa22ec8e2b4184897ecadb021fc78",
    "cve_id": "CVE-2021-29425",
    "cwe_id": "CWE-20",
    "filename": "src/main/java/org/apache/commons/io/FilenameUtils.java",
    "is_vulnerable": 0,
    "class_name": "FilenameUtils",
    "subclass_name": null,
    "function_name": "removeExtension(final String fileName)",
    "function_body": "{\n        if (fileName == null) {\n            return null;\n        }\n        failIfNullBytePresent(fileName);\n\n        final int index = indexOfExtension(fileName);\n        if (index == NOT_FOUND) {\n            return fileName;\n        }\n        return fileName.substring(0, index);\n    }"
  },
  {
    "id": 13,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 28,
    "human_patch": "https://github.com/apache/commons-io/commit/2736b6fe0b3fa22ec8e2b4184897ecadb021fc78",
    "cve_id": "CVE-2021-29425",
    "cwe_id": "CWE-20",
    "filename": "src/main/java/org/apache/commons/io/FilenameUtils.java",
    "is_vulnerable": 0,
    "class_name": "FilenameUtils",
    "subclass_name": null,
    "function_name": "equals(final String fileName1, final String fileName2)",
    "function_body": "{\n        return equals(fileName1, fileName2, false, IOCase.SENSITIVE);\n    }"
  },
  {
    "id": 13,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 29,
    "human_patch": "https://github.com/apache/commons-io/commit/2736b6fe0b3fa22ec8e2b4184897ecadb021fc78",
    "cve_id": "CVE-2021-29425",
    "cwe_id": "CWE-20",
    "filename": "src/main/java/org/apache/commons/io/FilenameUtils.java",
    "is_vulnerable": 0,
    "class_name": "FilenameUtils",
    "subclass_name": null,
    "function_name": "equalsOnSystem(final String fileName1, final String fileName2)",
    "function_body": "{\n        return equals(fileName1, fileName2, false, IOCase.SYSTEM);\n    }"
  },
  {
    "id": 13,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 30,
    "human_patch": "https://github.com/apache/commons-io/commit/2736b6fe0b3fa22ec8e2b4184897ecadb021fc78",
    "cve_id": "CVE-2021-29425",
    "cwe_id": "CWE-20",
    "filename": "src/main/java/org/apache/commons/io/FilenameUtils.java",
    "is_vulnerable": 0,
    "class_name": "FilenameUtils",
    "subclass_name": null,
    "function_name": "equalsNormalized(final String fileName1, final String fileName2)",
    "function_body": "{\n        return equals(fileName1, fileName2, true, IOCase.SENSITIVE);\n    }"
  },
  {
    "id": 13,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 31,
    "human_patch": "https://github.com/apache/commons-io/commit/2736b6fe0b3fa22ec8e2b4184897ecadb021fc78",
    "cve_id": "CVE-2021-29425",
    "cwe_id": "CWE-20",
    "filename": "src/main/java/org/apache/commons/io/FilenameUtils.java",
    "is_vulnerable": 0,
    "class_name": "FilenameUtils",
    "subclass_name": null,
    "function_name": "equalsNormalizedOnSystem(final String fileName1, final String fileName2)",
    "function_body": "{\n        return equals(fileName1, fileName2, true, IOCase.SYSTEM);\n    }"
  },
  {
    "id": 13,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 32,
    "human_patch": "https://github.com/apache/commons-io/commit/2736b6fe0b3fa22ec8e2b4184897ecadb021fc78",
    "cve_id": "CVE-2021-29425",
    "cwe_id": "CWE-20",
    "filename": "src/main/java/org/apache/commons/io/FilenameUtils.java",
    "is_vulnerable": 0,
    "class_name": "FilenameUtils",
    "subclass_name": null,
    "function_name": "equals(\n            String fileName1, String fileName2,\n            final boolean normalized, IOCase caseSensitivity)",
    "function_body": "{\n\n        if (fileName1 == null || fileName2 == null) {\n            return fileName1 == null && fileName2 == null;\n        }\n        if (normalized) {\n            fileName1 = normalize(fileName1);\n            fileName2 = normalize(fileName2);\n            if (fileName1 == null || fileName2 == null) {\n                throw new NullPointerException(\n                    \"Error normalizing one or both of the file names\");\n            }\n        }\n        if (caseSensitivity == null) {\n            caseSensitivity = IOCase.SENSITIVE;\n        }\n        return caseSensitivity.checkEquals(fileName1, fileName2);\n    }"
  },
  {
    "id": 13,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 33,
    "human_patch": "https://github.com/apache/commons-io/commit/2736b6fe0b3fa22ec8e2b4184897ecadb021fc78",
    "cve_id": "CVE-2021-29425",
    "cwe_id": "CWE-20",
    "filename": "src/main/java/org/apache/commons/io/FilenameUtils.java",
    "is_vulnerable": 0,
    "class_name": "FilenameUtils",
    "subclass_name": null,
    "function_name": "isExtension(final String fileName, final String extension)",
    "function_body": "{\n        if (fileName == null) {\n            return false;\n        }\n        failIfNullBytePresent(fileName);\n\n        if (extension == null || extension.isEmpty()) {\n            return indexOfExtension(fileName) == NOT_FOUND;\n        }\n        final String fileExt = getExtension(fileName);\n        return fileExt.equals(extension);\n    }"
  },
  {
    "id": 13,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 34,
    "human_patch": "https://github.com/apache/commons-io/commit/2736b6fe0b3fa22ec8e2b4184897ecadb021fc78",
    "cve_id": "CVE-2021-29425",
    "cwe_id": "CWE-20",
    "filename": "src/main/java/org/apache/commons/io/FilenameUtils.java",
    "is_vulnerable": 0,
    "class_name": "FilenameUtils",
    "subclass_name": null,
    "function_name": "isExtension(final String fileName, final String[] extensions)",
    "function_body": "{\n        if (fileName == null) {\n            return false;\n        }\n        failIfNullBytePresent(fileName);\n\n        if (extensions == null || extensions.length == 0) {\n            return indexOfExtension(fileName) == NOT_FOUND;\n        }\n        final String fileExt = getExtension(fileName);\n        for (final String extension : extensions) {\n            if (fileExt.equals(extension)) {\n                return true;\n            }\n        }\n        return false;\n    }"
  },
  {
    "id": 13,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 35,
    "human_patch": "https://github.com/apache/commons-io/commit/2736b6fe0b3fa22ec8e2b4184897ecadb021fc78",
    "cve_id": "CVE-2021-29425",
    "cwe_id": "CWE-20",
    "filename": "src/main/java/org/apache/commons/io/FilenameUtils.java",
    "is_vulnerable": 0,
    "class_name": "FilenameUtils",
    "subclass_name": null,
    "function_name": "isExtension(final String fileName, final Collection<String> extensions)",
    "function_body": "{\n        if (fileName == null) {\n            return false;\n        }\n        failIfNullBytePresent(fileName);\n\n        if (extensions == null || extensions.isEmpty()) {\n            return indexOfExtension(fileName) == NOT_FOUND;\n        }\n        final String fileExt = getExtension(fileName);\n        for (final String extension : extensions) {\n            if (fileExt.equals(extension)) {\n                return true;\n            }\n        }\n        return false;\n    }"
  },
  {
    "id": 13,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 36,
    "human_patch": "https://github.com/apache/commons-io/commit/2736b6fe0b3fa22ec8e2b4184897ecadb021fc78",
    "cve_id": "CVE-2021-29425",
    "cwe_id": "CWE-20",
    "filename": "src/main/java/org/apache/commons/io/FilenameUtils.java",
    "is_vulnerable": 0,
    "class_name": "FilenameUtils",
    "subclass_name": null,
    "function_name": "wildcardMatch(final String fileName, final String wildcardMatcher)",
    "function_body": "{\n        return wildcardMatch(fileName, wildcardMatcher, IOCase.SENSITIVE);\n    }"
  },
  {
    "id": 13,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 37,
    "human_patch": "https://github.com/apache/commons-io/commit/2736b6fe0b3fa22ec8e2b4184897ecadb021fc78",
    "cve_id": "CVE-2021-29425",
    "cwe_id": "CWE-20",
    "filename": "src/main/java/org/apache/commons/io/FilenameUtils.java",
    "is_vulnerable": 0,
    "class_name": "FilenameUtils",
    "subclass_name": null,
    "function_name": "wildcardMatchOnSystem(final String fileName, final String wildcardMatcher)",
    "function_body": "{\n        return wildcardMatch(fileName, wildcardMatcher, IOCase.SYSTEM);\n    }"
  },
  {
    "id": 13,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 38,
    "human_patch": "https://github.com/apache/commons-io/commit/2736b6fe0b3fa22ec8e2b4184897ecadb021fc78",
    "cve_id": "CVE-2021-29425",
    "cwe_id": "CWE-20",
    "filename": "src/main/java/org/apache/commons/io/FilenameUtils.java",
    "is_vulnerable": 0,
    "class_name": "FilenameUtils",
    "subclass_name": null,
    "function_name": "wildcardMatch(final String fileName, final String wildcardMatcher, IOCase caseSensitivity)",
    "function_body": "{\n        if (fileName == null && wildcardMatcher == null) {\n            return true;\n        }\n        if (fileName == null || wildcardMatcher == null) {\n            return false;\n        }\n        if (caseSensitivity == null) {\n            caseSensitivity = IOCase.SENSITIVE;\n        }\n        final String[] wcs = splitOnTokens(wildcardMatcher);\n        boolean anyChars = false;\n        int textIdx = 0;\n        int wcsIdx = 0;\n        final Stack<int[]> backtrack = new Stack<>();\n\n        \n        do {\n            if (backtrack.size() > 0) {\n                final int[] array = backtrack.pop();\n                wcsIdx = array[0];\n                textIdx = array[1];\n                anyChars = true;\n            }\n\n            \n            while (wcsIdx < wcs.length) {\n\n                if (wcs[wcsIdx].equals(\"?\")) {\n                    \n                    textIdx++;\n                    if (textIdx > fileName.length()) {\n                        break;\n                    }\n                    anyChars = false;\n\n                } else if (wcs[wcsIdx].equals(\"*\")) {\n                    \n                    anyChars = true;\n                    if (wcsIdx == wcs.length - 1) {\n                        textIdx = fileName.length();\n                    }\n\n                } else {\n                    \n                    if (anyChars) {\n                        \n                        textIdx = caseSensitivity.checkIndexOf(fileName, textIdx, wcs[wcsIdx]);\n                        if (textIdx == NOT_FOUND) {\n                            \n                            break;\n                        }\n                        final int repeat = caseSensitivity.checkIndexOf(fileName, textIdx + 1, wcs[wcsIdx]);\n                        if (repeat >= 0) {\n                            backtrack.push(new int[] {wcsIdx, repeat});\n                        }\n                    } else {\n                        \n                        if (!caseSensitivity.checkRegionMatches(fileName, textIdx, wcs[wcsIdx])) {\n                            \n                            break;\n                        }\n                    }\n\n                    \n                    textIdx += wcs[wcsIdx].length();\n                    anyChars = false;\n                }\n\n                wcsIdx++;\n            }\n\n            \n            if (wcsIdx == wcs.length && textIdx == fileName.length()) {\n                return true;\n            }\n\n        } while (backtrack.size() > 0);\n\n        return false;\n    }"
  },
  {
    "id": 13,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 39,
    "human_patch": "https://github.com/apache/commons-io/commit/2736b6fe0b3fa22ec8e2b4184897ecadb021fc78",
    "cve_id": "CVE-2021-29425",
    "cwe_id": "CWE-20",
    "filename": "src/main/java/org/apache/commons/io/FilenameUtils.java",
    "is_vulnerable": 0,
    "class_name": "FilenameUtils",
    "subclass_name": null,
    "function_name": "splitOnTokens(final String text)",
    "function_body": "{\n        \n        \n\n        if (text.indexOf('?') == NOT_FOUND && text.indexOf('*') == NOT_FOUND) {\n            return new String[] { text };\n        }\n\n        final char[] array = text.toCharArray();\n        final ArrayList<String> list = new ArrayList<>();\n        final StringBuilder buffer = new StringBuilder();\n        char prevChar = 0;\n        for (final char ch : array) {\n            if (ch == '?' || ch == '*') {\n                if (buffer.length() != 0) {\n                    list.add(buffer.toString());\n                    buffer.setLength(0);\n                }\n                if (ch == '?') {\n                    list.add(\"?\");\n                } else if (prevChar != '*') {\n                    list.add(\"*\");\n                }\n            } else {\n                buffer.append(ch);\n            }\n            prevChar = ch;\n        }\n        if (buffer.length() != 0) {\n            list.add(buffer.toString());\n        }\n\n        return list.toArray( new String[ list.size() ] );\n    }"
  },
  {
    "id": 13,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 0,
    "human_patch": "https://github.com/apache/commons-io/commit/2736b6fe0b3fa22ec8e2b4184897ecadb021fc78",
    "cve_id": "CVE-2021-29425",
    "cwe_id": "CWE-20",
    "filename": "src/test/java/org/apache/commons/io/FilenameUtilsTestCase.java",
    "is_vulnerable": 0,
    "class_name": "FilenameUtilsTestCase",
    "subclass_name": null,
    "function_name": "setUp() throws Exception",
    "function_body": "{\n        testFile1 = temporaryFolder.newFile(\"file1-test.txt\");\n        testFile2 = temporaryFolder.newFile(\"file1a-test.txt\");\n\n        testFile1Size = (int) testFile1.length();\n        testFile2Size = (int) testFile2.length();\n        if (!testFile1.getParentFile().exists()) {\n            throw new IOException(\"Cannot create file \" + testFile1\n                    + \" as the parent directory does not exist\");\n        }\n        try (final BufferedOutputStream output3 =\n                new BufferedOutputStream(new FileOutputStream(testFile1))) {\n            TestUtils.generateTestData(output3, testFile1Size);\n        }\n        if (!testFile2.getParentFile().exists()) {\n            throw new IOException(\"Cannot create file \" + testFile2\n                    + \" as the parent directory does not exist\");\n        }\n        try (final BufferedOutputStream output2 =\n                new BufferedOutputStream(new FileOutputStream(testFile2))) {\n            TestUtils.generateTestData(output2, testFile2Size);\n        }\n        if (!testFile1.getParentFile().exists()) {\n            throw new IOException(\"Cannot create file \" + testFile1\n                    + \" as the parent directory does not exist\");\n        }\n        try (final BufferedOutputStream output1 =\n                new BufferedOutputStream(new FileOutputStream(testFile1))) {\n            TestUtils.generateTestData(output1, testFile1Size);\n        }\n        if (!testFile2.getParentFile().exists()) {\n            throw new IOException(\"Cannot create file \" + testFile2\n                    + \" as the parent directory does not exist\");\n        }\n        try (final BufferedOutputStream output =\n                new BufferedOutputStream(new FileOutputStream(testFile2))) {\n            TestUtils.generateTestData(output, testFile2Size);\n        }\n    }"
  },
  {
    "id": 13,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 1,
    "human_patch": "https://github.com/apache/commons-io/commit/2736b6fe0b3fa22ec8e2b4184897ecadb021fc78",
    "cve_id": "CVE-2021-29425",
    "cwe_id": "CWE-20",
    "filename": "src/test/java/org/apache/commons/io/FilenameUtilsTestCase.java",
    "is_vulnerable": 1,
    "class_name": "FilenameUtilsTestCase",
    "subclass_name": null,
    "function_name": "testNormalize() throws Exception",
    "function_body": "{\n        assertEquals(null, FilenameUtils.normalize(null));\n        assertEquals(null, FilenameUtils.normalize(\":\"));\n        assertEquals(null, FilenameUtils.normalize(\"1:\\\\a\\\\b\\\\c.txt\"));\n        assertEquals(null, FilenameUtils.normalize(\"1:\"));\n        assertEquals(null, FilenameUtils.normalize(\"1:a\"));\n        assertEquals(null, FilenameUtils.normalize(\"\\\\\\\\\\\\a\\\\b\\\\c.txt\"));\n        assertEquals(null, FilenameUtils.normalize(\"\\\\\\\\a\"));\n\n        assertEquals(\"a\" + SEP + \"b\" + SEP + \"c.txt\", FilenameUtils.normalize(\"a\\\\b/c.txt\"));\n        assertEquals(\"\" + SEP + \"a\" + SEP + \"b\" + SEP + \"c.txt\", FilenameUtils.normalize(\"\\\\a\\\\b/c.txt\"));\n        assertEquals(\"C:\" + SEP + \"a\" + SEP + \"b\" + SEP + \"c.txt\", FilenameUtils.normalize(\"C:\\\\a\\\\b/c.txt\"));\n        assertEquals(\"\" + SEP + \"\" + SEP + \"server\" + SEP + \"a\" + SEP + \"b\" + SEP + \"c.txt\", FilenameUtils.normalize(\"\\\\\\\\server\\\\a\\\\b/c.txt\"));\n        assertEquals(\"~\" + SEP + \"a\" + SEP + \"b\" + SEP + \"c.txt\", FilenameUtils.normalize(\"~\\\\a\\\\b/c.txt\"));\n        assertEquals(\"~user\" + SEP + \"a\" + SEP + \"b\" + SEP + \"c.txt\", FilenameUtils.normalize(\"~user\\\\a\\\\b/c.txt\"));\n\n        assertEquals(\"a\" + SEP + \"c\", FilenameUtils.normalize(\"a/b/../c\"));\n        assertEquals(\"c\", FilenameUtils.normalize(\"a/b/../../c\"));\n        assertEquals(\"c\" + SEP, FilenameUtils.normalize(\"a/b/../../c/\"));\n        assertEquals(null, FilenameUtils.normalize(\"a/b/../../../c\"));\n        assertEquals(\"a\" + SEP, FilenameUtils.normalize(\"a/b/..\"));\n        assertEquals(\"a\" + SEP, FilenameUtils.normalize(\"a/b/../\"));\n        assertEquals(\"\", FilenameUtils.normalize(\"a/b/../..\"));\n        assertEquals(\"\", FilenameUtils.normalize(\"a/b/../../\"));\n        assertEquals(null, FilenameUtils.normalize(\"a/b/../../..\"));\n        assertEquals(\"a\" + SEP + \"d\", FilenameUtils.normalize(\"a/b/../c/../d\"));\n        assertEquals(\"a\" + SEP + \"d\" + SEP, FilenameUtils.normalize(\"a/b/../c/../d/\"));\n        assertEquals(\"a\" + SEP + \"b\" + SEP + \"d\", FilenameUtils.normalize(\"a/b//d\"));\n        assertEquals(\"a\" + SEP + \"b\" + SEP, FilenameUtils.normalize(\"a/b/././.\"));\n        assertEquals(\"a\" + SEP + \"b\" + SEP, FilenameUtils.normalize(\"a/b/./././\"));\n        assertEquals(\"a\" + SEP, FilenameUtils.normalize(\"./a/\"));\n        assertEquals(\"a\", FilenameUtils.normalize(\"./a\"));\n        assertEquals(\"\", FilenameUtils.normalize(\"./\"));\n        assertEquals(\"\", FilenameUtils.normalize(\".\"));\n        assertEquals(null, FilenameUtils.normalize(\"../a\"));\n        assertEquals(null, FilenameUtils.normalize(\"..\"));\n        assertEquals(\"\", FilenameUtils.normalize(\"\"));\n\n        assertEquals(SEP + \"a\", FilenameUtils.normalize(\"/a\"));\n        assertEquals(SEP + \"a\" + SEP, FilenameUtils.normalize(\"/a/\"));\n        assertEquals(SEP + \"a\" + SEP + \"c\", FilenameUtils.normalize(\"/a/b/../c\"));\n        assertEquals(SEP + \"c\", FilenameUtils.normalize(\"/a/b/../../c\"));\n        assertEquals(null, FilenameUtils.normalize(\"/a/b/../../../c\"));\n        assertEquals(SEP + \"a\" + SEP, FilenameUtils.normalize(\"/a/b/..\"));\n        assertEquals(SEP + \"\", FilenameUtils.normalize(\"/a/b/../..\"));\n        assertEquals(null, FilenameUtils.normalize(\"/a/b/../../..\"));\n        assertEquals(SEP + \"a\" + SEP + \"d\", FilenameUtils.normalize(\"/a/b/../c/../d\"));\n        assertEquals(SEP + \"a\" + SEP + \"b\" + SEP + \"d\", FilenameUtils.normalize(\"/a/b//d\"));\n        assertEquals(SEP + \"a\" + SEP + \"b\" + SEP, FilenameUtils.normalize(\"/a/b/././.\"));\n        assertEquals(SEP + \"a\", FilenameUtils.normalize(\"/./a\"));\n        assertEquals(SEP + \"\", FilenameUtils.normalize(\"/./\"));\n        assertEquals(SEP + \"\", FilenameUtils.normalize(\"/.\"));\n        assertEquals(null, FilenameUtils.normalize(\"/../a\"));\n        assertEquals(null, FilenameUtils.normalize(\"/..\"));\n        assertEquals(SEP + \"\", FilenameUtils.normalize(\"/\"));\n\n        assertEquals(\"~\" + SEP + \"a\", FilenameUtils.normalize(\"~/a\"));\n        assertEquals(\"~\" + SEP + \"a\" + SEP, FilenameUtils.normalize(\"~/a/\"));\n        assertEquals(\"~\" + SEP + \"a\" + SEP + \"c\", FilenameUtils.normalize(\"~/a/b/../c\"));\n        assertEquals(\"~\" + SEP + \"c\", FilenameUtils.normalize(\"~/a/b/../../c\"));\n        assertEquals(null, FilenameUtils.normalize(\"~/a/b/../../../c\"));\n        assertEquals(\"~\" + SEP + \"a\" + SEP, FilenameUtils.normalize(\"~/a/b/..\"));\n        assertEquals(\"~\" + SEP + \"\", FilenameUtils.normalize(\"~/a/b/../..\"));\n        assertEquals(null, FilenameUtils.normalize(\"~/a/b/../../..\"));\n        assertEquals(\"~\" + SEP + \"a\" + SEP + \"d\", FilenameUtils.normalize(\"~/a/b/../c/../d\"));\n        assertEquals(\"~\" + SEP + \"a\" + SEP + \"b\" + SEP + \"d\", FilenameUtils.normalize(\"~/a/b//d\"));\n        assertEquals(\"~\" + SEP + \"a\" + SEP + \"b\" + SEP, FilenameUtils.normalize(\"~/a/b/././.\"));\n        assertEquals(\"~\" + SEP + \"a\", FilenameUtils.normalize(\"~/./a\"));\n        assertEquals(\"~\" + SEP, FilenameUtils.normalize(\"~/./\"));\n        assertEquals(\"~\" + SEP, FilenameUtils.normalize(\"~/.\"));\n        assertEquals(null, FilenameUtils.normalize(\"~/../a\"));\n        assertEquals(null, FilenameUtils.normalize(\"~/..\"));\n        assertEquals(\"~\" + SEP, FilenameUtils.normalize(\"~/\"));\n        assertEquals(\"~\" + SEP, FilenameUtils.normalize(\"~\"));\n\n        assertEquals(\"~user\" + SEP + \"a\", FilenameUtils.normalize(\"~user/a\"));\n        assertEquals(\"~user\" + SEP + \"a\" + SEP, FilenameUtils.normalize(\"~user/a/\"));\n        assertEquals(\"~user\" + SEP + \"a\" + SEP + \"c\", FilenameUtils.normalize(\"~user/a/b/../c\"));\n        assertEquals(\"~user\" + SEP + \"c\", FilenameUtils.normalize(\"~user/a/b/../../c\"));\n        assertEquals(null, FilenameUtils.normalize(\"~user/a/b/../../../c\"));\n        assertEquals(\"~user\" + SEP + \"a\" + SEP, FilenameUtils.normalize(\"~user/a/b/..\"));\n        assertEquals(\"~user\" + SEP + \"\", FilenameUtils.normalize(\"~user/a/b/../..\"));\n        assertEquals(null, FilenameUtils.normalize(\"~user/a/b/../../..\"));\n        assertEquals(\"~user\" + SEP + \"a\" + SEP + \"d\", FilenameUtils.normalize(\"~user/a/b/../c/../d\"));\n        assertEquals(\"~user\" + SEP + \"a\" + SEP + \"b\" + SEP + \"d\", FilenameUtils.normalize(\"~user/a/b//d\"));\n        assertEquals(\"~user\" + SEP + \"a\" + SEP + \"b\" + SEP, FilenameUtils.normalize(\"~user/a/b/././.\"));\n        assertEquals(\"~user\" + SEP + \"a\", FilenameUtils.normalize(\"~user/./a\"));\n        assertEquals(\"~user\" + SEP + \"\", FilenameUtils.normalize(\"~user/./\"));\n        assertEquals(\"~user\" + SEP + \"\", FilenameUtils.normalize(\"~user/.\"));\n        assertEquals(null, FilenameUtils.normalize(\"~user/../a\"));\n        assertEquals(null, FilenameUtils.normalize(\"~user/..\"));\n        assertEquals(\"~user\" + SEP, FilenameUtils.normalize(\"~user/\"));\n        assertEquals(\"~user\" + SEP, FilenameUtils.normalize(\"~user\"));\n\n        assertEquals(\"C:\" + SEP + \"a\", FilenameUtils.normalize(\"C:/a\"));\n        assertEquals(\"C:\" + SEP + \"a\" + SEP, FilenameUtils.normalize(\"C:/a/\"));\n        assertEquals(\"C:\" + SEP + \"a\" + SEP + \"c\", FilenameUtils.normalize(\"C:/a/b/../c\"));\n        assertEquals(\"C:\" + SEP + \"c\", FilenameUtils.normalize(\"C:/a/b/../../c\"));\n        assertEquals(null, FilenameUtils.normalize(\"C:/a/b/../../../c\"));\n        assertEquals(\"C:\" + SEP + \"a\" + SEP, FilenameUtils.normalize(\"C:/a/b/..\"));\n        assertEquals(\"C:\" + SEP + \"\", FilenameUtils.normalize(\"C:/a/b/../..\"));\n        assertEquals(null, FilenameUtils.normalize(\"C:/a/b/../../..\"));\n        assertEquals(\"C:\" + SEP + \"a\" + SEP + \"d\", FilenameUtils.normalize(\"C:/a/b/../c/../d\"));\n        assertEquals(\"C:\" + SEP + \"a\" + SEP + \"b\" + SEP + \"d\", FilenameUtils.normalize(\"C:/a/b//d\"));\n        assertEquals(\"C:\" + SEP + \"a\" + SEP + \"b\" + SEP, FilenameUtils.normalize(\"C:/a/b/././.\"));\n        assertEquals(\"C:\" + SEP + \"a\", FilenameUtils.normalize(\"C:/./a\"));\n        assertEquals(\"C:\" + SEP + \"\", FilenameUtils.normalize(\"C:/./\"));\n        assertEquals(\"C:\" + SEP + \"\", FilenameUtils.normalize(\"C:/.\"));\n        assertEquals(null, FilenameUtils.normalize(\"C:/../a\"));\n        assertEquals(null, FilenameUtils.normalize(\"C:/..\"));\n        assertEquals(\"C:\" + SEP + \"\", FilenameUtils.normalize(\"C:/\"));\n\n        assertEquals(\"C:\" + \"a\", FilenameUtils.normalize(\"C:a\"));\n        assertEquals(\"C:\" + \"a\" + SEP, FilenameUtils.normalize(\"C:a/\"));\n        assertEquals(\"C:\" + \"a\" + SEP + \"c\", FilenameUtils.normalize(\"C:a/b/../c\"));\n        assertEquals(\"C:\" + \"c\", FilenameUtils.normalize(\"C:a/b/../../c\"));\n        assertEquals(null, FilenameUtils.normalize(\"C:a/b/../../../c\"));\n        assertEquals(\"C:\" + \"a\" + SEP, FilenameUtils.normalize(\"C:a/b/..\"));\n        assertEquals(\"C:\" + \"\", FilenameUtils.normalize(\"C:a/b/../..\"));\n        assertEquals(null, FilenameUtils.normalize(\"C:a/b/../../..\"));\n        assertEquals(\"C:\" + \"a\" + SEP + \"d\", FilenameUtils.normalize(\"C:a/b/../c/../d\"));\n        assertEquals(\"C:\" + \"a\" + SEP + \"b\" + SEP + \"d\", FilenameUtils.normalize(\"C:a/b//d\"));\n        assertEquals(\"C:\" + \"a\" + SEP + \"b\" + SEP, FilenameUtils.normalize(\"C:a/b/././.\"));\n        assertEquals(\"C:\" + \"a\", FilenameUtils.normalize(\"C:./a\"));\n        assertEquals(\"C:\" + \"\", FilenameUtils.normalize(\"C:./\"));\n        assertEquals(\"C:\" + \"\", FilenameUtils.normalize(\"C:.\"));\n        assertEquals(null, FilenameUtils.normalize(\"C:../a\"));\n        assertEquals(null, FilenameUtils.normalize(\"C:..\"));\n        assertEquals(\"C:\" + \"\", FilenameUtils.normalize(\"C:\"));\n\n        assertEquals(SEP + SEP + \"server\" + SEP + \"a\", FilenameUtils.normalize(\"//server/a\"));\n        assertEquals(SEP + SEP + \"server\" + SEP + \"a\" + SEP, FilenameUtils.normalize(\"//server/a/\"));\n        assertEquals(SEP + SEP + \"server\" + SEP + \"a\" + SEP + \"c\", FilenameUtils.normalize(\"//server/a/b/../c\"));\n        assertEquals(SEP + SEP + \"server\" + SEP + \"c\", FilenameUtils.normalize(\"//server/a/b/../../c\"));\n        assertEquals(null, FilenameUtils.normalize(\"//server/a/b/../../../c\"));\n        assertEquals(SEP + SEP + \"server\" + SEP + \"a\" + SEP, FilenameUtils.normalize(\"//server/a/b/..\"));\n        assertEquals(SEP + SEP + \"server\" + SEP + \"\", FilenameUtils.normalize(\"//server/a/b/../..\"));\n        assertEquals(null, FilenameUtils.normalize(\"//server/a/b/../../..\"));\n        assertEquals(SEP + SEP + \"server\" + SEP + \"a\" + SEP + \"d\", FilenameUtils.normalize(\"//server/a/b/../c/../d\"));\n        assertEquals(SEP + SEP + \"server\" + SEP + \"a\" + SEP + \"b\" + SEP + \"d\", FilenameUtils.normalize(\"//server/a/b//d\"));\n        assertEquals(SEP + SEP + \"server\" + SEP + \"a\" + SEP + \"b\" + SEP, FilenameUtils.normalize(\"//server/a/b/././.\"));\n        assertEquals(SEP + SEP + \"server\" + SEP + \"a\", FilenameUtils.normalize(\"//server/./a\"));\n        assertEquals(SEP + SEP + \"server\" + SEP + \"\", FilenameUtils.normalize(\"//server/./\"));\n        assertEquals(SEP + SEP + \"server\" + SEP + \"\", FilenameUtils.normalize(\"//server/.\"));\n        assertEquals(null, FilenameUtils.normalize(\"//server/../a\"));\n        assertEquals(null, FilenameUtils.normalize(\"//server/..\"));\n        assertEquals(SEP + SEP + \"server\" + SEP + \"\", FilenameUtils.normalize(\"//server/\"));\n    }"
  },
  {
    "id": 13,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 2,
    "human_patch": "https://github.com/apache/commons-io/commit/2736b6fe0b3fa22ec8e2b4184897ecadb021fc78",
    "cve_id": "CVE-2021-29425",
    "cwe_id": "CWE-20",
    "filename": "src/test/java/org/apache/commons/io/FilenameUtilsTestCase.java",
    "is_vulnerable": 0,
    "class_name": "FilenameUtilsTestCase",
    "subclass_name": null,
    "function_name": "testNormalize_with_nullbytes() throws Exception",
    "function_body": "{\n        try {\n            assertEquals(\"a\" + SEP + \"b\" + SEP + \"c.txt\", FilenameUtils.normalize(\"a\\\\b/c\\u0000.txt\"));\n        } catch (final IllegalArgumentException ignore) {\n        }\n\n        try {\n            assertEquals(\"a\" + SEP + \"b\" + SEP + \"c.txt\", FilenameUtils.normalize(\"\\u0000a\\\\b/c.txt\"));\n        } catch (final IllegalArgumentException ignore) {\n        }\n    }"
  },
  {
    "id": 13,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 3,
    "human_patch": "https://github.com/apache/commons-io/commit/2736b6fe0b3fa22ec8e2b4184897ecadb021fc78",
    "cve_id": "CVE-2021-29425",
    "cwe_id": "CWE-20",
    "filename": "src/test/java/org/apache/commons/io/FilenameUtilsTestCase.java",
    "is_vulnerable": 0,
    "class_name": "FilenameUtilsTestCase",
    "subclass_name": null,
    "function_name": "testNormalizeUnixWin() throws Exception",
    "function_body": "{\n\n        \n        assertEquals(\"/a/c/\", FilenameUtils.normalize(\"/a/b/../c/\", true));\n        assertEquals(\"/a/c/\", FilenameUtils.normalize(\"\\\\a\\\\b\\\\..\\\\c\\\\\", true));\n\n        \n        assertEquals(\"\\\\a\\\\c\\\\\", FilenameUtils.normalize(\"/a/b/../c/\", false));\n        assertEquals(\"\\\\a\\\\c\\\\\", FilenameUtils.normalize(\"\\\\a\\\\b\\\\..\\\\c\\\\\", false));\n    }"
  },
  {
    "id": 13,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 4,
    "human_patch": "https://github.com/apache/commons-io/commit/2736b6fe0b3fa22ec8e2b4184897ecadb021fc78",
    "cve_id": "CVE-2021-29425",
    "cwe_id": "CWE-20",
    "filename": "src/test/java/org/apache/commons/io/FilenameUtilsTestCase.java",
    "is_vulnerable": 0,
    "class_name": "FilenameUtilsTestCase",
    "subclass_name": null,
    "function_name": "testNormalizeNoEndSeparator() throws Exception",
    "function_body": "{\n        assertEquals(null, FilenameUtils.normalizeNoEndSeparator(null));\n        assertEquals(null, FilenameUtils.normalizeNoEndSeparator(\":\"));\n        assertEquals(null, FilenameUtils.normalizeNoEndSeparator(\"1:\\\\a\\\\b\\\\c.txt\"));\n        assertEquals(null, FilenameUtils.normalizeNoEndSeparator(\"1:\"));\n        assertEquals(null, FilenameUtils.normalizeNoEndSeparator(\"1:a\"));\n        assertEquals(null, FilenameUtils.normalizeNoEndSeparator(\"\\\\\\\\\\\\a\\\\b\\\\c.txt\"));\n        assertEquals(null, FilenameUtils.normalizeNoEndSeparator(\"\\\\\\\\a\"));\n\n        assertEquals(\"a\" + SEP + \"b\" + SEP + \"c.txt\", FilenameUtils.normalizeNoEndSeparator(\"a\\\\b/c.txt\"));\n        assertEquals(\"\" + SEP + \"a\" + SEP + \"b\" + SEP + \"c.txt\", FilenameUtils.normalizeNoEndSeparator(\"\\\\a\\\\b/c.txt\"));\n        assertEquals(\"C:\" + SEP + \"a\" + SEP + \"b\" + SEP + \"c.txt\", FilenameUtils.normalizeNoEndSeparator(\"C:\\\\a\\\\b/c.txt\"));\n        assertEquals(\"\" + SEP + \"\" + SEP + \"server\" + SEP + \"a\" + SEP + \"b\" + SEP + \"c.txt\", FilenameUtils.normalizeNoEndSeparator(\"\\\\\\\\server\\\\a\\\\b/c.txt\"));\n        assertEquals(\"~\" + SEP + \"a\" + SEP + \"b\" + SEP + \"c.txt\", FilenameUtils.normalizeNoEndSeparator(\"~\\\\a\\\\b/c.txt\"));\n        assertEquals(\"~user\" + SEP + \"a\" + SEP + \"b\" + SEP + \"c.txt\", FilenameUtils.normalizeNoEndSeparator(\"~user\\\\a\\\\b/c.txt\"));\n\n        assertEquals(\"a\" + SEP + \"c\", FilenameUtils.normalizeNoEndSeparator(\"a/b/../c\"));\n        assertEquals(\"c\", FilenameUtils.normalizeNoEndSeparator(\"a/b/../../c\"));\n        assertEquals(\"c\", FilenameUtils.normalizeNoEndSeparator(\"a/b/../../c/\"));\n        assertEquals(null, FilenameUtils.normalizeNoEndSeparator(\"a/b/../../../c\"));\n        assertEquals(\"a\", FilenameUtils.normalizeNoEndSeparator(\"a/b/..\"));\n        assertEquals(\"a\", FilenameUtils.normalizeNoEndSeparator(\"a/b/../\"));\n        assertEquals(\"\", FilenameUtils.normalizeNoEndSeparator(\"a/b/../..\"));\n        assertEquals(\"\", FilenameUtils.normalizeNoEndSeparator(\"a/b/../../\"));\n        assertEquals(null, FilenameUtils.normalizeNoEndSeparator(\"a/b/../../..\"));\n        assertEquals(\"a\" + SEP + \"d\", FilenameUtils.normalizeNoEndSeparator(\"a/b/../c/../d\"));\n        assertEquals(\"a\" + SEP + \"d\", FilenameUtils.normalizeNoEndSeparator(\"a/b/../c/../d/\"));\n        assertEquals(\"a\" + SEP + \"b\" + SEP + \"d\", FilenameUtils.normalizeNoEndSeparator(\"a/b//d\"));\n        assertEquals(\"a\" + SEP + \"b\", FilenameUtils.normalizeNoEndSeparator(\"a/b/././.\"));\n        assertEquals(\"a\" + SEP + \"b\", FilenameUtils.normalizeNoEndSeparator(\"a/b/./././\"));\n        assertEquals(\"a\", FilenameUtils.normalizeNoEndSeparator(\"./a/\"));\n        assertEquals(\"a\", FilenameUtils.normalizeNoEndSeparator(\"./a\"));\n        assertEquals(\"\", FilenameUtils.normalizeNoEndSeparator(\"./\"));\n        assertEquals(\"\", FilenameUtils.normalizeNoEndSeparator(\".\"));\n        assertEquals(null, FilenameUtils.normalizeNoEndSeparator(\"../a\"));\n        assertEquals(null, FilenameUtils.normalizeNoEndSeparator(\"..\"));\n        assertEquals(\"\", FilenameUtils.normalizeNoEndSeparator(\"\"));\n\n        assertEquals(SEP + \"a\", FilenameUtils.normalizeNoEndSeparator(\"/a\"));\n        assertEquals(SEP + \"a\", FilenameUtils.normalizeNoEndSeparator(\"/a/\"));\n        assertEquals(SEP + \"a\" + SEP + \"c\", FilenameUtils.normalizeNoEndSeparator(\"/a/b/../c\"));\n        assertEquals(SEP + \"c\", FilenameUtils.normalizeNoEndSeparator(\"/a/b/../../c\"));\n        assertEquals(null, FilenameUtils.normalizeNoEndSeparator(\"/a/b/../../../c\"));\n        assertEquals(SEP + \"a\", FilenameUtils.normalizeNoEndSeparator(\"/a/b/..\"));\n        assertEquals(SEP + \"\", FilenameUtils.normalizeNoEndSeparator(\"/a/b/../..\"));\n        assertEquals(null, FilenameUtils.normalizeNoEndSeparator(\"/a/b/../../..\"));\n        assertEquals(SEP + \"a\" + SEP + \"d\", FilenameUtils.normalizeNoEndSeparator(\"/a/b/../c/../d\"));\n        assertEquals(SEP + \"a\" + SEP + \"b\" + SEP + \"d\", FilenameUtils.normalizeNoEndSeparator(\"/a/b//d\"));\n        assertEquals(SEP + \"a\" + SEP + \"b\", FilenameUtils.normalizeNoEndSeparator(\"/a/b/././.\"));\n        assertEquals(SEP + \"a\", FilenameUtils.normalizeNoEndSeparator(\"/./a\"));\n        assertEquals(SEP + \"\", FilenameUtils.normalizeNoEndSeparator(\"/./\"));\n        assertEquals(SEP + \"\", FilenameUtils.normalizeNoEndSeparator(\"/.\"));\n        assertEquals(null, FilenameUtils.normalizeNoEndSeparator(\"/../a\"));\n        assertEquals(null, FilenameUtils.normalizeNoEndSeparator(\"/..\"));\n        assertEquals(SEP + \"\", FilenameUtils.normalizeNoEndSeparator(\"/\"));\n\n        assertEquals(\"~\" + SEP + \"a\", FilenameUtils.normalizeNoEndSeparator(\"~/a\"));\n        assertEquals(\"~\" + SEP + \"a\", FilenameUtils.normalizeNoEndSeparator(\"~/a/\"));\n        assertEquals(\"~\" + SEP + \"a\" + SEP + \"c\", FilenameUtils.normalizeNoEndSeparator(\"~/a/b/../c\"));\n        assertEquals(\"~\" + SEP + \"c\", FilenameUtils.normalizeNoEndSeparator(\"~/a/b/../../c\"));\n        assertEquals(null, FilenameUtils.normalizeNoEndSeparator(\"~/a/b/../../../c\"));\n        assertEquals(\"~\" + SEP + \"a\", FilenameUtils.normalizeNoEndSeparator(\"~/a/b/..\"));\n        assertEquals(\"~\" + SEP + \"\", FilenameUtils.normalizeNoEndSeparator(\"~/a/b/../..\"));\n        assertEquals(null, FilenameUtils.normalizeNoEndSeparator(\"~/a/b/../../..\"));\n        assertEquals(\"~\" + SEP + \"a\" + SEP + \"d\", FilenameUtils.normalizeNoEndSeparator(\"~/a/b/../c/../d\"));\n        assertEquals(\"~\" + SEP + \"a\" + SEP + \"b\" + SEP + \"d\", FilenameUtils.normalizeNoEndSeparator(\"~/a/b//d\"));\n        assertEquals(\"~\" + SEP + \"a\" + SEP + \"b\", FilenameUtils.normalizeNoEndSeparator(\"~/a/b/././.\"));\n        assertEquals(\"~\" + SEP + \"a\", FilenameUtils.normalizeNoEndSeparator(\"~/./a\"));\n        assertEquals(\"~\" + SEP, FilenameUtils.normalizeNoEndSeparator(\"~/./\"));\n        assertEquals(\"~\" + SEP, FilenameUtils.normalizeNoEndSeparator(\"~/.\"));\n        assertEquals(null, FilenameUtils.normalizeNoEndSeparator(\"~/../a\"));\n        assertEquals(null, FilenameUtils.normalizeNoEndSeparator(\"~/..\"));\n        assertEquals(\"~\" + SEP, FilenameUtils.normalizeNoEndSeparator(\"~/\"));\n        assertEquals(\"~\" + SEP, FilenameUtils.normalizeNoEndSeparator(\"~\"));\n\n        assertEquals(\"~user\" + SEP + \"a\", FilenameUtils.normalizeNoEndSeparator(\"~user/a\"));\n        assertEquals(\"~user\" + SEP + \"a\", FilenameUtils.normalizeNoEndSeparator(\"~user/a/\"));\n        assertEquals(\"~user\" + SEP + \"a\" + SEP + \"c\", FilenameUtils.normalizeNoEndSeparator(\"~user/a/b/../c\"));\n        assertEquals(\"~user\" + SEP + \"c\", FilenameUtils.normalizeNoEndSeparator(\"~user/a/b/../../c\"));\n        assertEquals(null, FilenameUtils.normalizeNoEndSeparator(\"~user/a/b/../../../c\"));\n        assertEquals(\"~user\" + SEP + \"a\", FilenameUtils.normalizeNoEndSeparator(\"~user/a/b/..\"));\n        assertEquals(\"~user\" + SEP + \"\", FilenameUtils.normalizeNoEndSeparator(\"~user/a/b/../..\"));\n        assertEquals(null, FilenameUtils.normalizeNoEndSeparator(\"~user/a/b/../../..\"));\n        assertEquals(\"~user\" + SEP + \"a\" + SEP + \"d\", FilenameUtils.normalizeNoEndSeparator(\"~user/a/b/../c/../d\"));\n        assertEquals(\"~user\" + SEP + \"a\" + SEP + \"b\" + SEP + \"d\", FilenameUtils.normalizeNoEndSeparator(\"~user/a/b//d\"));\n        assertEquals(\"~user\" + SEP + \"a\" + SEP + \"b\", FilenameUtils.normalizeNoEndSeparator(\"~user/a/b/././.\"));\n        assertEquals(\"~user\" + SEP + \"a\", FilenameUtils.normalizeNoEndSeparator(\"~user/./a\"));\n        assertEquals(\"~user\" + SEP + \"\", FilenameUtils.normalizeNoEndSeparator(\"~user/./\"));\n        assertEquals(\"~user\" + SEP + \"\", FilenameUtils.normalizeNoEndSeparator(\"~user/.\"));\n        assertEquals(null, FilenameUtils.normalizeNoEndSeparator(\"~user/../a\"));\n        assertEquals(null, FilenameUtils.normalizeNoEndSeparator(\"~user/..\"));\n        assertEquals(\"~user\" + SEP, FilenameUtils.normalizeNoEndSeparator(\"~user/\"));\n        assertEquals(\"~user\" + SEP, FilenameUtils.normalizeNoEndSeparator(\"~user\"));\n\n        assertEquals(\"C:\" + SEP + \"a\", FilenameUtils.normalizeNoEndSeparator(\"C:/a\"));\n        assertEquals(\"C:\" + SEP + \"a\", FilenameUtils.normalizeNoEndSeparator(\"C:/a/\"));\n        assertEquals(\"C:\" + SEP + \"a\" + SEP + \"c\", FilenameUtils.normalizeNoEndSeparator(\"C:/a/b/../c\"));\n        assertEquals(\"C:\" + SEP + \"c\", FilenameUtils.normalizeNoEndSeparator(\"C:/a/b/../../c\"));\n        assertEquals(null, FilenameUtils.normalizeNoEndSeparator(\"C:/a/b/../../../c\"));\n        assertEquals(\"C:\" + SEP + \"a\", FilenameUtils.normalizeNoEndSeparator(\"C:/a/b/..\"));\n        assertEquals(\"C:\" + SEP + \"\", FilenameUtils.normalizeNoEndSeparator(\"C:/a/b/../..\"));\n        assertEquals(null, FilenameUtils.normalizeNoEndSeparator(\"C:/a/b/../../..\"));\n        assertEquals(\"C:\" + SEP + \"a\" + SEP + \"d\", FilenameUtils.normalizeNoEndSeparator(\"C:/a/b/../c/../d\"));\n        assertEquals(\"C:\" + SEP + \"a\" + SEP + \"b\" + SEP + \"d\", FilenameUtils.normalizeNoEndSeparator(\"C:/a/b//d\"));\n        assertEquals(\"C:\" + SEP + \"a\" + SEP + \"b\", FilenameUtils.normalizeNoEndSeparator(\"C:/a/b/././.\"));\n        assertEquals(\"C:\" + SEP + \"a\", FilenameUtils.normalizeNoEndSeparator(\"C:/./a\"));\n        assertEquals(\"C:\" + SEP + \"\", FilenameUtils.normalizeNoEndSeparator(\"C:/./\"));\n        assertEquals(\"C:\" + SEP + \"\", FilenameUtils.normalizeNoEndSeparator(\"C:/.\"));\n        assertEquals(null, FilenameUtils.normalizeNoEndSeparator(\"C:/../a\"));\n        assertEquals(null, FilenameUtils.normalizeNoEndSeparator(\"C:/..\"));\n        assertEquals(\"C:\" + SEP + \"\", FilenameUtils.normalizeNoEndSeparator(\"C:/\"));\n\n        assertEquals(\"C:\" + \"a\", FilenameUtils.normalizeNoEndSeparator(\"C:a\"));\n        assertEquals(\"C:\" + \"a\", FilenameUtils.normalizeNoEndSeparator(\"C:a/\"));\n        assertEquals(\"C:\" + \"a\" + SEP + \"c\", FilenameUtils.normalizeNoEndSeparator(\"C:a/b/../c\"));\n        assertEquals(\"C:\" + \"c\", FilenameUtils.normalizeNoEndSeparator(\"C:a/b/../../c\"));\n        assertEquals(null, FilenameUtils.normalizeNoEndSeparator(\"C:a/b/../../../c\"));\n        assertEquals(\"C:\" + \"a\", FilenameUtils.normalizeNoEndSeparator(\"C:a/b/..\"));\n        assertEquals(\"C:\" + \"\", FilenameUtils.normalizeNoEndSeparator(\"C:a/b/../..\"));\n        assertEquals(null, FilenameUtils.normalizeNoEndSeparator(\"C:a/b/../../..\"));\n        assertEquals(\"C:\" + \"a\" + SEP + \"d\", FilenameUtils.normalizeNoEndSeparator(\"C:a/b/../c/../d\"));\n        assertEquals(\"C:\" + \"a\" + SEP + \"b\" + SEP + \"d\", FilenameUtils.normalizeNoEndSeparator(\"C:a/b//d\"));\n        assertEquals(\"C:\" + \"a\" + SEP + \"b\", FilenameUtils.normalizeNoEndSeparator(\"C:a/b/././.\"));\n        assertEquals(\"C:\" + \"a\", FilenameUtils.normalizeNoEndSeparator(\"C:./a\"));\n        assertEquals(\"C:\" + \"\", FilenameUtils.normalizeNoEndSeparator(\"C:./\"));\n        assertEquals(\"C:\" + \"\", FilenameUtils.normalizeNoEndSeparator(\"C:.\"));\n        assertEquals(null, FilenameUtils.normalizeNoEndSeparator(\"C:../a\"));\n        assertEquals(null, FilenameUtils.normalizeNoEndSeparator(\"C:..\"));\n        assertEquals(\"C:\" + \"\", FilenameUtils.normalizeNoEndSeparator(\"C:\"));\n\n        assertEquals(SEP + SEP + \"server\" + SEP + \"a\", FilenameUtils.normalizeNoEndSeparator(\"//server/a\"));\n        assertEquals(SEP + SEP + \"server\" + SEP + \"a\", FilenameUtils.normalizeNoEndSeparator(\"//server/a/\"));\n        assertEquals(SEP + SEP + \"server\" + SEP + \"a\" + SEP + \"c\", FilenameUtils.normalizeNoEndSeparator(\"//server/a/b/../c\"));\n        assertEquals(SEP + SEP + \"server\" + SEP + \"c\", FilenameUtils.normalizeNoEndSeparator(\"//server/a/b/../../c\"));\n        assertEquals(null, FilenameUtils.normalizeNoEndSeparator(\"//server/a/b/../../../c\"));\n        assertEquals(SEP + SEP + \"server\" + SEP + \"a\", FilenameUtils.normalizeNoEndSeparator(\"//server/a/b/..\"));\n        assertEquals(SEP + SEP + \"server\" + SEP + \"\", FilenameUtils.normalizeNoEndSeparator(\"//server/a/b/../..\"));\n        assertEquals(null, FilenameUtils.normalizeNoEndSeparator(\"//server/a/b/../../..\"));\n        assertEquals(SEP + SEP + \"server\" + SEP + \"a\" + SEP + \"d\", FilenameUtils.normalizeNoEndSeparator(\"//server/a/b/../c/../d\"));\n        assertEquals(SEP + SEP + \"server\" + SEP + \"a\" + SEP + \"b\" + SEP + \"d\", FilenameUtils.normalizeNoEndSeparator(\"//server/a/b//d\"));\n        assertEquals(SEP + SEP + \"server\" + SEP + \"a\" + SEP + \"b\", FilenameUtils.normalizeNoEndSeparator(\"//server/a/b/././.\"));\n        assertEquals(SEP + SEP + \"server\" + SEP + \"a\", FilenameUtils.normalizeNoEndSeparator(\"//server/./a\"));\n        assertEquals(SEP + SEP + \"server\" + SEP + \"\", FilenameUtils.normalizeNoEndSeparator(\"//server/./\"));\n        assertEquals(SEP + SEP + \"server\" + SEP + \"\", FilenameUtils.normalizeNoEndSeparator(\"//server/.\"));\n        assertEquals(null, FilenameUtils.normalizeNoEndSeparator(\"//server/../a\"));\n        assertEquals(null, FilenameUtils.normalizeNoEndSeparator(\"//server/..\"));\n        assertEquals(SEP + SEP + \"server\" + SEP + \"\", FilenameUtils.normalizeNoEndSeparator(\"//server/\"));\n    }"
  },
  {
    "id": 13,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 5,
    "human_patch": "https://github.com/apache/commons-io/commit/2736b6fe0b3fa22ec8e2b4184897ecadb021fc78",
    "cve_id": "CVE-2021-29425",
    "cwe_id": "CWE-20",
    "filename": "src/test/java/org/apache/commons/io/FilenameUtilsTestCase.java",
    "is_vulnerable": 0,
    "class_name": "FilenameUtilsTestCase",
    "subclass_name": null,
    "function_name": "testNormalizeNoEndSeparatorUnixWin() throws Exception",
    "function_body": "{\n\n        \n        assertEquals(\"/a/c\", FilenameUtils.normalizeNoEndSeparator(\"/a/b/../c/\", true));\n        assertEquals(\"/a/c\", FilenameUtils.normalizeNoEndSeparator(\"\\\\a\\\\b\\\\..\\\\c\\\\\", true));\n\n        \n        assertEquals(\"\\\\a\\\\c\", FilenameUtils.normalizeNoEndSeparator(\"/a/b/../c/\", false));\n        assertEquals(\"\\\\a\\\\c\", FilenameUtils.normalizeNoEndSeparator(\"\\\\a\\\\b\\\\..\\\\c\\\\\", false));\n    }"
  },
  {
    "id": 13,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 6,
    "human_patch": "https://github.com/apache/commons-io/commit/2736b6fe0b3fa22ec8e2b4184897ecadb021fc78",
    "cve_id": "CVE-2021-29425",
    "cwe_id": "CWE-20",
    "filename": "src/test/java/org/apache/commons/io/FilenameUtilsTestCase.java",
    "is_vulnerable": 0,
    "class_name": "FilenameUtilsTestCase",
    "subclass_name": null,
    "function_name": "testConcat()",
    "function_body": "{\n        assertEquals(null, FilenameUtils.concat(\"\", null));\n        assertEquals(null, FilenameUtils.concat(null, null));\n        assertEquals(null, FilenameUtils.concat(null, \"\"));\n        assertEquals(null, FilenameUtils.concat(null, \"a\"));\n        assertEquals(SEP + \"a\", FilenameUtils.concat(null, \"/a\"));\n\n        assertEquals(null, FilenameUtils.concat(\"\", \":\")); \n        assertEquals(null, FilenameUtils.concat(\":\", \"\")); \n\n        assertEquals(\"f\" + SEP, FilenameUtils.concat(\"\", \"f/\"));\n        assertEquals(\"f\", FilenameUtils.concat(\"\", \"f\"));\n        assertEquals(\"a\" + SEP + \"f\" + SEP, FilenameUtils.concat(\"a/\", \"f/\"));\n        assertEquals(\"a\" + SEP + \"f\", FilenameUtils.concat(\"a\", \"f\"));\n        assertEquals(\"a\" + SEP + \"b\" + SEP + \"f\" + SEP, FilenameUtils.concat(\"a/b/\", \"f/\"));\n        assertEquals(\"a\" + SEP + \"b\" + SEP + \"f\", FilenameUtils.concat(\"a/b\", \"f\"));\n\n        assertEquals(\"a\" + SEP + \"f\" + SEP, FilenameUtils.concat(\"a/b/\", \"../f/\"));\n        assertEquals(\"a\" + SEP + \"f\", FilenameUtils.concat(\"a/b\", \"../f\"));\n        assertEquals(\"a\" + SEP + \"c\" + SEP + \"g\" + SEP, FilenameUtils.concat(\"a/b/../c/\", \"f/../g/\"));\n        assertEquals(\"a\" + SEP + \"c\" + SEP + \"g\", FilenameUtils.concat(\"a/b/../c\", \"f/../g\"));\n\n        assertEquals(\"a\" + SEP + \"c.txt\" + SEP + \"f\", FilenameUtils.concat(\"a/c.txt\", \"f\"));\n\n        assertEquals(SEP + \"f\" + SEP, FilenameUtils.concat(\"\", \"/f/\"));\n        assertEquals(SEP + \"f\", FilenameUtils.concat(\"\", \"/f\"));\n        assertEquals(SEP + \"f\" + SEP, FilenameUtils.concat(\"a/\", \"/f/\"));\n        assertEquals(SEP + \"f\", FilenameUtils.concat(\"a\", \"/f\"));\n\n        assertEquals(SEP + \"c\" + SEP + \"d\", FilenameUtils.concat(\"a/b/\", \"/c/d\"));\n        assertEquals(\"C:c\" + SEP + \"d\", FilenameUtils.concat(\"a/b/\", \"C:c/d\"));\n        assertEquals(\"C:\" + SEP + \"c\" + SEP + \"d\", FilenameUtils.concat(\"a/b/\", \"C:/c/d\"));\n        assertEquals(\"~\" + SEP + \"c\" + SEP + \"d\", FilenameUtils.concat(\"a/b/\", \"~/c/d\"));\n        assertEquals(\"~user\" + SEP + \"c\" + SEP + \"d\", FilenameUtils.concat(\"a/b/\", \"~user/c/d\"));\n        assertEquals(\"~\" + SEP, FilenameUtils.concat(\"a/b/\", \"~\"));\n        assertEquals(\"~user\" + SEP, FilenameUtils.concat(\"a/b/\", \"~user\"));\n    }"
  },
  {
    "id": 13,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 7,
    "human_patch": "https://github.com/apache/commons-io/commit/2736b6fe0b3fa22ec8e2b4184897ecadb021fc78",
    "cve_id": "CVE-2021-29425",
    "cwe_id": "CWE-20",
    "filename": "src/test/java/org/apache/commons/io/FilenameUtilsTestCase.java",
    "is_vulnerable": 0,
    "class_name": "FilenameUtilsTestCase",
    "subclass_name": null,
    "function_name": "testSeparatorsToUnix()",
    "function_body": "{\n        assertEquals(null, FilenameUtils.separatorsToUnix(null));\n        assertEquals(\"/a/b/c\", FilenameUtils.separatorsToUnix(\"/a/b/c\"));\n        assertEquals(\"/a/b/c.txt\", FilenameUtils.separatorsToUnix(\"/a/b/c.txt\"));\n        assertEquals(\"/a/b/c\", FilenameUtils.separatorsToUnix(\"/a/b\\\\c\"));\n        assertEquals(\"/a/b/c\", FilenameUtils.separatorsToUnix(\"\\\\a\\\\b\\\\c\"));\n        assertEquals(\"D:/a/b/c\", FilenameUtils.separatorsToUnix(\"D:\\\\a\\\\b\\\\c\"));\n    }"
  },
  {
    "id": 13,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 8,
    "human_patch": "https://github.com/apache/commons-io/commit/2736b6fe0b3fa22ec8e2b4184897ecadb021fc78",
    "cve_id": "CVE-2021-29425",
    "cwe_id": "CWE-20",
    "filename": "src/test/java/org/apache/commons/io/FilenameUtilsTestCase.java",
    "is_vulnerable": 0,
    "class_name": "FilenameUtilsTestCase",
    "subclass_name": null,
    "function_name": "testSeparatorsToWindows()",
    "function_body": "{\n        assertEquals(null, FilenameUtils.separatorsToWindows(null));\n        assertEquals(\"\\\\a\\\\b\\\\c\", FilenameUtils.separatorsToWindows(\"\\\\a\\\\b\\\\c\"));\n        assertEquals(\"\\\\a\\\\b\\\\c.txt\", FilenameUtils.separatorsToWindows(\"\\\\a\\\\b\\\\c.txt\"));\n        assertEquals(\"\\\\a\\\\b\\\\c\", FilenameUtils.separatorsToWindows(\"\\\\a\\\\b/c\"));\n        assertEquals(\"\\\\a\\\\b\\\\c\", FilenameUtils.separatorsToWindows(\"/a/b/c\"));\n        assertEquals(\"D:\\\\a\\\\b\\\\c\", FilenameUtils.separatorsToWindows(\"D:/a/b/c\"));\n    }"
  },
  {
    "id": 13,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 9,
    "human_patch": "https://github.com/apache/commons-io/commit/2736b6fe0b3fa22ec8e2b4184897ecadb021fc78",
    "cve_id": "CVE-2021-29425",
    "cwe_id": "CWE-20",
    "filename": "src/test/java/org/apache/commons/io/FilenameUtilsTestCase.java",
    "is_vulnerable": 0,
    "class_name": "FilenameUtilsTestCase",
    "subclass_name": null,
    "function_name": "testSeparatorsToSystem()",
    "function_body": "{\n        if (WINDOWS) {\n            assertEquals(null, FilenameUtils.separatorsToSystem(null));\n            assertEquals(\"\\\\a\\\\b\\\\c\", FilenameUtils.separatorsToSystem(\"\\\\a\\\\b\\\\c\"));\n            assertEquals(\"\\\\a\\\\b\\\\c.txt\", FilenameUtils.separatorsToSystem(\"\\\\a\\\\b\\\\c.txt\"));\n            assertEquals(\"\\\\a\\\\b\\\\c\", FilenameUtils.separatorsToSystem(\"\\\\a\\\\b/c\"));\n            assertEquals(\"\\\\a\\\\b\\\\c\", FilenameUtils.separatorsToSystem(\"/a/b/c\"));\n            assertEquals(\"D:\\\\a\\\\b\\\\c\", FilenameUtils.separatorsToSystem(\"D:/a/b/c\"));\n        } else {\n            assertEquals(null, FilenameUtils.separatorsToSystem(null));\n            assertEquals(\"/a/b/c\", FilenameUtils.separatorsToSystem(\"/a/b/c\"));\n            assertEquals(\"/a/b/c.txt\", FilenameUtils.separatorsToSystem(\"/a/b/c.txt\"));\n            assertEquals(\"/a/b/c\", FilenameUtils.separatorsToSystem(\"/a/b\\\\c\"));\n            assertEquals(\"/a/b/c\", FilenameUtils.separatorsToSystem(\"\\\\a\\\\b\\\\c\"));\n            assertEquals(\"D:/a/b/c\", FilenameUtils.separatorsToSystem(\"D:\\\\a\\\\b\\\\c\"));\n        }\n    }"
  },
  {
    "id": 13,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 10,
    "human_patch": "https://github.com/apache/commons-io/commit/2736b6fe0b3fa22ec8e2b4184897ecadb021fc78",
    "cve_id": "CVE-2021-29425",
    "cwe_id": "CWE-20",
    "filename": "src/test/java/org/apache/commons/io/FilenameUtilsTestCase.java",
    "is_vulnerable": 1,
    "class_name": "FilenameUtilsTestCase",
    "subclass_name": null,
    "function_name": "testGetPrefixLength()",
    "function_body": "{\n        assertEquals(-1, FilenameUtils.getPrefixLength(null));\n        assertEquals(-1, FilenameUtils.getPrefixLength(\":\"));\n        assertEquals(-1, FilenameUtils.getPrefixLength(\"1:\\\\a\\\\b\\\\c.txt\"));\n        assertEquals(-1, FilenameUtils.getPrefixLength(\"1:\"));\n        assertEquals(-1, FilenameUtils.getPrefixLength(\"1:a\"));\n        assertEquals(-1, FilenameUtils.getPrefixLength(\"\\\\\\\\\\\\a\\\\b\\\\c.txt\"));\n        assertEquals(-1, FilenameUtils.getPrefixLength(\"\\\\\\\\a\"));\n\n        assertEquals(0, FilenameUtils.getPrefixLength(\"\"));\n        assertEquals(1, FilenameUtils.getPrefixLength(\"\\\\\"));\n        assertEquals(2, FilenameUtils.getPrefixLength(\"C:\"));\n        assertEquals(3, FilenameUtils.getPrefixLength(\"C:\\\\\"));\n        assertEquals(9, FilenameUtils.getPrefixLength(\"//server/\"));\n        assertEquals(2, FilenameUtils.getPrefixLength(\"~\"));\n        assertEquals(2, FilenameUtils.getPrefixLength(\"~/\"));\n        assertEquals(6, FilenameUtils.getPrefixLength(\"~user\"));\n        assertEquals(6, FilenameUtils.getPrefixLength(\"~user/\"));\n\n        assertEquals(0, FilenameUtils.getPrefixLength(\"a\\\\b\\\\c.txt\"));\n        assertEquals(1, FilenameUtils.getPrefixLength(\"\\\\a\\\\b\\\\c.txt\"));\n        assertEquals(2, FilenameUtils.getPrefixLength(\"C:a\\\\b\\\\c.txt\"));\n        assertEquals(3, FilenameUtils.getPrefixLength(\"C:\\\\a\\\\b\\\\c.txt\"));\n        assertEquals(9, FilenameUtils.getPrefixLength(\"\\\\\\\\server\\\\a\\\\b\\\\c.txt\"));\n\n        assertEquals(0, FilenameUtils.getPrefixLength(\"a/b/c.txt\"));\n        assertEquals(1, FilenameUtils.getPrefixLength(\"/a/b/c.txt\"));\n        assertEquals(3, FilenameUtils.getPrefixLength(\"C:/a/b/c.txt\"));\n        assertEquals(9, FilenameUtils.getPrefixLength(\"//server/a/b/c.txt\"));\n        assertEquals(2, FilenameUtils.getPrefixLength(\"~/a/b/c.txt\"));\n        assertEquals(6, FilenameUtils.getPrefixLength(\"~user/a/b/c.txt\"));\n\n        assertEquals(0, FilenameUtils.getPrefixLength(\"a\\\\b\\\\c.txt\"));\n        assertEquals(1, FilenameUtils.getPrefixLength(\"\\\\a\\\\b\\\\c.txt\"));\n        assertEquals(2, FilenameUtils.getPrefixLength(\"~\\\\a\\\\b\\\\c.txt\"));\n        assertEquals(6, FilenameUtils.getPrefixLength(\"~user\\\\a\\\\b\\\\c.txt\"));\n\n        assertEquals(9, FilenameUtils.getPrefixLength(\"//server/a/b/c.txt\"));\n        assertEquals(-1, FilenameUtils.getPrefixLength(\"\\\\\\\\\\\\a\\\\b\\\\c.txt\"));\n        assertEquals(-1, FilenameUtils.getPrefixLength(\"///a/b/c.txt\"));\n\n        assertEquals(1, FilenameUtils.getPrefixLength(\"/:foo\"));\n        assertEquals(1, FilenameUtils.getPrefixLength(\"/:/\"));\n        assertEquals(1, FilenameUtils.getPrefixLength(\"/:::::::.txt\"));\n    }"
  },
  {
    "id": 13,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 11,
    "human_patch": "https://github.com/apache/commons-io/commit/2736b6fe0b3fa22ec8e2b4184897ecadb021fc78",
    "cve_id": "CVE-2021-29425",
    "cwe_id": "CWE-20",
    "filename": "src/test/java/org/apache/commons/io/FilenameUtilsTestCase.java",
    "is_vulnerable": 0,
    "class_name": "FilenameUtilsTestCase",
    "subclass_name": null,
    "function_name": "testIndexOfLastSeparator()",
    "function_body": "{\n        assertEquals(-1, FilenameUtils.indexOfLastSeparator(null));\n        assertEquals(-1, FilenameUtils.indexOfLastSeparator(\"noseperator.inthispath\"));\n        assertEquals(3, FilenameUtils.indexOfLastSeparator(\"a/b/c\"));\n        assertEquals(3, FilenameUtils.indexOfLastSeparator(\"a\\\\b\\\\c\"));\n    }"
  },
  {
    "id": 13,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 12,
    "human_patch": "https://github.com/apache/commons-io/commit/2736b6fe0b3fa22ec8e2b4184897ecadb021fc78",
    "cve_id": "CVE-2021-29425",
    "cwe_id": "CWE-20",
    "filename": "src/test/java/org/apache/commons/io/FilenameUtilsTestCase.java",
    "is_vulnerable": 0,
    "class_name": "FilenameUtilsTestCase",
    "subclass_name": null,
    "function_name": "testIndexOfExtension()",
    "function_body": "{\n        assertEquals(-1, FilenameUtils.indexOfExtension(null));\n        assertEquals(-1, FilenameUtils.indexOfExtension(\"file\"));\n        assertEquals(4, FilenameUtils.indexOfExtension(\"file.txt\"));\n        assertEquals(13, FilenameUtils.indexOfExtension(\"a.txt/b.txt/c.txt\"));\n        assertEquals(-1, FilenameUtils.indexOfExtension(\"a/b/c\"));\n        assertEquals(-1, FilenameUtils.indexOfExtension(\"a\\\\b\\\\c\"));\n        assertEquals(-1, FilenameUtils.indexOfExtension(\"a/b.notextension/c\"));\n        assertEquals(-1, FilenameUtils.indexOfExtension(\"a\\\\b.notextension\\\\c\"));\n\n        if (FilenameUtils.isSystemWindows()) {\n            \n        \ttry {\n        \t\tFilenameUtils.indexOfExtension(\"foo.exe:bar.txt\");\n        \t\tthrow new AssertionError(\"Expected Exception\");\n        \t} catch (IllegalArgumentException e) {\n        \t\tassertEquals(\"NTFS ADS separator (':') in file name is forbidden.\", e.getMessage());\n        \t}\n        } else {\n        \t\n        \tassertEquals(11, FilenameUtils.indexOfExtension(\"foo.exe:bar.txt\"));\n        }\n\n    }"
  },
  {
    "id": 13,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 13,
    "human_patch": "https://github.com/apache/commons-io/commit/2736b6fe0b3fa22ec8e2b4184897ecadb021fc78",
    "cve_id": "CVE-2021-29425",
    "cwe_id": "CWE-20",
    "filename": "src/test/java/org/apache/commons/io/FilenameUtilsTestCase.java",
    "is_vulnerable": 0,
    "class_name": "FilenameUtilsTestCase",
    "subclass_name": null,
    "function_name": "testGetPrefix()",
    "function_body": "{\n        assertEquals(null, FilenameUtils.getPrefix(null));\n        assertEquals(null, FilenameUtils.getPrefix(\":\"));\n        assertEquals(null, FilenameUtils.getPrefix(\"1:\\\\a\\\\b\\\\c.txt\"));\n        assertEquals(null, FilenameUtils.getPrefix(\"1:\"));\n        assertEquals(null, FilenameUtils.getPrefix(\"1:a\"));\n        assertEquals(null, FilenameUtils.getPrefix(\"\\\\\\\\\\\\a\\\\b\\\\c.txt\"));\n        assertEquals(null, FilenameUtils.getPrefix(\"\\\\\\\\a\"));\n\n        assertEquals(\"\", FilenameUtils.getPrefix(\"\"));\n        assertEquals(\"\\\\\", FilenameUtils.getPrefix(\"\\\\\"));\n        assertEquals(\"C:\", FilenameUtils.getPrefix(\"C:\"));\n        assertEquals(\"C:\\\\\", FilenameUtils.getPrefix(\"C:\\\\\"));\n        assertEquals(\"//server/\", FilenameUtils.getPrefix(\"//server/\"));\n        assertEquals(\"~/\", FilenameUtils.getPrefix(\"~\"));\n        assertEquals(\"~/\", FilenameUtils.getPrefix(\"~/\"));\n        assertEquals(\"~user/\", FilenameUtils.getPrefix(\"~user\"));\n        assertEquals(\"~user/\", FilenameUtils.getPrefix(\"~user/\"));\n\n        assertEquals(\"\", FilenameUtils.getPrefix(\"a\\\\b\\\\c.txt\"));\n        assertEquals(\"\\\\\", FilenameUtils.getPrefix(\"\\\\a\\\\b\\\\c.txt\"));\n        assertEquals(\"C:\\\\\", FilenameUtils.getPrefix(\"C:\\\\a\\\\b\\\\c.txt\"));\n        assertEquals(\"\\\\\\\\server\\\\\", FilenameUtils.getPrefix(\"\\\\\\\\server\\\\a\\\\b\\\\c.txt\"));\n\n        assertEquals(\"\", FilenameUtils.getPrefix(\"a/b/c.txt\"));\n        assertEquals(\"/\", FilenameUtils.getPrefix(\"/a/b/c.txt\"));\n        assertEquals(\"C:/\", FilenameUtils.getPrefix(\"C:/a/b/c.txt\"));\n        assertEquals(\"//server/\", FilenameUtils.getPrefix(\"//server/a/b/c.txt\"));\n        assertEquals(\"~/\", FilenameUtils.getPrefix(\"~/a/b/c.txt\"));\n        assertEquals(\"~user/\", FilenameUtils.getPrefix(\"~user/a/b/c.txt\"));\n\n        assertEquals(\"\", FilenameUtils.getPrefix(\"a\\\\b\\\\c.txt\"));\n        assertEquals(\"\\\\\", FilenameUtils.getPrefix(\"\\\\a\\\\b\\\\c.txt\"));\n        assertEquals(\"~\\\\\", FilenameUtils.getPrefix(\"~\\\\a\\\\b\\\\c.txt\"));\n        assertEquals(\"~user\\\\\", FilenameUtils.getPrefix(\"~user\\\\a\\\\b\\\\c.txt\"));\n    }"
  },
  {
    "id": 13,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 14,
    "human_patch": "https://github.com/apache/commons-io/commit/2736b6fe0b3fa22ec8e2b4184897ecadb021fc78",
    "cve_id": "CVE-2021-29425",
    "cwe_id": "CWE-20",
    "filename": "src/test/java/org/apache/commons/io/FilenameUtilsTestCase.java",
    "is_vulnerable": 0,
    "class_name": "FilenameUtilsTestCase",
    "subclass_name": null,
    "function_name": "testGetPrefix_with_nullbyte()",
    "function_body": "{\n        try {\n            assertEquals(\"~user\\\\\", FilenameUtils.getPrefix(\"~u\\u0000ser\\\\a\\\\b\\\\c.txt\"));\n        } catch (final IllegalArgumentException ignore) {\n\n        }\n    }"
  },
  {
    "id": 13,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 15,
    "human_patch": "https://github.com/apache/commons-io/commit/2736b6fe0b3fa22ec8e2b4184897ecadb021fc78",
    "cve_id": "CVE-2021-29425",
    "cwe_id": "CWE-20",
    "filename": "src/test/java/org/apache/commons/io/FilenameUtilsTestCase.java",
    "is_vulnerable": 0,
    "class_name": "FilenameUtilsTestCase",
    "subclass_name": null,
    "function_name": "testGetPath()",
    "function_body": "{\n        assertEquals(null, FilenameUtils.getPath(null));\n        assertEquals(\"\", FilenameUtils.getPath(\"noseperator.inthispath\"));\n        assertEquals(\"\", FilenameUtils.getPath(\"/noseperator.inthispath\"));\n        assertEquals(\"\", FilenameUtils.getPath(\"\\\\noseperator.inthispath\"));\n        assertEquals(\"a/b/\", FilenameUtils.getPath(\"a/b/c.txt\"));\n        assertEquals(\"a/b/\", FilenameUtils.getPath(\"a/b/c\"));\n        assertEquals(\"a/b/c/\", FilenameUtils.getPath(\"a/b/c/\"));\n        assertEquals(\"a\\\\b\\\\\", FilenameUtils.getPath(\"a\\\\b\\\\c\"));\n\n        assertEquals(null, FilenameUtils.getPath(\":\"));\n        assertEquals(null, FilenameUtils.getPath(\"1:/a/b/c.txt\"));\n        assertEquals(null, FilenameUtils.getPath(\"1:\"));\n        assertEquals(null, FilenameUtils.getPath(\"1:a\"));\n        assertEquals(null, FilenameUtils.getPath(\"///a/b/c.txt\"));\n        assertEquals(null, FilenameUtils.getPath(\"//a\"));\n\n        assertEquals(\"\", FilenameUtils.getPath(\"\"));\n        assertEquals(\"\", FilenameUtils.getPath(\"C:\"));\n        assertEquals(\"\", FilenameUtils.getPath(\"C:/\"));\n        assertEquals(\"\", FilenameUtils.getPath(\"//server/\"));\n        assertEquals(\"\", FilenameUtils.getPath(\"~\"));\n        assertEquals(\"\", FilenameUtils.getPath(\"~/\"));\n        assertEquals(\"\", FilenameUtils.getPath(\"~user\"));\n        assertEquals(\"\", FilenameUtils.getPath(\"~user/\"));\n\n        assertEquals(\"a/b/\", FilenameUtils.getPath(\"a/b/c.txt\"));\n        assertEquals(\"a/b/\", FilenameUtils.getPath(\"/a/b/c.txt\"));\n        assertEquals(\"\", FilenameUtils.getPath(\"C:a\"));\n        assertEquals(\"a/b/\", FilenameUtils.getPath(\"C:a/b/c.txt\"));\n        assertEquals(\"a/b/\", FilenameUtils.getPath(\"C:/a/b/c.txt\"));\n        assertEquals(\"a/b/\", FilenameUtils.getPath(\"//server/a/b/c.txt\"));\n        assertEquals(\"a/b/\", FilenameUtils.getPath(\"~/a/b/c.txt\"));\n        assertEquals(\"a/b/\", FilenameUtils.getPath(\"~user/a/b/c.txt\"));\n    }"
  },
  {
    "id": 13,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 16,
    "human_patch": "https://github.com/apache/commons-io/commit/2736b6fe0b3fa22ec8e2b4184897ecadb021fc78",
    "cve_id": "CVE-2021-29425",
    "cwe_id": "CWE-20",
    "filename": "src/test/java/org/apache/commons/io/FilenameUtilsTestCase.java",
    "is_vulnerable": 0,
    "class_name": "FilenameUtilsTestCase",
    "subclass_name": null,
    "function_name": "testGetPath_with_nullbyte()",
    "function_body": "{\n        assertEquals(\"a/b/\", FilenameUtils.getPath(\"~user/a/\\u0000b/c.txt\"));\n    }"
  },
  {
    "id": 13,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 17,
    "human_patch": "https://github.com/apache/commons-io/commit/2736b6fe0b3fa22ec8e2b4184897ecadb021fc78",
    "cve_id": "CVE-2021-29425",
    "cwe_id": "CWE-20",
    "filename": "src/test/java/org/apache/commons/io/FilenameUtilsTestCase.java",
    "is_vulnerable": 0,
    "class_name": "FilenameUtilsTestCase",
    "subclass_name": null,
    "function_name": "testGetPathNoEndSeparator()",
    "function_body": "{\n        assertEquals(null, FilenameUtils.getPath(null));\n        assertEquals(\"\", FilenameUtils.getPath(\"noseperator.inthispath\"));\n        assertEquals(\"\", FilenameUtils.getPathNoEndSeparator(\"/noseperator.inthispath\"));\n        assertEquals(\"\", FilenameUtils.getPathNoEndSeparator(\"\\\\noseperator.inthispath\"));\n        assertEquals(\"a/b\", FilenameUtils.getPathNoEndSeparator(\"a/b/c.txt\"));\n        assertEquals(\"a/b\", FilenameUtils.getPathNoEndSeparator(\"a/b/c\"));\n        assertEquals(\"a/b/c\", FilenameUtils.getPathNoEndSeparator(\"a/b/c/\"));\n        assertEquals(\"a\\\\b\", FilenameUtils.getPathNoEndSeparator(\"a\\\\b\\\\c\"));\n\n        assertEquals(null, FilenameUtils.getPathNoEndSeparator(\":\"));\n        assertEquals(null, FilenameUtils.getPathNoEndSeparator(\"1:/a/b/c.txt\"));\n        assertEquals(null, FilenameUtils.getPathNoEndSeparator(\"1:\"));\n        assertEquals(null, FilenameUtils.getPathNoEndSeparator(\"1:a\"));\n        assertEquals(null, FilenameUtils.getPathNoEndSeparator(\"///a/b/c.txt\"));\n        assertEquals(null, FilenameUtils.getPathNoEndSeparator(\"//a\"));\n\n        assertEquals(\"\", FilenameUtils.getPathNoEndSeparator(\"\"));\n        assertEquals(\"\", FilenameUtils.getPathNoEndSeparator(\"C:\"));\n        assertEquals(\"\", FilenameUtils.getPathNoEndSeparator(\"C:/\"));\n        assertEquals(\"\", FilenameUtils.getPathNoEndSeparator(\"//server/\"));\n        assertEquals(\"\", FilenameUtils.getPathNoEndSeparator(\"~\"));\n        assertEquals(\"\", FilenameUtils.getPathNoEndSeparator(\"~/\"));\n        assertEquals(\"\", FilenameUtils.getPathNoEndSeparator(\"~user\"));\n        assertEquals(\"\", FilenameUtils.getPathNoEndSeparator(\"~user/\"));\n\n        assertEquals(\"a/b\", FilenameUtils.getPathNoEndSeparator(\"a/b/c.txt\"));\n        assertEquals(\"a/b\", FilenameUtils.getPathNoEndSeparator(\"/a/b/c.txt\"));\n        assertEquals(\"\", FilenameUtils.getPathNoEndSeparator(\"C:a\"));\n        assertEquals(\"a/b\", FilenameUtils.getPathNoEndSeparator(\"C:a/b/c.txt\"));\n        assertEquals(\"a/b\", FilenameUtils.getPathNoEndSeparator(\"C:/a/b/c.txt\"));\n        assertEquals(\"a/b\", FilenameUtils.getPathNoEndSeparator(\"//server/a/b/c.txt\"));\n        assertEquals(\"a/b\", FilenameUtils.getPathNoEndSeparator(\"~/a/b/c.txt\"));\n        assertEquals(\"a/b\", FilenameUtils.getPathNoEndSeparator(\"~user/a/b/c.txt\"));\n    }"
  },
  {
    "id": 13,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 18,
    "human_patch": "https://github.com/apache/commons-io/commit/2736b6fe0b3fa22ec8e2b4184897ecadb021fc78",
    "cve_id": "CVE-2021-29425",
    "cwe_id": "CWE-20",
    "filename": "src/test/java/org/apache/commons/io/FilenameUtilsTestCase.java",
    "is_vulnerable": 0,
    "class_name": "FilenameUtilsTestCase",
    "subclass_name": null,
    "function_name": "testGetPathNoEndSeparator_with_null_byte()",
    "function_body": "{\n        try {\n            assertEquals(\"a/b\", FilenameUtils.getPathNoEndSeparator(\"~user/a\\u0000/b/c.txt\"));\n        } catch (final IllegalArgumentException ignore) {\n\n        }\n    }"
  },
  {
    "id": 13,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 19,
    "human_patch": "https://github.com/apache/commons-io/commit/2736b6fe0b3fa22ec8e2b4184897ecadb021fc78",
    "cve_id": "CVE-2021-29425",
    "cwe_id": "CWE-20",
    "filename": "src/test/java/org/apache/commons/io/FilenameUtilsTestCase.java",
    "is_vulnerable": 0,
    "class_name": "FilenameUtilsTestCase",
    "subclass_name": null,
    "function_name": "testGetFullPath()",
    "function_body": "{\n        assertEquals(null, FilenameUtils.getFullPath(null));\n        assertEquals(\"\", FilenameUtils.getFullPath(\"noseperator.inthispath\"));\n        assertEquals(\"a/b/\", FilenameUtils.getFullPath(\"a/b/c.txt\"));\n        assertEquals(\"a/b/\", FilenameUtils.getFullPath(\"a/b/c\"));\n        assertEquals(\"a/b/c/\", FilenameUtils.getFullPath(\"a/b/c/\"));\n        assertEquals(\"a\\\\b\\\\\", FilenameUtils.getFullPath(\"a\\\\b\\\\c\"));\n\n        assertEquals(null, FilenameUtils.getFullPath(\":\"));\n        assertEquals(null, FilenameUtils.getFullPath(\"1:/a/b/c.txt\"));\n        assertEquals(null, FilenameUtils.getFullPath(\"1:\"));\n        assertEquals(null, FilenameUtils.getFullPath(\"1:a\"));\n        assertEquals(null, FilenameUtils.getFullPath(\"///a/b/c.txt\"));\n        assertEquals(null, FilenameUtils.getFullPath(\"//a\"));\n\n        assertEquals(\"\", FilenameUtils.getFullPath(\"\"));\n        assertEquals(\"C:\", FilenameUtils.getFullPath(\"C:\"));\n        assertEquals(\"C:/\", FilenameUtils.getFullPath(\"C:/\"));\n        assertEquals(\"//server/\", FilenameUtils.getFullPath(\"//server/\"));\n        assertEquals(\"~/\", FilenameUtils.getFullPath(\"~\"));\n        assertEquals(\"~/\", FilenameUtils.getFullPath(\"~/\"));\n        assertEquals(\"~user/\", FilenameUtils.getFullPath(\"~user\"));\n        assertEquals(\"~user/\", FilenameUtils.getFullPath(\"~user/\"));\n\n        assertEquals(\"a/b/\", FilenameUtils.getFullPath(\"a/b/c.txt\"));\n        assertEquals(\"/a/b/\", FilenameUtils.getFullPath(\"/a/b/c.txt\"));\n        assertEquals(\"C:\", FilenameUtils.getFullPath(\"C:a\"));\n        assertEquals(\"C:a/b/\", FilenameUtils.getFullPath(\"C:a/b/c.txt\"));\n        assertEquals(\"C:/a/b/\", FilenameUtils.getFullPath(\"C:/a/b/c.txt\"));\n        assertEquals(\"//server/a/b/\", FilenameUtils.getFullPath(\"//server/a/b/c.txt\"));\n        assertEquals(\"~/a/b/\", FilenameUtils.getFullPath(\"~/a/b/c.txt\"));\n        assertEquals(\"~user/a/b/\", FilenameUtils.getFullPath(\"~user/a/b/c.txt\"));\n    }"
  },
  {
    "id": 13,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 20,
    "human_patch": "https://github.com/apache/commons-io/commit/2736b6fe0b3fa22ec8e2b4184897ecadb021fc78",
    "cve_id": "CVE-2021-29425",
    "cwe_id": "CWE-20",
    "filename": "src/test/java/org/apache/commons/io/FilenameUtilsTestCase.java",
    "is_vulnerable": 0,
    "class_name": "FilenameUtilsTestCase",
    "subclass_name": null,
    "function_name": "testGetFullPathNoEndSeparator()",
    "function_body": "{\n        assertEquals(null, FilenameUtils.getFullPathNoEndSeparator(null));\n        assertEquals(\"\", FilenameUtils.getFullPathNoEndSeparator(\"noseperator.inthispath\"));\n        assertEquals(\"a/b\", FilenameUtils.getFullPathNoEndSeparator(\"a/b/c.txt\"));\n        assertEquals(\"a/b\", FilenameUtils.getFullPathNoEndSeparator(\"a/b/c\"));\n        assertEquals(\"a/b/c\", FilenameUtils.getFullPathNoEndSeparator(\"a/b/c/\"));\n        assertEquals(\"a\\\\b\", FilenameUtils.getFullPathNoEndSeparator(\"a\\\\b\\\\c\"));\n\n        assertEquals(null, FilenameUtils.getFullPathNoEndSeparator(\":\"));\n        assertEquals(null, FilenameUtils.getFullPathNoEndSeparator(\"1:/a/b/c.txt\"));\n        assertEquals(null, FilenameUtils.getFullPathNoEndSeparator(\"1:\"));\n        assertEquals(null, FilenameUtils.getFullPathNoEndSeparator(\"1:a\"));\n        assertEquals(null, FilenameUtils.getFullPathNoEndSeparator(\"///a/b/c.txt\"));\n        assertEquals(null, FilenameUtils.getFullPathNoEndSeparator(\"//a\"));\n\n        assertEquals(\"\", FilenameUtils.getFullPathNoEndSeparator(\"\"));\n        assertEquals(\"C:\", FilenameUtils.getFullPathNoEndSeparator(\"C:\"));\n        assertEquals(\"C:/\", FilenameUtils.getFullPathNoEndSeparator(\"C:/\"));\n        assertEquals(\"//server/\", FilenameUtils.getFullPathNoEndSeparator(\"//server/\"));\n        assertEquals(\"~\", FilenameUtils.getFullPathNoEndSeparator(\"~\"));\n        assertEquals(\"~/\", FilenameUtils.getFullPathNoEndSeparator(\"~/\"));\n        assertEquals(\"~user\", FilenameUtils.getFullPathNoEndSeparator(\"~user\"));\n        assertEquals(\"~user/\", FilenameUtils.getFullPathNoEndSeparator(\"~user/\"));\n\n        assertEquals(\"a/b\", FilenameUtils.getFullPathNoEndSeparator(\"a/b/c.txt\"));\n        assertEquals(\"/a/b\", FilenameUtils.getFullPathNoEndSeparator(\"/a/b/c.txt\"));\n        assertEquals(\"C:\", FilenameUtils.getFullPathNoEndSeparator(\"C:a\"));\n        assertEquals(\"C:a/b\", FilenameUtils.getFullPathNoEndSeparator(\"C:a/b/c.txt\"));\n        assertEquals(\"C:/a/b\", FilenameUtils.getFullPathNoEndSeparator(\"C:/a/b/c.txt\"));\n        assertEquals(\"//server/a/b\", FilenameUtils.getFullPathNoEndSeparator(\"//server/a/b/c.txt\"));\n        assertEquals(\"~/a/b\", FilenameUtils.getFullPathNoEndSeparator(\"~/a/b/c.txt\"));\n        assertEquals(\"~user/a/b\", FilenameUtils.getFullPathNoEndSeparator(\"~user/a/b/c.txt\"));\n    }"
  },
  {
    "id": 13,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 21,
    "human_patch": "https://github.com/apache/commons-io/commit/2736b6fe0b3fa22ec8e2b4184897ecadb021fc78",
    "cve_id": "CVE-2021-29425",
    "cwe_id": "CWE-20",
    "filename": "src/test/java/org/apache/commons/io/FilenameUtilsTestCase.java",
    "is_vulnerable": 0,
    "class_name": "FilenameUtilsTestCase",
    "subclass_name": null,
    "function_name": "testGetFullPathNoEndSeparator_IO_248()",
    "function_body": "{\n\n        \n        assertEquals(\"/\", FilenameUtils.getFullPathNoEndSeparator(\"/\"));\n        assertEquals(\"\\\\\", FilenameUtils.getFullPathNoEndSeparator(\"\\\\\"));\n\n        \n        assertEquals(\"/\", FilenameUtils.getFullPathNoEndSeparator(\"/abc\"));\n        assertEquals(\"\\\\\", FilenameUtils.getFullPathNoEndSeparator(\"\\\\abc\"));\n\n        \n        assertEquals(\"/abc\", FilenameUtils.getFullPathNoEndSeparator(\"/abc/xyz\"));\n        assertEquals(\"\\\\abc\", FilenameUtils.getFullPathNoEndSeparator(\"\\\\abc\\\\xyz\"));\n    }"
  },
  {
    "id": 13,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 22,
    "human_patch": "https://github.com/apache/commons-io/commit/2736b6fe0b3fa22ec8e2b4184897ecadb021fc78",
    "cve_id": "CVE-2021-29425",
    "cwe_id": "CWE-20",
    "filename": "src/test/java/org/apache/commons/io/FilenameUtilsTestCase.java",
    "is_vulnerable": 0,
    "class_name": "FilenameUtilsTestCase",
    "subclass_name": null,
    "function_name": "testGetName()",
    "function_body": "{\n        assertEquals(null, FilenameUtils.getName(null));\n        assertEquals(\"noseperator.inthispath\", FilenameUtils.getName(\"noseperator.inthispath\"));\n        assertEquals(\"c.txt\", FilenameUtils.getName(\"a/b/c.txt\"));\n        assertEquals(\"c\", FilenameUtils.getName(\"a/b/c\"));\n        assertEquals(\"\", FilenameUtils.getName(\"a/b/c/\"));\n        assertEquals(\"c\", FilenameUtils.getName(\"a\\\\b\\\\c\"));\n    }"
  },
  {
    "id": 13,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 23,
    "human_patch": "https://github.com/apache/commons-io/commit/2736b6fe0b3fa22ec8e2b4184897ecadb021fc78",
    "cve_id": "CVE-2021-29425",
    "cwe_id": "CWE-20",
    "filename": "src/test/java/org/apache/commons/io/FilenameUtilsTestCase.java",
    "is_vulnerable": 0,
    "class_name": "FilenameUtilsTestCase",
    "subclass_name": null,
    "function_name": "testInjectionFailure()",
    "function_body": "{\n        try {\n            assertEquals(\"c\", FilenameUtils.getName(\"a\\\\b\\\\\\u0000c\"));\n        } catch (final IllegalArgumentException ignore) {\n\n        }\n    }"
  },
  {
    "id": 13,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 24,
    "human_patch": "https://github.com/apache/commons-io/commit/2736b6fe0b3fa22ec8e2b4184897ecadb021fc78",
    "cve_id": "CVE-2021-29425",
    "cwe_id": "CWE-20",
    "filename": "src/test/java/org/apache/commons/io/FilenameUtilsTestCase.java",
    "is_vulnerable": 0,
    "class_name": "FilenameUtilsTestCase",
    "subclass_name": null,
    "function_name": "testGetBaseName()",
    "function_body": "{\n        assertEquals(null, FilenameUtils.getBaseName(null));\n        assertEquals(\"noseperator\", FilenameUtils.getBaseName(\"noseperator.inthispath\"));\n        assertEquals(\"c\", FilenameUtils.getBaseName(\"a/b/c.txt\"));\n        assertEquals(\"c\", FilenameUtils.getBaseName(\"a/b/c\"));\n        assertEquals(\"\", FilenameUtils.getBaseName(\"a/b/c/\"));\n        assertEquals(\"c\", FilenameUtils.getBaseName(\"a\\\\b\\\\c\"));\n        assertEquals(\"file.txt\", FilenameUtils.getBaseName(\"file.txt.bak\"));\n    }"
  },
  {
    "id": 13,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 25,
    "human_patch": "https://github.com/apache/commons-io/commit/2736b6fe0b3fa22ec8e2b4184897ecadb021fc78",
    "cve_id": "CVE-2021-29425",
    "cwe_id": "CWE-20",
    "filename": "src/test/java/org/apache/commons/io/FilenameUtilsTestCase.java",
    "is_vulnerable": 0,
    "class_name": "FilenameUtilsTestCase",
    "subclass_name": null,
    "function_name": "testGetBaseName_with_nullByte()",
    "function_body": "{\n        try {\n            assertEquals(\"file.txt\", FilenameUtils.getBaseName(\"fil\\u0000e.txt.bak\"));\n        } catch (final IllegalArgumentException ignore) {\n\n        }\n    }"
  },
  {
    "id": 13,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 26,
    "human_patch": "https://github.com/apache/commons-io/commit/2736b6fe0b3fa22ec8e2b4184897ecadb021fc78",
    "cve_id": "CVE-2021-29425",
    "cwe_id": "CWE-20",
    "filename": "src/test/java/org/apache/commons/io/FilenameUtilsTestCase.java",
    "is_vulnerable": 0,
    "class_name": "FilenameUtilsTestCase",
    "subclass_name": null,
    "function_name": "testGetExtension()",
    "function_body": "{\n        assertEquals(null, FilenameUtils.getExtension(null));\n        assertEquals(\"ext\", FilenameUtils.getExtension(\"file.ext\"));\n        assertEquals(\"\", FilenameUtils.getExtension(\"README\"));\n        assertEquals(\"com\", FilenameUtils.getExtension(\"domain.dot.com\"));\n        assertEquals(\"jpeg\", FilenameUtils.getExtension(\"image.jpeg\"));\n        assertEquals(\"\", FilenameUtils.getExtension(\"a.b/c\"));\n        assertEquals(\"txt\", FilenameUtils.getExtension(\"a.b/c.txt\"));\n        assertEquals(\"\", FilenameUtils.getExtension(\"a/b/c\"));\n        assertEquals(\"\", FilenameUtils.getExtension(\"a.b\\\\c\"));\n        assertEquals(\"txt\", FilenameUtils.getExtension(\"a.b\\\\c.txt\"));\n        assertEquals(\"\", FilenameUtils.getExtension(\"a\\\\b\\\\c\"));\n        assertEquals(\"\", FilenameUtils.getExtension(\"C:\\\\temp\\\\foo.bar\\\\README\"));\n        assertEquals(\"ext\", FilenameUtils.getExtension(\"../filename.ext\"));\n\n        if (FilenameUtils.isSystemWindows()) {\n            \n        \ttry {\n        \t\tFilenameUtils.getExtension(\"foo.exe:bar.txt\");\n        \t\tthrow new AssertionError(\"Expected Exception\");\n        \t} catch (IllegalArgumentException e) {\n        \t\tassertEquals(\"NTFS ADS separator (':') in file name is forbidden.\", e.getMessage());\n        \t}\n        } else {\n        \t\n        \tassertEquals(\"txt\", FilenameUtils.getExtension(\"foo.exe:bar.txt\"));\n        }\n    }"
  },
  {
    "id": 13,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 27,
    "human_patch": "https://github.com/apache/commons-io/commit/2736b6fe0b3fa22ec8e2b4184897ecadb021fc78",
    "cve_id": "CVE-2021-29425",
    "cwe_id": "CWE-20",
    "filename": "src/test/java/org/apache/commons/io/FilenameUtilsTestCase.java",
    "is_vulnerable": 0,
    "class_name": "FilenameUtilsTestCase",
    "subclass_name": null,
    "function_name": "testRemoveExtension()",
    "function_body": "{\n        assertEquals(null, FilenameUtils.removeExtension(null));\n        assertEquals(\"file\", FilenameUtils.removeExtension(\"file.ext\"));\n        assertEquals(\"README\", FilenameUtils.removeExtension(\"README\"));\n        assertEquals(\"domain.dot\", FilenameUtils.removeExtension(\"domain.dot.com\"));\n        assertEquals(\"image\", FilenameUtils.removeExtension(\"image.jpeg\"));\n        assertEquals(\"a.b/c\", FilenameUtils.removeExtension(\"a.b/c\"));\n        assertEquals(\"a.b/c\", FilenameUtils.removeExtension(\"a.b/c.txt\"));\n        assertEquals(\"a/b/c\", FilenameUtils.removeExtension(\"a/b/c\"));\n        assertEquals(\"a.b\\\\c\", FilenameUtils.removeExtension(\"a.b\\\\c\"));\n        assertEquals(\"a.b\\\\c\", FilenameUtils.removeExtension(\"a.b\\\\c.txt\"));\n        assertEquals(\"a\\\\b\\\\c\", FilenameUtils.removeExtension(\"a\\\\b\\\\c\"));\n        assertEquals(\"C:\\\\temp\\\\foo.bar\\\\README\", FilenameUtils.removeExtension(\"C:\\\\temp\\\\foo.bar\\\\README\"));\n        assertEquals(\"../filename\", FilenameUtils.removeExtension(\"../filename.ext\"));\n    }"
  },
  {
    "id": 13,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 28,
    "human_patch": "https://github.com/apache/commons-io/commit/2736b6fe0b3fa22ec8e2b4184897ecadb021fc78",
    "cve_id": "CVE-2021-29425",
    "cwe_id": "CWE-20",
    "filename": "src/test/java/org/apache/commons/io/FilenameUtilsTestCase.java",
    "is_vulnerable": 0,
    "class_name": "FilenameUtilsTestCase",
    "subclass_name": null,
    "function_name": "testEquals()",
    "function_body": "{\n        assertTrue(FilenameUtils.equals(null, null));\n        assertFalse(FilenameUtils.equals(null, \"\"));\n        assertFalse(FilenameUtils.equals(\"\", null));\n        assertTrue(FilenameUtils.equals(\"\", \"\"));\n        assertTrue(FilenameUtils.equals(\"file.txt\", \"file.txt\"));\n        assertFalse(FilenameUtils.equals(\"file.txt\", \"FILE.TXT\"));\n        assertFalse(FilenameUtils.equals(\"a\\\\b\\\\file.txt\", \"a/b/file.txt\"));\n    }"
  },
  {
    "id": 13,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 29,
    "human_patch": "https://github.com/apache/commons-io/commit/2736b6fe0b3fa22ec8e2b4184897ecadb021fc78",
    "cve_id": "CVE-2021-29425",
    "cwe_id": "CWE-20",
    "filename": "src/test/java/org/apache/commons/io/FilenameUtilsTestCase.java",
    "is_vulnerable": 0,
    "class_name": "FilenameUtilsTestCase",
    "subclass_name": null,
    "function_name": "testEqualsOnSystem()",
    "function_body": "{\n        assertTrue(FilenameUtils.equalsOnSystem(null, null));\n        assertFalse(FilenameUtils.equalsOnSystem(null, \"\"));\n        assertFalse(FilenameUtils.equalsOnSystem(\"\", null));\n        assertTrue(FilenameUtils.equalsOnSystem(\"\", \"\"));\n        assertTrue(FilenameUtils.equalsOnSystem(\"file.txt\", \"file.txt\"));\n        assertEquals(WINDOWS, FilenameUtils.equalsOnSystem(\"file.txt\", \"FILE.TXT\"));\n        assertFalse(FilenameUtils.equalsOnSystem(\"a\\\\b\\\\file.txt\", \"a/b/file.txt\"));\n    }"
  },
  {
    "id": 13,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 30,
    "human_patch": "https://github.com/apache/commons-io/commit/2736b6fe0b3fa22ec8e2b4184897ecadb021fc78",
    "cve_id": "CVE-2021-29425",
    "cwe_id": "CWE-20",
    "filename": "src/test/java/org/apache/commons/io/FilenameUtilsTestCase.java",
    "is_vulnerable": 0,
    "class_name": "FilenameUtilsTestCase",
    "subclass_name": null,
    "function_name": "testEqualsNormalized()",
    "function_body": "{\n        assertTrue(FilenameUtils.equalsNormalized(null, null));\n        assertFalse(FilenameUtils.equalsNormalized(null, \"\"));\n        assertFalse(FilenameUtils.equalsNormalized(\"\", null));\n        assertTrue(FilenameUtils.equalsNormalized(\"\", \"\"));\n        assertTrue(FilenameUtils.equalsNormalized(\"file.txt\", \"file.txt\"));\n        assertFalse(FilenameUtils.equalsNormalized(\"file.txt\", \"FILE.TXT\"));\n        assertTrue(FilenameUtils.equalsNormalized(\"a\\\\b\\\\file.txt\", \"a/b/file.txt\"));\n        assertFalse(FilenameUtils.equalsNormalized(\"a/b/\", \"a/b\"));\n    }"
  },
  {
    "id": 13,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 31,
    "human_patch": "https://github.com/apache/commons-io/commit/2736b6fe0b3fa22ec8e2b4184897ecadb021fc78",
    "cve_id": "CVE-2021-29425",
    "cwe_id": "CWE-20",
    "filename": "src/test/java/org/apache/commons/io/FilenameUtilsTestCase.java",
    "is_vulnerable": 0,
    "class_name": "FilenameUtilsTestCase",
    "subclass_name": null,
    "function_name": "testEqualsNormalizedOnSystem()",
    "function_body": "{\n        assertTrue(FilenameUtils.equalsNormalizedOnSystem(null, null));\n        assertFalse(FilenameUtils.equalsNormalizedOnSystem(null, \"\"));\n        assertFalse(FilenameUtils.equalsNormalizedOnSystem(\"\", null));\n        assertTrue(FilenameUtils.equalsNormalizedOnSystem(\"\", \"\"));\n        assertTrue(FilenameUtils.equalsNormalizedOnSystem(\"file.txt\", \"file.txt\"));\n        assertEquals(WINDOWS, FilenameUtils.equalsNormalizedOnSystem(\"file.txt\", \"FILE.TXT\"));\n        assertTrue(FilenameUtils.equalsNormalizedOnSystem(\"a\\\\b\\\\file.txt\", \"a/b/file.txt\"));\n        assertFalse(FilenameUtils.equalsNormalizedOnSystem(\"a/b/\", \"a/b\"));\n    }"
  },
  {
    "id": 13,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 32,
    "human_patch": "https://github.com/apache/commons-io/commit/2736b6fe0b3fa22ec8e2b4184897ecadb021fc78",
    "cve_id": "CVE-2021-29425",
    "cwe_id": "CWE-20",
    "filename": "src/test/java/org/apache/commons/io/FilenameUtilsTestCase.java",
    "is_vulnerable": 0,
    "class_name": "FilenameUtilsTestCase",
    "subclass_name": null,
    "function_name": "testEqualsNormalizedError_IO_128()",
    "function_body": "{\n        try {\n            FilenameUtils.equalsNormalizedOnSystem(\"//file.txt\", \"file.txt\");\n            fail(\"Invalid normalized first file\");\n        } catch (final NullPointerException e) {\n            \n        }\n        try {\n            FilenameUtils.equalsNormalizedOnSystem(\"file.txt\", \"//file.txt\");\n            fail(\"Invalid normalized second file\");\n        } catch (final NullPointerException e) {\n            \n        }\n        try {\n            FilenameUtils.equalsNormalizedOnSystem(\"//file.txt\", \"//file.txt\");\n            fail(\"Invalid normalized both filse\");\n        } catch (final NullPointerException e) {\n            \n        }\n    }"
  },
  {
    "id": 13,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 33,
    "human_patch": "https://github.com/apache/commons-io/commit/2736b6fe0b3fa22ec8e2b4184897ecadb021fc78",
    "cve_id": "CVE-2021-29425",
    "cwe_id": "CWE-20",
    "filename": "src/test/java/org/apache/commons/io/FilenameUtilsTestCase.java",
    "is_vulnerable": 0,
    "class_name": "FilenameUtilsTestCase",
    "subclass_name": null,
    "function_name": "testEquals_fullControl()",
    "function_body": "{\n        assertFalse(FilenameUtils.equals(\"file.txt\", \"FILE.TXT\", true, IOCase.SENSITIVE));\n        assertTrue(FilenameUtils.equals(\"file.txt\", \"FILE.TXT\", true, IOCase.INSENSITIVE));\n        assertEquals(WINDOWS, FilenameUtils.equals(\"file.txt\", \"FILE.TXT\", true, IOCase.SYSTEM));\n        assertFalse(FilenameUtils.equals(\"file.txt\", \"FILE.TXT\", true, null));\n    }"
  },
  {
    "id": 13,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 34,
    "human_patch": "https://github.com/apache/commons-io/commit/2736b6fe0b3fa22ec8e2b4184897ecadb021fc78",
    "cve_id": "CVE-2021-29425",
    "cwe_id": "CWE-20",
    "filename": "src/test/java/org/apache/commons/io/FilenameUtilsTestCase.java",
    "is_vulnerable": 0,
    "class_name": "FilenameUtilsTestCase",
    "subclass_name": null,
    "function_name": "testIsExtension()",
    "function_body": "{\n        assertFalse(FilenameUtils.isExtension(null, (String) null));\n        assertFalse(FilenameUtils.isExtension(\"file.txt\", (String) null));\n        assertTrue(FilenameUtils.isExtension(\"file\", (String) null));\n        assertFalse(FilenameUtils.isExtension(\"file.txt\", \"\"));\n        assertTrue(FilenameUtils.isExtension(\"file\", \"\"));\n        assertTrue(FilenameUtils.isExtension(\"file.txt\", \"txt\"));\n        assertFalse(FilenameUtils.isExtension(\"file.txt\", \"rtf\"));\n\n        assertFalse(FilenameUtils.isExtension(\"a/b/file.txt\", (String) null));\n        assertFalse(FilenameUtils.isExtension(\"a/b/file.txt\", \"\"));\n        assertTrue(FilenameUtils.isExtension(\"a/b/file.txt\", \"txt\"));\n        assertFalse(FilenameUtils.isExtension(\"a/b/file.txt\", \"rtf\"));\n\n        assertFalse(FilenameUtils.isExtension(\"a.b/file.txt\", (String) null));\n        assertFalse(FilenameUtils.isExtension(\"a.b/file.txt\", \"\"));\n        assertTrue(FilenameUtils.isExtension(\"a.b/file.txt\", \"txt\"));\n        assertFalse(FilenameUtils.isExtension(\"a.b/file.txt\", \"rtf\"));\n\n        assertFalse(FilenameUtils.isExtension(\"a\\\\b\\\\file.txt\", (String) null));\n        assertFalse(FilenameUtils.isExtension(\"a\\\\b\\\\file.txt\", \"\"));\n        assertTrue(FilenameUtils.isExtension(\"a\\\\b\\\\file.txt\", \"txt\"));\n        assertFalse(FilenameUtils.isExtension(\"a\\\\b\\\\file.txt\", \"rtf\"));\n\n        assertFalse(FilenameUtils.isExtension(\"a.b\\\\file.txt\", (String) null));\n        assertFalse(FilenameUtils.isExtension(\"a.b\\\\file.txt\", \"\"));\n        assertTrue(FilenameUtils.isExtension(\"a.b\\\\file.txt\", \"txt\"));\n        assertFalse(FilenameUtils.isExtension(\"a.b\\\\file.txt\", \"rtf\"));\n\n        assertFalse(FilenameUtils.isExtension(\"a.b\\\\file.txt\", \"TXT\"));\n    }"
  },
  {
    "id": 13,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 35,
    "human_patch": "https://github.com/apache/commons-io/commit/2736b6fe0b3fa22ec8e2b4184897ecadb021fc78",
    "cve_id": "CVE-2021-29425",
    "cwe_id": "CWE-20",
    "filename": "src/test/java/org/apache/commons/io/FilenameUtilsTestCase.java",
    "is_vulnerable": 0,
    "class_name": "FilenameUtilsTestCase",
    "subclass_name": null,
    "function_name": "testIsExtension_injection()",
    "function_body": "{\n        try {\n            FilenameUtils.isExtension(\"a.b\\\\fi\\u0000le.txt\", \"TXT\");\n            fail(\"Should throw IAE\");\n        } catch (final IllegalArgumentException ignore) {\n        }\n    }"
  },
  {
    "id": 13,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 36,
    "human_patch": "https://github.com/apache/commons-io/commit/2736b6fe0b3fa22ec8e2b4184897ecadb021fc78",
    "cve_id": "CVE-2021-29425",
    "cwe_id": "CWE-20",
    "filename": "src/test/java/org/apache/commons/io/FilenameUtilsTestCase.java",
    "is_vulnerable": 0,
    "class_name": "FilenameUtilsTestCase",
    "subclass_name": null,
    "function_name": "testIsExtensionArray()",
    "function_body": "{\n        assertFalse(FilenameUtils.isExtension(null, (String[]) null));\n        assertFalse(FilenameUtils.isExtension(\"file.txt\", (String[]) null));\n        assertTrue(FilenameUtils.isExtension(\"file\", (String[]) null));\n        assertFalse(FilenameUtils.isExtension(\"file.txt\", new String[0]));\n        assertTrue(FilenameUtils.isExtension(\"file.txt\", new String[]{\"txt\"}));\n        assertFalse(FilenameUtils.isExtension(\"file.txt\", new String[]{\"rtf\"}));\n        assertTrue(FilenameUtils.isExtension(\"file\", new String[]{\"rtf\", \"\"}));\n        assertTrue(FilenameUtils.isExtension(\"file.txt\", new String[]{\"rtf\", \"txt\"}));\n\n        assertFalse(FilenameUtils.isExtension(\"a/b/file.txt\", (String[]) null));\n        assertFalse(FilenameUtils.isExtension(\"a/b/file.txt\", new String[0]));\n        assertTrue(FilenameUtils.isExtension(\"a/b/file.txt\", new String[]{\"txt\"}));\n        assertFalse(FilenameUtils.isExtension(\"a/b/file.txt\", new String[]{\"rtf\"}));\n        assertTrue(FilenameUtils.isExtension(\"a/b/file.txt\", new String[]{\"rtf\", \"txt\"}));\n\n        assertFalse(FilenameUtils.isExtension(\"a.b/file.txt\", (String[]) null));\n        assertFalse(FilenameUtils.isExtension(\"a.b/file.txt\", new String[0]));\n        assertTrue(FilenameUtils.isExtension(\"a.b/file.txt\", new String[]{\"txt\"}));\n        assertFalse(FilenameUtils.isExtension(\"a.b/file.txt\", new String[]{\"rtf\"}));\n        assertTrue(FilenameUtils.isExtension(\"a.b/file.txt\", new String[]{\"rtf\", \"txt\"}));\n\n        assertFalse(FilenameUtils.isExtension(\"a\\\\b\\\\file.txt\", (String[]) null));\n        assertFalse(FilenameUtils.isExtension(\"a\\\\b\\\\file.txt\", new String[0]));\n        assertTrue(FilenameUtils.isExtension(\"a\\\\b\\\\file.txt\", new String[]{\"txt\"}));\n        assertFalse(FilenameUtils.isExtension(\"a\\\\b\\\\file.txt\", new String[]{\"rtf\"}));\n        assertTrue(FilenameUtils.isExtension(\"a\\\\b\\\\file.txt\", new String[]{\"rtf\", \"txt\"}));\n\n        assertFalse(FilenameUtils.isExtension(\"a.b\\\\file.txt\", (String[]) null));\n        assertFalse(FilenameUtils.isExtension(\"a.b\\\\file.txt\", new String[0]));\n        assertTrue(FilenameUtils.isExtension(\"a.b\\\\file.txt\", new String[]{\"txt\"}));\n        assertFalse(FilenameUtils.isExtension(\"a.b\\\\file.txt\", new String[]{\"rtf\"}));\n        assertTrue(FilenameUtils.isExtension(\"a.b\\\\file.txt\", new String[]{\"rtf\", \"txt\"}));\n\n        assertFalse(FilenameUtils.isExtension(\"a.b\\\\file.txt\", new String[]{\"TXT\"}));\n        assertFalse(FilenameUtils.isExtension(\"a.b\\\\file.txt\", new String[]{\"TXT\", \"RTF\"}));\n    }"
  },
  {
    "id": 13,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 37,
    "human_patch": "https://github.com/apache/commons-io/commit/2736b6fe0b3fa22ec8e2b4184897ecadb021fc78",
    "cve_id": "CVE-2021-29425",
    "cwe_id": "CWE-20",
    "filename": "src/test/java/org/apache/commons/io/FilenameUtilsTestCase.java",
    "is_vulnerable": 0,
    "class_name": "FilenameUtilsTestCase",
    "subclass_name": null,
    "function_name": "testIsExtensionCollection()",
    "function_body": "{\n        assertFalse(FilenameUtils.isExtension(null, (Collection<String>) null));\n        assertFalse(FilenameUtils.isExtension(\"file.txt\", (Collection<String>) null));\n        assertTrue(FilenameUtils.isExtension(\"file\", (Collection<String>) null));\n        assertFalse(FilenameUtils.isExtension(\"file.txt\", new ArrayList<String>()));\n        assertTrue(FilenameUtils.isExtension(\"file.txt\", new ArrayList<>(Arrays.asList(new String[]{\"txt\"}))));\n        assertFalse(FilenameUtils.isExtension(\"file.txt\", new ArrayList<>(Arrays.asList(new String[]{\"rtf\"}))));\n        assertTrue(FilenameUtils.isExtension(\"file\", new ArrayList<>(Arrays.asList(new String[]{\"rtf\", \"\"}))));\n        assertTrue(FilenameUtils.isExtension(\"file.txt\", new ArrayList<>(Arrays.asList(new String[]{\"rtf\", \"txt\"}))));\n\n        assertFalse(FilenameUtils.isExtension(\"a/b/file.txt\", (Collection<String>) null));\n        assertFalse(FilenameUtils.isExtension(\"a/b/file.txt\", new ArrayList<String>()));\n        assertTrue(FilenameUtils.isExtension(\"a/b/file.txt\", new ArrayList<>(Arrays.asList(new String[]{\"txt\"}))));\n        assertFalse(FilenameUtils.isExtension(\"a/b/file.txt\", new ArrayList<>(Arrays.asList(new String[]{\"rtf\"}))));\n        assertTrue(FilenameUtils.isExtension(\"a/b/file.txt\", new ArrayList<>(Arrays.asList(new String[]{\"rtf\", \"txt\"}))));\n\n        assertFalse(FilenameUtils.isExtension(\"a.b/file.txt\", (Collection<String>) null));\n        assertFalse(FilenameUtils.isExtension(\"a.b/file.txt\", new ArrayList<String>()));\n        assertTrue(FilenameUtils.isExtension(\"a.b/file.txt\", new ArrayList<>(Arrays.asList(new String[]{\"txt\"}))));\n        assertFalse(FilenameUtils.isExtension(\"a.b/file.txt\", new ArrayList<>(Arrays.asList(new String[]{\"rtf\"}))));\n        assertTrue(FilenameUtils.isExtension(\"a.b/file.txt\", new ArrayList<>(Arrays.asList(new String[]{\"rtf\", \"txt\"}))));\n\n        assertFalse(FilenameUtils.isExtension(\"a\\\\b\\\\file.txt\", (Collection<String>) null));\n        assertFalse(FilenameUtils.isExtension(\"a\\\\b\\\\file.txt\", new ArrayList<String>()));\n        assertTrue(FilenameUtils.isExtension(\"a\\\\b\\\\file.txt\", new ArrayList<>(Arrays.asList(new String[]{\"txt\"}))));\n        assertFalse(FilenameUtils.isExtension(\"a\\\\b\\\\file.txt\", new ArrayList<>(Arrays.asList(new String[]{\"rtf\"}))));\n        assertTrue(FilenameUtils.isExtension(\"a\\\\b\\\\file.txt\", new ArrayList<>(Arrays.asList(new String[]{\"rtf\", \"txt\"}))));\n\n        assertFalse(FilenameUtils.isExtension(\"a.b\\\\file.txt\", (Collection<String>) null));\n        assertFalse(FilenameUtils.isExtension(\"a.b\\\\file.txt\", new ArrayList<String>()));\n        assertTrue(FilenameUtils.isExtension(\"a.b\\\\file.txt\", new ArrayList<>(Arrays.asList(new String[]{\"txt\"}))));\n        assertFalse(FilenameUtils.isExtension(\"a.b\\\\file.txt\", new ArrayList<>(Arrays.asList(new String[]{\"rtf\"}))));\n        assertTrue(FilenameUtils.isExtension(\"a.b\\\\file.txt\", new ArrayList<>(Arrays.asList(new String[]{\"rtf\", \"txt\"}))));\n\n        assertFalse(FilenameUtils.isExtension(\"a.b\\\\file.txt\", new ArrayList<>(Arrays.asList(new String[]{\"TXT\"}))));\n        assertFalse(FilenameUtils.isExtension(\"a.b\\\\file.txt\", new ArrayList<>(Arrays.asList(new String[]{\"TXT\", \"RTF\"}))));\n    }"
  },
  {
    "id": 14,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 0,
    "human_patch": "https://github.com/apache/cxf/commit/d9e2a6e7",
    "cve_id": "CVE-2016-8739",
    "cwe_id": "CWE-611",
    "filename": "rt/rs/extensions/providers/src/main/java/org/apache/cxf/jaxrs/provider/atom/AbstractAtomProvider.java",
    "is_vulnerable": 0,
    "class_name": "AbstractAtomProvider",
    "subclass_name": null,
    "function_name": "getSize(T element, Class<?> type, Type genericType, Annotation[] annotations, MediaType mt)",
    "function_body": "{\n        return -1;\n    }"
  },
  {
    "id": 14,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 1,
    "human_patch": "https://github.com/apache/cxf/commit/d9e2a6e7",
    "cve_id": "CVE-2016-8739",
    "cwe_id": "CWE-611",
    "filename": "rt/rs/extensions/providers/src/main/java/org/apache/cxf/jaxrs/provider/atom/AbstractAtomProvider.java",
    "is_vulnerable": 0,
    "class_name": "AbstractAtomProvider",
    "subclass_name": null,
    "function_name": "writeTo(T element, Class<?> clazz, Type type, Annotation[] a, \n                        MediaType mt, MultivaluedMap<String, Object> headers, OutputStream os) throws IOException",
    "function_body": "{\n        if (MediaType.APPLICATION_JSON_TYPE.isCompatible(mt)) {\n            Writer w = createWriter(\"json\");\n            if (w == null) {\n                throw ExceptionUtils.toNotSupportedException(null, null);\n            }\n            element.writeTo(w, os);   \n        } else if (formattedOutput) {\n            Writer w = createWriter(\"prettyxml\");\n            if (w != null) {\n                element.writeTo(w, os);\n            } else {\n                element.writeTo(os);\n            }\n        } else {\n            element.writeTo(os);\n        }\n    }"
  },
  {
    "id": 14,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 2,
    "human_patch": "https://github.com/apache/cxf/commit/d9e2a6e7",
    "cve_id": "CVE-2016-8739",
    "cwe_id": "CWE-611",
    "filename": "rt/rs/extensions/providers/src/main/java/org/apache/cxf/jaxrs/provider/atom/AbstractAtomProvider.java",
    "is_vulnerable": 0,
    "class_name": "AbstractAtomProvider",
    "subclass_name": null,
    "function_name": "createWriter(String writerName)",
    "function_body": "{\n        Writer w = ATOM_ENGINE.getWriterFactory().getWriter(writerName);\n        if (w == null) {\n            LOG.fine(\"Atom writer \\\"\" + writerName + \"\\\" is not available\");\n        }\n        return w;\n    }"
  },
  {
    "id": 14,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 3,
    "human_patch": "https://github.com/apache/cxf/commit/d9e2a6e7",
    "cve_id": "CVE-2016-8739",
    "cwe_id": "CWE-611",
    "filename": "rt/rs/extensions/providers/src/main/java/org/apache/cxf/jaxrs/provider/atom/AbstractAtomProvider.java",
    "is_vulnerable": 1,
    "class_name": "AbstractAtomProvider",
    "subclass_name": null,
    "function_name": "readFrom(Class<T> clazz, Type t, Annotation[] a, MediaType mt, \n                         MultivaluedMap<String, String> headers, InputStream is) throws IOException",
    "function_body": "{\n        Parser parser = ATOM_ENGINE.getParser();\n        synchronized (parser) {\n            ParserOptions options = parser.getDefaultParserOptions();\n            if (options != null) {\n                options.setAutodetectCharset(autodetectCharset);\n                options.setResolveEntities(false);\n            }\n        }\n        Document<T> doc = parser.parse(is);\n        return doc.getRoot();\n    }"
  },
  {
    "id": 14,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 4,
    "human_patch": "https://github.com/apache/cxf/commit/d9e2a6e7",
    "cve_id": "CVE-2016-8739",
    "cwe_id": "CWE-611",
    "filename": "rt/rs/extensions/providers/src/main/java/org/apache/cxf/jaxrs/provider/atom/AbstractAtomProvider.java",
    "is_vulnerable": 0,
    "class_name": "AbstractAtomProvider",
    "subclass_name": null,
    "function_name": "setFormattedOutput(boolean formattedOutput)",
    "function_body": "{\n        this.formattedOutput = formattedOutput;\n    }"
  },
  {
    "id": 14,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 5,
    "human_patch": "https://github.com/apache/cxf/commit/d9e2a6e7",
    "cve_id": "CVE-2016-8739",
    "cwe_id": "CWE-611",
    "filename": "rt/rs/extensions/providers/src/main/java/org/apache/cxf/jaxrs/provider/atom/AbstractAtomProvider.java",
    "is_vulnerable": 0,
    "class_name": "AbstractAtomProvider",
    "subclass_name": null,
    "function_name": "setAutodetectCharset(boolean autodetectCharset)",
    "function_body": "{\n        this.autodetectCharset = autodetectCharset;\n    }"
  },
  {
    "id": 14,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 0,
    "human_patch": "https://github.com/apache/cxf/commit/d9e2a6e7",
    "cve_id": "CVE-2016-8739",
    "cwe_id": "CWE-611",
    "filename": "rt/rs/extensions/providers/src/test/java/org/apache/cxf/jaxrs/provider/atom/AtomPojoProviderTest.java",
    "is_vulnerable": 0,
    "class_name": "AtomPojoProviderTest",
    "subclass_name": null,
    "function_name": "setUp()",
    "function_body": "{\n        ctx = \n            new ClassPathXmlApplicationContext(\n                new String[] {\"/org/apache/cxf/jaxrs/provider/atom/servers.xml\"});\n    }"
  },
  {
    "id": 14,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 1,
    "human_patch": "https://github.com/apache/cxf/commit/d9e2a6e7",
    "cve_id": "CVE-2016-8739",
    "cwe_id": "CWE-611",
    "filename": "rt/rs/extensions/providers/src/test/java/org/apache/cxf/jaxrs/provider/atom/AtomPojoProviderTest.java",
    "is_vulnerable": 0,
    "class_name": "AtomPojoProviderTest",
    "subclass_name": null,
    "function_name": "testWriteFeedWithBuilders() throws Exception",
    "function_body": "{\n        AtomPojoProvider provider = (AtomPojoProvider)ctx.getBean(\"atom\");\n        assertNotNull(provider);\n        provider.setFormattedOutput(true);\n        ByteArrayOutputStream bos = new ByteArrayOutputStream();\n        \n        Books books = new Books();\n        List<Book> bs = new ArrayList<Book>();\n        bs.add(new Book(\"a\"));\n        bs.add(new Book(\"b\"));\n        books.setBooks(bs);\n        provider.writeTo(books, Books.class, Books.class, new Annotation[]{},\n                         MediaType.valueOf(\"application/atom+xml\"), null, bos);\n        ByteArrayInputStream bis = new ByteArrayInputStream(bos.toByteArray());\n        Feed feed = new AtomFeedProvider().readFrom(Feed.class, null, null, null, null, bis);\n        assertEquals(\"Books\", feed.getTitle()); \n        List<Entry> entries = feed.getEntries();\n        assertEquals(2, entries.size());\n        verifyEntry(getEntry(entries, \"a\"), \"a\");\n        verifyEntry(getEntry(entries, \"b\"), \"b\");\n    }"
  },
  {
    "id": 14,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 2,
    "human_patch": "https://github.com/apache/cxf/commit/d9e2a6e7",
    "cve_id": "CVE-2016-8739",
    "cwe_id": "CWE-611",
    "filename": "rt/rs/extensions/providers/src/test/java/org/apache/cxf/jaxrs/provider/atom/AtomPojoProviderTest.java",
    "is_vulnerable": 0,
    "class_name": "AtomPojoProviderTest",
    "subclass_name": null,
    "function_name": "testWriteFeedWithBuildersNoJaxb() throws Exception",
    "function_body": "{\n        AtomPojoProvider provider = (AtomPojoProvider)ctx.getBean(\"atomNoJaxb\");\n        assertNotNull(provider);\n        provider.setFormattedOutput(true);\n        ByteArrayOutputStream bos = new ByteArrayOutputStream();\n        \n        Books books = new Books();\n        List<Book> bs = new ArrayList<Book>();\n        bs.add(new Book(\"a\"));\n        bs.add(new Book(\"b\"));\n        books.setBooks(bs);\n        provider.writeTo(books, Books.class, Books.class, new Annotation[]{},\n                         MediaType.valueOf(\"application/atom+xml\"), null, bos);\n        ByteArrayInputStream bis = new ByteArrayInputStream(bos.toByteArray());\n        Feed feed = new AtomFeedProvider().readFrom(Feed.class, null, null, null, null, bis);\n        assertEquals(\"Books\", feed.getTitle()); \n        List<Entry> entries = feed.getEntries();\n        assertEquals(2, entries.size());\n        \n        Entry entryA = getEntry(entries, \"a\");\n        verifyEntry(entryA, \"a\");\n        String entryAContent = entryA.getContent();\n        assertTrue(\"<a/>\".equals(entryAContent) || \"<a><a/>\".equals(entryAContent)\n                   || \"<a xmlns=\\\"\\\"/>\".equals(entryAContent));\n        \n        Entry entryB = getEntry(entries, \"b\");\n        verifyEntry(entryB, \"b\");\n        String entryBContent = entryB.getContent();\n        assertTrue(\"<b/>\".equals(entryBContent) || \"<b><b/>\".equals(entryBContent)\n                   || \"<b xmlns=\\\"\\\"/>\".equals(entryBContent));\n    }"
  },
  {
    "id": 14,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 3,
    "human_patch": "https://github.com/apache/cxf/commit/d9e2a6e7",
    "cve_id": "CVE-2016-8739",
    "cwe_id": "CWE-611",
    "filename": "rt/rs/extensions/providers/src/test/java/org/apache/cxf/jaxrs/provider/atom/AtomPojoProviderTest.java",
    "is_vulnerable": 0,
    "class_name": "AtomPojoProviderTest",
    "subclass_name": null,
    "function_name": "testWriteEntryWithBuilders() throws Exception",
    "function_body": "{\n        AtomPojoProvider provider = (AtomPojoProvider)ctx.getBean(\"atom2\");\n        assertNotNull(provider);\n        provider.setFormattedOutput(true);\n        ByteArrayOutputStream bos = new ByteArrayOutputStream();\n        provider.writeTo(new Book(\"a\"), Book.class, Book.class, new Annotation[]{},\n                         MediaType.valueOf(\"application/atom+xml;type=entry\"), null, bos);\n        ByteArrayInputStream bis = new ByteArrayInputStream(bos.toByteArray());\n        Entry entry = new AtomEntryProvider().readFrom(Entry.class, null, null, null, null, bis);\n        verifyEntry(entry, \"a\");\n        \n    }"
  },
  {
    "id": 14,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 4,
    "human_patch": "https://github.com/apache/cxf/commit/d9e2a6e7",
    "cve_id": "CVE-2016-8739",
    "cwe_id": "CWE-611",
    "filename": "rt/rs/extensions/providers/src/test/java/org/apache/cxf/jaxrs/provider/atom/AtomPojoProviderTest.java",
    "is_vulnerable": 0,
    "class_name": "AtomPojoProviderTest",
    "subclass_name": null,
    "function_name": "testReadEntryWithBuilders() throws Exception",
    "function_body": "{\n        AtomPojoProvider provider = (AtomPojoProvider)ctx.getBean(\"atom3\");\n        assertNotNull(provider);\n        doTestReadEntry(provider);\n    }"
  },
  {
    "id": 14,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 5,
    "human_patch": "https://github.com/apache/cxf/commit/d9e2a6e7",
    "cve_id": "CVE-2016-8739",
    "cwe_id": "CWE-611",
    "filename": "rt/rs/extensions/providers/src/test/java/org/apache/cxf/jaxrs/provider/atom/AtomPojoProviderTest.java",
    "is_vulnerable": 0,
    "class_name": "AtomPojoProviderTest",
    "subclass_name": null,
    "function_name": "testReadEntryWithoutBuilders() throws Exception",
    "function_body": "{\n        doTestReadEntry(new AtomPojoProvider());\n    }"
  },
  {
    "id": 14,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 6,
    "human_patch": "https://github.com/apache/cxf/commit/d9e2a6e7",
    "cve_id": "CVE-2016-8739",
    "cwe_id": "CWE-611",
    "filename": "rt/rs/extensions/providers/src/test/java/org/apache/cxf/jaxrs/provider/atom/AtomPojoProviderTest.java",
    "is_vulnerable": 0,
    "class_name": "AtomPojoProviderTest",
    "subclass_name": null,
    "function_name": "doTestReadEntry(AtomPojoProvider provider) throws Exception",
    "function_body": "{\n        provider.setFormattedOutput(true);\n        ByteArrayOutputStream bos = new ByteArrayOutputStream();\n        MediaType mt = MediaType.valueOf(\"application/atom+xml;type=entry\");\n        provider.writeTo(new Book(\"a\"), Book.class, Book.class, new Annotation[]{}, mt, null, bos);\n        ByteArrayInputStream bis = new ByteArrayInputStream(bos.toByteArray());\n        @SuppressWarnings({\"unchecked\", \"rawtypes\" })\n        Book book = (Book)provider.readFrom((Class)Book.class, Book.class, \n                                            new Annotation[]{}, mt, null, bis);\n        assertEquals(\"a\", book.getName());\n    }"
  },
  {
    "id": 14,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 7,
    "human_patch": "https://github.com/apache/cxf/commit/d9e2a6e7",
    "cve_id": "CVE-2016-8739",
    "cwe_id": "CWE-611",
    "filename": "rt/rs/extensions/providers/src/test/java/org/apache/cxf/jaxrs/provider/atom/AtomPojoProviderTest.java",
    "is_vulnerable": 0,
    "class_name": "AtomPojoProviderTest",
    "subclass_name": null,
    "function_name": "testReadFeedWithBuilders() throws Exception",
    "function_body": "{\n        AtomPojoProvider provider = (AtomPojoProvider)ctx.getBean(\"atom4\");\n        assertNotNull(provider);\n        doTestReadFeed(provider);\n    }"
  },
  {
    "id": 14,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 8,
    "human_patch": "https://github.com/apache/cxf/commit/d9e2a6e7",
    "cve_id": "CVE-2016-8739",
    "cwe_id": "CWE-611",
    "filename": "rt/rs/extensions/providers/src/test/java/org/apache/cxf/jaxrs/provider/atom/AtomPojoProviderTest.java",
    "is_vulnerable": 0,
    "class_name": "AtomPojoProviderTest",
    "subclass_name": null,
    "function_name": "testReadFeedWithoutBuilders() throws Exception",
    "function_body": "{\n        AtomPojoProvider provider = new AtomPojoProvider();\n        doTestReadFeed(provider);\n    }"
  },
  {
    "id": 14,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 9,
    "human_patch": "https://github.com/apache/cxf/commit/d9e2a6e7",
    "cve_id": "CVE-2016-8739",
    "cwe_id": "CWE-611",
    "filename": "rt/rs/extensions/providers/src/test/java/org/apache/cxf/jaxrs/provider/atom/AtomPojoProviderTest.java",
    "is_vulnerable": 0,
    "class_name": "AtomPojoProviderTest",
    "subclass_name": null,
    "function_name": "doTestReadFeed(AtomPojoProvider provider) throws Exception",
    "function_body": "{\n        ByteArrayOutputStream bos = new ByteArrayOutputStream();\n        MediaType mt = MediaType.valueOf(\"application/atom+xml;type=feed\");\n        Books books = new Books();\n        List<Book> bs = new ArrayList<Book>();\n        bs.add(new Book(\"a\"));\n        bs.add(new Book(\"b\"));\n        books.setBooks(bs);\n        provider.writeTo(books, Books.class, Books.class, new Annotation[]{}, mt, null, bos);\n        ByteArrayInputStream bis = new ByteArrayInputStream(bos.toByteArray());\n        @SuppressWarnings({\"unchecked\", \"rawtypes\" })\n        Books books2 = (Books)provider.readFrom((Class)Books.class, Books.class, \n                                            new Annotation[]{}, mt, null, bis);\n        List<Book> list = books2.getBooks();\n        assertEquals(2, list.size());\n        assertTrue(\"a\".equals(list.get(0).getName()) || \"a\".equals(list.get(1).getName()));\n        assertTrue(\"b\".equals(list.get(0).getName()) || \"b\".equals(list.get(1).getName()));        \n    }"
  },
  {
    "id": 14,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 10,
    "human_patch": "https://github.com/apache/cxf/commit/d9e2a6e7",
    "cve_id": "CVE-2016-8739",
    "cwe_id": "CWE-611",
    "filename": "rt/rs/extensions/providers/src/test/java/org/apache/cxf/jaxrs/provider/atom/AtomPojoProviderTest.java",
    "is_vulnerable": 0,
    "class_name": "AtomPojoProviderTest",
    "subclass_name": null,
    "function_name": "testReadEntryNoContent() throws Exception",
    "function_body": "{\n        \n        final String entryNoContent =\n            \"<?xml version='1.0' encoding='UTF-8'?>\\n\" \n            + \"<entry xmlns=\\\"http://www.w3.org/2005/Atom\\\">\\n\" \n            + \"  <id>84297856</id>\\n\" \n            + \"</entry>\";\n\n        AtomPojoProvider atomPojoProvider = new AtomPojoProvider();\n        @SuppressWarnings({\n            \"rawtypes\", \"unchecked\"\n        })\n        JaxbDataType type = (JaxbDataType)atomPojoProvider.readFrom((Class)JaxbDataType.class,\n                                  JaxbDataType.class,\n                                  new Annotation[0],\n                                  MediaType.valueOf(\"application/atom+xml;type=entry\"),\n                                  new MetadataMap<String, String>(),\n                                  new ByteArrayInputStream(entryNoContent.getBytes(StandardCharsets.UTF_8)));\n        assertNull(type);\n    }"
  },
  {
    "id": 14,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 11,
    "human_patch": "https://github.com/apache/cxf/commit/d9e2a6e7",
    "cve_id": "CVE-2016-8739",
    "cwe_id": "CWE-611",
    "filename": "rt/rs/extensions/providers/src/test/java/org/apache/cxf/jaxrs/provider/atom/AtomPojoProviderTest.java",
    "is_vulnerable": 0,
    "class_name": "AtomPojoProviderTest",
    "subclass_name": null,
    "function_name": "testReadEntryWithUpperCaseTypeParam() throws Exception",
    "function_body": "{\n        doReadEntryWithContent(\"application/atom+xml;type=ENTRY\");\n    }"
  },
  {
    "id": 14,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 12,
    "human_patch": "https://github.com/apache/cxf/commit/d9e2a6e7",
    "cve_id": "CVE-2016-8739",
    "cwe_id": "CWE-611",
    "filename": "rt/rs/extensions/providers/src/test/java/org/apache/cxf/jaxrs/provider/atom/AtomPojoProviderTest.java",
    "is_vulnerable": 0,
    "class_name": "AtomPojoProviderTest",
    "subclass_name": null,
    "function_name": "testReadEntryNoTypeParam() throws Exception",
    "function_body": "{\n        doReadEntryWithContent(\"application/atom+xml\");\n    }"
  },
  {
    "id": 14,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 13,
    "human_patch": "https://github.com/apache/cxf/commit/d9e2a6e7",
    "cve_id": "CVE-2016-8739",
    "cwe_id": "CWE-611",
    "filename": "rt/rs/extensions/providers/src/test/java/org/apache/cxf/jaxrs/provider/atom/AtomPojoProviderTest.java",
    "is_vulnerable": 0,
    "class_name": "AtomPojoProviderTest",
    "subclass_name": null,
    "function_name": "doReadEntryWithContent(String mediaType) throws Exception",
    "function_body": "{\n        final String entryWithContent =\n            \"<?xml version='1.0' encoding='UTF-8'?>\\n\" \n            + \"<entry xmlns=\\\"http://www.w3.org/2005/Atom\\\">\\n\" \n            + \"  <id>84297856</id>\\n\" \n            + \"  <content type=\\\"application/xml\\\">\\n\" \n            + \"    <jaxbDataType xmlns=\\\"\\\">\\n\" \n            + \"    </jaxbDataType>\\n\" \n            + \"  </content>\\n\" \n            + \"</entry>\";\n\n        AtomPojoProvider atomPojoProvider = new AtomPojoProvider();\n        @SuppressWarnings({\n            \"rawtypes\", \"unchecked\"\n        })\n        JaxbDataType type = (JaxbDataType)atomPojoProvider.readFrom((Class)JaxbDataType.class,\n                                  JaxbDataType.class,\n                                  new Annotation[0],\n                                  MediaType.valueOf(mediaType),\n                                  new MetadataMap<String, String>(),\n                                  new ByteArrayInputStream(entryWithContent.getBytes(StandardCharsets.UTF_8)));\n        assertNotNull(type);\n    }"
  },
  {
    "id": 14,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 14,
    "human_patch": "https://github.com/apache/cxf/commit/d9e2a6e7",
    "cve_id": "CVE-2016-8739",
    "cwe_id": "CWE-611",
    "filename": "rt/rs/extensions/providers/src/test/java/org/apache/cxf/jaxrs/provider/atom/AtomPojoProviderTest.java",
    "is_vulnerable": 0,
    "class_name": "AtomPojoProviderTest",
    "subclass_name": null,
    "function_name": "getEntry(List<Entry> entries, String title)",
    "function_body": "{\n        for (Entry e : entries) {\n            if (title.equals(e.getTitle())) {\n                return e;\n            }\n        }\n        return null;\n    }"
  },
  {
    "id": 14,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 15,
    "human_patch": "https://github.com/apache/cxf/commit/d9e2a6e7",
    "cve_id": "CVE-2016-8739",
    "cwe_id": "CWE-611",
    "filename": "rt/rs/extensions/providers/src/test/java/org/apache/cxf/jaxrs/provider/atom/AtomPojoProviderTest.java",
    "is_vulnerable": 0,
    "class_name": "AtomPojoProviderTest",
    "subclass_name": null,
    "function_name": "verifyEntry(Entry e, String title)",
    "function_body": "{\n        assertNotNull(e);\n        assertEquals(title, e.getTitle());\n    }"
  },
  {
    "id": 14,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 16,
    "human_patch": "https://github.com/apache/cxf/commit/d9e2a6e7",
    "cve_id": "CVE-2016-8739",
    "cwe_id": "CWE-611",
    "filename": "rt/rs/extensions/providers/src/test/java/org/apache/cxf/jaxrs/provider/atom/AtomPojoProviderTest.java",
    "is_vulnerable": 0,
    "class_name": "AtomPojoProviderTest",
    "subclass_name": "CustomFeedWriter",
    "function_name": "writeTo(Feed feed, Books pojoFeed)",
    "function_body": "{\n            feed.setTitle(\"Books\");\n        }"
  },
  {
    "id": 14,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 17,
    "human_patch": "https://github.com/apache/cxf/commit/d9e2a6e7",
    "cve_id": "CVE-2016-8739",
    "cwe_id": "CWE-611",
    "filename": "rt/rs/extensions/providers/src/test/java/org/apache/cxf/jaxrs/provider/atom/AtomPojoProviderTest.java",
    "is_vulnerable": 0,
    "class_name": "AtomPojoProviderTest",
    "subclass_name": "CustomEntryWriter",
    "function_name": "writeTo(Entry entry, Book pojoEntry)",
    "function_body": "{\n            entry.setTitle(pojoEntry.getName());\n        }"
  },
  {
    "id": 14,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 18,
    "human_patch": "https://github.com/apache/cxf/commit/d9e2a6e7",
    "cve_id": "CVE-2016-8739",
    "cwe_id": "CWE-611",
    "filename": "rt/rs/extensions/providers/src/test/java/org/apache/cxf/jaxrs/provider/atom/AtomPojoProviderTest.java",
    "is_vulnerable": 0,
    "class_name": "AtomPojoProviderTest",
    "subclass_name": "CustomEntryReader",
    "function_name": "readFrom(Entry element)",
    "function_body": "{\n            try {\n                String s = element.getContent();\n                                \n                Unmarshaller um = \n                    new JAXBElementProvider<Book>().getJAXBContext(Book.class, Book.class)\n                        .createUnmarshaller();\n                return (Book)um.unmarshal(new StringReader(s));\n            } catch (Exception ex) {\n                \n            }\n            return null;\n        }"
  },
  {
    "id": 14,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 19,
    "human_patch": "https://github.com/apache/cxf/commit/d9e2a6e7",
    "cve_id": "CVE-2016-8739",
    "cwe_id": "CWE-611",
    "filename": "rt/rs/extensions/providers/src/test/java/org/apache/cxf/jaxrs/provider/atom/AtomPojoProviderTest.java",
    "is_vulnerable": 0,
    "class_name": "AtomPojoProviderTest",
    "subclass_name": "CustomFeedReader",
    "function_name": "readFrom(Feed element)",
    "function_body": "{\n            Books books = new Books();\n            List<Book> list = new ArrayList<Book>();\n            CustomEntryReader entryReader = new CustomEntryReader();\n            for (Entry e : element.getEntries()) {\n                list.add(entryReader.readFrom(e));\n            }\n            books.setBooks(list);\n            return books;\n        }"
  },
  {
    "id": 14,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 20,
    "human_patch": "https://github.com/apache/cxf/commit/d9e2a6e7",
    "cve_id": "CVE-2016-8739",
    "cwe_id": "CWE-611",
    "filename": "rt/rs/extensions/providers/src/test/java/org/apache/cxf/jaxrs/provider/atom/AtomPojoProviderTest.java",
    "is_vulnerable": 0,
    "class_name": "AtomPojoProviderTest",
    "subclass_name": "CustomFeedBuilder",
    "function_name": "getBaseUri(Books books)",
    "function_body": "{\n            return \"http://books\";\n        }"
  },
  {
    "id": 14,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 21,
    "human_patch": "https://github.com/apache/cxf/commit/d9e2a6e7",
    "cve_id": "CVE-2016-8739",
    "cwe_id": "CWE-611",
    "filename": "rt/rs/extensions/providers/src/test/java/org/apache/cxf/jaxrs/provider/atom/AtomPojoProviderTest.java",
    "is_vulnerable": 0,
    "class_name": "AtomPojoProviderTest",
    "subclass_name": "CustomEntryBuilder",
    "function_name": "getBaseUri(Book books)",
    "function_body": "{\n            return \"http://book\";\n        }"
  },
  {
    "id": 14,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 22,
    "human_patch": "https://github.com/apache/cxf/commit/d9e2a6e7",
    "cve_id": "CVE-2016-8739",
    "cwe_id": "CWE-611",
    "filename": "rt/rs/extensions/providers/src/test/java/org/apache/cxf/jaxrs/provider/atom/AtomPojoProviderTest.java",
    "is_vulnerable": 0,
    "class_name": "AtomPojoProviderTest",
    "subclass_name": "Book",
    "function_name": "setName(String name)",
    "function_body": "{\n            this.name = name;\n        }"
  },
  {
    "id": 14,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 23,
    "human_patch": "https://github.com/apache/cxf/commit/d9e2a6e7",
    "cve_id": "CVE-2016-8739",
    "cwe_id": "CWE-611",
    "filename": "rt/rs/extensions/providers/src/test/java/org/apache/cxf/jaxrs/provider/atom/AtomPojoProviderTest.java",
    "is_vulnerable": 0,
    "class_name": "AtomPojoProviderTest",
    "subclass_name": "Book",
    "function_name": "getName()",
    "function_body": "{\n            return name;\n        }"
  },
  {
    "id": 14,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 24,
    "human_patch": "https://github.com/apache/cxf/commit/d9e2a6e7",
    "cve_id": "CVE-2016-8739",
    "cwe_id": "CWE-611",
    "filename": "rt/rs/extensions/providers/src/test/java/org/apache/cxf/jaxrs/provider/atom/AtomPojoProviderTest.java",
    "is_vulnerable": 0,
    "class_name": "AtomPojoProviderTest",
    "subclass_name": "Book",
    "function_name": "getXMLContent()",
    "function_body": "{\n            return \"<\" + name + \"/>\";\n        }"
  },
  {
    "id": 14,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 25,
    "human_patch": "https://github.com/apache/cxf/commit/d9e2a6e7",
    "cve_id": "CVE-2016-8739",
    "cwe_id": "CWE-611",
    "filename": "rt/rs/extensions/providers/src/test/java/org/apache/cxf/jaxrs/provider/atom/AtomPojoProviderTest.java",
    "is_vulnerable": 0,
    "class_name": "AtomPojoProviderTest",
    "subclass_name": "Books",
    "function_name": "getBooks()",
    "function_body": "{\n            return books;\n        }"
  },
  {
    "id": 14,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 26,
    "human_patch": "https://github.com/apache/cxf/commit/d9e2a6e7",
    "cve_id": "CVE-2016-8739",
    "cwe_id": "CWE-611",
    "filename": "rt/rs/extensions/providers/src/test/java/org/apache/cxf/jaxrs/provider/atom/AtomPojoProviderTest.java",
    "is_vulnerable": 0,
    "class_name": "AtomPojoProviderTest",
    "subclass_name": "Books",
    "function_name": "setBooks(List<Book> list)",
    "function_body": "{\n            books = list;\n        }"
  },
  {
    "id": 15,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 0,
    "human_patch": "https://github.com/apache/cxf/commit/845eccb6484b43ba02875c71e824db23ae4f20c0",
    "cve_id": "CVE-2015-5253",
    "cwe_id": "CWE-264",
    "filename": "rt/rs/security/sso/saml/src/main/java/org/apache/cxf/rs/security/saml/sso/SAMLSSOResponseValidator.java",
    "is_vulnerable": 0,
    "class_name": "SAMLSSOResponseValidator",
    "subclass_name": null,
    "function_name": "setEnforceAssertionsSigned(boolean enforceAssertionsSigned)",
    "function_body": "{\n        this.enforceAssertionsSigned = enforceAssertionsSigned;\n    }"
  },
  {
    "id": 15,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 1,
    "human_patch": "https://github.com/apache/cxf/commit/845eccb6484b43ba02875c71e824db23ae4f20c0",
    "cve_id": "CVE-2015-5253",
    "cwe_id": "CWE-264",
    "filename": "rt/rs/security/sso/saml/src/main/java/org/apache/cxf/rs/security/saml/sso/SAMLSSOResponseValidator.java",
    "is_vulnerable": 0,
    "class_name": "SAMLSSOResponseValidator",
    "subclass_name": null,
    "function_name": "setEnforceKnownIssuer(boolean enforceKnownIssuer)",
    "function_body": "{\n        this.enforceKnownIssuer = enforceKnownIssuer;\n    }"
  },
  {
    "id": 15,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 2,
    "human_patch": "https://github.com/apache/cxf/commit/845eccb6484b43ba02875c71e824db23ae4f20c0",
    "cve_id": "CVE-2015-5253",
    "cwe_id": "CWE-264",
    "filename": "rt/rs/security/sso/saml/src/main/java/org/apache/cxf/rs/security/saml/sso/SAMLSSOResponseValidator.java",
    "is_vulnerable": 1,
    "class_name": "SAMLSSOResponseValidator",
    "subclass_name": null,
    "function_name": "validateSamlResponse(\n        org.opensaml.saml.saml2.core.Response samlResponse,\n        boolean postBinding\n    ) throws WSSecurityException",
    "function_body": "{\n        \n        validateIssuer(samlResponse.getIssuer());\n\n        \n        if (samlResponse.getAssertions() == null || samlResponse.getAssertions().isEmpty()) {\n            LOG.fine(\"The Response must contain at least one Assertion\");\n            throw new WSSecurityException(WSSecurityException.ErrorCode.FAILURE, \"invalidSAMLsecurity\");\n        }\n        \n        \n        \n        String destination = samlResponse.getDestination();\n        if (samlResponse.isSigned()\n            && (destination == null || !destination.equals(assertionConsumerURL))) {\n            LOG.fine(\"The Response must contain a destination that matches the assertion consumer URL\");\n            throw new WSSecurityException(WSSecurityException.ErrorCode.FAILURE, \"invalidSAMLsecurity\");\n        }\n        \n        \n        boolean foundValidSubject = false;\n        Date sessionNotOnOrAfter = null;\n        for (org.opensaml.saml.saml2.core.Assertion assertion : samlResponse.getAssertions()) {\n            \n            if (assertion.getIssuer() == null) {\n                LOG.fine(\"Assertion Issuer must not be null\");\n                throw new WSSecurityException(WSSecurityException.ErrorCode.FAILURE, \"invalidSAMLsecurity\");\n            }\n            validateIssuer(assertion.getIssuer());\n            \n            if (enforceAssertionsSigned && postBinding && assertion.getSignature() == null) {\n                LOG.fine(\"If the HTTP Post binding is used to deliver the Response, \"\n                         + \"the enclosed assertions must be signed\");\n                throw new WSSecurityException(WSSecurityException.ErrorCode.FAILURE, \"invalidSAMLsecurity\");\n            }\n            \n            \n            if (assertion.getAuthnStatements() != null\n                && !assertion.getAuthnStatements().isEmpty()) {\n                org.opensaml.saml.saml2.core.Subject subject = assertion.getSubject();\n                if (validateAuthenticationSubject(subject, assertion.getID(), postBinding)) {\n                    validateAudienceRestrictionCondition(assertion.getConditions());\n                    foundValidSubject = true;\n                    \n                    for (AuthnStatement authnStatment : assertion.getAuthnStatements()) {\n                        if (authnStatment.getSessionNotOnOrAfter() != null) {\n                            sessionNotOnOrAfter = authnStatment.getSessionNotOnOrAfter().toDate();\n                        }\n                    }\n                }\n            }\n            \n        }\n        \n        if (!foundValidSubject) {\n            LOG.fine(\"The Response did not contain any Authentication Statement that matched \"\n                     + \"the Subject Confirmation criteria\");\n            throw new WSSecurityException(WSSecurityException.ErrorCode.FAILURE, \"invalidSAMLsecurity\");\n        }\n        \n        SSOValidatorResponse validatorResponse = new SSOValidatorResponse();\n        validatorResponse.setResponseId(samlResponse.getID());\n        validatorResponse.setSessionNotOnOrAfter(sessionNotOnOrAfter);\n        if (samlResponse.getIssueInstant() != null) {\n            validatorResponse.setCreated(samlResponse.getIssueInstant().toDate());\n        }\n        \n        \n        Element assertionElement = samlResponse.getAssertions().get(0).getDOM();\n        Element clonedAssertionElement = (Element)assertionElement.cloneNode(true);\n        validatorResponse.setAssertionElement(clonedAssertionElement);\n        validatorResponse.setAssertion(DOM2Writer.nodeToString(clonedAssertionElement));\n        \n        return validatorResponse;\n    }"
  },
  {
    "id": 15,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 3,
    "human_patch": "https://github.com/apache/cxf/commit/845eccb6484b43ba02875c71e824db23ae4f20c0",
    "cve_id": "CVE-2015-5253",
    "cwe_id": "CWE-264",
    "filename": "rt/rs/security/sso/saml/src/main/java/org/apache/cxf/rs/security/saml/sso/SAMLSSOResponseValidator.java",
    "is_vulnerable": 0,
    "class_name": "SAMLSSOResponseValidator",
    "subclass_name": null,
    "function_name": "validateIssuer(org.opensaml.saml.saml2.core.Issuer issuer) throws WSSecurityException",
    "function_body": "{\n        if (issuer == null) {\n            return;\n        }\n        \n        \n        if (enforceKnownIssuer && !issuerIDP.startsWith(issuer.getValue())) {\n            LOG.fine(\"Issuer value: \" + issuer.getValue() + \" does not match issuer IDP: \" \n                + issuerIDP);\n            throw new WSSecurityException(WSSecurityException.ErrorCode.FAILURE, \"invalidSAMLsecurity\");\n        }\n        \n        \n        if (issuer.getFormat() != null\n            && !SAML2Constants.NAMEID_FORMAT_ENTITY.equals(issuer.getFormat())) {\n            LOG.fine(\"Issuer format is not null and does not equal: \" \n                + SAML2Constants.NAMEID_FORMAT_ENTITY);\n            throw new WSSecurityException(WSSecurityException.ErrorCode.FAILURE, \"invalidSAMLsecurity\");\n        }\n    }"
  },
  {
    "id": 15,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 4,
    "human_patch": "https://github.com/apache/cxf/commit/845eccb6484b43ba02875c71e824db23ae4f20c0",
    "cve_id": "CVE-2015-5253",
    "cwe_id": "CWE-264",
    "filename": "rt/rs/security/sso/saml/src/main/java/org/apache/cxf/rs/security/saml/sso/SAMLSSOResponseValidator.java",
    "is_vulnerable": 0,
    "class_name": "SAMLSSOResponseValidator",
    "subclass_name": null,
    "function_name": "validateAuthenticationSubject(\n        org.opensaml.saml.saml2.core.Subject subject, String id, boolean postBinding\n    ) throws WSSecurityException",
    "function_body": "{\n        if (subject.getSubjectConfirmations() == null) {\n            return false;\n        }\n        \n        boolean foundBearerSubjectConf = false;\n        \n        for (org.opensaml.saml.saml2.core.SubjectConfirmation subjectConf \n            : subject.getSubjectConfirmations()) {\n            if (SAML2Constants.CONF_BEARER.equals(subjectConf.getMethod())) {\n                foundBearerSubjectConf = true;\n                validateSubjectConfirmation(subjectConf.getSubjectConfirmationData(), id, postBinding);\n            }\n        }\n        \n        return foundBearerSubjectConf;\n    }"
  },
  {
    "id": 15,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 5,
    "human_patch": "https://github.com/apache/cxf/commit/845eccb6484b43ba02875c71e824db23ae4f20c0",
    "cve_id": "CVE-2015-5253",
    "cwe_id": "CWE-264",
    "filename": "rt/rs/security/sso/saml/src/main/java/org/apache/cxf/rs/security/saml/sso/SAMLSSOResponseValidator.java",
    "is_vulnerable": 0,
    "class_name": "SAMLSSOResponseValidator",
    "subclass_name": null,
    "function_name": "validateSubjectConfirmation(\n        org.opensaml.saml.saml2.core.SubjectConfirmationData subjectConfData, String id, boolean postBinding\n    ) throws WSSecurityException",
    "function_body": "{\n        if (subjectConfData == null) {\n            LOG.fine(\"Subject Confirmation Data of a Bearer Subject Confirmation is null\");\n            throw new WSSecurityException(WSSecurityException.ErrorCode.FAILURE, \"invalidSAMLsecurity\");\n        }\n        \n        \n        String recipient = subjectConfData.getRecipient();\n        if (recipient == null || !recipient.equals(assertionConsumerURL)) {\n            LOG.fine(\"Recipient \" + recipient + \" does not match assertion consumer URL \"\n                + assertionConsumerURL);\n            throw new WSSecurityException(WSSecurityException.ErrorCode.FAILURE, \"invalidSAMLsecurity\");\n        }\n        \n        \n        if (subjectConfData.getNotOnOrAfter() == null\n            || subjectConfData.getNotOnOrAfter().isBeforeNow()) {\n            LOG.fine(\"Subject Conf Data does not contain NotOnOrAfter or it has expired\");\n            throw new WSSecurityException(WSSecurityException.ErrorCode.FAILURE, \"invalidSAMLsecurity\");\n        }\n        \n        \n        if (postBinding && replayCache != null) {\n            if (replayCache.getId(id) == null) {\n                Date expires = subjectConfData.getNotOnOrAfter().toDate();\n                Date currentTime = new Date();\n                long ttl = expires.getTime() - currentTime.getTime();\n                replayCache.putId(id, ttl / 1000L);\n            } else {\n                LOG.fine(\"Replay attack with token id: \" + id);\n                throw new WSSecurityException(WSSecurityException.ErrorCode.FAILURE, \"invalidSAMLsecurity\");\n            }\n        }\n        \n        \n        if (subjectConfData.getAddress() != null\n            && !subjectConfData.getAddress().equals(clientAddress)) {\n            LOG.fine(\"Subject Conf Data address \" + subjectConfData.getAddress() + \" does match\"\n                     + \" client address \" + clientAddress);\n            throw new WSSecurityException(WSSecurityException.ErrorCode.FAILURE, \"invalidSAMLsecurity\");\n        }\n        \n        \n        if (subjectConfData.getNotBefore() != null) {\n            LOG.fine(\"The Subject Conf Data must not contain a NotBefore timestamp\");\n            throw new WSSecurityException(WSSecurityException.ErrorCode.FAILURE, \"invalidSAMLsecurity\");\n        }\n        \n        \n        if (requestId != null && !requestId.equals(subjectConfData.getInResponseTo())) {\n            LOG.fine(\"The InResponseTo String does match the original request id \" + requestId);\n            throw new WSSecurityException(WSSecurityException.ErrorCode.FAILURE, \"invalidSAMLsecurity\");\n        }\n        \n    }"
  },
  {
    "id": 15,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 6,
    "human_patch": "https://github.com/apache/cxf/commit/845eccb6484b43ba02875c71e824db23ae4f20c0",
    "cve_id": "CVE-2015-5253",
    "cwe_id": "CWE-264",
    "filename": "rt/rs/security/sso/saml/src/main/java/org/apache/cxf/rs/security/saml/sso/SAMLSSOResponseValidator.java",
    "is_vulnerable": 0,
    "class_name": "SAMLSSOResponseValidator",
    "subclass_name": null,
    "function_name": "validateAudienceRestrictionCondition(\n        org.opensaml.saml.saml2.core.Conditions conditions\n    ) throws WSSecurityException",
    "function_body": "{\n        if (conditions == null) {\n            LOG.fine(\"Conditions are null\");\n            throw new WSSecurityException(WSSecurityException.ErrorCode.FAILURE, \"invalidSAMLsecurity\");\n        }\n        List<AudienceRestriction> audienceRestrs = conditions.getAudienceRestrictions();\n        if (!matchSaml2AudienceRestriction(spIdentifier, audienceRestrs)) {\n            LOG.fine(\"Assertion does not contain unique subject provider identifier \" \n                     + spIdentifier + \" in the audience restriction conditions\");\n            throw new WSSecurityException(WSSecurityException.ErrorCode.FAILURE, \"invalidSAMLsecurity\");\n        }\n    }"
  },
  {
    "id": 15,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 7,
    "human_patch": "https://github.com/apache/cxf/commit/845eccb6484b43ba02875c71e824db23ae4f20c0",
    "cve_id": "CVE-2015-5253",
    "cwe_id": "CWE-264",
    "filename": "rt/rs/security/sso/saml/src/main/java/org/apache/cxf/rs/security/saml/sso/SAMLSSOResponseValidator.java",
    "is_vulnerable": 0,
    "class_name": "SAMLSSOResponseValidator",
    "subclass_name": null,
    "function_name": "matchSaml2AudienceRestriction(\n        String appliesTo, List<AudienceRestriction> audienceRestrictions\n    )",
    "function_body": "{\n        boolean oneMatchFound = false;\n        if (audienceRestrictions != null && !audienceRestrictions.isEmpty()) {\n            for (AudienceRestriction audienceRestriction : audienceRestrictions) {\n                if (audienceRestriction.getAudiences() != null) {\n                    boolean matchFound = false;\n                    for (org.opensaml.saml.saml2.core.Audience audience : audienceRestriction.getAudiences()) {\n                        if (appliesTo.equals(audience.getAudienceURI())) {\n                            matchFound = true;\n                            oneMatchFound = true;\n                            break;\n                        }\n                    }\n                    if (!matchFound) {\n                        return false;\n                    }\n                }\n            }\n        }\n\n        return oneMatchFound;\n    }"
  },
  {
    "id": 15,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 8,
    "human_patch": "https://github.com/apache/cxf/commit/845eccb6484b43ba02875c71e824db23ae4f20c0",
    "cve_id": "CVE-2015-5253",
    "cwe_id": "CWE-264",
    "filename": "rt/rs/security/sso/saml/src/main/java/org/apache/cxf/rs/security/saml/sso/SAMLSSOResponseValidator.java",
    "is_vulnerable": 0,
    "class_name": "SAMLSSOResponseValidator",
    "subclass_name": null,
    "function_name": "getIssuerIDP()",
    "function_body": "{\n        return issuerIDP;\n    }"
  },
  {
    "id": 15,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 9,
    "human_patch": "https://github.com/apache/cxf/commit/845eccb6484b43ba02875c71e824db23ae4f20c0",
    "cve_id": "CVE-2015-5253",
    "cwe_id": "CWE-264",
    "filename": "rt/rs/security/sso/saml/src/main/java/org/apache/cxf/rs/security/saml/sso/SAMLSSOResponseValidator.java",
    "is_vulnerable": 0,
    "class_name": "SAMLSSOResponseValidator",
    "subclass_name": null,
    "function_name": "setIssuerIDP(String issuerIDP)",
    "function_body": "{\n        this.issuerIDP = issuerIDP;\n    }"
  },
  {
    "id": 15,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 10,
    "human_patch": "https://github.com/apache/cxf/commit/845eccb6484b43ba02875c71e824db23ae4f20c0",
    "cve_id": "CVE-2015-5253",
    "cwe_id": "CWE-264",
    "filename": "rt/rs/security/sso/saml/src/main/java/org/apache/cxf/rs/security/saml/sso/SAMLSSOResponseValidator.java",
    "is_vulnerable": 0,
    "class_name": "SAMLSSOResponseValidator",
    "subclass_name": null,
    "function_name": "getAssertionConsumerURL()",
    "function_body": "{\n        return assertionConsumerURL;\n    }"
  },
  {
    "id": 15,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 11,
    "human_patch": "https://github.com/apache/cxf/commit/845eccb6484b43ba02875c71e824db23ae4f20c0",
    "cve_id": "CVE-2015-5253",
    "cwe_id": "CWE-264",
    "filename": "rt/rs/security/sso/saml/src/main/java/org/apache/cxf/rs/security/saml/sso/SAMLSSOResponseValidator.java",
    "is_vulnerable": 0,
    "class_name": "SAMLSSOResponseValidator",
    "subclass_name": null,
    "function_name": "setAssertionConsumerURL(String assertionConsumerURL)",
    "function_body": "{\n        this.assertionConsumerURL = assertionConsumerURL;\n    }"
  },
  {
    "id": 15,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 12,
    "human_patch": "https://github.com/apache/cxf/commit/845eccb6484b43ba02875c71e824db23ae4f20c0",
    "cve_id": "CVE-2015-5253",
    "cwe_id": "CWE-264",
    "filename": "rt/rs/security/sso/saml/src/main/java/org/apache/cxf/rs/security/saml/sso/SAMLSSOResponseValidator.java",
    "is_vulnerable": 0,
    "class_name": "SAMLSSOResponseValidator",
    "subclass_name": null,
    "function_name": "getClientAddress()",
    "function_body": "{\n        return clientAddress;\n    }"
  },
  {
    "id": 15,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 13,
    "human_patch": "https://github.com/apache/cxf/commit/845eccb6484b43ba02875c71e824db23ae4f20c0",
    "cve_id": "CVE-2015-5253",
    "cwe_id": "CWE-264",
    "filename": "rt/rs/security/sso/saml/src/main/java/org/apache/cxf/rs/security/saml/sso/SAMLSSOResponseValidator.java",
    "is_vulnerable": 0,
    "class_name": "SAMLSSOResponseValidator",
    "subclass_name": null,
    "function_name": "setClientAddress(String clientAddress)",
    "function_body": "{\n        this.clientAddress = clientAddress;\n    }"
  },
  {
    "id": 15,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 14,
    "human_patch": "https://github.com/apache/cxf/commit/845eccb6484b43ba02875c71e824db23ae4f20c0",
    "cve_id": "CVE-2015-5253",
    "cwe_id": "CWE-264",
    "filename": "rt/rs/security/sso/saml/src/main/java/org/apache/cxf/rs/security/saml/sso/SAMLSSOResponseValidator.java",
    "is_vulnerable": 0,
    "class_name": "SAMLSSOResponseValidator",
    "subclass_name": null,
    "function_name": "getRequestId()",
    "function_body": "{\n        return requestId;\n    }"
  },
  {
    "id": 15,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 15,
    "human_patch": "https://github.com/apache/cxf/commit/845eccb6484b43ba02875c71e824db23ae4f20c0",
    "cve_id": "CVE-2015-5253",
    "cwe_id": "CWE-264",
    "filename": "rt/rs/security/sso/saml/src/main/java/org/apache/cxf/rs/security/saml/sso/SAMLSSOResponseValidator.java",
    "is_vulnerable": 0,
    "class_name": "SAMLSSOResponseValidator",
    "subclass_name": null,
    "function_name": "setRequestId(String requestId)",
    "function_body": "{\n        this.requestId = requestId;\n    }"
  },
  {
    "id": 15,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 16,
    "human_patch": "https://github.com/apache/cxf/commit/845eccb6484b43ba02875c71e824db23ae4f20c0",
    "cve_id": "CVE-2015-5253",
    "cwe_id": "CWE-264",
    "filename": "rt/rs/security/sso/saml/src/main/java/org/apache/cxf/rs/security/saml/sso/SAMLSSOResponseValidator.java",
    "is_vulnerable": 0,
    "class_name": "SAMLSSOResponseValidator",
    "subclass_name": null,
    "function_name": "getSpIdentifier()",
    "function_body": "{\n        return spIdentifier;\n    }"
  },
  {
    "id": 15,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 17,
    "human_patch": "https://github.com/apache/cxf/commit/845eccb6484b43ba02875c71e824db23ae4f20c0",
    "cve_id": "CVE-2015-5253",
    "cwe_id": "CWE-264",
    "filename": "rt/rs/security/sso/saml/src/main/java/org/apache/cxf/rs/security/saml/sso/SAMLSSOResponseValidator.java",
    "is_vulnerable": 0,
    "class_name": "SAMLSSOResponseValidator",
    "subclass_name": null,
    "function_name": "setSpIdentifier(String spIdentifier)",
    "function_body": "{\n        this.spIdentifier = spIdentifier;\n    }"
  },
  {
    "id": 15,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 18,
    "human_patch": "https://github.com/apache/cxf/commit/845eccb6484b43ba02875c71e824db23ae4f20c0",
    "cve_id": "CVE-2015-5253",
    "cwe_id": "CWE-264",
    "filename": "rt/rs/security/sso/saml/src/main/java/org/apache/cxf/rs/security/saml/sso/SAMLSSOResponseValidator.java",
    "is_vulnerable": 0,
    "class_name": "SAMLSSOResponseValidator",
    "subclass_name": null,
    "function_name": "setReplayCache(TokenReplayCache<String> replayCache)",
    "function_body": "{\n        this.replayCache = replayCache;\n    }"
  },
  {
    "id": 15,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 0,
    "human_patch": "https://github.com/apache/cxf/commit/845eccb6484b43ba02875c71e824db23ae4f20c0",
    "cve_id": "CVE-2015-5253",
    "cwe_id": "CWE-264",
    "filename": "rt/rs/security/sso/saml/src/test/java/org/apache/cxf/rs/security/saml/sso/AbstractSAMLCallbackHandler.java",
    "is_vulnerable": 0,
    "class_name": "AbstractSAMLCallbackHandler",
    "subclass_name": null,
    "function_name": "getSessionNotOnOrAfter()",
    "function_body": "{\n        return sessionNotOnOrAfter;\n    }"
  },
  {
    "id": 15,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 1,
    "human_patch": "https://github.com/apache/cxf/commit/845eccb6484b43ba02875c71e824db23ae4f20c0",
    "cve_id": "CVE-2015-5253",
    "cwe_id": "CWE-264",
    "filename": "rt/rs/security/sso/saml/src/test/java/org/apache/cxf/rs/security/saml/sso/AbstractSAMLCallbackHandler.java",
    "is_vulnerable": 0,
    "class_name": "AbstractSAMLCallbackHandler",
    "subclass_name": null,
    "function_name": "setSessionNotOnOrAfter(DateTime sessionNotOnOrAfter)",
    "function_body": "{\n        this.sessionNotOnOrAfter = sessionNotOnOrAfter;\n    }"
  },
  {
    "id": 15,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 2,
    "human_patch": "https://github.com/apache/cxf/commit/845eccb6484b43ba02875c71e824db23ae4f20c0",
    "cve_id": "CVE-2015-5253",
    "cwe_id": "CWE-264",
    "filename": "rt/rs/security/sso/saml/src/test/java/org/apache/cxf/rs/security/saml/sso/AbstractSAMLCallbackHandler.java",
    "is_vulnerable": 0,
    "class_name": "AbstractSAMLCallbackHandler",
    "subclass_name": null,
    "function_name": "getAuthnInstant()",
    "function_body": "{\n        return authnInstant;\n    }"
  },
  {
    "id": 15,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 3,
    "human_patch": "https://github.com/apache/cxf/commit/845eccb6484b43ba02875c71e824db23ae4f20c0",
    "cve_id": "CVE-2015-5253",
    "cwe_id": "CWE-264",
    "filename": "rt/rs/security/sso/saml/src/test/java/org/apache/cxf/rs/security/saml/sso/AbstractSAMLCallbackHandler.java",
    "is_vulnerable": 0,
    "class_name": "AbstractSAMLCallbackHandler",
    "subclass_name": null,
    "function_name": "setAuthnInstant(DateTime authnInstant)",
    "function_body": "{\n        this.authnInstant = authnInstant;\n    }"
  },
  {
    "id": 15,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 4,
    "human_patch": "https://github.com/apache/cxf/commit/845eccb6484b43ba02875c71e824db23ae4f20c0",
    "cve_id": "CVE-2015-5253",
    "cwe_id": "CWE-264",
    "filename": "rt/rs/security/sso/saml/src/test/java/org/apache/cxf/rs/security/saml/sso/AbstractSAMLCallbackHandler.java",
    "is_vulnerable": 0,
    "class_name": "AbstractSAMLCallbackHandler",
    "subclass_name": null,
    "function_name": "setSubjectConfirmationData(SubjectConfirmationDataBean subjectConfirmationData)",
    "function_body": "{\n        this.subjectConfirmationData = subjectConfirmationData;\n    }"
  },
  {
    "id": 15,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 5,
    "human_patch": "https://github.com/apache/cxf/commit/845eccb6484b43ba02875c71e824db23ae4f20c0",
    "cve_id": "CVE-2015-5253",
    "cwe_id": "CWE-264",
    "filename": "rt/rs/security/sso/saml/src/test/java/org/apache/cxf/rs/security/saml/sso/AbstractSAMLCallbackHandler.java",
    "is_vulnerable": 0,
    "class_name": "AbstractSAMLCallbackHandler",
    "subclass_name": null,
    "function_name": "setConditions(ConditionsBean conditionsBean)",
    "function_body": "{\n        this.conditions = conditionsBean;\n    }"
  },
  {
    "id": 15,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 6,
    "human_patch": "https://github.com/apache/cxf/commit/845eccb6484b43ba02875c71e824db23ae4f20c0",
    "cve_id": "CVE-2015-5253",
    "cwe_id": "CWE-264",
    "filename": "rt/rs/security/sso/saml/src/test/java/org/apache/cxf/rs/security/saml/sso/AbstractSAMLCallbackHandler.java",
    "is_vulnerable": 0,
    "class_name": "AbstractSAMLCallbackHandler",
    "subclass_name": null,
    "function_name": "setConfirmationMethod(String confMethod)",
    "function_body": "{\n        confirmationMethod = confMethod;\n    }"
  },
  {
    "id": 15,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 7,
    "human_patch": "https://github.com/apache/cxf/commit/845eccb6484b43ba02875c71e824db23ae4f20c0",
    "cve_id": "CVE-2015-5253",
    "cwe_id": "CWE-264",
    "filename": "rt/rs/security/sso/saml/src/test/java/org/apache/cxf/rs/security/saml/sso/AbstractSAMLCallbackHandler.java",
    "is_vulnerable": 0,
    "class_name": "AbstractSAMLCallbackHandler",
    "subclass_name": null,
    "function_name": "setStatement(Statement statement)",
    "function_body": "{\n        this.statement = statement;\n    }"
  },
  {
    "id": 15,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 8,
    "human_patch": "https://github.com/apache/cxf/commit/845eccb6484b43ba02875c71e824db23ae4f20c0",
    "cve_id": "CVE-2015-5253",
    "cwe_id": "CWE-264",
    "filename": "rt/rs/security/sso/saml/src/test/java/org/apache/cxf/rs/security/saml/sso/AbstractSAMLCallbackHandler.java",
    "is_vulnerable": 0,
    "class_name": "AbstractSAMLCallbackHandler",
    "subclass_name": null,
    "function_name": "setCertIdentifier(CERT_IDENTIFIER certIdentifier)",
    "function_body": "{\n        this.certIdentifier = certIdentifier;\n    }"
  },
  {
    "id": 15,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 9,
    "human_patch": "https://github.com/apache/cxf/commit/845eccb6484b43ba02875c71e824db23ae4f20c0",
    "cve_id": "CVE-2015-5253",
    "cwe_id": "CWE-264",
    "filename": "rt/rs/security/sso/saml/src/test/java/org/apache/cxf/rs/security/saml/sso/AbstractSAMLCallbackHandler.java",
    "is_vulnerable": 0,
    "class_name": "AbstractSAMLCallbackHandler",
    "subclass_name": null,
    "function_name": "setCerts(X509Certificate[] certs)",
    "function_body": "{\n        this.certs = certs;\n    }"
  },
  {
    "id": 15,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 10,
    "human_patch": "https://github.com/apache/cxf/commit/845eccb6484b43ba02875c71e824db23ae4f20c0",
    "cve_id": "CVE-2015-5253",
    "cwe_id": "CWE-264",
    "filename": "rt/rs/security/sso/saml/src/test/java/org/apache/cxf/rs/security/saml/sso/AbstractSAMLCallbackHandler.java",
    "is_vulnerable": 0,
    "class_name": "AbstractSAMLCallbackHandler",
    "subclass_name": null,
    "function_name": "getEphemeralKey()",
    "function_body": "{\n        return ephemeralKey;\n    }"
  },
  {
    "id": 15,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 11,
    "human_patch": "https://github.com/apache/cxf/commit/845eccb6484b43ba02875c71e824db23ae4f20c0",
    "cve_id": "CVE-2015-5253",
    "cwe_id": "CWE-264",
    "filename": "rt/rs/security/sso/saml/src/test/java/org/apache/cxf/rs/security/saml/sso/AbstractSAMLCallbackHandler.java",
    "is_vulnerable": 0,
    "class_name": "AbstractSAMLCallbackHandler",
    "subclass_name": null,
    "function_name": "setIssuer(String issuer)",
    "function_body": "{\n        this.issuer = issuer;\n    }"
  },
  {
    "id": 15,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 12,
    "human_patch": "https://github.com/apache/cxf/commit/845eccb6484b43ba02875c71e824db23ae4f20c0",
    "cve_id": "CVE-2015-5253",
    "cwe_id": "CWE-264",
    "filename": "rt/rs/security/sso/saml/src/test/java/org/apache/cxf/rs/security/saml/sso/AbstractSAMLCallbackHandler.java",
    "is_vulnerable": 0,
    "class_name": "AbstractSAMLCallbackHandler",
    "subclass_name": null,
    "function_name": "setSubjectNameIDFormat(String subjectNameIDFormat)",
    "function_body": "{\n        this.subjectNameIDFormat = subjectNameIDFormat;\n    }"
  },
  {
    "id": 15,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 13,
    "human_patch": "https://github.com/apache/cxf/commit/845eccb6484b43ba02875c71e824db23ae4f20c0",
    "cve_id": "CVE-2015-5253",
    "cwe_id": "CWE-264",
    "filename": "rt/rs/security/sso/saml/src/test/java/org/apache/cxf/rs/security/saml/sso/AbstractSAMLCallbackHandler.java",
    "is_vulnerable": 0,
    "class_name": "AbstractSAMLCallbackHandler",
    "subclass_name": null,
    "function_name": "setSubjectLocality(String ipAddress, String dnsAddress)",
    "function_body": "{\n        this.subjectLocalityIpAddress = ipAddress;\n        this.subjectLocalityDnsAddress = dnsAddress;\n    }"
  },
  {
    "id": 15,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 14,
    "human_patch": "https://github.com/apache/cxf/commit/845eccb6484b43ba02875c71e824db23ae4f20c0",
    "cve_id": "CVE-2015-5253",
    "cwe_id": "CWE-264",
    "filename": "rt/rs/security/sso/saml/src/test/java/org/apache/cxf/rs/security/saml/sso/AbstractSAMLCallbackHandler.java",
    "is_vulnerable": 0,
    "class_name": "AbstractSAMLCallbackHandler",
    "subclass_name": null,
    "function_name": "setResource(String resource)",
    "function_body": "{\n        this.resource = resource;\n    }"
  },
  {
    "id": 15,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 15,
    "human_patch": "https://github.com/apache/cxf/commit/845eccb6484b43ba02875c71e824db23ae4f20c0",
    "cve_id": "CVE-2015-5253",
    "cwe_id": "CWE-264",
    "filename": "rt/rs/security/sso/saml/src/test/java/org/apache/cxf/rs/security/saml/sso/AbstractSAMLCallbackHandler.java",
    "is_vulnerable": 0,
    "class_name": "AbstractSAMLCallbackHandler",
    "subclass_name": null,
    "function_name": "setCustomAttributeValues(List<Object> customAttributeValues)",
    "function_body": "{\n        this.customAttributeValues = customAttributeValues;\n    }"
  },
  {
    "id": 15,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 16,
    "human_patch": "https://github.com/apache/cxf/commit/845eccb6484b43ba02875c71e824db23ae4f20c0",
    "cve_id": "CVE-2015-5253",
    "cwe_id": "CWE-264",
    "filename": "rt/rs/security/sso/saml/src/test/java/org/apache/cxf/rs/security/saml/sso/AbstractSAMLCallbackHandler.java",
    "is_vulnerable": 0,
    "class_name": "AbstractSAMLCallbackHandler",
    "subclass_name": null,
    "function_name": "createAndSetStatement(SubjectBean subjectBean, SAMLCallback callback)",
    "function_body": "{\n        if (statement == Statement.AUTHN) {\n            AuthenticationStatementBean authBean = new AuthenticationStatementBean();\n            if (subjectBean != null) {\n                authBean.setSubject(subjectBean);\n            }\n            if (subjectLocalityIpAddress != null || subjectLocalityDnsAddress != null) {\n                SubjectLocalityBean subjectLocality = new SubjectLocalityBean();\n                subjectLocality.setIpAddress(subjectLocalityIpAddress);\n                subjectLocality.setDnsAddress(subjectLocalityDnsAddress);\n                authBean.setSubjectLocality(subjectLocality);\n            }\n            authBean.setAuthenticationInstant(authnInstant);\n            authBean.setSessionNotOnOrAfter(sessionNotOnOrAfter);\n            authBean.setAuthenticationMethod(\"Password\");\n            callback.setAuthenticationStatementData(Collections.singletonList(authBean));\n        } else if (statement == Statement.ATTR) {\n            AttributeStatementBean attrBean = new AttributeStatementBean();\n            AttributeBean attributeBean = new AttributeBean();\n            if (subjectBean != null) {\n                attrBean.setSubject(subjectBean);\n                attributeBean.setSimpleName(\"role\");\n                attributeBean.setQualifiedName(\"http://custom-ns\");\n            } else {\n                attributeBean.setQualifiedName(\"role\");\n            }\n            if (customAttributeValues != null) {\n                attributeBean.setAttributeValues(customAttributeValues);   \n            } else {\n                attributeBean.addAttributeValue(\"user\");\n            }\n            attrBean.setSamlAttributes(Collections.singletonList(attributeBean));\n            callback.setAttributeStatementData(Collections.singletonList(attrBean));\n        } else {\n            AuthDecisionStatementBean authzBean = new AuthDecisionStatementBean();\n            if (subjectBean != null) {\n                authzBean.setSubject(subjectBean);\n            }\n            ActionBean actionBean = new ActionBean();\n            actionBean.setContents(\"Read\");\n            authzBean.setActions(Collections.singletonList(actionBean));\n            authzBean.setResource(\"endpoint\");\n            authzBean.setDecision(AuthDecisionStatementBean.Decision.PERMIT);\n            authzBean.setResource(resource);\n            callback.setAuthDecisionStatementData(Collections.singletonList(authzBean));\n        }\n    }"
  },
  {
    "id": 15,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 17,
    "human_patch": "https://github.com/apache/cxf/commit/845eccb6484b43ba02875c71e824db23ae4f20c0",
    "cve_id": "CVE-2015-5253",
    "cwe_id": "CWE-264",
    "filename": "rt/rs/security/sso/saml/src/test/java/org/apache/cxf/rs/security/saml/sso/AbstractSAMLCallbackHandler.java",
    "is_vulnerable": 0,
    "class_name": "AbstractSAMLCallbackHandler",
    "subclass_name": null,
    "function_name": "createKeyInfo() throws Exception",
    "function_body": "{\n        KeyInfoBean keyInfo = new KeyInfoBean();\n        if (statement == Statement.AUTHN) {\n            keyInfo.setCertificate(certs[0]);\n            keyInfo.setCertIdentifer(certIdentifier);\n        } else if (statement == Statement.ATTR) {\n            \n            DocumentBuilderFactory docBuilderFactory = \n                DocumentBuilderFactory.newInstance();\n            docBuilderFactory.setNamespaceAware(true);\n            DocumentBuilder docBuilder = docBuilderFactory.newDocumentBuilder();\n            Document doc = docBuilder.newDocument();\n                  \n            \n            WSSecEncryptedKey encrKey = new WSSecEncryptedKey();\n            encrKey.setKeyIdentifierType(WSConstants.ISSUER_SERIAL);\n            encrKey.setUseThisCert(certs[0]);\n            encrKey.prepare(doc, null);\n            ephemeralKey = encrKey.getEphemeralKey();\n            Element encryptedKeyElement = encrKey.getEncryptedKeyElement();\n            \n            \n            Element keyInfoElement = \n                doc.createElementNS(\n                    WSConstants.SIG_NS, WSConstants.SIG_PREFIX + \":\" + WSConstants.KEYINFO_LN\n                );\n            keyInfoElement.setAttributeNS(\n                WSConstants.XMLNS_NS, \"xmlns:\" + WSConstants.SIG_PREFIX, WSConstants.SIG_NS\n            );\n            keyInfoElement.appendChild(encryptedKeyElement);\n            \n            keyInfo.setElement(keyInfoElement);\n        }\n        return keyInfo;\n    }"
  },
  {
    "id": 16,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 0,
    "human_patch": "https://github.com/apache/httpcomponents-client/commit/0554271750599756d4946c0d7ba43d04b1a7b22",
    "cve_id": "HTTPCLIENT-1803",
    "cwe_id": "Not Mapping",
    "filename": "httpclient/src/main/java/org/apache/http/client/utils/URIBuilder.java",
    "is_vulnerable": 0,
    "class_name": "URIBuilder",
    "subclass_name": null,
    "function_name": "setCharset(final Charset charset)",
    "function_body": "{\n        this.charset = charset;\n        return this;\n    }"
  },
  {
    "id": 16,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 1,
    "human_patch": "https://github.com/apache/httpcomponents-client/commit/0554271750599756d4946c0d7ba43d04b1a7b22",
    "cve_id": "HTTPCLIENT-1803",
    "cwe_id": "Not Mapping",
    "filename": "httpclient/src/main/java/org/apache/http/client/utils/URIBuilder.java",
    "is_vulnerable": 0,
    "class_name": "URIBuilder",
    "subclass_name": null,
    "function_name": "getCharset()",
    "function_body": "{\n        return charset;\n    }"
  },
  {
    "id": 16,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 2,
    "human_patch": "https://github.com/apache/httpcomponents-client/commit/0554271750599756d4946c0d7ba43d04b1a7b22",
    "cve_id": "HTTPCLIENT-1803",
    "cwe_id": "Not Mapping",
    "filename": "httpclient/src/main/java/org/apache/http/client/utils/URIBuilder.java",
    "is_vulnerable": 0,
    "class_name": "URIBuilder",
    "subclass_name": null,
    "function_name": "parseQuery(final String query, final Charset charset)",
    "function_body": "{\n        if (query != null && !query.isEmpty()) {\n            return URLEncodedUtils.parse(query, charset);\n        }\n        return null;\n    }"
  },
  {
    "id": 16,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 3,
    "human_patch": "https://github.com/apache/httpcomponents-client/commit/0554271750599756d4946c0d7ba43d04b1a7b22",
    "cve_id": "HTTPCLIENT-1803",
    "cwe_id": "Not Mapping",
    "filename": "httpclient/src/main/java/org/apache/http/client/utils/URIBuilder.java",
    "is_vulnerable": 0,
    "class_name": "URIBuilder",
    "subclass_name": null,
    "function_name": "build() throws URISyntaxException",
    "function_body": "{\n        return new URI(buildString());\n    }"
  },
  {
    "id": 16,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 4,
    "human_patch": "https://github.com/apache/httpcomponents-client/commit/0554271750599756d4946c0d7ba43d04b1a7b22",
    "cve_id": "HTTPCLIENT-1803",
    "cwe_id": "Not Mapping",
    "filename": "httpclient/src/main/java/org/apache/http/client/utils/URIBuilder.java",
    "is_vulnerable": 0,
    "class_name": "URIBuilder",
    "subclass_name": null,
    "function_name": "buildString()",
    "function_body": "{\n        final StringBuilder sb = new StringBuilder();\n        if (this.scheme != null) {\n            sb.append(this.scheme).append(':');\n        }\n        if (this.encodedSchemeSpecificPart != null) {\n            sb.append(this.encodedSchemeSpecificPart);\n        } else {\n            if (this.encodedAuthority != null) {\n                sb.append(\"//\").append(this.encodedAuthority);\n            } else if (this.host != null) {\n                sb.append(\"//\");\n                if (this.encodedUserInfo != null) {\n                    sb.append(this.encodedUserInfo).append(\"@\");\n                } else if (this.userInfo != null) {\n                    sb.append(encodeUserInfo(this.userInfo)).append(\"@\");\n                }\n                if (InetAddressUtils.isIPv6Address(this.host)) {\n                    sb.append(\"[\").append(this.host).append(\"]\");\n                } else {\n                    sb.append(this.host);\n                }\n                if (this.port >= 0) {\n                    sb.append(\":\").append(this.port);\n                }\n            }\n            if (this.encodedPath != null) {\n                sb.append(normalizePath(this.encodedPath));\n            } else if (this.path != null) {\n                sb.append(encodePath(normalizePath(this.path)));\n            }\n            if (this.encodedQuery != null) {\n                sb.append(\"?\").append(this.encodedQuery);\n            } else if (this.queryParams != null) {\n                sb.append(\"?\").append(encodeUrlForm(this.queryParams));\n            } else if (this.query != null) {\n                sb.append(\"?\").append(encodeUric(this.query));\n            }\n        }\n        if (this.encodedFragment != null) {\n            sb.append(\"#\").append(this.encodedFragment);\n        } else if (this.fragment != null) {\n            sb.append(\"#\").append(encodeUric(this.fragment));\n        }\n        return sb.toString();\n    }"
  },
  {
    "id": 16,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 5,
    "human_patch": "https://github.com/apache/httpcomponents-client/commit/0554271750599756d4946c0d7ba43d04b1a7b22",
    "cve_id": "HTTPCLIENT-1803",
    "cwe_id": "Not Mapping",
    "filename": "httpclient/src/main/java/org/apache/http/client/utils/URIBuilder.java",
    "is_vulnerable": 0,
    "class_name": "URIBuilder",
    "subclass_name": null,
    "function_name": "digestURI(final URI uri)",
    "function_body": "{\n        this.scheme = uri.getScheme();\n        this.encodedSchemeSpecificPart = uri.getRawSchemeSpecificPart();\n        this.encodedAuthority = uri.getRawAuthority();\n        this.host = uri.getHost();\n        this.port = uri.getPort();\n        this.encodedUserInfo = uri.getRawUserInfo();\n        this.userInfo = uri.getUserInfo();\n        this.encodedPath = uri.getRawPath();\n        this.path = uri.getPath();\n        this.encodedQuery = uri.getRawQuery();\n        this.queryParams = parseQuery(uri.getRawQuery(), this.charset != null ? this.charset : Consts.UTF_8);\n        this.encodedFragment = uri.getRawFragment();\n        this.fragment = uri.getFragment();\n    }"
  },
  {
    "id": 16,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 6,
    "human_patch": "https://github.com/apache/httpcomponents-client/commit/0554271750599756d4946c0d7ba43d04b1a7b22",
    "cve_id": "HTTPCLIENT-1803",
    "cwe_id": "Not Mapping",
    "filename": "httpclient/src/main/java/org/apache/http/client/utils/URIBuilder.java",
    "is_vulnerable": 0,
    "class_name": "URIBuilder",
    "subclass_name": null,
    "function_name": "encodeUserInfo(final String userInfo)",
    "function_body": "{\n        return URLEncodedUtils.encUserInfo(userInfo, this.charset != null ? this.charset : Consts.UTF_8);\n    }"
  },
  {
    "id": 16,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 7,
    "human_patch": "https://github.com/apache/httpcomponents-client/commit/0554271750599756d4946c0d7ba43d04b1a7b22",
    "cve_id": "HTTPCLIENT-1803",
    "cwe_id": "Not Mapping",
    "filename": "httpclient/src/main/java/org/apache/http/client/utils/URIBuilder.java",
    "is_vulnerable": 0,
    "class_name": "URIBuilder",
    "subclass_name": null,
    "function_name": "encodePath(final String path)",
    "function_body": "{\n        return URLEncodedUtils.encPath(path, this.charset != null ? this.charset : Consts.UTF_8);\n    }"
  },
  {
    "id": 16,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 8,
    "human_patch": "https://github.com/apache/httpcomponents-client/commit/0554271750599756d4946c0d7ba43d04b1a7b22",
    "cve_id": "HTTPCLIENT-1803",
    "cwe_id": "Not Mapping",
    "filename": "httpclient/src/main/java/org/apache/http/client/utils/URIBuilder.java",
    "is_vulnerable": 0,
    "class_name": "URIBuilder",
    "subclass_name": null,
    "function_name": "encodeUrlForm(final List<NameValuePair> params)",
    "function_body": "{\n        return URLEncodedUtils.format(params, this.charset != null ? this.charset : Consts.UTF_8);\n    }"
  },
  {
    "id": 16,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 9,
    "human_patch": "https://github.com/apache/httpcomponents-client/commit/0554271750599756d4946c0d7ba43d04b1a7b22",
    "cve_id": "HTTPCLIENT-1803",
    "cwe_id": "Not Mapping",
    "filename": "httpclient/src/main/java/org/apache/http/client/utils/URIBuilder.java",
    "is_vulnerable": 0,
    "class_name": "URIBuilder",
    "subclass_name": null,
    "function_name": "encodeUric(final String fragment)",
    "function_body": "{\n        return URLEncodedUtils.encUric(fragment, this.charset != null ? this.charset : Consts.UTF_8);\n    }"
  },
  {
    "id": 16,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 10,
    "human_patch": "https://github.com/apache/httpcomponents-client/commit/0554271750599756d4946c0d7ba43d04b1a7b22",
    "cve_id": "HTTPCLIENT-1803",
    "cwe_id": "Not Mapping",
    "filename": "httpclient/src/main/java/org/apache/http/client/utils/URIBuilder.java",
    "is_vulnerable": 0,
    "class_name": "URIBuilder",
    "subclass_name": null,
    "function_name": "setScheme(final String scheme)",
    "function_body": "{\n        this.scheme = scheme;\n        return this;\n    }"
  },
  {
    "id": 16,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 11,
    "human_patch": "https://github.com/apache/httpcomponents-client/commit/0554271750599756d4946c0d7ba43d04b1a7b22",
    "cve_id": "HTTPCLIENT-1803",
    "cwe_id": "Not Mapping",
    "filename": "httpclient/src/main/java/org/apache/http/client/utils/URIBuilder.java",
    "is_vulnerable": 0,
    "class_name": "URIBuilder",
    "subclass_name": null,
    "function_name": "setUserInfo(final String userInfo)",
    "function_body": "{\n        this.userInfo = userInfo;\n        this.encodedSchemeSpecificPart = null;\n        this.encodedAuthority = null;\n        this.encodedUserInfo = null;\n        return this;\n    }"
  },
  {
    "id": 16,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 12,
    "human_patch": "https://github.com/apache/httpcomponents-client/commit/0554271750599756d4946c0d7ba43d04b1a7b22",
    "cve_id": "HTTPCLIENT-1803",
    "cwe_id": "Not Mapping",
    "filename": "httpclient/src/main/java/org/apache/http/client/utils/URIBuilder.java",
    "is_vulnerable": 0,
    "class_name": "URIBuilder",
    "subclass_name": null,
    "function_name": "setUserInfo(final String username, final String password)",
    "function_body": "{\n        return setUserInfo(username + ':' + password);\n    }"
  },
  {
    "id": 16,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 13,
    "human_patch": "https://github.com/apache/httpcomponents-client/commit/0554271750599756d4946c0d7ba43d04b1a7b22",
    "cve_id": "HTTPCLIENT-1803",
    "cwe_id": "Not Mapping",
    "filename": "httpclient/src/main/java/org/apache/http/client/utils/URIBuilder.java",
    "is_vulnerable": 0,
    "class_name": "URIBuilder",
    "subclass_name": null,
    "function_name": "setHost(final String host)",
    "function_body": "{\n        this.host = host;\n        this.encodedSchemeSpecificPart = null;\n        this.encodedAuthority = null;\n        return this;\n    }"
  },
  {
    "id": 16,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 14,
    "human_patch": "https://github.com/apache/httpcomponents-client/commit/0554271750599756d4946c0d7ba43d04b1a7b22",
    "cve_id": "HTTPCLIENT-1803",
    "cwe_id": "Not Mapping",
    "filename": "httpclient/src/main/java/org/apache/http/client/utils/URIBuilder.java",
    "is_vulnerable": 0,
    "class_name": "URIBuilder",
    "subclass_name": null,
    "function_name": "setPort(final int port)",
    "function_body": "{\n        this.port = port < 0 ? -1 : port;\n        this.encodedSchemeSpecificPart = null;\n        this.encodedAuthority = null;\n        return this;\n    }"
  },
  {
    "id": 16,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 15,
    "human_patch": "https://github.com/apache/httpcomponents-client/commit/0554271750599756d4946c0d7ba43d04b1a7b22",
    "cve_id": "HTTPCLIENT-1803",
    "cwe_id": "Not Mapping",
    "filename": "httpclient/src/main/java/org/apache/http/client/utils/URIBuilder.java",
    "is_vulnerable": 0,
    "class_name": "URIBuilder",
    "subclass_name": null,
    "function_name": "setPath(final String path)",
    "function_body": "{\n        this.path = path;\n        this.encodedSchemeSpecificPart = null;\n        this.encodedPath = null;\n        return this;\n    }"
  },
  {
    "id": 16,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 16,
    "human_patch": "https://github.com/apache/httpcomponents-client/commit/0554271750599756d4946c0d7ba43d04b1a7b22",
    "cve_id": "HTTPCLIENT-1803",
    "cwe_id": "Not Mapping",
    "filename": "httpclient/src/main/java/org/apache/http/client/utils/URIBuilder.java",
    "is_vulnerable": 0,
    "class_name": "URIBuilder",
    "subclass_name": null,
    "function_name": "removeQuery()",
    "function_body": "{\n        this.queryParams = null;\n        this.query = null;\n        this.encodedQuery = null;\n        this.encodedSchemeSpecificPart = null;\n        return this;\n    }"
  },
  {
    "id": 16,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 17,
    "human_patch": "https://github.com/apache/httpcomponents-client/commit/0554271750599756d4946c0d7ba43d04b1a7b22",
    "cve_id": "HTTPCLIENT-1803",
    "cwe_id": "Not Mapping",
    "filename": "httpclient/src/main/java/org/apache/http/client/utils/URIBuilder.java",
    "is_vulnerable": 0,
    "class_name": "URIBuilder",
    "subclass_name": null,
    "function_name": "setQuery(final String query)",
    "function_body": "{\n        this.queryParams = parseQuery(query, this.charset != null ? this.charset : Consts.UTF_8);\n        this.query = null;\n        this.encodedQuery = null;\n        this.encodedSchemeSpecificPart = null;\n        return this;\n    }"
  },
  {
    "id": 16,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 18,
    "human_patch": "https://github.com/apache/httpcomponents-client/commit/0554271750599756d4946c0d7ba43d04b1a7b22",
    "cve_id": "HTTPCLIENT-1803",
    "cwe_id": "Not Mapping",
    "filename": "httpclient/src/main/java/org/apache/http/client/utils/URIBuilder.java",
    "is_vulnerable": 0,
    "class_name": "URIBuilder",
    "subclass_name": null,
    "function_name": "setParameters(final List <NameValuePair> nvps)",
    "function_body": "{\n        if (this.queryParams == null) {\n            this.queryParams = new ArrayList<NameValuePair>();\n        } else {\n            this.queryParams.clear();\n        }\n        this.queryParams.addAll(nvps);\n        this.encodedQuery = null;\n        this.encodedSchemeSpecificPart = null;\n        this.query = null;\n        return this;\n    }"
  },
  {
    "id": 16,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 19,
    "human_patch": "https://github.com/apache/httpcomponents-client/commit/0554271750599756d4946c0d7ba43d04b1a7b22",
    "cve_id": "HTTPCLIENT-1803",
    "cwe_id": "Not Mapping",
    "filename": "httpclient/src/main/java/org/apache/http/client/utils/URIBuilder.java",
    "is_vulnerable": 0,
    "class_name": "URIBuilder",
    "subclass_name": null,
    "function_name": "addParameters(final List <NameValuePair> nvps)",
    "function_body": "{\n        if (this.queryParams == null) {\n            this.queryParams = new ArrayList<NameValuePair>();\n        }\n        this.queryParams.addAll(nvps);\n        this.encodedQuery = null;\n        this.encodedSchemeSpecificPart = null;\n        this.query = null;\n        return this;\n    }"
  },
  {
    "id": 16,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 20,
    "human_patch": "https://github.com/apache/httpcomponents-client/commit/0554271750599756d4946c0d7ba43d04b1a7b22",
    "cve_id": "HTTPCLIENT-1803",
    "cwe_id": "Not Mapping",
    "filename": "httpclient/src/main/java/org/apache/http/client/utils/URIBuilder.java",
    "is_vulnerable": 0,
    "class_name": "URIBuilder",
    "subclass_name": null,
    "function_name": "setParameters(final NameValuePair... nvps)",
    "function_body": "{\n        if (this.queryParams == null) {\n            this.queryParams = new ArrayList<NameValuePair>();\n        } else {\n            this.queryParams.clear();\n        }\n        for (final NameValuePair nvp: nvps) {\n            this.queryParams.add(nvp);\n        }\n        this.encodedQuery = null;\n        this.encodedSchemeSpecificPart = null;\n        this.query = null;\n        return this;\n    }"
  },
  {
    "id": 16,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 21,
    "human_patch": "https://github.com/apache/httpcomponents-client/commit/0554271750599756d4946c0d7ba43d04b1a7b22",
    "cve_id": "HTTPCLIENT-1803",
    "cwe_id": "Not Mapping",
    "filename": "httpclient/src/main/java/org/apache/http/client/utils/URIBuilder.java",
    "is_vulnerable": 0,
    "class_name": "URIBuilder",
    "subclass_name": null,
    "function_name": "addParameter(final String param, final String value)",
    "function_body": "{\n        if (this.queryParams == null) {\n            this.queryParams = new ArrayList<NameValuePair>();\n        }\n        this.queryParams.add(new BasicNameValuePair(param, value));\n        this.encodedQuery = null;\n        this.encodedSchemeSpecificPart = null;\n        this.query = null;\n        return this;\n    }"
  },
  {
    "id": 16,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 22,
    "human_patch": "https://github.com/apache/httpcomponents-client/commit/0554271750599756d4946c0d7ba43d04b1a7b22",
    "cve_id": "HTTPCLIENT-1803",
    "cwe_id": "Not Mapping",
    "filename": "httpclient/src/main/java/org/apache/http/client/utils/URIBuilder.java",
    "is_vulnerable": 0,
    "class_name": "URIBuilder",
    "subclass_name": null,
    "function_name": "setParameter(final String param, final String value)",
    "function_body": "{\n        if (this.queryParams == null) {\n            this.queryParams = new ArrayList<NameValuePair>();\n        }\n        if (!this.queryParams.isEmpty()) {\n            for (final Iterator<NameValuePair> it = this.queryParams.iterator(); it.hasNext(); ) {\n                final NameValuePair nvp = it.next();\n                if (nvp.getName().equals(param)) {\n                    it.remove();\n                }\n            }\n        }\n        this.queryParams.add(new BasicNameValuePair(param, value));\n        this.encodedQuery = null;\n        this.encodedSchemeSpecificPart = null;\n        this.query = null;\n        return this;\n    }"
  },
  {
    "id": 16,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 23,
    "human_patch": "https://github.com/apache/httpcomponents-client/commit/0554271750599756d4946c0d7ba43d04b1a7b22",
    "cve_id": "HTTPCLIENT-1803",
    "cwe_id": "Not Mapping",
    "filename": "httpclient/src/main/java/org/apache/http/client/utils/URIBuilder.java",
    "is_vulnerable": 0,
    "class_name": "URIBuilder",
    "subclass_name": null,
    "function_name": "clearParameters()",
    "function_body": "{\n        this.queryParams = null;\n        this.encodedQuery = null;\n        this.encodedSchemeSpecificPart = null;\n        return this;\n    }"
  },
  {
    "id": 16,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 24,
    "human_patch": "https://github.com/apache/httpcomponents-client/commit/0554271750599756d4946c0d7ba43d04b1a7b22",
    "cve_id": "HTTPCLIENT-1803",
    "cwe_id": "Not Mapping",
    "filename": "httpclient/src/main/java/org/apache/http/client/utils/URIBuilder.java",
    "is_vulnerable": 0,
    "class_name": "URIBuilder",
    "subclass_name": null,
    "function_name": "setCustomQuery(final String query)",
    "function_body": "{\n        this.query = query;\n        this.encodedQuery = null;\n        this.encodedSchemeSpecificPart = null;\n        this.queryParams = null;\n        return this;\n    }"
  },
  {
    "id": 16,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 25,
    "human_patch": "https://github.com/apache/httpcomponents-client/commit/0554271750599756d4946c0d7ba43d04b1a7b22",
    "cve_id": "HTTPCLIENT-1803",
    "cwe_id": "Not Mapping",
    "filename": "httpclient/src/main/java/org/apache/http/client/utils/URIBuilder.java",
    "is_vulnerable": 0,
    "class_name": "URIBuilder",
    "subclass_name": null,
    "function_name": "setFragment(final String fragment)",
    "function_body": "{\n        this.fragment = fragment;\n        this.encodedFragment = null;\n        return this;\n    }"
  },
  {
    "id": 16,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 26,
    "human_patch": "https://github.com/apache/httpcomponents-client/commit/0554271750599756d4946c0d7ba43d04b1a7b22",
    "cve_id": "HTTPCLIENT-1803",
    "cwe_id": "Not Mapping",
    "filename": "httpclient/src/main/java/org/apache/http/client/utils/URIBuilder.java",
    "is_vulnerable": 0,
    "class_name": "URIBuilder",
    "subclass_name": null,
    "function_name": "isAbsolute()",
    "function_body": "{\n        return this.scheme != null;\n    }"
  },
  {
    "id": 16,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 27,
    "human_patch": "https://github.com/apache/httpcomponents-client/commit/0554271750599756d4946c0d7ba43d04b1a7b22",
    "cve_id": "HTTPCLIENT-1803",
    "cwe_id": "Not Mapping",
    "filename": "httpclient/src/main/java/org/apache/http/client/utils/URIBuilder.java",
    "is_vulnerable": 0,
    "class_name": "URIBuilder",
    "subclass_name": null,
    "function_name": "isOpaque()",
    "function_body": "{\n        return this.path == null;\n    }"
  },
  {
    "id": 16,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 28,
    "human_patch": "https://github.com/apache/httpcomponents-client/commit/0554271750599756d4946c0d7ba43d04b1a7b22",
    "cve_id": "HTTPCLIENT-1803",
    "cwe_id": "Not Mapping",
    "filename": "httpclient/src/main/java/org/apache/http/client/utils/URIBuilder.java",
    "is_vulnerable": 0,
    "class_name": "URIBuilder",
    "subclass_name": null,
    "function_name": "getScheme()",
    "function_body": "{\n        return this.scheme;\n    }"
  },
  {
    "id": 16,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 29,
    "human_patch": "https://github.com/apache/httpcomponents-client/commit/0554271750599756d4946c0d7ba43d04b1a7b22",
    "cve_id": "HTTPCLIENT-1803",
    "cwe_id": "Not Mapping",
    "filename": "httpclient/src/main/java/org/apache/http/client/utils/URIBuilder.java",
    "is_vulnerable": 0,
    "class_name": "URIBuilder",
    "subclass_name": null,
    "function_name": "getUserInfo()",
    "function_body": "{\n        return this.userInfo;\n    }"
  },
  {
    "id": 16,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 30,
    "human_patch": "https://github.com/apache/httpcomponents-client/commit/0554271750599756d4946c0d7ba43d04b1a7b22",
    "cve_id": "HTTPCLIENT-1803",
    "cwe_id": "Not Mapping",
    "filename": "httpclient/src/main/java/org/apache/http/client/utils/URIBuilder.java",
    "is_vulnerable": 0,
    "class_name": "URIBuilder",
    "subclass_name": null,
    "function_name": "getHost()",
    "function_body": "{\n        return this.host;\n    }"
  },
  {
    "id": 16,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 31,
    "human_patch": "https://github.com/apache/httpcomponents-client/commit/0554271750599756d4946c0d7ba43d04b1a7b22",
    "cve_id": "HTTPCLIENT-1803",
    "cwe_id": "Not Mapping",
    "filename": "httpclient/src/main/java/org/apache/http/client/utils/URIBuilder.java",
    "is_vulnerable": 0,
    "class_name": "URIBuilder",
    "subclass_name": null,
    "function_name": "getPort()",
    "function_body": "{\n        return this.port;\n    }"
  },
  {
    "id": 16,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 32,
    "human_patch": "https://github.com/apache/httpcomponents-client/commit/0554271750599756d4946c0d7ba43d04b1a7b22",
    "cve_id": "HTTPCLIENT-1803",
    "cwe_id": "Not Mapping",
    "filename": "httpclient/src/main/java/org/apache/http/client/utils/URIBuilder.java",
    "is_vulnerable": 0,
    "class_name": "URIBuilder",
    "subclass_name": null,
    "function_name": "getPath()",
    "function_body": "{\n        return this.path;\n    }"
  },
  {
    "id": 16,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 33,
    "human_patch": "https://github.com/apache/httpcomponents-client/commit/0554271750599756d4946c0d7ba43d04b1a7b22",
    "cve_id": "HTTPCLIENT-1803",
    "cwe_id": "Not Mapping",
    "filename": "httpclient/src/main/java/org/apache/http/client/utils/URIBuilder.java",
    "is_vulnerable": 0,
    "class_name": "URIBuilder",
    "subclass_name": null,
    "function_name": "getQueryParams()",
    "function_body": "{\n        if (this.queryParams != null) {\n            return new ArrayList<NameValuePair>(this.queryParams);\n        } else {\n            return new ArrayList<NameValuePair>();\n        }\n    }"
  },
  {
    "id": 16,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 34,
    "human_patch": "https://github.com/apache/httpcomponents-client/commit/0554271750599756d4946c0d7ba43d04b1a7b22",
    "cve_id": "HTTPCLIENT-1803",
    "cwe_id": "Not Mapping",
    "filename": "httpclient/src/main/java/org/apache/http/client/utils/URIBuilder.java",
    "is_vulnerable": 0,
    "class_name": "URIBuilder",
    "subclass_name": null,
    "function_name": "getFragment()",
    "function_body": "{\n        return this.fragment;\n    }"
  },
  {
    "id": 16,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 35,
    "human_patch": "https://github.com/apache/httpcomponents-client/commit/0554271750599756d4946c0d7ba43d04b1a7b22",
    "cve_id": "HTTPCLIENT-1803",
    "cwe_id": "Not Mapping",
    "filename": "httpclient/src/main/java/org/apache/http/client/utils/URIBuilder.java",
    "is_vulnerable": 0,
    "class_name": "URIBuilder",
    "subclass_name": null,
    "function_name": "toString()",
    "function_body": "{\n        return buildString();\n    }"
  },
  {
    "id": 16,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 36,
    "human_patch": "https://github.com/apache/httpcomponents-client/commit/0554271750599756d4946c0d7ba43d04b1a7b22",
    "cve_id": "HTTPCLIENT-1803",
    "cwe_id": "Not Mapping",
    "filename": "httpclient/src/main/java/org/apache/http/client/utils/URIBuilder.java",
    "is_vulnerable": 1,
    "class_name": "URIBuilder",
    "subclass_name": null,
    "function_name": "normalizePath(final String path)",
    "function_body": "{\n        String s = path;\n        if (s == null) {\n            return null;\n        }\n        int n = 0;\n        for (; n < s.length(); n++) {\n            if (s.charAt(n) != '/') {\n                break;\n            }\n        }\n        if (n > 1) {\n            s = s.substring(n - 1);\n        }\n        return s;\n    }"
  },
  {
    "id": 16,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 0,
    "human_patch": "https://github.com/apache/httpcomponents-client/commit/0554271750599756d4946c0d7ba43d04b1a7b22",
    "cve_id": "HTTPCLIENT-1803",
    "cwe_id": "Not Mapping",
    "filename": "httpclient/src/test/java/org/apache/http/client/utils/TestURIBuilder.java",
    "is_vulnerable": 0,
    "class_name": "TestURIBuilder",
    "subclass_name": null,
    "function_name": "testHierarchicalUri() throws Exception",
    "function_body": "{\n        final URI uri = new URI(\"http\", \"stuff\", \"localhost\", 80, \"/some stuff\", \"param=stuff\", \"fragment\");\n        final URIBuilder uribuilder = new URIBuilder(uri);\n        final URI result = uribuilder.build();\n        Assert.assertEquals(new URI(\"http://stuff@localhost:80/some%20stuff?param=stuff#fragment\"), result);\n    }"
  },
  {
    "id": 16,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 1,
    "human_patch": "https://github.com/apache/httpcomponents-client/commit/0554271750599756d4946c0d7ba43d04b1a7b22",
    "cve_id": "HTTPCLIENT-1803",
    "cwe_id": "Not Mapping",
    "filename": "httpclient/src/test/java/org/apache/http/client/utils/TestURIBuilder.java",
    "is_vulnerable": 0,
    "class_name": "TestURIBuilder",
    "subclass_name": null,
    "function_name": "testMutationToRelativeUri() throws Exception",
    "function_body": "{\n        final URI uri = new URI(\"http://stuff@localhost:80/stuff?param=stuff#fragment\");\n        final URIBuilder uribuilder = new URIBuilder(uri).setHost(null);\n        final URI result = uribuilder.build();\n        Assert.assertEquals(new URI(\"http:///stuff?param=stuff#fragment\"), result);\n    }"
  },
  {
    "id": 16,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 2,
    "human_patch": "https://github.com/apache/httpcomponents-client/commit/0554271750599756d4946c0d7ba43d04b1a7b22",
    "cve_id": "HTTPCLIENT-1803",
    "cwe_id": "Not Mapping",
    "filename": "httpclient/src/test/java/org/apache/http/client/utils/TestURIBuilder.java",
    "is_vulnerable": 0,
    "class_name": "TestURIBuilder",
    "subclass_name": null,
    "function_name": "testMutationRemoveFragment() throws Exception",
    "function_body": "{\n        final URI uri = new URI(\"http://stuff@localhost:80/stuff?param=stuff#fragment\");\n        final URI result = new URIBuilder(uri).setFragment(null).build();\n        Assert.assertEquals(new URI(\"http://stuff@localhost:80/stuff?param=stuff\"), result);\n    }"
  },
  {
    "id": 16,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 3,
    "human_patch": "https://github.com/apache/httpcomponents-client/commit/0554271750599756d4946c0d7ba43d04b1a7b22",
    "cve_id": "HTTPCLIENT-1803",
    "cwe_id": "Not Mapping",
    "filename": "httpclient/src/test/java/org/apache/http/client/utils/TestURIBuilder.java",
    "is_vulnerable": 0,
    "class_name": "TestURIBuilder",
    "subclass_name": null,
    "function_name": "testMutationRemoveUserInfo() throws Exception",
    "function_body": "{\n        final URI uri = new URI(\"http://stuff@localhost:80/stuff?param=stuff#fragment\");\n        final URI result = new URIBuilder(uri).setUserInfo(null).build();\n        Assert.assertEquals(new URI(\"http://localhost:80/stuff?param=stuff#fragment\"), result);\n    }"
  },
  {
    "id": 16,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 4,
    "human_patch": "https://github.com/apache/httpcomponents-client/commit/0554271750599756d4946c0d7ba43d04b1a7b22",
    "cve_id": "HTTPCLIENT-1803",
    "cwe_id": "Not Mapping",
    "filename": "httpclient/src/test/java/org/apache/http/client/utils/TestURIBuilder.java",
    "is_vulnerable": 0,
    "class_name": "TestURIBuilder",
    "subclass_name": null,
    "function_name": "testMutationRemovePort() throws Exception",
    "function_body": "{\n        final URI uri = new URI(\"http://stuff@localhost:80/stuff?param=stuff#fragment\");\n        final URI result = new URIBuilder(uri).setPort(-1).build();\n        Assert.assertEquals(new URI(\"http://stuff@localhost/stuff?param=stuff#fragment\"), result);\n    }"
  },
  {
    "id": 16,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 5,
    "human_patch": "https://github.com/apache/httpcomponents-client/commit/0554271750599756d4946c0d7ba43d04b1a7b22",
    "cve_id": "HTTPCLIENT-1803",
    "cwe_id": "Not Mapping",
    "filename": "httpclient/src/test/java/org/apache/http/client/utils/TestURIBuilder.java",
    "is_vulnerable": 0,
    "class_name": "TestURIBuilder",
    "subclass_name": null,
    "function_name": "testOpaqueUri() throws Exception",
    "function_body": "{\n        final URI uri = new URI(\"stuff\", \"some-stuff\", \"fragment\");\n        final URIBuilder uribuilder = new URIBuilder(uri);\n        final URI result = uribuilder.build();\n        Assert.assertEquals(uri, result);\n    }"
  },
  {
    "id": 16,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 6,
    "human_patch": "https://github.com/apache/httpcomponents-client/commit/0554271750599756d4946c0d7ba43d04b1a7b22",
    "cve_id": "HTTPCLIENT-1803",
    "cwe_id": "Not Mapping",
    "filename": "httpclient/src/test/java/org/apache/http/client/utils/TestURIBuilder.java",
    "is_vulnerable": 0,
    "class_name": "TestURIBuilder",
    "subclass_name": null,
    "function_name": "testOpaqueUriMutation() throws Exception",
    "function_body": "{\n        final URI uri = new URI(\"stuff\", \"some-stuff\", \"fragment\");\n        final URIBuilder uribuilder = new URIBuilder(uri).setCustomQuery(\"param1&param2=stuff\").setFragment(null);\n        Assert.assertEquals(new URI(\"stuff:?param1&param2=stuff\"), uribuilder.build());\n    }"
  },
  {
    "id": 16,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 7,
    "human_patch": "https://github.com/apache/httpcomponents-client/commit/0554271750599756d4946c0d7ba43d04b1a7b22",
    "cve_id": "HTTPCLIENT-1803",
    "cwe_id": "Not Mapping",
    "filename": "httpclient/src/test/java/org/apache/http/client/utils/TestURIBuilder.java",
    "is_vulnerable": 0,
    "class_name": "TestURIBuilder",
    "subclass_name": null,
    "function_name": "testHierarchicalUriMutation() throws Exception",
    "function_body": "{\n        final URIBuilder uribuilder = new URIBuilder(\"/\").setScheme(\"http\").setHost(\"localhost\").setPort(80).setPath(\"/stuff\");\n        Assert.assertEquals(new URI(\"http://localhost:80/stuff\"), uribuilder.build());\n    }"
  },
  {
    "id": 16,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 8,
    "human_patch": "https://github.com/apache/httpcomponents-client/commit/0554271750599756d4946c0d7ba43d04b1a7b22",
    "cve_id": "HTTPCLIENT-1803",
    "cwe_id": "Not Mapping",
    "filename": "httpclient/src/test/java/org/apache/http/client/utils/TestURIBuilder.java",
    "is_vulnerable": 0,
    "class_name": "TestURIBuilder",
    "subclass_name": null,
    "function_name": "testEmpty() throws Exception",
    "function_body": "{\n        final URIBuilder uribuilder = new URIBuilder();\n        final URI result = uribuilder.build();\n        Assert.assertEquals(new URI(\"\"), result);\n    }"
  },
  {
    "id": 16,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 9,
    "human_patch": "https://github.com/apache/httpcomponents-client/commit/0554271750599756d4946c0d7ba43d04b1a7b22",
    "cve_id": "HTTPCLIENT-1803",
    "cwe_id": "Not Mapping",
    "filename": "httpclient/src/test/java/org/apache/http/client/utils/TestURIBuilder.java",
    "is_vulnerable": 0,
    "class_name": "TestURIBuilder",
    "subclass_name": null,
    "function_name": "testSetUserInfo() throws Exception",
    "function_body": "{\n        final URI uri = new URI(\"http\", null, \"localhost\", 80, \"/\", \"param=stuff\", null);\n        final URIBuilder uribuilder = new URIBuilder(uri).setUserInfo(\"user\", \"password\");\n        final URI result = uribuilder.build();\n        Assert.assertEquals(new URI(\"http://user:password@localhost:80/?param=stuff\"), result);\n    }"
  },
  {
    "id": 16,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 10,
    "human_patch": "https://github.com/apache/httpcomponents-client/commit/0554271750599756d4946c0d7ba43d04b1a7b22",
    "cve_id": "HTTPCLIENT-1803",
    "cwe_id": "Not Mapping",
    "filename": "httpclient/src/test/java/org/apache/http/client/utils/TestURIBuilder.java",
    "is_vulnerable": 0,
    "class_name": "TestURIBuilder",
    "subclass_name": null,
    "function_name": "testRemoveParameters() throws Exception",
    "function_body": "{\n        final URI uri = new URI(\"http\", null, \"localhost\", 80, \"/\", \"param=stuff\", null);\n        final URIBuilder uribuilder = new URIBuilder(uri).removeQuery();\n        final URI result = uribuilder.build();\n        Assert.assertEquals(new URI(\"http://localhost:80/\"), result);\n    }"
  },
  {
    "id": 16,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 11,
    "human_patch": "https://github.com/apache/httpcomponents-client/commit/0554271750599756d4946c0d7ba43d04b1a7b22",
    "cve_id": "HTTPCLIENT-1803",
    "cwe_id": "Not Mapping",
    "filename": "httpclient/src/test/java/org/apache/http/client/utils/TestURIBuilder.java",
    "is_vulnerable": 0,
    "class_name": "TestURIBuilder",
    "subclass_name": null,
    "function_name": "testSetParameter() throws Exception",
    "function_body": "{\n        final URI uri = new URI(\"http\", null, \"localhost\", 80, \"/\", \"param=stuff&blah&blah\", null);\n        final URIBuilder uribuilder = new URIBuilder(uri).setParameter(\"param\", \"some other stuff\")\n            .setParameter(\"blah\", \"blah\");\n        final URI result = uribuilder.build();\n        Assert.assertEquals(new URI(\"http://localhost:80/?param=some+other+stuff&blah=blah\"), result);\n    }"
  },
  {
    "id": 16,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 12,
    "human_patch": "https://github.com/apache/httpcomponents-client/commit/0554271750599756d4946c0d7ba43d04b1a7b22",
    "cve_id": "HTTPCLIENT-1803",
    "cwe_id": "Not Mapping",
    "filename": "httpclient/src/test/java/org/apache/http/client/utils/TestURIBuilder.java",
    "is_vulnerable": 0,
    "class_name": "TestURIBuilder",
    "subclass_name": null,
    "function_name": "testParameterWithSpecialChar() throws Exception",
    "function_body": "{\n        final URI uri = new URI(\"http\", null, \"localhost\", 80, \"/\", \"param=stuff\", null);\n        final URIBuilder uribuilder = new URIBuilder(uri).addParameter(\"param\", \"1 + 1 = 2\")\n            .addParameter(\"param\", \"blah&blah\");\n        final URI result = uribuilder.build();\n        Assert.assertEquals(new URI(\"http://localhost:80/?param=stuff&param=1+%2B+1+%3D+2&\" +\n                \"param=blah%26blah\"), result);\n    }"
  },
  {
    "id": 16,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 13,
    "human_patch": "https://github.com/apache/httpcomponents-client/commit/0554271750599756d4946c0d7ba43d04b1a7b22",
    "cve_id": "HTTPCLIENT-1803",
    "cwe_id": "Not Mapping",
    "filename": "httpclient/src/test/java/org/apache/http/client/utils/TestURIBuilder.java",
    "is_vulnerable": 0,
    "class_name": "TestURIBuilder",
    "subclass_name": null,
    "function_name": "testAddParameter() throws Exception",
    "function_body": "{\n        final URI uri = new URI(\"http\", null, \"localhost\", 80, \"/\", \"param=stuff&blah&blah\", null);\n        final URIBuilder uribuilder = new URIBuilder(uri).addParameter(\"param\", \"some other stuff\")\n            .addParameter(\"blah\", \"blah\");\n        final URI result = uribuilder.build();\n        Assert.assertEquals(new URI(\"http://localhost:80/?param=stuff&blah&blah&\" +\n                \"param=some+other+stuff&blah=blah\"), result);\n    }"
  },
  {
    "id": 16,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 14,
    "human_patch": "https://github.com/apache/httpcomponents-client/commit/0554271750599756d4946c0d7ba43d04b1a7b22",
    "cve_id": "HTTPCLIENT-1803",
    "cwe_id": "Not Mapping",
    "filename": "httpclient/src/test/java/org/apache/http/client/utils/TestURIBuilder.java",
    "is_vulnerable": 0,
    "class_name": "TestURIBuilder",
    "subclass_name": null,
    "function_name": "testQueryEncoding() throws Exception",
    "function_body": "{\n        final URI uri1 = new URI(\"https://somehost.com/stuff?client_id=1234567890\" +\n                \"&redirect_uri=https%3A%2F%2Fsomehost.com%2Fblah+blah%2F\");\n        final URI uri2 = new URIBuilder(\"https://somehost.com/stuff\")\n            .addParameter(\"client_id\",\"1234567890\")\n            .addParameter(\"redirect_uri\",\"https://somehost.com/blah blah/\").build();\n        Assert.assertEquals(uri1, uri2);\n    }"
  },
  {
    "id": 16,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 15,
    "human_patch": "https://github.com/apache/httpcomponents-client/commit/0554271750599756d4946c0d7ba43d04b1a7b22",
    "cve_id": "HTTPCLIENT-1803",
    "cwe_id": "Not Mapping",
    "filename": "httpclient/src/test/java/org/apache/http/client/utils/TestURIBuilder.java",
    "is_vulnerable": 0,
    "class_name": "TestURIBuilder",
    "subclass_name": null,
    "function_name": "testQueryAndParameterEncoding() throws Exception",
    "function_body": "{\n        final URI uri1 = new URI(\"https://somehost.com/stuff?param1=12345&param2=67890\");\n        final URI uri2 = new URIBuilder(\"https://somehost.com/stuff\")\n            .setCustomQuery(\"this&that\")\n            .addParameter(\"param1\",\"12345\")\n            .addParameter(\"param2\",\"67890\").build();\n        Assert.assertEquals(uri1, uri2);\n    }"
  },
  {
    "id": 16,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 16,
    "human_patch": "https://github.com/apache/httpcomponents-client/commit/0554271750599756d4946c0d7ba43d04b1a7b22",
    "cve_id": "HTTPCLIENT-1803",
    "cwe_id": "Not Mapping",
    "filename": "httpclient/src/test/java/org/apache/http/client/utils/TestURIBuilder.java",
    "is_vulnerable": 0,
    "class_name": "TestURIBuilder",
    "subclass_name": null,
    "function_name": "testPathEncoding() throws Exception",
    "function_body": "{\n        final URI uri1 = new URI(\"https://somehost.com/some%20path%20with%20blanks/\");\n        final URI uri2 = new URIBuilder()\n            .setScheme(\"https\")\n            .setHost(\"somehost.com\")\n            .setPath(\"/some path with blanks/\")\n            .build();\n        Assert.assertEquals(uri1, uri2);\n    }"
  },
  {
    "id": 16,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 17,
    "human_patch": "https://github.com/apache/httpcomponents-client/commit/0554271750599756d4946c0d7ba43d04b1a7b22",
    "cve_id": "HTTPCLIENT-1803",
    "cwe_id": "Not Mapping",
    "filename": "httpclient/src/test/java/org/apache/http/client/utils/TestURIBuilder.java",
    "is_vulnerable": 0,
    "class_name": "TestURIBuilder",
    "subclass_name": null,
    "function_name": "testAgainstURI() throws Exception",
    "function_body": "{\n        \n        final String scheme=\"https\";\n        final String host=\"localhost\";\n        final String specials=\"/abcd!$&*()_-+.,=:;'~@[]?<>|#^%\\\"{}\\\\\\u00a3`\\u00ac\\u00a6xyz\"; \n        final URI uri = new URI(scheme, specials, host, 80, specials, specials, specials);\n\n        final URI bld = new URIBuilder()\n                .setScheme(scheme)\n                .setHost(host)\n                .setUserInfo(specials)\n                .setPath(specials)\n                .setCustomQuery(specials)\n                .setFragment(specials)\n                .build();\n\n        Assert.assertEquals(uri.getHost(), bld.getHost());\n\n        Assert.assertEquals(uri.getUserInfo(), bld.getUserInfo());\n\n        Assert.assertEquals(uri.getPath(), bld.getPath());\n\n        Assert.assertEquals(uri.getQuery(), bld.getQuery());\n\n        Assert.assertEquals(uri.getFragment(), bld.getFragment());\n\n    }"
  },
  {
    "id": 16,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 18,
    "human_patch": "https://github.com/apache/httpcomponents-client/commit/0554271750599756d4946c0d7ba43d04b1a7b22",
    "cve_id": "HTTPCLIENT-1803",
    "cwe_id": "Not Mapping",
    "filename": "httpclient/src/test/java/org/apache/http/client/utils/TestURIBuilder.java",
    "is_vulnerable": 0,
    "class_name": "TestURIBuilder",
    "subclass_name": null,
    "function_name": "testAgainstURIEncoded() throws Exception",
    "function_body": "{\n        \n        final String scheme=\"https\";\n        final String host=\"localhost\";\n        final String specials=\"/ abcd!$&*()_-+.,=:;'~<>/@[]|#^%\\\"{}\\\\`xyz\"; \n        final URI uri = new URI(scheme, specials, host, 80, specials, specials, specials);\n\n        final URI bld = new URIBuilder()\n                .setScheme(scheme)\n                .setHost(host)\n                .setUserInfo(specials)\n                .setPath(specials)\n                .setCustomQuery(specials)\n                .setFragment(specials)\n                .build();\n\n        Assert.assertEquals(uri.getHost(), bld.getHost());\n\n        Assert.assertEquals(uri.getRawUserInfo(), bld.getRawUserInfo());\n\n        Assert.assertEquals(uri.getRawPath(), bld.getRawPath());\n\n        Assert.assertEquals(uri.getRawQuery(), bld.getRawQuery());\n\n        Assert.assertEquals(uri.getRawFragment(), bld.getRawFragment());\n\n    }"
  },
  {
    "id": 16,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 19,
    "human_patch": "https://github.com/apache/httpcomponents-client/commit/0554271750599756d4946c0d7ba43d04b1a7b22",
    "cve_id": "HTTPCLIENT-1803",
    "cwe_id": "Not Mapping",
    "filename": "httpclient/src/test/java/org/apache/http/client/utils/TestURIBuilder.java",
    "is_vulnerable": 0,
    "class_name": "TestURIBuilder",
    "subclass_name": null,
    "function_name": "testBuildAddParametersUTF8() throws Exception",
    "function_body": "{\n        assertAddParameters(Consts.UTF_8);\n    }"
  },
  {
    "id": 16,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 20,
    "human_patch": "https://github.com/apache/httpcomponents-client/commit/0554271750599756d4946c0d7ba43d04b1a7b22",
    "cve_id": "HTTPCLIENT-1803",
    "cwe_id": "Not Mapping",
    "filename": "httpclient/src/test/java/org/apache/http/client/utils/TestURIBuilder.java",
    "is_vulnerable": 0,
    "class_name": "TestURIBuilder",
    "subclass_name": null,
    "function_name": "testBuildAddParametersISO88591() throws Exception",
    "function_body": "{\n        assertAddParameters(Consts.ISO_8859_1);\n    }"
  },
  {
    "id": 16,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 21,
    "human_patch": "https://github.com/apache/httpcomponents-client/commit/0554271750599756d4946c0d7ba43d04b1a7b22",
    "cve_id": "HTTPCLIENT-1803",
    "cwe_id": "Not Mapping",
    "filename": "httpclient/src/test/java/org/apache/http/client/utils/TestURIBuilder.java",
    "is_vulnerable": 0,
    "class_name": "TestURIBuilder",
    "subclass_name": null,
    "function_name": "assertAddParameters(final Charset charset) throws Exception",
    "function_body": "{\n        final URI uri = new URIBuilder(\"https://somehost.com/stuff\")\n                .setCharset(charset)\n                .addParameters(createParameters()).build();\n\n        assertBuild(charset, uri);\n    }"
  },
  {
    "id": 16,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 22,
    "human_patch": "https://github.com/apache/httpcomponents-client/commit/0554271750599756d4946c0d7ba43d04b1a7b22",
    "cve_id": "HTTPCLIENT-1803",
    "cwe_id": "Not Mapping",
    "filename": "httpclient/src/test/java/org/apache/http/client/utils/TestURIBuilder.java",
    "is_vulnerable": 0,
    "class_name": "TestURIBuilder",
    "subclass_name": null,
    "function_name": "testBuildSetParametersUTF8() throws Exception",
    "function_body": "{\n        assertSetParameters(Consts.UTF_8);\n    }"
  },
  {
    "id": 16,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 23,
    "human_patch": "https://github.com/apache/httpcomponents-client/commit/0554271750599756d4946c0d7ba43d04b1a7b22",
    "cve_id": "HTTPCLIENT-1803",
    "cwe_id": "Not Mapping",
    "filename": "httpclient/src/test/java/org/apache/http/client/utils/TestURIBuilder.java",
    "is_vulnerable": 0,
    "class_name": "TestURIBuilder",
    "subclass_name": null,
    "function_name": "testBuildSetParametersISO88591() throws Exception",
    "function_body": "{\n        assertSetParameters(Consts.ISO_8859_1);\n    }"
  },
  {
    "id": 16,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 24,
    "human_patch": "https://github.com/apache/httpcomponents-client/commit/0554271750599756d4946c0d7ba43d04b1a7b22",
    "cve_id": "HTTPCLIENT-1803",
    "cwe_id": "Not Mapping",
    "filename": "httpclient/src/test/java/org/apache/http/client/utils/TestURIBuilder.java",
    "is_vulnerable": 0,
    "class_name": "TestURIBuilder",
    "subclass_name": null,
    "function_name": "assertSetParameters(final Charset charset) throws Exception",
    "function_body": "{\n        final URI uri = new URIBuilder(\"https://somehost.com/stuff\")\n                .setCharset(charset)\n                .setParameters(createParameters()).build();\n\n        assertBuild(charset, uri);\n    }"
  },
  {
    "id": 16,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 25,
    "human_patch": "https://github.com/apache/httpcomponents-client/commit/0554271750599756d4946c0d7ba43d04b1a7b22",
    "cve_id": "HTTPCLIENT-1803",
    "cwe_id": "Not Mapping",
    "filename": "httpclient/src/test/java/org/apache/http/client/utils/TestURIBuilder.java",
    "is_vulnerable": 0,
    "class_name": "TestURIBuilder",
    "subclass_name": null,
    "function_name": "assertBuild(final Charset charset, final URI uri) throws Exception",
    "function_body": "{\n        final String encodedData1 = URLEncoder.encode(\"\\\"1\\u00aa position\\\"\", charset.displayName());\n        final String encodedData2 = URLEncoder.encode(\"Jos\\u00e9 Abra\\u00e3o\", charset.displayName());\n\n        final String uriExpected = String.format(\"https://somehost.com/stuff?parameter1=value1&parameter2=%s&parameter3=%s\", encodedData1, encodedData2);\n\n        Assert.assertEquals(uriExpected, uri.toString());\n    }"
  },
  {
    "id": 16,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 26,
    "human_patch": "https://github.com/apache/httpcomponents-client/commit/0554271750599756d4946c0d7ba43d04b1a7b22",
    "cve_id": "HTTPCLIENT-1803",
    "cwe_id": "Not Mapping",
    "filename": "httpclient/src/test/java/org/apache/http/client/utils/TestURIBuilder.java",
    "is_vulnerable": 0,
    "class_name": "TestURIBuilder",
    "subclass_name": null,
    "function_name": "createParameters()",
    "function_body": "{\n        final List<NameValuePair> parameters = new ArrayList<NameValuePair>();\n        parameters.add(new BasicNameValuePair(\"parameter1\", \"value1\"));\n        parameters.add(new BasicNameValuePair(\"parameter2\", \"\\\"1\\u00aa position\\\"\"));\n        parameters.add(new BasicNameValuePair(\"parameter3\", \"Jos\\u00e9 Abra\\u00e3o\"));\n        return parameters;\n    }"
  },
  {
    "id": 17,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 0,
    "human_patch": "https://github.com/apache/jspwiki/commit/88d89d6523802c044cfcb7930cba40d8eeb21da2",
    "cve_id": "CVE-2019-0225",
    "cwe_id": "CWE-22",
    "filename": "jspwiki-main/src/main/java/org/apache/wiki/url/DefaultURLConstructor.java",
    "is_vulnerable": 0,
    "class_name": "DefaultURLConstructor",
    "subclass_name": null,
    "function_name": "initialize( WikiEngine engine,\n                            Properties properties )",
    "function_body": "{\n        m_engine = engine;\n\n        m_pathPrefix = engine.getBaseURL() + \"/\";\n    }"
  },
  {
    "id": 17,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 1,
    "human_patch": "https://github.com/apache/jspwiki/commit/88d89d6523802c044cfcb7930cba40d8eeb21da2",
    "cve_id": "CVE-2019-0225",
    "cwe_id": "CWE-22",
    "filename": "jspwiki-main/src/main/java/org/apache/wiki/url/DefaultURLConstructor.java",
    "is_vulnerable": 0,
    "class_name": "DefaultURLConstructor",
    "subclass_name": null,
    "function_name": "doReplacement( String baseptrn, String name, boolean absolute )",
    "function_body": "{\n        String baseurl = m_pathPrefix;\n\n        if( absolute ) baseurl = m_engine.getBaseURL() + \"/\";\n\n        baseptrn = TextUtil.replaceString( baseptrn, \"%u\", baseurl );\n        baseptrn = TextUtil.replaceString( baseptrn, \"%U\", m_engine.getBaseURL() );\n        baseptrn = TextUtil.replaceString( baseptrn, \"%n\", encodeURI(name) );\n        baseptrn = TextUtil.replaceString( baseptrn, \"%p\", m_pathPrefix );\n\n        return baseptrn;\n    }"
  },
  {
    "id": 17,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 2,
    "human_patch": "https://github.com/apache/jspwiki/commit/88d89d6523802c044cfcb7930cba40d8eeb21da2",
    "cve_id": "CVE-2019-0225",
    "cwe_id": "CWE-22",
    "filename": "jspwiki-main/src/main/java/org/apache/wiki/url/DefaultURLConstructor.java",
    "is_vulnerable": 0,
    "class_name": "DefaultURLConstructor",
    "subclass_name": null,
    "function_name": "encodeURI( String uri )",
    "function_body": "{\n        uri = m_engine.encodeName(uri);\n\n        uri = StringUtils.replace( uri, \"+\", \"%20\" );\n        uri = StringUtils.replace( uri, \"%2F\", \"/\" );\n\n        return uri;\n    }"
  },
  {
    "id": 17,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 3,
    "human_patch": "https://github.com/apache/jspwiki/commit/88d89d6523802c044cfcb7930cba40d8eeb21da2",
    "cve_id": "CVE-2019-0225",
    "cwe_id": "CWE-22",
    "filename": "jspwiki-main/src/main/java/org/apache/wiki/url/DefaultURLConstructor.java",
    "is_vulnerable": 0,
    "class_name": "DefaultURLConstructor",
    "subclass_name": null,
    "function_name": "getURLPattern( String context, String name ) throws IllegalArgumentException",
    "function_body": "{\n        if( context.equals(WikiContext.VIEW) && name == null)\n        {\n            \n            return \"%uWiki.jsp\";\n        }\n\n        \n        Command command = CommandResolver.findCommand( context );\n\n        return command.getURLPattern();\n    }"
  },
  {
    "id": 17,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 4,
    "human_patch": "https://github.com/apache/jspwiki/commit/88d89d6523802c044cfcb7930cba40d8eeb21da2",
    "cve_id": "CVE-2019-0225",
    "cwe_id": "CWE-22",
    "filename": "jspwiki-main/src/main/java/org/apache/wiki/url/DefaultURLConstructor.java",
    "is_vulnerable": 0,
    "class_name": "DefaultURLConstructor",
    "subclass_name": null,
    "function_name": "makeURL( String context,\n                            String name,\n                            boolean absolute )",
    "function_body": "{\n        return doReplacement( getURLPattern(context,name), name, absolute );\n    }"
  },
  {
    "id": 17,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 5,
    "human_patch": "https://github.com/apache/jspwiki/commit/88d89d6523802c044cfcb7930cba40d8eeb21da2",
    "cve_id": "CVE-2019-0225",
    "cwe_id": "CWE-22",
    "filename": "jspwiki-main/src/main/java/org/apache/wiki/url/DefaultURLConstructor.java",
    "is_vulnerable": 0,
    "class_name": "DefaultURLConstructor",
    "subclass_name": null,
    "function_name": "makeURL( String context,\n                           String name,\n                           boolean absolute,\n                           String parameters )",
    "function_body": "{\n        if( parameters != null && parameters.length() > 0 )\n        {\n            if( context.equals(WikiContext.ATTACH) )\n            {\n                parameters = \"?\"+parameters;\n            }\n            else if( context.equals(WikiContext.NONE) )\n            {\n                parameters = (name.indexOf('?') != -1 ) ? \"&amp;\" : \"?\" + parameters;\n            }\n            else\n            {\n                parameters = \"&amp;\"+parameters;\n            }\n        }\n        else\n        {\n            parameters = \"\";\n        }\n        return makeURL( context, name, absolute )+parameters;\n    }"
  },
  {
    "id": 17,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 6,
    "human_patch": "https://github.com/apache/jspwiki/commit/88d89d6523802c044cfcb7930cba40d8eeb21da2",
    "cve_id": "CVE-2019-0225",
    "cwe_id": "CWE-22",
    "filename": "jspwiki-main/src/main/java/org/apache/wiki/url/DefaultURLConstructor.java",
    "is_vulnerable": 0,
    "class_name": "DefaultURLConstructor",
    "subclass_name": null,
    "function_name": "parsePage( String context,\n                             HttpServletRequest request,\n                             String encoding ) throws UnsupportedEncodingException",
    "function_body": "{\n        String pagereq = request.getParameter( \"page\" );\n\n        if( context.equals(WikiContext.ATTACH) )\n        {\n            pagereq = parsePageFromURL( request, encoding );\n        }\n\n        return pagereq;\n    }"
  },
  {
    "id": 17,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 7,
    "human_patch": "https://github.com/apache/jspwiki/commit/88d89d6523802c044cfcb7930cba40d8eeb21da2",
    "cve_id": "CVE-2019-0225",
    "cwe_id": "CWE-22",
    "filename": "jspwiki-main/src/main/java/org/apache/wiki/url/DefaultURLConstructor.java",
    "is_vulnerable": 0,
    "class_name": "DefaultURLConstructor",
    "subclass_name": null,
    "function_name": "parsePageFromURL( HttpServletRequest request,\n                                           String encoding ) throws UnsupportedEncodingException",
    "function_body": "{\n        String name = request.getPathInfo();\n\n        if( name == null || name.length() <= 1 )\n        {\n            return null;\n        }\n        else if( name.charAt(0) == '/' )\n        {\n            name = name.substring(1);\n        }\n\n        \n        \n        \n        \n\n        \n\n        return name;\n    }"
  },
  {
    "id": 17,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 8,
    "human_patch": "https://github.com/apache/jspwiki/commit/88d89d6523802c044cfcb7930cba40d8eeb21da2",
    "cve_id": "CVE-2019-0225",
    "cwe_id": "CWE-22",
    "filename": "jspwiki-main/src/main/java/org/apache/wiki/url/DefaultURLConstructor.java",
    "is_vulnerable": 1,
    "class_name": "DefaultURLConstructor",
    "subclass_name": null,
    "function_name": "getForwardPage( HttpServletRequest request )",
    "function_body": "{\n        return request.getPathInfo();\n    }"
  },
  {
    "id": 18,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 0,
    "human_patch": "https://github.com/bqcuong/vul4j/commit/c90825da4d28d7b1ae9b1484b9a010206be3dec5",
    "cve_id": "PDFBOX-3341",
    "cwe_id": "Not Mapping",
    "filename": "pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java",
    "is_vulnerable": 0,
    "class_name": "StandardSecurityHandler",
    "subclass_name": null,
    "function_name": "computeVersionNumber()",
    "function_body": "{\n        if(keyLength == 40)\n        {\n            return DEFAULT_VERSION;\n        }\n        else if (keyLength == 128 && policy.isPreferAES())\n        {\n            return 4;\n        }\n        else if (keyLength == 256)\n        {\n            return 5;\n        }\n\n        return 2;\n    }"
  },
  {
    "id": 18,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 1,
    "human_patch": "https://github.com/bqcuong/vul4j/commit/c90825da4d28d7b1ae9b1484b9a010206be3dec5",
    "cve_id": "PDFBOX-3341",
    "cwe_id": "Not Mapping",
    "filename": "pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java",
    "is_vulnerable": 0,
    "class_name": "StandardSecurityHandler",
    "subclass_name": null,
    "function_name": "computeRevisionNumber(int version)",
    "function_body": "{\n        if(version < 2 && !policy.getPermissions().hasAnyRevision3PermissionSet())\n        {\n            return 2;\n        }\n        if (version == 5)\n        {\n            \n            return 6;    \n        }\n        if (version == 4)\n        {\n            return 4;\n        }\n        if ( version == 2 || version == 3 || policy.getPermissions().hasAnyRevision3PermissionSet())\n        {\n            return 3;\n        }\n        return 4;\n    }"
  },
  {
    "id": 18,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 2,
    "human_patch": "https://github.com/bqcuong/vul4j/commit/c90825da4d28d7b1ae9b1484b9a010206be3dec5",
    "cve_id": "PDFBOX-3341",
    "cwe_id": "Not Mapping",
    "filename": "pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java",
    "is_vulnerable": 1,
    "class_name": "StandardSecurityHandler",
    "subclass_name": null,
    "function_name": "prepareForDecryption(PDEncryption encryption, COSArray documentIDArray,\n                                     DecryptionMaterial decryptionMaterial) throws IOException",
    "function_body": "{\n        if(!(decryptionMaterial instanceof StandardDecryptionMaterial))\n        {\n            throw new IOException(\"Decryption material is not compatible with the document\");\n        }\n        setDecryptMetadata(encryption.isEncryptMetaData());\n        StandardDecryptionMaterial material = (StandardDecryptionMaterial)decryptionMaterial;\n\n        String password = material.getPassword();\n        if(password == null)\n        {\n            password = \"\";\n        }\n\n        int dicPermissions = encryption.getPermissions();\n        int dicRevision = encryption.getRevision();\n        int dicLength = encryption.getVersion() == 1 ? 5 : encryption.getLength() / 8;\n\n        byte[] documentIDBytes = getDocumentIDBytes(documentIDArray);\n\n        \n        boolean encryptMetadata = encryption.isEncryptMetaData();\n        \n        byte[] userKey = encryption.getUserKey();\n        byte[] ownerKey = encryption.getOwnerKey();\n        byte[] ue = null, oe = null;\n\n        Charset passwordCharset = Charsets.ISO_8859_1;\n        if (dicRevision == 6 || dicRevision == 5)\n        {\n            passwordCharset = Charsets.UTF_8;\n            ue = encryption.getUserEncryptionKey();\n            oe = encryption.getOwnerEncryptionKey();\n        }\n        \n        AccessPermission currentAccessPermission;\n\n        if( isOwnerPassword(password.getBytes(passwordCharset), userKey, ownerKey,\n                                 dicPermissions, documentIDBytes, dicRevision,\n                                 dicLength, encryptMetadata) )\n        {\n            currentAccessPermission = AccessPermission.getOwnerAccessPermission();\n            setCurrentAccessPermission(currentAccessPermission);\n            \n            byte[] computedPassword;\n            if (dicRevision == 6 || dicRevision == 5)\n            {\n                computedPassword = password.getBytes(passwordCharset);\n            }\n            else\n            {\n                computedPassword = getUserPassword(password.getBytes(passwordCharset),\n                        ownerKey, dicRevision, dicLength );\n            }\n            \n            encryptionKey =\n                computeEncryptedKey(\n                    computedPassword,\n                    ownerKey, userKey, oe, ue,\n                    dicPermissions,\n                    documentIDBytes,\n                    dicRevision,\n                    dicLength,\n                    encryptMetadata, true );\n        }\n        else if( isUserPassword(password.getBytes(passwordCharset), userKey, ownerKey,\n                           dicPermissions, documentIDBytes, dicRevision,\n                           dicLength, encryptMetadata) )\n        {\n            currentAccessPermission = new AccessPermission(dicPermissions);\n            setCurrentAccessPermission(currentAccessPermission);\n            \n            encryptionKey =\n                computeEncryptedKey(\n                    password.getBytes(passwordCharset),\n                    ownerKey, userKey, oe, ue,\n                    dicPermissions,\n                    documentIDBytes,\n                    dicRevision,\n                    dicLength,\n                    encryptMetadata, false );\n        }\n        else\n        {\n            throw new InvalidPasswordException(\"Cannot decrypt PDF, the password is incorrect\");\n        }\n\n        if (dicRevision == 6 || dicRevision == 5)\n        {\n            validatePerms(encryption, dicPermissions, encryptMetadata);\n        }\n\n        if (encryption.getVersion() == 4 || encryption.getVersion() == 5)\n        {\n            \n            \n            \n            PDCryptFilterDictionary stdCryptFilterDictionary = encryption.getStdCryptFilterDictionary();\n\n            if (stdCryptFilterDictionary != null)\n            {\n                COSName cryptFilterMethod = stdCryptFilterDictionary.getCryptFilterMethod();\n                setAES(COSName.AESV2.equals(cryptFilterMethod) || \n                       COSName.AESV3.equals(cryptFilterMethod));\n            }\n        }\n    }"
  },
  {
    "id": 18,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 3,
    "human_patch": "https://github.com/bqcuong/vul4j/commit/c90825da4d28d7b1ae9b1484b9a010206be3dec5",
    "cve_id": "PDFBOX-3341",
    "cwe_id": "Not Mapping",
    "filename": "pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java",
    "is_vulnerable": 0,
    "class_name": "StandardSecurityHandler",
    "subclass_name": null,
    "function_name": "getDocumentIDBytes(COSArray documentIDArray)",
    "function_body": "{\n        \n        \n        byte[] documentIDBytes;\n        if( documentIDArray != null && documentIDArray.size() >= 1 )\n        {\n            COSString id = (COSString)documentIDArray.getObject( 0 );\n            documentIDBytes = id.getBytes();\n        }\n        else\n        {\n            documentIDBytes = new byte[0];\n        }\n        return documentIDBytes;\n    }"
  },
  {
    "id": 18,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 4,
    "human_patch": "https://github.com/bqcuong/vul4j/commit/c90825da4d28d7b1ae9b1484b9a010206be3dec5",
    "cve_id": "PDFBOX-3341",
    "cwe_id": "Not Mapping",
    "filename": "pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java",
    "is_vulnerable": 0,
    "class_name": "StandardSecurityHandler",
    "subclass_name": null,
    "function_name": "validatePerms(PDEncryption encryption, int dicPermissions, boolean encryptMetadata) throws IOException",
    "function_body": "{\n        try\n        {\n            \n            \n            Cipher cipher = Cipher.getInstance(\"AES/ECB/NoPadding\");\n            cipher.init(Cipher.DECRYPT_MODE, new SecretKeySpec(encryptionKey, \"AES\"));\n            byte[] perms = cipher.doFinal(encryption.getPerms());\n            \n            \n            if (perms[9] != 'a' || perms[10] != 'd' || perms[11] != 'b')\n            {\n                LOG.warn(\"Verification of permissions failed (constant)\");\n            }\n            \n            \n            \n            int permsP = perms[0] & 0xFF | (perms[1] & 0xFF) << 8 | (perms[2] & 0xFF) << 16 |\n                    (perms[3] & 0xFF) << 24;\n            \n            if (permsP != dicPermissions)\n            {\n                LOG.warn(\"Verification of permissions failed (\" + String.format(\"%08X\",permsP) +\n                        \" != \" + String.format(\"%08X\",dicPermissions) + \")\");\n            }\n            \n            if (encryptMetadata && perms[8] != 'T' || !encryptMetadata && perms[8] != 'F')\n            {\n                LOG.warn(\"Verification of permissions failed (EncryptMetadata)\");\n            }\n        }\n        catch (GeneralSecurityException e)\n        {\n            logIfStrongEncryptionMissing();\n            throw new IOException(e);\n        }\n    }"
  },
  {
    "id": 18,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 5,
    "human_patch": "https://github.com/bqcuong/vul4j/commit/c90825da4d28d7b1ae9b1484b9a010206be3dec5",
    "cve_id": "PDFBOX-3341",
    "cwe_id": "Not Mapping",
    "filename": "pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java",
    "is_vulnerable": 0,
    "class_name": "StandardSecurityHandler",
    "subclass_name": null,
    "function_name": "prepareDocumentForEncryption(PDDocument document) throws IOException",
    "function_body": "{\n        PDEncryption encryptionDictionary = document.getEncryption();\n        if(encryptionDictionary == null)\n        {\n            encryptionDictionary = new PDEncryption();\n        }\n        int version = computeVersionNumber();\n        int revision = computeRevisionNumber(version);\n        encryptionDictionary.setFilter(FILTER);\n        encryptionDictionary.setVersion(version);\n        if (version != 4 && version != 5)\n        {\n            \n            encryptionDictionary.removeV45filters();\n        }\n        encryptionDictionary.setRevision(revision);\n        encryptionDictionary.setLength(keyLength);\n\n        String ownerPassword = policy.getOwnerPassword();\n        String userPassword = policy.getUserPassword();\n        if( ownerPassword == null )\n        {\n            ownerPassword = \"\";\n        }\n        if( userPassword == null )\n        {\n            userPassword = \"\";\n        }\n \n        \n        if (ownerPassword.isEmpty())\n        {\n            ownerPassword = userPassword;\n        }\n\n        int permissionInt = policy.getPermissions().getPermissionBytes();\n\n        encryptionDictionary.setPermissions(permissionInt);\n\n        int length = keyLength/8;\n\n        if (revision == 6)\n        {\n            prepareEncryptionDictRev6(ownerPassword, userPassword, encryptionDictionary, permissionInt);\n        }\n        else\n        {\n            prepareEncryptionDictRev2345(ownerPassword, userPassword, encryptionDictionary, permissionInt,\n                    document, revision, length);\n        }\n\n        document.setEncryptionDictionary( encryptionDictionary );\n        document.getDocument().setEncryptionDictionary(encryptionDictionary.getCOSDictionary());\n    }"
  },
  {
    "id": 18,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 6,
    "human_patch": "https://github.com/bqcuong/vul4j/commit/c90825da4d28d7b1ae9b1484b9a010206be3dec5",
    "cve_id": "PDFBOX-3341",
    "cwe_id": "Not Mapping",
    "filename": "pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java",
    "is_vulnerable": 0,
    "class_name": "StandardSecurityHandler",
    "subclass_name": null,
    "function_name": "prepareEncryptionDictRev6(String ownerPassword, String userPassword,\n            PDEncryption encryptionDictionary, int permissionInt) throws IOException",
    "function_body": "{\n        try\n        {\n            SecureRandom rnd = new SecureRandom();\n            Cipher cipher = Cipher.getInstance(\"AES/CBC/NoPadding\");\n\n            \n            encryptionKey = new byte[32];\n            rnd.nextBytes(encryptionKey);\n\n            \n            byte[] userPasswordBytes = truncate127(userPassword.getBytes(Charsets.UTF_8));\n            byte[] userValidationSalt = new byte[8];\n            byte[] userKeySalt = new byte[8];\n            rnd.nextBytes(userValidationSalt);\n            rnd.nextBytes(userKeySalt);\n            byte[] hashU = computeHash2B(concat(userPasswordBytes, userValidationSalt),\n                    userPasswordBytes, null);\n            byte[] u = concat(hashU, userValidationSalt, userKeySalt);\n\n            \n            byte[] hashUE = computeHash2B(concat(userPasswordBytes, userKeySalt),\n                    userPasswordBytes, null);\n            cipher.init(Cipher.ENCRYPT_MODE, new SecretKeySpec(hashUE, \"AES\"),\n                    new IvParameterSpec(new byte[16]));\n            byte[] ue = cipher.doFinal(encryptionKey);\n\n            \n            byte[] ownerPasswordBytes = truncate127(ownerPassword.getBytes(Charsets.UTF_8));\n            byte[] ownerValidationSalt = new byte[8];\n            byte[] ownerKeySalt = new byte[8];\n            rnd.nextBytes(ownerValidationSalt);\n            rnd.nextBytes(ownerKeySalt);\n            byte[] hashO = computeHash2B(concat(ownerPasswordBytes, ownerValidationSalt, u),\n                    ownerPasswordBytes, u);\n            byte[] o = concat(hashO, ownerValidationSalt, ownerKeySalt);\n\n            \n            byte[] hashOE = computeHash2B(concat(ownerPasswordBytes, ownerKeySalt, u),\n                    ownerPasswordBytes, u);\n            cipher.init(Cipher.ENCRYPT_MODE, new SecretKeySpec(hashOE, \"AES\"),\n                    new IvParameterSpec(new byte[16]));\n            byte[] oe = cipher.doFinal(encryptionKey);\n\n            \n            encryptionDictionary.setUserKey(u);\n            encryptionDictionary.setUserEncryptionKey(ue);\n            encryptionDictionary.setOwnerKey(o);\n            encryptionDictionary.setOwnerEncryptionKey(oe);\n\n            prepareEncryptionDictAES(encryptionDictionary, COSName.AESV3);\n\n            \n            byte[] perms = new byte[16];\n            perms[0] = (byte) permissionInt;\n            perms[1] = (byte) (permissionInt >>> 8);\n            perms[2] = (byte) (permissionInt >>> 16);\n            perms[3] = (byte) (permissionInt >>> 24);\n            perms[4] = (byte) 0xFF;\n            perms[5] = (byte) 0xFF;\n            perms[6] = (byte) 0xFF;\n            perms[7] = (byte) 0xFF;\n            perms[8] = 'T';    \n            perms[9] = 'a';\n            perms[10] = 'd';\n            perms[11] = 'b';\n            for (int i = 12; i <= 15; i++)\n            {\n                perms[i] = (byte) rnd.nextInt();\n            }\n\n            cipher.init(Cipher.ENCRYPT_MODE, new SecretKeySpec(encryptionKey, \"AES\"),\n                    new IvParameterSpec(new byte[16]));\n\n            byte[] permsEnc = cipher.doFinal(perms);\n\n            encryptionDictionary.setPerms(permsEnc);\n        }\n        catch (GeneralSecurityException e)\n        {\n            logIfStrongEncryptionMissing();\n            throw new IOException(e);\n        }\n    }"
  },
  {
    "id": 18,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 7,
    "human_patch": "https://github.com/bqcuong/vul4j/commit/c90825da4d28d7b1ae9b1484b9a010206be3dec5",
    "cve_id": "PDFBOX-3341",
    "cwe_id": "Not Mapping",
    "filename": "pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java",
    "is_vulnerable": 0,
    "class_name": "StandardSecurityHandler",
    "subclass_name": null,
    "function_name": "prepareEncryptionDictRev2345(String ownerPassword, String userPassword,\n            PDEncryption encryptionDictionary, int permissionInt, PDDocument document, \n            int revision, int length) throws IOException",
    "function_body": "{\n        COSArray idArray = document.getDocument().getDocumentID();\n\n        \n        if (idArray == null || idArray.size() < 2)\n        {\n            MessageDigest md = MessageDigests.getMD5();\n            BigInteger time = BigInteger.valueOf(System.currentTimeMillis());\n            md.update(time.toByteArray());\n            md.update(ownerPassword.getBytes(Charsets.ISO_8859_1));\n            md.update(userPassword.getBytes(Charsets.ISO_8859_1));\n            md.update(document.getDocument().toString().getBytes(Charsets.ISO_8859_1));\n\n            byte[] id = md.digest(this.toString().getBytes(Charsets.ISO_8859_1));\n            COSString idString = new COSString(id);\n\n            idArray = new COSArray();\n            idArray.add(idString);\n            idArray.add(idString);\n            document.getDocument().setDocumentID(idArray);\n        }\n\n        COSString id = (COSString) idArray.getObject(0);\n\n        byte[] ownerBytes = computeOwnerPassword(\n                ownerPassword.getBytes(Charsets.ISO_8859_1),\n                userPassword.getBytes(Charsets.ISO_8859_1), revision, length);\n\n        byte[] userBytes = computeUserPassword(\n                userPassword.getBytes(Charsets.ISO_8859_1),\n                ownerBytes, permissionInt, id.getBytes(), revision, length, true);\n\n        encryptionKey = computeEncryptedKey(userPassword.getBytes(Charsets.ISO_8859_1), ownerBytes,\n                null, null, null, permissionInt, id.getBytes(), revision, length, true, false);\n\n        encryptionDictionary.setOwnerKey(ownerBytes);\n        encryptionDictionary.setUserKey(userBytes);\n        \n        if (revision == 4)\n        {\n            prepareEncryptionDictAES(encryptionDictionary, COSName.AESV2);\n        }\n    }"
  },
  {
    "id": 18,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 8,
    "human_patch": "https://github.com/bqcuong/vul4j/commit/c90825da4d28d7b1ae9b1484b9a010206be3dec5",
    "cve_id": "PDFBOX-3341",
    "cwe_id": "Not Mapping",
    "filename": "pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java",
    "is_vulnerable": 0,
    "class_name": "StandardSecurityHandler",
    "subclass_name": null,
    "function_name": "prepareEncryptionDictAES(PDEncryption encryptionDictionary, COSName aesVName)",
    "function_body": "{\n        PDCryptFilterDictionary cryptFilterDictionary = new PDCryptFilterDictionary();\n        cryptFilterDictionary.setCryptFilterMethod(aesVName);\n        cryptFilterDictionary.setLength(keyLength);\n        encryptionDictionary.setStdCryptFilterDictionary(cryptFilterDictionary);\n        encryptionDictionary.setStreamFilterName(COSName.STD_CF);\n        encryptionDictionary.setStringFilterName(COSName.STD_CF);\n        setAES(true);\n    }"
  },
  {
    "id": 18,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 9,
    "human_patch": "https://github.com/bqcuong/vul4j/commit/c90825da4d28d7b1ae9b1484b9a010206be3dec5",
    "cve_id": "PDFBOX-3341",
    "cwe_id": "Not Mapping",
    "filename": "pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java",
    "is_vulnerable": 0,
    "class_name": "StandardSecurityHandler",
    "subclass_name": null,
    "function_name": "isOwnerPassword(byte[] ownerPassword, byte[] user, byte[] owner,\n                                   int permissions, byte[] id, int encRevision, int length,\n                                   boolean encryptMetadata) throws IOException",
    "function_body": "{\n        if (encRevision == 6 || encRevision == 5)\n        {            \n            byte[] truncatedOwnerPassword = truncate127(ownerPassword);\n            \n            byte[] oHash = new byte[32];\n            byte[] oValidationSalt = new byte[8];\n            System.arraycopy(owner, 0, oHash, 0, 32);\n            System.arraycopy(owner, 32, oValidationSalt, 0, 8);\n            \n            byte[] hash;\n            if (encRevision == 5)\n            {\n                hash = computeSHA256(truncatedOwnerPassword, oValidationSalt, user);\n            }\n            else\n            {\n                hash = computeHash2A(truncatedOwnerPassword, oValidationSalt, user);\n            }\n\n            return Arrays.equals(hash, oHash);\n        }\n        else\n        {\n            byte[] userPassword = getUserPassword( ownerPassword, owner, encRevision, length );\n            return isUserPassword( userPassword, user, owner, permissions, id, encRevision, length,\n                                   encryptMetadata );\n        }\n    }"
  },
  {
    "id": 18,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 10,
    "human_patch": "https://github.com/bqcuong/vul4j/commit/c90825da4d28d7b1ae9b1484b9a010206be3dec5",
    "cve_id": "PDFBOX-3341",
    "cwe_id": "Not Mapping",
    "filename": "pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java",
    "is_vulnerable": 0,
    "class_name": "StandardSecurityHandler",
    "subclass_name": null,
    "function_name": "getUserPassword( byte[] ownerPassword,  byte[] owner, int encRevision,\n                                   int length ) throws IOException",
    "function_body": "{\n        ByteArrayOutputStream result = new ByteArrayOutputStream();\n        byte[] rc4Key = computeRC4key(ownerPassword, encRevision, length);\n\n        if( encRevision == 2 )\n        {\n            encryptDataRC4(rc4Key, owner, result);\n        }\n        else if( encRevision == 3 || encRevision == 4)\n        {\n            byte[] iterationKey = new byte[ rc4Key.length ];\n            byte[] otemp = new byte[ owner.length ];\n            System.arraycopy( owner, 0, otemp, 0, owner.length );\n            \n            for( int i=19; i>=0; i-- )\n            {\n                System.arraycopy( rc4Key, 0, iterationKey, 0, rc4Key.length );\n                for( int j=0; j< iterationKey.length; j++ )\n                {\n                    iterationKey[j] = (byte)(iterationKey[j] ^ (byte)i);\n                }\n                result.reset();\n                encryptDataRC4(iterationKey, otemp, result);\n                otemp = result.toByteArray();\n            }\n        }\n        return result.toByteArray();\n    }"
  },
  {
    "id": 18,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 11,
    "human_patch": "https://github.com/bqcuong/vul4j/commit/c90825da4d28d7b1ae9b1484b9a010206be3dec5",
    "cve_id": "PDFBOX-3341",
    "cwe_id": "Not Mapping",
    "filename": "pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java",
    "is_vulnerable": 0,
    "class_name": "StandardSecurityHandler",
    "subclass_name": null,
    "function_name": "computeEncryptedKey(byte[] password, byte[] o, byte[] u, byte[] oe, byte[] ue,\n                                      int permissions, byte[] id, int encRevision, int length,\n                                      boolean encryptMetadata, boolean isOwnerPassword) throws IOException",
    "function_body": "{\n        if (encRevision == 6 || encRevision == 5)\n        {\n            return computeEncryptedKeyRev56(password, isOwnerPassword, o, u, oe, ue, encRevision);\n        }\n        else\n        {\n            return computeEncryptedKeyRev234(password, o, permissions, id, encryptMetadata, length, encRevision);\n        }\n    }"
  },
  {
    "id": 18,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 12,
    "human_patch": "https://github.com/bqcuong/vul4j/commit/c90825da4d28d7b1ae9b1484b9a010206be3dec5",
    "cve_id": "PDFBOX-3341",
    "cwe_id": "Not Mapping",
    "filename": "pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java",
    "is_vulnerable": 0,
    "class_name": "StandardSecurityHandler",
    "subclass_name": null,
    "function_name": "computeEncryptedKeyRev234(byte[] password, byte[] o, int permissions, \n            byte[] id, boolean encryptMetadata, int length, int encRevision)",
    "function_body": "{\n        \n\n        \n        byte[] padded = truncateOrPad(password);\n\n        MessageDigest md = MessageDigests.getMD5();\n        md.update(padded);\n\n        md.update(o);\n\n        md.update((byte) permissions);\n        md.update((byte) (permissions >>> 8));\n        md.update((byte) (permissions >>> 16));\n        md.update((byte) (permissions >>> 24));\n\n        md.update(id);\n\n        \n        \n        \n        if (encRevision == 4 && !encryptMetadata)\n        {\n            md.update(new byte[] { (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff });\n        }\n        byte[] digest = md.digest();\n\n        if (encRevision == 3 || encRevision == 4)\n        {\n            for (int i = 0; i < 50; i++)\n            {\n                md.update(digest, 0, length);\n                digest = md.digest();\n            }\n        }\n\n        byte[] result = new byte[length];\n        System.arraycopy(digest, 0, result, 0, length);\n        return result;\n    }"
  },
  {
    "id": 18,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 13,
    "human_patch": "https://github.com/bqcuong/vul4j/commit/c90825da4d28d7b1ae9b1484b9a010206be3dec5",
    "cve_id": "PDFBOX-3341",
    "cwe_id": "Not Mapping",
    "filename": "pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java",
    "is_vulnerable": 0,
    "class_name": "StandardSecurityHandler",
    "subclass_name": null,
    "function_name": "computeEncryptedKeyRev56(byte[] password, boolean isOwnerPassword, \n            byte[] o, byte[] u, byte[] oe, byte[] ue, int encRevision) throws IOException",
    "function_body": "{\n        byte[] hash, fileKeyEnc;\n\n        if (isOwnerPassword)\n        {\n            byte[] oKeySalt = new byte[8];\n            System.arraycopy(o, 40, oKeySalt, 0, 8);\n\n            if (encRevision == 5)\n            {\n                hash = computeSHA256(password, oKeySalt, u);\n            }\n            else\n            {\n                hash = computeHash2A(password, oKeySalt, u);\n            }\n\n            fileKeyEnc = oe;\n        }\n        else\n        {\n            byte[] uKeySalt = new byte[8];\n            System.arraycopy(u, 40, uKeySalt, 0, 8);\n\n            if (encRevision == 5)\n            {\n                hash = computeSHA256(password, uKeySalt, null);\n            }\n            else\n            {\n                hash = computeHash2A(password, uKeySalt, null);\n            }\n\n            fileKeyEnc = ue;\n        }\n        try\n        {\n            Cipher cipher = Cipher.getInstance(\"AES/CBC/NoPadding\");\n            cipher.init(Cipher.DECRYPT_MODE, new SecretKeySpec(hash, \"AES\"), new IvParameterSpec(new byte[16]));\n            return cipher.doFinal(fileKeyEnc);\n        }\n        catch (GeneralSecurityException e)\n        {\n            logIfStrongEncryptionMissing();\n            throw new IOException(e);\n        }\n    }"
  },
  {
    "id": 18,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 14,
    "human_patch": "https://github.com/bqcuong/vul4j/commit/c90825da4d28d7b1ae9b1484b9a010206be3dec5",
    "cve_id": "PDFBOX-3341",
    "cwe_id": "Not Mapping",
    "filename": "pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java",
    "is_vulnerable": 0,
    "class_name": "StandardSecurityHandler",
    "subclass_name": null,
    "function_name": "computeUserPassword(byte[] password, byte[] owner, int permissions,\n                                      byte[] id, int encRevision, int length,\n                                      boolean encryptMetadata) throws IOException",
    "function_body": "{\n        ByteArrayOutputStream result = new ByteArrayOutputStream();\n        byte[] encKey = computeEncryptedKey( password, owner, null, null, null, permissions,\n                id, encRevision, length, encryptMetadata, true );\n        \n        if( encRevision == 2 )\n        {\n            encryptDataRC4(encKey, ENCRYPT_PADDING, result );\n        }\n        else if( encRevision == 3 || encRevision == 4 )\n        {\n            MessageDigest md = MessageDigests.getMD5();\n            md.update( ENCRYPT_PADDING );\n\n            md.update( id );\n            result.write( md.digest() );\n\n            byte[] iterationKey = new byte[ encKey.length ];\n            for( int i=0; i<20; i++ )\n            {\n                System.arraycopy( encKey, 0, iterationKey, 0, iterationKey.length );\n                for( int j=0; j< iterationKey.length; j++ )\n                {\n                    iterationKey[j] = (byte)(iterationKey[j] ^ i);\n                }\n                ByteArrayInputStream input = new ByteArrayInputStream(result.toByteArray());\n                result.reset();\n                encryptDataRC4(iterationKey, input, result);\n            }\n\n            byte[] finalResult = new byte[32];\n            System.arraycopy( result.toByteArray(), 0, finalResult, 0, 16 );\n            System.arraycopy( ENCRYPT_PADDING, 0, finalResult, 16, 16 );\n            result.reset();\n            result.write( finalResult );\n        }\n        return result.toByteArray();\n    }"
  },
  {
    "id": 18,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 15,
    "human_patch": "https://github.com/bqcuong/vul4j/commit/c90825da4d28d7b1ae9b1484b9a010206be3dec5",
    "cve_id": "PDFBOX-3341",
    "cwe_id": "Not Mapping",
    "filename": "pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java",
    "is_vulnerable": 0,
    "class_name": "StandardSecurityHandler",
    "subclass_name": null,
    "function_name": "computeOwnerPassword(byte[] ownerPassword, byte[] userPassword,\n                                       int encRevision,  int length ) throws IOException",
    "function_body": "{\n        if( encRevision == 2 && length != 5 )\n        {\n            throw new IOException(\"Expected length=5 actual=\" + length );\n        }\n        \n        byte[] rc4Key = computeRC4key(ownerPassword, encRevision, length);\n        byte[] paddedUser = truncateOrPad( userPassword );\n\n        ByteArrayOutputStream encrypted = new ByteArrayOutputStream();\n        encryptDataRC4(rc4Key, new ByteArrayInputStream(paddedUser), encrypted);\n\n        if( encRevision == 3 || encRevision == 4 )\n        {\n            byte[] iterationKey = new byte[ rc4Key.length ];\n            for( int i=1; i<20; i++ )\n            {\n                System.arraycopy( rc4Key, 0, iterationKey, 0, rc4Key.length );\n                for( int j=0; j< iterationKey.length; j++ )\n                {\n                    iterationKey[j] = (byte)(iterationKey[j] ^ (byte)i);\n                }\n                ByteArrayInputStream input = new ByteArrayInputStream( encrypted.toByteArray() );\n                encrypted.reset();\n                encryptDataRC4(iterationKey, input, encrypted );\n            }\n        }\n\n        return encrypted.toByteArray();\n    }"
  },
  {
    "id": 18,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 16,
    "human_patch": "https://github.com/bqcuong/vul4j/commit/c90825da4d28d7b1ae9b1484b9a010206be3dec5",
    "cve_id": "PDFBOX-3341",
    "cwe_id": "Not Mapping",
    "filename": "pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java",
    "is_vulnerable": 0,
    "class_name": "StandardSecurityHandler",
    "subclass_name": null,
    "function_name": "computeRC4key(byte[] ownerPassword, int encRevision, int length)",
    "function_body": "{\n        MessageDigest md = MessageDigests.getMD5();\n        byte[] digest = md.digest(truncateOrPad(ownerPassword));\n        if (encRevision == 3 || encRevision == 4)\n        {\n            for (int i = 0; i < 50; i++)\n            {\n                \n                \n                \n                md.update(digest, 0, length);\n                digest = md.digest();\n            }\n        }\n        byte[] rc4Key = new byte[length];\n        System.arraycopy(digest, 0, rc4Key, 0, length);\n        return rc4Key;\n    }"
  },
  {
    "id": 18,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 17,
    "human_patch": "https://github.com/bqcuong/vul4j/commit/c90825da4d28d7b1ae9b1484b9a010206be3dec5",
    "cve_id": "PDFBOX-3341",
    "cwe_id": "Not Mapping",
    "filename": "pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java",
    "is_vulnerable": 0,
    "class_name": "StandardSecurityHandler",
    "subclass_name": null,
    "function_name": "truncateOrPad( byte[] password )",
    "function_body": "{\n        byte[] padded = new byte[ ENCRYPT_PADDING.length ];\n        int bytesBeforePad = Math.min( password.length, padded.length );\n        System.arraycopy( password, 0, padded, 0, bytesBeforePad );\n        System.arraycopy( ENCRYPT_PADDING, 0, padded, bytesBeforePad,\n                          ENCRYPT_PADDING.length-bytesBeforePad );\n        return padded;\n    }"
  },
  {
    "id": 18,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 18,
    "human_patch": "https://github.com/bqcuong/vul4j/commit/c90825da4d28d7b1ae9b1484b9a010206be3dec5",
    "cve_id": "PDFBOX-3341",
    "cwe_id": "Not Mapping",
    "filename": "pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java",
    "is_vulnerable": 0,
    "class_name": "StandardSecurityHandler",
    "subclass_name": null,
    "function_name": "isUserPassword(byte[] password, byte[] user, byte[] owner, int permissions,\n                                  byte[] id, int encRevision, int length, boolean encryptMetadata) throws IOException",
    "function_body": "{\n        if( encRevision == 2 )\n        {\n            byte[] passwordBytes = computeUserPassword( password, owner, permissions, id, encRevision,\n                                                        length, encryptMetadata );\n            return Arrays.equals(user, passwordBytes);\n        }\n        else if( encRevision == 3 || encRevision == 4 )\n        {\n            byte[] passwordBytes = computeUserPassword( password, owner, permissions, id, encRevision,\n                                                        length, encryptMetadata );\n            \n            return Arrays.equals(Arrays.copyOf(user, 16), Arrays.copyOf(passwordBytes, 16));\n        }\n        else if (encRevision == 6 || encRevision == 5)\n        {\n            byte[] truncatedPassword = truncate127(password);\n            \n            byte[] uHash = new byte[32];\n            byte[] uValidationSalt = new byte[8];\n            System.arraycopy(user, 0, uHash, 0, 32);\n            System.arraycopy(user, 32, uValidationSalt, 0, 8);\n\n            byte[] hash;\n            if (encRevision == 5)\n            {\n                hash = computeSHA256(truncatedPassword, uValidationSalt, null);\n            }\n            else\n            {\n                hash = computeHash2A(truncatedPassword, uValidationSalt, null);\n            }\n\n            return Arrays.equals(hash, uHash);\n        }\n        else\n        {\n            throw new IOException( \"Unknown Encryption Revision \" + encRevision );\n        }\n    }"
  },
  {
    "id": 18,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 19,
    "human_patch": "https://github.com/bqcuong/vul4j/commit/c90825da4d28d7b1ae9b1484b9a010206be3dec5",
    "cve_id": "PDFBOX-3341",
    "cwe_id": "Not Mapping",
    "filename": "pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java",
    "is_vulnerable": 0,
    "class_name": "StandardSecurityHandler",
    "subclass_name": null,
    "function_name": "isUserPassword(String password, byte[] user, byte[] owner, int permissions,\n                                  byte[] id, int encRevision,  int length, boolean encryptMetadata) throws IOException",
    "function_body": "{\n        if (encRevision == 6 || encRevision == 5)\n        {\n            return isUserPassword(password.getBytes(Charsets.UTF_8), user, owner, permissions, id,\n                    encRevision, length, encryptMetadata);\n        }\n        else\n        {\n            return isUserPassword(password.getBytes(Charsets.ISO_8859_1), user, owner, permissions, id,\n                    encRevision, length, encryptMetadata);\n        }\n    }"
  },
  {
    "id": 18,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 20,
    "human_patch": "https://github.com/bqcuong/vul4j/commit/c90825da4d28d7b1ae9b1484b9a010206be3dec5",
    "cve_id": "PDFBOX-3341",
    "cwe_id": "Not Mapping",
    "filename": "pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java",
    "is_vulnerable": 0,
    "class_name": "StandardSecurityHandler",
    "subclass_name": null,
    "function_name": "isOwnerPassword(String password, byte[] user, byte[] owner, int permissions,\n                                   byte[] id, int encRevision, int length, boolean encryptMetadata) throws IOException",
    "function_body": "{\n        return isOwnerPassword(password.getBytes(Charsets.ISO_8859_1), user,owner,permissions, id,\n                               encRevision, length, encryptMetadata);\n    }"
  },
  {
    "id": 18,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 21,
    "human_patch": "https://github.com/bqcuong/vul4j/commit/c90825da4d28d7b1ae9b1484b9a010206be3dec5",
    "cve_id": "PDFBOX-3341",
    "cwe_id": "Not Mapping",
    "filename": "pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java",
    "is_vulnerable": 0,
    "class_name": "StandardSecurityHandler",
    "subclass_name": null,
    "function_name": "computeHash2A(byte[] password, byte[] salt, byte[] u) throws IOException",
    "function_body": "{\n        byte[] userKey;\n        if (u == null)\n        {\n            userKey = new byte[0];\n        }\n        else if (u.length < 48)\n        {\n            throw new IOException(\"Bad U length\");\n        }\n        else if (u.length > 48)\n        {\n            \n            userKey = new byte[48];\n            System.arraycopy(u, 0, userKey, 0, 48);\n        }\n        else\n        {\n            userKey = u;\n        }\n\n        byte[] truncatedPassword = truncate127(password);\n        byte[] input = concat(truncatedPassword, salt, userKey);\n        return computeHash2B(input, truncatedPassword, userKey);\n    }"
  },
  {
    "id": 18,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 22,
    "human_patch": "https://github.com/bqcuong/vul4j/commit/c90825da4d28d7b1ae9b1484b9a010206be3dec5",
    "cve_id": "PDFBOX-3341",
    "cwe_id": "Not Mapping",
    "filename": "pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java",
    "is_vulnerable": 0,
    "class_name": "StandardSecurityHandler",
    "subclass_name": null,
    "function_name": "computeHash2B(byte[] input, byte[] password, byte[] userKey) throws IOException",
    "function_body": "{\n        try\n        {\n            MessageDigest md = MessageDigest.getInstance(\"SHA-256\");\n            byte[] k = md.digest(input);\n            \n            byte[] e = null;\n            for (int round = 0; round < 64 || ((int)e[e.length-1] & 0xFF) > round - 32; round++)\n            {                \n                byte[] k1;\n                if (userKey != null && userKey.length >= 48)\n                {\n                    k1 = new byte[64*(password.length + k.length + 48)];\n                }\n                else\n                {\n                    k1 = new byte[64*(password.length + k.length)];\n                }\n                \n                int pos = 0;\n                for (int i = 0; i < 64; i++)\n                {\n                    System.arraycopy(password, 0, k1, pos, password.length);\n                    pos += password.length;\n                    System.arraycopy(k, 0, k1, pos, k.length);\n                    pos += k.length;\n                    if (userKey != null && userKey.length >= 48)\n                    {\n                        System.arraycopy(userKey, 0, k1, pos, 48);\n                        pos += 48;\n                    }\n                }\n                \n                byte[] kFirst = new byte[16];\n                byte[] kSecond = new byte[16];\n                System.arraycopy(k, 0, kFirst, 0, 16);\n                System.arraycopy(k, 16, kSecond, 0, 16);\n                \n                Cipher cipher = Cipher.getInstance(\"AES/CBC/NoPadding\");\n                SecretKeySpec keySpec = new SecretKeySpec(kFirst, \"AES\");\n                IvParameterSpec ivSpec = new IvParameterSpec(kSecond);\n                cipher.init(Cipher.ENCRYPT_MODE, keySpec, ivSpec);\n                e = cipher.doFinal(k1);\n                \n                byte[] eFirst = new byte[16];\n                System.arraycopy(e, 0, eFirst, 0, 16);\n                BigInteger bi = new BigInteger(1, eFirst);\n                BigInteger remainder = bi.mod(new BigInteger(\"3\"));\n                String nextHash = HASHES_2B[remainder.intValue()];\n                \n                md = MessageDigest.getInstance(nextHash);\n                k = md.digest(e);\n            }\n            \n            if (k.length > 32)\n            {\n                byte[] kTrunc = new byte[32];\n                System.arraycopy(k, 0, kTrunc, 0, 32);\n                return kTrunc;\n            }\n            else\n            {\n                return k;\n            }            \n        }\n        catch (GeneralSecurityException e)\n        {\n            logIfStrongEncryptionMissing();\n            throw new IOException(e);\n        }\n    }"
  },
  {
    "id": 18,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 23,
    "human_patch": "https://github.com/bqcuong/vul4j/commit/c90825da4d28d7b1ae9b1484b9a010206be3dec5",
    "cve_id": "PDFBOX-3341",
    "cwe_id": "Not Mapping",
    "filename": "pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java",
    "is_vulnerable": 0,
    "class_name": "StandardSecurityHandler",
    "subclass_name": null,
    "function_name": "computeSHA256(byte[] input, byte[] password, byte[] userKey) throws IOException",
    "function_body": "{\n        try\n        {\n            MessageDigest md = MessageDigest.getInstance(\"SHA-256\");\n            md.update(input);\n            md.update(password);\n            return userKey == null ? md.digest() : md.digest(userKey);\n        }\n        catch (NoSuchAlgorithmException e)\n        {\n            throw new IOException(e);\n        }\n    }"
  },
  {
    "id": 18,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 24,
    "human_patch": "https://github.com/bqcuong/vul4j/commit/c90825da4d28d7b1ae9b1484b9a010206be3dec5",
    "cve_id": "PDFBOX-3341",
    "cwe_id": "Not Mapping",
    "filename": "pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java",
    "is_vulnerable": 0,
    "class_name": "StandardSecurityHandler",
    "subclass_name": null,
    "function_name": "concat(byte[] a, byte[] b)",
    "function_body": "{\n        byte[] o = new byte[a.length + b.length];\n        System.arraycopy(a, 0, o, 0, a.length);\n        System.arraycopy(b, 0, o, a.length, b.length);\n        return o;\n    }"
  },
  {
    "id": 18,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 25,
    "human_patch": "https://github.com/bqcuong/vul4j/commit/c90825da4d28d7b1ae9b1484b9a010206be3dec5",
    "cve_id": "PDFBOX-3341",
    "cwe_id": "Not Mapping",
    "filename": "pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java",
    "is_vulnerable": 0,
    "class_name": "StandardSecurityHandler",
    "subclass_name": null,
    "function_name": "concat(byte[] a, byte[] b, byte[] c)",
    "function_body": "{\n        byte[] o = new byte[a.length + b.length + c.length];\n        System.arraycopy(a, 0, o, 0, a.length);\n        System.arraycopy(b, 0, o, a.length, b.length);\n        System.arraycopy(c, 0, o, a.length + b.length, c.length);\n        return o;\n    }"
  },
  {
    "id": 18,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 26,
    "human_patch": "https://github.com/bqcuong/vul4j/commit/c90825da4d28d7b1ae9b1484b9a010206be3dec5",
    "cve_id": "PDFBOX-3341",
    "cwe_id": "Not Mapping",
    "filename": "pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java",
    "is_vulnerable": 0,
    "class_name": "StandardSecurityHandler",
    "subclass_name": null,
    "function_name": "truncate127(byte[] in)",
    "function_body": "{\n        if (in.length <= 127)\n        {\n            return in;\n        }\n        byte[] trunc = new byte[127];\n        System.arraycopy(in, 0, trunc, 0, 127);\n        return trunc;\n    }"
  },
  {
    "id": 18,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 27,
    "human_patch": "https://github.com/bqcuong/vul4j/commit/c90825da4d28d7b1ae9b1484b9a010206be3dec5",
    "cve_id": "PDFBOX-3341",
    "cwe_id": "Not Mapping",
    "filename": "pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java",
    "is_vulnerable": 0,
    "class_name": "StandardSecurityHandler",
    "subclass_name": null,
    "function_name": "logIfStrongEncryptionMissing()",
    "function_body": "{\n        try\n        {\n            if (Cipher.getMaxAllowedKeyLength(\"AES\") != Integer.MAX_VALUE)\n            {\n                LOG.warn(\"JCE unlimited strength jurisdiction policy files are not installed\");\n            }\n        }\n        catch (NoSuchAlgorithmException ex)\n        {\n        }\n    }"
  },
  {
    "id": 18,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 28,
    "human_patch": "https://github.com/bqcuong/vul4j/commit/c90825da4d28d7b1ae9b1484b9a010206be3dec5",
    "cve_id": "PDFBOX-3341",
    "cwe_id": "Not Mapping",
    "filename": "pdfbox/src/main/java/org/apache/pdfbox/pdmodel/encryption/StandardSecurityHandler.java",
    "is_vulnerable": 0,
    "class_name": "StandardSecurityHandler",
    "subclass_name": null,
    "function_name": "hasProtectionPolicy()",
    "function_body": "{\n        return policy != null;\n    }"
  },
  {
    "id": 19,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 0,
    "human_patch": "https://github.com/apache/pdfbox/commit/0e14d6a42cc965e23bb1b40f04b4c002dc173b88",
    "cve_id": "CVE-2018-11797",
    "cwe_id": "Not Mapping",
    "filename": "pdfbox/src/main/java/org/apache/pdfbox/cos/COSArray.java",
    "is_vulnerable": 0,
    "class_name": "COSArray",
    "subclass_name": null,
    "function_name": "add( COSBase object )",
    "function_body": "{\n        objects.add( object );\n    }"
  },
  {
    "id": 19,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 1,
    "human_patch": "https://github.com/apache/pdfbox/commit/0e14d6a42cc965e23bb1b40f04b4c002dc173b88",
    "cve_id": "CVE-2018-11797",
    "cwe_id": "Not Mapping",
    "filename": "pdfbox/src/main/java/org/apache/pdfbox/cos/COSArray.java",
    "is_vulnerable": 0,
    "class_name": "COSArray",
    "subclass_name": null,
    "function_name": "add( COSObjectable object )",
    "function_body": "{\n        objects.add( object.getCOSObject() );\n    }"
  },
  {
    "id": 19,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 2,
    "human_patch": "https://github.com/apache/pdfbox/commit/0e14d6a42cc965e23bb1b40f04b4c002dc173b88",
    "cve_id": "CVE-2018-11797",
    "cwe_id": "Not Mapping",
    "filename": "pdfbox/src/main/java/org/apache/pdfbox/cos/COSArray.java",
    "is_vulnerable": 0,
    "class_name": "COSArray",
    "subclass_name": null,
    "function_name": "add( int i, COSBase object)",
    "function_body": "{\n        objects.add( i, object );\n    }"
  },
  {
    "id": 19,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 3,
    "human_patch": "https://github.com/apache/pdfbox/commit/0e14d6a42cc965e23bb1b40f04b4c002dc173b88",
    "cve_id": "CVE-2018-11797",
    "cwe_id": "Not Mapping",
    "filename": "pdfbox/src/main/java/org/apache/pdfbox/cos/COSArray.java",
    "is_vulnerable": 0,
    "class_name": "COSArray",
    "subclass_name": null,
    "function_name": "clear()",
    "function_body": "{\n        objects.clear();\n    }"
  },
  {
    "id": 19,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 4,
    "human_patch": "https://github.com/apache/pdfbox/commit/0e14d6a42cc965e23bb1b40f04b4c002dc173b88",
    "cve_id": "CVE-2018-11797",
    "cwe_id": "Not Mapping",
    "filename": "pdfbox/src/main/java/org/apache/pdfbox/cos/COSArray.java",
    "is_vulnerable": 0,
    "class_name": "COSArray",
    "subclass_name": null,
    "function_name": "removeAll( Collection<COSBase> objectsList )",
    "function_body": "{\n        objects.removeAll( objectsList );\n    }"
  },
  {
    "id": 19,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 5,
    "human_patch": "https://github.com/apache/pdfbox/commit/0e14d6a42cc965e23bb1b40f04b4c002dc173b88",
    "cve_id": "CVE-2018-11797",
    "cwe_id": "Not Mapping",
    "filename": "pdfbox/src/main/java/org/apache/pdfbox/cos/COSArray.java",
    "is_vulnerable": 0,
    "class_name": "COSArray",
    "subclass_name": null,
    "function_name": "retainAll( Collection<COSBase> objectsList )",
    "function_body": "{\n        objects.retainAll( objectsList );\n    }"
  },
  {
    "id": 19,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 6,
    "human_patch": "https://github.com/apache/pdfbox/commit/0e14d6a42cc965e23bb1b40f04b4c002dc173b88",
    "cve_id": "CVE-2018-11797",
    "cwe_id": "Not Mapping",
    "filename": "pdfbox/src/main/java/org/apache/pdfbox/cos/COSArray.java",
    "is_vulnerable": 0,
    "class_name": "COSArray",
    "subclass_name": null,
    "function_name": "addAll( Collection<COSBase> objectsList )",
    "function_body": "{\n        objects.addAll( objectsList );\n    }"
  },
  {
    "id": 19,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 7,
    "human_patch": "https://github.com/apache/pdfbox/commit/0e14d6a42cc965e23bb1b40f04b4c002dc173b88",
    "cve_id": "CVE-2018-11797",
    "cwe_id": "Not Mapping",
    "filename": "pdfbox/src/main/java/org/apache/pdfbox/cos/COSArray.java",
    "is_vulnerable": 0,
    "class_name": "COSArray",
    "subclass_name": null,
    "function_name": "addAll( COSArray objectList )",
    "function_body": "{\n        if( objectList != null )\n        {\n            objects.addAll( objectList.objects );\n        }\n    }"
  },
  {
    "id": 19,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 8,
    "human_patch": "https://github.com/apache/pdfbox/commit/0e14d6a42cc965e23bb1b40f04b4c002dc173b88",
    "cve_id": "CVE-2018-11797",
    "cwe_id": "Not Mapping",
    "filename": "pdfbox/src/main/java/org/apache/pdfbox/cos/COSArray.java",
    "is_vulnerable": 0,
    "class_name": "COSArray",
    "subclass_name": null,
    "function_name": "addAll( int i, Collection<COSBase> objectList )",
    "function_body": "{\n        objects.addAll( i, objectList );\n    }"
  },
  {
    "id": 19,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 9,
    "human_patch": "https://github.com/apache/pdfbox/commit/0e14d6a42cc965e23bb1b40f04b4c002dc173b88",
    "cve_id": "CVE-2018-11797",
    "cwe_id": "Not Mapping",
    "filename": "pdfbox/src/main/java/org/apache/pdfbox/cos/COSArray.java",
    "is_vulnerable": 0,
    "class_name": "COSArray",
    "subclass_name": null,
    "function_name": "set( int index, COSBase object )",
    "function_body": "{\n        objects.set( index, object );\n    }"
  },
  {
    "id": 19,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 10,
    "human_patch": "https://github.com/apache/pdfbox/commit/0e14d6a42cc965e23bb1b40f04b4c002dc173b88",
    "cve_id": "CVE-2018-11797",
    "cwe_id": "Not Mapping",
    "filename": "pdfbox/src/main/java/org/apache/pdfbox/cos/COSArray.java",
    "is_vulnerable": 0,
    "class_name": "COSArray",
    "subclass_name": null,
    "function_name": "set( int index, int intVal )",
    "function_body": "{\n        objects.set( index, COSInteger.get(intVal) );\n    }"
  },
  {
    "id": 19,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 11,
    "human_patch": "https://github.com/apache/pdfbox/commit/0e14d6a42cc965e23bb1b40f04b4c002dc173b88",
    "cve_id": "CVE-2018-11797",
    "cwe_id": "Not Mapping",
    "filename": "pdfbox/src/main/java/org/apache/pdfbox/cos/COSArray.java",
    "is_vulnerable": 0,
    "class_name": "COSArray",
    "subclass_name": null,
    "function_name": "set( int index, COSObjectable object )",
    "function_body": "{\n        COSBase base = null;\n        if( object != null )\n        {\n            base = object.getCOSObject();\n        }\n        objects.set( index, base );\n    }"
  },
  {
    "id": 19,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 12,
    "human_patch": "https://github.com/apache/pdfbox/commit/0e14d6a42cc965e23bb1b40f04b4c002dc173b88",
    "cve_id": "CVE-2018-11797",
    "cwe_id": "Not Mapping",
    "filename": "pdfbox/src/main/java/org/apache/pdfbox/cos/COSArray.java",
    "is_vulnerable": 0,
    "class_name": "COSArray",
    "subclass_name": null,
    "function_name": "getObject( int index )",
    "function_body": "{\n        Object obj = objects.get( index );\n        if( obj instanceof COSObject )\n        {\n            obj = ((COSObject)obj).getObject();\n        }\n        if (obj instanceof COSNull)\n        {\n            obj = null;\n        }\n        return (COSBase)obj;\n    }"
  },
  {
    "id": 19,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 13,
    "human_patch": "https://github.com/apache/pdfbox/commit/0e14d6a42cc965e23bb1b40f04b4c002dc173b88",
    "cve_id": "CVE-2018-11797",
    "cwe_id": "Not Mapping",
    "filename": "pdfbox/src/main/java/org/apache/pdfbox/cos/COSArray.java",
    "is_vulnerable": 0,
    "class_name": "COSArray",
    "subclass_name": null,
    "function_name": "get( int index )",
    "function_body": "{\n        return objects.get( index );\n    }"
  },
  {
    "id": 19,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 14,
    "human_patch": "https://github.com/apache/pdfbox/commit/0e14d6a42cc965e23bb1b40f04b4c002dc173b88",
    "cve_id": "CVE-2018-11797",
    "cwe_id": "Not Mapping",
    "filename": "pdfbox/src/main/java/org/apache/pdfbox/cos/COSArray.java",
    "is_vulnerable": 0,
    "class_name": "COSArray",
    "subclass_name": null,
    "function_name": "getInt( int index )",
    "function_body": "{\n        return getInt( index, -1 );\n    }"
  },
  {
    "id": 19,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 15,
    "human_patch": "https://github.com/apache/pdfbox/commit/0e14d6a42cc965e23bb1b40f04b4c002dc173b88",
    "cve_id": "CVE-2018-11797",
    "cwe_id": "Not Mapping",
    "filename": "pdfbox/src/main/java/org/apache/pdfbox/cos/COSArray.java",
    "is_vulnerable": 0,
    "class_name": "COSArray",
    "subclass_name": null,
    "function_name": "getInt( int index, int defaultValue )",
    "function_body": "{\n        int retval = defaultValue;\n        if ( index < size() )\n        {\n            Object obj = objects.get( index );\n            if( obj instanceof COSNumber )\n            {\n                retval = ((COSNumber)obj).intValue();\n            }\n        }\n        return retval;\n    }"
  },
  {
    "id": 19,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 16,
    "human_patch": "https://github.com/apache/pdfbox/commit/0e14d6a42cc965e23bb1b40f04b4c002dc173b88",
    "cve_id": "CVE-2018-11797",
    "cwe_id": "Not Mapping",
    "filename": "pdfbox/src/main/java/org/apache/pdfbox/cos/COSArray.java",
    "is_vulnerable": 0,
    "class_name": "COSArray",
    "subclass_name": null,
    "function_name": "setInt( int index, int value )",
    "function_body": "{\n        set( index, COSInteger.get( value ) );\n    }"
  },
  {
    "id": 19,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 17,
    "human_patch": "https://github.com/apache/pdfbox/commit/0e14d6a42cc965e23bb1b40f04b4c002dc173b88",
    "cve_id": "CVE-2018-11797",
    "cwe_id": "Not Mapping",
    "filename": "pdfbox/src/main/java/org/apache/pdfbox/cos/COSArray.java",
    "is_vulnerable": 0,
    "class_name": "COSArray",
    "subclass_name": null,
    "function_name": "setName( int index, String name )",
    "function_body": "{\n        set( index, COSName.getPDFName( name ) );\n    }"
  },
  {
    "id": 19,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 18,
    "human_patch": "https://github.com/apache/pdfbox/commit/0e14d6a42cc965e23bb1b40f04b4c002dc173b88",
    "cve_id": "CVE-2018-11797",
    "cwe_id": "Not Mapping",
    "filename": "pdfbox/src/main/java/org/apache/pdfbox/cos/COSArray.java",
    "is_vulnerable": 0,
    "class_name": "COSArray",
    "subclass_name": null,
    "function_name": "getName( int index )",
    "function_body": "{\n        return getName( index, null );\n    }"
  },
  {
    "id": 19,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 19,
    "human_patch": "https://github.com/apache/pdfbox/commit/0e14d6a42cc965e23bb1b40f04b4c002dc173b88",
    "cve_id": "CVE-2018-11797",
    "cwe_id": "Not Mapping",
    "filename": "pdfbox/src/main/java/org/apache/pdfbox/cos/COSArray.java",
    "is_vulnerable": 0,
    "class_name": "COSArray",
    "subclass_name": null,
    "function_name": "getName( int index, String defaultValue )",
    "function_body": "{\n        String retval = defaultValue;\n        if( index < size() )\n        {\n            Object obj = objects.get( index );\n            if( obj instanceof COSName )\n            {\n                retval = ((COSName)obj).getName();\n            }\n        }\n        return retval;\n    }"
  },
  {
    "id": 19,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 20,
    "human_patch": "https://github.com/apache/pdfbox/commit/0e14d6a42cc965e23bb1b40f04b4c002dc173b88",
    "cve_id": "CVE-2018-11797",
    "cwe_id": "Not Mapping",
    "filename": "pdfbox/src/main/java/org/apache/pdfbox/cos/COSArray.java",
    "is_vulnerable": 0,
    "class_name": "COSArray",
    "subclass_name": null,
    "function_name": "setString( int index, String string )",
    "function_body": "{\n        if ( string != null )\n        {\n            set( index, new COSString( string ) );\n        }\n        else\n        {\n            set( index, null );\n        }\n    }"
  },
  {
    "id": 19,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 21,
    "human_patch": "https://github.com/apache/pdfbox/commit/0e14d6a42cc965e23bb1b40f04b4c002dc173b88",
    "cve_id": "CVE-2018-11797",
    "cwe_id": "Not Mapping",
    "filename": "pdfbox/src/main/java/org/apache/pdfbox/cos/COSArray.java",
    "is_vulnerable": 0,
    "class_name": "COSArray",
    "subclass_name": null,
    "function_name": "getString( int index )",
    "function_body": "{\n        return getString( index, null );\n    }"
  },
  {
    "id": 19,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 22,
    "human_patch": "https://github.com/apache/pdfbox/commit/0e14d6a42cc965e23bb1b40f04b4c002dc173b88",
    "cve_id": "CVE-2018-11797",
    "cwe_id": "Not Mapping",
    "filename": "pdfbox/src/main/java/org/apache/pdfbox/cos/COSArray.java",
    "is_vulnerable": 0,
    "class_name": "COSArray",
    "subclass_name": null,
    "function_name": "getString( int index, String defaultValue )",
    "function_body": "{\n        String retval = defaultValue;\n        if( index < size() )\n        {\n            Object obj = objects.get( index );\n            if( obj instanceof COSString )\n            {\n                retval = ((COSString)obj).getString();\n            }\n        }\n        return retval;\n    }"
  },
  {
    "id": 19,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 23,
    "human_patch": "https://github.com/apache/pdfbox/commit/0e14d6a42cc965e23bb1b40f04b4c002dc173b88",
    "cve_id": "CVE-2018-11797",
    "cwe_id": "Not Mapping",
    "filename": "pdfbox/src/main/java/org/apache/pdfbox/cos/COSArray.java",
    "is_vulnerable": 0,
    "class_name": "COSArray",
    "subclass_name": null,
    "function_name": "size()",
    "function_body": "{\n        return objects.size();\n    }"
  },
  {
    "id": 19,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 24,
    "human_patch": "https://github.com/apache/pdfbox/commit/0e14d6a42cc965e23bb1b40f04b4c002dc173b88",
    "cve_id": "CVE-2018-11797",
    "cwe_id": "Not Mapping",
    "filename": "pdfbox/src/main/java/org/apache/pdfbox/cos/COSArray.java",
    "is_vulnerable": 0,
    "class_name": "COSArray",
    "subclass_name": null,
    "function_name": "remove( int i )",
    "function_body": "{\n        return objects.remove( i );\n    }"
  },
  {
    "id": 19,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 25,
    "human_patch": "https://github.com/apache/pdfbox/commit/0e14d6a42cc965e23bb1b40f04b4c002dc173b88",
    "cve_id": "CVE-2018-11797",
    "cwe_id": "Not Mapping",
    "filename": "pdfbox/src/main/java/org/apache/pdfbox/cos/COSArray.java",
    "is_vulnerable": 0,
    "class_name": "COSArray",
    "subclass_name": null,
    "function_name": "remove( COSBase o )",
    "function_body": "{\n        return objects.remove( o );\n    }"
  },
  {
    "id": 19,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 26,
    "human_patch": "https://github.com/apache/pdfbox/commit/0e14d6a42cc965e23bb1b40f04b4c002dc173b88",
    "cve_id": "CVE-2018-11797",
    "cwe_id": "Not Mapping",
    "filename": "pdfbox/src/main/java/org/apache/pdfbox/cos/COSArray.java",
    "is_vulnerable": 0,
    "class_name": "COSArray",
    "subclass_name": null,
    "function_name": "removeObject(COSBase o)",
    "function_body": "{\n        boolean removed = this.remove(o);\n        if (!removed)\n        {\n            for (int i = 0; i < this.size(); i++)\n            {\n                COSBase entry = this.get(i);\n                if (entry instanceof COSObject)\n                {\n                    COSObject objEntry = (COSObject) entry;\n                    if (objEntry.getObject().equals(o))\n                    {\n                        return this.remove(entry);\n                    }\n                }\n            }\n        }\n        return removed;\n    }"
  },
  {
    "id": 19,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 27,
    "human_patch": "https://github.com/apache/pdfbox/commit/0e14d6a42cc965e23bb1b40f04b4c002dc173b88",
    "cve_id": "CVE-2018-11797",
    "cwe_id": "Not Mapping",
    "filename": "pdfbox/src/main/java/org/apache/pdfbox/cos/COSArray.java",
    "is_vulnerable": 0,
    "class_name": "COSArray",
    "subclass_name": null,
    "function_name": "toString()",
    "function_body": "{\n        return \"COSArray{\" + objects + \"}\";\n    }"
  },
  {
    "id": 19,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 28,
    "human_patch": "https://github.com/apache/pdfbox/commit/0e14d6a42cc965e23bb1b40f04b4c002dc173b88",
    "cve_id": "CVE-2018-11797",
    "cwe_id": "Not Mapping",
    "filename": "pdfbox/src/main/java/org/apache/pdfbox/cos/COSArray.java",
    "is_vulnerable": 0,
    "class_name": "COSArray",
    "subclass_name": null,
    "function_name": "iterator()",
    "function_body": "{\n        return objects.iterator();\n    }"
  },
  {
    "id": 19,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 29,
    "human_patch": "https://github.com/apache/pdfbox/commit/0e14d6a42cc965e23bb1b40f04b4c002dc173b88",
    "cve_id": "CVE-2018-11797",
    "cwe_id": "Not Mapping",
    "filename": "pdfbox/src/main/java/org/apache/pdfbox/cos/COSArray.java",
    "is_vulnerable": 0,
    "class_name": "COSArray",
    "subclass_name": null,
    "function_name": "indexOf( COSBase object )",
    "function_body": "{\n        int retval = -1;\n        for( int i=0; retval < 0 && i<size(); i++ )\n        {\n            if( get( i ).equals( object ) )\n            {\n                retval = i;\n            }\n        }\n        return retval;\n    }"
  },
  {
    "id": 19,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 30,
    "human_patch": "https://github.com/apache/pdfbox/commit/0e14d6a42cc965e23bb1b40f04b4c002dc173b88",
    "cve_id": "CVE-2018-11797",
    "cwe_id": "Not Mapping",
    "filename": "pdfbox/src/main/java/org/apache/pdfbox/cos/COSArray.java",
    "is_vulnerable": 0,
    "class_name": "COSArray",
    "subclass_name": null,
    "function_name": "indexOfObject(COSBase object)",
    "function_body": "{\n        int retval = -1;\n        for (int i = 0; retval < 0 && i < this.size(); i++)\n        {\n            COSBase item = this.get(i);\n            if (item.equals(object))\n            {\n                retval = i;\n                break;\n            }\n            else if (item instanceof COSObject && ((COSObject) item).getObject().equals(object))\n            {\n                retval = i;\n                break;\n            }\n        }\n        return retval;\n    }"
  },
  {
    "id": 19,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 31,
    "human_patch": "https://github.com/apache/pdfbox/commit/0e14d6a42cc965e23bb1b40f04b4c002dc173b88",
    "cve_id": "CVE-2018-11797",
    "cwe_id": "Not Mapping",
    "filename": "pdfbox/src/main/java/org/apache/pdfbox/cos/COSArray.java",
    "is_vulnerable": 0,
    "class_name": "COSArray",
    "subclass_name": null,
    "function_name": "growToSize( int size )",
    "function_body": "{\n        growToSize( size, null );\n    }"
  },
  {
    "id": 19,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 32,
    "human_patch": "https://github.com/apache/pdfbox/commit/0e14d6a42cc965e23bb1b40f04b4c002dc173b88",
    "cve_id": "CVE-2018-11797",
    "cwe_id": "Not Mapping",
    "filename": "pdfbox/src/main/java/org/apache/pdfbox/cos/COSArray.java",
    "is_vulnerable": 0,
    "class_name": "COSArray",
    "subclass_name": null,
    "function_name": "growToSize( int size, COSBase object )",
    "function_body": "{\n        while( size() < size )\n        {\n            add( object );\n        }\n    }"
  },
  {
    "id": 19,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 33,
    "human_patch": "https://github.com/apache/pdfbox/commit/0e14d6a42cc965e23bb1b40f04b4c002dc173b88",
    "cve_id": "CVE-2018-11797",
    "cwe_id": "Not Mapping",
    "filename": "pdfbox/src/main/java/org/apache/pdfbox/cos/COSArray.java",
    "is_vulnerable": 0,
    "class_name": "COSArray",
    "subclass_name": null,
    "function_name": "accept(ICOSVisitor visitor) throws IOException",
    "function_body": "{\n        return visitor.visitFromArray(this);\n    }"
  },
  {
    "id": 19,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 34,
    "human_patch": "https://github.com/apache/pdfbox/commit/0e14d6a42cc965e23bb1b40f04b4c002dc173b88",
    "cve_id": "CVE-2018-11797",
    "cwe_id": "Not Mapping",
    "filename": "pdfbox/src/main/java/org/apache/pdfbox/cos/COSArray.java",
    "is_vulnerable": 0,
    "class_name": "COSArray",
    "subclass_name": null,
    "function_name": "isNeedToBeUpdated()",
    "function_body": "{\n      return needToBeUpdated;\n    }"
  },
  {
    "id": 19,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 35,
    "human_patch": "https://github.com/apache/pdfbox/commit/0e14d6a42cc965e23bb1b40f04b4c002dc173b88",
    "cve_id": "CVE-2018-11797",
    "cwe_id": "Not Mapping",
    "filename": "pdfbox/src/main/java/org/apache/pdfbox/cos/COSArray.java",
    "is_vulnerable": 0,
    "class_name": "COSArray",
    "subclass_name": null,
    "function_name": "setNeedToBeUpdated(boolean flag)",
    "function_body": "{\n      needToBeUpdated = flag;\n    }"
  },
  {
    "id": 19,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 36,
    "human_patch": "https://github.com/apache/pdfbox/commit/0e14d6a42cc965e23bb1b40f04b4c002dc173b88",
    "cve_id": "CVE-2018-11797",
    "cwe_id": "Not Mapping",
    "filename": "pdfbox/src/main/java/org/apache/pdfbox/cos/COSArray.java",
    "is_vulnerable": 1,
    "class_name": "COSArray",
    "subclass_name": null,
    "function_name": "toFloatArray()",
    "function_body": "{\n        float[] retval = new float[size()];\n        for( int i=0; i<size(); i++ )\n        {\n            retval[i] = ((COSNumber)getObject( i )).floatValue();\n        }\n        return retval;\n    }"
  },
  {
    "id": 19,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 37,
    "human_patch": "https://github.com/apache/pdfbox/commit/0e14d6a42cc965e23bb1b40f04b4c002dc173b88",
    "cve_id": "CVE-2018-11797",
    "cwe_id": "Not Mapping",
    "filename": "pdfbox/src/main/java/org/apache/pdfbox/cos/COSArray.java",
    "is_vulnerable": 0,
    "class_name": "COSArray",
    "subclass_name": null,
    "function_name": "setFloatArray( float[] value )",
    "function_body": "{\n        this.clear();\n        for (float aValue : value)\n        {\n            add(new COSFloat(aValue));\n        }\n    }"
  },
  {
    "id": 19,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 38,
    "human_patch": "https://github.com/apache/pdfbox/commit/0e14d6a42cc965e23bb1b40f04b4c002dc173b88",
    "cve_id": "CVE-2018-11797",
    "cwe_id": "Not Mapping",
    "filename": "pdfbox/src/main/java/org/apache/pdfbox/cos/COSArray.java",
    "is_vulnerable": 0,
    "class_name": "COSArray",
    "subclass_name": null,
    "function_name": "toList()",
    "function_body": "{\n        List<COSBase> retList = new ArrayList<>(size());\n        for (int i = 0; i < size(); i++)\n        {\n            retList.add(get(i));\n        }\n        return retList;\n    }"
  },
  {
    "id": 20,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 0,
    "human_patch": "https://github.com/apache/santuario-java/commit/e50488044121cf01ffbc235ca53b9562031d69c5",
    "cve_id": "CVE-2014-8152",
    "cwe_id": "CWE-254",
    "filename": "src/main/java/org/apache/xml/security/stax/ext/InputProcessorChain.java",
    "is_vulnerable": 0,
    "class_name": "InputProcessorChain",
    "subclass_name": null,
    "function_name": "addProcessor(InputProcessor inputProcessor)",
    "function_body": null
  },
  {
    "id": 20,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 1,
    "human_patch": "https://github.com/apache/santuario-java/commit/e50488044121cf01ffbc235ca53b9562031d69c5",
    "cve_id": "CVE-2014-8152",
    "cwe_id": "CWE-254",
    "filename": "src/main/java/org/apache/xml/security/stax/ext/InputProcessorChain.java",
    "is_vulnerable": 0,
    "class_name": "InputProcessorChain",
    "subclass_name": null,
    "function_name": "removeProcessor(InputProcessor inputProcessor)",
    "function_body": null
  },
  {
    "id": 20,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 2,
    "human_patch": "https://github.com/apache/santuario-java/commit/e50488044121cf01ffbc235ca53b9562031d69c5",
    "cve_id": "CVE-2014-8152",
    "cwe_id": "CWE-254",
    "filename": "src/main/java/org/apache/xml/security/stax/ext/InputProcessorChain.java",
    "is_vulnerable": 0,
    "class_name": "InputProcessorChain",
    "subclass_name": null,
    "function_name": "getProcessors()",
    "function_body": null
  },
  {
    "id": 20,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 3,
    "human_patch": "https://github.com/apache/santuario-java/commit/e50488044121cf01ffbc235ca53b9562031d69c5",
    "cve_id": "CVE-2014-8152",
    "cwe_id": "CWE-254",
    "filename": "src/main/java/org/apache/xml/security/stax/ext/InputProcessorChain.java",
    "is_vulnerable": 0,
    "class_name": "InputProcessorChain",
    "subclass_name": null,
    "function_name": "getSecurityContext()",
    "function_body": null
  },
  {
    "id": 20,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 4,
    "human_patch": "https://github.com/apache/santuario-java/commit/e50488044121cf01ffbc235ca53b9562031d69c5",
    "cve_id": "CVE-2014-8152",
    "cwe_id": "CWE-254",
    "filename": "src/main/java/org/apache/xml/security/stax/ext/InputProcessorChain.java",
    "is_vulnerable": 0,
    "class_name": "InputProcessorChain",
    "subclass_name": null,
    "function_name": "getDocumentContext()",
    "function_body": null
  },
  {
    "id": 20,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 5,
    "human_patch": "https://github.com/apache/santuario-java/commit/e50488044121cf01ffbc235ca53b9562031d69c5",
    "cve_id": "CVE-2014-8152",
    "cwe_id": "CWE-254",
    "filename": "src/main/java/org/apache/xml/security/stax/ext/InputProcessorChain.java",
    "is_vulnerable": 0,
    "class_name": "InputProcessorChain",
    "subclass_name": null,
    "function_name": "createSubChain(InputProcessor inputProcessor) throws XMLStreamException, XMLSecurityException",
    "function_body": null
  },
  {
    "id": 20,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 6,
    "human_patch": "https://github.com/apache/santuario-java/commit/e50488044121cf01ffbc235ca53b9562031d69c5",
    "cve_id": "CVE-2014-8152",
    "cwe_id": "CWE-254",
    "filename": "src/main/java/org/apache/xml/security/stax/ext/InputProcessorChain.java",
    "is_vulnerable": 0,
    "class_name": "InputProcessorChain",
    "subclass_name": null,
    "function_name": "processHeaderEvent() throws XMLStreamException, XMLSecurityException",
    "function_body": null
  },
  {
    "id": 20,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 7,
    "human_patch": "https://github.com/apache/santuario-java/commit/e50488044121cf01ffbc235ca53b9562031d69c5",
    "cve_id": "CVE-2014-8152",
    "cwe_id": "CWE-254",
    "filename": "src/main/java/org/apache/xml/security/stax/ext/InputProcessorChain.java",
    "is_vulnerable": 0,
    "class_name": "InputProcessorChain",
    "subclass_name": null,
    "function_name": "processEvent() throws XMLStreamException, XMLSecurityException",
    "function_body": null
  },
  {
    "id": 20,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 0,
    "human_patch": "https://github.com/apache/santuario-java/commit/e50488044121cf01ffbc235ca53b9562031d69c5",
    "cve_id": "CVE-2014-8152",
    "cwe_id": "CWE-254",
    "filename": "src/main/java/org/apache/xml/security/stax/impl/InputProcessorChainImpl.java",
    "is_vulnerable": 0,
    "class_name": "InputProcessorChainImpl",
    "subclass_name": null,
    "function_name": "reset()",
    "function_body": "{\n        this.curPos = startPos;\n    }"
  },
  {
    "id": 20,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 1,
    "human_patch": "https://github.com/apache/santuario-java/commit/e50488044121cf01ffbc235ca53b9562031d69c5",
    "cve_id": "CVE-2014-8152",
    "cwe_id": "CWE-254",
    "filename": "src/main/java/org/apache/xml/security/stax/impl/InputProcessorChainImpl.java",
    "is_vulnerable": 0,
    "class_name": "InputProcessorChainImpl",
    "subclass_name": null,
    "function_name": "getSecurityContext()",
    "function_body": "{\n        return this.inboundSecurityContext;\n    }"
  },
  {
    "id": 20,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 2,
    "human_patch": "https://github.com/apache/santuario-java/commit/e50488044121cf01ffbc235ca53b9562031d69c5",
    "cve_id": "CVE-2014-8152",
    "cwe_id": "CWE-254",
    "filename": "src/main/java/org/apache/xml/security/stax/impl/InputProcessorChainImpl.java",
    "is_vulnerable": 0,
    "class_name": "InputProcessorChainImpl",
    "subclass_name": null,
    "function_name": "getDocumentContext()",
    "function_body": "{\n        return this.documentContext;\n    }"
  },
  {
    "id": 20,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 3,
    "human_patch": "https://github.com/apache/santuario-java/commit/e50488044121cf01ffbc235ca53b9562031d69c5",
    "cve_id": "CVE-2014-8152",
    "cwe_id": "CWE-254",
    "filename": "src/main/java/org/apache/xml/security/stax/impl/InputProcessorChainImpl.java",
    "is_vulnerable": 0,
    "class_name": "InputProcessorChainImpl",
    "subclass_name": null,
    "function_name": "addProcessor(InputProcessor newInputProcessor)",
    "function_body": "{\n        int startPhaseIdx = 0;\n        int endPhaseIdx = inputProcessors.size();\n\n        XMLSecurityConstants.Phase targetPhase = newInputProcessor.getPhase();\n\n        for (int i = inputProcessors.size() - 1; i >= 0; i--) {\n            InputProcessor inputProcessor = inputProcessors.get(i);\n            if (inputProcessor.getPhase().ordinal() > targetPhase.ordinal()) {\n                startPhaseIdx = i + 1;\n                break;\n            }\n        }\n        for (int i = startPhaseIdx; i < inputProcessors.size(); i++) {\n            InputProcessor inputProcessor = inputProcessors.get(i);\n            if (inputProcessor.getPhase().ordinal() < targetPhase.ordinal()) {\n                endPhaseIdx = i;\n                break;\n            }\n        }\n\n        \n        if (newInputProcessor.getBeforeProcessors().isEmpty()\n                && newInputProcessor.getAfterProcessors().isEmpty()) {\n            inputProcessors.add(startPhaseIdx, newInputProcessor);\n        } else if (newInputProcessor.getBeforeProcessors().isEmpty()) {\n            int idxToInsert = startPhaseIdx;\n\n            for (int i = endPhaseIdx - 1; i >= startPhaseIdx; i--) {\n                InputProcessor inputProcessor = inputProcessors.get(i);\n                if (newInputProcessor.getAfterProcessors().contains(inputProcessor)\n                        || newInputProcessor.getAfterProcessors().contains(inputProcessor.getClass().getName())) {\n                    idxToInsert = i;\n                    break;\n                }\n            }\n            inputProcessors.add(idxToInsert, newInputProcessor);\n        } else if (newInputProcessor.getAfterProcessors().isEmpty()) {\n            int idxToInsert = endPhaseIdx;\n\n            for (int i = startPhaseIdx; i < endPhaseIdx; i++) {\n                InputProcessor inputProcessor = inputProcessors.get(i);\n                if (newInputProcessor.getBeforeProcessors().contains(inputProcessor)\n                        || newInputProcessor.getBeforeProcessors().contains(inputProcessor.getClass().getName())) {\n                    idxToInsert = i + 1;\n                    break;\n                }\n            }\n            inputProcessors.add(idxToInsert, newInputProcessor);\n        } else {\n            boolean found = false;\n            int idxToInsert = startPhaseIdx;\n\n            for (int i = endPhaseIdx - 1; i >= startPhaseIdx; i--) {\n                InputProcessor inputProcessor = inputProcessors.get(i);\n                if (newInputProcessor.getAfterProcessors().contains(inputProcessor)\n                        || newInputProcessor.getAfterProcessors().contains(inputProcessor.getClass().getName())) {\n                    idxToInsert = i;\n                    found = true;\n                    break;\n                }\n            }\n            if (found) {\n                inputProcessors.add(idxToInsert, newInputProcessor);\n            } else {\n                for (int i = startPhaseIdx; i < endPhaseIdx; i++) {\n                    InputProcessor inputProcessor = inputProcessors.get(i);\n                    if (newInputProcessor.getBeforeProcessors().contains(inputProcessor)\n                            || newInputProcessor.getBeforeProcessors().contains(inputProcessor.getClass().getName())) {\n                        idxToInsert = i + 1;\n                        break;\n                    }\n                }\n                inputProcessors.add(idxToInsert, newInputProcessor);\n            }\n        }\n        if (isDebugEnabled) {\n            log.debug(\"Added \" + newInputProcessor.getClass().getName() + \" to input chain: \");\n            for (int i = 0; i < inputProcessors.size(); i++) {\n                InputProcessor inputProcessor = inputProcessors.get(i);\n                log.debug(\"Name: \" + inputProcessor.getClass().getName() + \" phase: \" + inputProcessor.getPhase());\n            }\n        }\n    }"
  },
  {
    "id": 20,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 4,
    "human_patch": "https://github.com/apache/santuario-java/commit/e50488044121cf01ffbc235ca53b9562031d69c5",
    "cve_id": "CVE-2014-8152",
    "cwe_id": "CWE-254",
    "filename": "src/main/java/org/apache/xml/security/stax/impl/InputProcessorChainImpl.java",
    "is_vulnerable": 0,
    "class_name": "InputProcessorChainImpl",
    "subclass_name": null,
    "function_name": "removeProcessor(InputProcessor inputProcessor)",
    "function_body": "{\n        if (isDebugEnabled) {\n            log.debug(\"Removing processor \" + inputProcessor.getClass().getName() + \" from input chain\");\n        }\n        if (this.inputProcessors.indexOf(inputProcessor) <= curPos) {\n            this.curPos--;\n        }\n        this.inputProcessors.remove(inputProcessor);\n    }"
  },
  {
    "id": 20,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 5,
    "human_patch": "https://github.com/apache/santuario-java/commit/e50488044121cf01ffbc235ca53b9562031d69c5",
    "cve_id": "CVE-2014-8152",
    "cwe_id": "CWE-254",
    "filename": "src/main/java/org/apache/xml/security/stax/impl/InputProcessorChainImpl.java",
    "is_vulnerable": 0,
    "class_name": "InputProcessorChainImpl",
    "subclass_name": null,
    "function_name": "getProcessors()",
    "function_body": "{\n        return this.inputProcessors;\n    }"
  },
  {
    "id": 20,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 6,
    "human_patch": "https://github.com/apache/santuario-java/commit/e50488044121cf01ffbc235ca53b9562031d69c5",
    "cve_id": "CVE-2014-8152",
    "cwe_id": "CWE-254",
    "filename": "src/main/java/org/apache/xml/security/stax/impl/InputProcessorChainImpl.java",
    "is_vulnerable": 0,
    "class_name": "InputProcessorChainImpl",
    "subclass_name": null,
    "function_name": "processHeaderEvent() throws XMLStreamException, XMLSecurityException",
    "function_body": "{\n        return inputProcessors.get(this.curPos++).processNextHeaderEvent(this);\n    }"
  },
  {
    "id": 20,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 7,
    "human_patch": "https://github.com/apache/santuario-java/commit/e50488044121cf01ffbc235ca53b9562031d69c5",
    "cve_id": "CVE-2014-8152",
    "cwe_id": "CWE-254",
    "filename": "src/main/java/org/apache/xml/security/stax/impl/InputProcessorChainImpl.java",
    "is_vulnerable": 0,
    "class_name": "InputProcessorChainImpl",
    "subclass_name": null,
    "function_name": "processEvent() throws XMLStreamException, XMLSecurityException",
    "function_body": "{\n        return inputProcessors.get(this.curPos++).processNextEvent(this);\n    }"
  },
  {
    "id": 20,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 8,
    "human_patch": "https://github.com/apache/santuario-java/commit/e50488044121cf01ffbc235ca53b9562031d69c5",
    "cve_id": "CVE-2014-8152",
    "cwe_id": "CWE-254",
    "filename": "src/main/java/org/apache/xml/security/stax/impl/InputProcessorChainImpl.java",
    "is_vulnerable": 0,
    "class_name": "InputProcessorChainImpl",
    "subclass_name": null,
    "function_name": "doFinal() throws XMLStreamException, XMLSecurityException",
    "function_body": "{\n        inputProcessors.get(this.curPos++).doFinal(this);\n    }"
  },
  {
    "id": 20,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 9,
    "human_patch": "https://github.com/apache/santuario-java/commit/e50488044121cf01ffbc235ca53b9562031d69c5",
    "cve_id": "CVE-2014-8152",
    "cwe_id": "CWE-254",
    "filename": "src/main/java/org/apache/xml/security/stax/impl/InputProcessorChainImpl.java",
    "is_vulnerable": 1,
    "class_name": "InputProcessorChainImpl",
    "subclass_name": null,
    "function_name": "createSubChain(InputProcessor inputProcessor) throws XMLStreamException, XMLSecurityException",
    "function_body": "{\n        InputProcessorChainImpl inputProcessorChain;\n        try {\n            inputProcessorChain = new InputProcessorChainImpl(inboundSecurityContext, documentContext.clone(),\n                    inputProcessors.indexOf(inputProcessor) + 1, new ArrayList<InputProcessor>(this.inputProcessors));\n        } catch (CloneNotSupportedException e) {\n            throw new XMLSecurityException(e);\n        }\n        return inputProcessorChain;\n    }"
  },
  {
    "id": 20,
    "sub_id": 2,
    "code_id": 0,
    "function_id": 0,
    "human_patch": "https://github.com/apache/santuario-java/commit/e50488044121cf01ffbc235ca53b9562031d69c5",
    "cve_id": "CVE-2014-8152",
    "cwe_id": "CWE-254",
    "filename": "src/main/java/org/apache/xml/security/stax/impl/processor/input/XMLSecurityInputProcessor.java",
    "is_vulnerable": 0,
    "class_name": "XMLSecurityInputProcessor",
    "subclass_name": null,
    "function_name": "processNextHeaderEvent(InputProcessorChain inputProcessorChain) throws XMLStreamException, XMLSecurityException",
    "function_body": "{\n        return null;\n    }"
  },
  {
    "id": 20,
    "sub_id": 2,
    "code_id": 0,
    "function_id": 1,
    "human_patch": "https://github.com/apache/santuario-java/commit/e50488044121cf01ffbc235ca53b9562031d69c5",
    "cve_id": "CVE-2014-8152",
    "cwe_id": "CWE-254",
    "filename": "src/main/java/org/apache/xml/security/stax/impl/processor/input/XMLSecurityInputProcessor.java",
    "is_vulnerable": 1,
    "class_name": "XMLSecurityInputProcessor",
    "subclass_name": null,
    "function_name": "processNextEvent(InputProcessorChain inputProcessorChain) throws XMLStreamException, XMLSecurityException",
    "function_body": "{\n\n        \n        if (internalBufferProcessor == null) {\n            internalBufferProcessor = new InternalBufferProcessor(getSecurityProperties());\n            inputProcessorChain.addProcessor(internalBufferProcessor);\n        }\n\n        XMLSecEvent xmlSecEvent = inputProcessorChain.processEvent();\n        switch (xmlSecEvent.getEventType()) {\n            case XMLStreamConstants.START_ELEMENT:\n                final XMLSecStartElement xmlSecStartElement = xmlSecEvent.asStartElement();\n\n                if (xmlSecStartElement.getName().equals(XMLSecurityConstants.TAG_dsig_Signature)) {\n                    signatureElementFound = true;\n                    startIndexForProcessor = internalBufferProcessor.getXmlSecEventList().size() - 1;\n                } else if (xmlSecStartElement.getName().equals(XMLSecurityConstants.TAG_xenc_EncryptedData)) {\n                    encryptedDataElementFound = true;\n\n                    XMLDecryptInputProcessor decryptInputProcessor = new XMLDecryptInputProcessor(getSecurityProperties());\n                    decryptInputProcessor.setPhase(XMLSecurityConstants.Phase.PREPROCESSING);\n                    decryptInputProcessor.addAfterProcessor(XMLEventReaderInputProcessor.class.getName());\n                    decryptInputProcessor.addBeforeProcessor(XMLSecurityInputProcessor.class.getName());\n                    decryptInputProcessor.addBeforeProcessor(XMLSecurityInputProcessor.InternalBufferProcessor.class.getName());\n                    inputProcessorChain.addProcessor(decryptInputProcessor);\n\n                    final ArrayDeque<XMLSecEvent> xmlSecEventList = internalBufferProcessor.getXmlSecEventList();\n                    \n                    xmlSecEventList.pollFirst();\n\n                    \n                    AbstractInputProcessor abstractInputProcessor = new AbstractInputProcessor(getSecurityProperties()) {\n                        @Override\n                        public XMLSecEvent processNextHeaderEvent(InputProcessorChain inputProcessorChain)\n                                throws XMLStreamException, XMLSecurityException {\n                            return processNextEvent(inputProcessorChain);\n                        }\n\n                        @Override\n                        public XMLSecEvent processNextEvent(InputProcessorChain inputProcessorChain)\n                                throws XMLStreamException, XMLSecurityException {\n                            inputProcessorChain.removeProcessor(this);\n                            return xmlSecStartElement;\n                        }\n                    };\n                    abstractInputProcessor.setPhase(XMLSecurityConstants.Phase.PREPROCESSING);\n                    abstractInputProcessor.addBeforeProcessor(decryptInputProcessor);\n                    inputProcessorChain.addProcessor(abstractInputProcessor);\n\n                    \n                    inputProcessorChain.reset();\n                    xmlSecEvent = inputProcessorChain.processEvent();\n\n                    \n                    if (xmlSecEvent.isStartElement() &&\n                            xmlSecEvent.asStartElement().getName().equals(XMLSecurityConstants.TAG_dsig_Signature)) {\n                        signatureElementFound = true;\n                        startIndexForProcessor = internalBufferProcessor.getXmlSecEventList().size() - 1;\n                    }\n                }\n                break;\n            case XMLStreamConstants.END_ELEMENT:\n                XMLSecEndElement xmlSecEndElement = xmlSecEvent.asEndElement();\n                \n                if (signatureElementFound\n                        && xmlSecEndElement.getName().equals(XMLSecurityConstants.TAG_dsig_Signature)) {\n                    XMLSignatureInputHandler inputHandler = new XMLSignatureInputHandler();\n\n                    final ArrayDeque<XMLSecEvent> xmlSecEventList = internalBufferProcessor.getXmlSecEventList();\n                    inputHandler.handle(inputProcessorChain, getSecurityProperties(),\n                            xmlSecEventList, startIndexForProcessor);\n\n                    inputProcessorChain.removeProcessor(internalBufferProcessor);\n\n                    \n                    InternalReplayProcessor internalReplayProcessor =\n                            new InternalReplayProcessor(getSecurityProperties(), xmlSecEventList);\n                    internalReplayProcessor.addBeforeProcessor(XMLSignatureReferenceVerifyInputProcessor.class.getName());\n                    inputProcessorChain.addProcessor(internalReplayProcessor);\n\n                    \n                    InputProcessorChain subInputProcessorChain = inputProcessorChain.createSubChain(this);\n                    while (!xmlSecEventList.isEmpty()) {\n                        subInputProcessorChain.reset();\n                        subInputProcessorChain.processEvent();\n                    }\n                }\n                break;\n        }\n\n        return xmlSecEvent;\n    }"
  },
  {
    "id": 20,
    "sub_id": 2,
    "code_id": 0,
    "function_id": 2,
    "human_patch": "https://github.com/apache/santuario-java/commit/e50488044121cf01ffbc235ca53b9562031d69c5",
    "cve_id": "CVE-2014-8152",
    "cwe_id": "CWE-254",
    "filename": "src/main/java/org/apache/xml/security/stax/impl/processor/input/XMLSecurityInputProcessor.java",
    "is_vulnerable": 1,
    "class_name": "XMLSecurityInputProcessor",
    "subclass_name": null,
    "function_name": "processNextHeaderEvent(InputProcessorChain inputProcessorChain) throws XMLStreamException, XMLSecurityException",
    "function_body": "{\n                            return processNextEvent(inputProcessorChain);\n                        }"
  },
  {
    "id": 20,
    "sub_id": 2,
    "code_id": 0,
    "function_id": 3,
    "human_patch": "https://github.com/apache/santuario-java/commit/e50488044121cf01ffbc235ca53b9562031d69c5",
    "cve_id": "CVE-2014-8152",
    "cwe_id": "CWE-254",
    "filename": "src/main/java/org/apache/xml/security/stax/impl/processor/input/XMLSecurityInputProcessor.java",
    "is_vulnerable": 1,
    "class_name": "XMLSecurityInputProcessor",
    "subclass_name": null,
    "function_name": "processNextEvent(InputProcessorChain inputProcessorChain) throws XMLStreamException, XMLSecurityException",
    "function_body": "{\n                            inputProcessorChain.removeProcessor(this);\n                            return xmlSecStartElement;\n                        }"
  },
  {
    "id": 20,
    "sub_id": 2,
    "code_id": 0,
    "function_id": 4,
    "human_patch": "https://github.com/apache/santuario-java/commit/e50488044121cf01ffbc235ca53b9562031d69c5",
    "cve_id": "CVE-2014-8152",
    "cwe_id": "CWE-254",
    "filename": "src/main/java/org/apache/xml/security/stax/impl/processor/input/XMLSecurityInputProcessor.java",
    "is_vulnerable": 0,
    "class_name": "XMLSecurityInputProcessor",
    "subclass_name": null,
    "function_name": "doFinal(InputProcessorChain inputProcessorChain) throws XMLStreamException, XMLSecurityException",
    "function_body": "{\n        if (!signatureElementFound && !encryptedDataElementFound) {\n            throw new XMLSecurityException(\"stax.unsecuredMessage\");\n        }\n        super.doFinal(inputProcessorChain);\n    }"
  },
  {
    "id": 20,
    "sub_id": 2,
    "code_id": 0,
    "function_id": 5,
    "human_patch": "https://github.com/apache/santuario-java/commit/e50488044121cf01ffbc235ca53b9562031d69c5",
    "cve_id": "CVE-2014-8152",
    "cwe_id": "CWE-254",
    "filename": "src/main/java/org/apache/xml/security/stax/impl/processor/input/XMLSecurityInputProcessor.java",
    "is_vulnerable": 0,
    "class_name": "XMLSecurityInputProcessor",
    "subclass_name": "InternalBufferProcessor",
    "function_name": "getXmlSecEventList()",
    "function_body": "{\n            return xmlSecEventList;\n        }"
  },
  {
    "id": 20,
    "sub_id": 2,
    "code_id": 0,
    "function_id": 6,
    "human_patch": "https://github.com/apache/santuario-java/commit/e50488044121cf01ffbc235ca53b9562031d69c5",
    "cve_id": "CVE-2014-8152",
    "cwe_id": "CWE-254",
    "filename": "src/main/java/org/apache/xml/security/stax/impl/processor/input/XMLSecurityInputProcessor.java",
    "is_vulnerable": 0,
    "class_name": "XMLSecurityInputProcessor",
    "subclass_name": "InternalBufferProcessor",
    "function_name": "processNextHeaderEvent(InputProcessorChain inputProcessorChain) throws XMLStreamException, XMLSecurityException",
    "function_body": "{\n            return null;\n        }"
  },
  {
    "id": 20,
    "sub_id": 2,
    "code_id": 0,
    "function_id": 7,
    "human_patch": "https://github.com/apache/santuario-java/commit/e50488044121cf01ffbc235ca53b9562031d69c5",
    "cve_id": "CVE-2014-8152",
    "cwe_id": "CWE-254",
    "filename": "src/main/java/org/apache/xml/security/stax/impl/processor/input/XMLSecurityInputProcessor.java",
    "is_vulnerable": 0,
    "class_name": "XMLSecurityInputProcessor",
    "subclass_name": "InternalBufferProcessor",
    "function_name": "processNextEvent(InputProcessorChain inputProcessorChain) throws XMLStreamException, XMLSecurityException",
    "function_body": "{\n            XMLSecEvent xmlSecEvent = inputProcessorChain.processEvent();\n            xmlSecEventList.push(xmlSecEvent);\n            return xmlSecEvent;\n        }"
  },
  {
    "id": 20,
    "sub_id": 2,
    "code_id": 0,
    "function_id": 8,
    "human_patch": "https://github.com/apache/santuario-java/commit/e50488044121cf01ffbc235ca53b9562031d69c5",
    "cve_id": "CVE-2014-8152",
    "cwe_id": "CWE-254",
    "filename": "src/main/java/org/apache/xml/security/stax/impl/processor/input/XMLSecurityInputProcessor.java",
    "is_vulnerable": 0,
    "class_name": "XMLSecurityInputProcessor",
    "subclass_name": "InternalReplayProcessor",
    "function_name": "processNextHeaderEvent(InputProcessorChain inputProcessorChain) throws XMLStreamException, XMLSecurityException",
    "function_body": "{\n            return null;\n        }"
  },
  {
    "id": 20,
    "sub_id": 2,
    "code_id": 0,
    "function_id": 9,
    "human_patch": "https://github.com/apache/santuario-java/commit/e50488044121cf01ffbc235ca53b9562031d69c5",
    "cve_id": "CVE-2014-8152",
    "cwe_id": "CWE-254",
    "filename": "src/main/java/org/apache/xml/security/stax/impl/processor/input/XMLSecurityInputProcessor.java",
    "is_vulnerable": 0,
    "class_name": "XMLSecurityInputProcessor",
    "subclass_name": "InternalReplayProcessor",
    "function_name": "processNextEvent(InputProcessorChain inputProcessorChain) throws XMLStreamException, XMLSecurityException",
    "function_body": "{\n\n            if (!xmlSecEventList.isEmpty()) {\n                return xmlSecEventList.pollLast();\n            } else {\n                inputProcessorChain.removeProcessor(this);\n                return inputProcessorChain.processEvent();\n            }\n        }"
  },
  {
    "id": 20,
    "sub_id": 3,
    "code_id": 0,
    "function_id": 0,
    "human_patch": "https://github.com/apache/santuario-java/commit/e50488044121cf01ffbc235ca53b9562031d69c5",
    "cve_id": "CVE-2014-8152",
    "cwe_id": "CWE-254",
    "filename": "src/test/java/org/apache/xml/security/test/stax/signature/SignatureVerificationTest.java",
    "is_vulnerable": 0,
    "class_name": "SignatureVerificationTest",
    "subclass_name": null,
    "function_name": "setUp() throws Exception",
    "function_body": "{\n        Init.init(SignatureVerificationTest.class.getClassLoader().getResource(\"security-config.xml\").toURI(),\n                this.getClass());\n        org.apache.xml.security.Init.init();\n        \n        xmlInputFactory = XMLInputFactory.newInstance();\n        xmlInputFactory.setEventAllocator(new XMLSecEventAllocator());\n    }"
  },
  {
    "id": 20,
    "sub_id": 3,
    "code_id": 0,
    "function_id": 1,
    "human_patch": "https://github.com/apache/santuario-java/commit/e50488044121cf01ffbc235ca53b9562031d69c5",
    "cve_id": "CVE-2014-8152",
    "cwe_id": "CWE-254",
    "filename": "src/test/java/org/apache/xml/security/test/stax/signature/SignatureVerificationTest.java",
    "is_vulnerable": 0,
    "class_name": "SignatureVerificationTest",
    "subclass_name": null,
    "function_name": "testSignatureVerification() throws Exception",
    "function_body": "{\n        \n        InputStream sourceDocument = \n                this.getClass().getClassLoader().getResourceAsStream(\n                        \"ie/baltimore/merlin-examples/merlin-xmlenc-five/plaintext.xml\");\n        DocumentBuilder builder = XMLUtils.createDocumentBuilder(false);\n        Document document = builder.parse(sourceDocument);\n        \n        \n        KeyStore keyStore = KeyStore.getInstance(\"jks\");\n        keyStore.load(\n            this.getClass().getClassLoader().getResource(\"transmitter.jks\").openStream(), \n            \"default\".toCharArray()\n        );\n        Key key = keyStore.getKey(\"transmitter\", \"default\".toCharArray());\n        X509Certificate cert = (X509Certificate)keyStore.getCertificate(\"transmitter\");\n        \n        \n        List<String> localNames = new ArrayList<String>();\n        localNames.add(\"PaymentInfo\");\n        XMLSignature sig = signUsingDOM(\n            \"http://www.w3.org/2000/09/xmldsig#rsa-sha1\", document, localNames, key\n        );\n        \n        \n        sig.addKeyInfo(cert);\n        \n        \n        \n        \n        javax.xml.transform.Transformer transformer = transformerFactory.newTransformer();\n        ByteArrayOutputStream baos = new ByteArrayOutputStream();\n        transformer.transform(new DOMSource(document), new StreamResult(baos));\n        final XMLStreamReader xmlStreamReader = \n                xmlInputFactory.createXMLStreamReader(new ByteArrayInputStream(baos.toByteArray()));\n  \n        \n        XMLSecurityProperties properties = new XMLSecurityProperties();\n        InboundXMLSec inboundXMLSec = XMLSec.getInboundWSSec(properties);\n        TestSecurityEventListener securityEventListener = new TestSecurityEventListener();\n        XMLStreamReader securityStreamReader = \n                inboundXMLSec.processInMessage(xmlStreamReader, null, securityEventListener);\n\n        document = StAX2DOM.readDoc(XMLUtils.createDocumentBuilder(false), securityStreamReader);\n        \n        \n        checkSecurityEvents(securityEventListener);\n        checkSignedElementSecurityEvents(securityEventListener);\n        checkSignatureToken(securityEventListener, cert, null,\n                            SecurityTokenConstants.KeyIdentifier_X509KeyIdentifier);\n\n        SignedElementSecurityEvent signedElementSecurityEvent = securityEventListener.getSecurityEvent(SecurityEventConstants.SignedElement);\n        X509TokenSecurityEvent x509TokenSecurityEvent = securityEventListener.getSecurityEvent(SecurityEventConstants.X509Token);\n        String signedElementCorrelationID = signedElementSecurityEvent.getCorrelationID();\n        String x509TokenCorrelationID = x509TokenSecurityEvent.getCorrelationID();\n\n        List<SecurityEvent> signatureSecurityEvents = new ArrayList<SecurityEvent>();\n        List<SecurityEvent> signedElementSecurityEvents = new ArrayList<SecurityEvent>();\n\n        List<SecurityEvent> securityEvents = securityEventListener.getSecurityEvents();\n        for (int i = 0; i < securityEvents.size(); i++) {\n            SecurityEvent securityEvent = securityEvents.get(i);\n            if (securityEvent.getCorrelationID().equals(signedElementCorrelationID)) {\n                signedElementSecurityEvents.add(securityEvent);\n            } else if (securityEvent.getCorrelationID().equals(x509TokenCorrelationID)) {\n                signatureSecurityEvents.add(securityEvent);\n            }\n        }\n\n        Assert.assertEquals(4, signatureSecurityEvents.size());\n        Assert.assertEquals(3, signedElementSecurityEvents.size());\n        Assert.assertEquals(securityEventListener.getSecurityEvents().size(),\n                signatureSecurityEvents.size() + signedElementSecurityEvents.size());\n    }"
  },
  {
    "id": 20,
    "sub_id": 3,
    "code_id": 0,
    "function_id": 2,
    "human_patch": "https://github.com/apache/santuario-java/commit/e50488044121cf01ffbc235ca53b9562031d69c5",
    "cve_id": "CVE-2014-8152",
    "cwe_id": "CWE-254",
    "filename": "src/test/java/org/apache/xml/security/test/stax/signature/SignatureVerificationTest.java",
    "is_vulnerable": 0,
    "class_name": "SignatureVerificationTest",
    "subclass_name": null,
    "function_name": "testMultipleElements() throws Exception",
    "function_body": "{\n        \n        InputStream sourceDocument = \n                this.getClass().getClassLoader().getResourceAsStream(\n                        \"ie/baltimore/merlin-examples/merlin-xmlenc-five/plaintext.xml\");\n        DocumentBuilder builder = XMLUtils.createDocumentBuilder(false);\n        Document document = builder.parse(sourceDocument);\n        \n        \n        KeyStore keyStore = KeyStore.getInstance(\"jks\");\n        keyStore.load(\n            this.getClass().getClassLoader().getResource(\"transmitter.jks\").openStream(), \n            \"default\".toCharArray()\n        );\n        Key key = keyStore.getKey(\"transmitter\", \"default\".toCharArray());\n        X509Certificate cert = (X509Certificate)keyStore.getCertificate(\"transmitter\");\n        \n        \n        List<String> localNames = new ArrayList<String>();\n        localNames.add(\"PaymentInfo\");\n        localNames.add(\"ShippingAddress\");\n        XMLSignature sig = signUsingDOM(\n            \"http://www.w3.org/2000/09/xmldsig#rsa-sha1\", document, localNames, key\n        );\n        \n        \n        sig.addKeyInfo(cert);\n        \n        \n        \n        \n        javax.xml.transform.Transformer transformer = transformerFactory.newTransformer();\n        ByteArrayOutputStream baos = new ByteArrayOutputStream();\n        transformer.transform(new DOMSource(document), new StreamResult(baos));\n        final XMLStreamReader xmlStreamReader = \n                xmlInputFactory.createXMLStreamReader(new ByteArrayInputStream(baos.toByteArray()));\n  \n        \n        XMLSecurityProperties properties = new XMLSecurityProperties();\n        InboundXMLSec inboundXMLSec = XMLSec.getInboundWSSec(properties);\n        TestSecurityEventListener securityEventListener = new TestSecurityEventListener();\n        XMLStreamReader securityStreamReader = \n            inboundXMLSec.processInMessage(xmlStreamReader, null, securityEventListener);\n\n        document = StAX2DOM.readDoc(XMLUtils.createDocumentBuilder(false), securityStreamReader);\n        \n        \n        checkSecurityEvents(securityEventListener);\n        checkSignedElementMultipleSecurityEvents(securityEventListener);\n        checkSignatureToken(securityEventListener, cert, null,\n                            SecurityTokenConstants.KeyIdentifier_X509KeyIdentifier);\n\n        List<SignedElementSecurityEvent> signedElementSecurityEventList = securityEventListener.getSecurityEvents(SecurityEventConstants.SignedElement);\n        Assert.assertEquals(2, signedElementSecurityEventList.size());\n        X509TokenSecurityEvent x509TokenSecurityEvent = securityEventListener.getSecurityEvent(SecurityEventConstants.X509Token);\n        String signedElementCorrelationID1 = signedElementSecurityEventList.get(0).getCorrelationID();\n        String signedElementCorrelationID2 = signedElementSecurityEventList.get(1).getCorrelationID();\n        String x509TokenCorrelationID = x509TokenSecurityEvent.getCorrelationID();\n\n        List<SecurityEvent> signatureSecurityEvents = new ArrayList<SecurityEvent>();\n        List<SecurityEvent> signedElementSecurityEvents1 = new ArrayList<SecurityEvent>();\n        List<SecurityEvent> signedElementSecurityEvents2 = new ArrayList<SecurityEvent>();\n\n        List<SecurityEvent> securityEvents = securityEventListener.getSecurityEvents();\n        for (int i = 0; i < securityEvents.size(); i++) {\n            SecurityEvent securityEvent = securityEvents.get(i);\n            if (securityEvent.getCorrelationID().equals(signedElementCorrelationID1)) {\n                signedElementSecurityEvents1.add(securityEvent);\n            } else if (securityEvent.getCorrelationID().equals(signedElementCorrelationID2)) {\n                signedElementSecurityEvents2.add(securityEvent);\n            } else if (securityEvent.getCorrelationID().equals(x509TokenCorrelationID)) {\n                signatureSecurityEvents.add(securityEvent);\n            }\n        }\n\n        Assert.assertEquals(4, signatureSecurityEvents.size());\n        Assert.assertEquals(3, signedElementSecurityEvents1.size());\n        Assert.assertEquals(3, signedElementSecurityEvents2.size());\n        Assert.assertEquals(securityEventListener.getSecurityEvents().size(),\n                signatureSecurityEvents.size() + signedElementSecurityEvents1.size() + signedElementSecurityEvents2.size());\n    }"
  },
  {
    "id": 20,
    "sub_id": 3,
    "code_id": 0,
    "function_id": 3,
    "human_patch": "https://github.com/apache/santuario-java/commit/e50488044121cf01ffbc235ca53b9562031d69c5",
    "cve_id": "CVE-2014-8152",
    "cwe_id": "CWE-254",
    "filename": "src/test/java/org/apache/xml/security/test/stax/signature/SignatureVerificationTest.java",
    "is_vulnerable": 0,
    "class_name": "SignatureVerificationTest",
    "subclass_name": null,
    "function_name": "testHMACSignatureVerification() throws Exception",
    "function_body": "{\n        \n        InputStream sourceDocument = \n                this.getClass().getClassLoader().getResourceAsStream(\n                        \"ie/baltimore/merlin-examples/merlin-xmlenc-five/plaintext.xml\");\n        DocumentBuilder builder = XMLUtils.createDocumentBuilder(false);\n        Document document = builder.parse(sourceDocument);\n        \n        \n        byte[] hmacKey = \"secret\".getBytes(\"ASCII\");\n        SecretKey key = new SecretKeySpec(hmacKey, \"http://www.w3.org/2000/09/xmldsig#hmac-sha1\");\n        \n        \n        List<String> localNames = new ArrayList<String>();\n        localNames.add(\"PaymentInfo\");\n        XMLSignature sig = signUsingDOM(\n            \"http://www.w3.org/2000/09/xmldsig#hmac-sha1\", document, localNames, key\n        );\n        \n        \n        KeyInfo keyInfo = sig.getKeyInfo();\n        KeyName keyName = new KeyName(document, \"SecretKey\");\n        keyInfo.add(keyName);\n        \n        \n        \n        \n        javax.xml.transform.Transformer transformer = transformerFactory.newTransformer();\n        ByteArrayOutputStream baos = new ByteArrayOutputStream();\n        transformer.transform(new DOMSource(document), new StreamResult(baos));\n        final XMLStreamReader xmlStreamReader = \n                xmlInputFactory.createXMLStreamReader(new ByteArrayInputStream(baos.toByteArray()));\n  \n        \n        XMLSecurityProperties properties = new XMLSecurityProperties();\n        properties.setSignatureVerificationKey(key);\n        InboundXMLSec inboundXMLSec = XMLSec.getInboundWSSec(properties);\n        TestSecurityEventListener securityEventListener = new TestSecurityEventListener();\n        XMLStreamReader securityStreamReader = \n            inboundXMLSec.processInMessage(xmlStreamReader, null, securityEventListener);\n\n        document = StAX2DOM.readDoc(XMLUtils.createDocumentBuilder(false), securityStreamReader);\n        \n        \n        checkSecurityEvents(securityEventListener,\n                            \"http://www.w3.org/2001/10/xml-exc-c14n#\",\n                            \"http://www.w3.org/2000/09/xmldsig#sha1\",\n                            \"http://www.w3.org/2000/09/xmldsig#hmac-sha1\");\n        checkSignedElementSecurityEvents(securityEventListener);\n        checkSignatureToken(securityEventListener, null, key,\n                            SecurityTokenConstants.KeyIdentifier_KeyName);\n\n        SignedElementSecurityEvent signedElementSecurityEvent = securityEventListener.getSecurityEvent(SecurityEventConstants.SignedElement);\n        KeyNameTokenSecurityEvent keyNameSecurityToken = securityEventListener.getSecurityEvent(SecurityEventConstants.KeyNameToken);\n        String signedElementCorrelationID = signedElementSecurityEvent.getCorrelationID();\n        String x509TokenCorrelationID = keyNameSecurityToken.getCorrelationID();\n\n        List<SecurityEvent> signatureSecurityEvents = new ArrayList<SecurityEvent>();\n        List<SecurityEvent> signedElementSecurityEvents = new ArrayList<SecurityEvent>();\n\n        List<SecurityEvent> securityEvents = securityEventListener.getSecurityEvents();\n        for (int i = 0; i < securityEvents.size(); i++) {\n            SecurityEvent securityEvent = securityEvents.get(i);\n            if (securityEvent.getCorrelationID().equals(signedElementCorrelationID)) {\n                signedElementSecurityEvents.add(securityEvent);\n            } else if (securityEvent.getCorrelationID().equals(x509TokenCorrelationID)) {\n                signatureSecurityEvents.add(securityEvent);\n            }\n        }\n\n        Assert.assertEquals(4, signatureSecurityEvents.size());\n        Assert.assertEquals(3, signedElementSecurityEvents.size());\n        Assert.assertEquals(securityEventListener.getSecurityEvents().size(),\n                signatureSecurityEvents.size() + signedElementSecurityEvents.size());\n    }"
  },
  {
    "id": 20,
    "sub_id": 3,
    "code_id": 0,
    "function_id": 4,
    "human_patch": "https://github.com/apache/santuario-java/commit/e50488044121cf01ffbc235ca53b9562031d69c5",
    "cve_id": "CVE-2014-8152",
    "cwe_id": "CWE-254",
    "filename": "src/test/java/org/apache/xml/security/test/stax/signature/SignatureVerificationTest.java",
    "is_vulnerable": 0,
    "class_name": "SignatureVerificationTest",
    "subclass_name": null,
    "function_name": "testHMACSignatureVerificationWrongKey() throws Exception",
    "function_body": "{\n        \n        InputStream sourceDocument = \n                this.getClass().getClassLoader().getResourceAsStream(\n                        \"ie/baltimore/merlin-examples/merlin-xmlenc-five/plaintext.xml\");\n        DocumentBuilder builder = XMLUtils.createDocumentBuilder(false);\n        Document document = builder.parse(sourceDocument);\n        \n        \n        byte[] hmacKey = \"secret\".getBytes(\"ASCII\");\n        SecretKey key = new SecretKeySpec(hmacKey, \"http://www.w3.org/2000/09/xmldsig#hmac-sha1\");\n        \n        \n        List<String> localNames = new ArrayList<String>();\n        localNames.add(\"PaymentInfo\");\n        XMLSignature sig = signUsingDOM(\n            \"http://www.w3.org/2000/09/xmldsig#hmac-sha1\", document, localNames, key\n        );\n        \n        \n        KeyInfo keyInfo = sig.getKeyInfo();\n        KeyName keyName = new KeyName(document, \"SecretKey\");\n        keyInfo.add(keyName);\n        \n        \n        \n        \n        javax.xml.transform.Transformer transformer = transformerFactory.newTransformer();\n        ByteArrayOutputStream baos = new ByteArrayOutputStream();\n        transformer.transform(new DOMSource(document), new StreamResult(baos));\n        final XMLStreamReader xmlStreamReader = \n                xmlInputFactory.createXMLStreamReader(new ByteArrayInputStream(baos.toByteArray()));\n  \n        \n        XMLSecurityProperties properties = new XMLSecurityProperties();\n        \n        byte[] badKey = \"secret2\".getBytes(\"ASCII\");\n        key = new SecretKeySpec(badKey, \"http://www.w3.org/2000/09/xmldsig#hmac-sha1\");\n        properties.setSignatureVerificationKey(key);\n        InboundXMLSec inboundXMLSec = XMLSec.getInboundWSSec(properties);\n        XMLStreamReader securityStreamReader = inboundXMLSec.processInMessage(xmlStreamReader);\n\n        try {\n            StAX2DOM.readDoc(XMLUtils.createDocumentBuilder(false), securityStreamReader);\n            fail(\"Failure expected on a bad key\");\n        } catch (XMLStreamException ex) {\n            Assert.assertTrue(ex.getCause() instanceof XMLSecurityException);\n            Assert.assertEquals(\"INVALID signature -- core validation failed.\", ex.getCause().getMessage());\n        }\n    }"
  },
  {
    "id": 20,
    "sub_id": 3,
    "code_id": 0,
    "function_id": 5,
    "human_patch": "https://github.com/apache/santuario-java/commit/e50488044121cf01ffbc235ca53b9562031d69c5",
    "cve_id": "CVE-2014-8152",
    "cwe_id": "CWE-254",
    "filename": "src/test/java/org/apache/xml/security/test/stax/signature/SignatureVerificationTest.java",
    "is_vulnerable": 0,
    "class_name": "SignatureVerificationTest",
    "subclass_name": null,
    "function_name": "testECDSASignatureVerification() throws Exception",
    "function_body": "{\n        \n        if (Security.getProvider(\"BC\") == null) {\n            return;\n        }\n        \n        \n        InputStream sourceDocument = \n                this.getClass().getClassLoader().getResourceAsStream(\n                        \"ie/baltimore/merlin-examples/merlin-xmlenc-five/plaintext.xml\");\n        DocumentBuilder builder = XMLUtils.createDocumentBuilder(false);\n        Document document = builder.parse(sourceDocument);\n        \n        \n        KeyStore keyStore = KeyStore.getInstance(\"jks\");\n        keyStore.load(\n            this.getClass().getClassLoader().getResource(\n                \"org/apache/xml/security/samples/input/ecdsa.jks\").openStream(), \n                \"security\".toCharArray()\n        );\n        Key key = keyStore.getKey(\"ECDSA\", \"security\".toCharArray());\n        X509Certificate cert = (X509Certificate)keyStore.getCertificate(\"ECDSA\");\n        \n        \n        List<String> localNames = new ArrayList<String>();\n        localNames.add(\"PaymentInfo\");\n        XMLSignature sig = signUsingDOM(\n            \"http://www.w3.org/2001/04/xmldsig-more#ecdsa-sha1\", document, localNames, key\n        );\n        \n        \n        sig.addKeyInfo(cert);\n        \n        \n        \n        \n        javax.xml.transform.Transformer transformer = transformerFactory.newTransformer();\n        ByteArrayOutputStream baos = new ByteArrayOutputStream();\n        transformer.transform(new DOMSource(document), new StreamResult(baos));\n        final XMLStreamReader xmlStreamReader = \n                xmlInputFactory.createXMLStreamReader(new ByteArrayInputStream(baos.toByteArray()));\n  \n        \n        XMLSecurityProperties properties = new XMLSecurityProperties();\n        InboundXMLSec inboundXMLSec = XMLSec.getInboundWSSec(properties);\n        TestSecurityEventListener securityEventListener = new TestSecurityEventListener();\n        XMLStreamReader securityStreamReader = \n            inboundXMLSec.processInMessage(xmlStreamReader, null, securityEventListener);\n\n        document = StAX2DOM.readDoc(XMLUtils.createDocumentBuilder(false), securityStreamReader);\n        \n        \n        checkSecurityEvents(securityEventListener, \n                \"http://www.w3.org/2001/10/xml-exc-c14n#\",\n                \"http://www.w3.org/2000/09/xmldsig#sha1\",\n                \"http://www.w3.org/2001/04/xmldsig-more#ecdsa-sha1\");\n        checkSignedElementSecurityEvents(securityEventListener);\n        checkSignatureToken(securityEventListener, cert, null,\n                            SecurityTokenConstants.KeyIdentifier_X509KeyIdentifier);\n\n        SignedElementSecurityEvent signedElementSecurityEvent = securityEventListener.getSecurityEvent(SecurityEventConstants.SignedElement);\n        X509TokenSecurityEvent x509TokenSecurityEvent = securityEventListener.getSecurityEvent(SecurityEventConstants.X509Token);\n        String signedElementCorrelationID = signedElementSecurityEvent.getCorrelationID();\n        String x509TokenCorrelationID = x509TokenSecurityEvent.getCorrelationID();\n\n        List<SecurityEvent> signatureSecurityEvents = new ArrayList<SecurityEvent>();\n        List<SecurityEvent> signedElementSecurityEvents = new ArrayList<SecurityEvent>();\n\n        List<SecurityEvent> securityEvents = securityEventListener.getSecurityEvents();\n        for (int i = 0; i < securityEvents.size(); i++) {\n            SecurityEvent securityEvent = securityEvents.get(i);\n            if (securityEvent.getCorrelationID().equals(signedElementCorrelationID)) {\n                signedElementSecurityEvents.add(securityEvent);\n            } else if (securityEvent.getCorrelationID().equals(x509TokenCorrelationID)) {\n                signatureSecurityEvents.add(securityEvent);\n            }\n        }\n\n        Assert.assertEquals(4, signatureSecurityEvents.size());\n        Assert.assertEquals(3, signedElementSecurityEvents.size());\n        Assert.assertEquals(securityEventListener.getSecurityEvents().size(),\n                signatureSecurityEvents.size() + signedElementSecurityEvents.size());\n    }"
  },
  {
    "id": 20,
    "sub_id": 3,
    "code_id": 0,
    "function_id": 6,
    "human_patch": "https://github.com/apache/santuario-java/commit/e50488044121cf01ffbc235ca53b9562031d69c5",
    "cve_id": "CVE-2014-8152",
    "cwe_id": "CWE-254",
    "filename": "src/test/java/org/apache/xml/security/test/stax/signature/SignatureVerificationTest.java",
    "is_vulnerable": 0,
    "class_name": "SignatureVerificationTest",
    "subclass_name": null,
    "function_name": "testDifferentC14nMethod() throws Exception",
    "function_body": "{\n        \n        InputStream sourceDocument = \n                this.getClass().getClassLoader().getResourceAsStream(\n                        \"ie/baltimore/merlin-examples/merlin-xmlenc-five/plaintext.xml\");\n        DocumentBuilder builder = XMLUtils.createDocumentBuilder(false);\n        Document document = builder.parse(sourceDocument);\n        \n        \n        KeyStore keyStore = KeyStore.getInstance(\"jks\");\n        keyStore.load(\n            this.getClass().getClassLoader().getResource(\"transmitter.jks\").openStream(), \n            \"default\".toCharArray()\n        );\n        Key key = keyStore.getKey(\"transmitter\", \"default\".toCharArray());\n        X509Certificate cert = (X509Certificate)keyStore.getCertificate(\"transmitter\");\n        \n        \n        List<String> localNames = new ArrayList<String>();\n        localNames.add(\"PaymentInfo\");\n        XMLSignature sig = signUsingDOM(\n            \"http://www.w3.org/2000/09/xmldsig#rsa-sha1\", document, localNames, key,\n            \"http://www.w3.org/TR/2001/REC-xml-c14n-20010315\"\n        );\n        \n        \n        sig.addKeyInfo(cert);\n        \n        \n        \n        \n        javax.xml.transform.Transformer transformer = transformerFactory.newTransformer();\n        ByteArrayOutputStream baos = new ByteArrayOutputStream();\n        transformer.transform(new DOMSource(document), new StreamResult(baos));\n        final XMLStreamReader xmlStreamReader = \n                xmlInputFactory.createXMLStreamReader(new ByteArrayInputStream(baos.toByteArray()));\n  \n        \n        XMLSecurityProperties properties = new XMLSecurityProperties();\n        InboundXMLSec inboundXMLSec = XMLSec.getInboundWSSec(properties);\n        TestSecurityEventListener securityEventListener = new TestSecurityEventListener();\n        XMLStreamReader securityStreamReader = \n            inboundXMLSec.processInMessage(xmlStreamReader, null, securityEventListener);\n\n        document = StAX2DOM.readDoc(XMLUtils.createDocumentBuilder(false), securityStreamReader);\n        \n        \n        checkSecurityEvents(securityEventListener, \n                            \"http://www.w3.org/TR/2001/REC-xml-c14n-20010315\",\n                            \"http://www.w3.org/2000/09/xmldsig#sha1\",\n                            \"http://www.w3.org/2000/09/xmldsig#rsa-sha1\");\n        checkSignedElementSecurityEvents(securityEventListener);\n        checkSignatureToken(securityEventListener, cert, null,\n                            SecurityTokenConstants.KeyIdentifier_X509KeyIdentifier);\n\n        SignedElementSecurityEvent signedElementSecurityEvent = securityEventListener.getSecurityEvent(SecurityEventConstants.SignedElement);\n        X509TokenSecurityEvent x509TokenSecurityEvent = securityEventListener.getSecurityEvent(SecurityEventConstants.X509Token);\n        String signedElementCorrelationID = signedElementSecurityEvent.getCorrelationID();\n        String x509TokenCorrelationID = x509TokenSecurityEvent.getCorrelationID();\n\n        List<SecurityEvent> signatureSecurityEvents = new ArrayList<SecurityEvent>();\n        List<SecurityEvent> signedElementSecurityEvents = new ArrayList<SecurityEvent>();\n\n        List<SecurityEvent> securityEvents = securityEventListener.getSecurityEvents();\n        for (int i = 0; i < securityEvents.size(); i++) {\n            SecurityEvent securityEvent = securityEvents.get(i);\n            if (securityEvent.getCorrelationID().equals(signedElementCorrelationID)) {\n                signedElementSecurityEvents.add(securityEvent);\n            } else if (securityEvent.getCorrelationID().equals(x509TokenCorrelationID)) {\n                signatureSecurityEvents.add(securityEvent);\n            }\n        }\n\n        Assert.assertEquals(4, signatureSecurityEvents.size());\n        Assert.assertEquals(3, signedElementSecurityEvents.size());\n        Assert.assertEquals(securityEventListener.getSecurityEvents().size(),\n                signatureSecurityEvents.size() + signedElementSecurityEvents.size());\n    }"
  },
  {
    "id": 20,
    "sub_id": 3,
    "code_id": 0,
    "function_id": 7,
    "human_patch": "https://github.com/apache/santuario-java/commit/e50488044121cf01ffbc235ca53b9562031d69c5",
    "cve_id": "CVE-2014-8152",
    "cwe_id": "CWE-254",
    "filename": "src/test/java/org/apache/xml/security/test/stax/signature/SignatureVerificationTest.java",
    "is_vulnerable": 0,
    "class_name": "SignatureVerificationTest",
    "subclass_name": null,
    "function_name": "testC14n11Method() throws Exception",
    "function_body": "{\n        \n        InputStream sourceDocument = \n                this.getClass().getClassLoader().getResourceAsStream(\n                        \"ie/baltimore/merlin-examples/merlin-xmlenc-five/plaintext.xml\");\n        DocumentBuilder builder = XMLUtils.createDocumentBuilder(false);\n        Document document = builder.parse(sourceDocument);\n        \n        \n        KeyStore keyStore = KeyStore.getInstance(\"jks\");\n        keyStore.load(\n            this.getClass().getClassLoader().getResource(\"transmitter.jks\").openStream(), \n            \"default\".toCharArray()\n        );\n        Key key = keyStore.getKey(\"transmitter\", \"default\".toCharArray());\n        X509Certificate cert = (X509Certificate)keyStore.getCertificate(\"transmitter\");\n        \n        \n        List<String> localNames = new ArrayList<String>();\n        localNames.add(\"PaymentInfo\");\n        XMLSignature sig = signUsingDOM(\n            \"http://www.w3.org/2000/09/xmldsig#rsa-sha1\", document, localNames, key,\n            \"http://www.w3.org/2006/12/xml-c14n11\"\n        );\n        \n        \n        sig.addKeyInfo(cert);\n        \n        \n        \n        \n        javax.xml.transform.Transformer transformer = transformerFactory.newTransformer();\n        ByteArrayOutputStream baos = new ByteArrayOutputStream();\n        transformer.transform(new DOMSource(document), new StreamResult(baos));\n        final XMLStreamReader xmlStreamReader = \n                xmlInputFactory.createXMLStreamReader(new ByteArrayInputStream(baos.toByteArray()));\n  \n        \n        XMLSecurityProperties properties = new XMLSecurityProperties();\n        InboundXMLSec inboundXMLSec = XMLSec.getInboundWSSec(properties);\n        TestSecurityEventListener securityEventListener = new TestSecurityEventListener();\n        XMLStreamReader securityStreamReader = \n            inboundXMLSec.processInMessage(xmlStreamReader, null, securityEventListener);\n\n        document = StAX2DOM.readDoc(XMLUtils.createDocumentBuilder(false), securityStreamReader);\n        \n        \n        checkSecurityEvents(securityEventListener, \n                            \"http://www.w3.org/2006/12/xml-c14n11\",\n                            \"http://www.w3.org/2000/09/xmldsig#sha1\",\n                            \"http://www.w3.org/2000/09/xmldsig#rsa-sha1\");\n        checkSignedElementSecurityEvents(securityEventListener);\n        checkSignatureToken(securityEventListener, cert, null,\n                            SecurityTokenConstants.KeyIdentifier_X509KeyIdentifier);\n\n        SignedElementSecurityEvent signedElementSecurityEvent = securityEventListener.getSecurityEvent(SecurityEventConstants.SignedElement);\n        X509TokenSecurityEvent x509TokenSecurityEvent = securityEventListener.getSecurityEvent(SecurityEventConstants.X509Token);\n        String signedElementCorrelationID = signedElementSecurityEvent.getCorrelationID();\n        String x509TokenCorrelationID = x509TokenSecurityEvent.getCorrelationID();\n\n        List<SecurityEvent> signatureSecurityEvents = new ArrayList<SecurityEvent>();\n        List<SecurityEvent> signedElementSecurityEvents = new ArrayList<SecurityEvent>();\n\n        List<SecurityEvent> securityEvents = securityEventListener.getSecurityEvents();\n        for (int i = 0; i < securityEvents.size(); i++) {\n            SecurityEvent securityEvent = securityEvents.get(i);\n            if (securityEvent.getCorrelationID().equals(signedElementCorrelationID)) {\n                signedElementSecurityEvents.add(securityEvent);\n            } else if (securityEvent.getCorrelationID().equals(x509TokenCorrelationID)) {\n                signatureSecurityEvents.add(securityEvent);\n            }\n        }\n\n        Assert.assertEquals(4, signatureSecurityEvents.size());\n        Assert.assertEquals(3, signedElementSecurityEvents.size());\n        Assert.assertEquals(securityEventListener.getSecurityEvents().size(),\n                signatureSecurityEvents.size() + signedElementSecurityEvents.size());\n    }"
  },
  {
    "id": 20,
    "sub_id": 3,
    "code_id": 0,
    "function_id": 8,
    "human_patch": "https://github.com/apache/santuario-java/commit/e50488044121cf01ffbc235ca53b9562031d69c5",
    "cve_id": "CVE-2014-8152",
    "cwe_id": "CWE-254",
    "filename": "src/test/java/org/apache/xml/security/test/stax/signature/SignatureVerificationTest.java",
    "is_vulnerable": 0,
    "class_name": "SignatureVerificationTest",
    "subclass_name": null,
    "function_name": "testStrongSignatureVerification() throws Exception",
    "function_body": "{\n        \n        InputStream sourceDocument = \n                this.getClass().getClassLoader().getResourceAsStream(\n                        \"ie/baltimore/merlin-examples/merlin-xmlenc-five/plaintext.xml\");\n        DocumentBuilder builder = XMLUtils.createDocumentBuilder(false);\n        Document document = builder.parse(sourceDocument);\n        \n        \n        KeyStore keyStore = KeyStore.getInstance(\"jks\");\n        keyStore.load(\n            this.getClass().getClassLoader().getResource(\"transmitter.jks\").openStream(), \n            \"default\".toCharArray()\n        );\n        Key key = keyStore.getKey(\"transmitter\", \"default\".toCharArray());\n        X509Certificate cert = (X509Certificate)keyStore.getCertificate(\"transmitter\");\n        \n        \n        List<String> localNames = new ArrayList<String>();\n        localNames.add(\"PaymentInfo\");\n        XMLSignature sig = signUsingDOM(\n            \"http://www.w3.org/2001/04/xmldsig-more#rsa-sha256\", document, localNames, key,\n            \"http://www.w3.org/2001/10/xml-exc-c14n#\", \"http://www.w3.org/2001/04/xmlenc#sha256\"\n        );\n        \n        \n        sig.addKeyInfo(cert);\n        \n        \n        \n        \n        javax.xml.transform.Transformer transformer = transformerFactory.newTransformer();\n        ByteArrayOutputStream baos = new ByteArrayOutputStream();\n        transformer.transform(new DOMSource(document), new StreamResult(baos));\n        final XMLStreamReader xmlStreamReader = \n                xmlInputFactory.createXMLStreamReader(new ByteArrayInputStream(baos.toByteArray()));\n  \n        \n        XMLSecurityProperties properties = new XMLSecurityProperties();\n        InboundXMLSec inboundXMLSec = XMLSec.getInboundWSSec(properties);\n        TestSecurityEventListener securityEventListener = new TestSecurityEventListener();\n        XMLStreamReader securityStreamReader = \n            inboundXMLSec.processInMessage(xmlStreamReader, null, securityEventListener);\n\n        document = StAX2DOM.readDoc(XMLUtils.createDocumentBuilder(false), securityStreamReader);\n        \n        \n        checkSecurityEvents(securityEventListener, \n                            \"http://www.w3.org/2001/10/xml-exc-c14n#\",\n                            \"http://www.w3.org/2001/04/xmlenc#sha256\",\n                            \"http://www.w3.org/2001/04/xmldsig-more#rsa-sha256\");\n        checkSignedElementSecurityEvents(securityEventListener);\n        checkSignatureToken(securityEventListener, cert, null,\n                            SecurityTokenConstants.KeyIdentifier_X509KeyIdentifier);\n\n        SignedElementSecurityEvent signedElementSecurityEvent = securityEventListener.getSecurityEvent(SecurityEventConstants.SignedElement);\n        X509TokenSecurityEvent x509TokenSecurityEvent = securityEventListener.getSecurityEvent(SecurityEventConstants.X509Token);\n        String signedElementCorrelationID = signedElementSecurityEvent.getCorrelationID();\n        String x509TokenCorrelationID = x509TokenSecurityEvent.getCorrelationID();\n\n        List<SecurityEvent> signatureSecurityEvents = new ArrayList<SecurityEvent>();\n        List<SecurityEvent> signedElementSecurityEvents = new ArrayList<SecurityEvent>();\n\n        List<SecurityEvent> securityEvents = securityEventListener.getSecurityEvents();\n        for (int i = 0; i < securityEvents.size(); i++) {\n            SecurityEvent securityEvent = securityEvents.get(i);\n            if (securityEvent.getCorrelationID().equals(signedElementCorrelationID)) {\n                signedElementSecurityEvents.add(securityEvent);\n            } else if (securityEvent.getCorrelationID().equals(x509TokenCorrelationID)) {\n                signatureSecurityEvents.add(securityEvent);\n            }\n        }\n\n        Assert.assertEquals(4, signatureSecurityEvents.size());\n        Assert.assertEquals(3, signedElementSecurityEvents.size());\n        Assert.assertEquals(securityEventListener.getSecurityEvents().size(),\n                signatureSecurityEvents.size() + signedElementSecurityEvents.size());\n    }"
  },
  {
    "id": 20,
    "sub_id": 3,
    "code_id": 0,
    "function_id": 9,
    "human_patch": "https://github.com/apache/santuario-java/commit/e50488044121cf01ffbc235ca53b9562031d69c5",
    "cve_id": "CVE-2014-8152",
    "cwe_id": "CWE-254",
    "filename": "src/test/java/org/apache/xml/security/test/stax/signature/SignatureVerificationTest.java",
    "is_vulnerable": 0,
    "class_name": "SignatureVerificationTest",
    "subclass_name": null,
    "function_name": "testIssuerSerial() throws Exception",
    "function_body": "{\n        \n        InputStream sourceDocument = \n                this.getClass().getClassLoader().getResourceAsStream(\n                        \"ie/baltimore/merlin-examples/merlin-xmlenc-five/plaintext.xml\");\n        DocumentBuilder builder = XMLUtils.createDocumentBuilder(false);\n        Document document = builder.parse(sourceDocument);\n        \n        \n        KeyStore keyStore = KeyStore.getInstance(\"jks\");\n        keyStore.load(\n            this.getClass().getClassLoader().getResource(\"transmitter.jks\").openStream(), \n            \"default\".toCharArray()\n        );\n        Key key = keyStore.getKey(\"transmitter\", \"default\".toCharArray());\n        X509Certificate cert = (X509Certificate)keyStore.getCertificate(\"transmitter\");\n        \n        \n        List<String> localNames = new ArrayList<String>();\n        localNames.add(\"PaymentInfo\");\n        XMLSignature sig = signUsingDOM(\n            \"http://www.w3.org/2000/09/xmldsig#rsa-sha1\", document, localNames, key\n        );\n        \n        \n        KeyInfo keyInfo = sig.getKeyInfo();\n        XMLX509IssuerSerial issuerSerial = \n            new XMLX509IssuerSerial(sig.getDocument(), cert);\n        X509Data x509Data = new X509Data(sig.getDocument());\n        x509Data.add(issuerSerial);\n        keyInfo.add(x509Data);\n        \n        \n        \n        \n        javax.xml.transform.Transformer transformer = transformerFactory.newTransformer();\n        ByteArrayOutputStream baos = new ByteArrayOutputStream();\n        transformer.transform(new DOMSource(document), new StreamResult(baos));\n        final XMLStreamReader xmlStreamReader = \n                xmlInputFactory.createXMLStreamReader(new ByteArrayInputStream(baos.toByteArray()));\n  \n        \n        XMLSecurityProperties properties = new XMLSecurityProperties();\n        properties.setSignatureVerificationKey(cert.getPublicKey());\n        InboundXMLSec inboundXMLSec = XMLSec.getInboundWSSec(properties);\n        TestSecurityEventListener securityEventListener = new TestSecurityEventListener();\n        XMLStreamReader securityStreamReader = \n                inboundXMLSec.processInMessage(xmlStreamReader, null, securityEventListener);\n\n        document = StAX2DOM.readDoc(XMLUtils.createDocumentBuilder(false), securityStreamReader);\n        \n        \n        checkSecurityEvents(securityEventListener);\n        checkSignedElementSecurityEvents(securityEventListener);\n        checkSignatureToken(securityEventListener, cert, null,\n                            SecurityTokenConstants.KeyIdentifier_IssuerSerial);\n\n        SignedElementSecurityEvent signedElementSecurityEvent = securityEventListener.getSecurityEvent(SecurityEventConstants.SignedElement);\n        X509TokenSecurityEvent x509TokenSecurityEvent = securityEventListener.getSecurityEvent(SecurityEventConstants.X509Token);\n        String signedElementCorrelationID = signedElementSecurityEvent.getCorrelationID();\n        String x509TokenCorrelationID = x509TokenSecurityEvent.getCorrelationID();\n\n        List<SecurityEvent> signatureSecurityEvents = new ArrayList<SecurityEvent>();\n        List<SecurityEvent> signedElementSecurityEvents = new ArrayList<SecurityEvent>();\n\n        List<SecurityEvent> securityEvents = securityEventListener.getSecurityEvents();\n        for (int i = 0; i < securityEvents.size(); i++) {\n            SecurityEvent securityEvent = securityEvents.get(i);\n            if (securityEvent.getCorrelationID().equals(signedElementCorrelationID)) {\n                signedElementSecurityEvents.add(securityEvent);\n            } else if (securityEvent.getCorrelationID().equals(x509TokenCorrelationID)) {\n                signatureSecurityEvents.add(securityEvent);\n            }\n        }\n\n        Assert.assertEquals(4, signatureSecurityEvents.size());\n        Assert.assertEquals(3, signedElementSecurityEvents.size());\n        Assert.assertEquals(securityEventListener.getSecurityEvents().size(),\n                signatureSecurityEvents.size() + signedElementSecurityEvents.size());\n    }"
  },
  {
    "id": 20,
    "sub_id": 3,
    "code_id": 0,
    "function_id": 10,
    "human_patch": "https://github.com/apache/santuario-java/commit/e50488044121cf01ffbc235ca53b9562031d69c5",
    "cve_id": "CVE-2014-8152",
    "cwe_id": "CWE-254",
    "filename": "src/test/java/org/apache/xml/security/test/stax/signature/SignatureVerificationTest.java",
    "is_vulnerable": 0,
    "class_name": "SignatureVerificationTest",
    "subclass_name": null,
    "function_name": "testSubjectName() throws Exception",
    "function_body": "{\n        \n        InputStream sourceDocument = \n                this.getClass().getClassLoader().getResourceAsStream(\n                        \"ie/baltimore/merlin-examples/merlin-xmlenc-five/plaintext.xml\");\n        DocumentBuilder builder = XMLUtils.createDocumentBuilder(false);\n        Document document = builder.parse(sourceDocument);\n        \n        \n        KeyStore keyStore = KeyStore.getInstance(\"jks\");\n        keyStore.load(\n            this.getClass().getClassLoader().getResource(\"transmitter.jks\").openStream(), \n            \"default\".toCharArray()\n        );\n        Key key = keyStore.getKey(\"transmitter\", \"default\".toCharArray());\n        X509Certificate cert = (X509Certificate)keyStore.getCertificate(\"transmitter\");\n        \n        \n        List<String> localNames = new ArrayList<String>();\n        localNames.add(\"PaymentInfo\");\n        XMLSignature sig = signUsingDOM(\n            \"http://www.w3.org/2000/09/xmldsig#rsa-sha1\", document, localNames, key\n        );\n        \n        \n        KeyInfo keyInfo = sig.getKeyInfo();\n        X509Data x509Data = new X509Data(sig.getDocument());\n        x509Data.addSubjectName(cert);\n        keyInfo.add(x509Data);\n        \n        \n        \n        \n        javax.xml.transform.Transformer transformer = transformerFactory.newTransformer();\n        ByteArrayOutputStream baos = new ByteArrayOutputStream();\n        transformer.transform(new DOMSource(document), new StreamResult(baos));\n        final XMLStreamReader xmlStreamReader = \n                xmlInputFactory.createXMLStreamReader(new ByteArrayInputStream(baos.toByteArray()));\n  \n        \n        XMLSecurityProperties properties = new XMLSecurityProperties();\n        properties.setSignatureVerificationKey(cert.getPublicKey());\n        InboundXMLSec inboundXMLSec = XMLSec.getInboundWSSec(properties);\n        TestSecurityEventListener securityEventListener = new TestSecurityEventListener();\n        XMLStreamReader securityStreamReader = \n                inboundXMLSec.processInMessage(xmlStreamReader, null, securityEventListener);\n\n        document = StAX2DOM.readDoc(XMLUtils.createDocumentBuilder(false), securityStreamReader);\n        \n        \n        checkSecurityEvents(securityEventListener);\n        checkSignedElementSecurityEvents(securityEventListener);\n        checkSignatureToken(securityEventListener, cert, null,\n                            SecurityTokenConstants.KeyIdentifier_X509SubjectName);\n\n        SignedElementSecurityEvent signedElementSecurityEvent = securityEventListener.getSecurityEvent(SecurityEventConstants.SignedElement);\n        X509TokenSecurityEvent x509TokenSecurityEvent = securityEventListener.getSecurityEvent(SecurityEventConstants.X509Token);\n        String signedElementCorrelationID = signedElementSecurityEvent.getCorrelationID();\n        String x509TokenCorrelationID = x509TokenSecurityEvent.getCorrelationID();\n\n        List<SecurityEvent> signatureSecurityEvents = new ArrayList<SecurityEvent>();\n        List<SecurityEvent> signedElementSecurityEvents = new ArrayList<SecurityEvent>();\n\n        List<SecurityEvent> securityEvents = securityEventListener.getSecurityEvents();\n        for (int i = 0; i < securityEvents.size(); i++) {\n            SecurityEvent securityEvent = securityEvents.get(i);\n            if (securityEvent.getCorrelationID().equals(signedElementCorrelationID)) {\n                signedElementSecurityEvents.add(securityEvent);\n            } else if (securityEvent.getCorrelationID().equals(x509TokenCorrelationID)) {\n                signatureSecurityEvents.add(securityEvent);\n            }\n        }\n\n        Assert.assertEquals(4, signatureSecurityEvents.size());\n        Assert.assertEquals(3, signedElementSecurityEvents.size());\n        Assert.assertEquals(securityEventListener.getSecurityEvents().size(),\n                signatureSecurityEvents.size() + signedElementSecurityEvents.size());\n    }"
  },
  {
    "id": 20,
    "sub_id": 3,
    "code_id": 0,
    "function_id": 11,
    "human_patch": "https://github.com/apache/santuario-java/commit/e50488044121cf01ffbc235ca53b9562031d69c5",
    "cve_id": "CVE-2014-8152",
    "cwe_id": "CWE-254",
    "filename": "src/test/java/org/apache/xml/security/test/stax/signature/SignatureVerificationTest.java",
    "is_vulnerable": 0,
    "class_name": "SignatureVerificationTest",
    "subclass_name": null,
    "function_name": "testSubjectSKI() throws Exception",
    "function_body": "{\n        \n        InputStream sourceDocument = \n                this.getClass().getClassLoader().getResourceAsStream(\n                        \"ie/baltimore/merlin-examples/merlin-xmlenc-five/plaintext.xml\");\n        DocumentBuilder builder = XMLUtils.createDocumentBuilder(false);\n        Document document = builder.parse(sourceDocument);\n        \n        \n        KeyStore keyStore = KeyStore.getInstance(\"JCEKS\");\n        keyStore.load(\n            this.getClass().getClassLoader().getResource(\"test.jceks\").openStream(), \n            \"secret\".toCharArray()\n        );\n        Key key = keyStore.getKey(\"rsakey\", \"secret\".toCharArray());\n        X509Certificate cert = (X509Certificate)keyStore.getCertificate(\"rsakey\");\n        \n        \n        List<String> localNames = new ArrayList<String>();\n        localNames.add(\"PaymentInfo\");\n        XMLSignature sig = signUsingDOM(\n            \"http://www.w3.org/2000/09/xmldsig#rsa-sha1\", document, localNames, key\n        );\n        \n        \n        KeyInfo keyInfo = sig.getKeyInfo();\n        X509Data x509Data = new X509Data(sig.getDocument());\n        x509Data.addSKI(cert);\n        keyInfo.add(x509Data);\n        \n        \n        \n        \n        javax.xml.transform.Transformer transformer = transformerFactory.newTransformer();\n        ByteArrayOutputStream baos = new ByteArrayOutputStream();\n        transformer.transform(new DOMSource(document), new StreamResult(baos));\n        final XMLStreamReader xmlStreamReader = \n                xmlInputFactory.createXMLStreamReader(new ByteArrayInputStream(baos.toByteArray()));\n  \n        \n        XMLSecurityProperties properties = new XMLSecurityProperties();\n        properties.setSignatureVerificationKey(cert.getPublicKey());\n        InboundXMLSec inboundXMLSec = XMLSec.getInboundWSSec(properties);\n        TestSecurityEventListener securityEventListener = new TestSecurityEventListener();\n        XMLStreamReader securityStreamReader = \n                inboundXMLSec.processInMessage(xmlStreamReader, null, securityEventListener);\n\n        document = StAX2DOM.readDoc(XMLUtils.createDocumentBuilder(false), securityStreamReader);\n        \n        \n        checkSecurityEvents(securityEventListener);\n        checkSignedElementSecurityEvents(securityEventListener);\n        checkSignatureToken(securityEventListener, cert, null,\n                            SecurityTokenConstants.KeyIdentifier_SkiKeyIdentifier);\n\n        SignedElementSecurityEvent signedElementSecurityEvent = securityEventListener.getSecurityEvent(SecurityEventConstants.SignedElement);\n        X509TokenSecurityEvent x509TokenSecurityEvent = securityEventListener.getSecurityEvent(SecurityEventConstants.X509Token);\n        String signedElementCorrelationID = signedElementSecurityEvent.getCorrelationID();\n        String x509TokenCorrelationID = x509TokenSecurityEvent.getCorrelationID();\n\n        List<SecurityEvent> signatureSecurityEvents = new ArrayList<SecurityEvent>();\n        List<SecurityEvent> signedElementSecurityEvents = new ArrayList<SecurityEvent>();\n\n        List<SecurityEvent> securityEvents = securityEventListener.getSecurityEvents();\n        for (int i = 0; i < securityEvents.size(); i++) {\n            SecurityEvent securityEvent = securityEvents.get(i);\n            if (securityEvent.getCorrelationID().equals(signedElementCorrelationID)) {\n                signedElementSecurityEvents.add(securityEvent);\n            } else if (securityEvent.getCorrelationID().equals(x509TokenCorrelationID)) {\n                signatureSecurityEvents.add(securityEvent);\n            }\n        }\n\n        Assert.assertEquals(4, signatureSecurityEvents.size());\n        Assert.assertEquals(3, signedElementSecurityEvents.size());\n        Assert.assertEquals(securityEventListener.getSecurityEvents().size(),\n                signatureSecurityEvents.size() + signedElementSecurityEvents.size());\n    }"
  },
  {
    "id": 20,
    "sub_id": 3,
    "code_id": 0,
    "function_id": 12,
    "human_patch": "https://github.com/apache/santuario-java/commit/e50488044121cf01ffbc235ca53b9562031d69c5",
    "cve_id": "CVE-2014-8152",
    "cwe_id": "CWE-254",
    "filename": "src/test/java/org/apache/xml/security/test/stax/signature/SignatureVerificationTest.java",
    "is_vulnerable": 0,
    "class_name": "SignatureVerificationTest",
    "subclass_name": null,
    "function_name": "testKeyValue() throws Exception",
    "function_body": "{\n        \n        InputStream sourceDocument = \n                this.getClass().getClassLoader().getResourceAsStream(\n                        \"ie/baltimore/merlin-examples/merlin-xmlenc-five/plaintext.xml\");\n        DocumentBuilder builder = XMLUtils.createDocumentBuilder(false);\n        Document document = builder.parse(sourceDocument);\n        \n        \n        KeyStore keyStore = KeyStore.getInstance(\"jks\");\n        keyStore.load(\n            this.getClass().getClassLoader().getResource(\"transmitter.jks\").openStream(), \n            \"default\".toCharArray()\n        );\n        Key key = keyStore.getKey(\"transmitter\", \"default\".toCharArray());\n        X509Certificate cert = (X509Certificate)keyStore.getCertificate(\"transmitter\");\n        \n        \n        List<String> localNames = new ArrayList<String>();\n        localNames.add(\"PaymentInfo\");\n        XMLSignature sig = signUsingDOM(\n            \"http://www.w3.org/2000/09/xmldsig#rsa-sha1\", document, localNames, key\n        );\n        \n        \n        sig.addKeyInfo(cert.getPublicKey());\n        \n        \n        \n        \n        javax.xml.transform.Transformer transformer = transformerFactory.newTransformer();\n        ByteArrayOutputStream baos = new ByteArrayOutputStream();\n        transformer.transform(new DOMSource(document), new StreamResult(baos));\n        final XMLStreamReader xmlStreamReader = \n                xmlInputFactory.createXMLStreamReader(new ByteArrayInputStream(baos.toByteArray()));\n  \n        \n        XMLSecurityProperties properties = new XMLSecurityProperties();\n        properties.setSignatureVerificationKey(cert.getPublicKey());\n        InboundXMLSec inboundXMLSec = XMLSec.getInboundWSSec(properties);\n        TestSecurityEventListener securityEventListener = new TestSecurityEventListener();\n        XMLStreamReader securityStreamReader = \n                inboundXMLSec.processInMessage(xmlStreamReader, null, securityEventListener);\n\n        document = StAX2DOM.readDoc(XMLUtils.createDocumentBuilder(false), securityStreamReader);\n        \n        \n        checkSecurityEvents(securityEventListener);\n        checkSignedElementSecurityEvents(securityEventListener);\n        checkSignatureToken(securityEventListener, null, cert.getPublicKey(),\n                            SecurityTokenConstants.KeyIdentifier_KeyValue);\n\n        SignedElementSecurityEvent signedElementSecurityEvent = securityEventListener.getSecurityEvent(SecurityEventConstants.SignedElement);\n        KeyValueTokenSecurityEvent keyValueTokenSecurityEvent = securityEventListener.getSecurityEvent(SecurityEventConstants.KeyValueToken);\n        String signedElementCorrelationID = signedElementSecurityEvent.getCorrelationID();\n        String x509TokenCorrelationID = keyValueTokenSecurityEvent.getCorrelationID();\n\n        List<SecurityEvent> signatureSecurityEvents = new ArrayList<SecurityEvent>();\n        List<SecurityEvent> signedElementSecurityEvents = new ArrayList<SecurityEvent>();\n\n        List<SecurityEvent> securityEvents = securityEventListener.getSecurityEvents();\n        for (int i = 0; i < securityEvents.size(); i++) {\n            SecurityEvent securityEvent = securityEvents.get(i);\n            if (securityEvent.getCorrelationID().equals(signedElementCorrelationID)) {\n                signedElementSecurityEvents.add(securityEvent);\n            } else if (securityEvent.getCorrelationID().equals(x509TokenCorrelationID)) {\n                signatureSecurityEvents.add(securityEvent);\n            }\n        }\n\n        Assert.assertEquals(4, signatureSecurityEvents.size());\n        Assert.assertEquals(3, signedElementSecurityEvents.size());\n        Assert.assertEquals(securityEventListener.getSecurityEvents().size(),\n                signatureSecurityEvents.size() + signedElementSecurityEvents.size());\n    }"
  },
  {
    "id": 20,
    "sub_id": 3,
    "code_id": 0,
    "function_id": 13,
    "human_patch": "https://github.com/apache/santuario-java/commit/e50488044121cf01ffbc235ca53b9562031d69c5",
    "cve_id": "CVE-2014-8152",
    "cwe_id": "CWE-254",
    "filename": "src/test/java/org/apache/xml/security/test/stax/signature/SignatureVerificationTest.java",
    "is_vulnerable": 0,
    "class_name": "SignatureVerificationTest",
    "subclass_name": null,
    "function_name": "testSignatureVerificationTransformBase64() throws Exception",
    "function_body": "{\n        \n        InputStream sourceDocument =\n                this.getClass().getClassLoader().getResourceAsStream(\n                        \"ie/baltimore/merlin-examples/merlin-xmlenc-five/plaintext-base64.xml\");\n        DocumentBuilder builder = XMLUtils.createDocumentBuilder(false);\n        Document document = builder.parse(sourceDocument);\n\n        \n        KeyStore keyStore = KeyStore.getInstance(\"jks\");\n        keyStore.load(\n                this.getClass().getClassLoader().getResource(\"transmitter.jks\").openStream(),\n                \"default\".toCharArray()\n        );\n        Key key = keyStore.getKey(\"transmitter\", \"default\".toCharArray());\n        X509Certificate cert = (X509Certificate)keyStore.getCertificate(\"transmitter\");\n\n        \n        List<String> localNames = new ArrayList<String>();\n        localNames.add(\"PaymentInfo\");\n        XMLSignature sig = signUsingDOM(\n                \"http://www.w3.org/2000/09/xmldsig#rsa-sha1\",\n                document, localNames, \"http://www.w3.org/2000/09/xmldsig#base64\", key\n        );\n\n        \n        sig.addKeyInfo(cert);\n\n        \n\n        \n        javax.xml.transform.Transformer transformer = transformerFactory.newTransformer();\n        ByteArrayOutputStream baos = new ByteArrayOutputStream();\n        transformer.transform(new DOMSource(document), new StreamResult(baos));\n        final XMLStreamReader xmlStreamReader =\n                xmlInputFactory.createXMLStreamReader(new ByteArrayInputStream(baos.toByteArray()));\n\n        \n        XMLSecurityProperties properties = new XMLSecurityProperties();\n        InboundXMLSec inboundXMLSec = XMLSec.getInboundWSSec(properties);\n        TestSecurityEventListener securityEventListener = new TestSecurityEventListener();\n        XMLStreamReader securityStreamReader =\n                inboundXMLSec.processInMessage(xmlStreamReader, null, securityEventListener);\n\n        document = StAX2DOM.readDoc(XMLUtils.createDocumentBuilder(false), securityStreamReader);\n\n        SignedElementSecurityEvent signedElementSecurityEvent = securityEventListener.getSecurityEvent(SecurityEventConstants.SignedElement);\n        X509TokenSecurityEvent x509TokenSecurityEvent = securityEventListener.getSecurityEvent(SecurityEventConstants.X509Token);\n        String signedElementCorrelationID = signedElementSecurityEvent.getCorrelationID();\n        String x509TokenCorrelationID = x509TokenSecurityEvent.getCorrelationID();\n\n        List<SecurityEvent> signatureSecurityEvents = new ArrayList<SecurityEvent>();\n        List<SecurityEvent> signedElementSecurityEvents = new ArrayList<SecurityEvent>();\n\n        List<SecurityEvent> securityEvents = securityEventListener.getSecurityEvents();\n        for (int i = 0; i < securityEvents.size(); i++) {\n            SecurityEvent securityEvent = securityEvents.get(i);\n            if (securityEvent.getCorrelationID().equals(signedElementCorrelationID)) {\n                signedElementSecurityEvents.add(securityEvent);\n            } else if (securityEvent.getCorrelationID().equals(x509TokenCorrelationID)) {\n                signatureSecurityEvents.add(securityEvent);\n            }\n        }\n\n        Assert.assertEquals(4, signatureSecurityEvents.size());\n        Assert.assertEquals(3, signedElementSecurityEvents.size());\n        Assert.assertEquals(securityEventListener.getSecurityEvents().size(),\n                signatureSecurityEvents.size() + signedElementSecurityEvents.size());\n    }"
  },
  {
    "id": 20,
    "sub_id": 3,
    "code_id": 0,
    "function_id": 14,
    "human_patch": "https://github.com/apache/santuario-java/commit/e50488044121cf01ffbc235ca53b9562031d69c5",
    "cve_id": "CVE-2014-8152",
    "cwe_id": "CWE-254",
    "filename": "src/test/java/org/apache/xml/security/test/stax/signature/SignatureVerificationTest.java",
    "is_vulnerable": 0,
    "class_name": "SignatureVerificationTest",
    "subclass_name": null,
    "function_name": "testMaximumAllowedReferencesPerManifest() throws Exception",
    "function_body": "{\n        \n        InputStream sourceDocument =\n                this.getClass().getClassLoader().getResourceAsStream(\n                        \"ie/baltimore/merlin-examples/merlin-xmlenc-five/plaintext.xml\");\n        DocumentBuilder builder = XMLUtils.createDocumentBuilder(false);\n        Document document = builder.parse(sourceDocument);\n\n        \n        KeyStore keyStore = KeyStore.getInstance(\"jks\");\n        keyStore.load(\n                this.getClass().getClassLoader().getResource(\"transmitter.jks\").openStream(),\n                \"default\".toCharArray()\n        );\n        Key key = keyStore.getKey(\"transmitter\", \"default\".toCharArray());\n        X509Certificate cert = (X509Certificate)keyStore.getCertificate(\"transmitter\");\n\n        \n        List<String> localNames = new ArrayList<String>();\n        localNames.add(\"Item\");\n        localNames.add(\"PaymentInfo\");\n        localNames.add(\"ShippingAddress\");\n        XMLSignature sig = signUsingDOM(\n                \"http://www.w3.org/2000/09/xmldsig#rsa-sha1\", document, localNames, key\n        );\n\n        \n        sig.addKeyInfo(cert);\n\n        \n        javax.xml.transform.Transformer transformer = transformerFactory.newTransformer();\n        ByteArrayOutputStream baos = new ByteArrayOutputStream();\n        transformer.transform(new DOMSource(document), new StreamResult(baos));\n        final XMLStreamReader xmlStreamReader =\n                xmlInputFactory.createXMLStreamReader(new ByteArrayInputStream(baos.toByteArray()));\n\n        \n        XMLSecurityProperties properties = new XMLSecurityProperties();\n        InboundXMLSec inboundXMLSec = XMLSec.getInboundWSSec(properties);\n        TestSecurityEventListener securityEventListener = new TestSecurityEventListener();\n        XMLStreamReader securityStreamReader =\n                inboundXMLSec.processInMessage(xmlStreamReader, null, securityEventListener);\n\n        int oldval = 0;\n        try {\n            oldval = TestUtils.changeValueOfMaximumAllowedReferencesPerManifest(2);\n            document = StAX2DOM.readDoc(XMLUtils.createDocumentBuilder(false), securityStreamReader);\n            fail(\"Exception expected\");\n        } catch (XMLStreamException e) {\n            assertTrue(e.getCause() instanceof XMLSecurityException);\n            assertEquals(\"4 references are contained in the Manifest, maximum 2 are allowed. You can raise the maximum \" +\n                    \"via the \\\"MaximumAllowedReferencesPerManifest\\\" property in the configuration.\",\n                    e.getCause().getMessage());\n        } finally {\n            TestUtils.changeValueOfMaximumAllowedReferencesPerManifest(oldval);\n        }\n    }"
  },
  {
    "id": 20,
    "sub_id": 3,
    "code_id": 0,
    "function_id": 15,
    "human_patch": "https://github.com/apache/santuario-java/commit/e50488044121cf01ffbc235ca53b9562031d69c5",
    "cve_id": "CVE-2014-8152",
    "cwe_id": "CWE-254",
    "filename": "src/test/java/org/apache/xml/security/test/stax/signature/SignatureVerificationTest.java",
    "is_vulnerable": 0,
    "class_name": "SignatureVerificationTest",
    "subclass_name": null,
    "function_name": "testMaximumAllowedTransformsPerReference() throws Exception",
    "function_body": "{\n        \n        InputStream sourceDocument =\n                this.getClass().getClassLoader().getResourceAsStream(\n                        \"ie/baltimore/merlin-examples/merlin-xmlenc-five/plaintext.xml\");\n        DocumentBuilder builder = XMLUtils.createDocumentBuilder(false);\n        Document document = builder.parse(sourceDocument);\n\n        \n        KeyStore keyStore = KeyStore.getInstance(\"jks\");\n        keyStore.load(\n                this.getClass().getClassLoader().getResource(\"transmitter.jks\").openStream(),\n                \"default\".toCharArray()\n        );\n        Key key = keyStore.getKey(\"transmitter\", \"default\".toCharArray());\n        X509Certificate cert = (X509Certificate)keyStore.getCertificate(\"transmitter\");\n\n        \n        List<String> localNames = new ArrayList<String>();\n        localNames.add(\"PaymentInfo\");\n        XMLSignature sig = signUsingDOM(\n                \"http://www.w3.org/2000/09/xmldsig#rsa-sha1\", document, localNames, key\n        );\n\n        \n        sig.addKeyInfo(cert);\n\n        \n        javax.xml.transform.Transformer transformer = transformerFactory.newTransformer();\n        ByteArrayOutputStream baos = new ByteArrayOutputStream();\n        transformer.transform(new DOMSource(document), new StreamResult(baos));\n        final XMLStreamReader xmlStreamReader =\n                xmlInputFactory.createXMLStreamReader(new ByteArrayInputStream(baos.toByteArray()));\n\n        \n        XMLSecurityProperties properties = new XMLSecurityProperties();\n        InboundXMLSec inboundXMLSec = XMLSec.getInboundWSSec(properties);\n        TestSecurityEventListener securityEventListener = new TestSecurityEventListener();\n        XMLStreamReader securityStreamReader =\n                inboundXMLSec.processInMessage(xmlStreamReader, null, securityEventListener);\n\n        int oldval = 0;\n        try {\n            oldval = TestUtils.changeValueOfMaximumAllowedTransformsPerReference(0);\n            document = StAX2DOM.readDoc(XMLUtils.createDocumentBuilder(false), securityStreamReader);\n            fail(\"Exception expected\");\n        } catch (XMLStreamException e) {\n            assertTrue(e.getCause() instanceof XMLSecurityException);\n            assertEquals(\"1 transforms are contained in the Reference, maximum 0 are allowed. You can raise the maximum \" +\n                    \"via the \\\"MaximumAllowedTransformsPerReference\\\" property in the configuration.\",\n                    e.getCause().getMessage());\n        } finally {\n            TestUtils.changeValueOfMaximumAllowedTransformsPerReference(oldval);\n        }\n    }"
  },
  {
    "id": 20,
    "sub_id": 3,
    "code_id": 0,
    "function_id": 16,
    "human_patch": "https://github.com/apache/santuario-java/commit/e50488044121cf01ffbc235ca53b9562031d69c5",
    "cve_id": "CVE-2014-8152",
    "cwe_id": "CWE-254",
    "filename": "src/test/java/org/apache/xml/security/test/stax/signature/SignatureVerificationTest.java",
    "is_vulnerable": 0,
    "class_name": "SignatureVerificationTest",
    "subclass_name": null,
    "function_name": "testDisallowMD5Algorithm() throws Exception",
    "function_body": "{\n        \n        InputStream sourceDocument =\n                this.getClass().getClassLoader().getResourceAsStream(\n                        \"ie/baltimore/merlin-examples/merlin-xmlenc-five/plaintext.xml\");\n        DocumentBuilder builder = XMLUtils.createDocumentBuilder(false);\n        Document document = builder.parse(sourceDocument);\n\n        \n        KeyStore keyStore = KeyStore.getInstance(\"jks\");\n        keyStore.load(\n                this.getClass().getClassLoader().getResource(\"transmitter.jks\").openStream(),\n                \"default\".toCharArray()\n        );\n        Key key = keyStore.getKey(\"transmitter\", \"default\".toCharArray());\n        X509Certificate cert = (X509Certificate)keyStore.getCertificate(\"transmitter\");\n\n        \n        List<String> localNames = new ArrayList<String>();\n        localNames.add(\"PaymentInfo\");\n        XMLSignature sig = signUsingDOM(\n                \"http://www.w3.org/2001/04/xmldsig-more#rsa-md5\", document, localNames, key\n        );\n\n        \n        sig.addKeyInfo(cert);\n\n        \n        javax.xml.transform.Transformer transformer = transformerFactory.newTransformer();\n        ByteArrayOutputStream baos = new ByteArrayOutputStream();\n        transformer.transform(new DOMSource(document), new StreamResult(baos));\n        final XMLStreamReader xmlStreamReader =\n                xmlInputFactory.createXMLStreamReader(new ByteArrayInputStream(baos.toByteArray()));\n\n        \n        XMLSecurityProperties properties = new XMLSecurityProperties();\n        InboundXMLSec inboundXMLSec = XMLSec.getInboundWSSec(properties);\n        TestSecurityEventListener securityEventListener = new TestSecurityEventListener();\n        XMLStreamReader securityStreamReader =\n                inboundXMLSec.processInMessage(xmlStreamReader, null, securityEventListener);\n\n        try {\n            document = StAX2DOM.readDoc(XMLUtils.createDocumentBuilder(false), securityStreamReader);\n            fail(\"Exception expected\");\n        } catch (XMLStreamException e) {\n            assertTrue(e.getCause() instanceof XMLSecurityException);\n            assertEquals(\"The use of MD5 algorithm is strongly discouraged. Nonetheless can it be enabled via the \" +\n                    \"\\\"AllowMD5Algorithm\\\" property in the configuration.\",\n                    e.getCause().getMessage());\n        }\n    }"
  },
  {
    "id": 20,
    "sub_id": 3,
    "code_id": 0,
    "function_id": 17,
    "human_patch": "https://github.com/apache/santuario-java/commit/e50488044121cf01ffbc235ca53b9562031d69c5",
    "cve_id": "CVE-2014-8152",
    "cwe_id": "CWE-254",
    "filename": "src/test/java/org/apache/xml/security/test/stax/signature/SignatureVerificationTest.java",
    "is_vulnerable": 0,
    "class_name": "SignatureVerificationTest",
    "subclass_name": null,
    "function_name": "testAllowMD5Algorithm() throws Exception",
    "function_body": "{\n        \n        InputStream sourceDocument =\n                this.getClass().getClassLoader().getResourceAsStream(\n                        \"ie/baltimore/merlin-examples/merlin-xmlenc-five/plaintext.xml\");\n        DocumentBuilder builder = XMLUtils.createDocumentBuilder(false);\n        Document document = builder.parse(sourceDocument);\n\n        \n        KeyStore keyStore = KeyStore.getInstance(\"jks\");\n        keyStore.load(\n                this.getClass().getClassLoader().getResource(\"transmitter.jks\").openStream(),\n                \"default\".toCharArray()\n        );\n        Key key = keyStore.getKey(\"transmitter\", \"default\".toCharArray());\n        X509Certificate cert = (X509Certificate)keyStore.getCertificate(\"transmitter\");\n\n        \n        List<String> localNames = new ArrayList<String>();\n        localNames.add(\"PaymentInfo\");\n        XMLSignature sig = signUsingDOM(\n                \"http://www.w3.org/2001/04/xmldsig-more#rsa-md5\", document, localNames, key\n        );\n\n        \n        sig.addKeyInfo(cert);\n\n        \n        javax.xml.transform.Transformer transformer = transformerFactory.newTransformer();\n        ByteArrayOutputStream baos = new ByteArrayOutputStream();\n        transformer.transform(new DOMSource(document), new StreamResult(baos));\n        final XMLStreamReader xmlStreamReader =\n                xmlInputFactory.createXMLStreamReader(new ByteArrayInputStream(baos.toByteArray()));\n\n        \n        XMLSecurityProperties properties = new XMLSecurityProperties();\n        InboundXMLSec inboundXMLSec = XMLSec.getInboundWSSec(properties);\n        TestSecurityEventListener securityEventListener = new TestSecurityEventListener();\n        XMLStreamReader securityStreamReader =\n                inboundXMLSec.processInMessage(xmlStreamReader, null, securityEventListener);\n\n        try {\n            TestUtils.switchAllowMD5Algorithm(true);\n            document = StAX2DOM.readDoc(XMLUtils.createDocumentBuilder(false), securityStreamReader);\n        } finally {\n            TestUtils.switchAllowMD5Algorithm(false);\n        }\n    }"
  },
  {
    "id": 20,
    "sub_id": 3,
    "code_id": 0,
    "function_id": 18,
    "human_patch": "https://github.com/apache/santuario-java/commit/e50488044121cf01ffbc235ca53b9562031d69c5",
    "cve_id": "CVE-2014-8152",
    "cwe_id": "CWE-254",
    "filename": "src/test/java/org/apache/xml/security/test/stax/signature/SignatureVerificationTest.java",
    "is_vulnerable": 0,
    "class_name": "SignatureVerificationTest",
    "subclass_name": null,
    "function_name": "testMaximumAllowedXMLStructureDepth() throws Exception",
    "function_body": "{\n        \n        InputStream sourceDocument =\n                this.getClass().getClassLoader().getResourceAsStream(\n                        \"ie/baltimore/merlin-examples/merlin-xmlenc-five/plaintext.xml\");\n        DocumentBuilder builder = XMLUtils.createDocumentBuilder(false);\n        Document document = builder.parse(sourceDocument);\n\n        \n        KeyStore keyStore = KeyStore.getInstance(\"jks\");\n        keyStore.load(\n                this.getClass().getClassLoader().getResource(\"transmitter.jks\").openStream(),\n                \"default\".toCharArray()\n        );\n        Key key = keyStore.getKey(\"transmitter\", \"default\".toCharArray());\n        X509Certificate cert = (X509Certificate)keyStore.getCertificate(\"transmitter\");\n\n        \n        List<String> localNames = new ArrayList<String>();\n        localNames.add(\"PaymentInfo\");\n        XMLSignature sig = signUsingDOM(\n                \"http://www.w3.org/2000/09/xmldsig#rsa-sha1\", document, localNames, key\n        );\n\n        \n        sig.addKeyInfo(cert);\n\n        \n        javax.xml.transform.Transformer transformer = transformerFactory.newTransformer();\n        ByteArrayOutputStream baos = new ByteArrayOutputStream();\n        transformer.transform(new DOMSource(document), new StreamResult(baos));\n        final XMLStreamReader xmlStreamReader =\n                xmlInputFactory.createXMLStreamReader(new ByteArrayInputStream(baos.toByteArray()));\n\n        \n        XMLSecurityProperties properties = new XMLSecurityProperties();\n        InboundXMLSec inboundXMLSec = XMLSec.getInboundWSSec(properties);\n        TestSecurityEventListener securityEventListener = new TestSecurityEventListener();\n        XMLStreamReader securityStreamReader =\n                inboundXMLSec.processInMessage(xmlStreamReader, null, securityEventListener);\n\n        int oldval = 0;\n        try {\n            oldval = TestUtils.changeValueOfMaximumAllowedXMLStructureDepth(5);\n            document = StAX2DOM.readDoc(XMLUtils.createDocumentBuilder(false), securityStreamReader);\n            fail(\"Exception expected\");\n        } catch (XMLStreamException e) {\n            assertTrue(e.getCause() instanceof XMLSecurityException);\n            assertEquals(\"Maximum depth (5) of the XML structure reached. You can raise the maximum via the \" +\n                    \"\\\"MaximumAllowedXMLStructureDepth\\\" property in the configuration.\",\n                    e.getCause().getMessage());\n        } finally {\n            TestUtils.changeValueOfMaximumAllowedXMLStructureDepth(oldval);\n        }\n    }"
  },
  {
    "id": 20,
    "sub_id": 3,
    "code_id": 0,
    "function_id": 19,
    "human_patch": "https://github.com/apache/santuario-java/commit/e50488044121cf01ffbc235ca53b9562031d69c5",
    "cve_id": "CVE-2014-8152",
    "cwe_id": "CWE-254",
    "filename": "src/test/java/org/apache/xml/security/test/stax/signature/SignatureVerificationTest.java",
    "is_vulnerable": 0,
    "class_name": "SignatureVerificationTest",
    "subclass_name": null,
    "function_name": "testCustomC14nAlgo() throws Exception",
    "function_body": "{\n\n        final String customC14N = \"customC14N\";\n        Transform.register(customC14N, TransformC14N.class);\n        Canonicalizer.register(customC14N, Canonicalizer20010315OmitComments.class);\n\n        Field algorithmsClassMapInField = TransformerAlgorithmMapper.class.getDeclaredField(\"algorithmsClassMapIn\");\n        algorithmsClassMapInField.setAccessible(true);\n        @SuppressWarnings(\"unchecked\")\n        Map<String, Class<?>> transformMap = (Map<String, Class<?>>)algorithmsClassMapInField.get(null);\n        transformMap.put(customC14N, org.apache.xml.security.stax.impl.transformer.canonicalizer.Canonicalizer20010315_OmitCommentsTransformer.class);\n\n        \n        InputStream sourceDocument =\n                this.getClass().getClassLoader().getResourceAsStream(\n                        \"ie/baltimore/merlin-examples/merlin-xmlenc-five/plaintext.xml\");\n        DocumentBuilder builder = XMLUtils.createDocumentBuilder(false);\n        Document document = builder.parse(sourceDocument);\n\n        \n        KeyStore keyStore = KeyStore.getInstance(\"jks\");\n        keyStore.load(\n                this.getClass().getClassLoader().getResource(\"transmitter.jks\").openStream(),\n                \"default\".toCharArray()\n        );\n        Key key = keyStore.getKey(\"transmitter\", \"default\".toCharArray());\n        X509Certificate cert = (X509Certificate)keyStore.getCertificate(\"transmitter\");\n\n        \n        List<String> localNames = new ArrayList<String>();\n        localNames.add(\"PaymentInfo\");\n\n        XMLSignature sig = signUsingDOM(\n                \"http://www.w3.org/2000/09/xmldsig#rsa-sha1\", document, localNames, key,\n                customC14N, (List<ReferenceInfo>)null\n        );\n\n        \n        sig.addKeyInfo(cert);\n\n        \n\n        \n        javax.xml.transform.Transformer transformer = transformerFactory.newTransformer();\n        ByteArrayOutputStream baos = new ByteArrayOutputStream();\n        transformer.transform(new DOMSource(document), new StreamResult(baos));\n        final XMLStreamReader xmlStreamReader =\n                xmlInputFactory.createXMLStreamReader(new ByteArrayInputStream(baos.toByteArray()));\n\n        \n        XMLSecurityProperties properties = new XMLSecurityProperties();\n        properties.setSignatureVerificationKey(cert.getPublicKey());\n        InboundXMLSec inboundXMLSec = XMLSec.getInboundWSSec(properties);\n        XMLStreamReader securityStreamReader = inboundXMLSec.processInMessage(xmlStreamReader);\n\n        StAX2DOM.readDoc(XMLUtils.createDocumentBuilder(false), securityStreamReader);\n    }"
  },
  {
    "id": 21,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 0,
    "human_patch": "https://github.com/apache/shiro/commit/b15ab927709ca18ea4a02538be01919a19ab65af",
    "cve_id": "CVE-2016-6802",
    "cwe_id": "CWE-284",
    "filename": "web/src/main/java/org/apache/shiro/web/util/WebUtils.java",
    "is_vulnerable": 0,
    "class_name": "WebUtils",
    "subclass_name": null,
    "function_name": "getPathWithinApplication(HttpServletRequest request)",
    "function_body": "{\n        String contextPath = getContextPath(request);\n        String requestUri = getRequestUri(request);\n        if (StringUtils.startsWithIgnoreCase(requestUri, contextPath)) {\n            \n            String path = requestUri.substring(contextPath.length());\n            return (StringUtils.hasText(path) ? path : \"/\");\n        } else {\n            \n            return requestUri;\n        }\n    }"
  },
  {
    "id": 21,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 1,
    "human_patch": "https://github.com/apache/shiro/commit/b15ab927709ca18ea4a02538be01919a19ab65af",
    "cve_id": "CVE-2016-6802",
    "cwe_id": "CWE-284",
    "filename": "web/src/main/java/org/apache/shiro/web/util/WebUtils.java",
    "is_vulnerable": 0,
    "class_name": "WebUtils",
    "subclass_name": null,
    "function_name": "getRequestUri(HttpServletRequest request)",
    "function_body": "{\n        String uri = (String) request.getAttribute(INCLUDE_REQUEST_URI_ATTRIBUTE);\n        if (uri == null) {\n            uri = request.getRequestURI();\n        }\n        return normalize(decodeAndCleanUriString(request, uri));\n    }"
  },
  {
    "id": 21,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 2,
    "human_patch": "https://github.com/apache/shiro/commit/b15ab927709ca18ea4a02538be01919a19ab65af",
    "cve_id": "CVE-2016-6802",
    "cwe_id": "CWE-284",
    "filename": "web/src/main/java/org/apache/shiro/web/util/WebUtils.java",
    "is_vulnerable": 0,
    "class_name": "WebUtils",
    "subclass_name": null,
    "function_name": "normalize(String path)",
    "function_body": "{\n        return normalize(path, true);\n    }"
  },
  {
    "id": 21,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 3,
    "human_patch": "https://github.com/apache/shiro/commit/b15ab927709ca18ea4a02538be01919a19ab65af",
    "cve_id": "CVE-2016-6802",
    "cwe_id": "CWE-284",
    "filename": "web/src/main/java/org/apache/shiro/web/util/WebUtils.java",
    "is_vulnerable": 0,
    "class_name": "WebUtils",
    "subclass_name": null,
    "function_name": "normalize(String path, boolean replaceBackSlash)",
    "function_body": "{\n\n        if (path == null)\n            return null;\n\n        \n        String normalized = path;\n\n        if (replaceBackSlash && normalized.indexOf('\\\\') >= 0)\n            normalized = normalized.replace('\\\\', '/');\n\n        if (normalized.equals(\"/.\"))\n            return \"/\";\n\n        \n        if (!normalized.startsWith(\"/\"))\n            normalized = \"/\" + normalized;\n\n        \n        while (true) {\n            int index = normalized.indexOf(\"//\");\n            if (index < 0)\n                break;\n            normalized = normalized.substring(0, index) +\n                    normalized.substring(index + 1);\n        }\n\n        \n        while (true) {\n            int index = normalized.indexOf(\"/./\");\n            if (index < 0)\n                break;\n            normalized = normalized.substring(0, index) +\n                    normalized.substring(index + 2);\n        }\n\n        \n        while (true) {\n            int index = normalized.indexOf(\"/../\");\n            if (index < 0)\n                break;\n            if (index == 0)\n                return (null);  \n            int index2 = normalized.lastIndexOf('/', index - 1);\n            normalized = normalized.substring(0, index2) +\n                    normalized.substring(index + 3);\n        }\n\n        \n        return (normalized);\n\n    }"
  },
  {
    "id": 21,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 4,
    "human_patch": "https://github.com/apache/shiro/commit/b15ab927709ca18ea4a02538be01919a19ab65af",
    "cve_id": "CVE-2016-6802",
    "cwe_id": "CWE-284",
    "filename": "web/src/main/java/org/apache/shiro/web/util/WebUtils.java",
    "is_vulnerable": 0,
    "class_name": "WebUtils",
    "subclass_name": null,
    "function_name": "decodeAndCleanUriString(HttpServletRequest request, String uri)",
    "function_body": "{\n        uri = decodeRequestString(request, uri);\n        int semicolonIndex = uri.indexOf(';');\n        return (semicolonIndex != -1 ? uri.substring(0, semicolonIndex) : uri);\n    }"
  },
  {
    "id": 21,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 5,
    "human_patch": "https://github.com/apache/shiro/commit/b15ab927709ca18ea4a02538be01919a19ab65af",
    "cve_id": "CVE-2016-6802",
    "cwe_id": "CWE-284",
    "filename": "web/src/main/java/org/apache/shiro/web/util/WebUtils.java",
    "is_vulnerable": 1,
    "class_name": "WebUtils",
    "subclass_name": null,
    "function_name": "getContextPath(HttpServletRequest request)",
    "function_body": "{\n        String contextPath = (String) request.getAttribute(INCLUDE_CONTEXT_PATH_ATTRIBUTE);\n        if (contextPath == null) {\n            contextPath = request.getContextPath();\n        }\n        if (\"/\".equals(contextPath)) {\n            \n            contextPath = \"\";\n        }\n        return decodeRequestString(request, contextPath);\n    }"
  },
  {
    "id": 21,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 6,
    "human_patch": "https://github.com/apache/shiro/commit/b15ab927709ca18ea4a02538be01919a19ab65af",
    "cve_id": "CVE-2016-6802",
    "cwe_id": "CWE-284",
    "filename": "web/src/main/java/org/apache/shiro/web/util/WebUtils.java",
    "is_vulnerable": 0,
    "class_name": "WebUtils",
    "subclass_name": null,
    "function_name": "getRequiredWebEnvironment(ServletContext sc) throws IllegalStateException",
    "function_body": "{\n\n        WebEnvironment we = getWebEnvironment(sc);\n        if (we == null) {\n            throw new IllegalStateException(\"No WebEnvironment found: no EnvironmentLoaderListener registered?\");\n        }\n        return we;\n    }"
  },
  {
    "id": 21,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 7,
    "human_patch": "https://github.com/apache/shiro/commit/b15ab927709ca18ea4a02538be01919a19ab65af",
    "cve_id": "CVE-2016-6802",
    "cwe_id": "CWE-284",
    "filename": "web/src/main/java/org/apache/shiro/web/util/WebUtils.java",
    "is_vulnerable": 0,
    "class_name": "WebUtils",
    "subclass_name": null,
    "function_name": "getWebEnvironment(ServletContext sc)",
    "function_body": "{\n        return getWebEnvironment(sc, EnvironmentLoader.ENVIRONMENT_ATTRIBUTE_KEY);\n    }"
  },
  {
    "id": 21,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 8,
    "human_patch": "https://github.com/apache/shiro/commit/b15ab927709ca18ea4a02538be01919a19ab65af",
    "cve_id": "CVE-2016-6802",
    "cwe_id": "CWE-284",
    "filename": "web/src/main/java/org/apache/shiro/web/util/WebUtils.java",
    "is_vulnerable": 0,
    "class_name": "WebUtils",
    "subclass_name": null,
    "function_name": "getWebEnvironment(ServletContext sc, String attrName)",
    "function_body": "{\n        if (sc == null) {\n            throw new IllegalArgumentException(\"ServletContext argument must not be null.\");\n        }\n        Object attr = sc.getAttribute(attrName);\n        if (attr == null) {\n            return null;\n        }\n        if (attr instanceof RuntimeException) {\n            throw (RuntimeException) attr;\n        }\n        if (attr instanceof Error) {\n            throw (Error) attr;\n        }\n        if (attr instanceof Exception) {\n            throw new IllegalStateException((Exception) attr);\n        }\n        if (!(attr instanceof WebEnvironment)) {\n            throw new IllegalStateException(\"Context attribute is not of type WebEnvironment: \" + attr);\n        }\n        return (WebEnvironment) attr;\n    }"
  },
  {
    "id": 21,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 9,
    "human_patch": "https://github.com/apache/shiro/commit/b15ab927709ca18ea4a02538be01919a19ab65af",
    "cve_id": "CVE-2016-6802",
    "cwe_id": "CWE-284",
    "filename": "web/src/main/java/org/apache/shiro/web/util/WebUtils.java",
    "is_vulnerable": 0,
    "class_name": "WebUtils",
    "subclass_name": null,
    "function_name": "decodeRequestString(HttpServletRequest request, String source)",
    "function_body": "{\n        String enc = determineEncoding(request);\n        try {\n            return URLDecoder.decode(source, enc);\n        } catch (UnsupportedEncodingException ex) {\n            if (log.isWarnEnabled()) {\n                log.warn(\"Could not decode request string [\" + source + \"] with encoding '\" + enc +\n                        \"': falling back to platform default encoding; exception message: \" + ex.getMessage());\n            }\n            return URLDecoder.decode(source);\n        }\n    }"
  },
  {
    "id": 21,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 10,
    "human_patch": "https://github.com/apache/shiro/commit/b15ab927709ca18ea4a02538be01919a19ab65af",
    "cve_id": "CVE-2016-6802",
    "cwe_id": "CWE-284",
    "filename": "web/src/main/java/org/apache/shiro/web/util/WebUtils.java",
    "is_vulnerable": 0,
    "class_name": "WebUtils",
    "subclass_name": null,
    "function_name": "determineEncoding(HttpServletRequest request)",
    "function_body": "{\n        String enc = request.getCharacterEncoding();\n        if (enc == null) {\n            enc = DEFAULT_CHARACTER_ENCODING;\n        }\n        return enc;\n    }"
  },
  {
    "id": 21,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 11,
    "human_patch": "https://github.com/apache/shiro/commit/b15ab927709ca18ea4a02538be01919a19ab65af",
    "cve_id": "CVE-2016-6802",
    "cwe_id": "CWE-284",
    "filename": "web/src/main/java/org/apache/shiro/web/util/WebUtils.java",
    "is_vulnerable": 0,
    "class_name": "WebUtils",
    "subclass_name": null,
    "function_name": "isWeb(Object requestPairSource)",
    "function_body": "{\n        return requestPairSource instanceof RequestPairSource && isWeb((RequestPairSource) requestPairSource);\n    }"
  },
  {
    "id": 21,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 12,
    "human_patch": "https://github.com/apache/shiro/commit/b15ab927709ca18ea4a02538be01919a19ab65af",
    "cve_id": "CVE-2016-6802",
    "cwe_id": "CWE-284",
    "filename": "web/src/main/java/org/apache/shiro/web/util/WebUtils.java",
    "is_vulnerable": 0,
    "class_name": "WebUtils",
    "subclass_name": null,
    "function_name": "isHttp(Object requestPairSource)",
    "function_body": "{\n        return requestPairSource instanceof RequestPairSource && isHttp((RequestPairSource) requestPairSource);\n    }"
  },
  {
    "id": 21,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 13,
    "human_patch": "https://github.com/apache/shiro/commit/b15ab927709ca18ea4a02538be01919a19ab65af",
    "cve_id": "CVE-2016-6802",
    "cwe_id": "CWE-284",
    "filename": "web/src/main/java/org/apache/shiro/web/util/WebUtils.java",
    "is_vulnerable": 0,
    "class_name": "WebUtils",
    "subclass_name": null,
    "function_name": "getRequest(Object requestPairSource)",
    "function_body": "{\n        if (requestPairSource instanceof RequestPairSource) {\n            return ((RequestPairSource) requestPairSource).getServletRequest();\n        }\n        return null;\n    }"
  },
  {
    "id": 21,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 14,
    "human_patch": "https://github.com/apache/shiro/commit/b15ab927709ca18ea4a02538be01919a19ab65af",
    "cve_id": "CVE-2016-6802",
    "cwe_id": "CWE-284",
    "filename": "web/src/main/java/org/apache/shiro/web/util/WebUtils.java",
    "is_vulnerable": 0,
    "class_name": "WebUtils",
    "subclass_name": null,
    "function_name": "getResponse(Object requestPairSource)",
    "function_body": "{\n        if (requestPairSource instanceof RequestPairSource) {\n            return ((RequestPairSource) requestPairSource).getServletResponse();\n        }\n        return null;\n    }"
  },
  {
    "id": 21,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 15,
    "human_patch": "https://github.com/apache/shiro/commit/b15ab927709ca18ea4a02538be01919a19ab65af",
    "cve_id": "CVE-2016-6802",
    "cwe_id": "CWE-284",
    "filename": "web/src/main/java/org/apache/shiro/web/util/WebUtils.java",
    "is_vulnerable": 0,
    "class_name": "WebUtils",
    "subclass_name": null,
    "function_name": "getHttpRequest(Object requestPairSource)",
    "function_body": "{\n        ServletRequest request = getRequest(requestPairSource);\n        if (request instanceof HttpServletRequest) {\n            return (HttpServletRequest) request;\n        }\n        return null;\n    }"
  },
  {
    "id": 21,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 16,
    "human_patch": "https://github.com/apache/shiro/commit/b15ab927709ca18ea4a02538be01919a19ab65af",
    "cve_id": "CVE-2016-6802",
    "cwe_id": "CWE-284",
    "filename": "web/src/main/java/org/apache/shiro/web/util/WebUtils.java",
    "is_vulnerable": 0,
    "class_name": "WebUtils",
    "subclass_name": null,
    "function_name": "getHttpResponse(Object requestPairSource)",
    "function_body": "{\n        ServletResponse response = getResponse(requestPairSource);\n        if (response instanceof HttpServletResponse) {\n            return (HttpServletResponse) response;\n        }\n        return null;\n    }"
  },
  {
    "id": 21,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 17,
    "human_patch": "https://github.com/apache/shiro/commit/b15ab927709ca18ea4a02538be01919a19ab65af",
    "cve_id": "CVE-2016-6802",
    "cwe_id": "CWE-284",
    "filename": "web/src/main/java/org/apache/shiro/web/util/WebUtils.java",
    "is_vulnerable": 0,
    "class_name": "WebUtils",
    "subclass_name": null,
    "function_name": "isWeb(RequestPairSource source)",
    "function_body": "{\n        ServletRequest request = source.getServletRequest();\n        ServletResponse response = source.getServletResponse();\n        return request != null && response != null;\n    }"
  },
  {
    "id": 21,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 18,
    "human_patch": "https://github.com/apache/shiro/commit/b15ab927709ca18ea4a02538be01919a19ab65af",
    "cve_id": "CVE-2016-6802",
    "cwe_id": "CWE-284",
    "filename": "web/src/main/java/org/apache/shiro/web/util/WebUtils.java",
    "is_vulnerable": 0,
    "class_name": "WebUtils",
    "subclass_name": null,
    "function_name": "isHttp(RequestPairSource source)",
    "function_body": "{\n        ServletRequest request = source.getServletRequest();\n        ServletResponse response = source.getServletResponse();\n        return request instanceof HttpServletRequest && response instanceof HttpServletResponse;\n    }"
  },
  {
    "id": 21,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 19,
    "human_patch": "https://github.com/apache/shiro/commit/b15ab927709ca18ea4a02538be01919a19ab65af",
    "cve_id": "CVE-2016-6802",
    "cwe_id": "CWE-284",
    "filename": "web/src/main/java/org/apache/shiro/web/util/WebUtils.java",
    "is_vulnerable": 0,
    "class_name": "WebUtils",
    "subclass_name": null,
    "function_name": "_isSessionCreationEnabled(Object requestPairSource)",
    "function_body": "{\n        if (requestPairSource instanceof RequestPairSource) {\n            RequestPairSource source = (RequestPairSource) requestPairSource;\n            return _isSessionCreationEnabled(source.getServletRequest());\n        }\n        return true; \n    }"
  },
  {
    "id": 21,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 20,
    "human_patch": "https://github.com/apache/shiro/commit/b15ab927709ca18ea4a02538be01919a19ab65af",
    "cve_id": "CVE-2016-6802",
    "cwe_id": "CWE-284",
    "filename": "web/src/main/java/org/apache/shiro/web/util/WebUtils.java",
    "is_vulnerable": 0,
    "class_name": "WebUtils",
    "subclass_name": null,
    "function_name": "_isSessionCreationEnabled(ServletRequest request)",
    "function_body": "{\n        if (request != null) {\n            Object val = request.getAttribute(DefaultSubjectContext.SESSION_CREATION_ENABLED);\n            if (val != null && val instanceof Boolean) {\n                return (Boolean) val;\n            }\n        }\n        return true; \n    }"
  },
  {
    "id": 21,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 21,
    "human_patch": "https://github.com/apache/shiro/commit/b15ab927709ca18ea4a02538be01919a19ab65af",
    "cve_id": "CVE-2016-6802",
    "cwe_id": "CWE-284",
    "filename": "web/src/main/java/org/apache/shiro/web/util/WebUtils.java",
    "is_vulnerable": 0,
    "class_name": "WebUtils",
    "subclass_name": null,
    "function_name": "toHttp(ServletRequest request)",
    "function_body": "{\n        return (HttpServletRequest) request;\n    }"
  },
  {
    "id": 21,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 22,
    "human_patch": "https://github.com/apache/shiro/commit/b15ab927709ca18ea4a02538be01919a19ab65af",
    "cve_id": "CVE-2016-6802",
    "cwe_id": "CWE-284",
    "filename": "web/src/main/java/org/apache/shiro/web/util/WebUtils.java",
    "is_vulnerable": 0,
    "class_name": "WebUtils",
    "subclass_name": null,
    "function_name": "toHttp(ServletResponse response)",
    "function_body": "{\n        return (HttpServletResponse) response;\n    }"
  },
  {
    "id": 21,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 23,
    "human_patch": "https://github.com/apache/shiro/commit/b15ab927709ca18ea4a02538be01919a19ab65af",
    "cve_id": "CVE-2016-6802",
    "cwe_id": "CWE-284",
    "filename": "web/src/main/java/org/apache/shiro/web/util/WebUtils.java",
    "is_vulnerable": 0,
    "class_name": "WebUtils",
    "subclass_name": null,
    "function_name": "issueRedirect(ServletRequest request, ServletResponse response, String url, Map queryParams, boolean contextRelative, boolean http10Compatible) throws IOException",
    "function_body": "{\n        RedirectView view = new RedirectView(url, contextRelative, http10Compatible);\n        view.renderMergedOutputModel(queryParams, toHttp(request), toHttp(response));\n    }"
  },
  {
    "id": 21,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 24,
    "human_patch": "https://github.com/apache/shiro/commit/b15ab927709ca18ea4a02538be01919a19ab65af",
    "cve_id": "CVE-2016-6802",
    "cwe_id": "CWE-284",
    "filename": "web/src/main/java/org/apache/shiro/web/util/WebUtils.java",
    "is_vulnerable": 0,
    "class_name": "WebUtils",
    "subclass_name": null,
    "function_name": "issueRedirect(ServletRequest request, ServletResponse response, String url) throws IOException",
    "function_body": "{\n        issueRedirect(request, response, url, null, true, true);\n    }"
  },
  {
    "id": 21,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 25,
    "human_patch": "https://github.com/apache/shiro/commit/b15ab927709ca18ea4a02538be01919a19ab65af",
    "cve_id": "CVE-2016-6802",
    "cwe_id": "CWE-284",
    "filename": "web/src/main/java/org/apache/shiro/web/util/WebUtils.java",
    "is_vulnerable": 0,
    "class_name": "WebUtils",
    "subclass_name": null,
    "function_name": "issueRedirect(ServletRequest request, ServletResponse response, String url, Map queryParams) throws IOException",
    "function_body": "{\n        issueRedirect(request, response, url, queryParams, true, true);\n    }"
  },
  {
    "id": 21,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 26,
    "human_patch": "https://github.com/apache/shiro/commit/b15ab927709ca18ea4a02538be01919a19ab65af",
    "cve_id": "CVE-2016-6802",
    "cwe_id": "CWE-284",
    "filename": "web/src/main/java/org/apache/shiro/web/util/WebUtils.java",
    "is_vulnerable": 0,
    "class_name": "WebUtils",
    "subclass_name": null,
    "function_name": "issueRedirect(ServletRequest request, ServletResponse response, String url, Map queryParams, boolean contextRelative) throws IOException",
    "function_body": "{\n        issueRedirect(request, response, url, queryParams, contextRelative, true);\n    }"
  },
  {
    "id": 21,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 27,
    "human_patch": "https://github.com/apache/shiro/commit/b15ab927709ca18ea4a02538be01919a19ab65af",
    "cve_id": "CVE-2016-6802",
    "cwe_id": "CWE-284",
    "filename": "web/src/main/java/org/apache/shiro/web/util/WebUtils.java",
    "is_vulnerable": 0,
    "class_name": "WebUtils",
    "subclass_name": null,
    "function_name": "isTrue(ServletRequest request, String paramName)",
    "function_body": "{\n        String value = getCleanParam(request, paramName);\n        return value != null &&\n                (value.equalsIgnoreCase(\"true\") ||\n                        value.equalsIgnoreCase(\"t\") ||\n                        value.equalsIgnoreCase(\"1\") ||\n                        value.equalsIgnoreCase(\"enabled\") ||\n                        value.equalsIgnoreCase(\"y\") ||\n                        value.equalsIgnoreCase(\"yes\") ||\n                        value.equalsIgnoreCase(\"on\"));\n    }"
  },
  {
    "id": 21,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 28,
    "human_patch": "https://github.com/apache/shiro/commit/b15ab927709ca18ea4a02538be01919a19ab65af",
    "cve_id": "CVE-2016-6802",
    "cwe_id": "CWE-284",
    "filename": "web/src/main/java/org/apache/shiro/web/util/WebUtils.java",
    "is_vulnerable": 0,
    "class_name": "WebUtils",
    "subclass_name": null,
    "function_name": "getCleanParam(ServletRequest request, String paramName)",
    "function_body": "{\n        return StringUtils.clean(request.getParameter(paramName));\n    }"
  },
  {
    "id": 21,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 29,
    "human_patch": "https://github.com/apache/shiro/commit/b15ab927709ca18ea4a02538be01919a19ab65af",
    "cve_id": "CVE-2016-6802",
    "cwe_id": "CWE-284",
    "filename": "web/src/main/java/org/apache/shiro/web/util/WebUtils.java",
    "is_vulnerable": 0,
    "class_name": "WebUtils",
    "subclass_name": null,
    "function_name": "saveRequest(ServletRequest request)",
    "function_body": "{\n        Subject subject = SecurityUtils.getSubject();\n        Session session = subject.getSession();\n        HttpServletRequest httpRequest = toHttp(request);\n        SavedRequest savedRequest = new SavedRequest(httpRequest);\n        session.setAttribute(SAVED_REQUEST_KEY, savedRequest);\n    }"
  },
  {
    "id": 21,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 30,
    "human_patch": "https://github.com/apache/shiro/commit/b15ab927709ca18ea4a02538be01919a19ab65af",
    "cve_id": "CVE-2016-6802",
    "cwe_id": "CWE-284",
    "filename": "web/src/main/java/org/apache/shiro/web/util/WebUtils.java",
    "is_vulnerable": 0,
    "class_name": "WebUtils",
    "subclass_name": null,
    "function_name": "getAndClearSavedRequest(ServletRequest request)",
    "function_body": "{\n        SavedRequest savedRequest = getSavedRequest(request);\n        if (savedRequest != null) {\n            Subject subject = SecurityUtils.getSubject();\n            Session session = subject.getSession();\n            session.removeAttribute(SAVED_REQUEST_KEY);\n        }\n        return savedRequest;\n    }"
  },
  {
    "id": 21,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 31,
    "human_patch": "https://github.com/apache/shiro/commit/b15ab927709ca18ea4a02538be01919a19ab65af",
    "cve_id": "CVE-2016-6802",
    "cwe_id": "CWE-284",
    "filename": "web/src/main/java/org/apache/shiro/web/util/WebUtils.java",
    "is_vulnerable": 0,
    "class_name": "WebUtils",
    "subclass_name": null,
    "function_name": "getSavedRequest(ServletRequest request)",
    "function_body": "{\n        SavedRequest savedRequest = null;\n        Subject subject = SecurityUtils.getSubject();\n        Session session = subject.getSession(false);\n        if (session != null) {\n            savedRequest = (SavedRequest) session.getAttribute(SAVED_REQUEST_KEY);\n        }\n        return savedRequest;\n    }"
  },
  {
    "id": 21,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 32,
    "human_patch": "https://github.com/apache/shiro/commit/b15ab927709ca18ea4a02538be01919a19ab65af",
    "cve_id": "CVE-2016-6802",
    "cwe_id": "CWE-284",
    "filename": "web/src/main/java/org/apache/shiro/web/util/WebUtils.java",
    "is_vulnerable": 0,
    "class_name": "WebUtils",
    "subclass_name": null,
    "function_name": "redirectToSavedRequest(ServletRequest request, ServletResponse response, String fallbackUrl) throws IOException",
    "function_body": "{\n        String successUrl = null;\n        boolean contextRelative = true;\n        SavedRequest savedRequest = WebUtils.getAndClearSavedRequest(request);\n        if (savedRequest != null && savedRequest.getMethod().equalsIgnoreCase(AccessControlFilter.GET_METHOD)) {\n            successUrl = savedRequest.getRequestUrl();\n            contextRelative = false;\n        }\n\n        if (successUrl == null) {\n            successUrl = fallbackUrl;\n        }\n\n        if (successUrl == null) {\n            throw new IllegalStateException(\"Success URL not available via saved request or via the \" +\n                    \"successUrlFallback method parameter. One of these must be non-null for \" +\n                    \"issueSuccessRedirect() to work.\");\n        }\n\n        WebUtils.issueRedirect(request, response, successUrl, null, contextRelative);\n    }"
  },
  {
    "id": 22,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 0,
    "human_patch": "https://github.com/apache/sling/commit/7d2365a248943071a44d8495655186e4f14ea294",
    "cve_id": "CVE-2016-5394",
    "cwe_id": "CWE-79",
    "filename": "bundles/extensions/xss/src/main/java/org/apache/sling/xss/impl/XSSAPIImpl.java",
    "is_vulnerable": 0,
    "class_name": "XSSAPIImpl",
    "subclass_name": null,
    "function_name": "activate()",
    "function_body": "{\n        factory = SAXParserFactory.newInstance();\n        factory.setValidating(false);\n        factory.setNamespaceAware(true);\n    }"
  },
  {
    "id": 22,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 1,
    "human_patch": "https://github.com/apache/sling/commit/7d2365a248943071a44d8495655186e4f14ea294",
    "cve_id": "CVE-2016-5394",
    "cwe_id": "CWE-79",
    "filename": "bundles/extensions/xss/src/main/java/org/apache/sling/xss/impl/XSSAPIImpl.java",
    "is_vulnerable": 0,
    "class_name": "XSSAPIImpl",
    "subclass_name": null,
    "function_name": "deactivate()",
    "function_body": "{\n        factory = null;\n    }"
  },
  {
    "id": 22,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 2,
    "human_patch": "https://github.com/apache/sling/commit/7d2365a248943071a44d8495655186e4f14ea294",
    "cve_id": "CVE-2016-5394",
    "cwe_id": "CWE-79",
    "filename": "bundles/extensions/xss/src/main/java/org/apache/sling/xss/impl/XSSAPIImpl.java",
    "is_vulnerable": 0,
    "class_name": "XSSAPIImpl",
    "subclass_name": null,
    "function_name": "getValidInteger(String integer, int defaultValue)",
    "function_body": "{\n        if (integer != null && integer.length() > 0) {\n            try {\n                return validator.getValidInteger(\"XSS\", integer, -2000000000, 2000000000, false);\n            } catch (Exception e) {\n                \n            }\n        }\n\n        \n        return defaultValue;\n    }"
  },
  {
    "id": 22,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 3,
    "human_patch": "https://github.com/apache/sling/commit/7d2365a248943071a44d8495655186e4f14ea294",
    "cve_id": "CVE-2016-5394",
    "cwe_id": "CWE-79",
    "filename": "bundles/extensions/xss/src/main/java/org/apache/sling/xss/impl/XSSAPIImpl.java",
    "is_vulnerable": 0,
    "class_name": "XSSAPIImpl",
    "subclass_name": null,
    "function_name": "getValidLong(String source, long defaultValue)",
    "function_body": "{\n        if (source != null && source.length() > 0) {\n            try {\n                LongValidationRule ivr = new LongValidationRule( \"number\", ESAPI.encoder(), -9000000000000000000L, 9000000000000000000L );\n                ivr.setAllowNull(false);\n                return ivr.getValid(\"XSS\", source);\n            } catch (Exception e) {\n                \n            }\n        }\n\n        \n        return defaultValue;\n    }"
  },
  {
    "id": 22,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 4,
    "human_patch": "https://github.com/apache/sling/commit/7d2365a248943071a44d8495655186e4f14ea294",
    "cve_id": "CVE-2016-5394",
    "cwe_id": "CWE-79",
    "filename": "bundles/extensions/xss/src/main/java/org/apache/sling/xss/impl/XSSAPIImpl.java",
    "is_vulnerable": 0,
    "class_name": "XSSAPIImpl",
    "subclass_name": null,
    "function_name": "getValidDouble(String source, double defaultValue)",
    "function_body": "{\n        if (source != null && source.length() > 0) {\n            try {\n                return validator.getValidDouble(\"XSS\", source, 0d, Double.MAX_VALUE, false);\n            } catch (Exception e) {\n                \n            }\n        }\n\n        \n        return defaultValue;\n    }"
  },
  {
    "id": 22,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 5,
    "human_patch": "https://github.com/apache/sling/commit/7d2365a248943071a44d8495655186e4f14ea294",
    "cve_id": "CVE-2016-5394",
    "cwe_id": "CWE-79",
    "filename": "bundles/extensions/xss/src/main/java/org/apache/sling/xss/impl/XSSAPIImpl.java",
    "is_vulnerable": 0,
    "class_name": "XSSAPIImpl",
    "subclass_name": null,
    "function_name": "getValidDimension(String dimension, String defaultValue)",
    "function_body": "{\n        if (dimension != null && dimension.length() > 0) {\n            if (PATTERN_AUTO_DIMENSION.matcher(dimension).matches()) {\n                return \"\\\"auto\\\"\";\n            }\n\n            try {\n                return validator.getValidInteger(\"XSS\", dimension, -10000, 10000, false).toString();\n            } catch (Exception e) {\n                \n            }\n        }\n\n        \n        return defaultValue;\n    }"
  },
  {
    "id": 22,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 6,
    "human_patch": "https://github.com/apache/sling/commit/7d2365a248943071a44d8495655186e4f14ea294",
    "cve_id": "CVE-2016-5394",
    "cwe_id": "CWE-79",
    "filename": "bundles/extensions/xss/src/main/java/org/apache/sling/xss/impl/XSSAPIImpl.java",
    "is_vulnerable": 0,
    "class_name": "XSSAPIImpl",
    "subclass_name": null,
    "function_name": "mangleNamespaces(String absPath)",
    "function_body": "{\n        if (absPath != null) {\n            \n            final int schemeIndex = absPath.indexOf(SCHEME_PATTERN);\n            final String manglePath;\n            final String prefix;\n            if (schemeIndex != -1) {\n                final int pathIndex = absPath.indexOf(\"/\", schemeIndex + 3);\n                if (pathIndex != -1) {\n                    prefix = absPath.substring(0, pathIndex);\n                    manglePath = absPath.substring(pathIndex);\n                } else {\n                    prefix = absPath;\n                    manglePath = \"\";\n                }\n            } else {\n                prefix = \"\";\n                manglePath = absPath;\n            }\n            if (manglePath.contains(MANGLE_NAMESPACE_OUT_SUFFIX)) {\n                final Matcher m = MANGLE_NAMESPACE_PATTERN.matcher(manglePath);\n\n                final StringBuffer buf = new StringBuffer();\n                while (m.find()) {\n                    final String replacement = MANGLE_NAMESPACE_IN_PREFIX + m.group(1) + MANGLE_NAMESPACE_IN_SUFFIX;\n                    m.appendReplacement(buf, replacement);\n                }\n\n                m.appendTail(buf);\n\n                absPath = prefix + buf.toString();\n\n            }\n        }\n\n        return absPath;\n    }"
  },
  {
    "id": 22,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 7,
    "human_patch": "https://github.com/apache/sling/commit/7d2365a248943071a44d8495655186e4f14ea294",
    "cve_id": "CVE-2016-5394",
    "cwe_id": "CWE-79",
    "filename": "bundles/extensions/xss/src/main/java/org/apache/sling/xss/impl/XSSAPIImpl.java",
    "is_vulnerable": 0,
    "class_name": "XSSAPIImpl",
    "subclass_name": null,
    "function_name": "getValidHref(final String url)",
    "function_body": "{\n        if (url != null && url.length() > 0) {\n            \n            \n            \n            String encodedUrl = url.replaceAll(\"\\\"\", \"%22\")\n                    .replaceAll(\"'\", \"%27\")\n                    .replaceAll(\">\", \"%3E\")\n                    .replaceAll(\"<\", \"%3C\")\n                    .replaceAll(\"`\", \"%60\")\n                    .replaceAll(\" \", \"%20\");\n            int qMarkIx = encodedUrl.indexOf('?');\n            if (qMarkIx > 0) {\n                encodedUrl = encodedUrl.substring(0, qMarkIx) + encodedUrl.substring(qMarkIx).replaceAll(\":\", \"%3A\");\n            }\n\n            encodedUrl = mangleNamespaces(encodedUrl);\n            if (xssFilter.isValidHref(encodedUrl)) {\n                return encodedUrl;\n            }\n        }\n\n        \n        return \"\";\n    }"
  },
  {
    "id": 22,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 8,
    "human_patch": "https://github.com/apache/sling/commit/7d2365a248943071a44d8495655186e4f14ea294",
    "cve_id": "CVE-2016-5394",
    "cwe_id": "CWE-79",
    "filename": "bundles/extensions/xss/src/main/java/org/apache/sling/xss/impl/XSSAPIImpl.java",
    "is_vulnerable": 0,
    "class_name": "XSSAPIImpl",
    "subclass_name": null,
    "function_name": "getValidJSToken(String token, String defaultValue)",
    "function_body": "{\n        if (token != null && token.length() > 0) {\n            token = token.trim();\n            String q = token.substring(0, 1);\n            if (q.matches(\"['\\\"]\") && token.endsWith(q)) {\n                String literal = token.substring(1, token.length() - 1);\n                return q + encodeForJSString(literal) + q;\n            } else if (token.matches(\"[0-9a-zA-Z_$][0-9a-zA-Z_$.]*\")) {\n                return token;\n            }\n        }\n\n        \n        return defaultValue;\n    }"
  },
  {
    "id": 22,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 9,
    "human_patch": "https://github.com/apache/sling/commit/7d2365a248943071a44d8495655186e4f14ea294",
    "cve_id": "CVE-2016-5394",
    "cwe_id": "CWE-79",
    "filename": "bundles/extensions/xss/src/main/java/org/apache/sling/xss/impl/XSSAPIImpl.java",
    "is_vulnerable": 0,
    "class_name": "XSSAPIImpl",
    "subclass_name": null,
    "function_name": "getValidStyleToken(String token, String defaultValue)",
    "function_body": "{\n        if (token != null && token.length() > 0 && token.matches(CSS_TOKEN)) {\n            return token;\n        }\n\n        return defaultValue;\n   }"
  },
  {
    "id": 22,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 10,
    "human_patch": "https://github.com/apache/sling/commit/7d2365a248943071a44d8495655186e4f14ea294",
    "cve_id": "CVE-2016-5394",
    "cwe_id": "CWE-79",
    "filename": "bundles/extensions/xss/src/main/java/org/apache/sling/xss/impl/XSSAPIImpl.java",
    "is_vulnerable": 0,
    "class_name": "XSSAPIImpl",
    "subclass_name": null,
    "function_name": "getValidCSSColor(String color, String defaultColor)",
    "function_body": "{\n        if (color != null && color.length() > 0) {\n            color = color.trim();\n            \n            if (color.matches(\"(?i)[#a-fghlrs(+0-9-.%,) \\\\t\\\\n\\\\x0B\\\\f\\\\r]+\")) {\n                return color;\n            }\n            \n            if (color.matches(\"(?i)[a-zA-Z \\\\t\\\\n\\\\x0B\\\\f\\\\r]+\")) {\n                return color;\n            }\n        }\n\n        return defaultColor;\n    }"
  },
  {
    "id": 22,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 11,
    "human_patch": "https://github.com/apache/sling/commit/7d2365a248943071a44d8495655186e4f14ea294",
    "cve_id": "CVE-2016-5394",
    "cwe_id": "CWE-79",
    "filename": "bundles/extensions/xss/src/main/java/org/apache/sling/xss/impl/XSSAPIImpl.java",
    "is_vulnerable": 0,
    "class_name": "XSSAPIImpl",
    "subclass_name": null,
    "function_name": "getValidMultiLineComment(String comment, String defaultComment)",
    "function_body": "{\n        if (comment != null && !comment.contains(\"*/\")) {\n            return comment;\n        }\n        return defaultComment;\n    }"
  },
  {
    "id": 22,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 12,
    "human_patch": "https://github.com/apache/sling/commit/7d2365a248943071a44d8495655186e4f14ea294",
    "cve_id": "CVE-2016-5394",
    "cwe_id": "CWE-79",
    "filename": "bundles/extensions/xss/src/main/java/org/apache/sling/xss/impl/XSSAPIImpl.java",
    "is_vulnerable": 0,
    "class_name": "XSSAPIImpl",
    "subclass_name": null,
    "function_name": "getValidJSON(String json, String defaultJson)",
    "function_body": "{\n        if (json == null) {\n            return getValidJSON(defaultJson, \"\");\n        }\n        json = json.trim();\n        if (\"\".equals(json)) {\n            return \"\";\n        }\n        int curlyIx = json.indexOf(\"{\");\n        int straightIx = json.indexOf(\"[\");\n        if (curlyIx >= 0 && (curlyIx < straightIx || straightIx < 0)) {\n            try {\n                JSONObject obj = new JSONObject(json);\n                return obj.toString();\n            } catch (JSONException e) {\n                LOGGER.debug(\"JSON validation failed: \" + e.getMessage(), e);\n            }\n        } else {\n            try {\n                JSONArray arr = new JSONArray(json);\n                return arr.toString();\n            } catch (JSONException e) {\n                LOGGER.debug(\"JSON validation failed: \" + e.getMessage(), e);\n            }\n        }\n        return getValidJSON(defaultJson, \"\");\n    }"
  },
  {
    "id": 22,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 13,
    "human_patch": "https://github.com/apache/sling/commit/7d2365a248943071a44d8495655186e4f14ea294",
    "cve_id": "CVE-2016-5394",
    "cwe_id": "CWE-79",
    "filename": "bundles/extensions/xss/src/main/java/org/apache/sling/xss/impl/XSSAPIImpl.java",
    "is_vulnerable": 0,
    "class_name": "XSSAPIImpl",
    "subclass_name": null,
    "function_name": "getValidXML(String xml, String defaultXml)",
    "function_body": "{\n        if (xml == null) {\n            return getValidXML(defaultXml, \"\");\n        }\n        xml = xml.trim();\n        if (\"\".equals(xml)) {\n            return \"\";\n        }\n\n        try {\n            SAXParser parser = factory.newSAXParser();\n            XMLReader reader = parser.getXMLReader();\n            reader.parse(new InputSource(new StringReader(xml)));\n            return xml;\n        } catch (Exception e) {\n            LOGGER.debug(\"XML validation failed: \" + e.getMessage(), e);\n        }\n        return getValidXML(defaultXml, \"\");\n    }"
  },
  {
    "id": 22,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 14,
    "human_patch": "https://github.com/apache/sling/commit/7d2365a248943071a44d8495655186e4f14ea294",
    "cve_id": "CVE-2016-5394",
    "cwe_id": "CWE-79",
    "filename": "bundles/extensions/xss/src/main/java/org/apache/sling/xss/impl/XSSAPIImpl.java",
    "is_vulnerable": 0,
    "class_name": "XSSAPIImpl",
    "subclass_name": null,
    "function_name": "encodeForHTML(String source)",
    "function_body": "{\n        return source == null ? null : Encode.forHtml(source);\n    }"
  },
  {
    "id": 22,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 15,
    "human_patch": "https://github.com/apache/sling/commit/7d2365a248943071a44d8495655186e4f14ea294",
    "cve_id": "CVE-2016-5394",
    "cwe_id": "CWE-79",
    "filename": "bundles/extensions/xss/src/main/java/org/apache/sling/xss/impl/XSSAPIImpl.java",
    "is_vulnerable": 0,
    "class_name": "XSSAPIImpl",
    "subclass_name": null,
    "function_name": "encodeForHTMLAttr(String source)",
    "function_body": "{\n        return source == null ? null : Encode.forHtmlAttribute(source);\n    }"
  },
  {
    "id": 22,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 16,
    "human_patch": "https://github.com/apache/sling/commit/7d2365a248943071a44d8495655186e4f14ea294",
    "cve_id": "CVE-2016-5394",
    "cwe_id": "CWE-79",
    "filename": "bundles/extensions/xss/src/main/java/org/apache/sling/xss/impl/XSSAPIImpl.java",
    "is_vulnerable": 0,
    "class_name": "XSSAPIImpl",
    "subclass_name": null,
    "function_name": "encodeForXML(String source)",
    "function_body": "{\n        return source == null ? null : Encode.forXml(source);\n    }"
  },
  {
    "id": 22,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 17,
    "human_patch": "https://github.com/apache/sling/commit/7d2365a248943071a44d8495655186e4f14ea294",
    "cve_id": "CVE-2016-5394",
    "cwe_id": "CWE-79",
    "filename": "bundles/extensions/xss/src/main/java/org/apache/sling/xss/impl/XSSAPIImpl.java",
    "is_vulnerable": 0,
    "class_name": "XSSAPIImpl",
    "subclass_name": null,
    "function_name": "encodeForXMLAttr(String source)",
    "function_body": "{\n        return source == null ? null : Encode.forXmlAttribute(source);\n    }"
  },
  {
    "id": 22,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 18,
    "human_patch": "https://github.com/apache/sling/commit/7d2365a248943071a44d8495655186e4f14ea294",
    "cve_id": "CVE-2016-5394",
    "cwe_id": "CWE-79",
    "filename": "bundles/extensions/xss/src/main/java/org/apache/sling/xss/impl/XSSAPIImpl.java",
    "is_vulnerable": 1,
    "class_name": "XSSAPIImpl",
    "subclass_name": null,
    "function_name": "encodeForJSString(String source)",
    "function_body": "{\n        return source == null ? null : Encode.forJavaScriptSource(source);\n    }"
  },
  {
    "id": 22,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 19,
    "human_patch": "https://github.com/apache/sling/commit/7d2365a248943071a44d8495655186e4f14ea294",
    "cve_id": "CVE-2016-5394",
    "cwe_id": "CWE-79",
    "filename": "bundles/extensions/xss/src/main/java/org/apache/sling/xss/impl/XSSAPIImpl.java",
    "is_vulnerable": 0,
    "class_name": "XSSAPIImpl",
    "subclass_name": null,
    "function_name": "encodeForCSSString(String source)",
    "function_body": "{\n        return source == null ? null : Encode.forCssString(source);\n    }"
  },
  {
    "id": 22,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 20,
    "human_patch": "https://github.com/apache/sling/commit/7d2365a248943071a44d8495655186e4f14ea294",
    "cve_id": "CVE-2016-5394",
    "cwe_id": "CWE-79",
    "filename": "bundles/extensions/xss/src/main/java/org/apache/sling/xss/impl/XSSAPIImpl.java",
    "is_vulnerable": 0,
    "class_name": "XSSAPIImpl",
    "subclass_name": null,
    "function_name": "filterHTML(String source)",
    "function_body": "{\n        return xssFilter.filter(ProtectionContext.HTML_HTML_CONTENT, source);\n    }"
  },
  {
    "id": 22,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 21,
    "human_patch": "https://github.com/apache/sling/commit/7d2365a248943071a44d8495655186e4f14ea294",
    "cve_id": "CVE-2016-5394",
    "cwe_id": "CWE-79",
    "filename": "bundles/extensions/xss/src/main/java/org/apache/sling/xss/impl/XSSAPIImpl.java",
    "is_vulnerable": 0,
    "class_name": "XSSAPIImpl",
    "subclass_name": null,
    "function_name": "getRequestSpecificAPI(final SlingHttpServletRequest request)",
    "function_body": "{\n        return this;\n    }"
  },
  {
    "id": 22,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 22,
    "human_patch": "https://github.com/apache/sling/commit/7d2365a248943071a44d8495655186e4f14ea294",
    "cve_id": "CVE-2016-5394",
    "cwe_id": "CWE-79",
    "filename": "bundles/extensions/xss/src/main/java/org/apache/sling/xss/impl/XSSAPIImpl.java",
    "is_vulnerable": 0,
    "class_name": "XSSAPIImpl",
    "subclass_name": null,
    "function_name": "getResourceResolverSpecificAPI(final ResourceResolver resourceResolver)",
    "function_body": "{\n        return this;\n    }"
  },
  {
    "id": 22,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 0,
    "human_patch": "https://github.com/apache/sling/commit/7d2365a248943071a44d8495655186e4f14ea294",
    "cve_id": "CVE-2016-5394",
    "cwe_id": "CWE-79",
    "filename": "bundles/extensions/xss/src/test/java/org/apache/sling/xss/impl/XSSAPIImplTest.java",
    "is_vulnerable": 0,
    "class_name": "XSSAPIImplTest",
    "subclass_name": null,
    "function_name": "setup()",
    "function_body": "{\n        try {\n            XSSFilterImpl xssFilter = new XSSFilterImpl();\n            setDefaultHandler(xssFilter, \"./src/main/resources/SLING-INF/content/config.xml\");\n\n            xssAPI = new XSSAPIImpl();\n            Whitebox.invokeMethod(xssAPI, \"activate\");\n            Field filterField = XSSAPIImpl.class.getDeclaredField(\"xssFilter\");\n            filterField.setAccessible(true);\n            filterField.set(xssAPI, xssFilter);\n\n            ResourceResolver mockResolver = mock(ResourceResolver.class);\n            when(mockResolver.map(anyString())).thenAnswer(new Answer() {\n                public Object answer(InvocationOnMock invocation) {\n                    Object[] args = invocation.getArguments();\n                    String url = (String) args[0];\n                    return url.replaceAll(\"jcr:\", \"_jcr_\");\n                }\n            });\n\n            SlingHttpServletRequest mockRequest = mock(SlingHttpServletRequest.class);\n            when(mockRequest.getResourceResolver()).thenReturn(mockResolver);\n\n            xssAPI = xssAPI.getRequestSpecificAPI(mockRequest);\n        } catch (Exception e) {\n            e.printStackTrace();\n        }\n    }"
  },
  {
    "id": 22,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 1,
    "human_patch": "https://github.com/apache/sling/commit/7d2365a248943071a44d8495655186e4f14ea294",
    "cve_id": "CVE-2016-5394",
    "cwe_id": "CWE-79",
    "filename": "bundles/extensions/xss/src/test/java/org/apache/sling/xss/impl/XSSAPIImplTest.java",
    "is_vulnerable": 0,
    "class_name": "XSSAPIImplTest",
    "subclass_name": null,
    "function_name": "answer(InvocationOnMock invocation)",
    "function_body": "{\n                    Object[] args = invocation.getArguments();\n                    String url = (String) args[0];\n                    return url.replaceAll(\"jcr:\", \"_jcr_\");\n                }"
  },
  {
    "id": 22,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 2,
    "human_patch": "https://github.com/apache/sling/commit/7d2365a248943071a44d8495655186e4f14ea294",
    "cve_id": "CVE-2016-5394",
    "cwe_id": "CWE-79",
    "filename": "bundles/extensions/xss/src/test/java/org/apache/sling/xss/impl/XSSAPIImplTest.java",
    "is_vulnerable": 0,
    "class_name": "XSSAPIImplTest",
    "subclass_name": null,
    "function_name": "setDefaultHandler(XSSFilterImpl xssFilter, String filename) throws Exception",
    "function_body": "{\n        InputStream policyStream = new FileInputStream(filename);\n        Policy policy = Policy.getInstance(policyStream);\n        AntiSamy antiSamy = new AntiSamy(policy);\n\n        PolicyHandler mockPolicyHandler = mock(PolicyHandler.class);\n        when(mockPolicyHandler.getPolicy()).thenReturn(policy);\n        when(mockPolicyHandler.getAntiSamy()).thenReturn(antiSamy);\n\n        Whitebox.invokeMethod(xssFilter, \"setDefaultHandler\", mockPolicyHandler);\n    }"
  },
  {
    "id": 22,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 3,
    "human_patch": "https://github.com/apache/sling/commit/7d2365a248943071a44d8495655186e4f14ea294",
    "cve_id": "CVE-2016-5394",
    "cwe_id": "CWE-79",
    "filename": "bundles/extensions/xss/src/test/java/org/apache/sling/xss/impl/XSSAPIImplTest.java",
    "is_vulnerable": 0,
    "class_name": "XSSAPIImplTest",
    "subclass_name": null,
    "function_name": "testEncodeForHTML()",
    "function_body": "{\n        String[][] testData = {\n                \n                \n                {null, null},\n                {\"simple\", \"simple\"},\n\n                {\"<script>\", \"&lt;script&gt;\"},\n                {\"<b>\", \"&lt;b&gt;\"},\n\n                {\"g\u00fcnter\", \"g\u00fcnter\"},\n                {\"\\u30e9\\u30c9\\u30af\\u30ea\\u30d5\\u3001\\u30de\\u30e9\\u30bd\\u30f3\\u4e94\\u8f2a\\u4ee3\\u8868\\u306b1\\u4e07m\\u51fa\\u5834\\u306b\\u3082\\u542b\\u307f\", \"\\u30e9\\u30c9\\u30af\\u30ea\\u30d5\\u3001\\u30de\\u30e9\\u30bd\\u30f3\\u4e94\\u8f2a\\u4ee3\\u8868\\u306b1\\u4e07m\\u51fa\\u5834\\u306b\\u3082\\u542b\\u307f\"}\n        };\n\n        for (String[] aTestData : testData) {\n            String source = aTestData[0];\n            String expected = aTestData[1];\n\n            TestCase.assertEquals(\"HTML Encoding '\" + source + \"'\", expected, xssAPI.encodeForHTML(source));\n        }\n    }\n\n"
  },
  {
    "id": 22,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 4,
    "human_patch": "https://github.com/apache/sling/commit/7d2365a248943071a44d8495655186e4f14ea294",
    "cve_id": "CVE-2016-5394",
    "cwe_id": "CWE-79",
    "filename": "bundles/extensions/xss/src/test/java/org/apache/sling/xss/impl/XSSAPIImplTest.java",
    "is_vulnerable": 0,
    "class_name": "XSSAPIImplTest",
    "subclass_name": null,
    "function_name": "stEncodeForHTMLAttr() {",
    "function_body": "        String[][] testData = {\n                \n                \n                {null, null},\n                {\"simple\", \"simple\"},\n\n                {\"<script>\", \"&lt;script>\"},\n                {\"\\\" <script>alert('pwned');</script>\", \"&#34; &lt;script>alert(&#39;pwned&#39;);&lt;/script>\"},\n                {\"g\u00fcnter\", \"g\u00fcnter\"},\n                {\"\\u30e9\\u30c9\\u30af\\u30ea\\u30d5\\u3001\\u30de\\u30e9\\u30bd\\u30f3\\u4e94\\u8f2a\\u4ee3\\u8868\\u306b1\\u4e07m\\u51fa\\u5834\\u306b\\u3082\\u542b\\u307f\", \"\\u30e9\\u30c9\\u30af\\u30ea\\u30d5\\u3001\\u30de\\u30e9\\u30bd\\u30f3\\u4e94\\u8f2a\\u4ee3\\u8868\\u306b1\\u4e07m\\u51fa\\u5834\\u306b\\u3082\\u542b\\u307f\"}\n        };\n\n        for (String[] aTestData : testData) {\n            String source = aTestData[0];\n            String expected = aTestData[1];\n\n            TestCase.assertEquals(\"HTML Encoding '\" + source + \"'\", expected, xssAPI.encodeForHTMLAttr(source));\n        }\n    }\n\n  "
  },
  {
    "id": 22,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 5,
    "human_patch": "https://github.com/apache/sling/commit/7d2365a248943071a44d8495655186e4f14ea294",
    "cve_id": "CVE-2016-5394",
    "cwe_id": "CWE-79",
    "filename": "bundles/extensions/xss/src/test/java/org/apache/sling/xss/impl/XSSAPIImplTest.java",
    "is_vulnerable": 0,
    "class_name": "XSSAPIImplTest",
    "subclass_name": null,
    "function_name": "EncodeForXML() {\n ",
    "function_body": "      String[][] testData = {\n                \n                \n                {null, null},\n                {\"simple\", \"simple\"},\n\n                {\"<script>\", \"&lt;script&gt;\"},\n                {\"<b>\", \"&lt;b&gt;\"},\n\n                {\"g\u00fcnter\", \"g\u00fcnter\"}\n        };\n\n        for (String[] aTestData : testData) {\n            String source = aTestData[0];\n            String expected = aTestData[1];\n\n            TestCase.assertEquals(\"XML Encoding '\" + source + \"'\", expected, xssAPI.encodeForXML(source));\n        }\n    }\n\n    "
  },
  {
    "id": 22,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 6,
    "human_patch": "https://github.com/apache/sling/commit/7d2365a248943071a44d8495655186e4f14ea294",
    "cve_id": "CVE-2016-5394",
    "cwe_id": "CWE-79",
    "filename": "bundles/extensions/xss/src/test/java/org/apache/sling/xss/impl/XSSAPIImplTest.java",
    "is_vulnerable": 0,
    "class_name": "XSSAPIImplTest",
    "subclass_name": null,
    "function_name": "codeForXMLAttr() {\n   ",
    "function_body": "    String[][] testData = {\n                \n                \n                {null, null},\n                {\"simple\", \"simple\"},\n\n                {\"<script>\", \"&lt;script>\"},\n                {\"<b>\", \"&lt;b>\"},\n\n                {\"g\u00fcnter\", \"g\u00fcnter\"},\n                {\"\\\"xss:expression(alert('XSS'))\", \"&#34;xss:expression(alert(&#39;XSS&#39;))\"}\n        };\n\n        for (String[] aTestData : testData) {\n            String source = aTestData[0];\n            String expected = aTestData[1];\n\n            TestCase.assertEquals(\"XML Encoding '\" + source + \"'\", expected, xssAPI.encodeForXMLAttr(source));\n        }\n    }\n\n    @T"
  },
  {
    "id": 22,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 7,
    "human_patch": "https://github.com/apache/sling/commit/7d2365a248943071a44d8495655186e4f14ea294",
    "cve_id": "CVE-2016-5394",
    "cwe_id": "CWE-79",
    "filename": "bundles/extensions/xss/src/test/java/org/apache/sling/xss/impl/XSSAPIImplTest.java",
    "is_vulnerable": 0,
    "class_name": "XSSAPIImplTest",
    "subclass_name": null,
    "function_name": "erHTML() {\n     ",
    "function_body": "  String[][] testData = {\n                \n                {null, \"\"},\n                {\"\", \"\"},\n                {\"simple\", \"simple\"},\n\n                {\"<script>ugly</script>\", \"\"},\n                {\"<b>wow!</b>\", \"<b>wow!</b>\"},\n\n                {\"<p onmouseover='ugly'>nice</p>\", \"<p>nice</p>\"},\n\n                {\"<img src='javascript:ugly'/>\", \"\"},\n                {\"<img src='nice.jpg'/>\", \"<img src=\\\"nice.jpg\\\" />\"},\n\n                {\"<ul><li>1</li><li>2</li></ul>\", \"<ul><li>1</li><li>2</li></ul>\"},\n\n                {\"g\u00fcnter\", \"g\u00fcnter\"},\n\n\n                {\"<strike>strike</strike>\", \"<strike>strike</strike>\"},\n                {\"<s>s</s>\", \"<s>s</s>\"},\n\n                {\"<a href=\\\"\\\">empty href</a>\", \"<a href=\\\"\\\">empty href</a>\"}\n        };\n\n        for (String[] aTestData : testData) {\n            String source = aTestData[0];\n            String expected = aTestData[1];\n\n            TestCase.assertEquals(\"Filtering '\" + source + \"'\", expected, xssAPI.filterHTML(source));\n        }\n    }\n\n    @Tes"
  },
  {
    "id": 22,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 8,
    "human_patch": "https://github.com/apache/sling/commit/7d2365a248943071a44d8495655186e4f14ea294",
    "cve_id": "CVE-2016-5394",
    "cwe_id": "CWE-79",
    "filename": "bundles/extensions/xss/src/test/java/org/apache/sling/xss/impl/XSSAPIImplTest.java",
    "is_vulnerable": 0,
    "class_name": "XSSAPIImplTest",
    "subclass_name": null,
    "function_name": "idHref() {\n       ",
    "function_body": "String[][] testData = {\n                \n                \n                {null, \"\"},\n                {\"\", \"\"},\n                {\"simple\", \"simple\"},\n\n                {\"../parent\", \"../parent\"},\n                {\"repo/g\u00fcnter\", \"repo/g\u00fcnter\"},\n\n                \n                {\"my/page/jcr:content.feed\", \"my/page/_jcr_content.feed\"},\n                {\"my/jcr:content/page/jcr:content\", \"my/_jcr_content/page/_jcr_content\"},\n\n                {\"\\\" onClick=ugly\", \"%22%20onClick=ugly\"},\n                {\"javascript:ugly\", \"\"},\n                {\"http://localhost:4502\", \"http://localhost:4502\"},\n                {\"http://localhost:4502/test\", \"http://localhost:4502/test\"},\n                {\"http://localhost:4502/jcr:content/test\", \"http://localhost:4502/_jcr_content/test\"},\n                {\"http://localhost:4502/test.html?a=b&b=c\", \"http://localhost:4502/test.html?a=b&b=c\"},\n\n                \n                {\"/test/ab cd\", \"/test/ab%20cd\"},\n                {\"http://localhost:4502/test/ab cd\", \"http://localhost:4502/test/ab%20cd\"},\n                {\"/test/ab attr=c\", \"/test/ab%20attr=c\"},\n                {\"http://localhost:4502/test/ab attr=c\", \"http://localhost:4502/test/ab%20attr=c\"},\n                \n                {\"/test/ab\\\"cd\", \"/test/ab%22cd\"},\n                {\"http://localhost:4502/test/ab\\\"cd\", \"http://localhost:4502/test/ab%22cd\"},\n                \n                {\"/test/ab'cd\", \"/test/ab%27cd\"},\n                {\"http://localhost:4502/test/ab'cd\", \"http://localhost:4502/test/ab%27cd\"},\n                \n                {\"/test/ab=cd\", \"/test/ab=cd\"},\n                {\"http://localhost:4502/test/ab=cd\", \"http://localhost:4502/test/ab=cd\"},\n                \n                {\"/test/ab>cd\", \"/test/ab%3Ecd\"},\n                {\"http://localhost:4502/test/ab>cd\", \"http://localhost:4502/test/ab%3Ecd\"},\n                \n                {\"/test/ab<cd\", \"/test/ab%3Ccd\"},\n                {\"http://localhost:4502/test/ab<cd\", \"http://localhost:4502/test/ab%3Ccd\"},\n                \n                {\"/test/ab`cd\", \"/test/ab%60cd\"},\n                {\"http://localhost:4502/test/ab`cd\", \"http://localhost:4502/test/ab%60cd\"},\n                \n                {\"/test/search.html?0_tag:id=test\", \"/test/search.html?0_tag%3Aid=test\"},\n                { \n                        \"/test/jcr:content/search.html?0_tag:id=test\",\n                        \"/test/_jcr_content/search.html?0_tag%3Aid=test\"\n                },\n                { \n                        \"/test/search.html?0_tag:id=test?ing&1_tag:id=abc\",\n                        \"/test/search.html?0_tag%3Aid=test?ing&1_tag%3Aid=abc\",\n                }\n        };\n\n        for (String[] aTestData : testData) {\n            String href = aTestData[0];\n            String expected = aTestData[1];\n\n            TestCase.assertEquals(\"Requested '\" + href + \"'\", expected, xssAPI.getValidHref(href));\n        }\n    }\n\n    @Test\n"
  },
  {
    "id": 22,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 9,
    "human_patch": "https://github.com/apache/sling/commit/7d2365a248943071a44d8495655186e4f14ea294",
    "cve_id": "CVE-2016-5394",
    "cwe_id": "CWE-79",
    "filename": "bundles/extensions/xss/src/test/java/org/apache/sling/xss/impl/XSSAPIImplTest.java",
    "is_vulnerable": 0,
    "class_name": "XSSAPIImplTest",
    "subclass_name": null,
    "function_name": "HrefWithoutHrefConfig() throws Exce tion {\n        \n",
    "function_body": "       XSSFilterImpl xssFilter = Whitebox.getInternalState(xssAPI, \"xssFilter\");\n        setDefaultHandler(xssFilter, \"./src/test/resources/configWithoutHref.xml\");\n\n        Attribute hrefAttribute = Whitebox.getInternalState(xssFilter, \"hrefAttribute\");\n        Assert.assertEquals(hrefAttribute, XSSFilterImpl.DEFAULT_HREF_ATTRIBUTE);\n\n        \n        testGetValidHref();\n    }\n\n    @Test\n"
  },
  {
    "id": 22,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 10,
    "human_patch": "https://github.com/apache/sling/commit/7d2365a248943071a44d8495655186e4f14ea294",
    "cve_id": "CVE-2016-5394",
    "cwe_id": "CWE-79",
    "filename": "bundles/extensions/xss/src/test/java/org/apache/sling/xss/impl/XSSAPIImplTest.java",
    "is_vulnerable": 0,
    "class_name": "XSSAPIImplTest",
    "subclass_name": null,
    "function_name": "Integer() {\n        S",
    "function_body": "ring[][] testData = {\n                \n                \n                {null, \"123\"},\n                {\"100\", \"100\"},\n                {\"0\", \"0\"},\n\n                {\"junk\", \"123\"},\n                {\"100.5\", \"123\"},\n                {\"\", \"123\"},\n                {\"null\", \"123\"}\n        };\n\n        for (String[] aTestData : testData) {\n            String source = aTestData[0];\n            Integer expected = (aTestData[1] != null) ? new Integer(aTestData[1]) : null;\n\n            TestCase.assertEquals(\"Validating integer '\" + source + \"'\", expected, xssAPI.getValidInteger(source, 123));\n        }\n    }\n\n    @Test\n"
  },
  {
    "id": 22,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 11,
    "human_patch": "https://github.com/apache/sling/commit/7d2365a248943071a44d8495655186e4f14ea294",
    "cve_id": "CVE-2016-5394",
    "cwe_id": "CWE-79",
    "filename": "bundles/extensions/xss/src/test/java/org/apache/sling/xss/impl/XSSAPIImplTest.java",
    "is_vulnerable": 0,
    "class_name": "XSSAPIImplTest",
    "subclass_name": null,
    "function_name": "Long() {\n        S",
    "function_body": "ring[][] testData = {\n                \n                \n                {null, \"123\"},\n                {\"100\", \"100\"},\n                {\"0\", \"0\"},\n\n                {\"junk\", \"123\"},\n                {\"100.5\", \"123\"},\n                {\"\", \"123\"},\n                {\"null\", \"123\"}\n        };\n\n        for (String[] aTestData : testData) {\n            String source = aTestData[0];\n            Long expected = (aTestData[1] != null) ? new Long(aTestData[1]) : null;\n\n            TestCase.assertEquals(\"Validating long '\" + source + \"'\", expected, xssAPI.getValidLong(source, 123));\n        }\n    }\n\n    @Test\n"
  },
  {
    "id": 22,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 12,
    "human_patch": "https://github.com/apache/sling/commit/7d2365a248943071a44d8495655186e4f14ea294",
    "cve_id": "CVE-2016-5394",
    "cwe_id": "CWE-79",
    "filename": "bundles/extensions/xss/src/test/java/org/apache/sling/xss/impl/XSSAPIImplTest.java",
    "is_vulnerable": 0,
    "class_name": "XSSAPIImplTest",
    "subclass_name": null,
    "function_name": "Double() {\n        S",
    "function_body": "ring[][] testData = {\n                \n                \n                {null, \"123\"},\n                {\"100.5\", \"100.5\"},\n                {\"0\", \"0\"},\n\n                {\"junk\", \"123\"},\n                {\"\", \"123\"},\n                {\"null\", \"123\"}\n        };\n\n        for (String[] aTestData : testData) {\n            String source = aTestData[0];\n            Double expected = (aTestData[1] != null) ? new Double(aTestData[1]) : null;\n\n            TestCase.assertEquals(\"Validating double '\" + source + \"'\", expected, xssAPI.getValidDouble(source, 123));\n        }\n    }\n\n    @Test\n"
  },
  {
    "id": 22,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 13,
    "human_patch": "https://github.com/apache/sling/commit/7d2365a248943071a44d8495655186e4f14ea294",
    "cve_id": "CVE-2016-5394",
    "cwe_id": "CWE-79",
    "filename": "bundles/extensions/xss/src/test/java/org/apache/sling/xss/impl/XSSAPIImplTest.java",
    "is_vulnerable": 0,
    "class_name": "XSSAPIImplTest",
    "subclass_name": null,
    "function_name": "Dimension() {\n        S",
    "function_body": "ring[][] testData = {\n                \n                \n                {null, \"123\"},\n                {\"\", \"123\"},\n                {\"100\", \"100\"},\n                {\"0\", \"0\"},\n\n                {\"junk\", \"123\"},\n                {\"100.5\", \"123\"},\n                {\"\", \"123\"},\n                {\"null\", \"123\"},\n\n                {\"\\\"auto\\\"\", \"\\\"auto\\\"\"},\n                {\"'auto'\", \"\\\"auto\\\"\"},\n                {\"auto\", \"\\\"auto\\\"\"},\n\n                {\"autox\", \"123\"}\n        };\n\n        for (String[] aTestData : testData) {\n            String source = aTestData[0];\n            String expected = aTestData[1];\n\n            TestCase.assertEquals(\"Validating dimension '\" + source + \"'\", expected, xssAPI.getValidDimension(source, \"123\"));\n        }\n    }\n\n    @Test\n"
  },
  {
    "id": 22,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 14,
    "human_patch": "https://github.com/apache/sling/commit/7d2365a248943071a44d8495655186e4f14ea294",
    "cve_id": "CVE-2016-5394",
    "cwe_id": "CWE-79",
    "filename": "bundles/extensions/xss/src/test/java/org/apache/sling/xss/impl/XSSAPIImplTest.java",
    "is_vulnerable": 1,
    "class_name": "XSSAPIImplTest",
    "subclass_name": null,
    "function_name": "rJSString() {\n        S",
    "function_body": "ring[][] testData = {\n                \n                \n                {null, null},\n                {\"simple\", \"simple\"},\n\n                {\"break\\\"out\", \"break\\\\\\\"out\"},\n                {\"break'out\", \"break\\\\'out\"},\n                {\"'alert(document.cookie)\", \"\\\\'alert(document.cookie)\"},\n                {\"2014-04-22T10:11:24.002+01:00\", \"2014-04-22T10:11:24.002+01:00\"}\n        };\n\n        for (String[] aTestData : testData) {\n            String source = aTestData[0];\n            String expected = aTestData[1];\n\n            TestCase.assertEquals(\"Encoding '\" + source + \"'\", expected, xssAPI.encodeForJSString(source));\n        }\n    }\n\n    @Test\n"
  },
  {
    "id": 22,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 15,
    "human_patch": "https://github.com/apache/sling/commit/7d2365a248943071a44d8495655186e4f14ea294",
    "cve_id": "CVE-2016-5394",
    "cwe_id": "CWE-79",
    "filename": "bundles/extensions/xss/src/test/java/org/apache/sling/xss/impl/XSSAPIImplTest.java",
    "is_vulnerable": 1,
    "class_name": "XSSAPIImplTest",
    "subclass_name": null,
    "function_name": "JSToken() {\n        S",
    "function_body": "ring[][] testData = {\n                \n                \n                {null, RUBBISH},\n                {\"\", RUBBISH},\n                {\"simple\", \"simple\"},\n                {\"clickstreamcloud.thingy\", \"clickstreamcloud.thingy\"},\n\n                {\"break out\", RUBBISH},\n                {\"break,out\", RUBBISH},\n\n                {\"\\\"literal string\\\"\", \"\\\"literal string\\\"\"},\n                {\"'literal string'\", \"'literal string'\"},\n                {\"\\\"bad literal'\", RUBBISH},\n                {\"'literal'); junk'\", \"'literal\\\\'); junk'\"},\n\n                {\"1200\", \"1200\"},\n                {\"3.14\", \"3.14\"},\n                {\"1,200\", RUBBISH},\n                {\"1200 + 1\", RUBBISH}\n        };\n\n        for (String[] aTestData : testData) {\n            String source = aTestData[0];\n            String expected = aTestData[1];\n\n            TestCase.assertEquals(\"Validating Javascript token '\" + source + \"'\", expected, xssAPI.getValidJSToken(source, RUBBISH));\n        }\n    }\n\n    @Test\n"
  },
  {
    "id": 22,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 16,
    "human_patch": "https://github.com/apache/sling/commit/7d2365a248943071a44d8495655186e4f14ea294",
    "cve_id": "CVE-2016-5394",
    "cwe_id": "CWE-79",
    "filename": "bundles/extensions/xss/src/test/java/org/apache/sling/xss/impl/XSSAPIImplTest.java",
    "is_vulnerable": 0,
    "class_name": "XSSAPIImplTest",
    "subclass_name": null,
    "function_name": "rCSSString() {\n        S",
    "function_body": "ring[][] testData = {\n                \n                {null, null},\n                {\"test\"   , \"test\"},\n                {\"\\\\\"     , \"\\\\5c\"},\n                {\"'\"      , \"\\\\27\"},\n                {\"\\\"\"     , \"\\\\22\"}\n        };\n\n        for (String[] aTestData : testData) {\n            String source = aTestData[0];\n            String expected = aTestData[1];\n\n            String result = xssAPI.encodeForCSSString(source);\n            TestCase.assertEquals(\"Encoding '\" + source + \"'\", expected, result);\n        }\n    }\n\n    @Test\n"
  },
  {
    "id": 22,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 17,
    "human_patch": "https://github.com/apache/sling/commit/7d2365a248943071a44d8495655186e4f14ea294",
    "cve_id": "CVE-2016-5394",
    "cwe_id": "CWE-79",
    "filename": "bundles/extensions/xss/src/test/java/org/apache/sling/xss/impl/XSSAPIImplTest.java",
    "is_vulnerable": 0,
    "class_name": "XSSAPIImplTest",
    "subclass_name": null,
    "function_name": "StyleToken() {\n        S",
    "function_body": "ring[][] testData = {\n                \n                {null                               , RUBBISH},\n                {\"\"                                 , RUBBISH},\n\n                \n                {\"}\"                                , RUBBISH},\n\n                \n                {\"br\\neak\"                          , RUBBISH},\n\n                \n                {\"javascript:alert(1)\"              , RUBBISH},\n                {\"'javascript:alert(1)'\"            , RUBBISH},\n                {\"\\\"javascript:alert('XSS')\\\"\"      , RUBBISH},\n                {\"url(javascript:alert(1))\"         , RUBBISH},\n                {\"url('javascript:alert(1)')\"       , RUBBISH},\n                {\"url(\\\"javascript:alert('XSS')\\\")\" , RUBBISH},\n\n                \n                {\"expression(alert(1))\"             , RUBBISH},\n                {\"expression  (alert(1))\"           , RUBBISH},\n                {\"expression(this.location='a.co')\" , RUBBISH},\n\n                \n                {\"</style><script>alert(1)</script>\", RUBBISH},\n\n                \n                {\"background-color\"                 , \"background-color\"},\n                {\"-moz-box-sizing\"                  , \"-moz-box-sizing\"},\n                {\".42%\"                             , \".42%\"},\n                {\"#fff\"                             , \"#fff\"},\n\n                \n                {\"'literal string'\"                 , \"'literal string'\"},\n                {\"\\\"literal string\\\"\"               , \"\\\"literal string\\\"\"},\n                {\"'it\\\\'s here'\"                    , \"'it\\\\'s here'\"},\n                {\"\\\"it\\\\\\\"s here\\\"\"                 , \"\\\"it\\\\\\\"s here\\\"\"},\n\n                \n                {\"\\\"bad string\"                     , RUBBISH},\n                {\"'it's here'\"                      , RUBBISH},\n                {\"\\\"it\\\"s here\\\"\"                   , RUBBISH},\n\n                \n                {\"rgb(255, 255, 255)\"               , \"rgb(255, 255, 255)\"},\n\n                \n                {\"rgb(255, 255, 255\"               , RUBBISH},\n                {\"255, 255, 255)\"                  , RUBBISH},\n\n                \n                {\"url(http://example.com/test.png)\", \"url(http://example.com/test.png)\"},\n                {\"url('image/test.png')\"           , \"url('image/test.png')\"},\n\n                \n                {\"color: red\"                      , RUBBISH}\n        };\n\n        for (String[] aTestData : testData) {\n            String source = aTestData[0];\n            String expected = aTestData[1];\n\n            String result = xssAPI.getValidStyleToken(source, RUBBISH);\n            if (!result.equals(expected)) {\n                fail(\"Validating style token '\" + source + \"', expecting '\" + expected + \"', but got '\" + result + \"'\");\n            }\n        }\n    }\n\n    @Test\n"
  },
  {
    "id": 22,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 18,
    "human_patch": "https://github.com/apache/sling/commit/7d2365a248943071a44d8495655186e4f14ea294",
    "cve_id": "CVE-2016-5394",
    "cwe_id": "CWE-79",
    "filename": "bundles/extensions/xss/src/test/java/org/apache/sling/xss/impl/XSSAPIImplTest.java",
    "is_vulnerable": 0,
    "class_name": "XSSAPIImplTest",
    "subclass_name": null,
    "function_name": "CSSColor() {\n        S",
    "function_body": "ring[][] testData = {\n                \n                \n                {null, RUBBISH},\n                {\"\", RUBBISH},\n\n                {\"rgb(0,+0,-0)\", \"rgb(0,+0,-0)\"},\n                {\"rgba ( 0\\f%, 0%,\\t0%,\\n100%\\r)\", \"rgba ( 0\\f%, 0%,\\t0%,\\n100%\\r)\",},\n\n                {\"#ddd\", \"#ddd\"},\n                {\"#eeeeee\", \"#eeeeee\",},\n\n                {\"hsl(0,1,2)\", \"hsl(0,1,2)\"},\n                {\"hsla(0,1,2,3)\", \"hsla(0,1,2,3)\"},\n                {\"currentColor\", \"currentColor\"},\n                {\"transparent\", \"transparent\"},\n\n                {\"\\f\\r\\n\\t MenuText\\f\\r\\n\\t \", \"MenuText\"},\n                {\"expression(99,99,99)\", RUBBISH},\n                {\"blue;\", RUBBISH},\n                {\"url(99,99,99)\", RUBBISH}\n        };\n\n        for (String[] aTestData : testData) {\n            String source = aTestData[0];\n            String expected = aTestData[1];\n\n            String result = xssAPI.getValidCSSColor(source, RUBBISH);\n            if (!result.equals(expected)) {\n                fail(\"Validating CSS Color '\" + source + \"', expecting '\" + expected + \"', but got '\" + result + \"'\");\n            }\n        }\n    }\n\n    @Test\n"
  },
  {
    "id": 22,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 19,
    "human_patch": "https://github.com/apache/sling/commit/7d2365a248943071a44d8495655186e4f14ea294",
    "cve_id": "CVE-2016-5394",
    "cwe_id": "CWE-79",
    "filename": "bundles/extensions/xss/src/test/java/org/apache/sling/xss/impl/XSSAPIImplTest.java",
    "is_vulnerable": 0,
    "class_name": "XSSAPIImplTest",
    "subclass_name": null,
    "function_name": "MultiLineComment() {\n        S",
    "function_body": "ring[][] testData = {\n                \n\n                {null               , RUBBISH},\n                {\"blah */ hack\"     , RUBBISH},\n\n                {\"Valid comment\"    , \"Valid comment\"}\n        };\n        for (String[] aTestData : testData) {\n            String source = aTestData[0];\n            String expected = aTestData[1];\n\n            String result = xssAPI.getValidMultiLineComment(source, RUBBISH);\n            if (!result.equals(expected)) {\n                fail(\"Validating multiline comment '\" + source + \"', expecting '\" + expected + \"', but got '\" + result + \"'\");\n            }\n        }\n    }\n\n    @Test\n"
  },
  {
    "id": 22,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 20,
    "human_patch": "https://github.com/apache/sling/commit/7d2365a248943071a44d8495655186e4f14ea294",
    "cve_id": "CVE-2016-5394",
    "cwe_id": "CWE-79",
    "filename": "bundles/extensions/xss/src/test/java/org/apache/sling/xss/impl/XSSAPIImplTest.java",
    "is_vulnerable": 0,
    "class_name": "XSSAPIImplTest",
    "subclass_name": null,
    "function_name": "JSON() {\n        S",
    "function_body": "ring[][] testData = {\n                {null,      RUBBISH_JSON},\n                {\"\",        \"\"},\n                {\"1]\",      RUBBISH_JSON},\n                {\"{}\",      \"{}\"},\n                {\"{1}\",     RUBBISH_JSON},\n                {\n                        \"{test: 'test'}\",\n                        \"{\\\"test\\\":\\\"test\\\"}\"\n                },\n                {\n                        \"{test:\\\"test}\",\n                        RUBBISH_JSON\n                },\n                {\n                        \"{test1:'test1', test2: {test21: 'test21', test22: 'test22'}}\",\n                        \"{\\\"test1\\\":\\\"test1\\\",\\\"test2\\\":{\\\"test21\\\":\\\"test21\\\",\\\"test22\\\":\\\"test22\\\"}}\"\n                },\n                {\"[]\",      \"[]\"},\n                {\"[1,2]\",   \"[1,2]\"},\n                {\"[1\",      RUBBISH_JSON},\n                {\n                        \"[{test: 'test'}]\",\n                        \"[{\\\"test\\\":\\\"test\\\"}]\"\n                }\n        };\n        for (String[] aTestData : testData) {\n            String source = aTestData[0];\n            String expected = aTestData[1];\n\n            String result = xssAPI.getValidJSON(source, RUBBISH_JSON);\n            if (!result.equals(expected)) {\n                fail(\"Validating JSON '\" + source + \"', expecting '\" + expected + \"', but got '\" + result + \"'\");\n            }\n        }\n    }\n\n    @Test\n"
  },
  {
    "id": 22,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 21,
    "human_patch": "https://github.com/apache/sling/commit/7d2365a248943071a44d8495655186e4f14ea294",
    "cve_id": "CVE-2016-5394",
    "cwe_id": "CWE-79",
    "filename": "bundles/extensions/xss/src/test/java/org/apache/sling/xss/impl/XSSAPIImplTest.java",
    "is_vulnerable": 0,
    "class_name": "XSSAPIImplTest",
    "subclass_name": null,
    "function_name": "XML() {\n        S",
    "function_body": "ring[][] testData = {\n                {null,      RUBBISH_XML},\n                {\"\",        \"\"},\n                {\n                        \"<t/>\",\n                        \"<t/>\"\n                },\n                {\n                        \"<t>\",\n                        RUBBISH_XML\n                },\n                {\n                        \"<t>test</t>\",\n                        \"<t>test</t>\"\n                },\n                {\n                        \"<t>test\",\n                        RUBBISH_XML\n                },\n                {\n                        \"<t t=\\\"t\\\">test</t>\",\n                        \"<t t=\\\"t\\\">test</t>\"\n                },\n                {\n                        \"<t t=\\\"t>test</t>\",\n                        RUBBISH_XML\n                },\n                {\n                        \"<t><w>xyz</w></t>\",\n                        \"<t><w>xyz</w></t>\"\n                },\n                {\n                        \"<t><w>xyz</t></w>\",\n                        RUBBISH_XML\n                }\n        };\n        for (String[] aTestData : testData) {\n            String source = aTestData[0];\n            String expected = aTestData[1];\n\n            String result = xssAPI.getValidXML(source, RUBBISH_XML);\n            if (!result.equals(expected)) {\n                fail(\"Validating XML '\" + source + \"', expecting '\" + expected + \"', but got '\" + result + \"'\");\n            }\n        }\n    }\n}\n"
  },
  {
    "id": 23,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 0,
    "human_patch": "https://github.com/apache/sling/commit/fb2719e8299fadddae62245482de112052a0e08c",
    "cve_id": "CVE-2016-6798",
    "cwe_id": "CWE-611",
    "filename": "bundles/extensions/xss/src/main/java/org/apache/sling/xss/impl/XSSAPIImpl.java",
    "is_vulnerable": 1,
    "class_name": "XSSAPIImpl",
    "subclass_name": null,
    "function_name": "activate()",
    "function_body": "{\n        factory = SAXParserFactory.newInstance();\n        factory.setValidating(false);\n        factory.setNamespaceAware(true);\n    }"
  },
  {
    "id": 23,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 1,
    "human_patch": "https://github.com/apache/sling/commit/fb2719e8299fadddae62245482de112052a0e08c",
    "cve_id": "CVE-2016-6798",
    "cwe_id": "CWE-611",
    "filename": "bundles/extensions/xss/src/main/java/org/apache/sling/xss/impl/XSSAPIImpl.java",
    "is_vulnerable": 0,
    "class_name": "XSSAPIImpl",
    "subclass_name": null,
    "function_name": "deactivate()",
    "function_body": "{\n        factory = null;\n    }"
  },
  {
    "id": 23,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 2,
    "human_patch": "https://github.com/apache/sling/commit/fb2719e8299fadddae62245482de112052a0e08c",
    "cve_id": "CVE-2016-6798",
    "cwe_id": "CWE-611",
    "filename": "bundles/extensions/xss/src/main/java/org/apache/sling/xss/impl/XSSAPIImpl.java",
    "is_vulnerable": 0,
    "class_name": "XSSAPIImpl",
    "subclass_name": null,
    "function_name": "getValidInteger(String integer, int defaultValue)",
    "function_body": "{\n        if (integer != null && integer.length() > 0) {\n            try {\n                return validator.getValidInteger(\"XSS\", integer, -2000000000, 2000000000, false);\n            } catch (Exception e) {\n                \n            }\n        }\n\n        \n        return defaultValue;\n    }"
  },
  {
    "id": 23,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 3,
    "human_patch": "https://github.com/apache/sling/commit/fb2719e8299fadddae62245482de112052a0e08c",
    "cve_id": "CVE-2016-6798",
    "cwe_id": "CWE-611",
    "filename": "bundles/extensions/xss/src/main/java/org/apache/sling/xss/impl/XSSAPIImpl.java",
    "is_vulnerable": 0,
    "class_name": "XSSAPIImpl",
    "subclass_name": null,
    "function_name": "getValidLong(String source, long defaultValue)",
    "function_body": "{\n        if (source != null && source.length() > 0) {\n            try {\n                LongValidationRule ivr = new LongValidationRule( \"number\", ESAPI.encoder(), -9000000000000000000L, 9000000000000000000L );\n                ivr.setAllowNull(false);\n                return ivr.getValid(\"XSS\", source);\n            } catch (Exception e) {\n                \n            }\n        }\n\n        \n        return defaultValue;\n    }"
  },
  {
    "id": 23,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 4,
    "human_patch": "https://github.com/apache/sling/commit/fb2719e8299fadddae62245482de112052a0e08c",
    "cve_id": "CVE-2016-6798",
    "cwe_id": "CWE-611",
    "filename": "bundles/extensions/xss/src/main/java/org/apache/sling/xss/impl/XSSAPIImpl.java",
    "is_vulnerable": 0,
    "class_name": "XSSAPIImpl",
    "subclass_name": null,
    "function_name": "getValidDouble(String source, double defaultValue)",
    "function_body": "{\n        if (source != null && source.length() > 0) {\n            try {\n                return validator.getValidDouble(\"XSS\", source, 0d, Double.MAX_VALUE, false);\n            } catch (Exception e) {\n                \n            }\n        }\n\n        \n        return defaultValue;\n    }"
  },
  {
    "id": 23,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 5,
    "human_patch": "https://github.com/apache/sling/commit/fb2719e8299fadddae62245482de112052a0e08c",
    "cve_id": "CVE-2016-6798",
    "cwe_id": "CWE-611",
    "filename": "bundles/extensions/xss/src/main/java/org/apache/sling/xss/impl/XSSAPIImpl.java",
    "is_vulnerable": 0,
    "class_name": "XSSAPIImpl",
    "subclass_name": null,
    "function_name": "getValidDimension(String dimension, String defaultValue)",
    "function_body": "{\n        if (dimension != null && dimension.length() > 0) {\n            if (PATTERN_AUTO_DIMENSION.matcher(dimension).matches()) {\n                return \"\\\"auto\\\"\";\n            }\n\n            try {\n                return validator.getValidInteger(\"XSS\", dimension, -10000, 10000, false).toString();\n            } catch (Exception e) {\n                \n            }\n        }\n\n        \n        return defaultValue;\n    }"
  },
  {
    "id": 23,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 6,
    "human_patch": "https://github.com/apache/sling/commit/fb2719e8299fadddae62245482de112052a0e08c",
    "cve_id": "CVE-2016-6798",
    "cwe_id": "CWE-611",
    "filename": "bundles/extensions/xss/src/main/java/org/apache/sling/xss/impl/XSSAPIImpl.java",
    "is_vulnerable": 0,
    "class_name": "XSSAPIImpl",
    "subclass_name": null,
    "function_name": "mangleNamespaces(String absPath)",
    "function_body": "{\n        if (absPath != null) {\n            \n            final int schemeIndex = absPath.indexOf(SCHEME_PATTERN);\n            final String manglePath;\n            final String prefix;\n            if (schemeIndex != -1) {\n                final int pathIndex = absPath.indexOf(\"/\", schemeIndex + 3);\n                if (pathIndex != -1) {\n                    prefix = absPath.substring(0, pathIndex);\n                    manglePath = absPath.substring(pathIndex);\n                } else {\n                    prefix = absPath;\n                    manglePath = \"\";\n                }\n            } else {\n                prefix = \"\";\n                manglePath = absPath;\n            }\n            if (manglePath.contains(MANGLE_NAMESPACE_OUT_SUFFIX)) {\n                final Matcher m = MANGLE_NAMESPACE_PATTERN.matcher(manglePath);\n\n                final StringBuffer buf = new StringBuffer();\n                while (m.find()) {\n                    final String replacement = MANGLE_NAMESPACE_IN_PREFIX + m.group(1) + MANGLE_NAMESPACE_IN_SUFFIX;\n                    m.appendReplacement(buf, replacement);\n                }\n\n                m.appendTail(buf);\n\n                absPath = prefix + buf.toString();\n\n            }\n        }\n\n        return absPath;\n    }"
  },
  {
    "id": 23,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 7,
    "human_patch": "https://github.com/apache/sling/commit/fb2719e8299fadddae62245482de112052a0e08c",
    "cve_id": "CVE-2016-6798",
    "cwe_id": "CWE-611",
    "filename": "bundles/extensions/xss/src/main/java/org/apache/sling/xss/impl/XSSAPIImpl.java",
    "is_vulnerable": 0,
    "class_name": "XSSAPIImpl",
    "subclass_name": null,
    "function_name": "getValidHref(final String url)",
    "function_body": "{\n        if (url != null && url.length() > 0) {\n            \n            \n            \n            String encodedUrl = url.replaceAll(\"\\\"\", \"%22\")\n                    .replaceAll(\"'\", \"%27\")\n                    .replaceAll(\">\", \"%3E\")\n                    .replaceAll(\"<\", \"%3C\")\n                    .replaceAll(\"`\", \"%60\")\n                    .replaceAll(\" \", \"%20\");\n            int qMarkIx = encodedUrl.indexOf('?');\n            if (qMarkIx > 0) {\n                encodedUrl = encodedUrl.substring(0, qMarkIx) + encodedUrl.substring(qMarkIx).replaceAll(\":\", \"%3A\");\n            }\n\n            encodedUrl = mangleNamespaces(encodedUrl);\n            if (xssFilter.isValidHref(encodedUrl)) {\n                return encodedUrl;\n            }\n        }\n\n        \n        return \"\";\n    }"
  },
  {
    "id": 23,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 8,
    "human_patch": "https://github.com/apache/sling/commit/fb2719e8299fadddae62245482de112052a0e08c",
    "cve_id": "CVE-2016-6798",
    "cwe_id": "CWE-611",
    "filename": "bundles/extensions/xss/src/main/java/org/apache/sling/xss/impl/XSSAPIImpl.java",
    "is_vulnerable": 0,
    "class_name": "XSSAPIImpl",
    "subclass_name": null,
    "function_name": "getValidJSToken(String token, String defaultValue)",
    "function_body": "{\n        if (token != null && token.length() > 0) {\n            token = token.trim();\n            String q = token.substring(0, 1);\n            if (q.matches(\"['\\\"]\") && token.endsWith(q)) {\n                String literal = token.substring(1, token.length() - 1);\n                return q + encodeForJSString(literal) + q;\n            } else if (token.matches(\"[0-9a-zA-Z_$][0-9a-zA-Z_$.]*\")) {\n                return token;\n            }\n        }\n\n        \n        return defaultValue;\n    }"
  },
  {
    "id": 23,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 9,
    "human_patch": "https://github.com/apache/sling/commit/fb2719e8299fadddae62245482de112052a0e08c",
    "cve_id": "CVE-2016-6798",
    "cwe_id": "CWE-611",
    "filename": "bundles/extensions/xss/src/main/java/org/apache/sling/xss/impl/XSSAPIImpl.java",
    "is_vulnerable": 0,
    "class_name": "XSSAPIImpl",
    "subclass_name": null,
    "function_name": "getValidStyleToken(String token, String defaultValue)",
    "function_body": "{\n        if (token != null && token.length() > 0 && token.matches(CSS_TOKEN)) {\n            return token;\n        }\n\n        return defaultValue;\n   }"
  },
  {
    "id": 23,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 10,
    "human_patch": "https://github.com/apache/sling/commit/fb2719e8299fadddae62245482de112052a0e08c",
    "cve_id": "CVE-2016-6798",
    "cwe_id": "CWE-611",
    "filename": "bundles/extensions/xss/src/main/java/org/apache/sling/xss/impl/XSSAPIImpl.java",
    "is_vulnerable": 0,
    "class_name": "XSSAPIImpl",
    "subclass_name": null,
    "function_name": "getValidCSSColor(String color, String defaultColor)",
    "function_body": "{\n        if (color != null && color.length() > 0) {\n            color = color.trim();\n            \n            if (color.matches(\"(?i)[#a-fghlrs(+0-9-.%,) \\\\t\\\\n\\\\x0B\\\\f\\\\r]+\")) {\n                return color;\n            }\n            \n            if (color.matches(\"(?i)[a-zA-Z \\\\t\\\\n\\\\x0B\\\\f\\\\r]+\")) {\n                return color;\n            }\n        }\n\n        return defaultColor;\n    }"
  },
  {
    "id": 23,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 11,
    "human_patch": "https://github.com/apache/sling/commit/fb2719e8299fadddae62245482de112052a0e08c",
    "cve_id": "CVE-2016-6798",
    "cwe_id": "CWE-611",
    "filename": "bundles/extensions/xss/src/main/java/org/apache/sling/xss/impl/XSSAPIImpl.java",
    "is_vulnerable": 0,
    "class_name": "XSSAPIImpl",
    "subclass_name": null,
    "function_name": "getValidMultiLineComment(String comment, String defaultComment)",
    "function_body": "{\n        if (comment != null && !comment.contains(\"*/\")) {\n            return comment;\n        }\n        return defaultComment;\n    }"
  },
  {
    "id": 23,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 12,
    "human_patch": "https://github.com/apache/sling/commit/fb2719e8299fadddae62245482de112052a0e08c",
    "cve_id": "CVE-2016-6798",
    "cwe_id": "CWE-611",
    "filename": "bundles/extensions/xss/src/main/java/org/apache/sling/xss/impl/XSSAPIImpl.java",
    "is_vulnerable": 0,
    "class_name": "XSSAPIImpl",
    "subclass_name": null,
    "function_name": "getValidJSON(String json, String defaultJson)",
    "function_body": "{\n        if (json == null) {\n            return getValidJSON(defaultJson, \"\");\n        }\n        json = json.trim();\n        if (\"\".equals(json)) {\n            return \"\";\n        }\n        int curlyIx = json.indexOf(\"{\");\n        int straightIx = json.indexOf(\"[\");\n        if (curlyIx >= 0 && (curlyIx < straightIx || straightIx < 0)) {\n            try {\n                JSONObject obj = new JSONObject(json);\n                return obj.toString();\n            } catch (JSONException e) {\n                LOGGER.debug(\"JSON validation failed: \" + e.getMessage(), e);\n            }\n        } else {\n            try {\n                JSONArray arr = new JSONArray(json);\n                return arr.toString();\n            } catch (JSONException e) {\n                LOGGER.debug(\"JSON validation failed: \" + e.getMessage(), e);\n            }\n        }\n        return getValidJSON(defaultJson, \"\");\n    }"
  },
  {
    "id": 23,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 13,
    "human_patch": "https://github.com/apache/sling/commit/fb2719e8299fadddae62245482de112052a0e08c",
    "cve_id": "CVE-2016-6798",
    "cwe_id": "CWE-611",
    "filename": "bundles/extensions/xss/src/main/java/org/apache/sling/xss/impl/XSSAPIImpl.java",
    "is_vulnerable": 0,
    "class_name": "XSSAPIImpl",
    "subclass_name": null,
    "function_name": "getValidXML(String xml, String defaultXml)",
    "function_body": "{\n        if (xml == null) {\n            return getValidXML(defaultXml, \"\");\n        }\n        xml = xml.trim();\n        if (\"\".equals(xml)) {\n            return \"\";\n        }\n\n        try {\n            SAXParser parser = factory.newSAXParser();\n            XMLReader reader = parser.getXMLReader();\n            reader.parse(new InputSource(new StringReader(xml)));\n            return xml;\n        } catch (Exception e) {\n            LOGGER.debug(\"XML validation failed: \" + e.getMessage(), e);\n        }\n        return getValidXML(defaultXml, \"\");\n    }"
  },
  {
    "id": 23,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 14,
    "human_patch": "https://github.com/apache/sling/commit/fb2719e8299fadddae62245482de112052a0e08c",
    "cve_id": "CVE-2016-6798",
    "cwe_id": "CWE-611",
    "filename": "bundles/extensions/xss/src/main/java/org/apache/sling/xss/impl/XSSAPIImpl.java",
    "is_vulnerable": 0,
    "class_name": "XSSAPIImpl",
    "subclass_name": null,
    "function_name": "encodeForHTML(String source)",
    "function_body": "{\n        return source == null ? null : Encode.forHtml(source);\n    }"
  },
  {
    "id": 23,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 15,
    "human_patch": "https://github.com/apache/sling/commit/fb2719e8299fadddae62245482de112052a0e08c",
    "cve_id": "CVE-2016-6798",
    "cwe_id": "CWE-611",
    "filename": "bundles/extensions/xss/src/main/java/org/apache/sling/xss/impl/XSSAPIImpl.java",
    "is_vulnerable": 0,
    "class_name": "XSSAPIImpl",
    "subclass_name": null,
    "function_name": "encodeForHTMLAttr(String source)",
    "function_body": "{\n        return source == null ? null : Encode.forHtmlAttribute(source);\n    }"
  },
  {
    "id": 23,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 16,
    "human_patch": "https://github.com/apache/sling/commit/fb2719e8299fadddae62245482de112052a0e08c",
    "cve_id": "CVE-2016-6798",
    "cwe_id": "CWE-611",
    "filename": "bundles/extensions/xss/src/main/java/org/apache/sling/xss/impl/XSSAPIImpl.java",
    "is_vulnerable": 0,
    "class_name": "XSSAPIImpl",
    "subclass_name": null,
    "function_name": "encodeForXML(String source)",
    "function_body": "{\n        return source == null ? null : Encode.forXml(source);\n    }"
  },
  {
    "id": 23,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 17,
    "human_patch": "https://github.com/apache/sling/commit/fb2719e8299fadddae62245482de112052a0e08c",
    "cve_id": "CVE-2016-6798",
    "cwe_id": "CWE-611",
    "filename": "bundles/extensions/xss/src/main/java/org/apache/sling/xss/impl/XSSAPIImpl.java",
    "is_vulnerable": 0,
    "class_name": "XSSAPIImpl",
    "subclass_name": null,
    "function_name": "encodeForXMLAttr(String source)",
    "function_body": "{\n        return source == null ? null : Encode.forXmlAttribute(source);\n    }"
  },
  {
    "id": 23,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 18,
    "human_patch": "https://github.com/apache/sling/commit/fb2719e8299fadddae62245482de112052a0e08c",
    "cve_id": "CVE-2016-6798",
    "cwe_id": "CWE-611",
    "filename": "bundles/extensions/xss/src/main/java/org/apache/sling/xss/impl/XSSAPIImpl.java",
    "is_vulnerable": 0,
    "class_name": "XSSAPIImpl",
    "subclass_name": null,
    "function_name": "encodeForJSString(String source)",
    "function_body": "{\n        return source == null ? null : Encode.forJavaScript(source).replace(\"\\\\-\", \"\\\\u002D\");\n    }"
  },
  {
    "id": 23,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 19,
    "human_patch": "https://github.com/apache/sling/commit/fb2719e8299fadddae62245482de112052a0e08c",
    "cve_id": "CVE-2016-6798",
    "cwe_id": "CWE-611",
    "filename": "bundles/extensions/xss/src/main/java/org/apache/sling/xss/impl/XSSAPIImpl.java",
    "is_vulnerable": 0,
    "class_name": "XSSAPIImpl",
    "subclass_name": null,
    "function_name": "encodeForCSSString(String source)",
    "function_body": "{\n        return source == null ? null : Encode.forCssString(source);\n    }"
  },
  {
    "id": 23,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 20,
    "human_patch": "https://github.com/apache/sling/commit/fb2719e8299fadddae62245482de112052a0e08c",
    "cve_id": "CVE-2016-6798",
    "cwe_id": "CWE-611",
    "filename": "bundles/extensions/xss/src/main/java/org/apache/sling/xss/impl/XSSAPIImpl.java",
    "is_vulnerable": 0,
    "class_name": "XSSAPIImpl",
    "subclass_name": null,
    "function_name": "filterHTML(String source)",
    "function_body": "{\n        return xssFilter.filter(ProtectionContext.HTML_HTML_CONTENT, source);\n    }"
  },
  {
    "id": 23,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 21,
    "human_patch": "https://github.com/apache/sling/commit/fb2719e8299fadddae62245482de112052a0e08c",
    "cve_id": "CVE-2016-6798",
    "cwe_id": "CWE-611",
    "filename": "bundles/extensions/xss/src/main/java/org/apache/sling/xss/impl/XSSAPIImpl.java",
    "is_vulnerable": 0,
    "class_name": "XSSAPIImpl",
    "subclass_name": null,
    "function_name": "getRequestSpecificAPI(final SlingHttpServletRequest request)",
    "function_body": "{\n        return this;\n    }"
  },
  {
    "id": 23,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 22,
    "human_patch": "https://github.com/apache/sling/commit/fb2719e8299fadddae62245482de112052a0e08c",
    "cve_id": "CVE-2016-6798",
    "cwe_id": "CWE-611",
    "filename": "bundles/extensions/xss/src/main/java/org/apache/sling/xss/impl/XSSAPIImpl.java",
    "is_vulnerable": 0,
    "class_name": "XSSAPIImpl",
    "subclass_name": null,
    "function_name": "getResourceResolverSpecificAPI(final ResourceResolver resourceResolver)",
    "function_body": "{\n        return this;\n    }"
  },
  {
    "id": 23,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 0,
    "human_patch": "https://github.com/apache/sling/commit/fb2719e8299fadddae62245482de112052a0e08c",
    "cve_id": "CVE-2016-6798",
    "cwe_id": "CWE-611",
    "filename": "bundles/extensions/xss/src/test/java/org/apache/sling/xss/impl/XSSAPIImplTest.java",
    "is_vulnerable": 0,
    "class_name": "XSSAPIImplTest",
    "subclass_name": null,
    "function_name": "setup()",
    "function_body": "{\n        try {\n            XSSFilterImpl xssFilter = new XSSFilterImpl();\n            setDefaultHandler(xssFilter, \"./src/main/resources/SLING-INF/content/config.xml\");\n\n            xssAPI = new XSSAPIImpl();\n            Whitebox.invokeMethod(xssAPI, \"activate\");\n            Field filterField = XSSAPIImpl.class.getDeclaredField(\"xssFilter\");\n            filterField.setAccessible(true);\n            filterField.set(xssAPI, xssFilter);\n\n            ResourceResolver mockResolver = mock(ResourceResolver.class);\n            when(mockResolver.map(anyString())).thenAnswer(new Answer() {\n                public Object answer(InvocationOnMock invocation) {\n                    Object[] args = invocation.getArguments();\n                    String url = (String) args[0];\n                    return url.replaceAll(\"jcr:\", \"_jcr_\");\n                }\n            });\n\n            SlingHttpServletRequest mockRequest = mock(SlingHttpServletRequest.class);\n            when(mockRequest.getResourceResolver()).thenReturn(mockResolver);\n\n            xssAPI = xssAPI.getRequestSpecificAPI(mockRequest);\n        } catch (Exception e) {\n            e.printStackTrace();\n        }\n    }"
  },
  {
    "id": 23,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 1,
    "human_patch": "https://github.com/apache/sling/commit/fb2719e8299fadddae62245482de112052a0e08c",
    "cve_id": "CVE-2016-6798",
    "cwe_id": "CWE-611",
    "filename": "bundles/extensions/xss/src/test/java/org/apache/sling/xss/impl/XSSAPIImplTest.java",
    "is_vulnerable": 0,
    "class_name": "XSSAPIImplTest",
    "subclass_name": null,
    "function_name": "answer(InvocationOnMock invocation)",
    "function_body": "{\n                    Object[] args = invocation.getArguments();\n                    String url = (String) args[0];\n                    return url.replaceAll(\"jcr:\", \"_jcr_\");\n                }"
  },
  {
    "id": 23,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 2,
    "human_patch": "https://github.com/apache/sling/commit/fb2719e8299fadddae62245482de112052a0e08c",
    "cve_id": "CVE-2016-6798",
    "cwe_id": "CWE-611",
    "filename": "bundles/extensions/xss/src/test/java/org/apache/sling/xss/impl/XSSAPIImplTest.java",
    "is_vulnerable": 0,
    "class_name": "XSSAPIImplTest",
    "subclass_name": null,
    "function_name": "setDefaultHandler(XSSFilterImpl xssFilter, String filename) throws Exception",
    "function_body": "{\n        InputStream policyStream = new FileInputStream(filename);\n        Policy policy = Policy.getInstance(policyStream);\n        AntiSamy antiSamy = new AntiSamy(policy);\n\n        PolicyHandler mockPolicyHandler = mock(PolicyHandler.class);\n        when(mockPolicyHandler.getPolicy()).thenReturn(policy);\n        when(mockPolicyHandler.getAntiSamy()).thenReturn(antiSamy);\n\n        Whitebox.invokeMethod(xssFilter, \"setDefaultHandler\", mockPolicyHandler);\n    }"
  },
  {
    "id": 23,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 3,
    "human_patch": "https://github.com/apache/sling/commit/fb2719e8299fadddae62245482de112052a0e08c",
    "cve_id": "CVE-2016-6798",
    "cwe_id": "CWE-611",
    "filename": "bundles/extensions/xss/src/test/java/org/apache/sling/xss/impl/XSSAPIImplTest.java",
    "is_vulnerable": 0,
    "class_name": "XSSAPIImplTest",
    "subclass_name": null,
    "function_name": "testEncodeForHTML()",
    "function_body": "{\n        String[][] testData = {\n                \n                \n                {null, null},\n                {\"simple\", \"simple\"},\n\n                {\"<script>\", \"&lt;script&gt;\"},\n                {\"<b>\", \"&lt;b&gt;\"},\n\n                {\"g\u00fcnter\", \"g\u00fcnter\"},\n                {\"\\u30e9\\u30c9\\u30af\\u30ea\\u30d5\\u3001\\u30de\\u30e9\\u30bd\\u30f3\\u4e94\\u8f2a\\u4ee3\\u8868\\u306b1\\u4e07m\\u51fa\\u5834\\u306b\\u3082\\u542b\\u307f\", \"\\u30e9\\u30c9\\u30af\\u30ea\\u30d5\\u3001\\u30de\\u30e9\\u30bd\\u30f3\\u4e94\\u8f2a\\u4ee3\\u8868\\u306b1\\u4e07m\\u51fa\\u5834\\u306b\\u3082\\u542b\\u307f\"}\n        };\n\n        for (String[] aTestData : testData) {\n            String source = aTestData[0];\n            String expected = aTestData[1];\n\n            TestCase.assertEquals(\"HTML Encoding '\" + source + \"'\", expected, xssAPI.encodeForHTML(source));\n        }\n    }\n\n"
  },
  {
    "id": 23,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 4,
    "human_patch": "https://github.com/apache/sling/commit/fb2719e8299fadddae62245482de112052a0e08c",
    "cve_id": "CVE-2016-6798",
    "cwe_id": "CWE-611",
    "filename": "bundles/extensions/xss/src/test/java/org/apache/sling/xss/impl/XSSAPIImplTest.java",
    "is_vulnerable": 0,
    "class_name": "XSSAPIImplTest",
    "subclass_name": null,
    "function_name": "stEncodeForHTMLAttr() {",
    "function_body": "        String[][] testData = {\n                \n                \n                {null, null},\n                {\"simple\", \"simple\"},\n\n                {\"<script>\", \"&lt;script>\"},\n                {\"\\\" <script>alert('pwned');</script>\", \"&#34; &lt;script>alert(&#39;pwned&#39;);&lt;/script>\"},\n                {\"g\u00fcnter\", \"g\u00fcnter\"},\n                {\"\\u30e9\\u30c9\\u30af\\u30ea\\u30d5\\u3001\\u30de\\u30e9\\u30bd\\u30f3\\u4e94\\u8f2a\\u4ee3\\u8868\\u306b1\\u4e07m\\u51fa\\u5834\\u306b\\u3082\\u542b\\u307f\", \"\\u30e9\\u30c9\\u30af\\u30ea\\u30d5\\u3001\\u30de\\u30e9\\u30bd\\u30f3\\u4e94\\u8f2a\\u4ee3\\u8868\\u306b1\\u4e07m\\u51fa\\u5834\\u306b\\u3082\\u542b\\u307f\"}\n        };\n\n        for (String[] aTestData : testData) {\n            String source = aTestData[0];\n            String expected = aTestData[1];\n\n            TestCase.assertEquals(\"HTML Encoding '\" + source + \"'\", expected, xssAPI.encodeForHTMLAttr(source));\n        }\n    }\n\n  "
  },
  {
    "id": 23,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 5,
    "human_patch": "https://github.com/apache/sling/commit/fb2719e8299fadddae62245482de112052a0e08c",
    "cve_id": "CVE-2016-6798",
    "cwe_id": "CWE-611",
    "filename": "bundles/extensions/xss/src/test/java/org/apache/sling/xss/impl/XSSAPIImplTest.java",
    "is_vulnerable": 0,
    "class_name": "XSSAPIImplTest",
    "subclass_name": null,
    "function_name": "EncodeForXML() {\n ",
    "function_body": "      String[][] testData = {\n                \n                \n                {null, null},\n                {\"simple\", \"simple\"},\n\n                {\"<script>\", \"&lt;script&gt;\"},\n                {\"<b>\", \"&lt;b&gt;\"},\n\n                {\"g\u00fcnter\", \"g\u00fcnter\"}\n        };\n\n        for (String[] aTestData : testData) {\n            String source = aTestData[0];\n            String expected = aTestData[1];\n\n            TestCase.assertEquals(\"XML Encoding '\" + source + \"'\", expected, xssAPI.encodeForXML(source));\n        }\n    }\n\n    "
  },
  {
    "id": 23,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 6,
    "human_patch": "https://github.com/apache/sling/commit/fb2719e8299fadddae62245482de112052a0e08c",
    "cve_id": "CVE-2016-6798",
    "cwe_id": "CWE-611",
    "filename": "bundles/extensions/xss/src/test/java/org/apache/sling/xss/impl/XSSAPIImplTest.java",
    "is_vulnerable": 0,
    "class_name": "XSSAPIImplTest",
    "subclass_name": null,
    "function_name": "codeForXMLAttr() {\n   ",
    "function_body": "    String[][] testData = {\n                \n                \n                {null, null},\n                {\"simple\", \"simple\"},\n\n                {\"<script>\", \"&lt;script>\"},\n                {\"<b>\", \"&lt;b>\"},\n\n                {\"g\u00fcnter\", \"g\u00fcnter\"},\n                {\"\\\"xss:expression(alert('XSS'))\", \"&#34;xss:expression(alert(&#39;XSS&#39;))\"}\n        };\n\n        for (String[] aTestData : testData) {\n            String source = aTestData[0];\n            String expected = aTestData[1];\n\n            TestCase.assertEquals(\"XML Encoding '\" + source + \"'\", expected, xssAPI.encodeForXMLAttr(source));\n        }\n    }\n\n    @T"
  },
  {
    "id": 23,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 7,
    "human_patch": "https://github.com/apache/sling/commit/fb2719e8299fadddae62245482de112052a0e08c",
    "cve_id": "CVE-2016-6798",
    "cwe_id": "CWE-611",
    "filename": "bundles/extensions/xss/src/test/java/org/apache/sling/xss/impl/XSSAPIImplTest.java",
    "is_vulnerable": 0,
    "class_name": "XSSAPIImplTest",
    "subclass_name": null,
    "function_name": "erHTML() {\n     ",
    "function_body": "  String[][] testData = {\n                \n                {null, \"\"},\n                {\"\", \"\"},\n                {\"simple\", \"simple\"},\n\n                {\"<script>ugly</script>\", \"\"},\n                {\"<b>wow!</b>\", \"<b>wow!</b>\"},\n\n                {\"<p onmouseover='ugly'>nice</p>\", \"<p>nice</p>\"},\n\n                {\"<img src='javascript:ugly'/>\", \"\"},\n                {\"<img src='nice.jpg'/>\", \"<img src=\\\"nice.jpg\\\" />\"},\n\n                {\"<ul><li>1</li><li>2</li></ul>\", \"<ul><li>1</li><li>2</li></ul>\"},\n\n                {\"g\u00fcnter\", \"g\u00fcnter\"},\n\n\n                {\"<strike>strike</strike>\", \"<strike>strike</strike>\"},\n                {\"<s>s</s>\", \"<s>s</s>\"},\n\n                {\"<a href=\\\"\\\">empty href</a>\", \"<a href=\\\"\\\">empty href</a>\"}\n        };\n\n        for (String[] aTestData : testData) {\n            String source = aTestData[0];\n            String expected = aTestData[1];\n\n            TestCase.assertEquals(\"Filtering '\" + source + \"'\", expected, xssAPI.filterHTML(source));\n        }\n    }\n\n    @Tes"
  },
  {
    "id": 23,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 8,
    "human_patch": "https://github.com/apache/sling/commit/fb2719e8299fadddae62245482de112052a0e08c",
    "cve_id": "CVE-2016-6798",
    "cwe_id": "CWE-611",
    "filename": "bundles/extensions/xss/src/test/java/org/apache/sling/xss/impl/XSSAPIImplTest.java",
    "is_vulnerable": 0,
    "class_name": "XSSAPIImplTest",
    "subclass_name": null,
    "function_name": "idHref() {\n       ",
    "function_body": "String[][] testData = {\n                \n                \n                {null, \"\"},\n                {\"\", \"\"},\n                {\"simple\", \"simple\"},\n\n                {\"../parent\", \"../parent\"},\n                {\"repo/g\u00fcnter\", \"repo/g\u00fcnter\"},\n\n                \n                {\"my/page/jcr:content.feed\", \"my/page/_jcr_content.feed\"},\n                {\"my/jcr:content/page/jcr:content\", \"my/_jcr_content/page/_jcr_content\"},\n\n                {\"\\\" onClick=ugly\", \"%22%20onClick=ugly\"},\n                {\"javascript:ugly\", \"\"},\n                {\"http://localhost:4502\", \"http://localhost:4502\"},\n                {\"http://localhost:4502/test\", \"http://localhost:4502/test\"},\n                {\"http://localhost:4502/jcr:content/test\", \"http://localhost:4502/_jcr_content/test\"},\n                {\"http://localhost:4502/test.html?a=b&b=c\", \"http://localhost:4502/test.html?a=b&b=c\"},\n\n                \n                {\"/test/ab cd\", \"/test/ab%20cd\"},\n                {\"http://localhost:4502/test/ab cd\", \"http://localhost:4502/test/ab%20cd\"},\n                {\"/test/ab attr=c\", \"/test/ab%20attr=c\"},\n                {\"http://localhost:4502/test/ab attr=c\", \"http://localhost:4502/test/ab%20attr=c\"},\n                \n                {\"/test/ab\\\"cd\", \"/test/ab%22cd\"},\n                {\"http://localhost:4502/test/ab\\\"cd\", \"http://localhost:4502/test/ab%22cd\"},\n                \n                {\"/test/ab'cd\", \"/test/ab%27cd\"},\n                {\"http://localhost:4502/test/ab'cd\", \"http://localhost:4502/test/ab%27cd\"},\n                \n                {\"/test/ab=cd\", \"/test/ab=cd\"},\n                {\"http://localhost:4502/test/ab=cd\", \"http://localhost:4502/test/ab=cd\"},\n                \n                {\"/test/ab>cd\", \"/test/ab%3Ecd\"},\n                {\"http://localhost:4502/test/ab>cd\", \"http://localhost:4502/test/ab%3Ecd\"},\n                \n                {\"/test/ab<cd\", \"/test/ab%3Ccd\"},\n                {\"http://localhost:4502/test/ab<cd\", \"http://localhost:4502/test/ab%3Ccd\"},\n                \n                {\"/test/ab`cd\", \"/test/ab%60cd\"},\n                {\"http://localhost:4502/test/ab`cd\", \"http://localhost:4502/test/ab%60cd\"},\n                \n                {\"/test/search.html?0_tag:id=test\", \"/test/search.html?0_tag%3Aid=test\"},\n                { \n                        \"/test/jcr:content/search.html?0_tag:id=test\",\n                        \"/test/_jcr_content/search.html?0_tag%3Aid=test\"\n                },\n                { \n                        \"/test/search.html?0_tag:id=test?ing&1_tag:id=abc\",\n                        \"/test/search.html?0_tag%3Aid=test?ing&1_tag%3Aid=abc\",\n                }\n        };\n\n        for (String[] aTestData : testData) {\n            String href = aTestData[0];\n            String expected = aTestData[1];\n\n            TestCase.assertEquals(\"Requested '\" + href + \"'\", expected, xssAPI.getValidHref(href));\n        }\n    }\n\n    @Test\n"
  },
  {
    "id": 23,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 9,
    "human_patch": "https://github.com/apache/sling/commit/fb2719e8299fadddae62245482de112052a0e08c",
    "cve_id": "CVE-2016-6798",
    "cwe_id": "CWE-611",
    "filename": "bundles/extensions/xss/src/test/java/org/apache/sling/xss/impl/XSSAPIImplTest.java",
    "is_vulnerable": 0,
    "class_name": "XSSAPIImplTest",
    "subclass_name": null,
    "function_name": "HrefWithoutHrefConfig() throws Exce tion {\n        \n",
    "function_body": "       XSSFilterImpl xssFilter = Whitebox.getInternalState(xssAPI, \"xssFilter\");\n        setDefaultHandler(xssFilter, \"./src/test/resources/configWithoutHref.xml\");\n\n        Attribute hrefAttribute = Whitebox.getInternalState(xssFilter, \"hrefAttribute\");\n        Assert.assertEquals(hrefAttribute, XSSFilterImpl.DEFAULT_HREF_ATTRIBUTE);\n\n        \n        testGetValidHref();\n    }\n\n    @Test\n"
  },
  {
    "id": 23,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 10,
    "human_patch": "https://github.com/apache/sling/commit/fb2719e8299fadddae62245482de112052a0e08c",
    "cve_id": "CVE-2016-6798",
    "cwe_id": "CWE-611",
    "filename": "bundles/extensions/xss/src/test/java/org/apache/sling/xss/impl/XSSAPIImplTest.java",
    "is_vulnerable": 0,
    "class_name": "XSSAPIImplTest",
    "subclass_name": null,
    "function_name": "Integer() {\n        S",
    "function_body": "ring[][] testData = {\n                \n                \n                {null, \"123\"},\n                {\"100\", \"100\"},\n                {\"0\", \"0\"},\n\n                {\"junk\", \"123\"},\n                {\"100.5\", \"123\"},\n                {\"\", \"123\"},\n                {\"null\", \"123\"}\n        };\n\n        for (String[] aTestData : testData) {\n            String source = aTestData[0];\n            Integer expected = (aTestData[1] != null) ? new Integer(aTestData[1]) : null;\n\n            TestCase.assertEquals(\"Validating integer '\" + source + \"'\", expected, xssAPI.getValidInteger(source, 123));\n        }\n    }\n\n    @Test\n"
  },
  {
    "id": 23,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 11,
    "human_patch": "https://github.com/apache/sling/commit/fb2719e8299fadddae62245482de112052a0e08c",
    "cve_id": "CVE-2016-6798",
    "cwe_id": "CWE-611",
    "filename": "bundles/extensions/xss/src/test/java/org/apache/sling/xss/impl/XSSAPIImplTest.java",
    "is_vulnerable": 0,
    "class_name": "XSSAPIImplTest",
    "subclass_name": null,
    "function_name": "Long() {\n        S",
    "function_body": "ring[][] testData = {\n                \n                \n                {null, \"123\"},\n                {\"100\", \"100\"},\n                {\"0\", \"0\"},\n\n                {\"junk\", \"123\"},\n                {\"100.5\", \"123\"},\n                {\"\", \"123\"},\n                {\"null\", \"123\"}\n        };\n\n        for (String[] aTestData : testData) {\n            String source = aTestData[0];\n            Long expected = (aTestData[1] != null) ? new Long(aTestData[1]) : null;\n\n            TestCase.assertEquals(\"Validating long '\" + source + \"'\", expected, xssAPI.getValidLong(source, 123));\n        }\n    }\n\n    @Test\n"
  },
  {
    "id": 23,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 12,
    "human_patch": "https://github.com/apache/sling/commit/fb2719e8299fadddae62245482de112052a0e08c",
    "cve_id": "CVE-2016-6798",
    "cwe_id": "CWE-611",
    "filename": "bundles/extensions/xss/src/test/java/org/apache/sling/xss/impl/XSSAPIImplTest.java",
    "is_vulnerable": 0,
    "class_name": "XSSAPIImplTest",
    "subclass_name": null,
    "function_name": "Double() {\n        S",
    "function_body": "ring[][] testData = {\n                \n                \n                {null, \"123\"},\n                {\"100.5\", \"100.5\"},\n                {\"0\", \"0\"},\n\n                {\"junk\", \"123\"},\n                {\"\", \"123\"},\n                {\"null\", \"123\"}\n        };\n\n        for (String[] aTestData : testData) {\n            String source = aTestData[0];\n            Double expected = (aTestData[1] != null) ? new Double(aTestData[1]) : null;\n\n            TestCase.assertEquals(\"Validating double '\" + source + \"'\", expected, xssAPI.getValidDouble(source, 123));\n        }\n    }\n\n    @Test\n"
  },
  {
    "id": 23,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 13,
    "human_patch": "https://github.com/apache/sling/commit/fb2719e8299fadddae62245482de112052a0e08c",
    "cve_id": "CVE-2016-6798",
    "cwe_id": "CWE-611",
    "filename": "bundles/extensions/xss/src/test/java/org/apache/sling/xss/impl/XSSAPIImplTest.java",
    "is_vulnerable": 0,
    "class_name": "XSSAPIImplTest",
    "subclass_name": null,
    "function_name": "Dimension() {\n        S",
    "function_body": "ring[][] testData = {\n                \n                \n                {null, \"123\"},\n                {\"\", \"123\"},\n                {\"100\", \"100\"},\n                {\"0\", \"0\"},\n\n                {\"junk\", \"123\"},\n                {\"100.5\", \"123\"},\n                {\"\", \"123\"},\n                {\"null\", \"123\"},\n\n                {\"\\\"auto\\\"\", \"\\\"auto\\\"\"},\n                {\"'auto'\", \"\\\"auto\\\"\"},\n                {\"auto\", \"\\\"auto\\\"\"},\n\n                {\"autox\", \"123\"}\n        };\n\n        for (String[] aTestData : testData) {\n            String source = aTestData[0];\n            String expected = aTestData[1];\n\n            TestCase.assertEquals(\"Validating dimension '\" + source + \"'\", expected, xssAPI.getValidDimension(source, \"123\"));\n        }\n    }\n\n    @Test\n"
  },
  {
    "id": 23,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 14,
    "human_patch": "https://github.com/apache/sling/commit/fb2719e8299fadddae62245482de112052a0e08c",
    "cve_id": "CVE-2016-6798",
    "cwe_id": "CWE-611",
    "filename": "bundles/extensions/xss/src/test/java/org/apache/sling/xss/impl/XSSAPIImplTest.java",
    "is_vulnerable": 0,
    "class_name": "XSSAPIImplTest",
    "subclass_name": null,
    "function_name": "rJSString() {\n        S",
    "function_body": "ring[][] testData = {\n                \n                \n                {null, null},\n                {\"simple\", \"simple\"},\n\n                {\"break\\\"out\", \"break\\\\x22out\"},\n                {\"break'out\", \"break\\\\x27out\"},\n\n                {\"</script>\", \"<\\\\/script>\"},\n\n                {\"'alert(document.cookie)\", \"\\\\x27alert(document.cookie)\"},\n                {\"2014-04-22T10:11:24.002+01:00\", \"2014\\\\u002D04\\\\u002D22T10:11:24.002+01:00\"}\n        };\n\n        for (String[] aTestData : testData) {\n            String source = aTestData[0];\n            String expected = aTestData[1];\n\n            TestCase.assertEquals(\"Encoding '\" + source + \"'\", expected, xssAPI.encodeForJSString(source));\n        }\n    }\n\n    @Test\n"
  },
  {
    "id": 23,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 15,
    "human_patch": "https://github.com/apache/sling/commit/fb2719e8299fadddae62245482de112052a0e08c",
    "cve_id": "CVE-2016-6798",
    "cwe_id": "CWE-611",
    "filename": "bundles/extensions/xss/src/test/java/org/apache/sling/xss/impl/XSSAPIImplTest.java",
    "is_vulnerable": 0,
    "class_name": "XSSAPIImplTest",
    "subclass_name": null,
    "function_name": "JSToken() {\n        S",
    "function_body": "ring[][] testData = {\n                \n                \n                {null, RUBBISH},\n                {\"\", RUBBISH},\n                {\"simple\", \"simple\"},\n                {\"clickstreamcloud.thingy\", \"clickstreamcloud.thingy\"},\n\n                {\"break out\", RUBBISH},\n                {\"break,out\", RUBBISH},\n\n                {\"\\\"literal string\\\"\", \"\\\"literal string\\\"\"},\n                {\"'literal string'\", \"'literal string'\"},\n                {\"\\\"bad literal'\", RUBBISH},\n                {\"'literal'); junk'\", \"'literal\\\\x27); junk'\"},\n\n                {\"1200\", \"1200\"},\n                {\"3.14\", \"3.14\"},\n                {\"1,200\", RUBBISH},\n                {\"1200 + 1\", RUBBISH}\n        };\n\n        for (String[] aTestData : testData) {\n            String source = aTestData[0];\n            String expected = aTestData[1];\n\n            TestCase.assertEquals(\"Validating Javascript token '\" + source + \"'\", expected, xssAPI.getValidJSToken(source, RUBBISH));\n        }\n    }\n\n    @Test\n"
  },
  {
    "id": 23,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 16,
    "human_patch": "https://github.com/apache/sling/commit/fb2719e8299fadddae62245482de112052a0e08c",
    "cve_id": "CVE-2016-6798",
    "cwe_id": "CWE-611",
    "filename": "bundles/extensions/xss/src/test/java/org/apache/sling/xss/impl/XSSAPIImplTest.java",
    "is_vulnerable": 0,
    "class_name": "XSSAPIImplTest",
    "subclass_name": null,
    "function_name": "rCSSString() {\n        S",
    "function_body": "ring[][] testData = {\n                \n                {null, null},\n                {\"test\"   , \"test\"},\n                {\"\\\\\"     , \"\\\\5c\"},\n                {\"'\"      , \"\\\\27\"},\n                {\"\\\"\"     , \"\\\\22\"}\n        };\n\n        for (String[] aTestData : testData) {\n            String source = aTestData[0];\n            String expected = aTestData[1];\n\n            String result = xssAPI.encodeForCSSString(source);\n            TestCase.assertEquals(\"Encoding '\" + source + \"'\", expected, result);\n        }\n    }\n\n    @Test\n"
  },
  {
    "id": 23,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 17,
    "human_patch": "https://github.com/apache/sling/commit/fb2719e8299fadddae62245482de112052a0e08c",
    "cve_id": "CVE-2016-6798",
    "cwe_id": "CWE-611",
    "filename": "bundles/extensions/xss/src/test/java/org/apache/sling/xss/impl/XSSAPIImplTest.java",
    "is_vulnerable": 0,
    "class_name": "XSSAPIImplTest",
    "subclass_name": null,
    "function_name": "StyleToken() {\n        S",
    "function_body": "ring[][] testData = {\n                \n                {null                               , RUBBISH},\n                {\"\"                                 , RUBBISH},\n\n                \n                {\"}\"                                , RUBBISH},\n\n                \n                {\"br\\neak\"                          , RUBBISH},\n\n                \n                {\"javascript:alert(1)\"              , RUBBISH},\n                {\"'javascript:alert(1)'\"            , RUBBISH},\n                {\"\\\"javascript:alert('XSS')\\\"\"      , RUBBISH},\n                {\"url(javascript:alert(1))\"         , RUBBISH},\n                {\"url('javascript:alert(1)')\"       , RUBBISH},\n                {\"url(\\\"javascript:alert('XSS')\\\")\" , RUBBISH},\n\n                \n                {\"expression(alert(1))\"             , RUBBISH},\n                {\"expression  (alert(1))\"           , RUBBISH},\n                {\"expression(this.location='a.co')\" , RUBBISH},\n\n                \n                {\"</style><script>alert(1)</script>\", RUBBISH},\n\n                \n                {\"background-color\"                 , \"background-color\"},\n                {\"-moz-box-sizing\"                  , \"-moz-box-sizing\"},\n                {\".42%\"                             , \".42%\"},\n                {\"#fff\"                             , \"#fff\"},\n\n                \n                {\"'literal string'\"                 , \"'literal string'\"},\n                {\"\\\"literal string\\\"\"               , \"\\\"literal string\\\"\"},\n                {\"'it\\\\'s here'\"                    , \"'it\\\\'s here'\"},\n                {\"\\\"it\\\\\\\"s here\\\"\"                 , \"\\\"it\\\\\\\"s here\\\"\"},\n\n                \n                {\"\\\"bad string\"                     , RUBBISH},\n                {\"'it's here'\"                      , RUBBISH},\n                {\"\\\"it\\\"s here\\\"\"                   , RUBBISH},\n\n                \n                {\"rgb(255, 255, 255)\"               , \"rgb(255, 255, 255)\"},\n\n                \n                {\"rgb(255, 255, 255\"               , RUBBISH},\n                {\"255, 255, 255)\"                  , RUBBISH},\n\n                \n                {\"url(http://example.com/test.png)\", \"url(http://example.com/test.png)\"},\n                {\"url('image/test.png')\"           , \"url('image/test.png')\"},\n\n                \n                {\"color: red\"                      , RUBBISH}\n        };\n\n        for (String[] aTestData : testData) {\n            String source = aTestData[0];\n            String expected = aTestData[1];\n\n            String result = xssAPI.getValidStyleToken(source, RUBBISH);\n            if (!result.equals(expected)) {\n                fail(\"Validating style token '\" + source + \"', expecting '\" + expected + \"', but got '\" + result + \"'\");\n            }\n        }\n    }\n\n    @Test\n"
  },
  {
    "id": 23,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 18,
    "human_patch": "https://github.com/apache/sling/commit/fb2719e8299fadddae62245482de112052a0e08c",
    "cve_id": "CVE-2016-6798",
    "cwe_id": "CWE-611",
    "filename": "bundles/extensions/xss/src/test/java/org/apache/sling/xss/impl/XSSAPIImplTest.java",
    "is_vulnerable": 0,
    "class_name": "XSSAPIImplTest",
    "subclass_name": null,
    "function_name": "CSSColor() {\n        S",
    "function_body": "ring[][] testData = {\n                \n                \n                {null, RUBBISH},\n                {\"\", RUBBISH},\n\n                {\"rgb(0,+0,-0)\", \"rgb(0,+0,-0)\"},\n                {\"rgba ( 0\\f%, 0%,\\t0%,\\n100%\\r)\", \"rgba ( 0\\f%, 0%,\\t0%,\\n100%\\r)\",},\n\n                {\"#ddd\", \"#ddd\"},\n                {\"#eeeeee\", \"#eeeeee\",},\n\n                {\"hsl(0,1,2)\", \"hsl(0,1,2)\"},\n                {\"hsla(0,1,2,3)\", \"hsla(0,1,2,3)\"},\n                {\"currentColor\", \"currentColor\"},\n                {\"transparent\", \"transparent\"},\n\n                {\"\\f\\r\\n\\t MenuText\\f\\r\\n\\t \", \"MenuText\"},\n                {\"expression(99,99,99)\", RUBBISH},\n                {\"blue;\", RUBBISH},\n                {\"url(99,99,99)\", RUBBISH}\n        };\n\n        for (String[] aTestData : testData) {\n            String source = aTestData[0];\n            String expected = aTestData[1];\n\n            String result = xssAPI.getValidCSSColor(source, RUBBISH);\n            if (!result.equals(expected)) {\n                fail(\"Validating CSS Color '\" + source + \"', expecting '\" + expected + \"', but got '\" + result + \"'\");\n            }\n        }\n    }\n\n    @Test\n"
  },
  {
    "id": 23,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 19,
    "human_patch": "https://github.com/apache/sling/commit/fb2719e8299fadddae62245482de112052a0e08c",
    "cve_id": "CVE-2016-6798",
    "cwe_id": "CWE-611",
    "filename": "bundles/extensions/xss/src/test/java/org/apache/sling/xss/impl/XSSAPIImplTest.java",
    "is_vulnerable": 0,
    "class_name": "XSSAPIImplTest",
    "subclass_name": null,
    "function_name": "MultiLineComment() {\n        S",
    "function_body": "ring[][] testData = {\n                \n\n                {null               , RUBBISH},\n                {\"blah */ hack\"     , RUBBISH},\n\n                {\"Valid comment\"    , \"Valid comment\"}\n        };\n        for (String[] aTestData : testData) {\n            String source = aTestData[0];\n            String expected = aTestData[1];\n\n            String result = xssAPI.getValidMultiLineComment(source, RUBBISH);\n            if (!result.equals(expected)) {\n                fail(\"Validating multiline comment '\" + source + \"', expecting '\" + expected + \"', but got '\" + result + \"'\");\n            }\n        }\n    }\n\n    @Test\n"
  },
  {
    "id": 23,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 20,
    "human_patch": "https://github.com/apache/sling/commit/fb2719e8299fadddae62245482de112052a0e08c",
    "cve_id": "CVE-2016-6798",
    "cwe_id": "CWE-611",
    "filename": "bundles/extensions/xss/src/test/java/org/apache/sling/xss/impl/XSSAPIImplTest.java",
    "is_vulnerable": 0,
    "class_name": "XSSAPIImplTest",
    "subclass_name": null,
    "function_name": "JSON() {\n        S",
    "function_body": "ring[][] testData = {\n                {null,      RUBBISH_JSON},\n                {\"\",        \"\"},\n                {\"1]\",      RUBBISH_JSON},\n                {\"{}\",      \"{}\"},\n                {\"{1}\",     RUBBISH_JSON},\n                {\n                        \"{test: 'test'}\",\n                        \"{\\\"test\\\":\\\"test\\\"}\"\n                },\n                {\n                        \"{test:\\\"test}\",\n                        RUBBISH_JSON\n                },\n                {\n                        \"{test1:'test1', test2: {test21: 'test21', test22: 'test22'}}\",\n                        \"{\\\"test1\\\":\\\"test1\\\",\\\"test2\\\":{\\\"test21\\\":\\\"test21\\\",\\\"test22\\\":\\\"test22\\\"}}\"\n                },\n                {\"[]\",      \"[]\"},\n                {\"[1,2]\",   \"[1,2]\"},\n                {\"[1\",      RUBBISH_JSON},\n                {\n                        \"[{test: 'test'}]\",\n                        \"[{\\\"test\\\":\\\"test\\\"}]\"\n                }\n        };\n        for (String[] aTestData : testData) {\n            String source = aTestData[0];\n            String expected = aTestData[1];\n\n            String result = xssAPI.getValidJSON(source, RUBBISH_JSON);\n            if (!result.equals(expected)) {\n                fail(\"Validating JSON '\" + source + \"', expecting '\" + expected + \"', but got '\" + result + \"'\");\n            }\n        }\n    }\n\n    @Test\n"
  },
  {
    "id": 23,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 21,
    "human_patch": "https://github.com/apache/sling/commit/fb2719e8299fadddae62245482de112052a0e08c",
    "cve_id": "CVE-2016-6798",
    "cwe_id": "CWE-611",
    "filename": "bundles/extensions/xss/src/test/java/org/apache/sling/xss/impl/XSSAPIImplTest.java",
    "is_vulnerable": 1,
    "class_name": "XSSAPIImplTest",
    "subclass_name": null,
    "function_name": "XML() {\n        S",
    "function_body": "ring[][] testData = {\n                {null,      RUBBISH_XML},\n                {\"\",        \"\"},\n                {\n                        \"<t/>\",\n                        \"<t/>\"\n                },\n                {\n                        \"<t>\",\n                        RUBBISH_XML\n                },\n                {\n                        \"<t>test</t>\",\n                        \"<t>test</t>\"\n                },\n                {\n                        \"<t>test\",\n                        RUBBISH_XML\n                },\n                {\n                        \"<t t=\\\"t\\\">test</t>\",\n                        \"<t t=\\\"t\\\">test</t>\"\n                },\n                {\n                        \"<t t=\\\"t>test</t>\",\n                        RUBBISH_XML\n                },\n                {\n                        \"<t><w>xyz</w></t>\",\n                        \"<t><w>xyz</w></t>\"\n                },\n                {\n                        \"<t><w>xyz</t></w>\",\n                        RUBBISH_XML\n                }\n        };\n        for (String[] aTestData : testData) {\n            String source = aTestData[0];\n            String expected = aTestData[1];\n\n            String result = xssAPI.getValidXML(source, RUBBISH_XML);\n            if (!result.equals(expected)) {\n                fail(\"Validating XML '\" + source + \"', expecting '\" + expected + \"', but got '\" + result + \"'\");\n            }\n        }\n    }\n}\n"
  },
  {
    "id": 24,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 0,
    "human_patch": "https://github.com/apache/sling-org-apache-sling-xss/commit/ec6764d165abc4df8cffd8439761bb2228887db9",
    "cve_id": "CVE-2017-15717",
    "cwe_id": "CWE-79",
    "filename": "src/main/java/org/apache/sling/xss/impl/XSSAPIImpl.java",
    "is_vulnerable": 0,
    "class_name": "XSSAPIImpl",
    "subclass_name": null,
    "function_name": "activate()",
    "function_body": "{\n        factory = SAXParserFactory.newInstance();\n        factory.setValidating(false);\n        factory.setNamespaceAware(true);\n        try {\n            factory.setFeature(\"http://apache.org/xml/features/nonvalidating/load-external-dtd\", false);\n            factory.setFeature(\"http://xml.org/sax/features/external-parameter-entities\", false);\n            factory.setFeature(\"http://xml.org/sax/features/external-general-entities\", false);\n        } catch (Exception e) {\n            LOGGER.error(\"SAX parser configuration error: \" + e.getMessage(), e);\n        }\n        Map<String, Object> config = new HashMap<>();\n        config.put(\"org.apache.johnzon.supports-comments\", true);\n        jsonReaderFactory = Json.createReaderFactory(config);\n    }"
  },
  {
    "id": 24,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 1,
    "human_patch": "https://github.com/apache/sling-org-apache-sling-xss/commit/ec6764d165abc4df8cffd8439761bb2228887db9",
    "cve_id": "CVE-2017-15717",
    "cwe_id": "CWE-79",
    "filename": "src/main/java/org/apache/sling/xss/impl/XSSAPIImpl.java",
    "is_vulnerable": 0,
    "class_name": "XSSAPIImpl",
    "subclass_name": null,
    "function_name": "deactivate()",
    "function_body": "{\n        factory = null;\n        jsonReaderFactory = null;\n    }"
  },
  {
    "id": 24,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 2,
    "human_patch": "https://github.com/apache/sling-org-apache-sling-xss/commit/ec6764d165abc4df8cffd8439761bb2228887db9",
    "cve_id": "CVE-2017-15717",
    "cwe_id": "CWE-79",
    "filename": "src/main/java/org/apache/sling/xss/impl/XSSAPIImpl.java",
    "is_vulnerable": 0,
    "class_name": "XSSAPIImpl",
    "subclass_name": null,
    "function_name": "getValidInteger(String integer, int defaultValue)",
    "function_body": "{\n        if (integer != null && integer.length() > 0) {\n            try {\n                return validator.getValidInteger(\"XSS\", integer, -2000000000, 2000000000, false);\n            } catch (Exception e) {\n                \n            }\n        }\n\n        \n        return defaultValue;\n    }"
  },
  {
    "id": 24,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 3,
    "human_patch": "https://github.com/apache/sling-org-apache-sling-xss/commit/ec6764d165abc4df8cffd8439761bb2228887db9",
    "cve_id": "CVE-2017-15717",
    "cwe_id": "CWE-79",
    "filename": "src/main/java/org/apache/sling/xss/impl/XSSAPIImpl.java",
    "is_vulnerable": 0,
    "class_name": "XSSAPIImpl",
    "subclass_name": null,
    "function_name": "getValidLong(String source, long defaultValue)",
    "function_body": "{\n        if (source != null && source.length() > 0) {\n            try {\n                LongValidationRule ivr = new LongValidationRule( \"number\", ESAPI.encoder(), -9000000000000000000L, 9000000000000000000L );\n                ivr.setAllowNull(false);\n                return ivr.getValid(\"XSS\", source);\n            } catch (Exception e) {\n                \n            }\n        }\n\n        \n        return defaultValue;\n    }"
  },
  {
    "id": 24,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 4,
    "human_patch": "https://github.com/apache/sling-org-apache-sling-xss/commit/ec6764d165abc4df8cffd8439761bb2228887db9",
    "cve_id": "CVE-2017-15717",
    "cwe_id": "CWE-79",
    "filename": "src/main/java/org/apache/sling/xss/impl/XSSAPIImpl.java",
    "is_vulnerable": 0,
    "class_name": "XSSAPIImpl",
    "subclass_name": null,
    "function_name": "getValidDouble(String source, double defaultValue)",
    "function_body": "{\n        if (source != null && source.length() > 0) {\n            try {\n                return validator.getValidDouble(\"XSS\", source, 0d, Double.MAX_VALUE, false);\n            } catch (Exception e) {\n                \n            }\n        }\n\n        \n        return defaultValue;\n    }"
  },
  {
    "id": 24,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 5,
    "human_patch": "https://github.com/apache/sling-org-apache-sling-xss/commit/ec6764d165abc4df8cffd8439761bb2228887db9",
    "cve_id": "CVE-2017-15717",
    "cwe_id": "CWE-79",
    "filename": "src/main/java/org/apache/sling/xss/impl/XSSAPIImpl.java",
    "is_vulnerable": 0,
    "class_name": "XSSAPIImpl",
    "subclass_name": null,
    "function_name": "getValidDimension(String dimension, String defaultValue)",
    "function_body": "{\n        if (dimension != null && dimension.length() > 0) {\n            if (PATTERN_AUTO_DIMENSION.matcher(dimension).matches()) {\n                return \"\\\"auto\\\"\";\n            }\n\n            try {\n                return validator.getValidInteger(\"XSS\", dimension, -10000, 10000, false).toString();\n            } catch (Exception e) {\n                \n            }\n        }\n\n        \n        return defaultValue;\n    }"
  },
  {
    "id": 24,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 6,
    "human_patch": "https://github.com/apache/sling-org-apache-sling-xss/commit/ec6764d165abc4df8cffd8439761bb2228887db9",
    "cve_id": "CVE-2017-15717",
    "cwe_id": "CWE-79",
    "filename": "src/main/java/org/apache/sling/xss/impl/XSSAPIImpl.java",
    "is_vulnerable": 0,
    "class_name": "XSSAPIImpl",
    "subclass_name": null,
    "function_name": "mangleNamespaces(String absPath)",
    "function_body": "{\n        if (absPath != null) {\n            \n            final int schemeIndex = absPath.indexOf(SCHEME_PATTERN);\n            final String manglePath;\n            final String prefix;\n            if (schemeIndex != -1) {\n                final int pathIndex = absPath.indexOf(\"/\", schemeIndex + 3);\n                if (pathIndex != -1) {\n                    prefix = absPath.substring(0, pathIndex);\n                    manglePath = absPath.substring(pathIndex);\n                } else {\n                    prefix = absPath;\n                    manglePath = \"\";\n                }\n            } else {\n                prefix = \"\";\n                manglePath = absPath;\n            }\n            if (manglePath.contains(MANGLE_NAMESPACE_OUT_SUFFIX)) {\n                final Matcher m = MANGLE_NAMESPACE_PATTERN.matcher(manglePath);\n\n                final StringBuffer buf = new StringBuffer();\n                while (m.find()) {\n                    final String replacement = MANGLE_NAMESPACE_IN_PREFIX + m.group(1) + MANGLE_NAMESPACE_IN_SUFFIX;\n                    m.appendReplacement(buf, replacement);\n                }\n\n                m.appendTail(buf);\n\n                absPath = prefix + buf.toString();\n\n            }\n        }\n\n        return absPath;\n    }"
  },
  {
    "id": 24,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 7,
    "human_patch": "https://github.com/apache/sling-org-apache-sling-xss/commit/ec6764d165abc4df8cffd8439761bb2228887db9",
    "cve_id": "CVE-2017-15717",
    "cwe_id": "CWE-79",
    "filename": "src/main/java/org/apache/sling/xss/impl/XSSAPIImpl.java",
    "is_vulnerable": 1,
    "class_name": "XSSAPIImpl",
    "subclass_name": null,
    "function_name": "getValidHref(final String url)",
    "function_body": "{\n        if (StringUtils.isNotEmpty(url)) {\n            try {\n                String unescapedURL = URLDecoder.decode(url, StandardCharsets.UTF_8.name());\n                \n                unescapedURL = StringEscapeUtils.unescapeXml(unescapedURL);\n                \n                \n                \n                String encodedUrl = unescapedURL.replaceAll(\"\\\"\", \"%22\")\n                        .replaceAll(\"'\", \"%27\")\n                        .replaceAll(\">\", \"%3E\")\n                        .replaceAll(\"<\", \"%3C\")\n                        .replaceAll(\"`\", \"%60\")\n                        .replaceAll(\" \", \"%20\");\n                int qMarkIx = encodedUrl.indexOf('?');\n                if (qMarkIx > 0) {\n                    encodedUrl = encodedUrl.substring(0, qMarkIx) + encodedUrl.substring(qMarkIx).replaceAll(\":\", \"%3A\");\n                }\n\n                encodedUrl = mangleNamespaces(encodedUrl);\n                if (xssFilter.isValidHref(encodedUrl)) {\n                    return encodedUrl;\n                }\n            } catch (UnsupportedEncodingException e) {\n                LOGGER.error(\"Unable to decode url: {}.\", url);\n            }\n        }\n        \n        return \"\";\n    }"
  },
  {
    "id": 24,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 8,
    "human_patch": "https://github.com/apache/sling-org-apache-sling-xss/commit/ec6764d165abc4df8cffd8439761bb2228887db9",
    "cve_id": "CVE-2017-15717",
    "cwe_id": "CWE-79",
    "filename": "src/main/java/org/apache/sling/xss/impl/XSSAPIImpl.java",
    "is_vulnerable": 0,
    "class_name": "XSSAPIImpl",
    "subclass_name": null,
    "function_name": "getValidJSToken(String token, String defaultValue)",
    "function_body": "{\n        if (token != null && token.length() > 0) {\n            token = token.trim();\n            String q = token.substring(0, 1);\n            if (q.matches(\"['\\\"]\") && token.endsWith(q)) {\n                String literal = token.substring(1, token.length() - 1);\n                return q + encodeForJSString(literal) + q;\n            } else if (token.matches(\"[0-9a-zA-Z_$][0-9a-zA-Z_$.]*\")) {\n                return token;\n            }\n        }\n\n        \n        return defaultValue;\n    }"
  },
  {
    "id": 24,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 9,
    "human_patch": "https://github.com/apache/sling-org-apache-sling-xss/commit/ec6764d165abc4df8cffd8439761bb2228887db9",
    "cve_id": "CVE-2017-15717",
    "cwe_id": "CWE-79",
    "filename": "src/main/java/org/apache/sling/xss/impl/XSSAPIImpl.java",
    "is_vulnerable": 0,
    "class_name": "XSSAPIImpl",
    "subclass_name": null,
    "function_name": "getValidStyleToken(String token, String defaultValue)",
    "function_body": "{\n        if (token != null && token.length() > 0 && token.matches(CSS_TOKEN)) {\n            return token;\n        }\n\n        return defaultValue;\n   }"
  },
  {
    "id": 24,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 10,
    "human_patch": "https://github.com/apache/sling-org-apache-sling-xss/commit/ec6764d165abc4df8cffd8439761bb2228887db9",
    "cve_id": "CVE-2017-15717",
    "cwe_id": "CWE-79",
    "filename": "src/main/java/org/apache/sling/xss/impl/XSSAPIImpl.java",
    "is_vulnerable": 0,
    "class_name": "XSSAPIImpl",
    "subclass_name": null,
    "function_name": "getValidCSSColor(String color, String defaultColor)",
    "function_body": "{\n        if (color != null && color.length() > 0) {\n            color = color.trim();\n            \n            if (color.matches(\"(?i)[#a-fghlrs(+0-9-.%,) \\\\t\\\\n\\\\x0B\\\\f\\\\r]+\")) {\n                return color;\n            }\n            \n            if (color.matches(\"(?i)[a-zA-Z \\\\t\\\\n\\\\x0B\\\\f\\\\r]+\")) {\n                return color;\n            }\n        }\n\n        return defaultColor;\n    }"
  },
  {
    "id": 24,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 11,
    "human_patch": "https://github.com/apache/sling-org-apache-sling-xss/commit/ec6764d165abc4df8cffd8439761bb2228887db9",
    "cve_id": "CVE-2017-15717",
    "cwe_id": "CWE-79",
    "filename": "src/main/java/org/apache/sling/xss/impl/XSSAPIImpl.java",
    "is_vulnerable": 0,
    "class_name": "XSSAPIImpl",
    "subclass_name": null,
    "function_name": "getValidMultiLineComment(String comment, String defaultComment)",
    "function_body": "{\n        if (comment != null && !comment.contains(\"*/\")) {\n            return comment;\n        }\n        return defaultComment;\n    }"
  },
  {
    "id": 24,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 12,
    "human_patch": "https://github.com/apache/sling-org-apache-sling-xss/commit/ec6764d165abc4df8cffd8439761bb2228887db9",
    "cve_id": "CVE-2017-15717",
    "cwe_id": "CWE-79",
    "filename": "src/main/java/org/apache/sling/xss/impl/XSSAPIImpl.java",
    "is_vulnerable": 0,
    "class_name": "XSSAPIImpl",
    "subclass_name": null,
    "function_name": "getValidJSON(String json, String defaultJson)",
    "function_body": "{\n        if (json == null) {\n            return getValidJSON(defaultJson, \"\");\n        }\n        json = json.trim();\n        if (\"\".equals(json)) {\n            return \"\";\n        }\n        int curlyIx = json.indexOf(\"{\");\n        int straightIx = json.indexOf(\"[\");\n        if (curlyIx >= 0 && (curlyIx < straightIx || straightIx < 0)) {\n            try {\n                StringWriter output = new StringWriter();\n                Json.createGenerator(output).write(jsonReaderFactory.createReader(new StringReader(json)).readObject()).close();\n                return output.getBuffer().toString();\n            } catch (Exception e) {\n                LOGGER.debug(\"JSON validation failed: \" + e.getMessage(), e);\n            }\n        } else {\n            try {\n                StringWriter output = new StringWriter();\n                Json.createGenerator(output).write(jsonReaderFactory.createReader(new StringReader(json)).readArray()).close();\n                return output.getBuffer().toString();\n            } catch (Exception e) {\n                LOGGER.debug(\"JSON validation failed: \" + e.getMessage(), e);\n            }\n        }\n        return getValidJSON(defaultJson, \"\");\n    }"
  },
  {
    "id": 24,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 13,
    "human_patch": "https://github.com/apache/sling-org-apache-sling-xss/commit/ec6764d165abc4df8cffd8439761bb2228887db9",
    "cve_id": "CVE-2017-15717",
    "cwe_id": "CWE-79",
    "filename": "src/main/java/org/apache/sling/xss/impl/XSSAPIImpl.java",
    "is_vulnerable": 0,
    "class_name": "XSSAPIImpl",
    "subclass_name": null,
    "function_name": "getValidXML(String xml, String defaultXml)",
    "function_body": "{\n        if (xml == null) {\n            return getValidXML(defaultXml, \"\");\n        }\n        xml = xml.trim();\n        if (\"\".equals(xml)) {\n            return \"\";\n        }\n\n        try {\n            SAXParser parser = factory.newSAXParser();\n            XMLReader reader = parser.getXMLReader();\n            reader.parse(new InputSource(new StringReader(xml)));\n            return xml;\n        } catch (Exception e) {\n            LOGGER.debug(\"XML validation failed: \" + e.getMessage(), e);\n        }\n        return getValidXML(defaultXml, \"\");\n    }"
  },
  {
    "id": 24,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 14,
    "human_patch": "https://github.com/apache/sling-org-apache-sling-xss/commit/ec6764d165abc4df8cffd8439761bb2228887db9",
    "cve_id": "CVE-2017-15717",
    "cwe_id": "CWE-79",
    "filename": "src/main/java/org/apache/sling/xss/impl/XSSAPIImpl.java",
    "is_vulnerable": 0,
    "class_name": "XSSAPIImpl",
    "subclass_name": null,
    "function_name": "encodeForHTML(String source)",
    "function_body": "{\n        return source == null ? null : Encode.forHtml(source);\n    }"
  },
  {
    "id": 24,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 15,
    "human_patch": "https://github.com/apache/sling-org-apache-sling-xss/commit/ec6764d165abc4df8cffd8439761bb2228887db9",
    "cve_id": "CVE-2017-15717",
    "cwe_id": "CWE-79",
    "filename": "src/main/java/org/apache/sling/xss/impl/XSSAPIImpl.java",
    "is_vulnerable": 0,
    "class_name": "XSSAPIImpl",
    "subclass_name": null,
    "function_name": "encodeForHTMLAttr(String source)",
    "function_body": "{\n        return source == null ? null : Encode.forHtmlAttribute(source);\n    }"
  },
  {
    "id": 24,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 16,
    "human_patch": "https://github.com/apache/sling-org-apache-sling-xss/commit/ec6764d165abc4df8cffd8439761bb2228887db9",
    "cve_id": "CVE-2017-15717",
    "cwe_id": "CWE-79",
    "filename": "src/main/java/org/apache/sling/xss/impl/XSSAPIImpl.java",
    "is_vulnerable": 0,
    "class_name": "XSSAPIImpl",
    "subclass_name": null,
    "function_name": "encodeForXML(String source)",
    "function_body": "{\n        return source == null ? null : Encode.forXml(source);\n    }"
  },
  {
    "id": 24,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 17,
    "human_patch": "https://github.com/apache/sling-org-apache-sling-xss/commit/ec6764d165abc4df8cffd8439761bb2228887db9",
    "cve_id": "CVE-2017-15717",
    "cwe_id": "CWE-79",
    "filename": "src/main/java/org/apache/sling/xss/impl/XSSAPIImpl.java",
    "is_vulnerable": 0,
    "class_name": "XSSAPIImpl",
    "subclass_name": null,
    "function_name": "encodeForXMLAttr(String source)",
    "function_body": "{\n        return source == null ? null : Encode.forXmlAttribute(source);\n    }"
  },
  {
    "id": 24,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 18,
    "human_patch": "https://github.com/apache/sling-org-apache-sling-xss/commit/ec6764d165abc4df8cffd8439761bb2228887db9",
    "cve_id": "CVE-2017-15717",
    "cwe_id": "CWE-79",
    "filename": "src/main/java/org/apache/sling/xss/impl/XSSAPIImpl.java",
    "is_vulnerable": 0,
    "class_name": "XSSAPIImpl",
    "subclass_name": null,
    "function_name": "encodeForJSString(String source)",
    "function_body": "{\n        return source == null ? null : Encode.forJavaScript(source).replace(\"\\\\-\", \"\\\\u002D\");\n    }"
  },
  {
    "id": 24,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 19,
    "human_patch": "https://github.com/apache/sling-org-apache-sling-xss/commit/ec6764d165abc4df8cffd8439761bb2228887db9",
    "cve_id": "CVE-2017-15717",
    "cwe_id": "CWE-79",
    "filename": "src/main/java/org/apache/sling/xss/impl/XSSAPIImpl.java",
    "is_vulnerable": 0,
    "class_name": "XSSAPIImpl",
    "subclass_name": null,
    "function_name": "encodeForCSSString(String source)",
    "function_body": "{\n        return source == null ? null : Encode.forCssString(source);\n    }"
  },
  {
    "id": 24,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 20,
    "human_patch": "https://github.com/apache/sling-org-apache-sling-xss/commit/ec6764d165abc4df8cffd8439761bb2228887db9",
    "cve_id": "CVE-2017-15717",
    "cwe_id": "CWE-79",
    "filename": "src/main/java/org/apache/sling/xss/impl/XSSAPIImpl.java",
    "is_vulnerable": 0,
    "class_name": "XSSAPIImpl",
    "subclass_name": null,
    "function_name": "filterHTML(String source)",
    "function_body": "{\n        return xssFilter.filter(ProtectionContext.HTML_HTML_CONTENT, source);\n    }"
  },
  {
    "id": 24,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 0,
    "human_patch": "https://github.com/apache/sling-org-apache-sling-xss/commit/ec6764d165abc4df8cffd8439761bb2228887db9",
    "cve_id": "CVE-2017-15717",
    "cwe_id": "CWE-79",
    "filename": "src/test/java/org/apache/sling/xss/impl/XSSAPIImplTest.java",
    "is_vulnerable": 0,
    "class_name": "XSSAPIImplTest",
    "subclass_name": null,
    "function_name": "setup()",
    "function_body": "{\n        try {\n            XSSFilterImpl xssFilter = new XSSFilterImpl();\n            setDefaultHandler(xssFilter, \"./src/main/resources/SLING-INF/content/config.xml\");\n\n            xssAPI = new XSSAPIImpl();\n            Whitebox.invokeMethod(xssAPI, \"activate\");\n            Field filterField = XSSAPIImpl.class.getDeclaredField(\"xssFilter\");\n            filterField.setAccessible(true);\n            filterField.set(xssAPI, xssFilter);\n\n            ResourceResolver mockResolver = mock(ResourceResolver.class);\n            when(mockResolver.map(anyString())).thenAnswer(new Answer() {\n                public Object answer(InvocationOnMock invocation) {\n                    Object[] args = invocation.getArguments();\n                    String url = (String) args[0];\n                    return url.replaceAll(\"jcr:\", \"_jcr_\");\n                }\n            });\n        } catch (Exception e) {\n            e.printStackTrace();\n        }\n    }"
  },
  {
    "id": 24,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 1,
    "human_patch": "https://github.com/apache/sling-org-apache-sling-xss/commit/ec6764d165abc4df8cffd8439761bb2228887db9",
    "cve_id": "CVE-2017-15717",
    "cwe_id": "CWE-79",
    "filename": "src/test/java/org/apache/sling/xss/impl/XSSAPIImplTest.java",
    "is_vulnerable": 0,
    "class_name": "XSSAPIImplTest",
    "subclass_name": null,
    "function_name": "answer(InvocationOnMock invocation)",
    "function_body": "{\n                    Object[] args = invocation.getArguments();\n                    String url = (String) args[0];\n                    return url.replaceAll(\"jcr:\", \"_jcr_\");\n                }"
  },
  {
    "id": 24,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 2,
    "human_patch": "https://github.com/apache/sling-org-apache-sling-xss/commit/ec6764d165abc4df8cffd8439761bb2228887db9",
    "cve_id": "CVE-2017-15717",
    "cwe_id": "CWE-79",
    "filename": "src/test/java/org/apache/sling/xss/impl/XSSAPIImplTest.java",
    "is_vulnerable": 0,
    "class_name": "XSSAPIImplTest",
    "subclass_name": null,
    "function_name": "setDefaultHandler(XSSFilterImpl xssFilter, String filename) throws Exception",
    "function_body": "{\n        InputStream policyStream = new FileInputStream(filename);\n        Policy policy = Policy.getInstance(policyStream);\n        AntiSamy antiSamy = new AntiSamy(policy);\n\n        PolicyHandler mockPolicyHandler = mock(PolicyHandler.class);\n        when(mockPolicyHandler.getPolicy()).thenReturn(policy);\n        when(mockPolicyHandler.getAntiSamy()).thenReturn(antiSamy);\n\n        Whitebox.invokeMethod(xssFilter, \"setDefaultHandler\", mockPolicyHandler);\n    }"
  },
  {
    "id": 24,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 3,
    "human_patch": "https://github.com/apache/sling-org-apache-sling-xss/commit/ec6764d165abc4df8cffd8439761bb2228887db9",
    "cve_id": "CVE-2017-15717",
    "cwe_id": "CWE-79",
    "filename": "src/test/java/org/apache/sling/xss/impl/XSSAPIImplTest.java",
    "is_vulnerable": 0,
    "class_name": "XSSAPIImplTest",
    "subclass_name": null,
    "function_name": "testEncodeForHTML()",
    "function_body": "{\n        String[][] testData = {\n                \n                \n                {null, null},\n                {\"simple\", \"simple\"},\n\n                {\"<script>\", \"&lt;script&gt;\"},\n                {\"<b>\", \"&lt;b&gt;\"},\n\n                {\"g\u00fcnter\", \"g\u00fcnter\"},\n                {\"\\u30e9\\u30c9\\u30af\\u30ea\\u30d5\\u3001\\u30de\\u30e9\\u30bd\\u30f3\\u4e94\\u8f2a\\u4ee3\\u8868\\u306b1\\u4e07m\\u51fa\\u5834\\u306b\\u3082\\u542b\\u307f\", \"\\u30e9\\u30c9\\u30af\\u30ea\\u30d5\\u3001\\u30de\\u30e9\\u30bd\\u30f3\\u4e94\\u8f2a\\u4ee3\\u8868\\u306b1\\u4e07m\\u51fa\\u5834\\u306b\\u3082\\u542b\\u307f\"}\n        };\n\n        for (String[] aTestData : testData) {\n            String source = aTestData[0];\n            String expected = aTestData[1];\n\n            TestCase.assertEquals(\"HTML Encoding '\" + source + \"'\", expected, xssAPI.encodeForHTML(source));\n        }\n    }\n\n"
  },
  {
    "id": 24,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 4,
    "human_patch": "https://github.com/apache/sling-org-apache-sling-xss/commit/ec6764d165abc4df8cffd8439761bb2228887db9",
    "cve_id": "CVE-2017-15717",
    "cwe_id": "CWE-79",
    "filename": "src/test/java/org/apache/sling/xss/impl/XSSAPIImplTest.java",
    "is_vulnerable": 0,
    "class_name": "XSSAPIImplTest",
    "subclass_name": null,
    "function_name": "stEncodeForHTMLAttr() {",
    "function_body": "        String[][] testData = {\n                \n                \n                {null, null},\n                {\"simple\", \"simple\"},\n\n                {\"<script>\", \"&lt;script>\"},\n                {\"\\\" <script>alert('pwned');</script>\", \"&#34; &lt;script>alert(&#39;pwned&#39;);&lt;/script>\"},\n                {\"g\u00fcnter\", \"g\u00fcnter\"},\n                {\"\\u30e9\\u30c9\\u30af\\u30ea\\u30d5\\u3001\\u30de\\u30e9\\u30bd\\u30f3\\u4e94\\u8f2a\\u4ee3\\u8868\\u306b1\\u4e07m\\u51fa\\u5834\\u306b\\u3082\\u542b\\u307f\", \"\\u30e9\\u30c9\\u30af\\u30ea\\u30d5\\u3001\\u30de\\u30e9\\u30bd\\u30f3\\u4e94\\u8f2a\\u4ee3\\u8868\\u306b1\\u4e07m\\u51fa\\u5834\\u306b\\u3082\\u542b\\u307f\"}\n        };\n\n        for (String[] aTestData : testData) {\n            String source = aTestData[0];\n            String expected = aTestData[1];\n\n            TestCase.assertEquals(\"HTML Encoding '\" + source + \"'\", expected, xssAPI.encodeForHTMLAttr(source));\n        }\n    }\n\n  "
  },
  {
    "id": 24,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 5,
    "human_patch": "https://github.com/apache/sling-org-apache-sling-xss/commit/ec6764d165abc4df8cffd8439761bb2228887db9",
    "cve_id": "CVE-2017-15717",
    "cwe_id": "CWE-79",
    "filename": "src/test/java/org/apache/sling/xss/impl/XSSAPIImplTest.java",
    "is_vulnerable": 0,
    "class_name": "XSSAPIImplTest",
    "subclass_name": null,
    "function_name": "EncodeForXML() {\n ",
    "function_body": "      String[][] testData = {\n                \n                \n                {null, null},\n                {\"simple\", \"simple\"},\n\n                {\"<script>\", \"&lt;script&gt;\"},\n                {\"<b>\", \"&lt;b&gt;\"},\n\n                {\"g\u00fcnter\", \"g\u00fcnter\"}\n        };\n\n        for (String[] aTestData : testData) {\n            String source = aTestData[0];\n            String expected = aTestData[1];\n\n            TestCase.assertEquals(\"XML Encoding '\" + source + \"'\", expected, xssAPI.encodeForXML(source));\n        }\n    }\n\n    "
  },
  {
    "id": 24,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 6,
    "human_patch": "https://github.com/apache/sling-org-apache-sling-xss/commit/ec6764d165abc4df8cffd8439761bb2228887db9",
    "cve_id": "CVE-2017-15717",
    "cwe_id": "CWE-79",
    "filename": "src/test/java/org/apache/sling/xss/impl/XSSAPIImplTest.java",
    "is_vulnerable": 0,
    "class_name": "XSSAPIImplTest",
    "subclass_name": null,
    "function_name": "codeForXMLAttr() {\n   ",
    "function_body": "    String[][] testData = {\n                \n                \n                {null, null},\n                {\"simple\", \"simple\"},\n\n                {\"<script>\", \"&lt;script>\"},\n                {\"<b>\", \"&lt;b>\"},\n\n                {\"g\u00fcnter\", \"g\u00fcnter\"},\n                {\"\\\"xss:expression(alert('XSS'))\", \"&#34;xss:expression(alert(&#39;XSS&#39;))\"}\n        };\n\n        for (String[] aTestData : testData) {\n            String source = aTestData[0];\n            String expected = aTestData[1];\n\n            TestCase.assertEquals(\"XML Encoding '\" + source + \"'\", expected, xssAPI.encodeForXMLAttr(source));\n        }\n    }\n\n    @T"
  },
  {
    "id": 24,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 7,
    "human_patch": "https://github.com/apache/sling-org-apache-sling-xss/commit/ec6764d165abc4df8cffd8439761bb2228887db9",
    "cve_id": "CVE-2017-15717",
    "cwe_id": "CWE-79",
    "filename": "src/test/java/org/apache/sling/xss/impl/XSSAPIImplTest.java",
    "is_vulnerable": 0,
    "class_name": "XSSAPIImplTest",
    "subclass_name": null,
    "function_name": "erHTML() {\n     ",
    "function_body": "  String[][] testData = {\n                \n                {null, \"\"},\n                {\"\", \"\"},\n                {\"simple\", \"simple\"},\n\n                {\"<script>ugly</script>\", \"\"},\n                {\"<b>wow!</b>\", \"<b>wow!</b>\"},\n\n                {\"<p onmouseover='ugly'>nice</p>\", \"<p>nice</p>\"},\n\n                {\"<img src='javascript:ugly'/>\", \"\"},\n                {\"<img src='nice.jpg'/>\", \"<img src=\\\"nice.jpg\\\" />\"},\n\n                {\"<ul><li>1</li><li>2</li></ul>\", \"<ul><li>1</li><li>2</li></ul>\"},\n\n                {\"g\u00fcnter\", \"g\u00fcnter\"},\n\n\n                {\"<strike>strike</strike>\", \"<strike>strike</strike>\"},\n                {\"<s>s</s>\", \"<s>s</s>\"},\n\n                {\"<a href=\\\"\\\">empty href</a>\", \"<a href=\\\"\\\">empty href</a>\"},\n                {\"<a href=\\\" javascript:alert(23)\\\">space</a>\",\"<a>space</a>\"},\n                {\"<table background=\\\"http://www.google.com\\\"></table>\", \"<table></table>\"},\n        };\n\n        for (String[] aTestData : testData) {\n            String source = aTestData[0];\n            String expected = aTestData[1];\n\n            TestCase.assertEquals(\"Filtering '\" + source + \"'\", expected, xssAPI.filterHTML(source));\n        }\n    }\n\n    @Tes"
  },
  {
    "id": 24,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 8,
    "human_patch": "https://github.com/apache/sling-org-apache-sling-xss/commit/ec6764d165abc4df8cffd8439761bb2228887db9",
    "cve_id": "CVE-2017-15717",
    "cwe_id": "CWE-79",
    "filename": "src/test/java/org/apache/sling/xss/impl/XSSAPIImplTest.java",
    "is_vulnerable": 1,
    "class_name": "XSSAPIImplTest",
    "subclass_name": null,
    "function_name": "idHref() {\n       ",
    "function_body": "String[][] testData = {\n                \n                \n                {\n                    \"/base?backHref=%26%23x6a%3b%26%23x61%3b%26%23x76%3b%26%23x61%3b%26%23x73%3b%26%23x63%3b%26%23x72%3b%26%23x69%3b%26%23x70%3b%26%23x74%3b%26%23x3a%3balert%281%29\",\n                    \"/base?backHref=javascript%3Aalert(1)\"\n                },\n                {\n                    \"%26%23x6a%3b%26%23x61%3b%26%23x76%3b%26%23x61%3b%26%23x73%3b%26%23x63%3b%26%23x72%3b%26%23x69%3b%26%23x70%3b%26%23x74%3b%26%23x3a%3balert%281%29\",\n                    \"\"\n                },\n                {\n                    \"&#x6a;&#x61;&#x76;&#x61;&#x73;&#x63;&#x72;&#x69;&#x70;&#x74;&#x3a;alert(1)\",\n                    \"\"\n                },\n                {\"%2Fscripts%2Ftest.js\", \"/scripts/test.js\"},\n                {\"/etc/commerce/collections/\u4e2d\u6587\", \"/etc/commerce/collections/\u4e2d\u6587\"},\n                {\"/etc/commerce/collections/\\u09aa\\u09b0\\u09c0\\u0995\\u09cd\\u09b7\\u09be\\u09ae\\u09c2\\u09b2\\u0995\", \"/etc/commerce/collections/\\u09aa\\u09b0\\u09c0\\u0995\\u09cd\\u09b7\\u09be\\u09ae\\u09c2\\u09b2\\u0995\"},\n                {null, \"\"},\n                {\"\", \"\"},\n                {\"simple\", \"simple\"},\n\n                {\"../parent\", \"../parent\"},\n                {\"repo/g\u00fcnter\", \"repo/g\u00fcnter\"},\n\n                \n                {\"my/page/jcr:content.feed\", \"my/page/_jcr_content.feed\"},\n                {\"my/jcr:content/page/jcr:content\", \"my/_jcr_content/page/_jcr_content\"},\n\n                {\"\\\" onClick=ugly\", \"%22%20onClick=ugly\"},\n                {\"javascript:ugly\", \"\"},\n                {\"http://localhost:4502\", \"http://localhost:4502\"},\n                {\"http://localhost:4502/test\", \"http://localhost:4502/test\"},\n                {\"http://localhost:4502/jcr:content/test\", \"http://localhost:4502/_jcr_content/test\"},\n                {\"http://localhost:4502/test.html?a=b&b=c\", \"http://localhost:4502/test.html?a=b&b=c\"},\n\n                \n                {\"/test/ab cd\", \"/test/ab%20cd\"},\n                {\"http://localhost:4502/test/ab cd\", \"http://localhost:4502/test/ab%20cd\"},\n                {\"/test/ab attr=c\", \"/test/ab%20attr=c\"},\n                {\"http://localhost:4502/test/ab attr=c\", \"http://localhost:4502/test/ab%20attr=c\"},\n                \n                {\"/test/ab\\\"cd\", \"/test/ab%22cd\"},\n                {\"http://localhost:4502/test/ab\\\"cd\", \"http://localhost:4502/test/ab%22cd\"},\n                \n                {\"/test/ab'cd\", \"/test/ab%27cd\"},\n                {\"http://localhost:4502/test/ab'cd\", \"http://localhost:4502/test/ab%27cd\"},\n                \n                {\"/test/ab=cd\", \"/test/ab=cd\"},\n                {\"http://localhost:4502/test/ab=cd\", \"http://localhost:4502/test/ab=cd\"},\n                \n                {\"/test/ab>cd\", \"/test/ab%3Ecd\"},\n                {\"http://localhost:4502/test/ab>cd\", \"http://localhost:4502/test/ab%3Ecd\"},\n                \n                {\"/test/ab<cd\", \"/test/ab%3Ccd\"},\n                {\"http://localhost:4502/test/ab<cd\", \"http://localhost:4502/test/ab%3Ccd\"},\n                \n                {\"/test/ab`cd\", \"/test/ab%60cd\"},\n                {\"http://localhost:4502/test/ab`cd\", \"http://localhost:4502/test/ab%60cd\"},\n                \n                {\"/test/search.html?0_tag:id=test\", \"/test/search.html?0_tag%3Aid=test\"},\n                { \n                        \"/test/jcr:content/search.html?0_tag:id=test\",\n                        \"/test/_jcr_content/search.html?0_tag%3Aid=test\"\n                },\n                { \n                        \"/test/search.html?0_tag:id=test?ing&1_tag:id=abc\",\n                        \"/test/search.html?0_tag%3Aid=test?ing&1_tag%3Aid=abc\",\n                }\n        };\n\n        for (String[] aTestData : testData) {\n            String href = aTestData[0];\n            String expected = aTestData[1];\n\n            TestCase.assertEquals(\"Requested '\" + href + \"'\", expected, xssAPI.getValidHref(href));\n        }\n    }\n\n    @Test\n    publ"
  },
  {
    "id": 24,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 9,
    "human_patch": "https://github.com/apache/sling-org-apache-sling-xss/commit/ec6764d165abc4df8cffd8439761bb2228887db9",
    "cve_id": "CVE-2017-15717",
    "cwe_id": "CWE-79",
    "filename": "src/test/java/org/apache/sling/xss/impl/XSSAPIImplTest.java",
    "is_vulnerable": 0,
    "class_name": "XSSAPIImplTest",
    "subclass_name": null,
    "function_name": "outHrefConfig() throws Exception {\n        \n        ",
    "function_body": "SSFilterImpl xssFilter = Whitebox.getInternalState(xssAPI, \"xssFilter\");\n        setDefaultHandler(xssFilter, \"./src/test/resources/configWithoutHref.xml\");\n\n        Attribute hrefAttribute = Whitebox.getInternalState(xssFilter, \"hrefAttribute\");\n        Assert.assertEquals(hrefAttribute, XSSFilterImpl.DEFAULT_HREF_ATTRIBUTE);\n\n        \n        testGetValidHref();\n    }\n\n    @Test\n    publ"
  },
  {
    "id": 24,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 10,
    "human_patch": "https://github.com/apache/sling-org-apache-sling-xss/commit/ec6764d165abc4df8cffd8439761bb2228887db9",
    "cve_id": "CVE-2017-15717",
    "cwe_id": "CWE-79",
    "filename": "src/test/java/org/apache/sling/xss/impl/XSSAPIImplTest.java",
    "is_vulnerable": 0,
    "class_name": "XSSAPIImplTest",
    "subclass_name": null,
    "function_name": ") {\n        String[][",
    "function_body": " testData = {\n                \n                \n                {null, \"123\"},\n                {\"100\", \"100\"},\n                {\"0\", \"0\"},\n\n                {\"junk\", \"123\"},\n                {\"100.5\", \"123\"},\n                {\"\", \"123\"},\n                {\"null\", \"123\"}\n        };\n\n        for (String[] aTestData : testData) {\n            String source = aTestData[0];\n            Integer expected = (aTestData[1] != null) ? new Integer(aTestData[1]) : null;\n\n            TestCase.assertEquals(\"Validating integer '\" + source + \"'\", expected, xssAPI.getValidInteger(source, 123));\n        }\n    }\n\n    @Test\n    publ"
  },
  {
    "id": 24,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 11,
    "human_patch": "https://github.com/apache/sling-org-apache-sling-xss/commit/ec6764d165abc4df8cffd8439761bb2228887db9",
    "cve_id": "CVE-2017-15717",
    "cwe_id": "CWE-79",
    "filename": "src/test/java/org/apache/sling/xss/impl/XSSAPIImplTest.java",
    "is_vulnerable": 0,
    "class_name": "XSSAPIImplTest",
    "subclass_name": null,
    "function_name": "\n        String[][",
    "function_body": " testData = {\n                \n                \n                {null, \"123\"},\n                {\"100\", \"100\"},\n                {\"0\", \"0\"},\n\n                {\"junk\", \"123\"},\n                {\"100.5\", \"123\"},\n                {\"\", \"123\"},\n                {\"null\", \"123\"}\n        };\n\n        for (String[] aTestData : testData) {\n            String source = aTestData[0];\n            Long expected = (aTestData[1] != null) ? new Long(aTestData[1]) : null;\n\n            TestCase.assertEquals(\"Validating long '\" + source + \"'\", expected, xssAPI.getValidLong(source, 123));\n        }\n    }\n\n    @Test\n    publ"
  },
  {
    "id": 24,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 12,
    "human_patch": "https://github.com/apache/sling-org-apache-sling-xss/commit/ec6764d165abc4df8cffd8439761bb2228887db9",
    "cve_id": "CVE-2017-15717",
    "cwe_id": "CWE-79",
    "filename": "src/test/java/org/apache/sling/xss/impl/XSSAPIImplTest.java",
    "is_vulnerable": 0,
    "class_name": "XSSAPIImplTest",
    "subclass_name": null,
    "function_name": " {\n        String[][",
    "function_body": " testData = {\n                \n                \n                {null, \"123\"},\n                {\"100.5\", \"100.5\"},\n                {\"0\", \"0\"},\n\n                {\"junk\", \"123\"},\n                {\"\", \"123\"},\n                {\"null\", \"123\"}\n        };\n\n        for (String[] aTestData : testData) {\n            String source = aTestData[0];\n            Double expected = (aTestData[1] != null) ? new Double(aTestData[1]) : null;\n\n            TestCase.assertEquals(\"Validating double '\" + source + \"'\", expected, xssAPI.getValidDouble(source, 123));\n        }\n    }\n\n    @Test\n    publ"
  },
  {
    "id": 24,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 13,
    "human_patch": "https://github.com/apache/sling-org-apache-sling-xss/commit/ec6764d165abc4df8cffd8439761bb2228887db9",
    "cve_id": "CVE-2017-15717",
    "cwe_id": "CWE-79",
    "filename": "src/test/java/org/apache/sling/xss/impl/XSSAPIImplTest.java",
    "is_vulnerable": 0,
    "class_name": "XSSAPIImplTest",
    "subclass_name": null,
    "function_name": "n() {\n        String[][",
    "function_body": " testData = {\n                \n                \n                {null, \"123\"},\n                {\"\", \"123\"},\n                {\"100\", \"100\"},\n                {\"0\", \"0\"},\n\n                {\"junk\", \"123\"},\n                {\"100.5\", \"123\"},\n                {\"\", \"123\"},\n                {\"null\", \"123\"},\n\n                {\"\\\"auto\\\"\", \"\\\"auto\\\"\"},\n                {\"'auto'\", \"\\\"auto\\\"\"},\n                {\"auto\", \"\\\"auto\\\"\"},\n\n                {\"autox\", \"123\"}\n        };\n\n        for (String[] aTestData : testData) {\n            String source = aTestData[0];\n            String expected = aTestData[1];\n\n            TestCase.assertEquals(\"Validating dimension '\" + source + \"'\", expected, xssAPI.getValidDimension(source, \"123\"));\n        }\n    }\n\n    @Test\n    publ"
  },
  {
    "id": 24,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 14,
    "human_patch": "https://github.com/apache/sling-org-apache-sling-xss/commit/ec6764d165abc4df8cffd8439761bb2228887db9",
    "cve_id": "CVE-2017-15717",
    "cwe_id": "CWE-79",
    "filename": "src/test/java/org/apache/sling/xss/impl/XSSAPIImplTest.java",
    "is_vulnerable": 0,
    "class_name": "XSSAPIImplTest",
    "subclass_name": null,
    "function_name": "g() {\n        String[][",
    "function_body": " testData = {\n                \n                \n                {null, null},\n                {\"simple\", \"simple\"},\n\n                {\"break\\\"out\", \"break\\\\x22out\"},\n                {\"break'out\", \"break\\\\x27out\"},\n\n                {\"</script>\", \"<\\\\/script>\"},\n\n                {\"'alert(document.cookie)\", \"\\\\x27alert(document.cookie)\"},\n                {\"2014-04-22T10:11:24.002+01:00\", \"2014\\\\u002D04\\\\u002D22T10:11:24.002+01:00\"}\n        };\n\n        for (String[] aTestData : testData) {\n            String source = aTestData[0];\n            String expected = aTestData[1];\n\n            TestCase.assertEquals(\"Encoding '\" + source + \"'\", expected, xssAPI.encodeForJSString(source));\n        }\n    }\n\n    @Test\n    publ"
  },
  {
    "id": 24,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 15,
    "human_patch": "https://github.com/apache/sling-org-apache-sling-xss/commit/ec6764d165abc4df8cffd8439761bb2228887db9",
    "cve_id": "CVE-2017-15717",
    "cwe_id": "CWE-79",
    "filename": "src/test/java/org/apache/sling/xss/impl/XSSAPIImplTest.java",
    "is_vulnerable": 1,
    "class_name": "XSSAPIImplTest",
    "subclass_name": null,
    "function_name": ") {\n        String[][",
    "function_body": " testData = {\n                \n                \n                {null, RUBBISH},\n                {\"\", RUBBISH},\n                {\"simple\", \"simple\"},\n                {\"clickstreamcloud.thingy\", \"clickstreamcloud.thingy\"},\n\n                {\"break out\", RUBBISH},\n                {\"break,out\", RUBBISH},\n\n                {\"\\\"literal string\\\"\", \"\\\"literal string\\\"\"},\n                {\"'literal string'\", \"'literal string'\"},\n                {\"\\\"bad literal'\", RUBBISH},\n                {\"'literal'); junk'\", \"'literal\\\\x27); junk'\"},\n\n                {\"1200\", \"1200\"},\n                {\"3.14\", \"3.14\"},\n                {\"1,200\", RUBBISH},\n                {\"1200 + 1\", RUBBISH}\n        };\n\n        for (String[] aTestData : testData) {\n            String source = aTestData[0];\n            String expected = aTestData[1];\n\n            TestCase.assertEquals(\"Validating Javascript token '\" + source + \"'\", expected, xssAPI.getValidJSToken(source, RUBBISH));\n        }\n    }\n\n    @Test\n    publ"
  },
  {
    "id": 24,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 16,
    "human_patch": "https://github.com/apache/sling-org-apache-sling-xss/commit/ec6764d165abc4df8cffd8439761bb2228887db9",
    "cve_id": "CVE-2017-15717",
    "cwe_id": "CWE-79",
    "filename": "src/test/java/org/apache/sling/xss/impl/XSSAPIImplTest.java",
    "is_vulnerable": 0,
    "class_name": "XSSAPIImplTest",
    "subclass_name": null,
    "function_name": "ng() {\n        String[][",
    "function_body": " testData = {\n                \n                {null, null},\n                {\"test\"   , \"test\"},\n                {\"\\\\\"     , \"\\\\5c\"},\n                {\"'\"      , \"\\\\27\"},\n                {\"\\\"\"     , \"\\\\22\"}\n        };\n\n        for (String[] aTestData : testData) {\n            String source = aTestData[0];\n            String expected = aTestData[1];\n\n            String result = xssAPI.encodeForCSSString(source);\n            TestCase.assertEquals(\"Encoding '\" + source + \"'\", expected, result);\n        }\n    }\n\n    @Test\n    publ"
  },
  {
    "id": 24,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 17,
    "human_patch": "https://github.com/apache/sling-org-apache-sling-xss/commit/ec6764d165abc4df8cffd8439761bb2228887db9",
    "cve_id": "CVE-2017-15717",
    "cwe_id": "CWE-79",
    "filename": "src/test/java/org/apache/sling/xss/impl/XSSAPIImplTest.java",
    "is_vulnerable": 0,
    "class_name": "XSSAPIImplTest",
    "subclass_name": null,
    "function_name": "en() {\n        String[][",
    "function_body": " testData = {\n                \n                {null                               , RUBBISH},\n                {\"\"                                 , RUBBISH},\n\n                \n                {\"}\"                                , RUBBISH},\n\n                \n                {\"br\\neak\"                          , RUBBISH},\n\n                \n                {\"javascript:alert(1)\"              , RUBBISH},\n                {\"'javascript:alert(1)'\"            , RUBBISH},\n                {\"\\\"javascript:alert('XSS')\\\"\"      , RUBBISH},\n                {\"url(javascript:alert(1))\"         , RUBBISH},\n                {\"url('javascript:alert(1)')\"       , RUBBISH},\n                {\"url(\\\"javascript:alert('XSS')\\\")\" , RUBBISH},\n\n                \n                {\"expression(alert(1))\"             , RUBBISH},\n                {\"expression  (alert(1))\"           , RUBBISH},\n                {\"expression(this.location='a.co')\" , RUBBISH},\n\n                \n                {\"</style><script>alert(1)</script>\", RUBBISH},\n\n                \n                {\"background-color\"                 , \"background-color\"},\n                {\"-moz-box-sizing\"                  , \"-moz-box-sizing\"},\n                {\".42%\"                             , \".42%\"},\n                {\"#fff\"                             , \"#fff\"},\n\n                \n                {\"'literal string'\"                 , \"'literal string'\"},\n                {\"\\\"literal string\\\"\"               , \"\\\"literal string\\\"\"},\n                {\"'it\\\\'s here'\"                    , \"'it\\\\'s here'\"},\n                {\"\\\"it\\\\\\\"s here\\\"\"                 , \"\\\"it\\\\\\\"s here\\\"\"},\n\n                \n                {\"\\\"bad string\"                     , RUBBISH},\n                {\"'it's here'\"                      , RUBBISH},\n                {\"\\\"it\\\"s here\\\"\"                   , RUBBISH},\n\n                \n                {\"rgb(255, 255, 255)\"               , \"rgb(255, 255, 255)\"},\n\n                \n                {\"rgb(255, 255, 255\"               , RUBBISH},\n                {\"255, 255, 255)\"                  , RUBBISH},\n\n                \n                {\"url(http://example.com/test.png)\", \"url(http://example.com/test.png)\"},\n                {\"url('image/test.png')\"           , \"url('image/test.png')\"},\n\n                \n                {\"color: red\"                      , RUBBISH}\n        };\n\n        for (String[] aTestData : testData) {\n            String source = aTestData[0];\n            String expected = aTestData[1];\n\n            String result = xssAPI.getValidStyleToken(source, RUBBISH);\n            if (!result.equals(expected)) {\n                fail(\"Validating style token '\" + source + \"', expecting '\" + expected + \"', but got '\" + result + \"'\");\n            }\n        }\n    }\n\n    @Test\n    publ"
  },
  {
    "id": 24,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 18,
    "human_patch": "https://github.com/apache/sling-org-apache-sling-xss/commit/ec6764d165abc4df8cffd8439761bb2228887db9",
    "cve_id": "CVE-2017-15717",
    "cwe_id": "CWE-79",
    "filename": "src/test/java/org/apache/sling/xss/impl/XSSAPIImplTest.java",
    "is_vulnerable": 0,
    "class_name": "XSSAPIImplTest",
    "subclass_name": null,
    "function_name": "() {\n        String[][",
    "function_body": " testData = {\n                \n                \n                {null, RUBBISH},\n                {\"\", RUBBISH},\n\n                {\"rgb(0,+0,-0)\", \"rgb(0,+0,-0)\"},\n                {\"rgba ( 0\\f%, 0%,\\t0%,\\n100%\\r)\", \"rgba ( 0\\f%, 0%,\\t0%,\\n100%\\r)\",},\n\n                {\"#ddd\", \"#ddd\"},\n                {\"#eeeeee\", \"#eeeeee\",},\n\n                {\"hsl(0,1,2)\", \"hsl(0,1,2)\"},\n                {\"hsla(0,1,2,3)\", \"hsla(0,1,2,3)\"},\n                {\"currentColor\", \"currentColor\"},\n                {\"transparent\", \"transparent\"},\n\n                {\"\\f\\r\\n\\t MenuText\\f\\r\\n\\t \", \"MenuText\"},\n                {\"expression(99,99,99)\", RUBBISH},\n                {\"blue;\", RUBBISH},\n                {\"url(99,99,99)\", RUBBISH}\n        };\n\n        for (String[] aTestData : testData) {\n            String source = aTestData[0];\n            String expected = aTestData[1];\n\n            String result = xssAPI.getValidCSSColor(source, RUBBISH);\n            if (!result.equals(expected)) {\n                fail(\"Validating CSS Color '\" + source + \"', expecting '\" + expected + \"', but got '\" + result + \"'\");\n            }\n        }\n    }\n\n    @Test\n    publ"
  },
  {
    "id": 24,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 19,
    "human_patch": "https://github.com/apache/sling-org-apache-sling-xss/commit/ec6764d165abc4df8cffd8439761bb2228887db9",
    "cve_id": "CVE-2017-15717",
    "cwe_id": "CWE-79",
    "filename": "src/test/java/org/apache/sling/xss/impl/XSSAPIImplTest.java",
    "is_vulnerable": 0,
    "class_name": "XSSAPIImplTest",
    "subclass_name": null,
    "function_name": "eComment() {\n        String[][",
    "function_body": " testData = {\n                \n\n                {null               , RUBBISH},\n                {\"blah */ hack\"     , RUBBISH},\n\n                {\"Valid comment\"    , \"Valid comment\"}\n        };\n        for (String[] aTestData : testData) {\n            String source = aTestData[0];\n            String expected = aTestData[1];\n\n            String result = xssAPI.getValidMultiLineComment(source, RUBBISH);\n            if (!result.equals(expected)) {\n                fail(\"Validating multiline comment '\" + source + \"', expecting '\" + expected + \"', but got '\" + result + \"'\");\n            }\n        }\n    }\n\n    @Test\n    publ"
  },
  {
    "id": 24,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 20,
    "human_patch": "https://github.com/apache/sling-org-apache-sling-xss/commit/ec6764d165abc4df8cffd8439761bb2228887db9",
    "cve_id": "CVE-2017-15717",
    "cwe_id": "CWE-79",
    "filename": "src/test/java/org/apache/sling/xss/impl/XSSAPIImplTest.java",
    "is_vulnerable": 1,
    "class_name": "XSSAPIImplTest",
    "subclass_name": null,
    "function_name": "\n        String[][",
    "function_body": " testData = {\n                {null,      RUBBISH_JSON},\n                {\"\",        \"\"},\n                {\"1]\",      RUBBISH_JSON},\n                {\"{}\",      \"{}\"},\n                {\"{1}\",     RUBBISH_JSON},\n                {\n                        \"{\\\"test\\\": \\\"test\\\"}\",\n                        \"{\\\"test\\\":\\\"test\\\"}\"\n                },\n                {\n                        \"{\\\"test\\\":\\\"test}\",\n                        RUBBISH_JSON\n                },\n                {\n                        \"{\\\"test1\\\":\\\"test1\\\", \\\"test2\\\": {\\\"test21\\\": \\\"test21\\\", \\\"test22\\\": \\\"test22\\\"}}\",\n                        \"{\\\"test1\\\":\\\"test1\\\",\\\"test2\\\":{\\\"test21\\\":\\\"test21\\\",\\\"test22\\\":\\\"test22\\\"}}\"\n                },\n                {\"[]\",      \"[]\"},\n                {\"[1,2]\",   \"[1,2]\"},\n                {\"[1\",      RUBBISH_JSON},\n                {\n                        \"[{\\\"test\\\": \\\"test\\\"}]\",\n                        \"[{\\\"test\\\":\\\"test\\\"}]\"\n                }\n        };\n        for (String[] aTestData : testData) {\n            String source = aTestData[0];\n            String expected = aTestData[1];\n\n            String result = xssAPI.getValidJSON(source, RUBBISH_JSON);\n            if (!result.equals(expected)) {\n                fail(\"Validating JSON '\" + source + \"', expecting '\" + expected + \"', but got '\" + result + \"'\");\n            }\n        }\n    }\n\n    @Test\n    publ"
  },
  {
    "id": 24,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 21,
    "human_patch": "https://github.com/apache/sling-org-apache-sling-xss/commit/ec6764d165abc4df8cffd8439761bb2228887db9",
    "cve_id": "CVE-2017-15717",
    "cwe_id": "CWE-79",
    "filename": "src/test/java/org/apache/sling/xss/impl/XSSAPIImplTest.java",
    "is_vulnerable": 0,
    "class_name": "XSSAPIImplTest",
    "subclass_name": null,
    "function_name": "        String[][",
    "function_body": " testData = {\n                {null,      RUBBISH_XML},\n                {\"\",        \"\"},\n                {\n                        \"<t/>\",\n                        \"<t/>\"\n                },\n                {\n                        \"<t>\",\n                        RUBBISH_XML\n                },\n                {\n                        \"<t>test</t>\",\n                        \"<t>test</t>\"\n                },\n                {\n                        \"<t>test\",\n                        RUBBISH_XML\n                },\n                {\n                        \"<t t=\\\"t\\\">test</t>\",\n                        \"<t t=\\\"t\\\">test</t>\"\n                },\n                {\n                        \"<t t=\\\"t>test</t>\",\n                        RUBBISH_XML\n                },\n                {\n                        \"<t><w>xyz</w></t>\",\n                        \"<t><w>xyz</w></t>\"\n                },\n                {\n                        \"<t><w>xyz</t></w>\",\n                        RUBBISH_XML\n                },\n                {\n                        \"<?xml version=\\\"1.0\\\"?><!DOCTYPE test SYSTEM \\\"http://nonExistentHost:1234/\\\"><test/>\",\n                        \"<?xml version=\\\"1.0\\\"?><!DOCTYPE test SYSTEM \\\"http://nonExistentHost:1234/\\\"><test/>\"\n                }\n        };\n        for (String[] aTestData : testData) {\n            String source = aTestData[0];\n            String expected = aTestData[1];\n\n            String result = xssAPI.getValidXML(source, RUBBISH_XML);\n            if (!result.equals(expected)) {\n                fail(\"Validating XML '\" + source + \"', expecting '\" + expected + \"', but got '\" + result + \"'\");\n            }\n        }\n    }\n}\n"
  },
  {
    "id": 25,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 0,
    "human_patch": "https://github.com/apache/struts/commit/a0fdca138feec2c2e94eb75ca1f8b76678b4d152",
    "cve_id": "CVE-2016-4465",
    "cwe_id": "CWE-20",
    "filename": "core/src/main/java/com/opensymphony/xwork2/validator/validators/URLValidator.java",
    "is_vulnerable": 0,
    "class_name": "URLValidator",
    "subclass_name": null,
    "function_name": "validate(Object object) throws ValidationException",
    "function_body": "{\n        String fieldName = getFieldName();\n        Object value = this.getFieldValue(fieldName, object);\n\n        \n        \n        if (value == null || value.toString().length() == 0) {\n            return;\n        }\n\n        if (!(value.getClass().equals(String.class)) || !Pattern.compile(getUrlRegex()).matcher((String) value).matches()) {\n            addFieldError(fieldName, object);\n        }\n    }"
  },
  {
    "id": 25,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 1,
    "human_patch": "https://github.com/apache/struts/commit/a0fdca138feec2c2e94eb75ca1f8b76678b4d152",
    "cve_id": "CVE-2016-4465",
    "cwe_id": "CWE-20",
    "filename": "core/src/main/java/com/opensymphony/xwork2/validator/validators/URLValidator.java",
    "is_vulnerable": 1,
    "class_name": "URLValidator",
    "subclass_name": null,
    "function_name": "getUrlRegex()",
    "function_body": "{\n        if (StringUtils.isNotEmpty(urlRegexExpression)) {\n            return (String) parse(urlRegexExpression, String.class);\n        } else if (StringUtils.isNotEmpty(urlRegex)) {\n            return urlRegex;\n        } else {\n            return \"^(https?|ftp):\\\\/\\\\/\" +\n                    \"(([a-z0-9$_\\\\.\\\\+!\\\\*\\\\'\\\\(\\\\),;\\\\?&=-]|%[0-9a-f]{2})+\" +\n                    \"(:([a-z0-9$_\\\\.\\\\+!\\\\*\\\\'\\\\(\\\\),;\\\\?&=-]|%[0-9a-f]{2})+)?\" +\n                    \"@)?(#?\" +\n                    \")((([a-z0-9]\\\\.|[a-z0-9][a-z0-9-]*[a-z0-9]\\\\.)*\" +\n                    \"[a-z][a-z0-9-]*[a-z0-9]\" +\n                    \"|((\\\\d|[1-9]\\\\d|1\\\\d{2}|2[0-4][0-9]|25[0-5])\\\\.){3}\" +\n                    \"(\\\\d|[1-9]\\\\d|1\\\\d{2}|2[0-4][0-9]|25[0-5])\" +\n                    \")(:\\\\d+)?\" +\n                    \")(((\\\\/+([a-z0-9$_\\\\.\\\\+!\\\\*\\\\'\\\\(\\\\),;:@&=-]|%[0-9a-f]{2})*)*\" +\n                    \"(\\\\?([a-z0-9$_\\\\.\\\\+!\\\\*\\\\'\\\\(\\\\),;:@&=-]|%[0-9a-f]{2})*)\" +\n                    \"?)?)?\" +\n                    \"(#([a-z0-9$_\\\\.\\\\+!\\\\*\\\\'\\\\(\\\\),;:@&=-]|%[0-9a-f]{2})*)?\" +\n                    \"$\";\n        }\n    }"
  },
  {
    "id": 25,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 2,
    "human_patch": "https://github.com/apache/struts/commit/a0fdca138feec2c2e94eb75ca1f8b76678b4d152",
    "cve_id": "CVE-2016-4465",
    "cwe_id": "CWE-20",
    "filename": "core/src/main/java/com/opensymphony/xwork2/validator/validators/URLValidator.java",
    "is_vulnerable": 0,
    "class_name": "URLValidator",
    "subclass_name": null,
    "function_name": "setUrlRegex(String urlRegex)",
    "function_body": "{\n        this.urlRegex = urlRegex;\n    }"
  },
  {
    "id": 25,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 3,
    "human_patch": "https://github.com/apache/struts/commit/a0fdca138feec2c2e94eb75ca1f8b76678b4d152",
    "cve_id": "CVE-2016-4465",
    "cwe_id": "CWE-20",
    "filename": "core/src/main/java/com/opensymphony/xwork2/validator/validators/URLValidator.java",
    "is_vulnerable": 0,
    "class_name": "URLValidator",
    "subclass_name": null,
    "function_name": "setUrlRegexExpression(String urlRegexExpression)",
    "function_body": "{\n        this.urlRegexExpression = urlRegexExpression;\n    }"
  },
  {
    "id": 25,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 0,
    "human_patch": "https://github.com/apache/struts/commit/a0fdca138feec2c2e94eb75ca1f8b76678b4d152",
    "cve_id": "CVE-2016-4465",
    "cwe_id": "CWE-20",
    "filename": "core/src/test/java/com/opensymphony/xwork2/validator/URLValidatorTest.java",
    "is_vulnerable": 0,
    "class_name": "URLValidatorTest",
    "subclass_name": null,
    "function_name": "testAcceptNullValueForMutualExclusionOfValidators() throws Exception",
    "function_body": "{\n\t\t\n\t\tURLValidator validator = new URLValidator();\n\t\tvalidator.setValidatorContext(new GenericValidatorContext(new Object()));\n\t\tvalidator.setFieldName(\"testingUrl1\");\n        validator.setValueStack(ActionContext.getContext().getValueStack());\n        validator.validate(new MyObject());\n\t\t\n\t\tassertFalse(validator.getValidatorContext().hasErrors());\n\t\tassertFalse(validator.getValidatorContext().hasActionErrors());\n\t\tassertFalse(validator.getValidatorContext().hasActionMessages());\n\t\tassertFalse(validator.getValidatorContext().hasFieldErrors());\n\t}"
  },
  {
    "id": 25,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 1,
    "human_patch": "https://github.com/apache/struts/commit/a0fdca138feec2c2e94eb75ca1f8b76678b4d152",
    "cve_id": "CVE-2016-4465",
    "cwe_id": "CWE-20",
    "filename": "core/src/test/java/com/opensymphony/xwork2/validator/URLValidatorTest.java",
    "is_vulnerable": 0,
    "class_name": "URLValidatorTest",
    "subclass_name": null,
    "function_name": "testInvalidEmptyValue() throws Exception",
    "function_body": "{\n\t\t\n\t\tURLValidator validator = new URLValidator();\n\t\tvalidator.setValidatorContext(new GenericValidatorContext(new Object()));\n\t\tvalidator.setFieldName(\"testingUrl2\");\n        validator.setValueStack(ActionContext.getContext().getValueStack());\n        validator.validate(new MyObject());\n\t\t\n\t\tassertFalse(validator.getValidatorContext().hasErrors());\n\t\tassertFalse(validator.getValidatorContext().hasActionErrors());\n\t\tassertFalse(validator.getValidatorContext().hasActionMessages());\n\t\tassertFalse(validator.getValidatorContext().hasFieldErrors());\n\t}"
  },
  {
    "id": 25,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 2,
    "human_patch": "https://github.com/apache/struts/commit/a0fdca138feec2c2e94eb75ca1f8b76678b4d152",
    "cve_id": "CVE-2016-4465",
    "cwe_id": "CWE-20",
    "filename": "core/src/test/java/com/opensymphony/xwork2/validator/URLValidatorTest.java",
    "is_vulnerable": 0,
    "class_name": "URLValidatorTest",
    "subclass_name": null,
    "function_name": "testInvalidValue() throws Exception",
    "function_body": "{\n\t\t\n\t\tURLValidator validator = new URLValidator();\n\t\tvalidator.setValidatorContext(new GenericValidatorContext(new Object()));\n\t\tvalidator.setFieldName(\"testingUrl3\");\n        validator.setValueStack(ActionContext.getContext().getValueStack());\n        validator.validate(new MyObject());\n\t\t\n\t\tassertTrue(validator.getValidatorContext().hasErrors());\n\t\tassertFalse(validator.getValidatorContext().hasActionErrors());\n\t\tassertFalse(validator.getValidatorContext().hasActionMessages());\n\t\tassertTrue(validator.getValidatorContext().hasFieldErrors());\n\t}"
  },
  {
    "id": 25,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 3,
    "human_patch": "https://github.com/apache/struts/commit/a0fdca138feec2c2e94eb75ca1f8b76678b4d152",
    "cve_id": "CVE-2016-4465",
    "cwe_id": "CWE-20",
    "filename": "core/src/test/java/com/opensymphony/xwork2/validator/URLValidatorTest.java",
    "is_vulnerable": 0,
    "class_name": "URLValidatorTest",
    "subclass_name": null,
    "function_name": "testValidUrl1() throws Exception",
    "function_body": "{\n\t\t\n\t\tURLValidator validator = new URLValidator();\n\t\tvalidator.setValidatorContext(new GenericValidatorContext(new Object()));\n\t\tvalidator.setFieldName(\"testingUrl4\");\n        validator.setValueStack(ActionContext.getContext().getValueStack());\n        validator.validate(new MyObject());\n\t\t\n\t\tassertFalse(validator.getValidatorContext().hasErrors());\n\t\tassertFalse(validator.getValidatorContext().hasActionErrors());\n\t\tassertFalse(validator.getValidatorContext().hasActionMessages());\n\t\tassertFalse(validator.getValidatorContext().hasFieldErrors());\n\t}"
  },
  {
    "id": 25,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 4,
    "human_patch": "https://github.com/apache/struts/commit/a0fdca138feec2c2e94eb75ca1f8b76678b4d152",
    "cve_id": "CVE-2016-4465",
    "cwe_id": "CWE-20",
    "filename": "core/src/test/java/com/opensymphony/xwork2/validator/URLValidatorTest.java",
    "is_vulnerable": 0,
    "class_name": "URLValidatorTest",
    "subclass_name": null,
    "function_name": "testValidUrl2() throws Exception",
    "function_body": "{\n\t\t\n\t\tURLValidator validator = new URLValidator();\n\t\tvalidator.setValidatorContext(new GenericValidatorContext(new Object()));\n\t\tvalidator.setFieldName(\"testingUrl5\");\n        validator.setValueStack(ActionContext.getContext().getValueStack());\n        validator.validate(new MyObject());\n\t\t\n\t\tassertFalse(validator.getValidatorContext().hasErrors());\n\t\tassertFalse(validator.getValidatorContext().hasActionErrors());\n\t\tassertFalse(validator.getValidatorContext().hasActionMessages());\n\t\tassertFalse(validator.getValidatorContext().hasFieldErrors());\n\t}"
  },
  {
    "id": 25,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 5,
    "human_patch": "https://github.com/apache/struts/commit/a0fdca138feec2c2e94eb75ca1f8b76678b4d152",
    "cve_id": "CVE-2016-4465",
    "cwe_id": "CWE-20",
    "filename": "core/src/test/java/com/opensymphony/xwork2/validator/URLValidatorTest.java",
    "is_vulnerable": 0,
    "class_name": "URLValidatorTest",
    "subclass_name": null,
    "function_name": "testValidUrlWithRegex() throws Exception",
    "function_body": "{\n\t\tURLValidator validator = new URLValidator();\n\n        validator.setUrlRegex(\"^myapp:\\\\/\\\\/[a-z]*\\\\.com$\");\n\n        Pattern pattern = Pattern.compile(validator.getUrlRegex());\n\n        assertTrue(pattern.matcher(\"myapp://test.com\").matches());\n        assertFalse(pattern.matcher(\"myap://test.com\").matches());\n\t}"
  },
  {
    "id": 25,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 6,
    "human_patch": "https://github.com/apache/struts/commit/a0fdca138feec2c2e94eb75ca1f8b76678b4d152",
    "cve_id": "CVE-2016-4465",
    "cwe_id": "CWE-20",
    "filename": "core/src/test/java/com/opensymphony/xwork2/validator/URLValidatorTest.java",
    "is_vulnerable": 0,
    "class_name": "URLValidatorTest",
    "subclass_name": null,
    "function_name": "testValidUrlWithRegexExpression() throws Exception",
    "function_body": "{\n\t\tURLValidator validator = new URLValidator();\n        ActionContext.getContext().getValueStack().push(new MyAction());\n        validator.setValueStack(ActionContext.getContext().getValueStack());\n        validator.setUrlRegexExpression(\"${urlRegex}\");\n\n        Pattern pattern = Pattern.compile(validator.getUrlRegex());\n\n        assertTrue(pattern.matcher(\"myapp://test.com\").matches());\n        assertFalse(pattern.matcher(\"myap://test.com\").matches());\n\t}"
  },
  {
    "id": 25,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 7,
    "human_patch": "https://github.com/apache/struts/commit/a0fdca138feec2c2e94eb75ca1f8b76678b4d152",
    "cve_id": "CVE-2016-4465",
    "cwe_id": "CWE-20",
    "filename": "core/src/test/java/com/opensymphony/xwork2/validator/URLValidatorTest.java",
    "is_vulnerable": 1,
    "class_name": "URLValidatorTest",
    "subclass_name": null,
    "function_name": "testValidUrlWithDefaultRegex() throws Exception",
    "function_body": "{\n\t\tURLValidator validator = new URLValidator();\n\n        Pattern pattern = Pattern.compile(validator.getUrlRegex());\n\n        assertFalse(pattern.matcher(\"myapp://test.com\").matches());\n        assertFalse(pattern.matcher(\"myap://test.com\").matches());\n        assertFalse(pattern.matcher(\"\").matches());\n        assertFalse(pattern.matcher(\"   \").matches());\n        assertFalse(pattern.matcher(\"no url\").matches());\n\n        assertTrue(pattern.matcher(\"http://www.opensymphony.com\").matches());\n        assertTrue(pattern.matcher(\"https://www.opensymphony.com\").matches());\n        assertTrue(pattern.matcher(\"https://www.opensymphony.com:443/login\").matches());\n        assertTrue(pattern.matcher(\"http://localhost:8080/myapp\").matches());\n    }"
  },
  {
    "id": 25,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 8,
    "human_patch": "https://github.com/apache/struts/commit/a0fdca138feec2c2e94eb75ca1f8b76678b4d152",
    "cve_id": "CVE-2016-4465",
    "cwe_id": "CWE-20",
    "filename": "core/src/test/java/com/opensymphony/xwork2/validator/URLValidatorTest.java",
    "is_vulnerable": 0,
    "class_name": "URLValidatorTest",
    "subclass_name": null,
    "function_name": "setUp() throws Exception",
    "function_body": "{\n\t    super.setUp();\n\t\tstack = ActionContext.getContext().getValueStack();\n\t\tactionContext = ActionContext.getContext();\n\t}"
  },
  {
    "id": 25,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 9,
    "human_patch": "https://github.com/apache/struts/commit/a0fdca138feec2c2e94eb75ca1f8b76678b4d152",
    "cve_id": "CVE-2016-4465",
    "cwe_id": "CWE-20",
    "filename": "core/src/test/java/com/opensymphony/xwork2/validator/URLValidatorTest.java",
    "is_vulnerable": 0,
    "class_name": "URLValidatorTest",
    "subclass_name": null,
    "function_name": "tearDown() throws Exception",
    "function_body": "{\n\t    super.tearDown();\n\t\tstack = null;\n\t\tactionContext = null;\n\t}"
  },
  {
    "id": 25,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 10,
    "human_patch": "https://github.com/apache/struts/commit/a0fdca138feec2c2e94eb75ca1f8b76678b4d152",
    "cve_id": "CVE-2016-4465",
    "cwe_id": "CWE-20",
    "filename": "core/src/test/java/com/opensymphony/xwork2/validator/URLValidatorTest.java",
    "is_vulnerable": 0,
    "class_name": "URLValidatorTest",
    "subclass_name": "MyObject",
    "function_name": "getTestingUrl1()",
    "function_body": "{\n\t\t\treturn null;\n\t\t}"
  },
  {
    "id": 25,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 11,
    "human_patch": "https://github.com/apache/struts/commit/a0fdca138feec2c2e94eb75ca1f8b76678b4d152",
    "cve_id": "CVE-2016-4465",
    "cwe_id": "CWE-20",
    "filename": "core/src/test/java/com/opensymphony/xwork2/validator/URLValidatorTest.java",
    "is_vulnerable": 0,
    "class_name": "URLValidatorTest",
    "subclass_name": "MyObject",
    "function_name": "getTestingUrl2()",
    "function_body": "{\n\t\t\treturn \"\";\n\t\t}"
  },
  {
    "id": 25,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 12,
    "human_patch": "https://github.com/apache/struts/commit/a0fdca138feec2c2e94eb75ca1f8b76678b4d152",
    "cve_id": "CVE-2016-4465",
    "cwe_id": "CWE-20",
    "filename": "core/src/test/java/com/opensymphony/xwork2/validator/URLValidatorTest.java",
    "is_vulnerable": 0,
    "class_name": "URLValidatorTest",
    "subclass_name": "MyObject",
    "function_name": "getTestingUrl3()",
    "function_body": "{\n\t\t\treturn \"sasdasd@asddd\";\n\t\t}"
  },
  {
    "id": 25,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 13,
    "human_patch": "https://github.com/apache/struts/commit/a0fdca138feec2c2e94eb75ca1f8b76678b4d152",
    "cve_id": "CVE-2016-4465",
    "cwe_id": "CWE-20",
    "filename": "core/src/test/java/com/opensymphony/xwork2/validator/URLValidatorTest.java",
    "is_vulnerable": 0,
    "class_name": "URLValidatorTest",
    "subclass_name": "MyObject",
    "function_name": "getTestingUrl4()",
    "function_body": "{\n\t\t\t\n\t\t\treturn \"http://www.jroller.com1?qwe=qwe\";\n\t\t}"
  },
  {
    "id": 25,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 14,
    "human_patch": "https://github.com/apache/struts/commit/a0fdca138feec2c2e94eb75ca1f8b76678b4d152",
    "cve_id": "CVE-2016-4465",
    "cwe_id": "CWE-20",
    "filename": "core/src/test/java/com/opensymphony/xwork2/validator/URLValidatorTest.java",
    "is_vulnerable": 0,
    "class_name": "URLValidatorTest",
    "subclass_name": "MyObject",
    "function_name": "getTestingUrl5()",
    "function_body": "{\n\t\t\treturn \"http://yahoo.com/articles?id=123\";\n\t\t}"
  },
  {
    "id": 25,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 15,
    "human_patch": "https://github.com/apache/struts/commit/a0fdca138feec2c2e94eb75ca1f8b76678b4d152",
    "cve_id": "CVE-2016-4465",
    "cwe_id": "CWE-20",
    "filename": "core/src/test/java/com/opensymphony/xwork2/validator/URLValidatorTest.java",
    "is_vulnerable": 0,
    "class_name": "URLValidatorTest",
    "subclass_name": "MyAction",
    "function_name": "getUrlRegex()",
    "function_body": "{\n            return \"myapp:\\\\/\\\\/[a-z]*\\\\.com\";\n        }"
  },
  {
    "id": 26,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 0,
    "human_patch": "https://github.com/bqcuong/vul4j/commit/1a668af7f1ffccea4a3b46d8d8c1fe1c7331ff02",
    "cve_id": "CVE-2014-0116",
    "cwe_id": "CWE-264",
    "filename": "core/src/main/java/org/apache/struts2/interceptor/CookieInterceptor.java",
    "is_vulnerable": 0,
    "class_name": "CookieInterceptor",
    "subclass_name": null,
    "function_name": "setCookiesName(String cookiesName)",
    "function_body": "{\n        if (cookiesName != null)\n            this.cookiesNameSet = TextParseUtil.commaDelimitedStringToSet(cookiesName);\n    }"
  },
  {
    "id": 26,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 1,
    "human_patch": "https://github.com/bqcuong/vul4j/commit/1a668af7f1ffccea4a3b46d8d8c1fe1c7331ff02",
    "cve_id": "CVE-2014-0116",
    "cwe_id": "CWE-264",
    "filename": "core/src/main/java/org/apache/struts2/interceptor/CookieInterceptor.java",
    "is_vulnerable": 0,
    "class_name": "CookieInterceptor",
    "subclass_name": null,
    "function_name": "setCookiesValue(String cookiesValue)",
    "function_body": "{\n        if (cookiesValue != null)\n            this.cookiesValueSet = TextParseUtil.commaDelimitedStringToSet(cookiesValue);\n    }"
  },
  {
    "id": 26,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 2,
    "human_patch": "https://github.com/bqcuong/vul4j/commit/1a668af7f1ffccea4a3b46d8d8c1fe1c7331ff02",
    "cve_id": "CVE-2014-0116",
    "cwe_id": "CWE-264",
    "filename": "core/src/main/java/org/apache/struts2/interceptor/CookieInterceptor.java",
    "is_vulnerable": 0,
    "class_name": "CookieInterceptor",
    "subclass_name": null,
    "function_name": "setAcceptCookieNames(String pattern)",
    "function_body": "{\n        acceptedPattern = Pattern.compile(pattern);\n    }"
  },
  {
    "id": 26,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 3,
    "human_patch": "https://github.com/bqcuong/vul4j/commit/1a668af7f1ffccea4a3b46d8d8c1fe1c7331ff02",
    "cve_id": "CVE-2014-0116",
    "cwe_id": "CWE-264",
    "filename": "core/src/main/java/org/apache/struts2/interceptor/CookieInterceptor.java",
    "is_vulnerable": 0,
    "class_name": "CookieInterceptor",
    "subclass_name": null,
    "function_name": "intercept(ActionInvocation invocation) throws Exception",
    "function_body": "{\n        if (LOG.isDebugEnabled()) {\n            LOG.debug(\"start interception\");\n        }\n\n        \n        final Map<String, String> cookiesMap = new LinkedHashMap<String, String>();\n\n        Cookie[] cookies = ServletActionContext.getRequest().getCookies();\n        if (cookies != null) {\n            final ValueStack stack = ActionContext.getContext().getValueStack();\n\n            for (Cookie cookie : cookies) {\n                String name = cookie.getName();\n                String value = cookie.getValue();\n\n                if (isAcceptableName(name) && isAcceptableValue(value)) {\n                    if (cookiesNameSet.contains(\"*\")) {\n                        if (LOG.isDebugEnabled()) {\n                            LOG.debug(\"contains cookie name [*] in configured cookies name set, cookie with name [\" + name + \"] with value [\" + value + \"] will be injected\");\n                        }\n                        populateCookieValueIntoStack(name, value, cookiesMap, stack);\n                    } else if (cookiesNameSet.contains(cookie.getName())) {\n                        populateCookieValueIntoStack(name, value, cookiesMap, stack);\n                    }\n                } else {\n                    LOG.warn(\"Cookie name [#0] with value [#1] was rejected!\", name, value);\n                }\n            }\n        }\n\n        \n        injectIntoCookiesAwareAction(invocation.getAction(), cookiesMap);\n\n        return invocation.invoke();\n    }"
  },
  {
    "id": 26,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 4,
    "human_patch": "https://github.com/bqcuong/vul4j/commit/1a668af7f1ffccea4a3b46d8d8c1fe1c7331ff02",
    "cve_id": "CVE-2014-0116",
    "cwe_id": "CWE-264",
    "filename": "core/src/main/java/org/apache/struts2/interceptor/CookieInterceptor.java",
    "is_vulnerable": 1,
    "class_name": "CookieInterceptor",
    "subclass_name": null,
    "function_name": "isAcceptableValue(String value)",
    "function_body": "{\n        boolean matches = !excludedPattern.matcher(value).matches();\n        if (!matches) {\n            if (LOG.isTraceEnabled()) {\n                LOG.trace(\"Cookie value [#0] matches excludedPattern [#1]\", value, ExcludedPatterns.CLASS_ACCESS_PATTERN);\n            }\n        }\n        return matches;\n    }"
  },
  {
    "id": 26,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 5,
    "human_patch": "https://github.com/bqcuong/vul4j/commit/1a668af7f1ffccea4a3b46d8d8c1fe1c7331ff02",
    "cve_id": "CVE-2014-0116",
    "cwe_id": "CWE-264",
    "filename": "core/src/main/java/org/apache/struts2/interceptor/CookieInterceptor.java",
    "is_vulnerable": 0,
    "class_name": "CookieInterceptor",
    "subclass_name": null,
    "function_name": "isAcceptableName(String name)",
    "function_body": "{\n        return !isExcluded(name) && isAccepted(name);\n    }"
  },
  {
    "id": 26,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 6,
    "human_patch": "https://github.com/bqcuong/vul4j/commit/1a668af7f1ffccea4a3b46d8d8c1fe1c7331ff02",
    "cve_id": "CVE-2014-0116",
    "cwe_id": "CWE-264",
    "filename": "core/src/main/java/org/apache/struts2/interceptor/CookieInterceptor.java",
    "is_vulnerable": 0,
    "class_name": "CookieInterceptor",
    "subclass_name": null,
    "function_name": "isAccepted(String name)",
    "function_body": "{\n        boolean matches = acceptedPattern.matcher(name).matches();\n        if (matches) {\n            if (LOG.isTraceEnabled()) {\n                LOG.trace(\"Cookie [#0] matches acceptedPattern [#1]\", name, ACCEPTED_PATTERN);\n            }\n        } else {\n            if (LOG.isTraceEnabled()) {\n                LOG.trace(\"Cookie [#0] doesn't match acceptedPattern [#1]\", name, ACCEPTED_PATTERN);\n            }\n        }\n        return matches;\n    }"
  },
  {
    "id": 26,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 7,
    "human_patch": "https://github.com/bqcuong/vul4j/commit/1a668af7f1ffccea4a3b46d8d8c1fe1c7331ff02",
    "cve_id": "CVE-2014-0116",
    "cwe_id": "CWE-264",
    "filename": "core/src/main/java/org/apache/struts2/interceptor/CookieInterceptor.java",
    "is_vulnerable": 1,
    "class_name": "CookieInterceptor",
    "subclass_name": null,
    "function_name": "isExcluded(String name)",
    "function_body": "{\n        boolean matches = excludedPattern.matcher(name).matches();\n        if (matches) {\n            if (LOG.isTraceEnabled()) {\n                LOG.trace(\"Cookie [#0] matches excludedPattern [#1]\", name, ExcludedPatterns.CLASS_ACCESS_PATTERN);\n            }\n        } else {\n            if (LOG.isTraceEnabled()) {\n                LOG.trace(\"Cookie [#0] doesn't match excludedPattern [#1]\", name, ExcludedPatterns.CLASS_ACCESS_PATTERN);\n            }\n        }\n        return matches;\n    }"
  },
  {
    "id": 26,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 8,
    "human_patch": "https://github.com/bqcuong/vul4j/commit/1a668af7f1ffccea4a3b46d8d8c1fe1c7331ff02",
    "cve_id": "CVE-2014-0116",
    "cwe_id": "CWE-264",
    "filename": "core/src/main/java/org/apache/struts2/interceptor/CookieInterceptor.java",
    "is_vulnerable": 0,
    "class_name": "CookieInterceptor",
    "subclass_name": null,
    "function_name": "populateCookieValueIntoStack(String cookieName, String cookieValue, Map<String, String> cookiesMap, ValueStack stack)",
    "function_body": "{\n        if (cookiesValueSet.isEmpty() || cookiesValueSet.contains(\"*\")) {\n            \n            \n            \n            \n            if (LOG.isDebugEnabled()) {\n                if (cookiesValueSet.isEmpty())\n                    LOG.debug(\"no cookie value is configured, cookie with name [\"+cookieName+\"] with value [\"+cookieValue+\"] will be injected\");\n                else if (cookiesValueSet.contains(\"*\"))\n                    LOG.debug(\"interceptor is configured to accept any value, cookie with name [\"+cookieName+\"] with value [\"+cookieValue+\"] will be injected\");\n            }\n            cookiesMap.put(cookieName, cookieValue);\n            stack.setValue(cookieName, cookieValue);\n        }\n        else {\n            \n            \n            if (cookiesValueSet.contains(cookieValue)) {\n                if (LOG.isDebugEnabled()) {\n                    LOG.debug(\"both configured cookie name and value matched, cookie [\"+cookieName+\"] with value [\"+cookieValue+\"] will be injected\");\n                }\n\n                cookiesMap.put(cookieName, cookieValue);\n                stack.setValue(cookieName, cookieValue);\n            }\n        }\n    }"
  },
  {
    "id": 26,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 9,
    "human_patch": "https://github.com/bqcuong/vul4j/commit/1a668af7f1ffccea4a3b46d8d8c1fe1c7331ff02",
    "cve_id": "CVE-2014-0116",
    "cwe_id": "CWE-264",
    "filename": "core/src/main/java/org/apache/struts2/interceptor/CookieInterceptor.java",
    "is_vulnerable": 0,
    "class_name": "CookieInterceptor",
    "subclass_name": null,
    "function_name": "injectIntoCookiesAwareAction(Object action, Map<String, String> cookiesMap)",
    "function_body": "{\n        if (action instanceof CookiesAware) {\n            if (LOG.isDebugEnabled()) {\n                LOG.debug(\"action [\"+action+\"] implements CookiesAware, injecting cookies map [\"+cookiesMap+\"]\");\n            }\n            ((CookiesAware)action).setCookiesMap(cookiesMap);\n        }\n    }"
  },
  {
    "id": 26,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 0,
    "human_patch": "https://github.com/bqcuong/vul4j/commit/1a668af7f1ffccea4a3b46d8d8c1fe1c7331ff02",
    "cve_id": "CVE-2014-0116",
    "cwe_id": "CWE-264",
    "filename": "core/src/test/java/org/apache/struts2/interceptor/CookieInterceptorTest.java",
    "is_vulnerable": 0,
    "class_name": "CookieInterceptorTest",
    "subclass_name": null,
    "function_name": "testIntercepDefault() throws Exception",
    "function_body": "{\n        MockHttpServletRequest request = new MockHttpServletRequest();\n        request.setCookies(new Cookie[] {\n                new Cookie(\"cookie1\", \"cookie1value\"),\n                new Cookie(\"cookie2\", \"cookie2value\"),\n                new Cookie(\"cookie3\", \"cookie3value\")\n            });\n        ServletActionContext.setRequest(request);\n\n        MockActionWithCookieAware action = new MockActionWithCookieAware();\n\n        ActionContext.getContext().getValueStack().push(action);\n\n        MockControl actionInvocationControl = MockControl.createControl(ActionInvocation.class);\n        ActionInvocation invocation = (ActionInvocation) actionInvocationControl.getMock();\n        actionInvocationControl.expectAndDefaultReturn(\n                                                       invocation.getAction(), action);\n        actionInvocationControl.expectAndDefaultReturn(\n                                                       invocation.invoke(), Action.SUCCESS);\n\n        actionInvocationControl.replay();\n\n        \n        CookieInterceptor interceptor = new CookieInterceptor();\n        interceptor.intercept(invocation);\n\n        assertTrue(action.getCookiesMap().isEmpty());\n        assertNull(action.getCookie1(), null);\n        assertNull(action.getCookie2(), null);\n        assertNull(action.getCookie3(), null);\n        assertNull(ActionContext.getContext().getValueStack().findValue(\"cookie1\"));\n        assertNull(ActionContext.getContext().getValueStack().findValue(\"cookie2\"));\n        assertNull(ActionContext.getContext().getValueStack().findValue(\"cookie3\"));\n    }"
  },
  {
    "id": 26,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 1,
    "human_patch": "https://github.com/bqcuong/vul4j/commit/1a668af7f1ffccea4a3b46d8d8c1fe1c7331ff02",
    "cve_id": "CVE-2014-0116",
    "cwe_id": "CWE-264",
    "filename": "core/src/test/java/org/apache/struts2/interceptor/CookieInterceptorTest.java",
    "is_vulnerable": 0,
    "class_name": "CookieInterceptorTest",
    "subclass_name": null,
    "function_name": "testInterceptAll1() throws Exception",
    "function_body": "{\n        MockHttpServletRequest request = new MockHttpServletRequest();\n        request.setCookies(new Cookie[] {\n                new Cookie(\"cookie1\", \"cookie1value\"),\n                new Cookie(\"cookie2\", \"cookie2value\"),\n                new Cookie(\"cookie3\", \"cookie3value\")\n            });\n        ServletActionContext.setRequest(request);\n\n        MockActionWithCookieAware action = new MockActionWithCookieAware();\n\n        ActionContext.getContext().getValueStack().push(action);\n\n        MockControl actionInvocationControl = MockControl.createControl(ActionInvocation.class);\n        ActionInvocation invocation = (ActionInvocation) actionInvocationControl.getMock();\n        actionInvocationControl.expectAndDefaultReturn(\n                                                       invocation.getAction(), action);\n        actionInvocationControl.expectAndDefaultReturn(\n                                                       invocation.invoke(), Action.SUCCESS);\n\n        actionInvocationControl.replay();\n\n        CookieInterceptor interceptor = new CookieInterceptor();\n        interceptor.setCookiesName(\"*\");\n        interceptor.setCookiesValue(\"*\");\n        interceptor.intercept(invocation);\n\n        assertFalse(action.getCookiesMap().isEmpty());\n        assertEquals(action.getCookiesMap().size(), 3);\n        assertEquals(action.getCookiesMap().get(\"cookie1\"), \"cookie1value\");\n        assertEquals(action.getCookiesMap().get(\"cookie2\"), \"cookie2value\");\n        assertEquals(action.getCookiesMap().get(\"cookie3\"), \"cookie3value\");\n        assertEquals(action.getCookie1(), \"cookie1value\");\n        assertEquals(action.getCookie2(), \"cookie2value\");\n        assertEquals(action.getCookie3(), \"cookie3value\");\n        assertEquals(ActionContext.getContext().getValueStack().findValue(\"cookie1\"), \"cookie1value\");\n        assertEquals(ActionContext.getContext().getValueStack().findValue(\"cookie2\"), \"cookie2value\");\n        assertEquals(ActionContext.getContext().getValueStack().findValue(\"cookie3\"), \"cookie3value\");\n    }"
  },
  {
    "id": 26,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 2,
    "human_patch": "https://github.com/bqcuong/vul4j/commit/1a668af7f1ffccea4a3b46d8d8c1fe1c7331ff02",
    "cve_id": "CVE-2014-0116",
    "cwe_id": "CWE-264",
    "filename": "core/src/test/java/org/apache/struts2/interceptor/CookieInterceptorTest.java",
    "is_vulnerable": 0,
    "class_name": "CookieInterceptorTest",
    "subclass_name": null,
    "function_name": "testInterceptAll2() throws Exception",
    "function_body": "{\n        MockHttpServletRequest request = new MockHttpServletRequest();\n        request.setCookies(new Cookie[] {\n                new Cookie(\"cookie1\", \"cookie1value\"),\n                new Cookie(\"cookie2\", \"cookie2value\"),\n                new Cookie(\"cookie3\", \"cookie3value\")\n            });\n        ServletActionContext.setRequest(request);\n\n        MockActionWithCookieAware action = new MockActionWithCookieAware();\n\n        ActionContext.getContext().getValueStack().push(action);\n\n        MockControl actionInvocationControl = MockControl.createControl(ActionInvocation.class);\n        ActionInvocation invocation = (ActionInvocation) actionInvocationControl.getMock();\n        actionInvocationControl.expectAndDefaultReturn(\n                                                       invocation.getAction(), action);\n        actionInvocationControl.expectAndDefaultReturn(\n                                                       invocation.invoke(), Action.SUCCESS);\n\n        actionInvocationControl.replay();\n\n        CookieInterceptor interceptor = new CookieInterceptor();\n        interceptor.setCookiesName(\"cookie1, cookie2, cookie3\");\n        interceptor.setCookiesValue(\"cookie1value, cookie2value, cookie3value\");\n        interceptor.intercept(invocation);\n\n        assertFalse(action.getCookiesMap().isEmpty());\n        assertEquals(action.getCookiesMap().size(), 3);\n        assertEquals(action.getCookiesMap().get(\"cookie1\"), \"cookie1value\");\n        assertEquals(action.getCookiesMap().get(\"cookie2\"), \"cookie2value\");\n        assertEquals(action.getCookiesMap().get(\"cookie3\"), \"cookie3value\");\n        assertEquals(action.getCookie1(), \"cookie1value\");\n        assertEquals(action.getCookie2(), \"cookie2value\");\n        assertEquals(action.getCookie3(), \"cookie3value\");\n        assertEquals(ActionContext.getContext().getValueStack().findValue(\"cookie1\"), \"cookie1value\");\n        assertEquals(ActionContext.getContext().getValueStack().findValue(\"cookie2\"), \"cookie2value\");\n        assertEquals(ActionContext.getContext().getValueStack().findValue(\"cookie3\"), \"cookie3value\");\n    }"
  },
  {
    "id": 26,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 3,
    "human_patch": "https://github.com/bqcuong/vul4j/commit/1a668af7f1ffccea4a3b46d8d8c1fe1c7331ff02",
    "cve_id": "CVE-2014-0116",
    "cwe_id": "CWE-264",
    "filename": "core/src/test/java/org/apache/struts2/interceptor/CookieInterceptorTest.java",
    "is_vulnerable": 0,
    "class_name": "CookieInterceptorTest",
    "subclass_name": null,
    "function_name": "testInterceptSelectedCookiesNameOnly1() throws Exception",
    "function_body": "{\n        MockHttpServletRequest request = new MockHttpServletRequest();\n        request.setCookies(new Cookie[] {\n                new Cookie(\"cookie1\", \"cookie1value\"),\n                new Cookie(\"cookie2\", \"cookie2value\"),\n                new Cookie(\"cookie3\", \"cookie3value\")\n            });\n        ServletActionContext.setRequest(request);\n\n        MockActionWithCookieAware action = new MockActionWithCookieAware();\n\n        ActionContext.getContext().getValueStack().push(action);\n\n        MockControl actionInvocationControl = MockControl.createControl(ActionInvocation.class);\n        ActionInvocation invocation = (ActionInvocation) actionInvocationControl.getMock();\n        actionInvocationControl.expectAndDefaultReturn(\n                                                       invocation.getAction(), action);\n        actionInvocationControl.expectAndDefaultReturn(\n                                                       invocation.invoke(), Action.SUCCESS);\n\n        actionInvocationControl.replay();\n\n        CookieInterceptor interceptor = new CookieInterceptor();\n        interceptor.setCookiesName(\"cookie1, cookie3\");\n        interceptor.setCookiesValue(\"cookie1value, cookie2value, cookie3value\");\n        interceptor.intercept(invocation);\n\n        assertFalse(action.getCookiesMap().isEmpty());\n        assertEquals(action.getCookiesMap().size(), 2);\n        assertEquals(action.getCookiesMap().get(\"cookie1\"), \"cookie1value\");\n        assertEquals(action.getCookiesMap().get(\"cookie2\"), null);\n        assertEquals(action.getCookiesMap().get(\"cookie3\"), \"cookie3value\");\n        assertEquals(action.getCookie1(), \"cookie1value\");\n        assertEquals(action.getCookie2(), null);\n        assertEquals(action.getCookie3(), \"cookie3value\");\n        assertEquals(ActionContext.getContext().getValueStack().findValue(\"cookie1\"), \"cookie1value\");\n        assertEquals(ActionContext.getContext().getValueStack().findValue(\"cookie2\"), null);\n        assertEquals(ActionContext.getContext().getValueStack().findValue(\"cookie3\"), \"cookie3value\");\n    }"
  },
  {
    "id": 26,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 4,
    "human_patch": "https://github.com/bqcuong/vul4j/commit/1a668af7f1ffccea4a3b46d8d8c1fe1c7331ff02",
    "cve_id": "CVE-2014-0116",
    "cwe_id": "CWE-264",
    "filename": "core/src/test/java/org/apache/struts2/interceptor/CookieInterceptorTest.java",
    "is_vulnerable": 0,
    "class_name": "CookieInterceptorTest",
    "subclass_name": null,
    "function_name": "testInterceptSelectedCookiesNameOnly2() throws Exception",
    "function_body": "{\n        MockHttpServletRequest request = new MockHttpServletRequest();\n        request.setCookies(new Cookie[] {\n                new Cookie(\"cookie1\", \"cookie1value\"),\n                new Cookie(\"cookie2\", \"cookie2value\"),\n                new Cookie(\"cookie3\", \"cookie3value\")\n            });\n        ServletActionContext.setRequest(request);\n\n        MockActionWithCookieAware action = new MockActionWithCookieAware();\n\n        ActionContext.getContext().getValueStack().push(action);\n\n        MockControl actionInvocationControl = MockControl.createControl(ActionInvocation.class);\n        ActionInvocation invocation = (ActionInvocation) actionInvocationControl.getMock();\n        actionInvocationControl.expectAndDefaultReturn(\n                                                       invocation.getAction(), action);\n        actionInvocationControl.expectAndDefaultReturn(\n                                                       invocation.invoke(), Action.SUCCESS);\n\n        actionInvocationControl.replay();\n\n        CookieInterceptor interceptor = new CookieInterceptor();\n        interceptor.setCookiesName(\"cookie1, cookie3\");\n        interceptor.setCookiesValue(\"*\");\n        interceptor.intercept(invocation);\n\n        assertFalse(action.getCookiesMap().isEmpty());\n        assertEquals(action.getCookiesMap().size(), 2);\n        assertEquals(action.getCookiesMap().get(\"cookie1\"), \"cookie1value\");\n        assertEquals(action.getCookiesMap().get(\"cookie2\"), null);\n        assertEquals(action.getCookiesMap().get(\"cookie3\"), \"cookie3value\");\n        assertEquals(action.getCookie1(), \"cookie1value\");\n        assertEquals(action.getCookie2(), null);\n        assertEquals(action.getCookie3(), \"cookie3value\");\n        assertEquals(ActionContext.getContext().getValueStack().findValue(\"cookie1\"), \"cookie1value\");\n        assertEquals(ActionContext.getContext().getValueStack().findValue(\"cookie2\"), null);\n        assertEquals(ActionContext.getContext().getValueStack().findValue(\"cookie3\"), \"cookie3value\");\n    }"
  },
  {
    "id": 26,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 5,
    "human_patch": "https://github.com/bqcuong/vul4j/commit/1a668af7f1ffccea4a3b46d8d8c1fe1c7331ff02",
    "cve_id": "CVE-2014-0116",
    "cwe_id": "CWE-264",
    "filename": "core/src/test/java/org/apache/struts2/interceptor/CookieInterceptorTest.java",
    "is_vulnerable": 0,
    "class_name": "CookieInterceptorTest",
    "subclass_name": null,
    "function_name": "testInterceptSelectedCookiesNameOnly3() throws Exception",
    "function_body": "{\n        MockHttpServletRequest request = new MockHttpServletRequest();\n        request.setCookies(new Cookie[] {\n                new Cookie(\"cookie1\", \"cookie1value\"),\n                new Cookie(\"cookie2\", \"cookie2value\"),\n                new Cookie(\"cookie3\", \"cookie3value\")\n            });\n        ServletActionContext.setRequest(request);\n\n        MockActionWithCookieAware action = new MockActionWithCookieAware();\n\n        ActionContext.getContext().getValueStack().push(action);\n\n        MockControl actionInvocationControl = MockControl.createControl(ActionInvocation.class);\n        ActionInvocation invocation = (ActionInvocation) actionInvocationControl.getMock();\n        actionInvocationControl.expectAndDefaultReturn(\n                                                       invocation.getAction(), action);\n        actionInvocationControl.expectAndDefaultReturn(\n                                                       invocation.invoke(), Action.SUCCESS);\n\n        actionInvocationControl.replay();\n\n        CookieInterceptor interceptor = new CookieInterceptor();\n        interceptor.setCookiesName(\"cookie1, cookie3\");\n        interceptor.setCookiesValue(\"\");\n        interceptor.intercept(invocation);\n\n        assertFalse(action.getCookiesMap().isEmpty());\n        assertEquals(action.getCookiesMap().size(), 2);\n        assertEquals(action.getCookiesMap().get(\"cookie1\"), \"cookie1value\");\n        assertEquals(action.getCookiesMap().get(\"cookie2\"), null);\n        assertEquals(action.getCookiesMap().get(\"cookie3\"), \"cookie3value\");\n        assertEquals(action.getCookie1(), \"cookie1value\");\n        assertEquals(action.getCookie2(), null);\n        assertEquals(action.getCookie3(), \"cookie3value\");\n        assertEquals(ActionContext.getContext().getValueStack().findValue(\"cookie1\"), \"cookie1value\");\n        assertEquals(ActionContext.getContext().getValueStack().findValue(\"cookie2\"), null);\n        assertEquals(ActionContext.getContext().getValueStack().findValue(\"cookie3\"), \"cookie3value\");\n    }"
  },
  {
    "id": 26,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 6,
    "human_patch": "https://github.com/bqcuong/vul4j/commit/1a668af7f1ffccea4a3b46d8d8c1fe1c7331ff02",
    "cve_id": "CVE-2014-0116",
    "cwe_id": "CWE-264",
    "filename": "core/src/test/java/org/apache/struts2/interceptor/CookieInterceptorTest.java",
    "is_vulnerable": 0,
    "class_name": "CookieInterceptorTest",
    "subclass_name": null,
    "function_name": "testInterceptSelectedCookiesNameAndValue() throws Exception",
    "function_body": "{\n        MockHttpServletRequest request = new MockHttpServletRequest();\n        request.setCookies(new Cookie[] {\n                new Cookie(\"cookie1\", \"cookie1value\"),\n                new Cookie(\"cookie2\", \"cookie2value\"),\n                new Cookie(\"cookie3\", \"cookie3value\")\n            });\n        ServletActionContext.setRequest(request);\n\n        MockActionWithCookieAware action = new MockActionWithCookieAware();\n\n        ActionContext.getContext().getValueStack().push(action);\n\n        MockControl actionInvocationControl = MockControl.createControl(ActionInvocation.class);\n        ActionInvocation invocation = (ActionInvocation) actionInvocationControl.getMock();\n        actionInvocationControl.expectAndDefaultReturn(\n                                                       invocation.getAction(), action);\n        actionInvocationControl.expectAndDefaultReturn(\n                                                       invocation.invoke(), Action.SUCCESS);\n\n        actionInvocationControl.replay();\n\n        CookieInterceptor interceptor = new CookieInterceptor();\n        interceptor.setCookiesName(\"cookie1, cookie3\");\n        interceptor.setCookiesValue(\"cookie1value\");\n        interceptor.intercept(invocation);\n\n        assertFalse(action.getCookiesMap().isEmpty());\n        assertEquals(action.getCookiesMap().size(), 1);\n        assertEquals(action.getCookiesMap().get(\"cookie1\"), \"cookie1value\");\n        assertEquals(action.getCookiesMap().get(\"cookie2\"), null);\n        assertEquals(action.getCookiesMap().get(\"cookie3\"), null);\n        assertEquals(action.getCookie1(), \"cookie1value\");\n        assertEquals(action.getCookie2(), null);\n        assertEquals(action.getCookie3(), null);\n        assertEquals(ActionContext.getContext().getValueStack().findValue(\"cookie1\"), \"cookie1value\");\n        assertEquals(ActionContext.getContext().getValueStack().findValue(\"cookie2\"), null);\n        assertEquals(ActionContext.getContext().getValueStack().findValue(\"cookie3\"), null);\n    }"
  },
  {
    "id": 26,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 7,
    "human_patch": "https://github.com/bqcuong/vul4j/commit/1a668af7f1ffccea4a3b46d8d8c1fe1c7331ff02",
    "cve_id": "CVE-2014-0116",
    "cwe_id": "CWE-264",
    "filename": "core/src/test/java/org/apache/struts2/interceptor/CookieInterceptorTest.java",
    "is_vulnerable": 0,
    "class_name": "CookieInterceptorTest",
    "subclass_name": null,
    "function_name": "testCookiesWithClassPollution() throws Exception",
    "function_body": "{\n        MockHttpServletRequest request = new MockHttpServletRequest();\n        String pollution1 = \"model['class']['classLoader']['jarPath']\";\n        String pollution2 = \"model.class.classLoader.jarPath\";\n        String pollution3 = \"class.classLoader.jarPath\";\n        String pollution4 = \"class['classLoader']['jarPath']\";\n        String pollution5 = \"model[\\\"class\\\"]['classLoader']['jarPath']\";\n        String pollution6 = \"class[\\\"classLoader\\\"]['jarPath']\";\n\n        request.setCookies(\n                new Cookie(pollution1, \"pollution1\"),\n                new Cookie(\"pollution1\", pollution1),\n                new Cookie(pollution2, \"pollution2\"),\n                new Cookie(\"pollution2\", pollution2),\n                new Cookie(pollution3, \"pollution3\"),\n                new Cookie(\"pollution3\", pollution3),\n                new Cookie(pollution4, \"pollution4\"),\n                new Cookie(\"pollution4\", pollution4),\n                new Cookie(pollution5, \"pollution5\"),\n                new Cookie(\"pollution5\", pollution5),\n                new Cookie(pollution6, \"pollution6\"),\n                new Cookie(\"pollution6\", pollution6)\n            );\n        ServletActionContext.setRequest(request);\n\n        final Map<String, Boolean> excludedName = new HashMap<String, Boolean>();\n        final Map<String, Boolean> excludedValue = new HashMap<String, Boolean>();\n\n        CookieInterceptor interceptor = new CookieInterceptor() {\n            @Override\n            protected boolean isAcceptableName(String name) {\n                boolean accepted = super.isAcceptableName(name);\n                excludedName.put(name, accepted);\n                return accepted;\n            }\n\n            @Override\n            protected boolean isAcceptableValue(String value) {\n                boolean accepted = super.isAcceptableValue(value);\n                excludedValue.put(value, accepted);\n                return accepted;\n            }\n        };\n        interceptor.setCookiesName(\"*\");\n\n        MockActionInvocation invocation = new MockActionInvocation();\n        invocation.setAction(new MockActionWithCookieAware());\n\n        interceptor.intercept(invocation);\n\n        assertFalse(excludedName.get(pollution1));\n        assertFalse(excludedName.get(pollution2));\n        assertFalse(excludedName.get(pollution3));\n        assertFalse(excludedName.get(pollution4));\n        assertFalse(excludedName.get(pollution5));\n        assertFalse(excludedName.get(pollution6));\n\n        assertFalse(excludedValue.get(pollution1));\n        assertFalse(excludedValue.get(pollution2));\n        assertFalse(excludedValue.get(pollution3));\n        assertFalse(excludedValue.get(pollution4));\n        assertFalse(excludedValue.get(pollution5));\n        assertFalse(excludedValue.get(pollution6));\n    }"
  },
  {
    "id": 26,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 8,
    "human_patch": "https://github.com/bqcuong/vul4j/commit/1a668af7f1ffccea4a3b46d8d8c1fe1c7331ff02",
    "cve_id": "CVE-2014-0116",
    "cwe_id": "CWE-264",
    "filename": "core/src/test/java/org/apache/struts2/interceptor/CookieInterceptorTest.java",
    "is_vulnerable": 0,
    "class_name": "CookieInterceptorTest",
    "subclass_name": null,
    "function_name": "isAcceptableName(String name)",
    "function_body": "{\n                boolean accepted = super.isAcceptableName(name);\n                excludedName.put(name, accepted);\n                return accepted;\n            }"
  },
  {
    "id": 26,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 9,
    "human_patch": "https://github.com/bqcuong/vul4j/commit/1a668af7f1ffccea4a3b46d8d8c1fe1c7331ff02",
    "cve_id": "CVE-2014-0116",
    "cwe_id": "CWE-264",
    "filename": "core/src/test/java/org/apache/struts2/interceptor/CookieInterceptorTest.java",
    "is_vulnerable": 0,
    "class_name": "CookieInterceptorTest",
    "subclass_name": null,
    "function_name": "isAcceptableValue(String value)",
    "function_body": "{\n                boolean accepted = super.isAcceptableValue(value);\n                excludedValue.put(value, accepted);\n                return accepted;\n            }"
  },
  {
    "id": 26,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 10,
    "human_patch": "https://github.com/bqcuong/vul4j/commit/1a668af7f1ffccea4a3b46d8d8c1fe1c7331ff02",
    "cve_id": "CVE-2014-0116",
    "cwe_id": "CWE-264",
    "filename": "core/src/test/java/org/apache/struts2/interceptor/CookieInterceptorTest.java",
    "is_vulnerable": 0,
    "class_name": "CookieInterceptorTest",
    "subclass_name": "MockActionWithCookieAware",
    "function_name": "setCookiesMap(Map<String, String> cookies)",
    "function_body": "{\n            this.cookies = cookies;\n        }"
  },
  {
    "id": 26,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 11,
    "human_patch": "https://github.com/bqcuong/vul4j/commit/1a668af7f1ffccea4a3b46d8d8c1fe1c7331ff02",
    "cve_id": "CVE-2014-0116",
    "cwe_id": "CWE-264",
    "filename": "core/src/test/java/org/apache/struts2/interceptor/CookieInterceptorTest.java",
    "is_vulnerable": 0,
    "class_name": "CookieInterceptorTest",
    "subclass_name": "MockActionWithCookieAware",
    "function_name": "getCookiesMap()",
    "function_body": "{\n            return this.cookies;\n        }"
  },
  {
    "id": 26,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 12,
    "human_patch": "https://github.com/bqcuong/vul4j/commit/1a668af7f1ffccea4a3b46d8d8c1fe1c7331ff02",
    "cve_id": "CVE-2014-0116",
    "cwe_id": "CWE-264",
    "filename": "core/src/test/java/org/apache/struts2/interceptor/CookieInterceptorTest.java",
    "is_vulnerable": 0,
    "class_name": "CookieInterceptorTest",
    "subclass_name": "MockActionWithCookieAware",
    "function_name": "getCookie1()",
    "function_body": "{ return cookie1; }"
  },
  {
    "id": 26,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 13,
    "human_patch": "https://github.com/bqcuong/vul4j/commit/1a668af7f1ffccea4a3b46d8d8c1fe1c7331ff02",
    "cve_id": "CVE-2014-0116",
    "cwe_id": "CWE-264",
    "filename": "core/src/test/java/org/apache/struts2/interceptor/CookieInterceptorTest.java",
    "is_vulnerable": 0,
    "class_name": "CookieInterceptorTest",
    "subclass_name": "MockActionWithCookieAware",
    "function_name": "setCookie1(String cookie1)",
    "function_body": "{ this.cookie1 = cookie1; }"
  },
  {
    "id": 26,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 14,
    "human_patch": "https://github.com/bqcuong/vul4j/commit/1a668af7f1ffccea4a3b46d8d8c1fe1c7331ff02",
    "cve_id": "CVE-2014-0116",
    "cwe_id": "CWE-264",
    "filename": "core/src/test/java/org/apache/struts2/interceptor/CookieInterceptorTest.java",
    "is_vulnerable": 0,
    "class_name": "CookieInterceptorTest",
    "subclass_name": "MockActionWithCookieAware",
    "function_name": "getCookie2()",
    "function_body": "{ return cookie2; }"
  },
  {
    "id": 26,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 15,
    "human_patch": "https://github.com/bqcuong/vul4j/commit/1a668af7f1ffccea4a3b46d8d8c1fe1c7331ff02",
    "cve_id": "CVE-2014-0116",
    "cwe_id": "CWE-264",
    "filename": "core/src/test/java/org/apache/struts2/interceptor/CookieInterceptorTest.java",
    "is_vulnerable": 0,
    "class_name": "CookieInterceptorTest",
    "subclass_name": "MockActionWithCookieAware",
    "function_name": "setCookie2(String cookie2)",
    "function_body": "{ this.cookie2 = cookie2; }"
  },
  {
    "id": 26,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 16,
    "human_patch": "https://github.com/bqcuong/vul4j/commit/1a668af7f1ffccea4a3b46d8d8c1fe1c7331ff02",
    "cve_id": "CVE-2014-0116",
    "cwe_id": "CWE-264",
    "filename": "core/src/test/java/org/apache/struts2/interceptor/CookieInterceptorTest.java",
    "is_vulnerable": 0,
    "class_name": "CookieInterceptorTest",
    "subclass_name": "MockActionWithCookieAware",
    "function_name": "getCookie3()",
    "function_body": "{ return cookie3; }"
  },
  {
    "id": 26,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 17,
    "human_patch": "https://github.com/bqcuong/vul4j/commit/1a668af7f1ffccea4a3b46d8d8c1fe1c7331ff02",
    "cve_id": "CVE-2014-0116",
    "cwe_id": "CWE-264",
    "filename": "core/src/test/java/org/apache/struts2/interceptor/CookieInterceptorTest.java",
    "is_vulnerable": 0,
    "class_name": "CookieInterceptorTest",
    "subclass_name": "MockActionWithCookieAware",
    "function_name": "setCookie3(String cookie3)",
    "function_body": "{ this.cookie3 = cookie3; }"
  },
  {
    "id": 27,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 0,
    "human_patch": "https://github.com/apache/struts/commit/554b9dddb0fbd1e581ef577dd62a7c22955ad0f6",
    "cve_id": "CVE-2016-8738",
    "cwe_id": "CWE-20",
    "filename": "core/src/main/java/com/opensymphony/xwork2/validator/validators/URLValidator.java",
    "is_vulnerable": 1,
    "class_name": "URLValidator",
    "subclass_name": null,
    "function_name": "validate(Object object) throws ValidationException",
    "function_body": "{\n        String fieldName = getFieldName();\n        Object value = this.getFieldValue(fieldName, object);\n\n        \n        \n        if (value == null || value.toString().length() == 0) {\n            return;\n        }\n\n        if (!(value.getClass().equals(String.class)) || !Pattern.compile(getUrlRegex(), Pattern.CASE_INSENSITIVE).matcher(String.valueOf(value)).matches()) {\n            addFieldError(fieldName, object);\n        }\n    }"
  },
  {
    "id": 27,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 1,
    "human_patch": "https://github.com/apache/struts/commit/554b9dddb0fbd1e581ef577dd62a7c22955ad0f6",
    "cve_id": "CVE-2016-8738",
    "cwe_id": "CWE-20",
    "filename": "core/src/main/java/com/opensymphony/xwork2/validator/validators/URLValidator.java",
    "is_vulnerable": 0,
    "class_name": "URLValidator",
    "subclass_name": null,
    "function_name": "getUrlRegex()",
    "function_body": "{\n        if (StringUtils.isNotEmpty(urlRegexExpression)) {\n            return (String) parse(urlRegexExpression, String.class);\n        } else if (StringUtils.isNotEmpty(urlRegex)) {\n            return urlRegex;\n        } else {\n            return \"^(https?|ftp):\\\\/\\\\/\" +\n                    \"(([a-z0-9$_\\\\.\\\\+!\\\\*\\\\'\\\\(\\\\),;\\\\?&=-]|%[0-9a-f]{2})+\" +\n                    \"(:([a-z0-9$_\\\\.\\\\+!\\\\*\\\\'\\\\(\\\\),;\\\\?&=-]|%[0-9a-f]{2})+)?\" +\n                    \"@)?(#?\" +\n                    \")((([a-z0-9]\\\\.|[a-z0-9][a-z0-9-]*[a-z0-9]\\\\.)*\" +\n                    \"[a-z][a-z0-9-]*[a-z0-9]\" +\n                    \"|((\\\\d|[1-9]\\\\d|1\\\\d{2}|2[0-4][0-9]|25[0-5])\\\\.){3}\" +\n                    \"(\\\\d|[1-9]\\\\d|1\\\\d{2}|2[0-4][0-9]|25[0-5])\" +\n                    \")(:\\\\d+)?\" +\n                    \")(((\\\\/{0,1}([a-z0-9$_\\\\.\\\\+!\\\\*\\\\'\\\\(\\\\),;:@&=-]|%[0-9a-f]{2})*)*\" +\n                    \"(\\\\?([a-z0-9$_\\\\.\\\\+!\\\\*\\\\'\\\\(\\\\),;:@&=-]|%[0-9a-f]{2})*)\" +\n                    \"?)?)?\" +\n                    \"(#([a-z0-9$_\\\\.\\\\+!\\\\*\\\\'\\\\(\\\\),;:@&=-]|%[0-9a-f]{2})*)?\" +\n                    \"$\";\n        }\n    }"
  },
  {
    "id": 27,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 2,
    "human_patch": "https://github.com/apache/struts/commit/554b9dddb0fbd1e581ef577dd62a7c22955ad0f6",
    "cve_id": "CVE-2016-8738",
    "cwe_id": "CWE-20",
    "filename": "core/src/main/java/com/opensymphony/xwork2/validator/validators/URLValidator.java",
    "is_vulnerable": 0,
    "class_name": "URLValidator",
    "subclass_name": null,
    "function_name": "setUrlRegex(String urlRegex)",
    "function_body": "{\n        this.urlRegex = urlRegex;\n    }"
  },
  {
    "id": 27,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 3,
    "human_patch": "https://github.com/apache/struts/commit/554b9dddb0fbd1e581ef577dd62a7c22955ad0f6",
    "cve_id": "CVE-2016-8738",
    "cwe_id": "CWE-20",
    "filename": "core/src/main/java/com/opensymphony/xwork2/validator/validators/URLValidator.java",
    "is_vulnerable": 0,
    "class_name": "URLValidator",
    "subclass_name": null,
    "function_name": "setUrlRegexExpression(String urlRegexExpression)",
    "function_body": "{\n        this.urlRegexExpression = urlRegexExpression;\n    }"
  },
  {
    "id": 28,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 0,
    "human_patch": "https://github.com/apache/struts/commit/237432512df0e27013f7c7b9ab59fdce44ca34a5",
    "cve_id": "CVE-2016-4436",
    "cwe_id": "Not Mapping",
    "filename": "core/src/main/java/org/apache/struts2/dispatcher/mapper/DefaultActionMapper.java",
    "is_vulnerable": 0,
    "class_name": "DefaultActionMapper",
    "subclass_name": null,
    "function_name": "execute(String key, ActionMapping mapping)",
    "function_body": "{\n                        if (allowDynamicMethodCalls) {\n                            mapping.setMethod(cleanupActionName(key.substring(METHOD_PREFIX.length())));\n                        }\n                    }"
  },
  {
    "id": 28,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 1,
    "human_patch": "https://github.com/apache/struts/commit/237432512df0e27013f7c7b9ab59fdce44ca34a5",
    "cve_id": "CVE-2016-4436",
    "cwe_id": "Not Mapping",
    "filename": "core/src/main/java/org/apache/struts2/dispatcher/mapper/DefaultActionMapper.java",
    "is_vulnerable": 0,
    "class_name": "DefaultActionMapper",
    "subclass_name": null,
    "function_name": "execute(final String key, ActionMapping mapping)",
    "function_body": "{\n                        if (allowActionPrefix) {\n                            String name = key.substring(ACTION_PREFIX.length());\n                            if (allowDynamicMethodCalls) {\n                                int bang = name.indexOf('!');\n                                if (bang != -1) {\n                                    String method = cleanupActionName(name.substring(bang + 1));\n                                    mapping.setMethod(method);\n                                    name = name.substring(0, bang);\n                                }\n                            }\n                            String actionName = cleanupActionName(name);\n                            if (allowSlashesInActionNames && !allowActionCrossNamespaceAccess) {\n                                if (actionName.startsWith(\"/\")) {\n                                    actionName = actionName.substring(1);\n                                }\n                            }\n                            if (!allowSlashesInActionNames && !allowActionCrossNamespaceAccess) {\n                                if (actionName.lastIndexOf(\"/\") != -1) {\n                                    actionName = actionName.substring(actionName.lastIndexOf(\"/\") + 1);\n                                }\n                            }\n                            mapping.setName(actionName);\n                        }\n                    }"
  },
  {
    "id": 28,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 2,
    "human_patch": "https://github.com/apache/struts/commit/237432512df0e27013f7c7b9ab59fdce44ca34a5",
    "cve_id": "CVE-2016-4436",
    "cwe_id": "Not Mapping",
    "filename": "core/src/main/java/org/apache/struts2/dispatcher/mapper/DefaultActionMapper.java",
    "is_vulnerable": 0,
    "class_name": "DefaultActionMapper",
    "subclass_name": null,
    "function_name": "addParameterAction(String prefix, ParameterAction parameterAction)",
    "function_body": "{\n        prefixTrie.put(prefix, parameterAction);\n    }"
  },
  {
    "id": 28,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 3,
    "human_patch": "https://github.com/apache/struts/commit/237432512df0e27013f7c7b9ab59fdce44ca34a5",
    "cve_id": "CVE-2016-4436",
    "cwe_id": "Not Mapping",
    "filename": "core/src/main/java/org/apache/struts2/dispatcher/mapper/DefaultActionMapper.java",
    "is_vulnerable": 0,
    "class_name": "DefaultActionMapper",
    "subclass_name": null,
    "function_name": "setAllowDynamicMethodCalls(String allow)",
    "function_body": "{\n        allowDynamicMethodCalls = \"true\".equalsIgnoreCase(allow);\n    }"
  },
  {
    "id": 28,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 4,
    "human_patch": "https://github.com/apache/struts/commit/237432512df0e27013f7c7b9ab59fdce44ca34a5",
    "cve_id": "CVE-2016-4436",
    "cwe_id": "Not Mapping",
    "filename": "core/src/main/java/org/apache/struts2/dispatcher/mapper/DefaultActionMapper.java",
    "is_vulnerable": 0,
    "class_name": "DefaultActionMapper",
    "subclass_name": null,
    "function_name": "setSlashesInActionNames(String allow)",
    "function_body": "{\n        allowSlashesInActionNames = \"true\".equals(allow);\n    }"
  },
  {
    "id": 28,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 5,
    "human_patch": "https://github.com/apache/struts/commit/237432512df0e27013f7c7b9ab59fdce44ca34a5",
    "cve_id": "CVE-2016-4436",
    "cwe_id": "Not Mapping",
    "filename": "core/src/main/java/org/apache/struts2/dispatcher/mapper/DefaultActionMapper.java",
    "is_vulnerable": 0,
    "class_name": "DefaultActionMapper",
    "subclass_name": null,
    "function_name": "setAlwaysSelectFullNamespace(String val)",
    "function_body": "{\n        this.alwaysSelectFullNamespace = \"true\".equals(val);\n    }"
  },
  {
    "id": 28,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 6,
    "human_patch": "https://github.com/apache/struts/commit/237432512df0e27013f7c7b9ab59fdce44ca34a5",
    "cve_id": "CVE-2016-4436",
    "cwe_id": "Not Mapping",
    "filename": "core/src/main/java/org/apache/struts2/dispatcher/mapper/DefaultActionMapper.java",
    "is_vulnerable": 0,
    "class_name": "DefaultActionMapper",
    "subclass_name": null,
    "function_name": "setAllowedActionNames(String allowedActionNames)",
    "function_body": "{\n        this.allowedActionNames = Pattern.compile(allowedActionNames);\n    }"
  },
  {
    "id": 28,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 7,
    "human_patch": "https://github.com/apache/struts/commit/237432512df0e27013f7c7b9ab59fdce44ca34a5",
    "cve_id": "CVE-2016-4436",
    "cwe_id": "Not Mapping",
    "filename": "core/src/main/java/org/apache/struts2/dispatcher/mapper/DefaultActionMapper.java",
    "is_vulnerable": 0,
    "class_name": "DefaultActionMapper",
    "subclass_name": null,
    "function_name": "setAllowActionPrefix(String allowActionPrefix)",
    "function_body": "{\n        this.allowActionPrefix = \"true\".equalsIgnoreCase(allowActionPrefix);\n    }"
  },
  {
    "id": 28,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 8,
    "human_patch": "https://github.com/apache/struts/commit/237432512df0e27013f7c7b9ab59fdce44ca34a5",
    "cve_id": "CVE-2016-4436",
    "cwe_id": "Not Mapping",
    "filename": "core/src/main/java/org/apache/struts2/dispatcher/mapper/DefaultActionMapper.java",
    "is_vulnerable": 0,
    "class_name": "DefaultActionMapper",
    "subclass_name": null,
    "function_name": "setAllowActionCrossNamespaceAccess(String allowActionCrossNamespaceAccess)",
    "function_body": "{\n        this.allowActionCrossNamespaceAccess = \"true\".equalsIgnoreCase(allowActionCrossNamespaceAccess);\n    }"
  },
  {
    "id": 28,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 9,
    "human_patch": "https://github.com/apache/struts/commit/237432512df0e27013f7c7b9ab59fdce44ca34a5",
    "cve_id": "CVE-2016-4436",
    "cwe_id": "Not Mapping",
    "filename": "core/src/main/java/org/apache/struts2/dispatcher/mapper/DefaultActionMapper.java",
    "is_vulnerable": 0,
    "class_name": "DefaultActionMapper",
    "subclass_name": null,
    "function_name": "setContainer(Container container)",
    "function_body": "{\n        this.container = container;\n    }"
  },
  {
    "id": 28,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 10,
    "human_patch": "https://github.com/apache/struts/commit/237432512df0e27013f7c7b9ab59fdce44ca34a5",
    "cve_id": "CVE-2016-4436",
    "cwe_id": "Not Mapping",
    "filename": "core/src/main/java/org/apache/struts2/dispatcher/mapper/DefaultActionMapper.java",
    "is_vulnerable": 0,
    "class_name": "DefaultActionMapper",
    "subclass_name": null,
    "function_name": "setExtensions(String extensions)",
    "function_body": "{\n        if (extensions != null && !\"\".equals(extensions)) {\n            List<String> list = new ArrayList<String>();\n            String[] tokens = extensions.split(\",\");\n            Collections.addAll(list, tokens);\n            if (extensions.endsWith(\",\")) {\n                list.add(\"\");\n            }\n            this.extensions = Collections.unmodifiableList(list);\n        } else {\n            this.extensions = null;\n        }\n    }"
  },
  {
    "id": 28,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 11,
    "human_patch": "https://github.com/apache/struts/commit/237432512df0e27013f7c7b9ab59fdce44ca34a5",
    "cve_id": "CVE-2016-4436",
    "cwe_id": "Not Mapping",
    "filename": "core/src/main/java/org/apache/struts2/dispatcher/mapper/DefaultActionMapper.java",
    "is_vulnerable": 0,
    "class_name": "DefaultActionMapper",
    "subclass_name": null,
    "function_name": "getMappingFromActionName(String actionName)",
    "function_body": "{\n        ActionMapping mapping = new ActionMapping();\n        mapping.setName(actionName);\n        return parseActionName(mapping);\n    }"
  },
  {
    "id": 28,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 12,
    "human_patch": "https://github.com/apache/struts/commit/237432512df0e27013f7c7b9ab59fdce44ca34a5",
    "cve_id": "CVE-2016-4436",
    "cwe_id": "Not Mapping",
    "filename": "core/src/main/java/org/apache/struts2/dispatcher/mapper/DefaultActionMapper.java",
    "is_vulnerable": 0,
    "class_name": "DefaultActionMapper",
    "subclass_name": null,
    "function_name": "isSlashesInActionNames()",
    "function_body": "{\n        return allowSlashesInActionNames;\n    }"
  },
  {
    "id": 28,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 13,
    "human_patch": "https://github.com/apache/struts/commit/237432512df0e27013f7c7b9ab59fdce44ca34a5",
    "cve_id": "CVE-2016-4436",
    "cwe_id": "Not Mapping",
    "filename": "core/src/main/java/org/apache/struts2/dispatcher/mapper/DefaultActionMapper.java",
    "is_vulnerable": 0,
    "class_name": "DefaultActionMapper",
    "subclass_name": null,
    "function_name": "getMapping(HttpServletRequest request, ConfigurationManager configManager)",
    "function_body": "{\n        ActionMapping mapping = new ActionMapping();\n        String uri = RequestUtils.getUri(request);\n\n        int indexOfSemicolon = uri.indexOf(\";\");\n        uri = (indexOfSemicolon > -1) ? uri.substring(0, indexOfSemicolon) : uri;\n\n        uri = dropExtension(uri, mapping);\n        if (uri == null) {\n            return null;\n        }\n\n        parseNameAndNamespace(uri, mapping, configManager);\n        handleSpecialParameters(request, mapping);\n        return parseActionName(mapping);\n    }"
  },
  {
    "id": 28,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 14,
    "human_patch": "https://github.com/apache/struts/commit/237432512df0e27013f7c7b9ab59fdce44ca34a5",
    "cve_id": "CVE-2016-4436",
    "cwe_id": "Not Mapping",
    "filename": "core/src/main/java/org/apache/struts2/dispatcher/mapper/DefaultActionMapper.java",
    "is_vulnerable": 0,
    "class_name": "DefaultActionMapper",
    "subclass_name": null,
    "function_name": "parseActionName(ActionMapping mapping)",
    "function_body": "{\n        if (mapping.getName() == null) {\n            return null;\n        }\n        if (allowDynamicMethodCalls) {\n            \n            String name = mapping.getName();\n            int exclamation = name.lastIndexOf(\"!\");\n            if (exclamation != -1) {\n                mapping.setName(name.substring(0, exclamation));\n\n                mapping.setMethod(name.substring(exclamation + 1));\n            }\n        }\n        return mapping;\n    }"
  },
  {
    "id": 28,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 15,
    "human_patch": "https://github.com/apache/struts/commit/237432512df0e27013f7c7b9ab59fdce44ca34a5",
    "cve_id": "CVE-2016-4436",
    "cwe_id": "Not Mapping",
    "filename": "core/src/main/java/org/apache/struts2/dispatcher/mapper/DefaultActionMapper.java",
    "is_vulnerable": 0,
    "class_name": "DefaultActionMapper",
    "subclass_name": null,
    "function_name": "handleSpecialParameters(HttpServletRequest request, ActionMapping mapping)",
    "function_body": "{\n        \n        Set<String> uniqueParameters = new HashSet<String>();\n        Map parameterMap = request.getParameterMap();\n        for (Object o : parameterMap.keySet()) {\n            String key = (String) o;\n\n            \n            if (key.endsWith(\".x\") || key.endsWith(\".y\")) {\n                key = key.substring(0, key.length() - 2);\n            }\n\n            \n            if (!uniqueParameters.contains(key)) {\n                ParameterAction parameterAction = (ParameterAction) prefixTrie.get(key);\n                if (parameterAction != null) {\n                    parameterAction.execute(key, mapping);\n                    uniqueParameters.add(key);\n                    break;\n                }\n            }\n        }\n    }"
  },
  {
    "id": 28,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 16,
    "human_patch": "https://github.com/apache/struts/commit/237432512df0e27013f7c7b9ab59fdce44ca34a5",
    "cve_id": "CVE-2016-4436",
    "cwe_id": "Not Mapping",
    "filename": "core/src/main/java/org/apache/struts2/dispatcher/mapper/DefaultActionMapper.java",
    "is_vulnerable": 0,
    "class_name": "DefaultActionMapper",
    "subclass_name": null,
    "function_name": "parseNameAndNamespace(String uri, ActionMapping mapping, ConfigurationManager configManager)",
    "function_body": "{\n        String namespace, name;\n        int lastSlash = uri.lastIndexOf(\"/\");\n        if (lastSlash == -1) {\n            namespace = \"\";\n            name = uri;\n        } else if (lastSlash == 0) {\n            \n            \n            \n            namespace = \"/\";\n            name = uri.substring(lastSlash + 1);\n        } else if (alwaysSelectFullNamespace) {\n            \n            namespace = uri.substring(0, lastSlash);\n            name = uri.substring(lastSlash + 1);\n        } else {\n            \n            Configuration config = configManager.getConfiguration();\n            String prefix = uri.substring(0, lastSlash);\n            namespace = \"\";\n            boolean rootAvailable = false;\n            \n            for (PackageConfig cfg : config.getPackageConfigs().values()) {\n                String ns = cfg.getNamespace();\n                if (ns != null && prefix.startsWith(ns) && (prefix.length() == ns.length() || prefix.charAt(ns.length()) == '/')) {\n                    if (ns.length() > namespace.length()) {\n                        namespace = ns;\n                    }\n                }\n                if (\"/\".equals(ns)) {\n                    rootAvailable = true;\n                }\n            }\n\n            name = uri.substring(namespace.length() + 1);\n\n            \n            if (rootAvailable && \"\".equals(namespace)) {\n                namespace = \"/\";\n            }\n        }\n\n        if (!allowSlashesInActionNames) {\n            int pos = name.lastIndexOf('/');\n            if (pos > -1 && pos < name.length() - 1) {\n                name = name.substring(pos + 1);\n            }\n        }\n\n        mapping.setNamespace(namespace);\n        mapping.setName(cleanupActionName(name));\n    }"
  },
  {
    "id": 28,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 17,
    "human_patch": "https://github.com/apache/struts/commit/237432512df0e27013f7c7b9ab59fdce44ca34a5",
    "cve_id": "CVE-2016-4436",
    "cwe_id": "Not Mapping",
    "filename": "core/src/main/java/org/apache/struts2/dispatcher/mapper/DefaultActionMapper.java",
    "is_vulnerable": 1,
    "class_name": "DefaultActionMapper",
    "subclass_name": null,
    "function_name": "cleanupActionName(final String rawActionName)",
    "function_body": "{\n        if (allowedActionNames.matcher(rawActionName).matches()) {\n            return rawActionName;\n        } else {\n            if (LOG.isWarnEnabled()) {\n                LOG.warn(\"Action/method [#0] does not match allowed action names pattern [#1], cleaning it up!\",\n                        rawActionName, allowedActionNames);\n            }\n            String cleanActionName = rawActionName;\n            for (String chunk : allowedActionNames.split(rawActionName)) {\n                cleanActionName = cleanActionName.replace(chunk, \"\");\n            }\n            if (LOG.isDebugEnabled()) {\n                LOG.debug(\"Cleaned action/method name [#0]\", cleanActionName);\n            }\n            return cleanActionName;\n        }\n    }"
  },
  {
    "id": 28,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 18,
    "human_patch": "https://github.com/apache/struts/commit/237432512df0e27013f7c7b9ab59fdce44ca34a5",
    "cve_id": "CVE-2016-4436",
    "cwe_id": "Not Mapping",
    "filename": "core/src/main/java/org/apache/struts2/dispatcher/mapper/DefaultActionMapper.java",
    "is_vulnerable": 0,
    "class_name": "DefaultActionMapper",
    "subclass_name": null,
    "function_name": "dropExtension(String name)",
    "function_body": "{\n        return dropExtension(name, new ActionMapping());\n    }"
  },
  {
    "id": 28,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 19,
    "human_patch": "https://github.com/apache/struts/commit/237432512df0e27013f7c7b9ab59fdce44ca34a5",
    "cve_id": "CVE-2016-4436",
    "cwe_id": "Not Mapping",
    "filename": "core/src/main/java/org/apache/struts2/dispatcher/mapper/DefaultActionMapper.java",
    "is_vulnerable": 0,
    "class_name": "DefaultActionMapper",
    "subclass_name": null,
    "function_name": "dropExtension(String name, ActionMapping mapping)",
    "function_body": "{\n        if (extensions == null) {\n            return name;\n        }\n        for (String ext : extensions) {\n            if (\"\".equals(ext)) {\n                \n                \n                \n                int index = name.lastIndexOf('.');\n                if (index == -1 || name.indexOf('/', index) >= 0) {\n                    return name;\n                }\n            } else {\n                String extension = \".\" + ext;\n                if (name.endsWith(extension)) {\n                    name = name.substring(0, name.length() - extension.length());\n                    mapping.setExtension(ext);\n                    return name;\n                }\n            }\n        }\n        return null;\n    }"
  },
  {
    "id": 28,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 20,
    "human_patch": "https://github.com/apache/struts/commit/237432512df0e27013f7c7b9ab59fdce44ca34a5",
    "cve_id": "CVE-2016-4436",
    "cwe_id": "Not Mapping",
    "filename": "core/src/main/java/org/apache/struts2/dispatcher/mapper/DefaultActionMapper.java",
    "is_vulnerable": 0,
    "class_name": "DefaultActionMapper",
    "subclass_name": null,
    "function_name": "getDefaultExtension()",
    "function_body": "{\n        if (extensions == null) {\n            return null;\n        } else {\n            return extensions.get(0);\n        }\n    }"
  },
  {
    "id": 28,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 21,
    "human_patch": "https://github.com/apache/struts/commit/237432512df0e27013f7c7b9ab59fdce44ca34a5",
    "cve_id": "CVE-2016-4436",
    "cwe_id": "Not Mapping",
    "filename": "core/src/main/java/org/apache/struts2/dispatcher/mapper/DefaultActionMapper.java",
    "is_vulnerable": 0,
    "class_name": "DefaultActionMapper",
    "subclass_name": null,
    "function_name": "getUriFromActionMapping(ActionMapping mapping)",
    "function_body": "{\n        StringBuilder uri = new StringBuilder();\n\n        handleNamespace(mapping, uri);\n        handleName(mapping, uri);\n        handleDynamicMethod(mapping, uri);\n        handleExtension(mapping, uri);\n        handleParams(mapping, uri);\n\n        return uri.toString();\n    }"
  },
  {
    "id": 28,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 22,
    "human_patch": "https://github.com/apache/struts/commit/237432512df0e27013f7c7b9ab59fdce44ca34a5",
    "cve_id": "CVE-2016-4436",
    "cwe_id": "Not Mapping",
    "filename": "core/src/main/java/org/apache/struts2/dispatcher/mapper/DefaultActionMapper.java",
    "is_vulnerable": 0,
    "class_name": "DefaultActionMapper",
    "subclass_name": null,
    "function_name": "handleNamespace(ActionMapping mapping, StringBuilder uri)",
    "function_body": "{\n        if (mapping.getNamespace() != null) {\n            uri.append(mapping.getNamespace());\n            if (!\"/\".equals(mapping.getNamespace())) {\n                uri.append(\"/\");\n            }\n        }\n    }"
  },
  {
    "id": 28,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 23,
    "human_patch": "https://github.com/apache/struts/commit/237432512df0e27013f7c7b9ab59fdce44ca34a5",
    "cve_id": "CVE-2016-4436",
    "cwe_id": "Not Mapping",
    "filename": "core/src/main/java/org/apache/struts2/dispatcher/mapper/DefaultActionMapper.java",
    "is_vulnerable": 0,
    "class_name": "DefaultActionMapper",
    "subclass_name": null,
    "function_name": "handleName(ActionMapping mapping, StringBuilder uri)",
    "function_body": "{\n        String name = mapping.getName();\n        if (name.indexOf('?') != -1) {\n            name = name.substring(0, name.indexOf('?'));\n        }\n        uri.append(name);\n    }"
  },
  {
    "id": 28,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 24,
    "human_patch": "https://github.com/apache/struts/commit/237432512df0e27013f7c7b9ab59fdce44ca34a5",
    "cve_id": "CVE-2016-4436",
    "cwe_id": "Not Mapping",
    "filename": "core/src/main/java/org/apache/struts2/dispatcher/mapper/DefaultActionMapper.java",
    "is_vulnerable": 0,
    "class_name": "DefaultActionMapper",
    "subclass_name": null,
    "function_name": "handleDynamicMethod(ActionMapping mapping, StringBuilder uri)",
    "function_body": "{\n        \n        if (StringUtils.isNotEmpty(mapping.getMethod())) {\n            if (allowDynamicMethodCalls) {\n                \n                String name = mapping.getName();\n                if (!name.contains(\"!\")) {\n                    \n                    uri.append(\"!\").append(mapping.getMethod());\n                }\n            } else {\n                uri.append(\"!\").append(mapping.getMethod());\n            }\n        }\n    }"
  },
  {
    "id": 28,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 25,
    "human_patch": "https://github.com/apache/struts/commit/237432512df0e27013f7c7b9ab59fdce44ca34a5",
    "cve_id": "CVE-2016-4436",
    "cwe_id": "Not Mapping",
    "filename": "core/src/main/java/org/apache/struts2/dispatcher/mapper/DefaultActionMapper.java",
    "is_vulnerable": 0,
    "class_name": "DefaultActionMapper",
    "subclass_name": null,
    "function_name": "handleExtension(ActionMapping mapping, StringBuilder uri)",
    "function_body": "{\n        String extension = lookupExtension(mapping.getExtension());\n\n        if (extension != null) {\n            if (extension.length() == 0 || (extension.length() > 0 && uri.indexOf('.' + extension) == -1)) {\n                if (extension.length() > 0) {\n                    uri.append(\".\").append(extension);\n                }\n            }\n        }\n    }"
  },
  {
    "id": 28,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 26,
    "human_patch": "https://github.com/apache/struts/commit/237432512df0e27013f7c7b9ab59fdce44ca34a5",
    "cve_id": "CVE-2016-4436",
    "cwe_id": "Not Mapping",
    "filename": "core/src/main/java/org/apache/struts2/dispatcher/mapper/DefaultActionMapper.java",
    "is_vulnerable": 0,
    "class_name": "DefaultActionMapper",
    "subclass_name": null,
    "function_name": "lookupExtension(String extension)",
    "function_body": "{\n        if (extension == null) {\n            \n            ActionContext context = ActionContext.getContext();\n            if (context != null) {\n                ActionMapping orig = (ActionMapping) context.get(ServletActionContext.ACTION_MAPPING);\n                if (orig != null) {\n                    extension = orig.getExtension();\n                }\n            }\n            if (extension == null) {\n                extension = getDefaultExtension();\n            }\n        }\n        return extension;\n    }"
  },
  {
    "id": 28,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 27,
    "human_patch": "https://github.com/apache/struts/commit/237432512df0e27013f7c7b9ab59fdce44ca34a5",
    "cve_id": "CVE-2016-4436",
    "cwe_id": "Not Mapping",
    "filename": "core/src/main/java/org/apache/struts2/dispatcher/mapper/DefaultActionMapper.java",
    "is_vulnerable": 0,
    "class_name": "DefaultActionMapper",
    "subclass_name": null,
    "function_name": "handleParams(ActionMapping mapping, StringBuilder uri)",
    "function_body": "{\n        String name = mapping.getName();\n        String params = \"\";\n        if (name.indexOf('?') != -1) {\n            params = name.substring(name.indexOf('?'));\n        }\n        if (params.length() > 0) {\n            uri.append(params);\n        }\n    }"
  },
  {
    "id": 28,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 0,
    "human_patch": "https://github.com/apache/struts/commit/237432512df0e27013f7c7b9ab59fdce44ca34a5",
    "cve_id": "CVE-2016-4436",
    "cwe_id": "Not Mapping",
    "filename": "core/src/test/java/org/apache/struts2/dispatcher/mapper/DefaultActionMapperTest.java",
    "is_vulnerable": 0,
    "class_name": "DefaultActionMapperTest",
    "subclass_name": null,
    "function_name": "setUp() throws Exception",
    "function_body": "{\n        super.setUp();\n        req = new MockHttpServletRequest();\n        req.setupGetParameterMap(new HashMap());\n        req.setupGetContextPath(\"/my/namespace\");\n\n        config = new DefaultConfiguration();\n        PackageConfig pkg = new PackageConfig.Builder(\"myns\")\n            .namespace(\"/my/namespace\").build();\n        PackageConfig pkg2 = new PackageConfig.Builder(\"my\").namespace(\"/my\").build();\n        config.addPackageConfig(\"mvns\", pkg);\n        config.addPackageConfig(\"my\", pkg2);\n        configManager = new ConfigurationManager() {\n            public Configuration getConfiguration() {\n                return config;\n            }\n        };\n    }"
  },
  {
    "id": 28,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 1,
    "human_patch": "https://github.com/apache/struts/commit/237432512df0e27013f7c7b9ab59fdce44ca34a5",
    "cve_id": "CVE-2016-4436",
    "cwe_id": "Not Mapping",
    "filename": "core/src/test/java/org/apache/struts2/dispatcher/mapper/DefaultActionMapperTest.java",
    "is_vulnerable": 0,
    "class_name": "DefaultActionMapperTest",
    "subclass_name": null,
    "function_name": "getConfiguration()",
    "function_body": "{\n                return config;\n            }"
  },
  {
    "id": 28,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 2,
    "human_patch": "https://github.com/apache/struts/commit/237432512df0e27013f7c7b9ab59fdce44ca34a5",
    "cve_id": "CVE-2016-4436",
    "cwe_id": "Not Mapping",
    "filename": "core/src/test/java/org/apache/struts2/dispatcher/mapper/DefaultActionMapperTest.java",
    "is_vulnerable": 0,
    "class_name": "DefaultActionMapperTest",
    "subclass_name": null,
    "function_name": "testGetMapping() throws Exception",
    "function_body": "{\n        req.setupGetRequestURI(\"/my/namespace/actionName.action\");\n        req.setupGetServletPath(\"/my/namespace/actionName.action\");\n        req.setupGetAttribute(null);\n        req.addExpectedGetAttributeName(\"javax.servlet.include.servlet_path\");\n\n        DefaultActionMapper mapper = new DefaultActionMapper();\n        ActionMapping mapping = mapper.getMapping(req, configManager);\n\n        assertEquals(\"/my/namespace\", mapping.getNamespace());\n        assertEquals(\"actionName\", mapping.getName());\n        assertNull(mapping.getMethod());\n    }"
  },
  {
    "id": 28,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 3,
    "human_patch": "https://github.com/apache/struts/commit/237432512df0e27013f7c7b9ab59fdce44ca34a5",
    "cve_id": "CVE-2016-4436",
    "cwe_id": "Not Mapping",
    "filename": "core/src/test/java/org/apache/struts2/dispatcher/mapper/DefaultActionMapperTest.java",
    "is_vulnerable": 0,
    "class_name": "DefaultActionMapperTest",
    "subclass_name": null,
    "function_name": "testGetMappingWithMethod() throws Exception",
    "function_body": "{\n        req.setupGetParameterMap(new HashMap());\n        req.setupGetRequestURI(\"/my/namespace/actionName!add.action\");\n        req.setupGetServletPath(\"/my/namespace/actionName!add.action\");\n        req.setupGetAttribute(null);\n        req.addExpectedGetAttributeName(\"javax.servlet.include.servlet_path\");\n\n        DefaultActionMapper mapper = new DefaultActionMapper();\n        mapper.setAllowDynamicMethodCalls(\"true\");\n        ActionMapping mapping = mapper.getMapping(req, configManager);\n\n        assertEquals(\"/my/namespace\", mapping.getNamespace());\n        assertEquals(\"actionName\", mapping.getName());\n        assertEquals(\"add\", mapping.getMethod());\n    }"
  },
  {
    "id": 28,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 4,
    "human_patch": "https://github.com/apache/struts/commit/237432512df0e27013f7c7b9ab59fdce44ca34a5",
    "cve_id": "CVE-2016-4436",
    "cwe_id": "Not Mapping",
    "filename": "core/src/test/java/org/apache/struts2/dispatcher/mapper/DefaultActionMapperTest.java",
    "is_vulnerable": 0,
    "class_name": "DefaultActionMapperTest",
    "subclass_name": null,
    "function_name": "testGetMappingWithSlashedName() throws Exception",
    "function_body": "{\n\n        req.setupGetRequestURI(\"/my/foo/actionName.action\");\n        req.setupGetServletPath(\"/my/foo/actionName.action\");\n        req.setupGetAttribute(null);\n        req.addExpectedGetAttributeName(\"javax.servlet.include.servlet_path\");\n\n        DefaultActionMapper mapper = new DefaultActionMapper();\n        mapper.setSlashesInActionNames(\"true\");\n        ActionMapping mapping = mapper.getMapping(req, configManager);\n\n        assertEquals(\"/my\", mapping.getNamespace());\n        assertEquals(\"foo/actionName\", mapping.getName());\n        assertNull(mapping.getMethod());\n    }"
  },
  {
    "id": 28,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 5,
    "human_patch": "https://github.com/apache/struts/commit/237432512df0e27013f7c7b9ab59fdce44ca34a5",
    "cve_id": "CVE-2016-4436",
    "cwe_id": "Not Mapping",
    "filename": "core/src/test/java/org/apache/struts2/dispatcher/mapper/DefaultActionMapperTest.java",
    "is_vulnerable": 0,
    "class_name": "DefaultActionMapperTest",
    "subclass_name": null,
    "function_name": "testGetMappingWithSlashedNameAtRootButNoSlashPackage() throws Exception",
    "function_body": "{\n\n        req.setupGetRequestURI(\"/foo/actionName.action\");\n        req.setupGetServletPath(\"/foo/actionName.action\");\n        req.setupGetAttribute(null);\n        req.addExpectedGetAttributeName(\"javax.servlet.include.servlet_path\");\n\n        DefaultActionMapper mapper = new DefaultActionMapper();\n        mapper.setSlashesInActionNames(\"true\");\n        ActionMapping mapping = mapper.getMapping(req, configManager);\n\n        assertEquals(\"\", mapping.getNamespace());\n        assertEquals(\"foo/actionName\", mapping.getName());\n        assertNull(mapping.getMethod());\n    }"
  },
  {
    "id": 28,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 6,
    "human_patch": "https://github.com/apache/struts/commit/237432512df0e27013f7c7b9ab59fdce44ca34a5",
    "cve_id": "CVE-2016-4436",
    "cwe_id": "Not Mapping",
    "filename": "core/src/test/java/org/apache/struts2/dispatcher/mapper/DefaultActionMapperTest.java",
    "is_vulnerable": 0,
    "class_name": "DefaultActionMapperTest",
    "subclass_name": null,
    "function_name": "testGetMappingWithSlashedNameAtRoot() throws Exception",
    "function_body": "{\n        config = new DefaultConfiguration();\n        PackageConfig pkg = new PackageConfig.Builder(\"myns\")\n            .namespace(\"/my/namespace\").build();\n        PackageConfig pkg2 = new PackageConfig.Builder(\"my\").namespace(\"/my\").build();\n        PackageConfig pkg3 = new PackageConfig.Builder(\"root\").namespace(\"/\").build();\n        config.addPackageConfig(\"mvns\", pkg);\n        config.addPackageConfig(\"my\", pkg2);\n        config.addPackageConfig(\"root\", pkg3);\n        configManager = new ConfigurationManager() {\n            public Configuration getConfiguration() {\n                return config;\n            }\n        };\n\n        req.setupGetRequestURI(\"/foo/actionName.action\");\n        req.setupGetServletPath(\"/foo/actionName.action\");\n        req.setupGetAttribute(null);\n        req.addExpectedGetAttributeName(\"javax.servlet.include.servlet_path\");\n\n        DefaultActionMapper mapper = new DefaultActionMapper();\n        mapper.setSlashesInActionNames(\"true\");\n        ActionMapping mapping = mapper.getMapping(req, configManager);\n\n        assertEquals(\"/\", mapping.getNamespace());\n        assertEquals(\"foo/actionName\", mapping.getName());\n        assertNull(mapping.getMethod());\n    }"
  },
  {
    "id": 28,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 7,
    "human_patch": "https://github.com/apache/struts/commit/237432512df0e27013f7c7b9ab59fdce44ca34a5",
    "cve_id": "CVE-2016-4436",
    "cwe_id": "Not Mapping",
    "filename": "core/src/test/java/org/apache/struts2/dispatcher/mapper/DefaultActionMapperTest.java",
    "is_vulnerable": 0,
    "class_name": "DefaultActionMapperTest",
    "subclass_name": null,
    "function_name": "getConfiguration()",
    "function_body": "{\n                return config;\n            }"
  },
  {
    "id": 28,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 8,
    "human_patch": "https://github.com/apache/struts/commit/237432512df0e27013f7c7b9ab59fdce44ca34a5",
    "cve_id": "CVE-2016-4436",
    "cwe_id": "Not Mapping",
    "filename": "core/src/test/java/org/apache/struts2/dispatcher/mapper/DefaultActionMapperTest.java",
    "is_vulnerable": 0,
    "class_name": "DefaultActionMapperTest",
    "subclass_name": null,
    "function_name": "testGetMappingWithNamespaceSlash() throws Exception",
    "function_body": "{\n\n        req.setupGetRequestURI(\"/my.hh/abc.action\");\n        req.setupGetServletPath(\"/my.hh/abc.action\");\n        req.setupGetAttribute(null);\n        req.addExpectedGetAttributeName(\"javax.servlet.include.servlet_path\");\n\n        DefaultActionMapper mapper = new DefaultActionMapper();\n        ActionMapping mapping = mapper.getMapping(req, configManager);\n\n        assertEquals(\"\", mapping.getNamespace());\n        assertEquals(\"abc\", mapping.getName());\n\n        req.setupGetAttribute(null);\n        req.addExpectedGetAttributeName(\"javax.servlet.include.servlet_path\");\n        mapper = new DefaultActionMapper();\n        mapper.setSlashesInActionNames(\"true\");\n        mapping = mapper.getMapping(req, configManager);\n\n        assertEquals(\"\", mapping.getNamespace());\n        assertEquals(\"my.hh/abc\", mapping.getName());\n    }"
  },
  {
    "id": 28,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 9,
    "human_patch": "https://github.com/apache/struts/commit/237432512df0e27013f7c7b9ab59fdce44ca34a5",
    "cve_id": "CVE-2016-4436",
    "cwe_id": "Not Mapping",
    "filename": "core/src/test/java/org/apache/struts2/dispatcher/mapper/DefaultActionMapperTest.java",
    "is_vulnerable": 0,
    "class_name": "DefaultActionMapperTest",
    "subclass_name": null,
    "function_name": "testGetMappingWithUnknownNamespace() throws Exception",
    "function_body": "{\n        req.setupGetRequestURI(\"/bo/foo/actionName.action\");\n        req.setupGetServletPath(\"/bo/foo/actionName.action\");\n        req.setupGetAttribute(null);\n        req.addExpectedGetAttributeName(\"javax.servlet.include.servlet_path\");\n\n        DefaultActionMapper mapper = new DefaultActionMapper();\n        ActionMapping mapping = mapper.getMapping(req, configManager);\n\n        assertEquals(\"\", mapping.getNamespace());\n        assertEquals(\"actionName\", mapping.getName());\n        assertNull(mapping.getMethod());\n    }"
  },
  {
    "id": 28,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 10,
    "human_patch": "https://github.com/apache/struts/commit/237432512df0e27013f7c7b9ab59fdce44ca34a5",
    "cve_id": "CVE-2016-4436",
    "cwe_id": "Not Mapping",
    "filename": "core/src/test/java/org/apache/struts2/dispatcher/mapper/DefaultActionMapperTest.java",
    "is_vulnerable": 0,
    "class_name": "DefaultActionMapperTest",
    "subclass_name": null,
    "function_name": "testGetMappingWithUnknownNamespaceButFullNamespaceSelect() throws Exception",
    "function_body": "{\n        req.setupGetRequestURI(\"/bo/foo/actionName.action\");\n        req.setupGetServletPath(\"/bo/foo/actionName.action\");\n        req.setupGetAttribute(null);\n        req.addExpectedGetAttributeName(\"javax.servlet.include.servlet_path\");\n\n        DefaultActionMapper mapper = new DefaultActionMapper();\n        mapper.setAlwaysSelectFullNamespace(\"true\");\n        ActionMapping mapping = mapper.getMapping(req, configManager);\n\n        assertEquals(\"/bo/foo\", mapping.getNamespace());\n        assertEquals(\"actionName\", mapping.getName());\n        assertNull(mapping.getMethod());\n    }"
  },
  {
    "id": 28,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 11,
    "human_patch": "https://github.com/apache/struts/commit/237432512df0e27013f7c7b9ab59fdce44ca34a5",
    "cve_id": "CVE-2016-4436",
    "cwe_id": "Not Mapping",
    "filename": "core/src/test/java/org/apache/struts2/dispatcher/mapper/DefaultActionMapperTest.java",
    "is_vulnerable": 0,
    "class_name": "DefaultActionMapperTest",
    "subclass_name": null,
    "function_name": "testGetMappingWithActionName_methodAndName() throws Exception",
    "function_body": "{\n        DefaultActionMapper mapper = new DefaultActionMapper();\n        mapper.setAllowDynamicMethodCalls(\"true\");\n        ActionMapping mapping = mapper.getMappingFromActionName(\"actionName!add\");\n        assertEquals(\"actionName\", mapping.getName());\n        assertEquals(\"add\", mapping.getMethod());\n    }"
  },
  {
    "id": 28,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 12,
    "human_patch": "https://github.com/apache/struts/commit/237432512df0e27013f7c7b9ab59fdce44ca34a5",
    "cve_id": "CVE-2016-4436",
    "cwe_id": "Not Mapping",
    "filename": "core/src/test/java/org/apache/struts2/dispatcher/mapper/DefaultActionMapperTest.java",
    "is_vulnerable": 0,
    "class_name": "DefaultActionMapperTest",
    "subclass_name": null,
    "function_name": "testGetMappingWithActionName_name() throws Exception",
    "function_body": "{\n        DefaultActionMapper mapper = new DefaultActionMapper();\n        ActionMapping mapping = mapper.getMappingFromActionName(\"actionName\");\n        assertEquals(\"actionName\", mapping.getName());\n        assertEquals(null, mapping.getMethod());\n    }"
  },
  {
    "id": 28,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 13,
    "human_patch": "https://github.com/apache/struts/commit/237432512df0e27013f7c7b9ab59fdce44ca34a5",
    "cve_id": "CVE-2016-4436",
    "cwe_id": "Not Mapping",
    "filename": "core/src/test/java/org/apache/struts2/dispatcher/mapper/DefaultActionMapperTest.java",
    "is_vulnerable": 0,
    "class_name": "DefaultActionMapperTest",
    "subclass_name": null,
    "function_name": "testGetMappingWithActionName_noDynamicMethod() throws Exception",
    "function_body": "{\n        DefaultActionMapper mapper = new DefaultActionMapper();\n        mapper.setAllowDynamicMethodCalls(\"false\");\n        ActionMapping mapping = mapper.getMappingFromActionName(\"actionName!add\");\n        assertEquals(\"actionName!add\", mapping.getName());\n        assertEquals(null, mapping.getMethod());\n    }"
  },
  {
    "id": 28,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 14,
    "human_patch": "https://github.com/apache/struts/commit/237432512df0e27013f7c7b9ab59fdce44ca34a5",
    "cve_id": "CVE-2016-4436",
    "cwe_id": "Not Mapping",
    "filename": "core/src/test/java/org/apache/struts2/dispatcher/mapper/DefaultActionMapperTest.java",
    "is_vulnerable": 0,
    "class_name": "DefaultActionMapperTest",
    "subclass_name": null,
    "function_name": "testGetMappingWithActionName_noDynamicMethodColonPrefix() throws Exception",
    "function_body": "{\n\n        Map parameterMap = new HashMap();\n        parameterMap.put(DefaultActionMapper.METHOD_PREFIX + \"someMethod\", \"\");\n\n        StrutsMockHttpServletRequest request = new StrutsMockHttpServletRequest();\n        request.setParameterMap(parameterMap);\n        request.setupGetServletPath(\"/someServletPath.action\");\n\n        DefaultActionMapper defaultActionMapper = new DefaultActionMapper();\n        defaultActionMapper.setAllowDynamicMethodCalls(\"false\");\n        ActionMapping actionMapping = defaultActionMapper.getMapping(request, configManager);\n\n        assertEquals(\"someServletPath\", actionMapping.getName());\n        assertEquals(null, actionMapping.getMethod());\n    }"
  },
  {
    "id": 28,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 15,
    "human_patch": "https://github.com/apache/struts/commit/237432512df0e27013f7c7b9ab59fdce44ca34a5",
    "cve_id": "CVE-2016-4436",
    "cwe_id": "Not Mapping",
    "filename": "core/src/test/java/org/apache/struts2/dispatcher/mapper/DefaultActionMapperTest.java",
    "is_vulnerable": 0,
    "class_name": "DefaultActionMapperTest",
    "subclass_name": null,
    "function_name": "testGetMappingWithActionName_null() throws Exception",
    "function_body": "{\n        DefaultActionMapper mapper = new DefaultActionMapper();\n        ActionMapping mapping = mapper.getMappingFromActionName(null);\n        assertNull(mapping);\n    }"
  },
  {
    "id": 28,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 16,
    "human_patch": "https://github.com/apache/struts/commit/237432512df0e27013f7c7b9ab59fdce44ca34a5",
    "cve_id": "CVE-2016-4436",
    "cwe_id": "Not Mapping",
    "filename": "core/src/test/java/org/apache/struts2/dispatcher/mapper/DefaultActionMapperTest.java",
    "is_vulnerable": 0,
    "class_name": "DefaultActionMapperTest",
    "subclass_name": null,
    "function_name": "testGetUri() throws Exception",
    "function_body": "{\n        req.setupGetParameterMap(new HashMap());\n        req.setupGetRequestURI(\"/my/namespace/actionName.action\");\n        req.setupGetServletPath(\"/my/namespace/actionName.action\");\n        req.setupGetAttribute(null);\n        req.addExpectedGetAttributeName(\"javax.servlet.include.servlet_path\");\n\n        DefaultActionMapper mapper = new DefaultActionMapper();\n        ActionMapping mapping = mapper.getMapping(req, configManager);\n        assertEquals(\"/my/namespace/actionName.action\", mapper.getUriFromActionMapping(mapping));\n    }"
  },
  {
    "id": 28,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 17,
    "human_patch": "https://github.com/apache/struts/commit/237432512df0e27013f7c7b9ab59fdce44ca34a5",
    "cve_id": "CVE-2016-4436",
    "cwe_id": "Not Mapping",
    "filename": "core/src/test/java/org/apache/struts2/dispatcher/mapper/DefaultActionMapperTest.java",
    "is_vulnerable": 0,
    "class_name": "DefaultActionMapperTest",
    "subclass_name": null,
    "function_name": "testGetUriWithSemicolonPresent() throws Exception",
    "function_body": "{\n        req.setupGetParameterMap(new HashMap());\n        req.setupGetRequestURI(\"/my/namespace/actionName.action;abc=123rty56\");\n        req.setupGetServletPath(\"/my/namespace/actionName.action;abc=123rty56\");\n        req.setupGetAttribute(null);\n        req.addExpectedGetAttributeName(\"javax.servlet.include.servlet_path\");\n\n        DefaultActionMapper mapper = new DefaultActionMapper();\n        ActionMapping mapping = mapper.getMapping(req, configManager);\n        assertEquals(\"/my/namespace/actionName.action\", mapper.getUriFromActionMapping(mapping));\n    }"
  },
  {
    "id": 28,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 18,
    "human_patch": "https://github.com/apache/struts/commit/237432512df0e27013f7c7b9ab59fdce44ca34a5",
    "cve_id": "CVE-2016-4436",
    "cwe_id": "Not Mapping",
    "filename": "core/src/test/java/org/apache/struts2/dispatcher/mapper/DefaultActionMapperTest.java",
    "is_vulnerable": 0,
    "class_name": "DefaultActionMapperTest",
    "subclass_name": null,
    "function_name": "testGetUriWithMethod() throws Exception",
    "function_body": "{\n        req.setupGetParameterMap(new HashMap());\n        req.setupGetRequestURI(\"/my/namespace/actionName!add.action\");\n        req.setupGetServletPath(\"/my/namespace/actionName!add.action\");\n        req.setupGetAttribute(null);\n        req.addExpectedGetAttributeName(\"javax.servlet.include.servlet_path\");\n\n        DefaultActionMapper mapper = new DefaultActionMapper();\n        ActionMapping mapping = mapper.getMapping(req, configManager);\n\n        assertEquals(\"/my/namespace/actionName!add.action\", mapper.getUriFromActionMapping(mapping));\n    }"
  },
  {
    "id": 28,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 19,
    "human_patch": "https://github.com/apache/struts/commit/237432512df0e27013f7c7b9ab59fdce44ca34a5",
    "cve_id": "CVE-2016-4436",
    "cwe_id": "Not Mapping",
    "filename": "core/src/test/java/org/apache/struts2/dispatcher/mapper/DefaultActionMapperTest.java",
    "is_vulnerable": 0,
    "class_name": "DefaultActionMapperTest",
    "subclass_name": null,
    "function_name": "testGetUriWithOriginalExtension() throws Exception",
    "function_body": "{\n        ActionMapping mapping = new ActionMapping(\"actionName\", \"/ns\", null, new HashMap());\n\n        ActionMapping orig = new ActionMapping();\n        orig.setExtension(\"foo\");\n        ActionContext.getContext().put(ServletActionContext.ACTION_MAPPING, orig);\n\n        DefaultActionMapper mapper = new DefaultActionMapper();\n        assertEquals(\"/ns/actionName.foo\", mapper.getUriFromActionMapping(mapping));\n    }"
  },
  {
    "id": 28,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 20,
    "human_patch": "https://github.com/apache/struts/commit/237432512df0e27013f7c7b9ab59fdce44ca34a5",
    "cve_id": "CVE-2016-4436",
    "cwe_id": "Not Mapping",
    "filename": "core/src/test/java/org/apache/struts2/dispatcher/mapper/DefaultActionMapperTest.java",
    "is_vulnerable": 0,
    "class_name": "DefaultActionMapperTest",
    "subclass_name": null,
    "function_name": "testGetMappingWithNoExtension() throws Exception",
    "function_body": "{\n        req.setupGetParameterMap(new HashMap());\n        req.setupGetRequestURI(\"/my/namespace/actionName\");\n        req.setupGetServletPath(\"/my/namespace/actionName\");\n        req.setupGetAttribute(null);\n        req.addExpectedGetAttributeName(\"javax.servlet.include.servlet_path\");\n\n        DefaultActionMapper mapper = new DefaultActionMapper();\n        mapper.setExtensions(\"\");\n        ActionMapping mapping = mapper.getMapping(req, configManager);\n\n        assertEquals(\"/my/namespace\", mapping.getNamespace());\n        assertEquals(\"actionName\", mapping.getName());\n        assertNull(mapping.getMethod());\n    }"
  },
  {
    "id": 28,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 21,
    "human_patch": "https://github.com/apache/struts/commit/237432512df0e27013f7c7b9ab59fdce44ca34a5",
    "cve_id": "CVE-2016-4436",
    "cwe_id": "Not Mapping",
    "filename": "core/src/test/java/org/apache/struts2/dispatcher/mapper/DefaultActionMapperTest.java",
    "is_vulnerable": 0,
    "class_name": "DefaultActionMapperTest",
    "subclass_name": null,
    "function_name": "testGetMappingWithNoExtensionButUriHasExtension() throws Exception",
    "function_body": "{\n        req.setupGetParameterMap(new HashMap());\n        req.setupGetRequestURI(\"/my/namespace/actionName.html\");\n        req.setupGetServletPath(\"/my/namespace/actionName.html\");\n        req.setupGetAttribute(null);\n        req.addExpectedGetAttributeName(\"javax.servlet.include.servlet_path\");\n\n        DefaultActionMapper mapper = new DefaultActionMapper();\n        mapper.setExtensions(\"\");\n        ActionMapping mapping = mapper.getMapping(req, configManager);\n\n        assertEquals(\"/my/namespace\", mapping.getNamespace());\n        assertEquals(\"actionName.html\", mapping.getName());\n        assertNull(mapping.getMethod());\n    }"
  },
  {
    "id": 28,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 22,
    "human_patch": "https://github.com/apache/struts/commit/237432512df0e27013f7c7b9ab59fdce44ca34a5",
    "cve_id": "CVE-2016-4436",
    "cwe_id": "Not Mapping",
    "filename": "core/src/test/java/org/apache/struts2/dispatcher/mapper/DefaultActionMapperTest.java",
    "is_vulnerable": 0,
    "class_name": "DefaultActionMapperTest",
    "subclass_name": null,
    "function_name": "testParseNameAndNamespace1() throws Exception",
    "function_body": "{\n        ActionMapping actionMapping = new ActionMapping();\n\n        DefaultActionMapper defaultActionMapper = new DefaultActionMapper();\n        defaultActionMapper.parseNameAndNamespace(\"someAction\", actionMapping, configManager);\n\n        assertEquals(actionMapping.getName(), \"someAction\");\n        assertEquals(actionMapping.getNamespace(), \"\");\n    }"
  },
  {
    "id": 28,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 23,
    "human_patch": "https://github.com/apache/struts/commit/237432512df0e27013f7c7b9ab59fdce44ca34a5",
    "cve_id": "CVE-2016-4436",
    "cwe_id": "Not Mapping",
    "filename": "core/src/test/java/org/apache/struts2/dispatcher/mapper/DefaultActionMapperTest.java",
    "is_vulnerable": 0,
    "class_name": "DefaultActionMapperTest",
    "subclass_name": null,
    "function_name": "testParseNameAndNamespace2() throws Exception",
    "function_body": "{\n        ActionMapping actionMapping = new ActionMapping();\n\n        DefaultActionMapper defaultActionMapper = new DefaultActionMapper();\n        defaultActionMapper.parseNameAndNamespace(\"/someAction\", actionMapping, configManager);\n\n        assertEquals(actionMapping.getName(), \"someAction\");\n        assertEquals(actionMapping.getNamespace(), \"/\");\n    }"
  },
  {
    "id": 28,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 24,
    "human_patch": "https://github.com/apache/struts/commit/237432512df0e27013f7c7b9ab59fdce44ca34a5",
    "cve_id": "CVE-2016-4436",
    "cwe_id": "Not Mapping",
    "filename": "core/src/test/java/org/apache/struts2/dispatcher/mapper/DefaultActionMapperTest.java",
    "is_vulnerable": 0,
    "class_name": "DefaultActionMapperTest",
    "subclass_name": null,
    "function_name": "testParseNameAndNamespace3() throws Exception",
    "function_body": "{\n        ActionMapping actionMapping = new ActionMapping();\n\n        DefaultActionMapper defaultActionMapper = new DefaultActionMapper();\n        defaultActionMapper.parseNameAndNamespace(\"/my/someAction\", actionMapping, configManager);\n\n        assertEquals(actionMapping.getName(), \"someAction\");\n        assertEquals(actionMapping.getNamespace(), \"/my\");\n    }"
  },
  {
    "id": 28,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 25,
    "human_patch": "https://github.com/apache/struts/commit/237432512df0e27013f7c7b9ab59fdce44ca34a5",
    "cve_id": "CVE-2016-4436",
    "cwe_id": "Not Mapping",
    "filename": "core/src/test/java/org/apache/struts2/dispatcher/mapper/DefaultActionMapperTest.java",
    "is_vulnerable": 0,
    "class_name": "DefaultActionMapperTest",
    "subclass_name": null,
    "function_name": "testParseNameAndNamespace_NoSlashes() throws Exception",
    "function_body": "{\n        ActionMapping actionMapping = new ActionMapping();\n\n        DefaultActionMapper defaultActionMapper = new DefaultActionMapper();\n        defaultActionMapper.setSlashesInActionNames(\"false\");\n        defaultActionMapper.parseNameAndNamespace(\"/foo/someAction\", actionMapping, configManager);\n\n        assertEquals(actionMapping.getName(), \"someAction\");\n        assertEquals(actionMapping.getNamespace(), \"\");\n    }"
  },
  {
    "id": 28,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 26,
    "human_patch": "https://github.com/apache/struts/commit/237432512df0e27013f7c7b9ab59fdce44ca34a5",
    "cve_id": "CVE-2016-4436",
    "cwe_id": "Not Mapping",
    "filename": "core/src/test/java/org/apache/struts2/dispatcher/mapper/DefaultActionMapperTest.java",
    "is_vulnerable": 0,
    "class_name": "DefaultActionMapperTest",
    "subclass_name": null,
    "function_name": "testParseNameAndNamespace_AllowSlashes() throws Exception",
    "function_body": "{\n        ActionMapping actionMapping = new ActionMapping();\n\n        DefaultActionMapper defaultActionMapper = new DefaultActionMapper();\n        defaultActionMapper.setSlashesInActionNames(\"true\");\n        defaultActionMapper.parseNameAndNamespace(\"/foo/someAction\", actionMapping, configManager);\n\n        assertEquals(actionMapping.getName(), \"foo/someAction\");\n        assertEquals(actionMapping.getNamespace(), \"\");\n    }"
  },
  {
    "id": 28,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 27,
    "human_patch": "https://github.com/apache/struts/commit/237432512df0e27013f7c7b9ab59fdce44ca34a5",
    "cve_id": "CVE-2016-4436",
    "cwe_id": "Not Mapping",
    "filename": "core/src/test/java/org/apache/struts2/dispatcher/mapper/DefaultActionMapperTest.java",
    "is_vulnerable": 0,
    "class_name": "DefaultActionMapperTest",
    "subclass_name": null,
    "function_name": "testActionPrefixWhenDisabled() throws Exception",
    "function_body": "{\n        Map parameterMap = new HashMap();\n        parameterMap.put(DefaultActionMapper.ACTION_PREFIX + \"myAction\", \"\");\n\n        StrutsMockHttpServletRequest request = new StrutsMockHttpServletRequest();\n        request.setParameterMap(parameterMap);\n        request.setupGetServletPath(\"/someServletPath.action\");\n\n        DefaultActionMapper defaultActionMapper = new DefaultActionMapper();\n        ActionMapping actionMapping = defaultActionMapper.getMapping(request, configManager);\n\n        assertEquals(\"someServletPath\", actionMapping.getName());\n    }"
  },
  {
    "id": 28,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 28,
    "human_patch": "https://github.com/apache/struts/commit/237432512df0e27013f7c7b9ab59fdce44ca34a5",
    "cve_id": "CVE-2016-4436",
    "cwe_id": "Not Mapping",
    "filename": "core/src/test/java/org/apache/struts2/dispatcher/mapper/DefaultActionMapperTest.java",
    "is_vulnerable": 0,
    "class_name": "DefaultActionMapperTest",
    "subclass_name": null,
    "function_name": "testActionPrefixWhenEnabled() throws Exception",
    "function_body": "{\n        Map parameterMap = new HashMap();\n        parameterMap.put(DefaultActionMapper.ACTION_PREFIX + \"myAction\", \"\");\n\n        StrutsMockHttpServletRequest request = new StrutsMockHttpServletRequest();\n        request.setParameterMap(parameterMap);\n        request.setupGetServletPath(\"/someServletPath.action\");\n\n        DefaultActionMapper defaultActionMapper = new DefaultActionMapper();\n        defaultActionMapper.setAllowActionPrefix(\"true\");\n        ActionMapping actionMapping = defaultActionMapper.getMapping(request, configManager);\n\n        assertEquals(\"myAction\", actionMapping.getName());\n    }"
  },
  {
    "id": 28,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 29,
    "human_patch": "https://github.com/apache/struts/commit/237432512df0e27013f7c7b9ab59fdce44ca34a5",
    "cve_id": "CVE-2016-4436",
    "cwe_id": "Not Mapping",
    "filename": "core/src/test/java/org/apache/struts2/dispatcher/mapper/DefaultActionMapperTest.java",
    "is_vulnerable": 0,
    "class_name": "DefaultActionMapperTest",
    "subclass_name": null,
    "function_name": "testActionPrefixWhenSlashesAndCrossNamespaceDisabled() throws Exception",
    "function_body": "{\n        Map parameterMap = new HashMap();\n        parameterMap.put(DefaultActionMapper.ACTION_PREFIX + \"my/Action\", \"\");\n\n        StrutsMockHttpServletRequest request = new StrutsMockHttpServletRequest();\n        request.setParameterMap(parameterMap);\n        request.setupGetServletPath(\"/someServletPath.action\");\n\n        DefaultActionMapper defaultActionMapper = new DefaultActionMapper();\n        defaultActionMapper.setAllowActionPrefix(\"true\");\n        defaultActionMapper.setSlashesInActionNames(\"true\");\n        ActionMapping actionMapping = defaultActionMapper.getMapping(request, configManager);\n\n        assertEquals(\"my/Action\", actionMapping.getName());\n    }"
  },
  {
    "id": 28,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 30,
    "human_patch": "https://github.com/apache/struts/commit/237432512df0e27013f7c7b9ab59fdce44ca34a5",
    "cve_id": "CVE-2016-4436",
    "cwe_id": "Not Mapping",
    "filename": "core/src/test/java/org/apache/struts2/dispatcher/mapper/DefaultActionMapperTest.java",
    "is_vulnerable": 0,
    "class_name": "DefaultActionMapperTest",
    "subclass_name": null,
    "function_name": "testActionPrefixWhenSlashesButSlashesDisabledAndCrossNamespaceDisabled() throws Exception",
    "function_body": "{\n        Map parameterMap = new HashMap();\n        parameterMap.put(DefaultActionMapper.ACTION_PREFIX + \"my/Action\", \"\");\n\n        StrutsMockHttpServletRequest request = new StrutsMockHttpServletRequest();\n        request.setParameterMap(parameterMap);\n        request.setupGetServletPath(\"/someServletPath.action\");\n\n        DefaultActionMapper defaultActionMapper = new DefaultActionMapper();\n        defaultActionMapper.setAllowActionPrefix(\"true\");\n        defaultActionMapper.setSlashesInActionNames(\"false\");\n        ActionMapping actionMapping = defaultActionMapper.getMapping(request, configManager);\n\n        assertEquals(\"Action\", actionMapping.getName());\n    }"
  },
  {
    "id": 28,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 31,
    "human_patch": "https://github.com/apache/struts/commit/237432512df0e27013f7c7b9ab59fdce44ca34a5",
    "cve_id": "CVE-2016-4436",
    "cwe_id": "Not Mapping",
    "filename": "core/src/test/java/org/apache/struts2/dispatcher/mapper/DefaultActionMapperTest.java",
    "is_vulnerable": 0,
    "class_name": "DefaultActionMapperTest",
    "subclass_name": null,
    "function_name": "testActionPrefixWhenSlashesButSlashesDisabledAndCrossNamespace() throws Exception",
    "function_body": "{\n        Map parameterMap = new HashMap();\n        parameterMap.put(DefaultActionMapper.ACTION_PREFIX + \"my/Action\", \"\");\n\n        StrutsMockHttpServletRequest request = new StrutsMockHttpServletRequest();\n        request.setParameterMap(parameterMap);\n        request.setupGetServletPath(\"/someServletPath.action\");\n\n        DefaultActionMapper defaultActionMapper = new DefaultActionMapper();\n        defaultActionMapper.setAllowActionPrefix(\"true\");\n        defaultActionMapper.setAllowActionCrossNamespaceAccess(\"true\");\n        defaultActionMapper.setSlashesInActionNames(\"false\");\n        ActionMapping actionMapping = defaultActionMapper.getMapping(request, configManager);\n\n        assertEquals(\"my/Action\", actionMapping.getName());\n    }"
  },
  {
    "id": 28,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 32,
    "human_patch": "https://github.com/apache/struts/commit/237432512df0e27013f7c7b9ab59fdce44ca34a5",
    "cve_id": "CVE-2016-4436",
    "cwe_id": "Not Mapping",
    "filename": "core/src/test/java/org/apache/struts2/dispatcher/mapper/DefaultActionMapperTest.java",
    "is_vulnerable": 0,
    "class_name": "DefaultActionMapperTest",
    "subclass_name": null,
    "function_name": "testActionPrefixWhenCrossNamespace() throws Exception",
    "function_body": "{\n        Map parameterMap = new HashMap();\n        parameterMap.put(DefaultActionMapper.ACTION_PREFIX + \"/my/Action\", \"\");\n\n        StrutsMockHttpServletRequest request = new StrutsMockHttpServletRequest();\n        request.setParameterMap(parameterMap);\n        request.setupGetServletPath(\"/someServletPath.action\");\n\n        DefaultActionMapper defaultActionMapper = new DefaultActionMapper();\n        defaultActionMapper.setAllowActionPrefix(\"true\");\n        defaultActionMapper.setAllowActionCrossNamespaceAccess(\"true\");\n        ActionMapping actionMapping = defaultActionMapper.getMapping(request, configManager);\n\n        assertEquals(\"/my/Action\", actionMapping.getName());\n    }"
  },
  {
    "id": 28,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 33,
    "human_patch": "https://github.com/apache/struts/commit/237432512df0e27013f7c7b9ab59fdce44ca34a5",
    "cve_id": "CVE-2016-4436",
    "cwe_id": "Not Mapping",
    "filename": "core/src/test/java/org/apache/struts2/dispatcher/mapper/DefaultActionMapperTest.java",
    "is_vulnerable": 0,
    "class_name": "DefaultActionMapperTest",
    "subclass_name": null,
    "function_name": "testActionPrefix_fromImageButton() throws Exception",
    "function_body": "{\n        Map parameterMap = new HashMap();\n        parameterMap.put(DefaultActionMapper.ACTION_PREFIX + \"myAction\", \"\");\n        parameterMap.put(DefaultActionMapper.ACTION_PREFIX + \"myAction.x\", \"\");\n        parameterMap.put(DefaultActionMapper.ACTION_PREFIX + \"myAction.y\", \"\");\n\n        StrutsMockHttpServletRequest request = new StrutsMockHttpServletRequest();\n        request.setParameterMap(parameterMap);\n        request.setupGetServletPath(\"/someServletPath.action\");\n\n        DefaultActionMapper defaultActionMapper = new DefaultActionMapper();\n        defaultActionMapper.setAllowActionPrefix(\"true\");\n        ActionMapping actionMapping = defaultActionMapper.getMapping(request, configManager);\n\n        assertEquals(\"myAction\", actionMapping.getName());\n    }"
  },
  {
    "id": 28,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 34,
    "human_patch": "https://github.com/apache/struts/commit/237432512df0e27013f7c7b9ab59fdce44ca34a5",
    "cve_id": "CVE-2016-4436",
    "cwe_id": "Not Mapping",
    "filename": "core/src/test/java/org/apache/struts2/dispatcher/mapper/DefaultActionMapperTest.java",
    "is_vulnerable": 0,
    "class_name": "DefaultActionMapperTest",
    "subclass_name": null,
    "function_name": "testActionPrefix_fromIEImageButton() throws Exception",
    "function_body": "{\n        Map parameterMap = new HashMap();\n        parameterMap.put(DefaultActionMapper.ACTION_PREFIX + \"myAction.x\", \"\");\n        parameterMap.put(DefaultActionMapper.ACTION_PREFIX + \"myAction.y\", \"\");\n\n        StrutsMockHttpServletRequest request = new StrutsMockHttpServletRequest();\n        request.setParameterMap(parameterMap);\n        request.setupGetServletPath(\"/someServletPath.action\");\n\n        DefaultActionMapper defaultActionMapper = new DefaultActionMapper();\n        defaultActionMapper.setAllowActionPrefix(\"true\");\n        ActionMapping actionMapping = defaultActionMapper.getMapping(request, configManager);\n\n        assertEquals(\"myAction\", actionMapping.getName());\n    }"
  },
  {
    "id": 28,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 35,
    "human_patch": "https://github.com/apache/struts/commit/237432512df0e27013f7c7b9ab59fdce44ca34a5",
    "cve_id": "CVE-2016-4436",
    "cwe_id": "Not Mapping",
    "filename": "core/src/test/java/org/apache/struts2/dispatcher/mapper/DefaultActionMapperTest.java",
    "is_vulnerable": 0,
    "class_name": "DefaultActionMapperTest",
    "subclass_name": null,
    "function_name": "testRedirectPrefix() throws Exception",
    "function_body": "{\n        Map parameterMap = new HashMap();\n        parameterMap.put(\"redirect:\" + \"http://www.google.com\", \"\");\n\n        StrutsMockHttpServletRequest request = new StrutsMockHttpServletRequest();\n        request.setupGetServletPath(\"/someServletPath.action\");\n        request.setParameterMap(parameterMap);\n\n        DefaultActionMapper defaultActionMapper = new DefaultActionMapper();\n        defaultActionMapper.setContainer(container);\n        ActionMapping actionMapping = defaultActionMapper.getMapping(request, configManager);\n\n        Result result = actionMapping.getResult();\n        assertNull(result);\n    }"
  },
  {
    "id": 28,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 36,
    "human_patch": "https://github.com/apache/struts/commit/237432512df0e27013f7c7b9ab59fdce44ca34a5",
    "cve_id": "CVE-2016-4436",
    "cwe_id": "Not Mapping",
    "filename": "core/src/test/java/org/apache/struts2/dispatcher/mapper/DefaultActionMapperTest.java",
    "is_vulnerable": 0,
    "class_name": "DefaultActionMapperTest",
    "subclass_name": null,
    "function_name": "testUnsafeRedirectPrefix() throws Exception",
    "function_body": "{\n        Map parameterMap = new HashMap();\n        parameterMap.put(\"redirect:\" + \"http://%{3*4}\", \"\");\n\n        StrutsMockHttpServletRequest request = new StrutsMockHttpServletRequest();\n        request.setupGetServletPath(\"/someServletPath.action\");\n        request.setParameterMap(parameterMap);\n\n        DefaultActionMapper defaultActionMapper = new DefaultActionMapper();\n        defaultActionMapper.setContainer(container);\n        ActionMapping actionMapping = defaultActionMapper.getMapping(request, configManager);\n\n        Result result = actionMapping.getResult();\n        assertNull(result);\n    }"
  },
  {
    "id": 28,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 37,
    "human_patch": "https://github.com/apache/struts/commit/237432512df0e27013f7c7b9ab59fdce44ca34a5",
    "cve_id": "CVE-2016-4436",
    "cwe_id": "Not Mapping",
    "filename": "core/src/test/java/org/apache/struts2/dispatcher/mapper/DefaultActionMapperTest.java",
    "is_vulnerable": 0,
    "class_name": "DefaultActionMapperTest",
    "subclass_name": null,
    "function_name": "testRedirectActionPrefix() throws Exception",
    "function_body": "{\n        Map parameterMap = new HashMap();\n        parameterMap.put(\"redirectAction:\" + \"myAction\", \"\");\n\n        StrutsMockHttpServletRequest request = new StrutsMockHttpServletRequest();\n        request.setupGetServletPath(\"/someServletPath.action\");\n        request.setParameterMap(parameterMap);\n\n        DefaultActionMapper defaultActionMapper = new DefaultActionMapper();\n        defaultActionMapper.setContainer(container);\n        ActionMapping actionMapping = defaultActionMapper.getMapping(request, configManager);\n\n\n        StrutsResultSupport result = (StrutsResultSupport) actionMapping.getResult();\n        assertNull(result);\n    }"
  },
  {
    "id": 28,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 38,
    "human_patch": "https://github.com/apache/struts/commit/237432512df0e27013f7c7b9ab59fdce44ca34a5",
    "cve_id": "CVE-2016-4436",
    "cwe_id": "Not Mapping",
    "filename": "core/src/test/java/org/apache/struts2/dispatcher/mapper/DefaultActionMapperTest.java",
    "is_vulnerable": 0,
    "class_name": "DefaultActionMapperTest",
    "subclass_name": null,
    "function_name": "testUnsafeRedirectActionPrefix() throws Exception",
    "function_body": "{\n        Map parameterMap = new HashMap();\n        parameterMap.put(\"redirectAction:\" + \"%{3*4}\", \"\");\n\n        StrutsMockHttpServletRequest request = new StrutsMockHttpServletRequest();\n        request.setupGetServletPath(\"/someServletPath.action\");\n        request.setParameterMap(parameterMap);\n\n        DefaultActionMapper defaultActionMapper = new DefaultActionMapper();\n        defaultActionMapper.setContainer(container);\n        ActionMapping actionMapping = defaultActionMapper.getMapping(request, configManager);\n\n\n        StrutsResultSupport result = (StrutsResultSupport) actionMapping.getResult();\n        assertNull(result);\n    }"
  },
  {
    "id": 28,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 39,
    "human_patch": "https://github.com/apache/struts/commit/237432512df0e27013f7c7b9ab59fdce44ca34a5",
    "cve_id": "CVE-2016-4436",
    "cwe_id": "Not Mapping",
    "filename": "core/src/test/java/org/apache/struts2/dispatcher/mapper/DefaultActionMapperTest.java",
    "is_vulnerable": 0,
    "class_name": "DefaultActionMapperTest",
    "subclass_name": null,
    "function_name": "testRedirectActionPrefixWithEmptyExtension() throws Exception",
    "function_body": "{\n        Map parameterMap = new HashMap();\n        parameterMap.put(\"redirectAction:\" + \"myAction\", \"\");\n\n        StrutsMockHttpServletRequest request = new StrutsMockHttpServletRequest();\n        request.setupGetServletPath(\"/someServletPath\");\n        request.setParameterMap(parameterMap);\n\n        DefaultActionMapper defaultActionMapper = new DefaultActionMapper();\n        defaultActionMapper.setContainer(container);\n        defaultActionMapper.setExtensions(\",,\");\n        ActionMapping actionMapping = defaultActionMapper.getMapping(request, configManager);\n\n\n        StrutsResultSupport result = (StrutsResultSupport) actionMapping.getResult();\n        assertNull(result);\n    }"
  },
  {
    "id": 28,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 40,
    "human_patch": "https://github.com/apache/struts/commit/237432512df0e27013f7c7b9ab59fdce44ca34a5",
    "cve_id": "CVE-2016-4436",
    "cwe_id": "Not Mapping",
    "filename": "core/src/test/java/org/apache/struts2/dispatcher/mapper/DefaultActionMapperTest.java",
    "is_vulnerable": 0,
    "class_name": "DefaultActionMapperTest",
    "subclass_name": null,
    "function_name": "testCustomActionPrefix() throws Exception",
    "function_body": "{\n        Map parameterMap = new HashMap();\n        parameterMap.put(\"foo:myAction\", \"\");\n\n        final StrutsMockHttpServletRequest request = new StrutsMockHttpServletRequest();\n        request.setParameterMap(parameterMap);\n        request.setupGetServletPath(\"/someServletPath.action\");\n\n        DefaultActionMapper defaultActionMapper = new DefaultActionMapper();\n        defaultActionMapper.addParameterAction(\"foo\", new ParameterAction() {\n            public void execute(String key, ActionMapping mapping) {\n                mapping.setName(\"myAction\");\n            }\n        });\n        ActionMapping actionMapping = defaultActionMapper.getMapping(request, configManager);\n\n        assertEquals(actionMapping.getName(), \"myAction\");\n    }"
  },
  {
    "id": 28,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 41,
    "human_patch": "https://github.com/apache/struts/commit/237432512df0e27013f7c7b9ab59fdce44ca34a5",
    "cve_id": "CVE-2016-4436",
    "cwe_id": "Not Mapping",
    "filename": "core/src/test/java/org/apache/struts2/dispatcher/mapper/DefaultActionMapperTest.java",
    "is_vulnerable": 0,
    "class_name": "DefaultActionMapperTest",
    "subclass_name": null,
    "function_name": "execute(String key, ActionMapping mapping)",
    "function_body": "{\n                mapping.setName(\"myAction\");\n            }"
  },
  {
    "id": 28,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 42,
    "human_patch": "https://github.com/apache/struts/commit/237432512df0e27013f7c7b9ab59fdce44ca34a5",
    "cve_id": "CVE-2016-4436",
    "cwe_id": "Not Mapping",
    "filename": "core/src/test/java/org/apache/struts2/dispatcher/mapper/DefaultActionMapperTest.java",
    "is_vulnerable": 0,
    "class_name": "DefaultActionMapperTest",
    "subclass_name": null,
    "function_name": "testDropExtension() throws Exception",
    "function_body": "{\n        DefaultActionMapper mapper = new DefaultActionMapper();\n        String name = mapper.dropExtension(\"foo.action\");\n        assertTrue(\"Name not right: \"+name, \"foo\".equals(name));\n\n        name = mapper.dropExtension(\"foo.action.action\");\n        assertTrue(\"Name not right: \"+name, \"foo.action\".equals(name));\n\n    }"
  },
  {
    "id": 28,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 43,
    "human_patch": "https://github.com/apache/struts/commit/237432512df0e27013f7c7b9ab59fdce44ca34a5",
    "cve_id": "CVE-2016-4436",
    "cwe_id": "Not Mapping",
    "filename": "core/src/test/java/org/apache/struts2/dispatcher/mapper/DefaultActionMapperTest.java",
    "is_vulnerable": 0,
    "class_name": "DefaultActionMapperTest",
    "subclass_name": null,
    "function_name": "testDropExtensionWhenBlank() throws Exception",
    "function_body": "{\n        DefaultActionMapper mapper = new DefaultActionMapper();\n        mapper.setExtensions(\"action,,\");\n        String name = mapper.dropExtension(\"foo.action\");\n        assertTrue(\"Name not right: \"+name, \"foo\".equals(name));\n        name = mapper.dropExtension(\"foo\");\n        assertTrue(\"Name not right: \"+name, \"foo\".equals(name));\n        assertNull(mapper.dropExtension(\"foo.bar\"));\n        assertNull(mapper.dropExtension(\"foo.\"));\n    }"
  },
  {
    "id": 28,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 44,
    "human_patch": "https://github.com/apache/struts/commit/237432512df0e27013f7c7b9ab59fdce44ca34a5",
    "cve_id": "CVE-2016-4436",
    "cwe_id": "Not Mapping",
    "filename": "core/src/test/java/org/apache/struts2/dispatcher/mapper/DefaultActionMapperTest.java",
    "is_vulnerable": 0,
    "class_name": "DefaultActionMapperTest",
    "subclass_name": null,
    "function_name": "testDropExtensionEmbeddedDot() throws Exception",
    "function_body": "{\n        DefaultActionMapper mapper = new DefaultActionMapper();\n        mapper.setExtensions(\"action,,\");\n\n        String name = mapper.dropExtension(\"/foo/bar-1.0/baz.action\");\n        assertTrue(\"Name not right: \"+name, \"/foo/bar-1.0/baz\".equals(name));\n\n        name = mapper.dropExtension(\"/foo/bar-1.0/baz\");\n        assertTrue(\"Name not right: \"+name, \"/foo/bar-1.0/baz\".equals(name));\n    }"
  },
  {
    "id": 28,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 45,
    "human_patch": "https://github.com/apache/struts/commit/237432512df0e27013f7c7b9ab59fdce44ca34a5",
    "cve_id": "CVE-2016-4436",
    "cwe_id": "Not Mapping",
    "filename": "core/src/test/java/org/apache/struts2/dispatcher/mapper/DefaultActionMapperTest.java",
    "is_vulnerable": 0,
    "class_name": "DefaultActionMapperTest",
    "subclass_name": null,
    "function_name": "testGetUriFromActionMapper1() throws Exception",
    "function_body": "{\n        DefaultActionMapper mapper = new DefaultActionMapper();\n        ActionMapping actionMapping = new ActionMapping();\n        actionMapping.setMethod(\"myMethod\");\n        actionMapping.setName(\"myActionName\");\n        actionMapping.setNamespace(\"/myNamespace\");\n        String uri = mapper.getUriFromActionMapping(actionMapping);\n\n        assertEquals(\"/myNamespace/myActionName!myMethod.action\", uri);\n    }"
  },
  {
    "id": 28,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 46,
    "human_patch": "https://github.com/apache/struts/commit/237432512df0e27013f7c7b9ab59fdce44ca34a5",
    "cve_id": "CVE-2016-4436",
    "cwe_id": "Not Mapping",
    "filename": "core/src/test/java/org/apache/struts2/dispatcher/mapper/DefaultActionMapperTest.java",
    "is_vulnerable": 0,
    "class_name": "DefaultActionMapperTest",
    "subclass_name": null,
    "function_name": "testGetUriFromActionMapper2() throws Exception",
    "function_body": "{\n        DefaultActionMapper mapper = new DefaultActionMapper();\n        ActionMapping actionMapping = new ActionMapping();\n        actionMapping.setMethod(\"myMethod\");\n        actionMapping.setName(\"myActionName\");\n        actionMapping.setNamespace(\"/\");\n        String uri = mapper.getUriFromActionMapping(actionMapping);\n\n        assertEquals(\"/myActionName!myMethod.action\", uri);\n    }"
  },
  {
    "id": 28,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 47,
    "human_patch": "https://github.com/apache/struts/commit/237432512df0e27013f7c7b9ab59fdce44ca34a5",
    "cve_id": "CVE-2016-4436",
    "cwe_id": "Not Mapping",
    "filename": "core/src/test/java/org/apache/struts2/dispatcher/mapper/DefaultActionMapperTest.java",
    "is_vulnerable": 0,
    "class_name": "DefaultActionMapperTest",
    "subclass_name": null,
    "function_name": "testGetUriFromActionMapper3() throws Exception",
    "function_body": "{\n        DefaultActionMapper mapper = new DefaultActionMapper();\n        ActionMapping actionMapping = new ActionMapping();\n        actionMapping.setMethod(\"myMethod\");\n        actionMapping.setName(\"myActionName\");\n        actionMapping.setNamespace(\"\");\n        String uri = mapper.getUriFromActionMapping(actionMapping);\n\n        assertEquals(\"/myActionName!myMethod.action\", uri);\n    }"
  },
  {
    "id": 28,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 48,
    "human_patch": "https://github.com/apache/struts/commit/237432512df0e27013f7c7b9ab59fdce44ca34a5",
    "cve_id": "CVE-2016-4436",
    "cwe_id": "Not Mapping",
    "filename": "core/src/test/java/org/apache/struts2/dispatcher/mapper/DefaultActionMapperTest.java",
    "is_vulnerable": 0,
    "class_name": "DefaultActionMapperTest",
    "subclass_name": null,
    "function_name": "testGetUriFromActionMapper4() throws Exception",
    "function_body": "{\n        DefaultActionMapper mapper = new DefaultActionMapper();\n        ActionMapping actionMapping = new ActionMapping();\n        actionMapping.setName(\"myActionName\");\n        actionMapping.setNamespace(\"\");\n        String uri = mapper.getUriFromActionMapping(actionMapping);\n\n        assertEquals(\"/myActionName.action\", uri);\n    }"
  },
  {
    "id": 28,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 49,
    "human_patch": "https://github.com/apache/struts/commit/237432512df0e27013f7c7b9ab59fdce44ca34a5",
    "cve_id": "CVE-2016-4436",
    "cwe_id": "Not Mapping",
    "filename": "core/src/test/java/org/apache/struts2/dispatcher/mapper/DefaultActionMapperTest.java",
    "is_vulnerable": 0,
    "class_name": "DefaultActionMapperTest",
    "subclass_name": null,
    "function_name": "testGetUriFromActionMapper5() throws Exception",
    "function_body": "{\n        DefaultActionMapper mapper = new DefaultActionMapper();\n        ActionMapping actionMapping = new ActionMapping();\n        actionMapping.setName(\"myActionName\");\n        actionMapping.setNamespace(\"/\");\n        String uri = mapper.getUriFromActionMapping(actionMapping);\n\n        assertEquals(\"/myActionName.action\", uri);\n    }"
  },
  {
    "id": 28,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 50,
    "human_patch": "https://github.com/apache/struts/commit/237432512df0e27013f7c7b9ab59fdce44ca34a5",
    "cve_id": "CVE-2016-4436",
    "cwe_id": "Not Mapping",
    "filename": "core/src/test/java/org/apache/struts2/dispatcher/mapper/DefaultActionMapperTest.java",
    "is_vulnerable": 0,
    "class_name": "DefaultActionMapperTest",
    "subclass_name": null,
    "function_name": "testGetUriFromActionMapper6() throws Exception",
    "function_body": "{\n        DefaultActionMapper mapper = new DefaultActionMapper();\n        ActionMapping actionMapping = new ActionMapping();\n        actionMapping.setMethod(\"myMethod\");\n        actionMapping.setName(\"myActionName?test=bla\");\n        actionMapping.setNamespace(\"/myNamespace\");\n        String uri = mapper.getUriFromActionMapping(actionMapping);\n\n        assertEquals(\"/myNamespace/myActionName!myMethod.action?test=bla\", uri);\n    }"
  },
  {
    "id": 28,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 51,
    "human_patch": "https://github.com/apache/struts/commit/237432512df0e27013f7c7b9ab59fdce44ca34a5",
    "cve_id": "CVE-2016-4436",
    "cwe_id": "Not Mapping",
    "filename": "core/src/test/java/org/apache/struts2/dispatcher/mapper/DefaultActionMapperTest.java",
    "is_vulnerable": 0,
    "class_name": "DefaultActionMapperTest",
    "subclass_name": null,
    "function_name": "testGetUriFromActionMapper7() throws Exception",
    "function_body": "{\n        DefaultActionMapper mapper = new DefaultActionMapper();\n        ActionMapping actionMapping = new ActionMapping();\n        actionMapping.setMethod(\"myMethod\");\n        actionMapping.setName(\"myActionName?test=bla\");\n        actionMapping.setNamespace(\"/\");\n        String uri = mapper.getUriFromActionMapping(actionMapping);\n\n        assertEquals(\"/myActionName!myMethod.action?test=bla\", uri);\n    }"
  },
  {
    "id": 28,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 52,
    "human_patch": "https://github.com/apache/struts/commit/237432512df0e27013f7c7b9ab59fdce44ca34a5",
    "cve_id": "CVE-2016-4436",
    "cwe_id": "Not Mapping",
    "filename": "core/src/test/java/org/apache/struts2/dispatcher/mapper/DefaultActionMapperTest.java",
    "is_vulnerable": 0,
    "class_name": "DefaultActionMapperTest",
    "subclass_name": null,
    "function_name": "testGetUriFromActionMapper8() throws Exception",
    "function_body": "{\n        DefaultActionMapper mapper = new DefaultActionMapper();\n        ActionMapping actionMapping = new ActionMapping();\n        actionMapping.setMethod(\"myMethod\");\n        actionMapping.setName(\"myActionName?test=bla\");\n        actionMapping.setNamespace(\"\");\n        String uri = mapper.getUriFromActionMapping(actionMapping);\n\n        assertEquals(\"/myActionName!myMethod.action?test=bla\", uri);\n    }"
  },
  {
    "id": 28,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 53,
    "human_patch": "https://github.com/apache/struts/commit/237432512df0e27013f7c7b9ab59fdce44ca34a5",
    "cve_id": "CVE-2016-4436",
    "cwe_id": "Not Mapping",
    "filename": "core/src/test/java/org/apache/struts2/dispatcher/mapper/DefaultActionMapperTest.java",
    "is_vulnerable": 0,
    "class_name": "DefaultActionMapperTest",
    "subclass_name": null,
    "function_name": "testGetUriFromActionMapper9() throws Exception",
    "function_body": "{\n        DefaultActionMapper mapper = new DefaultActionMapper();\n        ActionMapping actionMapping = new ActionMapping();\n        actionMapping.setName(\"myActionName?test=bla\");\n        actionMapping.setNamespace(\"\");\n        String uri = mapper.getUriFromActionMapping(actionMapping);\n\n        assertEquals(\"/myActionName.action?test=bla\", uri);\n    }"
  },
  {
    "id": 28,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 54,
    "human_patch": "https://github.com/apache/struts/commit/237432512df0e27013f7c7b9ab59fdce44ca34a5",
    "cve_id": "CVE-2016-4436",
    "cwe_id": "Not Mapping",
    "filename": "core/src/test/java/org/apache/struts2/dispatcher/mapper/DefaultActionMapperTest.java",
    "is_vulnerable": 0,
    "class_name": "DefaultActionMapperTest",
    "subclass_name": null,
    "function_name": "testGetUriFromActionMapper10() throws Exception",
    "function_body": "{\n        DefaultActionMapper mapper = new DefaultActionMapper();\n        ActionMapping actionMapping = new ActionMapping();\n        actionMapping.setName(\"myActionName?test=bla\");\n        actionMapping.setNamespace(\"/\");\n        String uri = mapper.getUriFromActionMapping(actionMapping);\n\n        assertEquals(\"/myActionName.action?test=bla\", uri);\n    }"
  },
  {
    "id": 28,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 55,
    "human_patch": "https://github.com/apache/struts/commit/237432512df0e27013f7c7b9ab59fdce44ca34a5",
    "cve_id": "CVE-2016-4436",
    "cwe_id": "Not Mapping",
    "filename": "core/src/test/java/org/apache/struts2/dispatcher/mapper/DefaultActionMapperTest.java",
    "is_vulnerable": 0,
    "class_name": "DefaultActionMapperTest",
    "subclass_name": null,
    "function_name": "testGetUriFromActionMapper11() throws Exception",
    "function_body": "{\n        DefaultActionMapper mapper = new DefaultActionMapper();\n        ActionMapping actionMapping = new ActionMapping();\n        actionMapping.setName(\"myActionName.action\");\n        actionMapping.setNamespace(\"/\");\n        String uri = mapper.getUriFromActionMapping(actionMapping);\n\n        assertEquals(\"/myActionName.action\", uri);\n    }"
  },
  {
    "id": 28,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 56,
    "human_patch": "https://github.com/apache/struts/commit/237432512df0e27013f7c7b9ab59fdce44ca34a5",
    "cve_id": "CVE-2016-4436",
    "cwe_id": "Not Mapping",
    "filename": "core/src/test/java/org/apache/struts2/dispatcher/mapper/DefaultActionMapperTest.java",
    "is_vulnerable": 0,
    "class_name": "DefaultActionMapperTest",
    "subclass_name": null,
    "function_name": "testGetUriFromActionMapper12() throws Exception",
    "function_body": "{\n        DefaultActionMapper mapper = new DefaultActionMapper();\n        ActionMapping actionMapping = new ActionMapping();\n        actionMapping.setName(\"myActionName.action\");\n        actionMapping.setNamespace(\"/\");\n        String uri = mapper.getUriFromActionMapping(actionMapping);\n\n        assertEquals(\"/myActionName.action\", uri);\n    }"
  },
  {
    "id": 28,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 57,
    "human_patch": "https://github.com/apache/struts/commit/237432512df0e27013f7c7b9ab59fdce44ca34a5",
    "cve_id": "CVE-2016-4436",
    "cwe_id": "Not Mapping",
    "filename": "core/src/test/java/org/apache/struts2/dispatcher/mapper/DefaultActionMapperTest.java",
    "is_vulnerable": 0,
    "class_name": "DefaultActionMapperTest",
    "subclass_name": null,
    "function_name": "testGetUriFromActionMapper_justActionAndMethod() throws Exception",
    "function_body": "{\n        DefaultActionMapper mapper = new DefaultActionMapper();\n        ActionMapping actionMapping = new ActionMapping();\n        actionMapping.setMethod(\"myMethod\");\n        actionMapping.setName(\"myActionName\");\n        actionMapping.setExtension(\"\");\n        String uri = mapper.getUriFromActionMapping(actionMapping);\n\n        assertEquals(\"myActionName!myMethod\", uri);\n    }"
  },
  {
    "id": 28,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 58,
    "human_patch": "https://github.com/apache/struts/commit/237432512df0e27013f7c7b9ab59fdce44ca34a5",
    "cve_id": "CVE-2016-4436",
    "cwe_id": "Not Mapping",
    "filename": "core/src/test/java/org/apache/struts2/dispatcher/mapper/DefaultActionMapperTest.java",
    "is_vulnerable": 0,
    "class_name": "DefaultActionMapperTest",
    "subclass_name": null,
    "function_name": "testGetUriFromActionMapperWhenBlankExtension() throws Exception",
    "function_body": "{\n        DefaultActionMapper mapper = new DefaultActionMapper();\n        mapper.setExtensions(\",,\");\n        ActionMapping actionMapping = new ActionMapping();\n        actionMapping.setMethod(\"myMethod\");\n        actionMapping.setName(\"myActionName\");\n        actionMapping.setNamespace(\"/myNamespace\");\n        String uri = mapper.getUriFromActionMapping(actionMapping);\n\n        assertEquals(\"/myNamespace/myActionName!myMethod\", uri);\n    }"
  },
  {
    "id": 28,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 59,
    "human_patch": "https://github.com/apache/struts/commit/237432512df0e27013f7c7b9ab59fdce44ca34a5",
    "cve_id": "CVE-2016-4436",
    "cwe_id": "Not Mapping",
    "filename": "core/src/test/java/org/apache/struts2/dispatcher/mapper/DefaultActionMapperTest.java",
    "is_vulnerable": 0,
    "class_name": "DefaultActionMapperTest",
    "subclass_name": null,
    "function_name": "testSetExtension() throws Exception",
    "function_body": "{\n        DefaultActionMapper mapper = new DefaultActionMapper();\n        mapper.setExtensions(\"\");\n        assertNull(mapper.extensions);\n        mapper.setExtensions(null);\n        assertNull(mapper.extensions);\n\n        mapper.setExtensions(\",xml\");\n        assertEquals(Arrays.asList(\"\", \"xml\"), mapper.extensions);\n\n        mapper.setExtensions(\"html,xml,\");\n        assertEquals(Arrays.asList(\"html\", \"xml\", \"\"), mapper.extensions);\n\n        mapper.setExtensions(\"html,,xml\");\n        assertEquals(Arrays.asList(\"html\", \"\", \"xml\"), mapper.extensions);\n\n        mapper.setExtensions(\"xml\");\n        assertEquals(Arrays.asList(\"xml\"), mapper.extensions);\n\n        mapper.setExtensions(\",\");\n        assertEquals(Arrays.asList(\"\"), mapper.extensions);\n\n\n    }"
  },
  {
    "id": 28,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 60,
    "human_patch": "https://github.com/apache/struts/commit/237432512df0e27013f7c7b9ab59fdce44ca34a5",
    "cve_id": "CVE-2016-4436",
    "cwe_id": "Not Mapping",
    "filename": "core/src/test/java/org/apache/struts2/dispatcher/mapper/DefaultActionMapperTest.java",
    "is_vulnerable": 1,
    "class_name": "DefaultActionMapperTest",
    "subclass_name": null,
    "function_name": "testAllowedActionNames() throws Exception",
    "function_body": "{\n        DefaultActionMapper mapper = new DefaultActionMapper();\n\n        String actionName = \"action\";\n        assertEquals(actionName, mapper.cleanupActionName(actionName));\n\n        actionName = \"${action}\";\n        assertEquals(\"action\", mapper.cleanupActionName(actionName));\n\n        actionName = \"${${%{action}}}\";\n        assertEquals(\"action\", mapper.cleanupActionName(actionName));\n\n        actionName = \"${#foo='action',#foo}\";\n        assertEquals(\"fooactionfoo\", mapper.cleanupActionName(actionName));\n\n        actionName = \"test-action\";\n        assertEquals(\"test-action\", mapper.cleanupActionName(actionName));\n\n        actionName = \"test_action\";\n        assertEquals(\"test_action\", mapper.cleanupActionName(actionName));\n\n        actionName = \"test!bar.action\";\n        assertEquals(\"test!bar.action\", mapper.cleanupActionName(actionName));\n    }"
  },
  {
    "id": 29,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 0,
    "human_patch": "https://github.com/apache/struts/commit/d832747d647df343ed07a58b1b5e540a05a4d51b",
    "cve_id": "CVE-2015-1831",
    "cwe_id": "Not Mapping",
    "filename": "core/src/test/java/org/apache/struts2/interceptor/CookieInterceptorTest.java",
    "is_vulnerable": 0,
    "class_name": "CookieInterceptorTest",
    "subclass_name": null,
    "function_name": "testIntercepDefault() throws Exception",
    "function_body": "{\n        MockHttpServletRequest request = new MockHttpServletRequest();\n        request.setCookies(new Cookie[] {\n                new Cookie(\"cookie1\", \"cookie1value\"),\n                new Cookie(\"cookie2\", \"cookie2value\"),\n                new Cookie(\"cookie3\", \"cookie3value\")\n            });\n        ServletActionContext.setRequest(request);\n\n        MockActionWithCookieAware action = new MockActionWithCookieAware();\n\n        ActionContext.getContext().getValueStack().push(action);\n\n        MockControl actionInvocationControl = MockControl.createControl(ActionInvocation.class);\n        ActionInvocation invocation = (ActionInvocation) actionInvocationControl.getMock();\n        actionInvocationControl.expectAndDefaultReturn(\n                                                       invocation.getAction(), action);\n        actionInvocationControl.expectAndDefaultReturn(\n                                                       invocation.invoke(), Action.SUCCESS);\n\n        actionInvocationControl.replay();\n\n        \n        CookieInterceptor interceptor = new CookieInterceptor();\n        interceptor.setExcludedPatternsChecker(new DefaultExcludedPatternsChecker());\n\n        interceptor.intercept(invocation);\n\n        assertTrue(action.getCookiesMap().isEmpty());\n        assertNull(action.getCookie1(), null);\n        assertNull(action.getCookie2(), null);\n        assertNull(action.getCookie3(), null);\n        assertNull(ActionContext.getContext().getValueStack().findValue(\"cookie1\"));\n        assertNull(ActionContext.getContext().getValueStack().findValue(\"cookie2\"));\n        assertNull(ActionContext.getContext().getValueStack().findValue(\"cookie3\"));\n    }"
  },
  {
    "id": 29,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 1,
    "human_patch": "https://github.com/apache/struts/commit/d832747d647df343ed07a58b1b5e540a05a4d51b",
    "cve_id": "CVE-2015-1831",
    "cwe_id": "Not Mapping",
    "filename": "core/src/test/java/org/apache/struts2/interceptor/CookieInterceptorTest.java",
    "is_vulnerable": 0,
    "class_name": "CookieInterceptorTest",
    "subclass_name": null,
    "function_name": "testInterceptAll1() throws Exception",
    "function_body": "{\n        MockHttpServletRequest request = new MockHttpServletRequest();\n        request.setCookies(new Cookie[] {\n                new Cookie(\"cookie1\", \"cookie1value\"),\n                new Cookie(\"cookie2\", \"cookie2value\"),\n                new Cookie(\"cookie3\", \"cookie3value\")\n            });\n        ServletActionContext.setRequest(request);\n\n        MockActionWithCookieAware action = new MockActionWithCookieAware();\n\n        ActionContext.getContext().getValueStack().push(action);\n\n        MockControl actionInvocationControl = MockControl.createControl(ActionInvocation.class);\n        ActionInvocation invocation = (ActionInvocation) actionInvocationControl.getMock();\n        actionInvocationControl.expectAndDefaultReturn(\n                                                       invocation.getAction(), action);\n        actionInvocationControl.expectAndDefaultReturn(\n                                                       invocation.invoke(), Action.SUCCESS);\n\n        actionInvocationControl.replay();\n\n        CookieInterceptor interceptor = new CookieInterceptor();\n        interceptor.setExcludedPatternsChecker(new DefaultExcludedPatternsChecker());\n        interceptor.setCookiesName(\"*\");\n        interceptor.setCookiesValue(\"*\");\n        interceptor.intercept(invocation);\n\n        assertFalse(action.getCookiesMap().isEmpty());\n        assertEquals(action.getCookiesMap().size(), 3);\n        assertEquals(action.getCookiesMap().get(\"cookie1\"), \"cookie1value\");\n        assertEquals(action.getCookiesMap().get(\"cookie2\"), \"cookie2value\");\n        assertEquals(action.getCookiesMap().get(\"cookie3\"), \"cookie3value\");\n        assertEquals(action.getCookie1(), \"cookie1value\");\n        assertEquals(action.getCookie2(), \"cookie2value\");\n        assertEquals(action.getCookie3(), \"cookie3value\");\n        assertEquals(ActionContext.getContext().getValueStack().findValue(\"cookie1\"), \"cookie1value\");\n        assertEquals(ActionContext.getContext().getValueStack().findValue(\"cookie2\"), \"cookie2value\");\n        assertEquals(ActionContext.getContext().getValueStack().findValue(\"cookie3\"), \"cookie3value\");\n    }"
  },
  {
    "id": 29,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 2,
    "human_patch": "https://github.com/apache/struts/commit/d832747d647df343ed07a58b1b5e540a05a4d51b",
    "cve_id": "CVE-2015-1831",
    "cwe_id": "Not Mapping",
    "filename": "core/src/test/java/org/apache/struts2/interceptor/CookieInterceptorTest.java",
    "is_vulnerable": 0,
    "class_name": "CookieInterceptorTest",
    "subclass_name": null,
    "function_name": "testInterceptAll2() throws Exception",
    "function_body": "{\n        MockHttpServletRequest request = new MockHttpServletRequest();\n        request.setCookies(new Cookie[] {\n                new Cookie(\"cookie1\", \"cookie1value\"),\n                new Cookie(\"cookie2\", \"cookie2value\"),\n                new Cookie(\"cookie3\", \"cookie3value\")\n            });\n        ServletActionContext.setRequest(request);\n\n        MockActionWithCookieAware action = new MockActionWithCookieAware();\n\n        ActionContext.getContext().getValueStack().push(action);\n\n        MockControl actionInvocationControl = MockControl.createControl(ActionInvocation.class);\n        ActionInvocation invocation = (ActionInvocation) actionInvocationControl.getMock();\n        actionInvocationControl.expectAndDefaultReturn(\n                                                       invocation.getAction(), action);\n        actionInvocationControl.expectAndDefaultReturn(\n                                                       invocation.invoke(), Action.SUCCESS);\n\n        actionInvocationControl.replay();\n\n        CookieInterceptor interceptor = new CookieInterceptor();\n        interceptor.setExcludedPatternsChecker(new DefaultExcludedPatternsChecker());\n        interceptor.setCookiesName(\"cookie1, cookie2, cookie3\");\n        interceptor.setCookiesValue(\"cookie1value, cookie2value, cookie3value\");\n        interceptor.intercept(invocation);\n\n        assertFalse(action.getCookiesMap().isEmpty());\n        assertEquals(action.getCookiesMap().size(), 3);\n        assertEquals(action.getCookiesMap().get(\"cookie1\"), \"cookie1value\");\n        assertEquals(action.getCookiesMap().get(\"cookie2\"), \"cookie2value\");\n        assertEquals(action.getCookiesMap().get(\"cookie3\"), \"cookie3value\");\n        assertEquals(action.getCookie1(), \"cookie1value\");\n        assertEquals(action.getCookie2(), \"cookie2value\");\n        assertEquals(action.getCookie3(), \"cookie3value\");\n        assertEquals(ActionContext.getContext().getValueStack().findValue(\"cookie1\"), \"cookie1value\");\n        assertEquals(ActionContext.getContext().getValueStack().findValue(\"cookie2\"), \"cookie2value\");\n        assertEquals(ActionContext.getContext().getValueStack().findValue(\"cookie3\"), \"cookie3value\");\n    }"
  },
  {
    "id": 29,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 3,
    "human_patch": "https://github.com/apache/struts/commit/d832747d647df343ed07a58b1b5e540a05a4d51b",
    "cve_id": "CVE-2015-1831",
    "cwe_id": "Not Mapping",
    "filename": "core/src/test/java/org/apache/struts2/interceptor/CookieInterceptorTest.java",
    "is_vulnerable": 0,
    "class_name": "CookieInterceptorTest",
    "subclass_name": null,
    "function_name": "testInterceptSelectedCookiesNameOnly1() throws Exception",
    "function_body": "{\n        MockHttpServletRequest request = new MockHttpServletRequest();\n        request.setCookies(new Cookie[] {\n                new Cookie(\"cookie1\", \"cookie1value\"),\n                new Cookie(\"cookie2\", \"cookie2value\"),\n                new Cookie(\"cookie3\", \"cookie3value\")\n            });\n        ServletActionContext.setRequest(request);\n\n        MockActionWithCookieAware action = new MockActionWithCookieAware();\n\n        ActionContext.getContext().getValueStack().push(action);\n\n        MockControl actionInvocationControl = MockControl.createControl(ActionInvocation.class);\n        ActionInvocation invocation = (ActionInvocation) actionInvocationControl.getMock();\n        actionInvocationControl.expectAndDefaultReturn(\n                                                       invocation.getAction(), action);\n        actionInvocationControl.expectAndDefaultReturn(\n                                                       invocation.invoke(), Action.SUCCESS);\n\n        actionInvocationControl.replay();\n\n        CookieInterceptor interceptor = new CookieInterceptor();\n        interceptor.setExcludedPatternsChecker(new DefaultExcludedPatternsChecker());\n        interceptor.setCookiesName(\"cookie1, cookie3\");\n        interceptor.setCookiesValue(\"cookie1value, cookie2value, cookie3value\");\n        interceptor.intercept(invocation);\n\n        assertFalse(action.getCookiesMap().isEmpty());\n        assertEquals(action.getCookiesMap().size(), 2);\n        assertEquals(action.getCookiesMap().get(\"cookie1\"), \"cookie1value\");\n        assertEquals(action.getCookiesMap().get(\"cookie2\"), null);\n        assertEquals(action.getCookiesMap().get(\"cookie3\"), \"cookie3value\");\n        assertEquals(action.getCookie1(), \"cookie1value\");\n        assertEquals(action.getCookie2(), null);\n        assertEquals(action.getCookie3(), \"cookie3value\");\n        assertEquals(ActionContext.getContext().getValueStack().findValue(\"cookie1\"), \"cookie1value\");\n        assertEquals(ActionContext.getContext().getValueStack().findValue(\"cookie2\"), null);\n        assertEquals(ActionContext.getContext().getValueStack().findValue(\"cookie3\"), \"cookie3value\");\n    }"
  },
  {
    "id": 29,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 4,
    "human_patch": "https://github.com/apache/struts/commit/d832747d647df343ed07a58b1b5e540a05a4d51b",
    "cve_id": "CVE-2015-1831",
    "cwe_id": "Not Mapping",
    "filename": "core/src/test/java/org/apache/struts2/interceptor/CookieInterceptorTest.java",
    "is_vulnerable": 0,
    "class_name": "CookieInterceptorTest",
    "subclass_name": null,
    "function_name": "testInterceptSelectedCookiesNameOnly2() throws Exception",
    "function_body": "{\n        MockHttpServletRequest request = new MockHttpServletRequest();\n        request.setCookies(new Cookie[] {\n                new Cookie(\"cookie1\", \"cookie1value\"),\n                new Cookie(\"cookie2\", \"cookie2value\"),\n                new Cookie(\"cookie3\", \"cookie3value\")\n            });\n        ServletActionContext.setRequest(request);\n\n        MockActionWithCookieAware action = new MockActionWithCookieAware();\n\n        ActionContext.getContext().getValueStack().push(action);\n\n        MockControl actionInvocationControl = MockControl.createControl(ActionInvocation.class);\n        ActionInvocation invocation = (ActionInvocation) actionInvocationControl.getMock();\n        actionInvocationControl.expectAndDefaultReturn(\n                                                       invocation.getAction(), action);\n        actionInvocationControl.expectAndDefaultReturn(\n                                                       invocation.invoke(), Action.SUCCESS);\n\n        actionInvocationControl.replay();\n\n        CookieInterceptor interceptor = new CookieInterceptor();\n        interceptor.setExcludedPatternsChecker(new DefaultExcludedPatternsChecker());\n        interceptor.setCookiesName(\"cookie1, cookie3\");\n        interceptor.setCookiesValue(\"*\");\n        interceptor.intercept(invocation);\n\n        assertFalse(action.getCookiesMap().isEmpty());\n        assertEquals(action.getCookiesMap().size(), 2);\n        assertEquals(action.getCookiesMap().get(\"cookie1\"), \"cookie1value\");\n        assertEquals(action.getCookiesMap().get(\"cookie2\"), null);\n        assertEquals(action.getCookiesMap().get(\"cookie3\"), \"cookie3value\");\n        assertEquals(action.getCookie1(), \"cookie1value\");\n        assertEquals(action.getCookie2(), null);\n        assertEquals(action.getCookie3(), \"cookie3value\");\n        assertEquals(ActionContext.getContext().getValueStack().findValue(\"cookie1\"), \"cookie1value\");\n        assertEquals(ActionContext.getContext().getValueStack().findValue(\"cookie2\"), null);\n        assertEquals(ActionContext.getContext().getValueStack().findValue(\"cookie3\"), \"cookie3value\");\n    }"
  },
  {
    "id": 29,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 5,
    "human_patch": "https://github.com/apache/struts/commit/d832747d647df343ed07a58b1b5e540a05a4d51b",
    "cve_id": "CVE-2015-1831",
    "cwe_id": "Not Mapping",
    "filename": "core/src/test/java/org/apache/struts2/interceptor/CookieInterceptorTest.java",
    "is_vulnerable": 0,
    "class_name": "CookieInterceptorTest",
    "subclass_name": null,
    "function_name": "testInterceptSelectedCookiesNameOnly3() throws Exception",
    "function_body": "{\n        MockHttpServletRequest request = new MockHttpServletRequest();\n        request.setCookies(new Cookie[] {\n                new Cookie(\"cookie1\", \"cookie1value\"),\n                new Cookie(\"cookie2\", \"cookie2value\"),\n                new Cookie(\"cookie3\", \"cookie3value\")\n            });\n        ServletActionContext.setRequest(request);\n\n        MockActionWithCookieAware action = new MockActionWithCookieAware();\n\n        ActionContext.getContext().getValueStack().push(action);\n\n        MockControl actionInvocationControl = MockControl.createControl(ActionInvocation.class);\n        ActionInvocation invocation = (ActionInvocation) actionInvocationControl.getMock();\n        actionInvocationControl.expectAndDefaultReturn(\n                                                       invocation.getAction(), action);\n        actionInvocationControl.expectAndDefaultReturn(\n                                                       invocation.invoke(), Action.SUCCESS);\n\n        actionInvocationControl.replay();\n\n        CookieInterceptor interceptor = new CookieInterceptor();\n        interceptor.setExcludedPatternsChecker(new DefaultExcludedPatternsChecker());\n        interceptor.setCookiesName(\"cookie1, cookie3\");\n        interceptor.setCookiesValue(\"\");\n        interceptor.intercept(invocation);\n\n        assertFalse(action.getCookiesMap().isEmpty());\n        assertEquals(action.getCookiesMap().size(), 2);\n        assertEquals(action.getCookiesMap().get(\"cookie1\"), \"cookie1value\");\n        assertEquals(action.getCookiesMap().get(\"cookie2\"), null);\n        assertEquals(action.getCookiesMap().get(\"cookie3\"), \"cookie3value\");\n        assertEquals(action.getCookie1(), \"cookie1value\");\n        assertEquals(action.getCookie2(), null);\n        assertEquals(action.getCookie3(), \"cookie3value\");\n        assertEquals(ActionContext.getContext().getValueStack().findValue(\"cookie1\"), \"cookie1value\");\n        assertEquals(ActionContext.getContext().getValueStack().findValue(\"cookie2\"), null);\n        assertEquals(ActionContext.getContext().getValueStack().findValue(\"cookie3\"), \"cookie3value\");\n    }"
  },
  {
    "id": 29,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 6,
    "human_patch": "https://github.com/apache/struts/commit/d832747d647df343ed07a58b1b5e540a05a4d51b",
    "cve_id": "CVE-2015-1831",
    "cwe_id": "Not Mapping",
    "filename": "core/src/test/java/org/apache/struts2/interceptor/CookieInterceptorTest.java",
    "is_vulnerable": 0,
    "class_name": "CookieInterceptorTest",
    "subclass_name": null,
    "function_name": "testInterceptSelectedCookiesNameAndValue() throws Exception",
    "function_body": "{\n        MockHttpServletRequest request = new MockHttpServletRequest();\n        request.setCookies(new Cookie[] {\n                new Cookie(\"cookie1\", \"cookie1value\"),\n                new Cookie(\"cookie2\", \"cookie2value\"),\n                new Cookie(\"cookie3\", \"cookie3value\")\n            });\n        ServletActionContext.setRequest(request);\n\n        MockActionWithCookieAware action = new MockActionWithCookieAware();\n\n        ActionContext.getContext().getValueStack().push(action);\n\n        MockControl actionInvocationControl = MockControl.createControl(ActionInvocation.class);\n        ActionInvocation invocation = (ActionInvocation) actionInvocationControl.getMock();\n        actionInvocationControl.expectAndDefaultReturn(\n                                                       invocation.getAction(), action);\n        actionInvocationControl.expectAndDefaultReturn(\n                                                       invocation.invoke(), Action.SUCCESS);\n\n        actionInvocationControl.replay();\n\n        CookieInterceptor interceptor = new CookieInterceptor();\n        interceptor.setExcludedPatternsChecker(new DefaultExcludedPatternsChecker());\n        interceptor.setCookiesName(\"cookie1, cookie3\");\n        interceptor.setCookiesValue(\"cookie1value\");\n        interceptor.intercept(invocation);\n\n        assertFalse(action.getCookiesMap().isEmpty());\n        assertEquals(action.getCookiesMap().size(), 1);\n        assertEquals(action.getCookiesMap().get(\"cookie1\"), \"cookie1value\");\n        assertEquals(action.getCookiesMap().get(\"cookie2\"), null);\n        assertEquals(action.getCookiesMap().get(\"cookie3\"), null);\n        assertEquals(action.getCookie1(), \"cookie1value\");\n        assertEquals(action.getCookie2(), null);\n        assertEquals(action.getCookie3(), null);\n        assertEquals(ActionContext.getContext().getValueStack().findValue(\"cookie1\"), \"cookie1value\");\n        assertEquals(ActionContext.getContext().getValueStack().findValue(\"cookie2\"), null);\n        assertEquals(ActionContext.getContext().getValueStack().findValue(\"cookie3\"), null);\n    }"
  },
  {
    "id": 29,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 7,
    "human_patch": "https://github.com/apache/struts/commit/d832747d647df343ed07a58b1b5e540a05a4d51b",
    "cve_id": "CVE-2015-1831",
    "cwe_id": "Not Mapping",
    "filename": "core/src/test/java/org/apache/struts2/interceptor/CookieInterceptorTest.java",
    "is_vulnerable": 1,
    "class_name": "CookieInterceptorTest",
    "subclass_name": null,
    "function_name": "testCookiesWithClassPollution() throws Exception",
    "function_body": "{\n        MockHttpServletRequest request = new MockHttpServletRequest();\n        String pollution1 = \"model['class']['classLoader']['jarPath']\";\n        String pollution2 = \"model.class.classLoader.jarPath\";\n        String pollution3 = \"class.classLoader.jarPath\";\n        String pollution4 = \"class['classLoader']['jarPath']\";\n        String pollution5 = \"model[\\\"class\\\"]['classLoader']['jarPath']\";\n        String pollution6 = \"class[\\\"classLoader\\\"]['jarPath']\";\n\n        request.setCookies(\n                new Cookie(pollution1, \"pollution1\"),\n                new Cookie(\"pollution1\", pollution1),\n                new Cookie(pollution2, \"pollution2\"),\n                new Cookie(\"pollution2\", pollution2),\n                new Cookie(pollution3, \"pollution3\"),\n                new Cookie(\"pollution3\", pollution3),\n                new Cookie(pollution4, \"pollution4\"),\n                new Cookie(\"pollution4\", pollution4),\n                new Cookie(pollution5, \"pollution5\"),\n                new Cookie(\"pollution5\", pollution5),\n                new Cookie(pollution6, \"pollution6\"),\n                new Cookie(\"pollution6\", pollution6)\n            );\n        ServletActionContext.setRequest(request);\n\n        final Map<String, Boolean> excludedName = new HashMap<String, Boolean>();\n        final Map<String, Boolean> excludedValue = new HashMap<String, Boolean>();\n\n        CookieInterceptor interceptor = new CookieInterceptor() {\n            @Override\n            protected boolean isAcceptableName(String name) {\n                boolean accepted = super.isAcceptableName(name);\n                excludedName.put(name, accepted);\n                return accepted;\n            }\n\n            @Override\n            protected boolean isAcceptableValue(String value) {\n                boolean accepted = super.isAcceptableValue(value);\n                excludedValue.put(value, accepted);\n                return accepted;\n            }\n        };\n        interceptor.setExcludedPatternsChecker(new DefaultExcludedPatternsChecker());\n        interceptor.setCookiesName(\"*\");\n\n        MockActionInvocation invocation = new MockActionInvocation();\n        invocation.setAction(new MockActionWithCookieAware());\n\n        interceptor.intercept(invocation);\n\n        assertFalse(excludedName.get(pollution1));\n        assertFalse(excludedName.get(pollution2));\n        assertFalse(excludedName.get(pollution3));\n        assertFalse(excludedName.get(pollution4));\n        assertFalse(excludedName.get(pollution5));\n        assertFalse(excludedName.get(pollution6));\n\n        assertFalse(excludedValue.get(pollution1));\n        assertFalse(excludedValue.get(pollution2));\n        assertFalse(excludedValue.get(pollution3));\n        assertFalse(excludedValue.get(pollution4));\n        assertFalse(excludedValue.get(pollution5));\n        assertFalse(excludedValue.get(pollution6));\n    }"
  },
  {
    "id": 29,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 8,
    "human_patch": "https://github.com/apache/struts/commit/d832747d647df343ed07a58b1b5e540a05a4d51b",
    "cve_id": "CVE-2015-1831",
    "cwe_id": "Not Mapping",
    "filename": "core/src/test/java/org/apache/struts2/interceptor/CookieInterceptorTest.java",
    "is_vulnerable": 0,
    "class_name": "CookieInterceptorTest",
    "subclass_name": null,
    "function_name": "isAcceptableName(String name)",
    "function_body": "{\n                boolean accepted = super.isAcceptableName(name);\n                excludedName.put(name, accepted);\n                return accepted;\n            }"
  },
  {
    "id": 29,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 9,
    "human_patch": "https://github.com/apache/struts/commit/d832747d647df343ed07a58b1b5e540a05a4d51b",
    "cve_id": "CVE-2015-1831",
    "cwe_id": "Not Mapping",
    "filename": "core/src/test/java/org/apache/struts2/interceptor/CookieInterceptorTest.java",
    "is_vulnerable": 0,
    "class_name": "CookieInterceptorTest",
    "subclass_name": null,
    "function_name": "isAcceptableValue(String value)",
    "function_body": "{\n                boolean accepted = super.isAcceptableValue(value);\n                excludedValue.put(value, accepted);\n                return accepted;\n            }"
  },
  {
    "id": 29,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 10,
    "human_patch": "https://github.com/apache/struts/commit/d832747d647df343ed07a58b1b5e540a05a4d51b",
    "cve_id": "CVE-2015-1831",
    "cwe_id": "Not Mapping",
    "filename": "core/src/test/java/org/apache/struts2/interceptor/CookieInterceptorTest.java",
    "is_vulnerable": 0,
    "class_name": "CookieInterceptorTest",
    "subclass_name": null,
    "function_name": "testCookiesWithStrutsInternalsAccess() throws Exception",
    "function_body": "{\n        MockHttpServletRequest request = new MockHttpServletRequest();\n        String sessionCookieName = \"session.userId\";\n        String sessionCookieValue = \"session.userId=1\";\n        String appCookieName = \"application.userId\";\n        String appCookieValue = \"application.userId=1\";\n        String reqCookieName = \"request.userId\";\n        String reqCookieValue = \"request.userId=1\";\n\n        request.setCookies(\n                new Cookie(sessionCookieName, \"1\"),\n                new Cookie(\"1\", sessionCookieValue),\n                new Cookie(appCookieName, \"1\"),\n                new Cookie(\"1\", appCookieValue),\n                new Cookie(reqCookieName, \"1\"),\n                new Cookie(\"1\", reqCookieValue)\n            );\n        ServletActionContext.setRequest(request);\n\n        final Map<String, Boolean> excludedName = new HashMap<String, Boolean>();\n        final Map<String, Boolean> excludedValue = new HashMap<String, Boolean>();\n\n        CookieInterceptor interceptor = new CookieInterceptor() {\n            @Override\n            protected boolean isAcceptableName(String name) {\n                boolean accepted = super.isAcceptableName(name);\n                excludedName.put(name, accepted);\n                return accepted;\n            }\n\n            @Override\n            protected boolean isAcceptableValue(String value) {\n                boolean accepted = super.isAcceptableValue(value);\n                excludedValue.put(value, accepted);\n                return accepted;\n            }\n        };\n        interceptor.setExcludedPatternsChecker(new DefaultExcludedPatternsChecker());\n        interceptor.setCookiesName(\"*\");\n\n        MockActionInvocation invocation = new MockActionInvocation();\n        invocation.setAction(new MockActionWithCookieAware());\n\n        interceptor.intercept(invocation);\n\n        assertFalse(excludedName.get(sessionCookieName));\n        assertFalse(excludedName.get(appCookieName));\n        assertFalse(excludedName.get(reqCookieName));\n\n        assertFalse(excludedValue.get(sessionCookieValue));\n        assertFalse(excludedValue.get(appCookieValue));\n        assertFalse(excludedValue.get(reqCookieValue));\n    }"
  },
  {
    "id": 29,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 11,
    "human_patch": "https://github.com/apache/struts/commit/d832747d647df343ed07a58b1b5e540a05a4d51b",
    "cve_id": "CVE-2015-1831",
    "cwe_id": "Not Mapping",
    "filename": "core/src/test/java/org/apache/struts2/interceptor/CookieInterceptorTest.java",
    "is_vulnerable": 0,
    "class_name": "CookieInterceptorTest",
    "subclass_name": null,
    "function_name": "isAcceptableName(String name)",
    "function_body": "{\n                boolean accepted = super.isAcceptableName(name);\n                excludedName.put(name, accepted);\n                return accepted;\n            }"
  },
  {
    "id": 29,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 12,
    "human_patch": "https://github.com/apache/struts/commit/d832747d647df343ed07a58b1b5e540a05a4d51b",
    "cve_id": "CVE-2015-1831",
    "cwe_id": "Not Mapping",
    "filename": "core/src/test/java/org/apache/struts2/interceptor/CookieInterceptorTest.java",
    "is_vulnerable": 0,
    "class_name": "CookieInterceptorTest",
    "subclass_name": null,
    "function_name": "isAcceptableValue(String value)",
    "function_body": "{\n                boolean accepted = super.isAcceptableValue(value);\n                excludedValue.put(value, accepted);\n                return accepted;\n            }"
  },
  {
    "id": 29,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 13,
    "human_patch": "https://github.com/apache/struts/commit/d832747d647df343ed07a58b1b5e540a05a4d51b",
    "cve_id": "CVE-2015-1831",
    "cwe_id": "Not Mapping",
    "filename": "core/src/test/java/org/apache/struts2/interceptor/CookieInterceptorTest.java",
    "is_vulnerable": 0,
    "class_name": "CookieInterceptorTest",
    "subclass_name": "MockActionWithCookieAware",
    "function_name": "setCookiesMap(Map<String, String> cookies)",
    "function_body": "{\n            this.cookies = cookies;\n        }"
  },
  {
    "id": 29,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 14,
    "human_patch": "https://github.com/apache/struts/commit/d832747d647df343ed07a58b1b5e540a05a4d51b",
    "cve_id": "CVE-2015-1831",
    "cwe_id": "Not Mapping",
    "filename": "core/src/test/java/org/apache/struts2/interceptor/CookieInterceptorTest.java",
    "is_vulnerable": 0,
    "class_name": "CookieInterceptorTest",
    "subclass_name": "MockActionWithCookieAware",
    "function_name": "getCookiesMap()",
    "function_body": "{\n            return this.cookies;\n        }"
  },
  {
    "id": 29,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 15,
    "human_patch": "https://github.com/apache/struts/commit/d832747d647df343ed07a58b1b5e540a05a4d51b",
    "cve_id": "CVE-2015-1831",
    "cwe_id": "Not Mapping",
    "filename": "core/src/test/java/org/apache/struts2/interceptor/CookieInterceptorTest.java",
    "is_vulnerable": 0,
    "class_name": "CookieInterceptorTest",
    "subclass_name": "MockActionWithCookieAware",
    "function_name": "getCookie1()",
    "function_body": "{ return cookie1; }"
  },
  {
    "id": 29,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 16,
    "human_patch": "https://github.com/apache/struts/commit/d832747d647df343ed07a58b1b5e540a05a4d51b",
    "cve_id": "CVE-2015-1831",
    "cwe_id": "Not Mapping",
    "filename": "core/src/test/java/org/apache/struts2/interceptor/CookieInterceptorTest.java",
    "is_vulnerable": 0,
    "class_name": "CookieInterceptorTest",
    "subclass_name": "MockActionWithCookieAware",
    "function_name": "setCookie1(String cookie1)",
    "function_body": "{ this.cookie1 = cookie1; }"
  },
  {
    "id": 29,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 17,
    "human_patch": "https://github.com/apache/struts/commit/d832747d647df343ed07a58b1b5e540a05a4d51b",
    "cve_id": "CVE-2015-1831",
    "cwe_id": "Not Mapping",
    "filename": "core/src/test/java/org/apache/struts2/interceptor/CookieInterceptorTest.java",
    "is_vulnerable": 0,
    "class_name": "CookieInterceptorTest",
    "subclass_name": "MockActionWithCookieAware",
    "function_name": "getCookie2()",
    "function_body": "{ return cookie2; }"
  },
  {
    "id": 29,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 18,
    "human_patch": "https://github.com/apache/struts/commit/d832747d647df343ed07a58b1b5e540a05a4d51b",
    "cve_id": "CVE-2015-1831",
    "cwe_id": "Not Mapping",
    "filename": "core/src/test/java/org/apache/struts2/interceptor/CookieInterceptorTest.java",
    "is_vulnerable": 0,
    "class_name": "CookieInterceptorTest",
    "subclass_name": "MockActionWithCookieAware",
    "function_name": "setCookie2(String cookie2)",
    "function_body": "{ this.cookie2 = cookie2; }"
  },
  {
    "id": 29,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 19,
    "human_patch": "https://github.com/apache/struts/commit/d832747d647df343ed07a58b1b5e540a05a4d51b",
    "cve_id": "CVE-2015-1831",
    "cwe_id": "Not Mapping",
    "filename": "core/src/test/java/org/apache/struts2/interceptor/CookieInterceptorTest.java",
    "is_vulnerable": 0,
    "class_name": "CookieInterceptorTest",
    "subclass_name": "MockActionWithCookieAware",
    "function_name": "getCookie3()",
    "function_body": "{ return cookie3; }"
  },
  {
    "id": 29,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 20,
    "human_patch": "https://github.com/apache/struts/commit/d832747d647df343ed07a58b1b5e540a05a4d51b",
    "cve_id": "CVE-2015-1831",
    "cwe_id": "Not Mapping",
    "filename": "core/src/test/java/org/apache/struts2/interceptor/CookieInterceptorTest.java",
    "is_vulnerable": 0,
    "class_name": "CookieInterceptorTest",
    "subclass_name": "MockActionWithCookieAware",
    "function_name": "setCookie3(String cookie3)",
    "function_body": "{ this.cookie3 = cookie3; }"
  },
  {
    "id": 29,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 0,
    "human_patch": "https://github.com/apache/struts/commit/d832747d647df343ed07a58b1b5e540a05a4d51b",
    "cve_id": "CVE-2015-1831",
    "cwe_id": "Not Mapping",
    "filename": "xwork-core/src/main/java/com/opensymphony/xwork2/security/DefaultExcludedPatternsChecker.java",
    "is_vulnerable": 0,
    "class_name": "DefaultExcludedPatternsChecker",
    "subclass_name": null,
    "function_name": "setOverrideExcludePatterns(String excludePatterns)",
    "function_body": "{\n        if (LOG.isWarnEnabled()) {\n            LOG.warn(\"Overriding excluded patterns [#0] with [#1], be aware that this affects all instances and safety of your application!\",\n                    XWorkConstants.OVERRIDE_EXCLUDED_PATTERNS, excludePatterns);\n        }\n        excludedPatterns = new HashSet<Pattern>();\n        for (String pattern : TextParseUtil.commaDelimitedStringToSet(excludePatterns)) {\n            excludedPatterns.add(Pattern.compile(pattern, Pattern.CASE_INSENSITIVE));\n        }\n    }"
  },
  {
    "id": 29,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 1,
    "human_patch": "https://github.com/apache/struts/commit/d832747d647df343ed07a58b1b5e540a05a4d51b",
    "cve_id": "CVE-2015-1831",
    "cwe_id": "Not Mapping",
    "filename": "xwork-core/src/main/java/com/opensymphony/xwork2/security/DefaultExcludedPatternsChecker.java",
    "is_vulnerable": 0,
    "class_name": "DefaultExcludedPatternsChecker",
    "subclass_name": null,
    "function_name": "setAdditionalExcludePatterns(String excludePatterns)",
    "function_body": "{\n        if (LOG.isDebugEnabled()) {\n            LOG.debug(\"Adding additional global patterns [#0] to excluded patterns!\", excludePatterns);\n        }\n        for (String pattern : TextParseUtil.commaDelimitedStringToSet(excludePatterns)) {\n            excludedPatterns.add(Pattern.compile(pattern, Pattern.CASE_INSENSITIVE));\n        }\n    }"
  },
  {
    "id": 29,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 2,
    "human_patch": "https://github.com/apache/struts/commit/d832747d647df343ed07a58b1b5e540a05a4d51b",
    "cve_id": "CVE-2015-1831",
    "cwe_id": "Not Mapping",
    "filename": "xwork-core/src/main/java/com/opensymphony/xwork2/security/DefaultExcludedPatternsChecker.java",
    "is_vulnerable": 0,
    "class_name": "DefaultExcludedPatternsChecker",
    "subclass_name": null,
    "function_name": "setExcludedPatterns(String commaDelimitedPatterns)",
    "function_body": "{\n        setExcludedPatterns(TextParseUtil.commaDelimitedStringToSet(commaDelimitedPatterns));\n    }"
  },
  {
    "id": 29,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 3,
    "human_patch": "https://github.com/apache/struts/commit/d832747d647df343ed07a58b1b5e540a05a4d51b",
    "cve_id": "CVE-2015-1831",
    "cwe_id": "Not Mapping",
    "filename": "xwork-core/src/main/java/com/opensymphony/xwork2/security/DefaultExcludedPatternsChecker.java",
    "is_vulnerable": 0,
    "class_name": "DefaultExcludedPatternsChecker",
    "subclass_name": null,
    "function_name": "setExcludedPatterns(String[] patterns)",
    "function_body": "{\n        setExcludedPatterns(new HashSet<String>(Arrays.asList(patterns)));\n    }"
  },
  {
    "id": 29,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 4,
    "human_patch": "https://github.com/apache/struts/commit/d832747d647df343ed07a58b1b5e540a05a4d51b",
    "cve_id": "CVE-2015-1831",
    "cwe_id": "Not Mapping",
    "filename": "xwork-core/src/main/java/com/opensymphony/xwork2/security/DefaultExcludedPatternsChecker.java",
    "is_vulnerable": 0,
    "class_name": "DefaultExcludedPatternsChecker",
    "subclass_name": null,
    "function_name": "setExcludedPatterns(Set<String> patterns)",
    "function_body": "{\n        if (LOG.isTraceEnabled()) {\n            LOG.trace(\"Sets excluded patterns [#0]\", patterns);\n        }\n        excludedPatterns = new HashSet<Pattern>(patterns.size());\n        for (String pattern : patterns) {\n            excludedPatterns.add(Pattern.compile(pattern, Pattern.CASE_INSENSITIVE));\n        }\n    }"
  },
  {
    "id": 29,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 5,
    "human_patch": "https://github.com/apache/struts/commit/d832747d647df343ed07a58b1b5e540a05a4d51b",
    "cve_id": "CVE-2015-1831",
    "cwe_id": "Not Mapping",
    "filename": "xwork-core/src/main/java/com/opensymphony/xwork2/security/DefaultExcludedPatternsChecker.java",
    "is_vulnerable": 0,
    "class_name": "DefaultExcludedPatternsChecker",
    "subclass_name": null,
    "function_name": "isExcluded(String value)",
    "function_body": "{\n        for (Pattern excludedPattern : excludedPatterns) {\n            if (excludedPattern.matcher(value).matches()) {\n                if (LOG.isTraceEnabled()) {\n                    LOG.trace(\"[#0] matches excluded pattern [#1]\", value, excludedPattern);\n                }\n                return IsExcluded.yes(excludedPattern);\n            }\n        }\n        return IsExcluded.no(excludedPatterns);\n    }"
  },
  {
    "id": 29,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 6,
    "human_patch": "https://github.com/apache/struts/commit/d832747d647df343ed07a58b1b5e540a05a4d51b",
    "cve_id": "CVE-2015-1831",
    "cwe_id": "Not Mapping",
    "filename": "xwork-core/src/main/java/com/opensymphony/xwork2/security/DefaultExcludedPatternsChecker.java",
    "is_vulnerable": 0,
    "class_name": "DefaultExcludedPatternsChecker",
    "subclass_name": null,
    "function_name": "getExcludedPatterns()",
    "function_body": "{\n        return excludedPatterns;\n    }"
  },
  {
    "id": 29,
    "sub_id": 2,
    "code_id": 0,
    "function_id": 0,
    "human_patch": "https://github.com/apache/struts/commit/d832747d647df343ed07a58b1b5e540a05a4d51b",
    "cve_id": "CVE-2015-1831",
    "cwe_id": "Not Mapping",
    "filename": "xwork-core/src/test/java/com/opensymphony/xwork2/security/DefaultExcludedPatternsCheckerTest.java",
    "is_vulnerable": 1,
    "class_name": "DefaultExcludedPatternsCheckerTest",
    "subclass_name": null,
    "function_name": "testHardcodedPatterns() throws Exception",
    "function_body": "{\n        \n        List<String> params = new ArrayList<String>() {\n            {\n                add(\"%{#application['test']}\");\n                add(\"%{#application.test}\");\n                add(\"%{#Application['test']}\");\n                add(\"%{#Application.test}\");\n                add(\"%{#session['test']}\");\n                add(\"%{#session.test}\");\n                add(\"%{#Session['test']}\");\n                add(\"%{#Session.test}\");\n                add(\"%{#struts['test']}\");\n                add(\"%{#struts.test}\");\n                add(\"%{#Struts['test']}\");\n                add(\"%{#Struts.test}\");\n                add(\"%{#request['test']}\");\n                add(\"%{#request.test}\");\n                add(\"%{#Request['test']}\");\n                add(\"%{#Request.test}\");\n                add(\"%{#servletRequest['test']}\");\n                add(\"%{#servletRequest.test}\");\n                add(\"%{#ServletRequest['test']}\");\n                add(\"%{#ServletRequest.test}\");\n                add(\"%{#servletResponse['test']}\");\n                add(\"%{#servletResponse.test}\");\n                add(\"%{#ServletResponse['test']}\");\n                add(\"%{#ServletResponse.test}\");\n                add(\"%{#parameters['test']}\");\n                add(\"%{#parameters.test}\");\n                add(\"%{#Parameters['test']}\");\n                add(\"%{#Parameters.test}\");\n                add(\"#context.get('com.opensymphony.xwork2.dispatcher.HttpServletResponse')\");\n                add(\"%{#context.get('com.opensymphony.xwork2.dispatcher.HttpServletResponse')}\");\n                add(\"#_memberAccess[\\\"allowStaticMethodAccess\\\"]= new java.lang.Boolean(true)\");\n                add(\"%{#_memberAccess[\\\"allowStaticMethodAccess\\\"]= new java.lang.Boolean(true)}\");\n                add(\"form.class.classLoader\");\n                add(\"form[\\\"class\\\"][\\\"classLoader\\\"]\");\n                add(\"form['class']['classLoader']\");\n                add(\"class['classLoader']\");\n                add(\"class[\\\"classLoader\\\"]\");\n                add(\"class.classLoader.resources.dirContext.docBase=tttt\");\n                add(\"Class.classLoader.resources.dirContext.docBase=tttt\");\n            }\n        };\n\n        ExcludedPatternsChecker checker = new DefaultExcludedPatternsChecker();\n\n        for (String param : params) {\n            \n            ExcludedPatternsChecker.IsExcluded actual = checker.isExcluded(param);\n\n            \n            assertTrue(\"Access to \" + param + \" is possible!\", actual.isExcluded());\n        }\n    }"
  },
  {
    "id": 29,
    "sub_id": 2,
    "code_id": 0,
    "function_id": 1,
    "human_patch": "https://github.com/apache/struts/commit/d832747d647df343ed07a58b1b5e540a05a4d51b",
    "cve_id": "CVE-2015-1831",
    "cwe_id": "Not Mapping",
    "filename": "xwork-core/src/test/java/com/opensymphony/xwork2/security/DefaultExcludedPatternsCheckerTest.java",
    "is_vulnerable": 1,
    "class_name": "DefaultExcludedPatternsCheckerTest",
    "subclass_name": null,
    "function_name": "testParamWithClassInName() throws Exception",
    "function_body": "{\n        \n        List<String> properParams = new ArrayList<String>();\n        properParams.add(\"eventClass\");\n        properParams.add(\"form.eventClass\");\n        properParams.add(\"form[\\\"eventClass\\\"]\");\n        properParams.add(\"form['eventClass']\");\n\n        ExcludedPatternsChecker checker = new DefaultExcludedPatternsChecker();\n\n        for (String properParam : properParams) {\n            \n            ExcludedPatternsChecker.IsExcluded actual = checker.isExcluded(properParam);\n\n            \n            assertFalse(\"Param '\" + properParam + \"' is excluded!\", actual.isExcluded());\n        }\n    }"
  },
  {
    "id": 29,
    "sub_id": 2,
    "code_id": 0,
    "function_id": 2,
    "human_patch": "https://github.com/apache/struts/commit/d832747d647df343ed07a58b1b5e540a05a4d51b",
    "cve_id": "CVE-2015-1831",
    "cwe_id": "Not Mapping",
    "filename": "xwork-core/src/test/java/com/opensymphony/xwork2/security/DefaultExcludedPatternsCheckerTest.java",
    "is_vulnerable": 0,
    "class_name": "DefaultExcludedPatternsCheckerTest",
    "subclass_name": null,
    "function_name": "testStrutsTokenIsExcluded() throws Exception",
    "function_body": "{\n        \n        List<String> tokens = new ArrayList<String>();\n        tokens.add(\"struts.token.name\");\n        tokens.add(\"struts.token\");\n\n        ExcludedPatternsChecker checker = new DefaultExcludedPatternsChecker();\n\n        for (String token : tokens) {\n            \n            ExcludedPatternsChecker.IsExcluded actual = checker.isExcluded(token);\n\n            \n            assertTrue(\"Param '\" + token + \"' is not excluded!\", actual.isExcluded());\n        }\n    }"
  },
  {
    "id": 30,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 0,
    "human_patch": "https://github.com/apache/struts/commit/f238cf4f1091be19fbcfd086b042c86a1bcaa7fc",
    "cve_id": "CVE-2016-3081",
    "cwe_id": "CWE-77",
    "filename": "core/src/main/java/com/opensymphony/xwork2/ognl/OgnlUtil.java",
    "is_vulnerable": 0,
    "class_name": "OgnlUtil",
    "subclass_name": null,
    "function_name": "setXWorkConverter(XWorkConverter conv)",
    "function_body": "{\n        this.defaultConverter = new OgnlTypeConverterWrapper(conv);\n    }"
  },
  {
    "id": 30,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 1,
    "human_patch": "https://github.com/apache/struts/commit/f238cf4f1091be19fbcfd086b042c86a1bcaa7fc",
    "cve_id": "CVE-2016-3081",
    "cwe_id": "CWE-77",
    "filename": "core/src/main/java/com/opensymphony/xwork2/ognl/OgnlUtil.java",
    "is_vulnerable": 0,
    "class_name": "OgnlUtil",
    "subclass_name": null,
    "function_name": "setDevMode(String mode)",
    "function_body": "{\n        this.devMode = BooleanUtils.toBoolean(mode);\n    }"
  },
  {
    "id": 30,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 2,
    "human_patch": "https://github.com/apache/struts/commit/f238cf4f1091be19fbcfd086b042c86a1bcaa7fc",
    "cve_id": "CVE-2016-3081",
    "cwe_id": "CWE-77",
    "filename": "core/src/main/java/com/opensymphony/xwork2/ognl/OgnlUtil.java",
    "is_vulnerable": 0,
    "class_name": "OgnlUtil",
    "subclass_name": null,
    "function_name": "setEnableExpressionCache(String cache)",
    "function_body": "{\n        enableExpressionCache = BooleanUtils.toBoolean(cache);\n    }"
  },
  {
    "id": 30,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 3,
    "human_patch": "https://github.com/apache/struts/commit/f238cf4f1091be19fbcfd086b042c86a1bcaa7fc",
    "cve_id": "CVE-2016-3081",
    "cwe_id": "CWE-77",
    "filename": "core/src/main/java/com/opensymphony/xwork2/ognl/OgnlUtil.java",
    "is_vulnerable": 0,
    "class_name": "OgnlUtil",
    "subclass_name": null,
    "function_name": "setEnableEvalExpression(String evalExpression)",
    "function_body": "{\n        enableEvalExpression = \"true\".equals(evalExpression);\n        if(enableEvalExpression){\n            LOG.warn(\"Enabling OGNL expression evaluation may introduce security risks \" +\n                    \"(see http://struts.apache.org/release/2.3.x/docs/s2-013.html for further details)\");\n        }\n    }"
  },
  {
    "id": 30,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 4,
    "human_patch": "https://github.com/apache/struts/commit/f238cf4f1091be19fbcfd086b042c86a1bcaa7fc",
    "cve_id": "CVE-2016-3081",
    "cwe_id": "CWE-77",
    "filename": "core/src/main/java/com/opensymphony/xwork2/ognl/OgnlUtil.java",
    "is_vulnerable": 0,
    "class_name": "OgnlUtil",
    "subclass_name": null,
    "function_name": "setExcludedClasses(String commaDelimitedClasses)",
    "function_body": "{\n        Set<String> classes = TextParseUtil.commaDelimitedStringToSet(commaDelimitedClasses);\n        for (String className : classes) {\n            try {\n                excludedClasses.add(Class.forName(className));\n            } catch (ClassNotFoundException e) {\n                throw new ConfigurationException(\"Cannot load excluded class: \" + className, e);\n            }\n        }\n    }"
  },
  {
    "id": 30,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 5,
    "human_patch": "https://github.com/apache/struts/commit/f238cf4f1091be19fbcfd086b042c86a1bcaa7fc",
    "cve_id": "CVE-2016-3081",
    "cwe_id": "CWE-77",
    "filename": "core/src/main/java/com/opensymphony/xwork2/ognl/OgnlUtil.java",
    "is_vulnerable": 0,
    "class_name": "OgnlUtil",
    "subclass_name": null,
    "function_name": "setExcludedPackageNamePatterns(String commaDelimitedPackagePatterns)",
    "function_body": "{\n        Set<String> packagePatterns = TextParseUtil.commaDelimitedStringToSet(commaDelimitedPackagePatterns);\n        for (String pattern : packagePatterns) {\n            excludedPackageNamePatterns.add(Pattern.compile(pattern));\n        }\n    }"
  },
  {
    "id": 30,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 6,
    "human_patch": "https://github.com/apache/struts/commit/f238cf4f1091be19fbcfd086b042c86a1bcaa7fc",
    "cve_id": "CVE-2016-3081",
    "cwe_id": "CWE-77",
    "filename": "core/src/main/java/com/opensymphony/xwork2/ognl/OgnlUtil.java",
    "is_vulnerable": 0,
    "class_name": "OgnlUtil",
    "subclass_name": null,
    "function_name": "setExcludedPackageNames(String commaDelimitedPackageNames)",
    "function_body": "{\n        excludedPackageNames = TextParseUtil.commaDelimitedStringToSet(commaDelimitedPackageNames);\n    }"
  },
  {
    "id": 30,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 7,
    "human_patch": "https://github.com/apache/struts/commit/f238cf4f1091be19fbcfd086b042c86a1bcaa7fc",
    "cve_id": "CVE-2016-3081",
    "cwe_id": "CWE-77",
    "filename": "core/src/main/java/com/opensymphony/xwork2/ognl/OgnlUtil.java",
    "is_vulnerable": 0,
    "class_name": "OgnlUtil",
    "subclass_name": null,
    "function_name": "getExcludedClasses()",
    "function_body": "{\n        return excludedClasses;\n    }"
  },
  {
    "id": 30,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 8,
    "human_patch": "https://github.com/apache/struts/commit/f238cf4f1091be19fbcfd086b042c86a1bcaa7fc",
    "cve_id": "CVE-2016-3081",
    "cwe_id": "CWE-77",
    "filename": "core/src/main/java/com/opensymphony/xwork2/ognl/OgnlUtil.java",
    "is_vulnerable": 0,
    "class_name": "OgnlUtil",
    "subclass_name": null,
    "function_name": "getExcludedPackageNamePatterns()",
    "function_body": "{\n        return excludedPackageNamePatterns;\n    }"
  },
  {
    "id": 30,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 9,
    "human_patch": "https://github.com/apache/struts/commit/f238cf4f1091be19fbcfd086b042c86a1bcaa7fc",
    "cve_id": "CVE-2016-3081",
    "cwe_id": "CWE-77",
    "filename": "core/src/main/java/com/opensymphony/xwork2/ognl/OgnlUtil.java",
    "is_vulnerable": 0,
    "class_name": "OgnlUtil",
    "subclass_name": null,
    "function_name": "getExcludedPackageNames()",
    "function_body": "{\n        return excludedPackageNames;\n    }"
  },
  {
    "id": 30,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 10,
    "human_patch": "https://github.com/apache/struts/commit/f238cf4f1091be19fbcfd086b042c86a1bcaa7fc",
    "cve_id": "CVE-2016-3081",
    "cwe_id": "CWE-77",
    "filename": "core/src/main/java/com/opensymphony/xwork2/ognl/OgnlUtil.java",
    "is_vulnerable": 0,
    "class_name": "OgnlUtil",
    "subclass_name": null,
    "function_name": "setContainer(Container container)",
    "function_body": "{\n        this.container = container;\n    }"
  },
  {
    "id": 30,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 11,
    "human_patch": "https://github.com/apache/struts/commit/f238cf4f1091be19fbcfd086b042c86a1bcaa7fc",
    "cve_id": "CVE-2016-3081",
    "cwe_id": "CWE-77",
    "filename": "core/src/main/java/com/opensymphony/xwork2/ognl/OgnlUtil.java",
    "is_vulnerable": 0,
    "class_name": "OgnlUtil",
    "subclass_name": null,
    "function_name": "setAllowStaticMethodAccess(String allowStaticMethodAccess)",
    "function_body": "{\n        this.allowStaticMethodAccess = Boolean.parseBoolean(allowStaticMethodAccess);\n    }"
  },
  {
    "id": 30,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 12,
    "human_patch": "https://github.com/apache/struts/commit/f238cf4f1091be19fbcfd086b042c86a1bcaa7fc",
    "cve_id": "CVE-2016-3081",
    "cwe_id": "CWE-77",
    "filename": "core/src/main/java/com/opensymphony/xwork2/ognl/OgnlUtil.java",
    "is_vulnerable": 0,
    "class_name": "OgnlUtil",
    "subclass_name": null,
    "function_name": "setProperties(Map<String, ?> props, Object o, Map<String, Object> context)",
    "function_body": "{\n        setProperties(props, o, context, false);\n    }"
  },
  {
    "id": 30,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 13,
    "human_patch": "https://github.com/apache/struts/commit/f238cf4f1091be19fbcfd086b042c86a1bcaa7fc",
    "cve_id": "CVE-2016-3081",
    "cwe_id": "CWE-77",
    "filename": "core/src/main/java/com/opensymphony/xwork2/ognl/OgnlUtil.java",
    "is_vulnerable": 0,
    "class_name": "OgnlUtil",
    "subclass_name": null,
    "function_name": "setProperties(Map<String, ?> props, Object o, Map<String, Object> context, boolean throwPropertyExceptions) throws ReflectionException",
    "function_body": "{\n        if (props == null) {\n            return;\n        }\n\n        Ognl.setTypeConverter(context, getTypeConverterFromContext(context));\n\n        Object oldRoot = Ognl.getRoot(context);\n        Ognl.setRoot(context, o);\n\n        for (Map.Entry<String, ?> entry : props.entrySet()) {\n            String expression = entry.getKey();\n            internalSetProperty(expression, entry.getValue(), o, context, throwPropertyExceptions);\n        }\n\n        Ognl.setRoot(context, oldRoot);\n    }"
  },
  {
    "id": 30,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 14,
    "human_patch": "https://github.com/apache/struts/commit/f238cf4f1091be19fbcfd086b042c86a1bcaa7fc",
    "cve_id": "CVE-2016-3081",
    "cwe_id": "CWE-77",
    "filename": "core/src/main/java/com/opensymphony/xwork2/ognl/OgnlUtil.java",
    "is_vulnerable": 0,
    "class_name": "OgnlUtil",
    "subclass_name": null,
    "function_name": "setProperties(Map<String, ?> properties, Object o)",
    "function_body": "{\n        setProperties(properties, o, false);\n    }"
  },
  {
    "id": 30,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 15,
    "human_patch": "https://github.com/apache/struts/commit/f238cf4f1091be19fbcfd086b042c86a1bcaa7fc",
    "cve_id": "CVE-2016-3081",
    "cwe_id": "CWE-77",
    "filename": "core/src/main/java/com/opensymphony/xwork2/ognl/OgnlUtil.java",
    "is_vulnerable": 0,
    "class_name": "OgnlUtil",
    "subclass_name": null,
    "function_name": "setProperties(Map<String, ?> properties, Object o, boolean throwPropertyExceptions)",
    "function_body": "{\n        Map context = createDefaultContext(o, null);\n        setProperties(properties, o, context, throwPropertyExceptions);\n    }"
  },
  {
    "id": 30,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 16,
    "human_patch": "https://github.com/apache/struts/commit/f238cf4f1091be19fbcfd086b042c86a1bcaa7fc",
    "cve_id": "CVE-2016-3081",
    "cwe_id": "CWE-77",
    "filename": "core/src/main/java/com/opensymphony/xwork2/ognl/OgnlUtil.java",
    "is_vulnerable": 0,
    "class_name": "OgnlUtil",
    "subclass_name": null,
    "function_name": "setProperty(String name, Object value, Object o, Map<String, Object> context)",
    "function_body": "{\n        setProperty(name, value, o, context, false);\n    }"
  },
  {
    "id": 30,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 17,
    "human_patch": "https://github.com/apache/struts/commit/f238cf4f1091be19fbcfd086b042c86a1bcaa7fc",
    "cve_id": "CVE-2016-3081",
    "cwe_id": "CWE-77",
    "filename": "core/src/main/java/com/opensymphony/xwork2/ognl/OgnlUtil.java",
    "is_vulnerable": 0,
    "class_name": "OgnlUtil",
    "subclass_name": null,
    "function_name": "setProperty(String name, Object value, Object o, Map<String, Object> context, boolean throwPropertyExceptions)",
    "function_body": "{\n        Ognl.setTypeConverter(context, getTypeConverterFromContext(context));\n\n        Object oldRoot = Ognl.getRoot(context);\n        Ognl.setRoot(context, o);\n\n        internalSetProperty(name, value, o, context, throwPropertyExceptions);\n\n        Ognl.setRoot(context, oldRoot);\n    }"
  },
  {
    "id": 30,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 18,
    "human_patch": "https://github.com/apache/struts/commit/f238cf4f1091be19fbcfd086b042c86a1bcaa7fc",
    "cve_id": "CVE-2016-3081",
    "cwe_id": "CWE-77",
    "filename": "core/src/main/java/com/opensymphony/xwork2/ognl/OgnlUtil.java",
    "is_vulnerable": 0,
    "class_name": "OgnlUtil",
    "subclass_name": null,
    "function_name": "getRealTarget(String property, Map<String, Object> context, Object root) throws OgnlException",
    "function_body": "{\n        \n        if (\"top\".equals(property)) {\n            return root;\n        }\n\n        if (root instanceof CompoundRoot) {\n            \n            CompoundRoot cr = (CompoundRoot) root;\n\n            try {\n                for (Object target : cr) {\n                    if (OgnlRuntime.hasSetProperty((OgnlContext) context, target, property)\n                            || OgnlRuntime.hasGetProperty((OgnlContext) context, target, property)\n                            || OgnlRuntime.getIndexedPropertyType((OgnlContext) context, target.getClass(), property) != OgnlRuntime.INDEXED_PROPERTY_NONE\n                            ) {\n                        return target;\n                    }\n                }\n            } catch (IntrospectionException ex) {\n                throw new ReflectionException(\"Cannot figure out real target class\", ex);\n            }\n\n            return null;\n        }\n\n        return root;\n    }"
  },
  {
    "id": 30,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 19,
    "human_patch": "https://github.com/apache/struts/commit/f238cf4f1091be19fbcfd086b042c86a1bcaa7fc",
    "cve_id": "CVE-2016-3081",
    "cwe_id": "CWE-77",
    "filename": "core/src/main/java/com/opensymphony/xwork2/ognl/OgnlUtil.java",
    "is_vulnerable": 1,
    "class_name": "OgnlUtil",
    "subclass_name": null,
    "function_name": "setValue(final String name, final Map<String, Object> context, final Object root, final Object value) throws OgnlException",
    "function_body": "{\n        compileAndExecute(name, context, new OgnlTask<Void>() {\n            public Void execute(Object tree) throws OgnlException {\n                if (isEvalExpression(tree, context)) {\n                    throw new OgnlException(\"Eval expression cannot be used as parameter name\");\n                }\n                Ognl.setValue(tree, context, root, value);\n                return null;\n            }\n        });\n    }"
  },
  {
    "id": 30,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 20,
    "human_patch": "https://github.com/apache/struts/commit/f238cf4f1091be19fbcfd086b042c86a1bcaa7fc",
    "cve_id": "CVE-2016-3081",
    "cwe_id": "CWE-77",
    "filename": "core/src/main/java/com/opensymphony/xwork2/ognl/OgnlUtil.java",
    "is_vulnerable": 1,
    "class_name": "OgnlUtil",
    "subclass_name": null,
    "function_name": "execute(Object tree) throws OgnlException",
    "function_body": "{\n                if (isEvalExpression(tree, context)) {\n                    throw new OgnlException(\"Eval expression cannot be used as parameter name\");\n                }\n                Ognl.setValue(tree, context, root, value);\n                return null;\n            }"
  },
  {
    "id": 30,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 21,
    "human_patch": "https://github.com/apache/struts/commit/f238cf4f1091be19fbcfd086b042c86a1bcaa7fc",
    "cve_id": "CVE-2016-3081",
    "cwe_id": "CWE-77",
    "filename": "core/src/main/java/com/opensymphony/xwork2/ognl/OgnlUtil.java",
    "is_vulnerable": 1,
    "class_name": "OgnlUtil",
    "subclass_name": null,
    "function_name": "isEvalExpression(Object tree, Map<String, Object> context) throws OgnlException",
    "function_body": "{\n        if (tree instanceof SimpleNode) {\n            SimpleNode node = (SimpleNode) tree;\n            OgnlContext ognlContext = null;\n\n            if (context!=null && context instanceof OgnlContext) {\n                ognlContext = (OgnlContext) context;\n            }\n            return node.isEvalChain(ognlContext);\n        }\n        return false;\n    }"
  },
  {
    "id": 30,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 22,
    "human_patch": "https://github.com/apache/struts/commit/f238cf4f1091be19fbcfd086b042c86a1bcaa7fc",
    "cve_id": "CVE-2016-3081",
    "cwe_id": "CWE-77",
    "filename": "core/src/main/java/com/opensymphony/xwork2/ognl/OgnlUtil.java",
    "is_vulnerable": 0,
    "class_name": "OgnlUtil",
    "subclass_name": null,
    "function_name": "getValue(final String name, final Map<String, Object> context, final Object root) throws OgnlException",
    "function_body": "{\n        return compileAndExecute(name, context, new OgnlTask<Object>() {\n            public Object execute(Object tree) throws OgnlException {\n                return Ognl.getValue(tree, context, root);\n            }\n        });\n    }"
  },
  {
    "id": 30,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 23,
    "human_patch": "https://github.com/apache/struts/commit/f238cf4f1091be19fbcfd086b042c86a1bcaa7fc",
    "cve_id": "CVE-2016-3081",
    "cwe_id": "CWE-77",
    "filename": "core/src/main/java/com/opensymphony/xwork2/ognl/OgnlUtil.java",
    "is_vulnerable": 1,
    "class_name": "OgnlUtil",
    "subclass_name": null,
    "function_name": "execute(Object tree) throws OgnlException",
    "function_body": "{\n                return Ognl.getValue(tree, context, root);\n            }"
  },
  {
    "id": 30,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 24,
    "human_patch": "https://github.com/apache/struts/commit/f238cf4f1091be19fbcfd086b042c86a1bcaa7fc",
    "cve_id": "CVE-2016-3081",
    "cwe_id": "CWE-77",
    "filename": "core/src/main/java/com/opensymphony/xwork2/ognl/OgnlUtil.java",
    "is_vulnerable": 0,
    "class_name": "OgnlUtil",
    "subclass_name": null,
    "function_name": "getValue(final String name, final Map<String, Object> context, final Object root, final Class resultType) throws OgnlException",
    "function_body": "{\n        return compileAndExecute(name, context, new OgnlTask<Object>() {\n            public Object execute(Object tree) throws OgnlException {\n                return Ognl.getValue(tree, context, root, resultType);\n            }\n        });\n    }"
  },
  {
    "id": 30,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 25,
    "human_patch": "https://github.com/apache/struts/commit/f238cf4f1091be19fbcfd086b042c86a1bcaa7fc",
    "cve_id": "CVE-2016-3081",
    "cwe_id": "CWE-77",
    "filename": "core/src/main/java/com/opensymphony/xwork2/ognl/OgnlUtil.java",
    "is_vulnerable": 1,
    "class_name": "OgnlUtil",
    "subclass_name": null,
    "function_name": "execute(Object tree) throws OgnlException",
    "function_body": "{\n                return Ognl.getValue(tree, context, root, resultType);\n            }"
  },
  {
    "id": 30,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 26,
    "human_patch": "https://github.com/apache/struts/commit/f238cf4f1091be19fbcfd086b042c86a1bcaa7fc",
    "cve_id": "CVE-2016-3081",
    "cwe_id": "CWE-77",
    "filename": "core/src/main/java/com/opensymphony/xwork2/ognl/OgnlUtil.java",
    "is_vulnerable": 0,
    "class_name": "OgnlUtil",
    "subclass_name": null,
    "function_name": "compile(String expression) throws OgnlException",
    "function_body": "{\n        return compile(expression, null);\n    }"
  },
  {
    "id": 30,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 27,
    "human_patch": "https://github.com/apache/struts/commit/f238cf4f1091be19fbcfd086b042c86a1bcaa7fc",
    "cve_id": "CVE-2016-3081",
    "cwe_id": "CWE-77",
    "filename": "core/src/main/java/com/opensymphony/xwork2/ognl/OgnlUtil.java",
    "is_vulnerable": 0,
    "class_name": "OgnlUtil",
    "subclass_name": null,
    "function_name": "compileAndExecute(String expression, Map<String, Object> context, OgnlTask<T> task) throws OgnlException",
    "function_body": "{\n        Object tree;\n        if (enableExpressionCache) {\n            tree = expressions.get(expression);\n            if (tree == null) {\n                tree = Ognl.parseExpression(expression);\n                checkEnableEvalExpression(tree, context);\n            }\n        } else {\n            tree = Ognl.parseExpression(expression);\n            checkEnableEvalExpression(tree, context);\n        }\n\n        final T exec = task.execute(tree);\n        \n        if(enableExpressionCache) {\n            expressions.putIfAbsent(expression, tree);\n        }\n        return exec;\n    }"
  },
  {
    "id": 30,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 28,
    "human_patch": "https://github.com/apache/struts/commit/f238cf4f1091be19fbcfd086b042c86a1bcaa7fc",
    "cve_id": "CVE-2016-3081",
    "cwe_id": "CWE-77",
    "filename": "core/src/main/java/com/opensymphony/xwork2/ognl/OgnlUtil.java",
    "is_vulnerable": 0,
    "class_name": "OgnlUtil",
    "subclass_name": null,
    "function_name": "compile(String expression, Map<String, Object> context) throws OgnlException",
    "function_body": "{\n        return compileAndExecute(expression,context,new OgnlTask<Object>() {\n            public Object execute(Object tree) throws OgnlException {\n                return tree;\n            }\n        });\n    }"
  },
  {
    "id": 30,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 29,
    "human_patch": "https://github.com/apache/struts/commit/f238cf4f1091be19fbcfd086b042c86a1bcaa7fc",
    "cve_id": "CVE-2016-3081",
    "cwe_id": "CWE-77",
    "filename": "core/src/main/java/com/opensymphony/xwork2/ognl/OgnlUtil.java",
    "is_vulnerable": 1,
    "class_name": "OgnlUtil",
    "subclass_name": null,
    "function_name": "execute(Object tree) throws OgnlException",
    "function_body": "{\n                return tree;\n            }"
  },
  {
    "id": 30,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 30,
    "human_patch": "https://github.com/apache/struts/commit/f238cf4f1091be19fbcfd086b042c86a1bcaa7fc",
    "cve_id": "CVE-2016-3081",
    "cwe_id": "CWE-77",
    "filename": "core/src/main/java/com/opensymphony/xwork2/ognl/OgnlUtil.java",
    "is_vulnerable": 1,
    "class_name": "OgnlUtil",
    "subclass_name": null,
    "function_name": "checkEnableEvalExpression(Object tree, Map<String, Object> context) throws OgnlException",
    "function_body": "{\n        if (!enableEvalExpression && isEvalExpression(tree, context)) {\n            throw new OgnlException(\"Eval expressions has been disabled!\");\n        }\n    }"
  },
  {
    "id": 30,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 31,
    "human_patch": "https://github.com/apache/struts/commit/f238cf4f1091be19fbcfd086b042c86a1bcaa7fc",
    "cve_id": "CVE-2016-3081",
    "cwe_id": "CWE-77",
    "filename": "core/src/main/java/com/opensymphony/xwork2/ognl/OgnlUtil.java",
    "is_vulnerable": 0,
    "class_name": "OgnlUtil",
    "subclass_name": null,
    "function_name": "copy(final Object from, final Object to, final Map<String, Object> context, Collection<String> exclusions, Collection<String> inclusions)",
    "function_body": "{\n        if (from == null || to == null) {\n            LOG.warn(\"Attempting to copy from or to a null source. This is illegal and is bein skipped. This may be due to an error in an OGNL expression, action chaining, or some other event.\");\n            return;\n        }\n\n        TypeConverter converter = getTypeConverterFromContext(context);\n        final Map contextFrom = createDefaultContext(from, null);\n        Ognl.setTypeConverter(contextFrom, converter);\n        final Map contextTo = createDefaultContext(to, null);\n        Ognl.setTypeConverter(contextTo, converter);\n\n        PropertyDescriptor[] fromPds;\n        PropertyDescriptor[] toPds;\n\n        try {\n            fromPds = getPropertyDescriptors(from);\n            toPds = getPropertyDescriptors(to);\n        } catch (IntrospectionException e) {\n            LOG.error(\"An error occurred\", e);\n            return;\n        }\n\n        Map<String, PropertyDescriptor> toPdHash = new HashMap<>();\n\n        for (PropertyDescriptor toPd : toPds) {\n            toPdHash.put(toPd.getName(), toPd);\n        }\n\n        for (PropertyDescriptor fromPd : fromPds) {\n            if (fromPd.getReadMethod() != null) {\n                boolean copy = true;\n                if (exclusions != null && exclusions.contains(fromPd.getName())) {\n                    copy = false;\n                } else if (inclusions != null && !inclusions.contains(fromPd.getName())) {\n                    copy = false;\n                }\n\n                if (copy) {\n                    PropertyDescriptor toPd = toPdHash.get(fromPd.getName());\n                    if ((toPd != null) && (toPd.getWriteMethod() != null)) {\n                        try {\n                            compileAndExecute(fromPd.getName(), context, new OgnlTask<Object>() {\n                                public Void execute(Object expr) throws OgnlException {\n                                    Object value = Ognl.getValue(expr, contextFrom, from);\n                                    Ognl.setValue(expr, contextTo, to, value);\n                                    return null;\n                                }\n                            });\n\n                        } catch (OgnlException e) {\n                            LOG.debug(\"Got OGNL exception\", e);\n                        }\n                    }\n\n                }\n\n            }\n\n        }\n    }"
  },
  {
    "id": 30,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 32,
    "human_patch": "https://github.com/apache/struts/commit/f238cf4f1091be19fbcfd086b042c86a1bcaa7fc",
    "cve_id": "CVE-2016-3081",
    "cwe_id": "CWE-77",
    "filename": "core/src/main/java/com/opensymphony/xwork2/ognl/OgnlUtil.java",
    "is_vulnerable": 0,
    "class_name": "OgnlUtil",
    "subclass_name": null,
    "function_name": "execute(Object expr) throws OgnlException",
    "function_body": "{\n                                    Object value = Ognl.getValue(expr, contextFrom, from);\n                                    Ognl.setValue(expr, contextTo, to, value);\n                                    return null;\n                                }"
  },
  {
    "id": 30,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 33,
    "human_patch": "https://github.com/apache/struts/commit/f238cf4f1091be19fbcfd086b042c86a1bcaa7fc",
    "cve_id": "CVE-2016-3081",
    "cwe_id": "CWE-77",
    "filename": "core/src/main/java/com/opensymphony/xwork2/ognl/OgnlUtil.java",
    "is_vulnerable": 0,
    "class_name": "OgnlUtil",
    "subclass_name": null,
    "function_name": "copy(Object from, Object to, Map<String, Object> context)",
    "function_body": "{\n        copy(from, to, context, null, null);\n    }"
  },
  {
    "id": 30,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 34,
    "human_patch": "https://github.com/apache/struts/commit/f238cf4f1091be19fbcfd086b042c86a1bcaa7fc",
    "cve_id": "CVE-2016-3081",
    "cwe_id": "CWE-77",
    "filename": "core/src/main/java/com/opensymphony/xwork2/ognl/OgnlUtil.java",
    "is_vulnerable": 0,
    "class_name": "OgnlUtil",
    "subclass_name": null,
    "function_name": "getPropertyDescriptors(Object source) throws IntrospectionException",
    "function_body": "{\n        BeanInfo beanInfo = getBeanInfo(source);\n        return beanInfo.getPropertyDescriptors();\n    }"
  },
  {
    "id": 30,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 35,
    "human_patch": "https://github.com/apache/struts/commit/f238cf4f1091be19fbcfd086b042c86a1bcaa7fc",
    "cve_id": "CVE-2016-3081",
    "cwe_id": "CWE-77",
    "filename": "core/src/main/java/com/opensymphony/xwork2/ognl/OgnlUtil.java",
    "is_vulnerable": 0,
    "class_name": "OgnlUtil",
    "subclass_name": null,
    "function_name": "getPropertyDescriptors(Class clazz) throws IntrospectionException",
    "function_body": "{\n        BeanInfo beanInfo = getBeanInfo(clazz);\n        return beanInfo.getPropertyDescriptors();\n    }"
  },
  {
    "id": 30,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 36,
    "human_patch": "https://github.com/apache/struts/commit/f238cf4f1091be19fbcfd086b042c86a1bcaa7fc",
    "cve_id": "CVE-2016-3081",
    "cwe_id": "CWE-77",
    "filename": "core/src/main/java/com/opensymphony/xwork2/ognl/OgnlUtil.java",
    "is_vulnerable": 0,
    "class_name": "OgnlUtil",
    "subclass_name": null,
    "function_name": "getBeanMap(final Object source) throws IntrospectionException, OgnlException",
    "function_body": "{\n        Map<String, Object> beanMap = new HashMap<>();\n        final Map sourceMap = createDefaultContext(source, null);\n        PropertyDescriptor[] propertyDescriptors = getPropertyDescriptors(source);\n        for (PropertyDescriptor propertyDescriptor : propertyDescriptors) {\n            final String propertyName = propertyDescriptor.getDisplayName();\n            Method readMethod = propertyDescriptor.getReadMethod();\n            if (readMethod != null) {\n                final Object value = compileAndExecute(propertyName, null, new OgnlTask<Object>() {\n                    public Object execute(Object expr) throws OgnlException {\n                        return Ognl.getValue(expr, sourceMap, source);\n                    }\n                });\n                beanMap.put(propertyName, value);\n            } else {\n                beanMap.put(propertyName, \"There is no read method for \" + propertyName);\n            }\n        }\n        return beanMap;\n    }"
  },
  {
    "id": 30,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 37,
    "human_patch": "https://github.com/apache/struts/commit/f238cf4f1091be19fbcfd086b042c86a1bcaa7fc",
    "cve_id": "CVE-2016-3081",
    "cwe_id": "CWE-77",
    "filename": "core/src/main/java/com/opensymphony/xwork2/ognl/OgnlUtil.java",
    "is_vulnerable": 1,
    "class_name": "OgnlUtil",
    "subclass_name": null,
    "function_name": "execute(Object expr) throws OgnlException",
    "function_body": "{\n                        return Ognl.getValue(expr, sourceMap, source);\n                    }"
  },
  {
    "id": 30,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 38,
    "human_patch": "https://github.com/apache/struts/commit/f238cf4f1091be19fbcfd086b042c86a1bcaa7fc",
    "cve_id": "CVE-2016-3081",
    "cwe_id": "CWE-77",
    "filename": "core/src/main/java/com/opensymphony/xwork2/ognl/OgnlUtil.java",
    "is_vulnerable": 0,
    "class_name": "OgnlUtil",
    "subclass_name": null,
    "function_name": "getBeanInfo(Object from) throws IntrospectionException",
    "function_body": "{\n        return getBeanInfo(from.getClass());\n    }"
  },
  {
    "id": 30,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 39,
    "human_patch": "https://github.com/apache/struts/commit/f238cf4f1091be19fbcfd086b042c86a1bcaa7fc",
    "cve_id": "CVE-2016-3081",
    "cwe_id": "CWE-77",
    "filename": "core/src/main/java/com/opensymphony/xwork2/ognl/OgnlUtil.java",
    "is_vulnerable": 0,
    "class_name": "OgnlUtil",
    "subclass_name": null,
    "function_name": "getBeanInfo(Class clazz) throws IntrospectionException",
    "function_body": "{\n        synchronized (beanInfoCache) {\n            BeanInfo beanInfo;\n            beanInfo = beanInfoCache.get(clazz);\n            if (beanInfo == null) {\n                beanInfo = Introspector.getBeanInfo(clazz, Object.class);\n                beanInfoCache.putIfAbsent(clazz, beanInfo);\n            }\n            return beanInfo;\n        }\n    }"
  },
  {
    "id": 30,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 40,
    "human_patch": "https://github.com/apache/struts/commit/f238cf4f1091be19fbcfd086b042c86a1bcaa7fc",
    "cve_id": "CVE-2016-3081",
    "cwe_id": "CWE-77",
    "filename": "core/src/main/java/com/opensymphony/xwork2/ognl/OgnlUtil.java",
    "is_vulnerable": 0,
    "class_name": "OgnlUtil",
    "subclass_name": null,
    "function_name": "internalSetProperty(String name, Object value, Object o, Map<String, Object> context, boolean throwPropertyExceptions) throws ReflectionException",
    "function_body": "{\n        try {\n            setValue(name, context, o, value);\n        } catch (OgnlException e) {\n            Throwable reason = e.getReason();\n            String msg = \"Caught OgnlException while setting property '\" + name + \"' on type '\" + o.getClass().getName() + \"'.\";\n            Throwable exception = (reason == null) ? e : reason;\n\n            if (throwPropertyExceptions) {\n                throw new ReflectionException(msg, exception);\n            } else if (devMode) {\n                LOG.warn(msg, exception);\n            }\n        }\n    }"
  },
  {
    "id": 30,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 41,
    "human_patch": "https://github.com/apache/struts/commit/f238cf4f1091be19fbcfd086b042c86a1bcaa7fc",
    "cve_id": "CVE-2016-3081",
    "cwe_id": "CWE-77",
    "filename": "core/src/main/java/com/opensymphony/xwork2/ognl/OgnlUtil.java",
    "is_vulnerable": 0,
    "class_name": "OgnlUtil",
    "subclass_name": null,
    "function_name": "getTypeConverterFromContext(Map<String, Object> context)",
    "function_body": "{\n        \n        return defaultConverter;\n    }"
  },
  {
    "id": 30,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 42,
    "human_patch": "https://github.com/apache/struts/commit/f238cf4f1091be19fbcfd086b042c86a1bcaa7fc",
    "cve_id": "CVE-2016-3081",
    "cwe_id": "CWE-77",
    "filename": "core/src/main/java/com/opensymphony/xwork2/ognl/OgnlUtil.java",
    "is_vulnerable": 0,
    "class_name": "OgnlUtil",
    "subclass_name": null,
    "function_name": "createDefaultContext(Object root)",
    "function_body": "{\n        return createDefaultContext(root, null);\n    }"
  },
  {
    "id": 30,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 43,
    "human_patch": "https://github.com/apache/struts/commit/f238cf4f1091be19fbcfd086b042c86a1bcaa7fc",
    "cve_id": "CVE-2016-3081",
    "cwe_id": "CWE-77",
    "filename": "core/src/main/java/com/opensymphony/xwork2/ognl/OgnlUtil.java",
    "is_vulnerable": 0,
    "class_name": "OgnlUtil",
    "subclass_name": null,
    "function_name": "createDefaultContext(Object root, ClassResolver classResolver)",
    "function_body": "{\n        ClassResolver resolver = classResolver;\n        if (resolver == null) {\n            resolver = container.getInstance(CompoundRootAccessor.class);\n        }\n\n        SecurityMemberAccess memberAccess = new SecurityMemberAccess(allowStaticMethodAccess);\n        memberAccess.setExcludedClasses(excludedClasses);\n        memberAccess.setExcludedPackageNamePatterns(excludedPackageNamePatterns);\n        memberAccess.setExcludedPackageNames(excludedPackageNames);\n\n        return Ognl.createDefaultContext(root, resolver, defaultConverter, memberAccess);\n    }"
  },
  {
    "id": 30,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 44,
    "human_patch": "https://github.com/apache/struts/commit/f238cf4f1091be19fbcfd086b042c86a1bcaa7fc",
    "cve_id": "CVE-2016-3081",
    "cwe_id": "CWE-77",
    "filename": "core/src/main/java/com/opensymphony/xwork2/ognl/OgnlUtil.java",
    "is_vulnerable": 0,
    "class_name": "OgnlUtil",
    "subclass_name": "OgnlTask",
    "function_name": "execute(Object tree) throws OgnlException",
    "function_body": null
  },
  {
    "id": 30,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 0,
    "human_patch": "https://github.com/apache/struts/commit/f238cf4f1091be19fbcfd086b042c86a1bcaa7fc",
    "cve_id": "CVE-2016-3081",
    "cwe_id": "CWE-77",
    "filename": "core/src/test/java/com/opensymphony/xwork2/ognl/OgnlUtilTest.java",
    "is_vulnerable": 0,
    "class_name": "OgnlUtilTest",
    "subclass_name": null,
    "function_name": "setUp() throws Exception",
    "function_body": "{\n        super.setUp();\n        ognlUtil = container.getInstance(OgnlUtil.class);\n    }"
  },
  {
    "id": 30,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 1,
    "human_patch": "https://github.com/apache/struts/commit/f238cf4f1091be19fbcfd086b042c86a1bcaa7fc",
    "cve_id": "CVE-2016-3081",
    "cwe_id": "CWE-77",
    "filename": "core/src/test/java/com/opensymphony/xwork2/ognl/OgnlUtilTest.java",
    "is_vulnerable": 0,
    "class_name": "OgnlUtilTest",
    "subclass_name": null,
    "function_name": "testCanSetADependentObject() throws Exception",
    "function_body": "{\n        String dogName = \"fido\";\n\n        OgnlRuntime.setNullHandler(Owner.class, new NullHandler() {\n            public Object nullMethodResult(Map map, Object o, String s, Object[] objects) {\n                return null;\n            }\n\n            public Object nullPropertyValue(Map map, Object o, Object o1) {\n                String methodName = o1.toString();\n                String getter = \"set\" + methodName.substring(0, 1).toUpperCase() + methodName.substring(1);\n                Method[] methods = o.getClass().getDeclaredMethods();\n                System.out.println(getter);\n\n                for (Method method : methods) {\n                    String name = method.getName();\n\n                    if (!getter.equals(name) || (method.getParameterTypes().length != 1)) {\n                        continue;\n                    } else {\n                        Class clazz = method.getParameterTypes()[0];\n\n                        try {\n                            Object param = clazz.newInstance();\n                            method.invoke(o, new Object[]{param});\n\n                            return param;\n                        } catch (Exception e) {\n                            throw new RuntimeException(e);\n                        }\n                    }\n                }\n\n                return null;\n            }\n        });\n\n        Owner owner = new Owner();\n        Map context = ognlUtil.createDefaultContext(owner);\n        Map props = new HashMap();\n        props.put(\"dog.name\", dogName);\n\n        ognlUtil.setProperties(props, owner, context);\n        assertNotNull(\"expected Ognl to create an instance of Dog\", owner.getDog());\n        assertEquals(dogName, owner.getDog().getName());\n    }"
  },
  {
    "id": 30,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 2,
    "human_patch": "https://github.com/apache/struts/commit/f238cf4f1091be19fbcfd086b042c86a1bcaa7fc",
    "cve_id": "CVE-2016-3081",
    "cwe_id": "CWE-77",
    "filename": "core/src/test/java/com/opensymphony/xwork2/ognl/OgnlUtilTest.java",
    "is_vulnerable": 0,
    "class_name": "OgnlUtilTest",
    "subclass_name": null,
    "function_name": "nullMethodResult(Map map, Object o, String s, Object[] objects)",
    "function_body": "{\n                return null;\n            }"
  },
  {
    "id": 30,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 3,
    "human_patch": "https://github.com/apache/struts/commit/f238cf4f1091be19fbcfd086b042c86a1bcaa7fc",
    "cve_id": "CVE-2016-3081",
    "cwe_id": "CWE-77",
    "filename": "core/src/test/java/com/opensymphony/xwork2/ognl/OgnlUtilTest.java",
    "is_vulnerable": 0,
    "class_name": "OgnlUtilTest",
    "subclass_name": null,
    "function_name": "nullPropertyValue(Map map, Object o, Object o1)",
    "function_body": "{\n                String methodName = o1.toString();\n                String getter = \"set\" + methodName.substring(0, 1).toUpperCase() + methodName.substring(1);\n                Method[] methods = o.getClass().getDeclaredMethods();\n                System.out.println(getter);\n\n                for (Method method : methods) {\n                    String name = method.getName();\n\n                    if (!getter.equals(name) || (method.getParameterTypes().length != 1)) {\n                        continue;\n                    } else {\n                        Class clazz = method.getParameterTypes()[0];\n\n                        try {\n                            Object param = clazz.newInstance();\n                            method.invoke(o, new Object[]{param});\n\n                            return param;\n                        } catch (Exception e) {\n                            throw new RuntimeException(e);\n                        }\n                    }\n                }\n\n                return null;\n            }"
  },
  {
    "id": 30,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 4,
    "human_patch": "https://github.com/apache/struts/commit/f238cf4f1091be19fbcfd086b042c86a1bcaa7fc",
    "cve_id": "CVE-2016-3081",
    "cwe_id": "CWE-77",
    "filename": "core/src/test/java/com/opensymphony/xwork2/ognl/OgnlUtilTest.java",
    "is_vulnerable": 0,
    "class_name": "OgnlUtilTest",
    "subclass_name": null,
    "function_name": "testCacheEnabled() throws OgnlException",
    "function_body": "{\n        ognlUtil.setEnableExpressionCache(\"true\");\n        Object expr0 = ognlUtil.compile(\"test\");\n        Object expr2 = ognlUtil.compile(\"test\");\n        assertSame(expr0, expr2);\n    }"
  },
  {
    "id": 30,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 5,
    "human_patch": "https://github.com/apache/struts/commit/f238cf4f1091be19fbcfd086b042c86a1bcaa7fc",
    "cve_id": "CVE-2016-3081",
    "cwe_id": "CWE-77",
    "filename": "core/src/test/java/com/opensymphony/xwork2/ognl/OgnlUtilTest.java",
    "is_vulnerable": 0,
    "class_name": "OgnlUtilTest",
    "subclass_name": null,
    "function_name": "testCacheDisabled() throws OgnlException",
    "function_body": "{\n        ognlUtil.setEnableExpressionCache(\"false\");\n        Object expr0 = ognlUtil.compile(\"test\");\n        Object expr2 = ognlUtil.compile(\"test\");\n        assertNotSame(expr0, expr2);\n    }"
  },
  {
    "id": 30,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 6,
    "human_patch": "https://github.com/apache/struts/commit/f238cf4f1091be19fbcfd086b042c86a1bcaa7fc",
    "cve_id": "CVE-2016-3081",
    "cwe_id": "CWE-77",
    "filename": "core/src/test/java/com/opensymphony/xwork2/ognl/OgnlUtilTest.java",
    "is_vulnerable": 0,
    "class_name": "OgnlUtilTest",
    "subclass_name": null,
    "function_name": "testCanSetDependentObjectArray()",
    "function_body": "{\n        EmailAction action = new EmailAction();\n        Map<String, Object> context = ognlUtil.createDefaultContext(action);\n\n        Map<String, Object> props = new HashMap<String, Object>();\n        props.put(\"email[0].address\", \"addr1\");\n        props.put(\"email[1].address\", \"addr2\");\n        props.put(\"email[2].address\", \"addr3\");\n\n        ognlUtil.setProperties(props, action, context);\n        assertEquals(3, action.email.size());\n        assertEquals(\"addr1\", action.email.get(0).toString());\n        assertEquals(\"addr2\", action.email.get(1).toString());\n        assertEquals(\"addr3\", action.email.get(2).toString());\n    }"
  },
  {
    "id": 30,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 7,
    "human_patch": "https://github.com/apache/struts/commit/f238cf4f1091be19fbcfd086b042c86a1bcaa7fc",
    "cve_id": "CVE-2016-3081",
    "cwe_id": "CWE-77",
    "filename": "core/src/test/java/com/opensymphony/xwork2/ognl/OgnlUtilTest.java",
    "is_vulnerable": 0,
    "class_name": "OgnlUtilTest",
    "subclass_name": null,
    "function_name": "testCopySameType()",
    "function_body": "{\n        Foo foo1 = new Foo();\n        Foo foo2 = new Foo();\n\n        Map context = ognlUtil.createDefaultContext(foo1);\n\n        Calendar cal = Calendar.getInstance();\n        cal.clear();\n        cal.set(Calendar.MONTH, Calendar.FEBRUARY);\n        cal.set(Calendar.DAY_OF_MONTH, 12);\n        cal.set(Calendar.YEAR, 1982);\n\n        foo1.setTitle(\"blah\");\n        foo1.setNumber(1);\n        foo1.setPoints(new long[]{1, 2, 3});\n        foo1.setBirthday(cal.getTime());\n        foo1.setUseful(false);\n\n        ognlUtil.copy(foo1, foo2, context);\n\n        assertEquals(foo1.getTitle(), foo2.getTitle());\n        assertEquals(foo1.getNumber(), foo2.getNumber());\n        assertEquals(foo1.getPoints(), foo2.getPoints());\n        assertEquals(foo1.getBirthday(), foo2.getBirthday());\n        assertEquals(foo1.isUseful(), foo2.isUseful());\n    }"
  },
  {
    "id": 30,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 8,
    "human_patch": "https://github.com/apache/struts/commit/f238cf4f1091be19fbcfd086b042c86a1bcaa7fc",
    "cve_id": "CVE-2016-3081",
    "cwe_id": "CWE-77",
    "filename": "core/src/test/java/com/opensymphony/xwork2/ognl/OgnlUtilTest.java",
    "is_vulnerable": 0,
    "class_name": "OgnlUtilTest",
    "subclass_name": null,
    "function_name": "testIncudeExcludes()",
    "function_body": "{\n\n        Foo foo1 = new Foo();\n        Foo foo2 = new Foo();\n\n        Calendar cal = Calendar.getInstance();\n        cal.clear();\n        cal.set(Calendar.MONTH, Calendar.FEBRUARY);\n        cal.set(Calendar.DAY_OF_MONTH, 12);\n        cal.set(Calendar.YEAR, 1982);\n\n        foo1.setPoints(new long[]{1, 2, 3});\n        foo1.setBirthday(cal.getTime());\n        foo1.setUseful(false);\n\n\n        foo1.setTitle(\"foo1 title\");\n        foo1.setNumber(1);\n\n        foo2.setTitle(\"foo2 title\");\n        foo2.setNumber(2);\n\n        Map<String, Object> context = ognlUtil.createDefaultContext(foo1);\n\n        List<String> excludes = new ArrayList<String>();\n        excludes.add(\"title\");\n        excludes.add(\"number\");\n\n        ognlUtil.copy(foo1, foo2, context, excludes, null);\n        \n        assertEquals(foo2.getTitle(), \"foo2 title\");\n        assertEquals(foo2.getNumber(), 2);\n\n        \n        assertEquals(foo1.getPoints(), foo2.getPoints());\n        assertEquals(foo1.getBirthday(), foo2.getBirthday());\n        assertEquals(foo1.isUseful(), foo2.isUseful());\n\n\n        Bar b1 = new Bar();\n        Bar b2 = new Bar();\n\n        b1.setTitle(\"bar1 title\");\n        b1.setSomethingElse(10);\n\n\n        b1.setId(new Long(1));\n\n        b2.setTitle(\"\");\n        b2.setId(new Long(2));\n\n        context = ognlUtil.createDefaultContext(b1);\n        List<String> includes = new ArrayList<String>();\n        includes.add(\"title\");\n        includes.add(\"somethingElse\");\n\n        ognlUtil.copy(b1, b2, context, null, includes);\n        \n        assertEquals(b1.getTitle(), b2.getTitle());\n        assertEquals(b1.getSomethingElse(), b2.getSomethingElse());\n\n        \n        assertEquals(b2.getId(), new Long(2));\n\n    }"
  },
  {
    "id": 30,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 9,
    "human_patch": "https://github.com/apache/struts/commit/f238cf4f1091be19fbcfd086b042c86a1bcaa7fc",
    "cve_id": "CVE-2016-3081",
    "cwe_id": "CWE-77",
    "filename": "core/src/test/java/com/opensymphony/xwork2/ognl/OgnlUtilTest.java",
    "is_vulnerable": 0,
    "class_name": "OgnlUtilTest",
    "subclass_name": null,
    "function_name": "testCopyUnevenObjects()",
    "function_body": "{\n        Foo foo = new Foo();\n        Bar bar = new Bar();\n\n        Map<String, Object> context = ognlUtil.createDefaultContext(foo);\n\n        Calendar cal = Calendar.getInstance();\n        cal.clear();\n        cal.set(Calendar.MONTH, Calendar.FEBRUARY);\n        cal.set(Calendar.DAY_OF_MONTH, 12);\n        cal.set(Calendar.YEAR, 1982);\n\n        foo.setTitle(\"blah\");\n        foo.setNumber(1);\n        foo.setPoints(new long[]{1, 2, 3});\n        foo.setBirthday(cal.getTime());\n        foo.setUseful(false);\n\n        ognlUtil.copy(foo, bar, context);\n\n        assertEquals(foo.getTitle(), bar.getTitle());\n        assertEquals(0, bar.getSomethingElse());\n    }"
  },
  {
    "id": 30,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 10,
    "human_patch": "https://github.com/apache/struts/commit/f238cf4f1091be19fbcfd086b042c86a1bcaa7fc",
    "cve_id": "CVE-2016-3081",
    "cwe_id": "CWE-77",
    "filename": "core/src/test/java/com/opensymphony/xwork2/ognl/OgnlUtilTest.java",
    "is_vulnerable": 0,
    "class_name": "OgnlUtilTest",
    "subclass_name": null,
    "function_name": "testDeepSetting()",
    "function_body": "{\n        Foo foo = new Foo();\n        foo.setBar(new Bar());\n\n        Map<String, Object> context = ognlUtil.createDefaultContext(foo);\n\n        Map<String, Object> props = new HashMap();\n        props.put(\"bar.title\", \"i am barbaz\");\n        ognlUtil.setProperties(props, foo, context);\n\n        assertEquals(foo.getBar().getTitle(), \"i am barbaz\");\n    }"
  },
  {
    "id": 30,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 11,
    "human_patch": "https://github.com/apache/struts/commit/f238cf4f1091be19fbcfd086b042c86a1bcaa7fc",
    "cve_id": "CVE-2016-3081",
    "cwe_id": "CWE-77",
    "filename": "core/src/test/java/com/opensymphony/xwork2/ognl/OgnlUtilTest.java",
    "is_vulnerable": 0,
    "class_name": "OgnlUtilTest",
    "subclass_name": null,
    "function_name": "testNoExceptionForUnmatchedGetterAndSetterWithThrowPropertyException()",
    "function_body": "{\n        Map<String, Object> props = new HashMap<String, Object>();\n        props.put(\"myIntegerProperty\", new Integer(1234));\n\n        TestObject testObject = new TestObject();\n\n        \n        ognlUtil.setProperties(props, testObject, true);\n        assertEquals(1234, props.get(\"myIntegerProperty\"));\n    }"
  },
  {
    "id": 30,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 12,
    "human_patch": "https://github.com/apache/struts/commit/f238cf4f1091be19fbcfd086b042c86a1bcaa7fc",
    "cve_id": "CVE-2016-3081",
    "cwe_id": "CWE-77",
    "filename": "core/src/test/java/com/opensymphony/xwork2/ognl/OgnlUtilTest.java",
    "is_vulnerable": 0,
    "class_name": "OgnlUtilTest",
    "subclass_name": null,
    "function_name": "testExceptionForWrongPropertyNameWithThrowPropertyException()",
    "function_body": "{\n        Map<String, Object> props = new HashMap<String, Object>();\n        props.put(\"myStringProperty\", \"testString\");\n\n        TestObject testObject = new TestObject();\n\n        try {\n            ognlUtil.setProperties(props, testObject, true);\n            fail(\"Should rise NoSuchPropertyException because of wrong property name\");\n        } catch (Exception e) {\n            \n        }\n    }"
  },
  {
    "id": 30,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 13,
    "human_patch": "https://github.com/apache/struts/commit/f238cf4f1091be19fbcfd086b042c86a1bcaa7fc",
    "cve_id": "CVE-2016-3081",
    "cwe_id": "CWE-77",
    "filename": "core/src/test/java/com/opensymphony/xwork2/ognl/OgnlUtilTest.java",
    "is_vulnerable": 0,
    "class_name": "OgnlUtilTest",
    "subclass_name": null,
    "function_name": "testOgnlHandlesCrapAtTheEndOfANumber()",
    "function_body": "{\n        Foo foo = new Foo();\n        Map<String, Object> context = ognlUtil.createDefaultContext(foo);\n\n        Map<String, Object> props = new HashMap<String, Object>();\n        props.put(\"aLong\", \"123a\");\n\n        ognlUtil.setProperties(props, foo, context);\n        assertEquals(0, foo.getALong());\n    }"
  },
  {
    "id": 30,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 14,
    "human_patch": "https://github.com/apache/struts/commit/f238cf4f1091be19fbcfd086b042c86a1bcaa7fc",
    "cve_id": "CVE-2016-3081",
    "cwe_id": "CWE-77",
    "filename": "core/src/test/java/com/opensymphony/xwork2/ognl/OgnlUtilTest.java",
    "is_vulnerable": 0,
    "class_name": "OgnlUtilTest",
    "subclass_name": null,
    "function_name": "testSetIndexedValue()",
    "function_body": "{\n        ValueStack stack = ActionContext.getContext().getValueStack();\n        Map<String, Object> stackContext = stack.getContext();\n        stackContext.put(ReflectionContextState.CREATE_NULL_OBJECTS, Boolean.TRUE);\n        stackContext.put(ReflectionContextState.DENY_METHOD_EXECUTION, Boolean.TRUE);\n        stackContext.put(XWorkConverter.REPORT_CONVERSION_ERRORS, Boolean.TRUE);\n\n        User user = new User();\n        stack.push(user);\n\n        \n        user.setList(new ArrayList<String>());\n        user.getList().add(\"\");\n\n        String[] foo = new String[]{\"asdf\"};\n        stack.setValue(\"list[0]\", foo);\n        assertNotNull(user.getList());\n        assertEquals(1, user.getList().size());\n        assertEquals(String.class, user.getList().get(0).getClass());\n        assertEquals(\"asdf\", user.getList().get(0));\n    }"
  },
  {
    "id": 30,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 15,
    "human_patch": "https://github.com/apache/struts/commit/f238cf4f1091be19fbcfd086b042c86a1bcaa7fc",
    "cve_id": "CVE-2016-3081",
    "cwe_id": "CWE-77",
    "filename": "core/src/test/java/com/opensymphony/xwork2/ognl/OgnlUtilTest.java",
    "is_vulnerable": 0,
    "class_name": "OgnlUtilTest",
    "subclass_name": null,
    "function_name": "testSetPropertiesBoolean()",
    "function_body": "{\n        Foo foo = new Foo();\n\n        Map context = ognlUtil.createDefaultContext(foo);\n\n        Map props = new HashMap();\n        props.put(\"useful\", \"true\");\n        ognlUtil.setProperties(props, foo, context);\n\n        assertEquals(true, foo.isUseful());\n\n        props = new HashMap();\n        props.put(\"useful\", \"false\");\n        ognlUtil.setProperties(props, foo, context);\n\n        assertEquals(false, foo.isUseful());\n    }"
  },
  {
    "id": 30,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 16,
    "human_patch": "https://github.com/apache/struts/commit/f238cf4f1091be19fbcfd086b042c86a1bcaa7fc",
    "cve_id": "CVE-2016-3081",
    "cwe_id": "CWE-77",
    "filename": "core/src/test/java/com/opensymphony/xwork2/ognl/OgnlUtilTest.java",
    "is_vulnerable": 0,
    "class_name": "OgnlUtilTest",
    "subclass_name": null,
    "function_name": "testSetPropertiesDate()",
    "function_body": "{\n        Foo foo = new Foo();\n\n        Map context = ognlUtil.createDefaultContext(foo);\n\n        Map props = new HashMap();\n        props.put(\"birthday\", \"02/12/1982\");\n        \n        ognlUtil.setProperties(props, foo, context);\n\n        Calendar cal = Calendar.getInstance();\n        cal.clear();\n        cal.set(Calendar.MONTH, Calendar.FEBRUARY);\n        cal.set(Calendar.DAY_OF_MONTH, 12);\n        cal.set(Calendar.YEAR, 1982);\n\n        assertEquals(cal.getTime(), foo.getBirthday());\n        \n        \n        props.put(\"event\", \"18/10/2006 14:23:45\");\n        props.put(\"meeting\", \"09/09/2006 14:30\");\n        context.put(ActionContext.LOCALE, Locale.UK);\n\n        ognlUtil.setProperties(props, foo, context);\n        \n        cal = Calendar.getInstance();\n        cal.clear();\n        cal.set(Calendar.MONTH, Calendar.OCTOBER);\n        cal.set(Calendar.DAY_OF_MONTH, 18);\n        cal.set(Calendar.YEAR, 2006);\n        cal.set(Calendar.HOUR_OF_DAY, 14);\n        cal.set(Calendar.MINUTE, 23);\n        cal.set(Calendar.SECOND, 45);\n        \n        assertEquals(cal.getTime(), foo.getEvent());\n        \n        cal = Calendar.getInstance();\n        cal.clear();\n        cal.set(Calendar.MONTH, Calendar.SEPTEMBER);\n        cal.set(Calendar.DAY_OF_MONTH, 9);\n        cal.set(Calendar.YEAR, 2006);\n        cal.set(Calendar.HOUR_OF_DAY, 14);\n        cal.set(Calendar.MINUTE, 30);\n        \n        assertEquals(cal.getTime(), foo.getMeeting());\n        \n        \n        props.put(\"event\", \"1996-12-19T16:39:57Z\");\n        ognlUtil.setProperties(props, foo, context);\n        \n        cal = Calendar.getInstance();\n        cal.clear();\n        cal.set(Calendar.MONTH, Calendar.DECEMBER);\n        cal.set(Calendar.DAY_OF_MONTH, 19);\n        cal.set(Calendar.YEAR, 1996);\n        cal.set(Calendar.HOUR_OF_DAY, 16);\n        cal.set(Calendar.MINUTE, 39);\n        cal.set(Calendar.SECOND, 57);\n        \n        assertEquals(cal.getTime(), foo.getEvent());\n        \n        \n        props.put(\"calendar\", \"1996-12-19T16:39:57Z\");\n        ognlUtil.setProperties(props, foo, context);\n        assertEquals(cal, foo.getCalendar());\n    }"
  },
  {
    "id": 30,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 17,
    "human_patch": "https://github.com/apache/struts/commit/f238cf4f1091be19fbcfd086b042c86a1bcaa7fc",
    "cve_id": "CVE-2016-3081",
    "cwe_id": "CWE-77",
    "filename": "core/src/test/java/com/opensymphony/xwork2/ognl/OgnlUtilTest.java",
    "is_vulnerable": 0,
    "class_name": "OgnlUtilTest",
    "subclass_name": null,
    "function_name": "testSetPropertiesInt()",
    "function_body": "{\n        Foo foo = new Foo();\n\n        Map context = ognlUtil.createDefaultContext(foo);\n\n        Map props = new HashMap();\n        props.put(\"number\", \"2\");\n        ognlUtil.setProperties(props, foo, context);\n\n        assertEquals(2, foo.getNumber());\n    }"
  },
  {
    "id": 30,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 18,
    "human_patch": "https://github.com/apache/struts/commit/f238cf4f1091be19fbcfd086b042c86a1bcaa7fc",
    "cve_id": "CVE-2016-3081",
    "cwe_id": "CWE-77",
    "filename": "core/src/test/java/com/opensymphony/xwork2/ognl/OgnlUtilTest.java",
    "is_vulnerable": 0,
    "class_name": "OgnlUtilTest",
    "subclass_name": null,
    "function_name": "testSetPropertiesLongArray()",
    "function_body": "{\n        Foo foo = new Foo();\n\n        Map context = ognlUtil.createDefaultContext(foo);\n\n        Map props = new HashMap();\n        props.put(\"points\", new String[]{\"1\", \"2\"});\n        ognlUtil.setProperties(props, foo, context);\n\n        assertNotNull(foo.getPoints());\n        assertEquals(2, foo.getPoints().length);\n        assertEquals(1, foo.getPoints()[0]);\n        assertEquals(2, foo.getPoints()[1]);\n    }"
  },
  {
    "id": 30,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 19,
    "human_patch": "https://github.com/apache/struts/commit/f238cf4f1091be19fbcfd086b042c86a1bcaa7fc",
    "cve_id": "CVE-2016-3081",
    "cwe_id": "CWE-77",
    "filename": "core/src/test/java/com/opensymphony/xwork2/ognl/OgnlUtilTest.java",
    "is_vulnerable": 0,
    "class_name": "OgnlUtilTest",
    "subclass_name": null,
    "function_name": "testSetPropertiesString()",
    "function_body": "{\n        Foo foo = new Foo();\n\n        Map context = ognlUtil.createDefaultContext(foo);\n\n        Map props = new HashMap();\n        props.put(\"title\", \"this is a title\");\n        ognlUtil.setProperties(props, foo, context);\n\n        assertEquals(foo.getTitle(), \"this is a title\");\n    }"
  },
  {
    "id": 30,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 20,
    "human_patch": "https://github.com/apache/struts/commit/f238cf4f1091be19fbcfd086b042c86a1bcaa7fc",
    "cve_id": "CVE-2016-3081",
    "cwe_id": "CWE-77",
    "filename": "core/src/test/java/com/opensymphony/xwork2/ognl/OgnlUtilTest.java",
    "is_vulnerable": 0,
    "class_name": "OgnlUtilTest",
    "subclass_name": null,
    "function_name": "testSetProperty()",
    "function_body": "{\n        Foo foo = new Foo();\n        Map context = ognlUtil.createDefaultContext(foo);\n        assertFalse(123456 == foo.getNumber());\n        ognlUtil.setProperty(\"number\", \"123456\", foo, context);\n        assertEquals(123456, foo.getNumber());\n    }"
  },
  {
    "id": 30,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 21,
    "human_patch": "https://github.com/apache/struts/commit/f238cf4f1091be19fbcfd086b042c86a1bcaa7fc",
    "cve_id": "CVE-2016-3081",
    "cwe_id": "CWE-77",
    "filename": "core/src/test/java/com/opensymphony/xwork2/ognl/OgnlUtilTest.java",
    "is_vulnerable": 0,
    "class_name": "OgnlUtilTest",
    "subclass_name": null,
    "function_name": "testSetList() throws Exception",
    "function_body": "{\n        ChainingInterceptor foo = new ChainingInterceptor();\n        ChainingInterceptor foo2 = new ChainingInterceptor();\n\n        OgnlContext context = (OgnlContext) ognlUtil.createDefaultContext(null);\n        SimpleNode expression = (SimpleNode) Ognl.parseExpression(\"{'a','ruby','b','tom'}\");\n\n\n        Ognl.getValue(expression, context, \"aksdj\");\n\n        final ValueStack stack = ActionContext.getContext().getValueStack();\n\n        Object result = Ognl.getValue(ognlUtil.compile(\"{\\\"foo\\\",'ruby','b','tom'}\"), context, foo);\n        foo.setIncludes((Collection) result);\n\n        assertEquals(4, foo.getIncludes().size());\n        assertEquals(\"foo\", foo.getIncludes().toArray()[0]);\n        assertEquals(\"ruby\", foo.getIncludes().toArray()[1]);\n        assertEquals(\"b\", \"\" + foo.getIncludes().toArray()[2]);\n        assertEquals(\"tom\", foo.getIncludes().toArray()[3]);\n\n        Object result2 = Ognl.getValue(ognlUtil.compile(\"{\\\"foo\\\",'ruby','b','tom'}\"), context, foo2);\n        ognlUtil.setProperty(\"includes\", result2, foo2, context);\n\n        assertEquals(4, foo.getIncludes().size());\n        assertEquals(\"foo\", foo.getIncludes().toArray()[0]);\n        assertEquals(\"ruby\", foo.getIncludes().toArray()[1]);\n        assertEquals(\"b\", \"\" + foo.getIncludes().toArray()[2]);\n        assertEquals(\"tom\", foo.getIncludes().toArray()[3]);\n\n        result = ActionContext.getContext().getValueStack().findValue(\"{\\\"foo\\\",'ruby','b','tom'}\");\n\n        foo.setIncludes((Collection) result);\n        assertEquals(ArrayList.class, result.getClass());\n\n        assertEquals(4, foo.getIncludes().size());\n        assertEquals(\"foo\", foo.getIncludes().toArray()[0]);\n        assertEquals(\"ruby\", foo.getIncludes().toArray()[1]);\n        assertEquals(\"b\", \"\" + foo.getIncludes().toArray()[2]);\n        assertEquals(\"tom\", foo.getIncludes().toArray()[3]);\n    }"
  },
  {
    "id": 30,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 22,
    "human_patch": "https://github.com/apache/struts/commit/f238cf4f1091be19fbcfd086b042c86a1bcaa7fc",
    "cve_id": "CVE-2016-3081",
    "cwe_id": "CWE-77",
    "filename": "core/src/test/java/com/opensymphony/xwork2/ognl/OgnlUtilTest.java",
    "is_vulnerable": 0,
    "class_name": "OgnlUtilTest",
    "subclass_name": null,
    "function_name": "testStringToLong()",
    "function_body": "{\n        Foo foo = new Foo();\n\n        Map context = ognlUtil.createDefaultContext(foo);\n\n        Map props = new HashMap();\n        props.put(\"ALong\", \"123\");\n\n        ognlUtil.setProperties(props, foo, context);\n        assertEquals(123, foo.getALong());\n\n        props.put(\"ALong\", new String[]{\"123\"});\n\n        foo.setALong(0);\n        ognlUtil.setProperties(props, foo, context);\n        assertEquals(123, foo.getALong());\n    }"
  },
  {
    "id": 30,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 23,
    "human_patch": "https://github.com/apache/struts/commit/f238cf4f1091be19fbcfd086b042c86a1bcaa7fc",
    "cve_id": "CVE-2016-3081",
    "cwe_id": "CWE-77",
    "filename": "core/src/test/java/com/opensymphony/xwork2/ognl/OgnlUtilTest.java",
    "is_vulnerable": 0,
    "class_name": "OgnlUtilTest",
    "subclass_name": null,
    "function_name": "testNullProperties()",
    "function_body": "{\n        Foo foo = new Foo();\n        foo.setALong(88);\n\n        Map context = ognlUtil.createDefaultContext(foo);\n\n        ognlUtil.setProperties(null, foo, context);\n        assertEquals(88, foo.getALong());\n\n        Map props = new HashMap();\n        props.put(\"ALong\", \"99\");\n        ognlUtil.setProperties(props, foo, context);\n        assertEquals(99, foo.getALong());\n    }"
  },
  {
    "id": 30,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 24,
    "human_patch": "https://github.com/apache/struts/commit/f238cf4f1091be19fbcfd086b042c86a1bcaa7fc",
    "cve_id": "CVE-2016-3081",
    "cwe_id": "CWE-77",
    "filename": "core/src/test/java/com/opensymphony/xwork2/ognl/OgnlUtilTest.java",
    "is_vulnerable": 0,
    "class_name": "OgnlUtilTest",
    "subclass_name": null,
    "function_name": "testCopyNull()",
    "function_body": "{\n        Foo foo = new Foo();\n        Map context = ognlUtil.createDefaultContext(foo);\n   \t\tognlUtil.copy(null, null, context);\n\n   \t\tognlUtil.copy(foo, null, context);\n   \t\tognlUtil.copy(null, foo, context);\n    }"
  },
  {
    "id": 30,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 25,
    "human_patch": "https://github.com/apache/struts/commit/f238cf4f1091be19fbcfd086b042c86a1bcaa7fc",
    "cve_id": "CVE-2016-3081",
    "cwe_id": "CWE-77",
    "filename": "core/src/test/java/com/opensymphony/xwork2/ognl/OgnlUtilTest.java",
    "is_vulnerable": 0,
    "class_name": "OgnlUtilTest",
    "subclass_name": null,
    "function_name": "testGetTopTarget() throws Exception",
    "function_body": "{\n        Foo foo = new Foo();\n        Map context = ognlUtil.createDefaultContext(foo);\n\n        CompoundRoot root = new CompoundRoot();\n        Object top = ognlUtil.getRealTarget(\"top\", context, root);\n        assertEquals(root, top); \n        \n        root.push(foo);\n        Object val = ognlUtil.getRealTarget(\"unknown\", context, root);\n        assertNull(val); \n    }"
  },
  {
    "id": 30,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 26,
    "human_patch": "https://github.com/apache/struts/commit/f238cf4f1091be19fbcfd086b042c86a1bcaa7fc",
    "cve_id": "CVE-2016-3081",
    "cwe_id": "CWE-77",
    "filename": "core/src/test/java/com/opensymphony/xwork2/ognl/OgnlUtilTest.java",
    "is_vulnerable": 0,
    "class_name": "OgnlUtilTest",
    "subclass_name": null,
    "function_name": "testGetBeanMap() throws Exception",
    "function_body": "{\n    \tBar bar = new Bar();\n    \tbar.setTitle(\"I have beer\");\n        \n    \tFoo foo = new Foo();\n        foo.setALong(123);\n        foo.setNumber(44);\n        foo.setBar(bar);\n        foo.setTitle(\"Hello Santa\");\n        foo.setUseful(true);\n        \n        \n        Map beans = ognlUtil.getBeanMap(foo);\n        assertNotNull(beans);\n        assertEquals(19, beans.size());\n        assertEquals(\"Hello Santa\", beans.get(\"title\"));\n        assertEquals(new Long(\"123\"), beans.get(\"ALong\"));\n        assertEquals(new Integer(\"44\"), beans.get(\"number\"));\n        assertEquals(bar, beans.get(\"bar\"));\n        assertEquals(Boolean.TRUE, beans.get(\"useful\"));\n    }"
  },
  {
    "id": 30,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 27,
    "human_patch": "https://github.com/apache/struts/commit/f238cf4f1091be19fbcfd086b042c86a1bcaa7fc",
    "cve_id": "CVE-2016-3081",
    "cwe_id": "CWE-77",
    "filename": "core/src/test/java/com/opensymphony/xwork2/ognl/OgnlUtilTest.java",
    "is_vulnerable": 0,
    "class_name": "OgnlUtilTest",
    "subclass_name": null,
    "function_name": "testGetBeanMapNoReadMethod() throws Exception",
    "function_body": "{\n    \tMyWriteBar bar = new MyWriteBar();\n    \tbar.setBar(\"Sams\");\n    \t\n    \tMap beans = ognlUtil.getBeanMap(bar);\n    \tassertEquals(2, beans.size());\n    \tassertEquals(new Integer(\"1\"), beans.get(\"id\"));\n    \tassertEquals(\"There is no read method for bar\", beans.get(\"bar\"));\n    }"
  },
  {
    "id": 30,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 28,
    "human_patch": "https://github.com/apache/struts/commit/f238cf4f1091be19fbcfd086b042c86a1bcaa7fc",
    "cve_id": "CVE-2016-3081",
    "cwe_id": "CWE-77",
    "filename": "core/src/test/java/com/opensymphony/xwork2/ognl/OgnlUtilTest.java",
    "is_vulnerable": 0,
    "class_name": "OgnlUtilTest",
    "subclass_name": null,
    "function_name": "testSetBigIndexedValue()",
    "function_body": "{\n        ValueStack stack = ActionContext.getContext().getValueStack();\n        Map stackContext = stack.getContext();\n        stackContext.put(ReflectionContextState.CREATE_NULL_OBJECTS, Boolean.FALSE);\n        stackContext.put(ReflectionContextState.DENY_METHOD_EXECUTION, Boolean.TRUE);\n        stackContext.put(XWorkConverter.REPORT_CONVERSION_ERRORS, Boolean.TRUE);\n\n        User user = new User();\n        stack.push(user);\n\n        \n        user.setList(new ArrayList());\n\n        String[] foo = new String[]{\"asdf\"};\n        ((OgnlValueStack)stack).setDevMode(\"true\");\n        try {\n            stack.setValue(\"list.1114778947765\", foo);\n            fail(\"non-valid expression: list.1114778947765\"); \n        }\n        catch(RuntimeException ex) {\n            ; \n        }\n        \n        try {\n            stack.setValue(\"1114778947765\", foo);\n            fail(\"non-valid expression: 1114778947765\"); \n        }\n        catch(RuntimeException ex) {\n            ;\n        }\n        \n        try {\n            stack.setValue(\"1234\", foo);\n            fail(\"non-valid expression: 1114778947765\"); \n        }\n        catch(RuntimeException ex) {\n            ;\n        }\n        \n        ((OgnlValueStack)stack).setDevMode(\"false\");\n        stack.setValue(\"list.1114778947765\", foo);\n        stack.setValue(\"1114778947765\", foo);\n        stack.setValue(\"1234\", foo);\n    }"
  },
  {
    "id": 30,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 29,
    "human_patch": "https://github.com/apache/struts/commit/f238cf4f1091be19fbcfd086b042c86a1bcaa7fc",
    "cve_id": "CVE-2016-3081",
    "cwe_id": "CWE-77",
    "filename": "core/src/test/java/com/opensymphony/xwork2/ognl/OgnlUtilTest.java",
    "is_vulnerable": 0,
    "class_name": "OgnlUtilTest",
    "subclass_name": null,
    "function_name": "testAvoidCallingMethodsOnObjectClass() throws Exception",
    "function_body": "{\n        Foo foo = new Foo();\n\n        Exception expected = null;\n        try {\n            ognlUtil.setExcludedClasses(Object.class.getName());\n            ognlUtil.setValue(\"class.classLoader.defaultAssertionStatus\", ognlUtil.createDefaultContext(foo), foo, true);\n            fail();\n        } catch (OgnlException e) {\n            expected = e;\n        }\n        assertNotNull(expected);\n        assertSame(NoSuchPropertyException.class, expected.getClass());\n        assertEquals(\"com.opensymphony.xwork2.util.Foo.class\", expected.getMessage());\n    }"
  },
  {
    "id": 30,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 30,
    "human_patch": "https://github.com/apache/struts/commit/f238cf4f1091be19fbcfd086b042c86a1bcaa7fc",
    "cve_id": "CVE-2016-3081",
    "cwe_id": "CWE-77",
    "filename": "core/src/test/java/com/opensymphony/xwork2/ognl/OgnlUtilTest.java",
    "is_vulnerable": 0,
    "class_name": "OgnlUtilTest",
    "subclass_name": null,
    "function_name": "testAvoidCallingMethodsOnObjectClassUpperCased() throws Exception",
    "function_body": "{\n        Foo foo = new Foo();\n\n        Exception expected = null;\n        try {\n            ognlUtil.setExcludedClasses(Object.class.getName());\n            ognlUtil.setValue(\"Class.ClassLoader.DefaultAssertionStatus\", ognlUtil.createDefaultContext(foo), foo, true);\n            fail();\n        } catch (OgnlException e) {\n            expected = e;\n        }\n        assertNotNull(expected);\n        assertSame(NoSuchPropertyException.class, expected.getClass());\n        assertEquals(\"com.opensymphony.xwork2.util.Foo.Class\", expected.getMessage());\n    }"
  },
  {
    "id": 30,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 31,
    "human_patch": "https://github.com/apache/struts/commit/f238cf4f1091be19fbcfd086b042c86a1bcaa7fc",
    "cve_id": "CVE-2016-3081",
    "cwe_id": "CWE-77",
    "filename": "core/src/test/java/com/opensymphony/xwork2/ognl/OgnlUtilTest.java",
    "is_vulnerable": 0,
    "class_name": "OgnlUtilTest",
    "subclass_name": null,
    "function_name": "testAvoidCallingMethodsOnObjectClassAsMap() throws Exception",
    "function_body": "{\n        Foo foo = new Foo();\n\n        Exception expected = null;\n        try {\n            ognlUtil.setExcludedClasses(Object.class.getName());\n            ognlUtil.setValue(\"class['classLoader']['defaultAssertionStatus']\", ognlUtil.createDefaultContext(foo), foo, true);\n            fail();\n        } catch (OgnlException e) {\n            expected = e;\n        }\n        assertNotNull(expected);\n        assertSame(NoSuchPropertyException.class, expected.getClass());\n        assertEquals(\"com.opensymphony.xwork2.util.Foo.class\", expected.getMessage());\n    }"
  },
  {
    "id": 30,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 32,
    "human_patch": "https://github.com/apache/struts/commit/f238cf4f1091be19fbcfd086b042c86a1bcaa7fc",
    "cve_id": "CVE-2016-3081",
    "cwe_id": "CWE-77",
    "filename": "core/src/test/java/com/opensymphony/xwork2/ognl/OgnlUtilTest.java",
    "is_vulnerable": 0,
    "class_name": "OgnlUtilTest",
    "subclass_name": null,
    "function_name": "testAvoidCallingMethodsOnObjectClassAsMap2() throws Exception",
    "function_body": "{\n        Foo foo = new Foo();\n\n        Exception expected = null;\n        try {\n            ognlUtil.setValue(\"foo['class']['classLoader']['defaultAssertionStatus']\", ognlUtil.createDefaultContext(foo), foo, true);\n            fail();\n        } catch (OgnlException e) {\n            expected = e;\n        }\n        assertNotNull(expected);\n        assertSame(NoSuchPropertyException.class, expected.getClass());\n        assertEquals(\"com.opensymphony.xwork2.util.Foo.foo\", expected.getMessage());\n    }"
  },
  {
    "id": 30,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 33,
    "human_patch": "https://github.com/apache/struts/commit/f238cf4f1091be19fbcfd086b042c86a1bcaa7fc",
    "cve_id": "CVE-2016-3081",
    "cwe_id": "CWE-77",
    "filename": "core/src/test/java/com/opensymphony/xwork2/ognl/OgnlUtilTest.java",
    "is_vulnerable": 0,
    "class_name": "OgnlUtilTest",
    "subclass_name": null,
    "function_name": "testAvoidCallingMethodsOnObjectClassAsMapWithQuotes() throws Exception",
    "function_body": "{\n        Foo foo = new Foo();\n\n        Exception expected = null;\n        try {\n            ognlUtil.setExcludedClasses(Object.class.getName());\n            ognlUtil.setValue(\"class[\\\"classLoader\\\"]['defaultAssertionStatus']\", ognlUtil.createDefaultContext(foo), foo, true);\n            fail();\n        } catch (OgnlException e) {\n            expected = e;\n        }\n        assertNotNull(expected);\n        assertSame(NoSuchPropertyException.class, expected.getClass());\n        assertEquals(\"com.opensymphony.xwork2.util.Foo.class\", expected.getMessage());\n    }"
  },
  {
    "id": 30,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 34,
    "human_patch": "https://github.com/apache/struts/commit/f238cf4f1091be19fbcfd086b042c86a1bcaa7fc",
    "cve_id": "CVE-2016-3081",
    "cwe_id": "CWE-77",
    "filename": "core/src/test/java/com/opensymphony/xwork2/ognl/OgnlUtilTest.java",
    "is_vulnerable": 0,
    "class_name": "OgnlUtilTest",
    "subclass_name": null,
    "function_name": "testAvoidCallingToString() throws Exception",
    "function_body": "{\n        Foo foo = new Foo();\n\n        Exception expected = null;\n        try {\n            ognlUtil.setValue(\"toString\", ognlUtil.createDefaultContext(foo), foo, null);\n            fail();\n        } catch (OgnlException e) {\n            expected = e;\n        }\n        assertNotNull(expected);\n        assertSame(OgnlException.class, expected.getClass());\n        assertEquals(\"toString\", expected.getMessage());\n    }"
  },
  {
    "id": 30,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 35,
    "human_patch": "https://github.com/apache/struts/commit/f238cf4f1091be19fbcfd086b042c86a1bcaa7fc",
    "cve_id": "CVE-2016-3081",
    "cwe_id": "CWE-77",
    "filename": "core/src/test/java/com/opensymphony/xwork2/ognl/OgnlUtilTest.java",
    "is_vulnerable": 0,
    "class_name": "OgnlUtilTest",
    "subclass_name": null,
    "function_name": "testAvoidCallingMethodsWithBraces() throws Exception",
    "function_body": "{\n        Foo foo = new Foo();\n\n        Exception expected = null;\n        try {\n            ognlUtil.setValue(\"toString()\", ognlUtil.createDefaultContext(foo), foo, true);\n            fail();\n        } catch (OgnlException e) {\n            expected = e;\n        }\n        assertNotNull(expected);\n        assertSame(InappropriateExpressionException.class, expected.getClass());\n        assertEquals(expected.getMessage(), \"Inappropriate OGNL expression: toString()\");\n    }"
  },
  {
    "id": 30,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 36,
    "human_patch": "https://github.com/apache/struts/commit/f238cf4f1091be19fbcfd086b042c86a1bcaa7fc",
    "cve_id": "CVE-2016-3081",
    "cwe_id": "CWE-77",
    "filename": "core/src/test/java/com/opensymphony/xwork2/ognl/OgnlUtilTest.java",
    "is_vulnerable": 0,
    "class_name": "OgnlUtilTest",
    "subclass_name": null,
    "function_name": "testAvoidCallingSomeClasses() throws Exception",
    "function_body": "{\n        Foo foo = new Foo();\n\n        Exception expected = null;\n        try {\n            ognlUtil.setExcludedClasses(Runtime.class.getName());\n            ognlUtil.setValue(\"@java.lang.Runtime@getRuntime().exec('mate')\", ognlUtil.createDefaultContext(foo), foo, true);\n            fail();\n        } catch (OgnlException e) {\n            expected = e;\n        }\n        assertNotNull(expected);\n        assertSame(MethodFailedException.class, expected.getClass());\n        assertEquals(expected.getMessage(), \"Method \\\"getRuntime\\\" failed for object class java.lang.Runtime\");\n    }"
  },
  {
    "id": 30,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 37,
    "human_patch": "https://github.com/apache/struts/commit/f238cf4f1091be19fbcfd086b042c86a1bcaa7fc",
    "cve_id": "CVE-2016-3081",
    "cwe_id": "CWE-77",
    "filename": "core/src/test/java/com/opensymphony/xwork2/ognl/OgnlUtilTest.java",
    "is_vulnerable": 0,
    "class_name": "OgnlUtilTest",
    "subclass_name": "Email",
    "function_name": "setAddress(String address)",
    "function_body": "{\n            this.address = address;\n        }"
  },
  {
    "id": 30,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 38,
    "human_patch": "https://github.com/apache/struts/commit/f238cf4f1091be19fbcfd086b042c86a1bcaa7fc",
    "cve_id": "CVE-2016-3081",
    "cwe_id": "CWE-77",
    "filename": "core/src/test/java/com/opensymphony/xwork2/ognl/OgnlUtilTest.java",
    "is_vulnerable": 0,
    "class_name": "OgnlUtilTest",
    "subclass_name": "Email",
    "function_name": "toString()",
    "function_body": "{\n            return address;\n        }"
  },
  {
    "id": 30,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 39,
    "human_patch": "https://github.com/apache/struts/commit/f238cf4f1091be19fbcfd086b042c86a1bcaa7fc",
    "cve_id": "CVE-2016-3081",
    "cwe_id": "CWE-77",
    "filename": "core/src/test/java/com/opensymphony/xwork2/ognl/OgnlUtilTest.java",
    "is_vulnerable": 0,
    "class_name": "OgnlUtilTest",
    "subclass_name": "TestObject",
    "function_name": "setMyIntegerProperty(Integer myIntegerProperty)",
    "function_body": "{\n            this.myIntegerProperty = myIntegerProperty;\n        }"
  },
  {
    "id": 30,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 40,
    "human_patch": "https://github.com/apache/struts/commit/f238cf4f1091be19fbcfd086b042c86a1bcaa7fc",
    "cve_id": "CVE-2016-3081",
    "cwe_id": "CWE-77",
    "filename": "core/src/test/java/com/opensymphony/xwork2/ognl/OgnlUtilTest.java",
    "is_vulnerable": 0,
    "class_name": "OgnlUtilTest",
    "subclass_name": "TestObject",
    "function_name": "getMyIntegerProperty()",
    "function_body": "{\n            return myIntegerProperty.toString();\n        }"
  },
  {
    "id": 30,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 41,
    "human_patch": "https://github.com/apache/struts/commit/f238cf4f1091be19fbcfd086b042c86a1bcaa7fc",
    "cve_id": "CVE-2016-3081",
    "cwe_id": "CWE-77",
    "filename": "core/src/test/java/com/opensymphony/xwork2/ognl/OgnlUtilTest.java",
    "is_vulnerable": 0,
    "class_name": "OgnlUtilTest",
    "subclass_name": "TestObject",
    "function_name": "setMyLongProperty(Long myLongProperty)",
    "function_body": "{\n            this.myLongProperty = myLongProperty;\n        }"
  },
  {
    "id": 30,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 42,
    "human_patch": "https://github.com/apache/struts/commit/f238cf4f1091be19fbcfd086b042c86a1bcaa7fc",
    "cve_id": "CVE-2016-3081",
    "cwe_id": "CWE-77",
    "filename": "core/src/test/java/com/opensymphony/xwork2/ognl/OgnlUtilTest.java",
    "is_vulnerable": 0,
    "class_name": "OgnlUtilTest",
    "subclass_name": "TestObject",
    "function_name": "getMyLongProperty()",
    "function_body": "{\n            return myLongProperty;\n        }"
  },
  {
    "id": 30,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 43,
    "human_patch": "https://github.com/apache/struts/commit/f238cf4f1091be19fbcfd086b042c86a1bcaa7fc",
    "cve_id": "CVE-2016-3081",
    "cwe_id": "CWE-77",
    "filename": "core/src/test/java/com/opensymphony/xwork2/ognl/OgnlUtilTest.java",
    "is_vulnerable": 0,
    "class_name": "OgnlUtilTest",
    "subclass_name": "TestObject",
    "function_name": "setMyStrProperty(String myStrProperty)",
    "function_body": "{\n            this.myStrProperty = myStrProperty;\n        }"
  },
  {
    "id": 30,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 44,
    "human_patch": "https://github.com/apache/struts/commit/f238cf4f1091be19fbcfd086b042c86a1bcaa7fc",
    "cve_id": "CVE-2016-3081",
    "cwe_id": "CWE-77",
    "filename": "core/src/test/java/com/opensymphony/xwork2/ognl/OgnlUtilTest.java",
    "is_vulnerable": 0,
    "class_name": "OgnlUtilTest",
    "subclass_name": "TestObject",
    "function_name": "getMyStrProperty()",
    "function_body": "{\n            return myStrProperty;\n        }"
  },
  {
    "id": 30,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 45,
    "human_patch": "https://github.com/apache/struts/commit/f238cf4f1091be19fbcfd086b042c86a1bcaa7fc",
    "cve_id": "CVE-2016-3081",
    "cwe_id": "CWE-77",
    "filename": "core/src/test/java/com/opensymphony/xwork2/ognl/OgnlUtilTest.java",
    "is_vulnerable": 0,
    "class_name": "OgnlUtilTest",
    "subclass_name": "EmailAction",
    "function_name": "getEmail()",
    "function_body": "{\n            return this.email;\n        }"
  },
  {
    "id": 30,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 46,
    "human_patch": "https://github.com/apache/struts/commit/f238cf4f1091be19fbcfd086b042c86a1bcaa7fc",
    "cve_id": "CVE-2016-3081",
    "cwe_id": "CWE-77",
    "filename": "core/src/test/java/com/opensymphony/xwork2/ognl/OgnlUtilTest.java",
    "is_vulnerable": 0,
    "class_name": "OgnlUtilTest",
    "subclass_name": "OgnlList",
    "function_name": "get(int index)",
    "function_body": "{\n            while (index >= this.size()) {\n                try {\n                    this.add(clazz.newInstance());\n                } catch (Exception e) {\n                    throw new XWorkException(e);\n                }\n            }\n\n            return super.get(index);\n        }"
  },
  {
    "id": 30,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 47,
    "human_patch": "https://github.com/apache/struts/commit/f238cf4f1091be19fbcfd086b042c86a1bcaa7fc",
    "cve_id": "CVE-2016-3081",
    "cwe_id": "CWE-77",
    "filename": "core/src/test/java/com/opensymphony/xwork2/ognl/OgnlUtilTest.java",
    "is_vulnerable": 0,
    "class_name": "OgnlUtilTest",
    "subclass_name": "MyWriteBar",
    "function_name": "getId()",
    "function_body": "{\n    \t\treturn id;\n    \t}"
  },
  {
    "id": 30,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 48,
    "human_patch": "https://github.com/apache/struts/commit/f238cf4f1091be19fbcfd086b042c86a1bcaa7fc",
    "cve_id": "CVE-2016-3081",
    "cwe_id": "CWE-77",
    "filename": "core/src/test/java/com/opensymphony/xwork2/ognl/OgnlUtilTest.java",
    "is_vulnerable": 0,
    "class_name": "OgnlUtilTest",
    "subclass_name": "MyWriteBar",
    "function_name": "setBar(String name)",
    "function_body": "{\n    \t\tif (\"Sams\".equals(name))\n    \t\t\tid = 1;\n    \t\telse\n    \t\t\tid = 999;\n    \t}"
  },
  {
    "id": 31,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 0,
    "human_patch": "https://github.com/apache/struts/commit/fc2179cf1ac9fbfb61e3430fa88b641d87253327",
    "cve_id": "CVE-2016-2162",
    "cwe_id": "CWE-79",
    "filename": "core/src/main/java/com/opensymphony/xwork2/interceptor/I18nInterceptor.java",
    "is_vulnerable": 0,
    "class_name": "I18nInterceptor",
    "subclass_name": null,
    "function_name": "setParameterName(String parameterName)",
    "function_body": "{\n        this.parameterName = parameterName;\n    }"
  },
  {
    "id": 31,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 1,
    "human_patch": "https://github.com/apache/struts/commit/fc2179cf1ac9fbfb61e3430fa88b641d87253327",
    "cve_id": "CVE-2016-2162",
    "cwe_id": "CWE-79",
    "filename": "core/src/main/java/com/opensymphony/xwork2/interceptor/I18nInterceptor.java",
    "is_vulnerable": 0,
    "class_name": "I18nInterceptor",
    "subclass_name": null,
    "function_name": "setRequestOnlyParameterName(String requestOnlyParameterName)",
    "function_body": "{\n        this.requestOnlyParameterName = requestOnlyParameterName;\n    }"
  },
  {
    "id": 31,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 2,
    "human_patch": "https://github.com/apache/struts/commit/fc2179cf1ac9fbfb61e3430fa88b641d87253327",
    "cve_id": "CVE-2016-2162",
    "cwe_id": "CWE-79",
    "filename": "core/src/main/java/com/opensymphony/xwork2/interceptor/I18nInterceptor.java",
    "is_vulnerable": 0,
    "class_name": "I18nInterceptor",
    "subclass_name": null,
    "function_name": "setAttributeName(String attributeName)",
    "function_body": "{\n        this.attributeName = attributeName;\n    }"
  },
  {
    "id": 31,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 3,
    "human_patch": "https://github.com/apache/struts/commit/fc2179cf1ac9fbfb61e3430fa88b641d87253327",
    "cve_id": "CVE-2016-2162",
    "cwe_id": "CWE-79",
    "filename": "core/src/main/java/com/opensymphony/xwork2/interceptor/I18nInterceptor.java",
    "is_vulnerable": 0,
    "class_name": "I18nInterceptor",
    "subclass_name": null,
    "function_name": "intercept(ActionInvocation invocation) throws Exception",
    "function_body": "{\n        if (LOG.isDebugEnabled()) {\n            LOG.debug(\"Intercept '{}/{}' {\", invocation.getProxy().getNamespace(), invocation.getProxy().getActionName());\n        }\n\n        LocaleFinder localeFinder = new LocaleFinder(invocation);\n        Locale locale = getLocaleFromParam(localeFinder.getRequestedLocale());\n        locale = storeLocale(invocation, locale, localeFinder.getStorage());\n        saveLocale(invocation, locale);\n\n        if (LOG.isDebugEnabled()) {\n            LOG.debug(\"before Locale: {}\", invocation.getStack().findValue(\"locale\"));\n        }\n\n        final String result = invocation.invoke();\n\n        if (LOG.isDebugEnabled()) {\n            LOG.debug(\"after Locale {}\", invocation.getStack().findValue(\"locale\"));\n            LOG.debug(\"intercept } \");\n        }\n\n        return result;\n    }"
  },
  {
    "id": 31,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 4,
    "human_patch": "https://github.com/apache/struts/commit/fc2179cf1ac9fbfb61e3430fa88b641d87253327",
    "cve_id": "CVE-2016-2162",
    "cwe_id": "CWE-79",
    "filename": "core/src/main/java/com/opensymphony/xwork2/interceptor/I18nInterceptor.java",
    "is_vulnerable": 0,
    "class_name": "I18nInterceptor",
    "subclass_name": null,
    "function_name": "storeLocale(ActionInvocation invocation, Locale locale, String storage)",
    "function_body": "{\n        \n        Map<String, Object> session = invocation.getInvocationContext().getSession();\n\n        if (session != null) {\n            synchronized (session) {\n                if (locale == null) {\n                    storage = Storage.NONE.toString();\n                    locale = readStoredLocale(invocation, session);\n                }\n\n                if (Storage.SESSION.toString().equals(storage)) {\n                    session.put(attributeName, locale);\n                }\n            }\n        }\n        return locale;\n    }"
  },
  {
    "id": 31,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 5,
    "human_patch": "https://github.com/apache/struts/commit/fc2179cf1ac9fbfb61e3430fa88b641d87253327",
    "cve_id": "CVE-2016-2162",
    "cwe_id": "CWE-79",
    "filename": "core/src/main/java/com/opensymphony/xwork2/interceptor/I18nInterceptor.java",
    "is_vulnerable": 0,
    "class_name": "I18nInterceptor",
    "subclass_name": "LocaleFinder",
    "function_name": "find()",
    "function_body": "{\n            \n            Map<String, Object> params = actionInvocation.getInvocationContext().getParameters();\n\n            storage = Storage.SESSION.toString();\n\n            requestedLocale = findLocaleParameter(params, parameterName);\n            if (requestedLocale != null) {\n                return;\n            }\n\n            requestedLocale = findLocaleParameter(params, requestOnlyParameterName);\n            if (requestedLocale != null) {\n                storage = Storage.NONE.toString();\n            }\n        }"
  },
  {
    "id": 31,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 6,
    "human_patch": "https://github.com/apache/struts/commit/fc2179cf1ac9fbfb61e3430fa88b641d87253327",
    "cve_id": "CVE-2016-2162",
    "cwe_id": "CWE-79",
    "filename": "core/src/main/java/com/opensymphony/xwork2/interceptor/I18nInterceptor.java",
    "is_vulnerable": 0,
    "class_name": "I18nInterceptor",
    "subclass_name": "LocaleFinder",
    "function_name": "getStorage()",
    "function_body": "{\n            return storage;\n        }"
  },
  {
    "id": 31,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 7,
    "human_patch": "https://github.com/apache/struts/commit/fc2179cf1ac9fbfb61e3430fa88b641d87253327",
    "cve_id": "CVE-2016-2162",
    "cwe_id": "CWE-79",
    "filename": "core/src/main/java/com/opensymphony/xwork2/interceptor/I18nInterceptor.java",
    "is_vulnerable": 0,
    "class_name": "I18nInterceptor",
    "subclass_name": "LocaleFinder",
    "function_name": "getRequestedLocale()",
    "function_body": "{\n            return requestedLocale;\n        }"
  },
  {
    "id": 31,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 8,
    "human_patch": "https://github.com/apache/struts/commit/fc2179cf1ac9fbfb61e3430fa88b641d87253327",
    "cve_id": "CVE-2016-2162",
    "cwe_id": "CWE-79",
    "filename": "core/src/main/java/com/opensymphony/xwork2/interceptor/I18nInterceptor.java",
    "is_vulnerable": 1,
    "class_name": "I18nInterceptor",
    "subclass_name": null,
    "function_name": "getLocaleFromParam(Object requestedLocale)",
    "function_body": "{\n        Locale locale = null;\n        if (requestedLocale != null) {\n            locale = (requestedLocale instanceof Locale) ?\n                    (Locale) requestedLocale :\n                    LocalizedTextUtil.localeFromString(requestedLocale.toString(), null);\n            if (locale != null) {\n                LOG.debug(\"Applied request locale: {}\", locale);\n            }\n        }\n        return locale;\n    }"
  },
  {
    "id": 31,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 9,
    "human_patch": "https://github.com/apache/struts/commit/fc2179cf1ac9fbfb61e3430fa88b641d87253327",
    "cve_id": "CVE-2016-2162",
    "cwe_id": "CWE-79",
    "filename": "core/src/main/java/com/opensymphony/xwork2/interceptor/I18nInterceptor.java",
    "is_vulnerable": 0,
    "class_name": "I18nInterceptor",
    "subclass_name": null,
    "function_name": "readStoredLocale(ActionInvocation invocation, Map<String, Object> session)",
    "function_body": "{\n        Locale locale = this.readStoredLocalFromSession(invocation, session);\n\n        if (locale != null) {\n            return locale;\n        }\n\n        return this.readStoredLocalFromCurrentInvocation(invocation);\n    }"
  },
  {
    "id": 31,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 10,
    "human_patch": "https://github.com/apache/struts/commit/fc2179cf1ac9fbfb61e3430fa88b641d87253327",
    "cve_id": "CVE-2016-2162",
    "cwe_id": "CWE-79",
    "filename": "core/src/main/java/com/opensymphony/xwork2/interceptor/I18nInterceptor.java",
    "is_vulnerable": 0,
    "class_name": "I18nInterceptor",
    "subclass_name": null,
    "function_name": "readStoredLocalFromSession(ActionInvocation invocation, Map<String, Object> session)",
    "function_body": "{\n         \n        Object sessionLocale = session.get(attributeName);\n        if (sessionLocale != null && sessionLocale instanceof Locale) {\n            Locale locale = (Locale) sessionLocale;\n            LOG.debug(\"Applied session locale: {}\", locale);\n            return locale;\n        }\n        return null;\n    }"
  },
  {
    "id": 31,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 11,
    "human_patch": "https://github.com/apache/struts/commit/fc2179cf1ac9fbfb61e3430fa88b641d87253327",
    "cve_id": "CVE-2016-2162",
    "cwe_id": "CWE-79",
    "filename": "core/src/main/java/com/opensymphony/xwork2/interceptor/I18nInterceptor.java",
    "is_vulnerable": 0,
    "class_name": "I18nInterceptor",
    "subclass_name": null,
    "function_name": "readStoredLocalFromCurrentInvocation(ActionInvocation invocation)",
    "function_body": "{\n        \n        Locale locale = invocation.getInvocationContext().getLocale();\n        if (locale != null) {\n            LOG.debug(\"Applied invocation context locale: {}\", locale);\n        }\n        return locale;\n    }"
  },
  {
    "id": 31,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 12,
    "human_patch": "https://github.com/apache/struts/commit/fc2179cf1ac9fbfb61e3430fa88b641d87253327",
    "cve_id": "CVE-2016-2162",
    "cwe_id": "CWE-79",
    "filename": "core/src/main/java/com/opensymphony/xwork2/interceptor/I18nInterceptor.java",
    "is_vulnerable": 0,
    "class_name": "I18nInterceptor",
    "subclass_name": null,
    "function_name": "findLocaleParameter(Map<String, Object> params, String parameterName)",
    "function_body": "{\n        Object requestedLocale = params.remove(parameterName);\n        if (requestedLocale != null && requestedLocale.getClass().isArray()\n                && ((Object[]) requestedLocale).length > 0) {\n            requestedLocale = ((Object[]) requestedLocale)[0];\n\n            LOG.debug(\"Requested locale: {}\", requestedLocale);\n        }\n        return requestedLocale;\n    }"
  },
  {
    "id": 31,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 13,
    "human_patch": "https://github.com/apache/struts/commit/fc2179cf1ac9fbfb61e3430fa88b641d87253327",
    "cve_id": "CVE-2016-2162",
    "cwe_id": "CWE-79",
    "filename": "core/src/main/java/com/opensymphony/xwork2/interceptor/I18nInterceptor.java",
    "is_vulnerable": 0,
    "class_name": "I18nInterceptor",
    "subclass_name": null,
    "function_name": "saveLocale(ActionInvocation invocation, Locale locale)",
    "function_body": "{\n        invocation.getInvocationContext().setLocale(locale);\n    }"
  },
  {
    "id": 31,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 0,
    "human_patch": "https://github.com/apache/struts/commit/fc2179cf1ac9fbfb61e3430fa88b641d87253327",
    "cve_id": "CVE-2016-2162",
    "cwe_id": "CWE-79",
    "filename": "core/src/test/java/com/opensymphony/xwork2/interceptor/I18nInterceptorTest.java",
    "is_vulnerable": 0,
    "class_name": "I18nInterceptorTest",
    "subclass_name": null,
    "function_name": "testEmptyParamAndSession() throws Exception",
    "function_body": "{\n        interceptor.intercept(mai);\n    }"
  },
  {
    "id": 31,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 1,
    "human_patch": "https://github.com/apache/struts/commit/fc2179cf1ac9fbfb61e3430fa88b641d87253327",
    "cve_id": "CVE-2016-2162",
    "cwe_id": "CWE-79",
    "filename": "core/src/test/java/com/opensymphony/xwork2/interceptor/I18nInterceptorTest.java",
    "is_vulnerable": 0,
    "class_name": "I18nInterceptorTest",
    "subclass_name": null,
    "function_name": "testNoSession() throws Exception",
    "function_body": "{\n        ac.setSession(null);\n        interceptor.intercept(mai);\n    }"
  },
  {
    "id": 31,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 2,
    "human_patch": "https://github.com/apache/struts/commit/fc2179cf1ac9fbfb61e3430fa88b641d87253327",
    "cve_id": "CVE-2016-2162",
    "cwe_id": "CWE-79",
    "filename": "core/src/test/java/com/opensymphony/xwork2/interceptor/I18nInterceptorTest.java",
    "is_vulnerable": 0,
    "class_name": "I18nInterceptorTest",
    "subclass_name": null,
    "function_name": "testDefaultLocale() throws Exception",
    "function_body": "{\n        params.put(I18nInterceptor.DEFAULT_PARAMETER, \"_\"); \n        interceptor.intercept(mai);\n\n        assertNull(params.get(I18nInterceptor.DEFAULT_PARAMETER)); \n\n        assertNotNull(session.get(I18nInterceptor.DEFAULT_SESSION_ATTRIBUTE)); \n        assertEquals(Locale.getDefault(), session.get(I18nInterceptor.DEFAULT_SESSION_ATTRIBUTE)); \n    }"
  },
  {
    "id": 31,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 3,
    "human_patch": "https://github.com/apache/struts/commit/fc2179cf1ac9fbfb61e3430fa88b641d87253327",
    "cve_id": "CVE-2016-2162",
    "cwe_id": "CWE-79",
    "filename": "core/src/test/java/com/opensymphony/xwork2/interceptor/I18nInterceptorTest.java",
    "is_vulnerable": 0,
    "class_name": "I18nInterceptorTest",
    "subclass_name": null,
    "function_name": "testDenmarkLocale() throws Exception",
    "function_body": "{\n        params.put(I18nInterceptor.DEFAULT_PARAMETER, \"da_DK\");\n        interceptor.intercept(mai);\n\n        assertNull(params.get(I18nInterceptor.DEFAULT_PARAMETER)); \n\n        Locale denmark = new Locale(\"da\", \"DK\");\n        assertNotNull(session.get(I18nInterceptor.DEFAULT_SESSION_ATTRIBUTE)); \n        assertEquals(denmark, session.get(I18nInterceptor.DEFAULT_SESSION_ATTRIBUTE)); \n    }"
  },
  {
    "id": 31,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 4,
    "human_patch": "https://github.com/apache/struts/commit/fc2179cf1ac9fbfb61e3430fa88b641d87253327",
    "cve_id": "CVE-2016-2162",
    "cwe_id": "CWE-79",
    "filename": "core/src/test/java/com/opensymphony/xwork2/interceptor/I18nInterceptorTest.java",
    "is_vulnerable": 0,
    "class_name": "I18nInterceptorTest",
    "subclass_name": null,
    "function_name": "testDenmarkLocaleRequestOnly() throws Exception",
    "function_body": "{\n        params.put(I18nInterceptor.DEFAULT_REQUESTONLY_PARAMETER, \"da_DK\");\n        interceptor.intercept(mai);\n\n        assertNull(params.get(I18nInterceptor.DEFAULT_PARAMETER)); \n\n        Locale denmark = new Locale(\"da\", \"DK\");\n        assertNull(session.get(I18nInterceptor.DEFAULT_SESSION_ATTRIBUTE)); \n        assertEquals(denmark, mai.getInvocationContext().getLocale()); \n    }"
  },
  {
    "id": 31,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 5,
    "human_patch": "https://github.com/apache/struts/commit/fc2179cf1ac9fbfb61e3430fa88b641d87253327",
    "cve_id": "CVE-2016-2162",
    "cwe_id": "CWE-79",
    "filename": "core/src/test/java/com/opensymphony/xwork2/interceptor/I18nInterceptorTest.java",
    "is_vulnerable": 1,
    "class_name": "I18nInterceptorTest",
    "subclass_name": null,
    "function_name": "testCountryOnlyLocale() throws Exception",
    "function_body": "{\n        params.put(I18nInterceptor.DEFAULT_PARAMETER, \"DK\");\n        interceptor.intercept(mai);\n\n        assertNull(params.get(I18nInterceptor.DEFAULT_PARAMETER)); \n\n        Locale denmark = new Locale(\"DK\");\n        assertNotNull(session.get(I18nInterceptor.DEFAULT_SESSION_ATTRIBUTE)); \n        assertEquals(denmark, session.get(I18nInterceptor.DEFAULT_SESSION_ATTRIBUTE)); \n    }"
  },
  {
    "id": 31,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 6,
    "human_patch": "https://github.com/apache/struts/commit/fc2179cf1ac9fbfb61e3430fa88b641d87253327",
    "cve_id": "CVE-2016-2162",
    "cwe_id": "CWE-79",
    "filename": "core/src/test/java/com/opensymphony/xwork2/interceptor/I18nInterceptorTest.java",
    "is_vulnerable": 0,
    "class_name": "I18nInterceptorTest",
    "subclass_name": null,
    "function_name": "testLanguageOnlyLocale() throws Exception",
    "function_body": "{\n        params.put(I18nInterceptor.DEFAULT_PARAMETER, \"da_\");\n        interceptor.intercept(mai);\n\n        assertNull(params.get(I18nInterceptor.DEFAULT_PARAMETER)); \n\n        Locale denmark = new Locale(\"da\");\n        assertNotNull(session.get(I18nInterceptor.DEFAULT_SESSION_ATTRIBUTE)); \n        assertEquals(denmark, session.get(I18nInterceptor.DEFAULT_SESSION_ATTRIBUTE)); \n    }"
  },
  {
    "id": 31,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 7,
    "human_patch": "https://github.com/apache/struts/commit/fc2179cf1ac9fbfb61e3430fa88b641d87253327",
    "cve_id": "CVE-2016-2162",
    "cwe_id": "CWE-79",
    "filename": "core/src/test/java/com/opensymphony/xwork2/interceptor/I18nInterceptorTest.java",
    "is_vulnerable": 1,
    "class_name": "I18nInterceptorTest",
    "subclass_name": null,
    "function_name": "testWithVariant() throws Exception",
    "function_body": "{\n        params.put(I18nInterceptor.DEFAULT_PARAMETER, \"fr_CA_xx\");\n        interceptor.intercept(mai);\n\n        assertNull(params.get(I18nInterceptor.DEFAULT_PARAMETER)); \n\n        Locale variant = new Locale(\"fr\", \"CA\", \"xx\");\n        Locale locale = (Locale) session.get(I18nInterceptor.DEFAULT_SESSION_ATTRIBUTE);\n        assertNotNull(locale); \n        assertEquals(variant, locale);\n        assertEquals(\"xx\", locale.getVariant());\n    }"
  },
  {
    "id": 31,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 8,
    "human_patch": "https://github.com/apache/struts/commit/fc2179cf1ac9fbfb61e3430fa88b641d87253327",
    "cve_id": "CVE-2016-2162",
    "cwe_id": "CWE-79",
    "filename": "core/src/test/java/com/opensymphony/xwork2/interceptor/I18nInterceptorTest.java",
    "is_vulnerable": 1,
    "class_name": "I18nInterceptorTest",
    "subclass_name": null,
    "function_name": "testWithVariantRequestOnly() throws Exception",
    "function_body": "{\n        params.put(I18nInterceptor.DEFAULT_REQUESTONLY_PARAMETER, \"fr_CA_xx\");\n        interceptor.intercept(mai);\n\n        assertNull(params.get(I18nInterceptor.DEFAULT_PARAMETER)); \n        assertNull(session.get(I18nInterceptor.DEFAULT_SESSION_ATTRIBUTE));\n\n        Locale variant = new Locale(\"fr\", \"CA\", \"xx\");\n        Locale locale = mai.getInvocationContext().getLocale();\n        assertNotNull(locale); \n        assertEquals(variant, locale);\n        assertEquals(\"xx\", locale.getVariant());\n    }"
  },
  {
    "id": 31,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 9,
    "human_patch": "https://github.com/apache/struts/commit/fc2179cf1ac9fbfb61e3430fa88b641d87253327",
    "cve_id": "CVE-2016-2162",
    "cwe_id": "CWE-79",
    "filename": "core/src/test/java/com/opensymphony/xwork2/interceptor/I18nInterceptorTest.java",
    "is_vulnerable": 0,
    "class_name": "I18nInterceptorTest",
    "subclass_name": null,
    "function_name": "testRealLocaleObjectInParams() throws Exception",
    "function_body": "{\n        params.put(I18nInterceptor.DEFAULT_PARAMETER, Locale.CANADA_FRENCH);\n        interceptor.intercept(mai);\n\n        assertNull(params.get(I18nInterceptor.DEFAULT_PARAMETER)); \n\n        assertNotNull(session.get(I18nInterceptor.DEFAULT_SESSION_ATTRIBUTE)); \n        assertEquals(Locale.CANADA_FRENCH, session.get(I18nInterceptor.DEFAULT_SESSION_ATTRIBUTE)); \n    }"
  },
  {
    "id": 31,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 10,
    "human_patch": "https://github.com/apache/struts/commit/fc2179cf1ac9fbfb61e3430fa88b641d87253327",
    "cve_id": "CVE-2016-2162",
    "cwe_id": "CWE-79",
    "filename": "core/src/test/java/com/opensymphony/xwork2/interceptor/I18nInterceptorTest.java",
    "is_vulnerable": 0,
    "class_name": "I18nInterceptorTest",
    "subclass_name": null,
    "function_name": "testRealLocalesInParams() throws Exception",
    "function_body": "{\n        Locale[] locales = new Locale[] { Locale.CANADA_FRENCH };\n        assertTrue(locales.getClass().isArray());\n        params.put(I18nInterceptor.DEFAULT_PARAMETER, locales);\n        interceptor.intercept(mai);\n\n        assertNull(params.get(I18nInterceptor.DEFAULT_PARAMETER)); \n\n        assertNotNull(session.get(I18nInterceptor.DEFAULT_SESSION_ATTRIBUTE)); \n        assertEquals(Locale.CANADA_FRENCH, session.get(I18nInterceptor.DEFAULT_SESSION_ATTRIBUTE));\n    }"
  },
  {
    "id": 31,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 11,
    "human_patch": "https://github.com/apache/struts/commit/fc2179cf1ac9fbfb61e3430fa88b641d87253327",
    "cve_id": "CVE-2016-2162",
    "cwe_id": "CWE-79",
    "filename": "core/src/test/java/com/opensymphony/xwork2/interceptor/I18nInterceptorTest.java",
    "is_vulnerable": 0,
    "class_name": "I18nInterceptorTest",
    "subclass_name": null,
    "function_name": "testSetParameterAndAttributeNames() throws Exception",
    "function_body": "{\n        interceptor.setAttributeName(\"hello\");\n        interceptor.setParameterName(\"world\");\n\n        params.put(\"world\", Locale.CHINA);\n        interceptor.intercept(mai);\n\n        assertNull(params.get(\"world\")); \n\n        assertNotNull(session.get(\"hello\")); \n        assertEquals(Locale.CHINA, session.get(\"hello\"));\n    }"
  },
  {
    "id": 31,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 12,
    "human_patch": "https://github.com/apache/struts/commit/fc2179cf1ac9fbfb61e3430fa88b641d87253327",
    "cve_id": "CVE-2016-2162",
    "cwe_id": "CWE-79",
    "filename": "core/src/test/java/com/opensymphony/xwork2/interceptor/I18nInterceptorTest.java",
    "is_vulnerable": 0,
    "class_name": "I18nInterceptorTest",
    "subclass_name": null,
    "function_name": "testActionContextLocaleIsPreservedWhenNotOverridden() throws Exception",
    "function_body": "{\n        final Locale locale1 = Locale.TRADITIONAL_CHINESE;\n        mai.getInvocationContext().setLocale(locale1);\n        interceptor.intercept(mai);\n\n        Locale locale = (Locale) session.get(I18nInterceptor.DEFAULT_SESSION_ATTRIBUTE);\n        assertNull(locale); \n        locale = mai.getInvocationContext().getLocale();\n        assertEquals(locale1, locale);\n    }"
  },
  {
    "id": 31,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 13,
    "human_patch": "https://github.com/apache/struts/commit/fc2179cf1ac9fbfb61e3430fa88b641d87253327",
    "cve_id": "CVE-2016-2162",
    "cwe_id": "CWE-79",
    "filename": "core/src/test/java/com/opensymphony/xwork2/interceptor/I18nInterceptorTest.java",
    "is_vulnerable": 0,
    "class_name": "I18nInterceptorTest",
    "subclass_name": null,
    "function_name": "setUp() throws Exception",
    "function_body": "{\n        interceptor = new I18nInterceptor();\n        interceptor.init();\n        params = new HashMap<>();\n        session = new HashMap();\n\n        Map<String, Object> ctx = new HashMap<>();\n        ctx.put(ActionContext.PARAMETERS, params);\n        ctx.put(ActionContext.SESSION, session);\n        ac = new ActionContext(ctx);\n\n        Action action = new SimpleFooAction();\n        mai = new MockActionInvocation();\n        ((MockActionInvocation) mai).setAction(action);\n        ((MockActionInvocation) mai).setInvocationContext(ac);\n    }"
  },
  {
    "id": 31,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 14,
    "human_patch": "https://github.com/apache/struts/commit/fc2179cf1ac9fbfb61e3430fa88b641d87253327",
    "cve_id": "CVE-2016-2162",
    "cwe_id": "CWE-79",
    "filename": "core/src/test/java/com/opensymphony/xwork2/interceptor/I18nInterceptorTest.java",
    "is_vulnerable": 0,
    "class_name": "I18nInterceptorTest",
    "subclass_name": null,
    "function_name": "tearDown() throws Exception",
    "function_body": "{\n        interceptor.destroy();\n        interceptor = null;\n        ac = null;\n        params = null;\n        session = null;\n        mai = null;\n    }"
  },
  {
    "id": 31,
    "sub_id": 2,
    "code_id": 0,
    "function_id": 0,
    "human_patch": "https://github.com/apache/struts/commit/fc2179cf1ac9fbfb61e3430fa88b641d87253327",
    "cve_id": "CVE-2016-2162",
    "cwe_id": "CWE-79",
    "filename": "core/src/test/java/org/apache/struts2/interceptor/I18nInterceptorTest.java",
    "is_vulnerable": 0,
    "class_name": "I18nInterceptorTest",
    "subclass_name": null,
    "function_name": "setUp() throws Exception",
    "function_body": "{\n        interceptor = new I18nInterceptor();\n        interceptor.init();\n        params = new HashMap<String, Object>();\n        session = new HashMap();\n\n        Map<String, Object> ctx = new HashMap<String, Object>();\n        ctx.put(ActionContext.PARAMETERS, params);\n        ctx.put(ActionContext.SESSION, session);\n        ac = new ActionContext(ctx);\n\n        Action action = new Action() {\n            public String execute() throws Exception {\n                return SUCCESS;\n            }\n        };\n        mai = new MockActionInvocation();\n        ((MockActionInvocation) mai).setAction(action);\n        ((MockActionInvocation) mai).setInvocationContext(ac);\n    }"
  },
  {
    "id": 31,
    "sub_id": 2,
    "code_id": 0,
    "function_id": 1,
    "human_patch": "https://github.com/apache/struts/commit/fc2179cf1ac9fbfb61e3430fa88b641d87253327",
    "cve_id": "CVE-2016-2162",
    "cwe_id": "CWE-79",
    "filename": "core/src/test/java/org/apache/struts2/interceptor/I18nInterceptorTest.java",
    "is_vulnerable": 0,
    "class_name": "I18nInterceptorTest",
    "subclass_name": null,
    "function_name": "execute() throws Exception",
    "function_body": "{\n                return SUCCESS;\n            }"
  },
  {
    "id": 31,
    "sub_id": 2,
    "code_id": 0,
    "function_id": 2,
    "human_patch": "https://github.com/apache/struts/commit/fc2179cf1ac9fbfb61e3430fa88b641d87253327",
    "cve_id": "CVE-2016-2162",
    "cwe_id": "CWE-79",
    "filename": "core/src/test/java/org/apache/struts2/interceptor/I18nInterceptorTest.java",
    "is_vulnerable": 0,
    "class_name": "I18nInterceptorTest",
    "subclass_name": null,
    "function_name": "tearDown() throws Exception",
    "function_body": "{\n        interceptor.destroy();\n        interceptor = null;\n        ac = null;\n        params = null;\n        session = null;\n        mai = null;\n    }"
  },
  {
    "id": 31,
    "sub_id": 2,
    "code_id": 0,
    "function_id": 3,
    "human_patch": "https://github.com/apache/struts/commit/fc2179cf1ac9fbfb61e3430fa88b641d87253327",
    "cve_id": "CVE-2016-2162",
    "cwe_id": "CWE-79",
    "filename": "core/src/test/java/org/apache/struts2/interceptor/I18nInterceptorTest.java",
    "is_vulnerable": 0,
    "class_name": "I18nInterceptorTest",
    "subclass_name": "CookieMatcher",
    "function_name": "matches(Object argument)",
    "function_body": "{\n            Cookie cookie = ((Cookie) argument);\n            return\n                (cookie.getName().equals(expected.getName()) &&\n                 cookie.getValue().equals(expected.getValue()));\n        }"
  },
  {
    "id": 31,
    "sub_id": 2,
    "code_id": 0,
    "function_id": 4,
    "human_patch": "https://github.com/apache/struts/commit/fc2179cf1ac9fbfb61e3430fa88b641d87253327",
    "cve_id": "CVE-2016-2162",
    "cwe_id": "CWE-79",
    "filename": "core/src/test/java/org/apache/struts2/interceptor/I18nInterceptorTest.java",
    "is_vulnerable": 0,
    "class_name": "I18nInterceptorTest",
    "subclass_name": "CookieMatcher",
    "function_name": "eqCookie(Cookie ck)",
    "function_body": "{\n            EasyMock.reportMatcher(new CookieMatcher(ck));\n            return null;\n        }"
  },
  {
    "id": 31,
    "sub_id": 2,
    "code_id": 0,
    "function_id": 5,
    "human_patch": "https://github.com/apache/struts/commit/fc2179cf1ac9fbfb61e3430fa88b641d87253327",
    "cve_id": "CVE-2016-2162",
    "cwe_id": "CWE-79",
    "filename": "core/src/test/java/org/apache/struts2/interceptor/I18nInterceptorTest.java",
    "is_vulnerable": 0,
    "class_name": "I18nInterceptorTest",
    "subclass_name": "CookieMatcher",
    "function_name": "appendTo(StringBuffer buffer)",
    "function_body": "{\n            buffer\n                .append(\"Received\")\n                .append(expected.getName())\n                .append(\"/\")\n                .append(expected.getValue());\n        }"
  },
  {
    "id": 31,
    "sub_id": 2,
    "code_id": 0,
    "function_id": 6,
    "human_patch": "https://github.com/apache/struts/commit/fc2179cf1ac9fbfb61e3430fa88b641d87253327",
    "cve_id": "CVE-2016-2162",
    "cwe_id": "CWE-79",
    "filename": "core/src/test/java/org/apache/struts2/interceptor/I18nInterceptorTest.java",
    "is_vulnerable": 0,
    "class_name": "I18nInterceptorTest",
    "subclass_name": null,
    "function_name": "testCookieCreation() throws Exception",
    "function_body": "{\n\n        params.put(I18nInterceptor.DEFAULT_COOKIE_PARAMETER, \"da_DK\");\n\n        final Cookie cookie = new Cookie(I18nInterceptor.DEFAULT_COOKIE_ATTRIBUTE, \"da_DK\");\n\n        HttpServletResponse response = EasyMock.createMock(HttpServletResponse.class);\n        response.addCookie(CookieMatcher.eqCookie(cookie));\n        EasyMock.replay(response);\n\n        ac.put(StrutsStatics.HTTP_RESPONSE, response);\n        interceptor.intercept(mai);\n\n        EasyMock.verify(response);\n\n        Locale denmark = new Locale(\"da\", \"DK\");\n        assertNotNull(session.get(I18nInterceptor.DEFAULT_SESSION_ATTRIBUTE)); \n        assertEquals(denmark, session.get(I18nInterceptor.DEFAULT_SESSION_ATTRIBUTE)); \n    }"
  },
  {
    "id": 31,
    "sub_id": 2,
    "code_id": 0,
    "function_id": 7,
    "human_patch": "https://github.com/apache/struts/commit/fc2179cf1ac9fbfb61e3430fa88b641d87253327",
    "cve_id": "CVE-2016-2162",
    "cwe_id": "CWE-79",
    "filename": "core/src/test/java/org/apache/struts2/interceptor/I18nInterceptorTest.java",
    "is_vulnerable": 0,
    "class_name": "I18nInterceptorTest",
    "subclass_name": null,
    "function_name": "testNoSession() throws Exception",
    "function_body": "{\n        ac.setSession(null);\n        interceptor.intercept(mai);\n    }"
  },
  {
    "id": 31,
    "sub_id": 2,
    "code_id": 0,
    "function_id": 8,
    "human_patch": "https://github.com/apache/struts/commit/fc2179cf1ac9fbfb61e3430fa88b641d87253327",
    "cve_id": "CVE-2016-2162",
    "cwe_id": "CWE-79",
    "filename": "core/src/test/java/org/apache/struts2/interceptor/I18nInterceptorTest.java",
    "is_vulnerable": 0,
    "class_name": "I18nInterceptorTest",
    "subclass_name": null,
    "function_name": "testDefaultLocale() throws Exception",
    "function_body": "{\n        params.put(I18nInterceptor.DEFAULT_PARAMETER, \"_\"); \n        interceptor.intercept(mai);\n\n        assertNull(params.get(I18nInterceptor.DEFAULT_PARAMETER)); \n\n        assertNotNull(session.get(I18nInterceptor.DEFAULT_SESSION_ATTRIBUTE)); \n        assertEquals(Locale.getDefault(), session.get(I18nInterceptor.DEFAULT_SESSION_ATTRIBUTE)); \n    }"
  },
  {
    "id": 31,
    "sub_id": 2,
    "code_id": 0,
    "function_id": 9,
    "human_patch": "https://github.com/apache/struts/commit/fc2179cf1ac9fbfb61e3430fa88b641d87253327",
    "cve_id": "CVE-2016-2162",
    "cwe_id": "CWE-79",
    "filename": "core/src/test/java/org/apache/struts2/interceptor/I18nInterceptorTest.java",
    "is_vulnerable": 0,
    "class_name": "I18nInterceptorTest",
    "subclass_name": null,
    "function_name": "testDenmarkLocale() throws Exception",
    "function_body": "{\n        params.put(I18nInterceptor.DEFAULT_PARAMETER, \"da_DK\");\n        interceptor.intercept(mai);\n\n        assertNull(params.get(I18nInterceptor.DEFAULT_PARAMETER)); \n\n        Locale denmark = new Locale(\"da\", \"DK\");\n        assertNotNull(session.get(I18nInterceptor.DEFAULT_SESSION_ATTRIBUTE)); \n        assertEquals(denmark, session.get(I18nInterceptor.DEFAULT_SESSION_ATTRIBUTE)); \n    }"
  },
  {
    "id": 31,
    "sub_id": 2,
    "code_id": 0,
    "function_id": 10,
    "human_patch": "https://github.com/apache/struts/commit/fc2179cf1ac9fbfb61e3430fa88b641d87253327",
    "cve_id": "CVE-2016-2162",
    "cwe_id": "CWE-79",
    "filename": "core/src/test/java/org/apache/struts2/interceptor/I18nInterceptorTest.java",
    "is_vulnerable": 0,
    "class_name": "I18nInterceptorTest",
    "subclass_name": null,
    "function_name": "testDenmarkLocaleRequestOnly() throws Exception",
    "function_body": "{\n        params.put(I18nInterceptor.DEFAULT_REQUESTONLY_PARAMETER, \"da_DK\");\n        interceptor.intercept(mai);\n\n        assertNull(params.get(I18nInterceptor.DEFAULT_PARAMETER)); \n\n        Locale denmark = new Locale(\"da\", \"DK\");\n        assertNull(session.get(I18nInterceptor.DEFAULT_SESSION_ATTRIBUTE)); \n        assertEquals(denmark, mai.getInvocationContext().getLocale()); \n    }"
  },
  {
    "id": 31,
    "sub_id": 2,
    "code_id": 0,
    "function_id": 11,
    "human_patch": "https://github.com/apache/struts/commit/fc2179cf1ac9fbfb61e3430fa88b641d87253327",
    "cve_id": "CVE-2016-2162",
    "cwe_id": "CWE-79",
    "filename": "core/src/test/java/org/apache/struts2/interceptor/I18nInterceptorTest.java",
    "is_vulnerable": 1,
    "class_name": "I18nInterceptorTest",
    "subclass_name": null,
    "function_name": "testCountryOnlyLocale() throws Exception",
    "function_body": "{\n        params.put(I18nInterceptor.DEFAULT_PARAMETER, \"DK\");\n        interceptor.intercept(mai);\n\n        assertNull(params.get(I18nInterceptor.DEFAULT_PARAMETER)); \n\n        Locale denmark = new Locale(\"DK\");\n        assertNotNull(session.get(I18nInterceptor.DEFAULT_SESSION_ATTRIBUTE)); \n        assertEquals(denmark, session.get(I18nInterceptor.DEFAULT_SESSION_ATTRIBUTE)); \n    }"
  },
  {
    "id": 31,
    "sub_id": 2,
    "code_id": 0,
    "function_id": 12,
    "human_patch": "https://github.com/apache/struts/commit/fc2179cf1ac9fbfb61e3430fa88b641d87253327",
    "cve_id": "CVE-2016-2162",
    "cwe_id": "CWE-79",
    "filename": "core/src/test/java/org/apache/struts2/interceptor/I18nInterceptorTest.java",
    "is_vulnerable": 0,
    "class_name": "I18nInterceptorTest",
    "subclass_name": null,
    "function_name": "testLanguageOnlyLocale() throws Exception",
    "function_body": "{\n        params.put(I18nInterceptor.DEFAULT_PARAMETER, \"da_\");\n        interceptor.intercept(mai);\n\n        assertNull(params.get(I18nInterceptor.DEFAULT_PARAMETER)); \n\n        Locale denmark = new Locale(\"da\");\n        assertNotNull(session.get(I18nInterceptor.DEFAULT_SESSION_ATTRIBUTE)); \n        assertEquals(denmark, session.get(I18nInterceptor.DEFAULT_SESSION_ATTRIBUTE)); \n    }"
  },
  {
    "id": 31,
    "sub_id": 2,
    "code_id": 0,
    "function_id": 13,
    "human_patch": "https://github.com/apache/struts/commit/fc2179cf1ac9fbfb61e3430fa88b641d87253327",
    "cve_id": "CVE-2016-2162",
    "cwe_id": "CWE-79",
    "filename": "core/src/test/java/org/apache/struts2/interceptor/I18nInterceptorTest.java",
    "is_vulnerable": 1,
    "class_name": "I18nInterceptorTest",
    "subclass_name": null,
    "function_name": "testWithVariant() throws Exception",
    "function_body": "{\n        params.put(I18nInterceptor.DEFAULT_PARAMETER, \"fr_CA_xx\");\n        interceptor.intercept(mai);\n\n        assertNull(params.get(I18nInterceptor.DEFAULT_PARAMETER)); \n\n        Locale variant = new Locale(\"fr\", \"CA\", \"xx\");\n        Locale locale = (Locale) session.get(I18nInterceptor.DEFAULT_SESSION_ATTRIBUTE);\n        assertNotNull(locale); \n        assertEquals(variant, locale);\n        assertEquals(\"xx\", locale.getVariant());\n    }"
  },
  {
    "id": 31,
    "sub_id": 2,
    "code_id": 0,
    "function_id": 14,
    "human_patch": "https://github.com/apache/struts/commit/fc2179cf1ac9fbfb61e3430fa88b641d87253327",
    "cve_id": "CVE-2016-2162",
    "cwe_id": "CWE-79",
    "filename": "core/src/test/java/org/apache/struts2/interceptor/I18nInterceptorTest.java",
    "is_vulnerable": 1,
    "class_name": "I18nInterceptorTest",
    "subclass_name": null,
    "function_name": "testWithVariantRequestOnly() throws Exception",
    "function_body": "{\n        params.put(I18nInterceptor.DEFAULT_REQUESTONLY_PARAMETER, \"fr_CA_xx\");\n        interceptor.intercept(mai);\n\n        assertNull(params.get(I18nInterceptor.DEFAULT_PARAMETER)); \n        assertNull(session.get(I18nInterceptor.DEFAULT_SESSION_ATTRIBUTE));\n\n        Locale variant = new Locale(\"fr\", \"CA\", \"xx\");\n        Locale locale = mai.getInvocationContext().getLocale();\n        assertNotNull(locale); \n        assertEquals(variant, locale);\n        assertEquals(\"xx\", locale.getVariant());\n    }"
  },
  {
    "id": 31,
    "sub_id": 2,
    "code_id": 0,
    "function_id": 15,
    "human_patch": "https://github.com/apache/struts/commit/fc2179cf1ac9fbfb61e3430fa88b641d87253327",
    "cve_id": "CVE-2016-2162",
    "cwe_id": "CWE-79",
    "filename": "core/src/test/java/org/apache/struts2/interceptor/I18nInterceptorTest.java",
    "is_vulnerable": 0,
    "class_name": "I18nInterceptorTest",
    "subclass_name": null,
    "function_name": "testRealLocaleObjectInParams() throws Exception",
    "function_body": "{\n        params.put(I18nInterceptor.DEFAULT_PARAMETER, Locale.CANADA_FRENCH);\n        interceptor.intercept(mai);\n\n        assertNull(params.get(I18nInterceptor.DEFAULT_PARAMETER)); \n\n        assertNotNull(session.get(I18nInterceptor.DEFAULT_SESSION_ATTRIBUTE)); \n        assertEquals(Locale.CANADA_FRENCH, session.get(I18nInterceptor.DEFAULT_SESSION_ATTRIBUTE)); \n    }"
  },
  {
    "id": 31,
    "sub_id": 2,
    "code_id": 0,
    "function_id": 16,
    "human_patch": "https://github.com/apache/struts/commit/fc2179cf1ac9fbfb61e3430fa88b641d87253327",
    "cve_id": "CVE-2016-2162",
    "cwe_id": "CWE-79",
    "filename": "core/src/test/java/org/apache/struts2/interceptor/I18nInterceptorTest.java",
    "is_vulnerable": 0,
    "class_name": "I18nInterceptorTest",
    "subclass_name": null,
    "function_name": "testRealLocalesInParams() throws Exception",
    "function_body": "{\n        Locale[] locales = new Locale[]{Locale.CANADA_FRENCH};\n        assertTrue(locales.getClass().isArray());\n        params.put(I18nInterceptor.DEFAULT_PARAMETER, locales);\n        interceptor.intercept(mai);\n\n        assertNull(params.get(I18nInterceptor.DEFAULT_PARAMETER)); \n\n        assertNotNull(session.get(I18nInterceptor.DEFAULT_SESSION_ATTRIBUTE)); \n        assertEquals(Locale.CANADA_FRENCH, session.get(I18nInterceptor.DEFAULT_SESSION_ATTRIBUTE));\n    }"
  },
  {
    "id": 31,
    "sub_id": 2,
    "code_id": 0,
    "function_id": 17,
    "human_patch": "https://github.com/apache/struts/commit/fc2179cf1ac9fbfb61e3430fa88b641d87253327",
    "cve_id": "CVE-2016-2162",
    "cwe_id": "CWE-79",
    "filename": "core/src/test/java/org/apache/struts2/interceptor/I18nInterceptorTest.java",
    "is_vulnerable": 0,
    "class_name": "I18nInterceptorTest",
    "subclass_name": null,
    "function_name": "testSetParameterAndAttributeNames() throws Exception",
    "function_body": "{\n        interceptor.setAttributeName(\"hello\");\n        interceptor.setParameterName(\"world\");\n\n        params.put(\"world\", Locale.CHINA);\n        interceptor.intercept(mai);\n\n        assertNull(params.get(\"world\")); \n\n        assertNotNull(session.get(\"hello\")); \n        assertEquals(Locale.CHINA, session.get(\"hello\"));\n    }"
  },
  {
    "id": 32,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 0,
    "human_patch": "https://github.com/apache/struts/commit/1f301038a751bf16e525607c3db513db835b2999",
    "cve_id": "CVE-2014-7809",
    "cwe_id": "CWE-352",
    "filename": "core/src/main/java/org/apache/struts2/util/TokenHelper.java",
    "is_vulnerable": 0,
    "class_name": "TokenHelper",
    "subclass_name": null,
    "function_name": "setToken()",
    "function_body": "{\n        return setToken(DEFAULT_TOKEN_NAME);\n    }"
  },
  {
    "id": 32,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 1,
    "human_patch": "https://github.com/apache/struts/commit/1f301038a751bf16e525607c3db513db835b2999",
    "cve_id": "CVE-2014-7809",
    "cwe_id": "CWE-352",
    "filename": "core/src/main/java/org/apache/struts2/util/TokenHelper.java",
    "is_vulnerable": 0,
    "class_name": "TokenHelper",
    "subclass_name": null,
    "function_name": "setToken( String tokenName )",
    "function_body": "{\n\t\tString token = generateGUID();\n\t\tsetSessionToken(tokenName, token);\n\t\treturn token;\n\t}"
  },
  {
    "id": 32,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 2,
    "human_patch": "https://github.com/apache/struts/commit/1f301038a751bf16e525607c3db513db835b2999",
    "cve_id": "CVE-2014-7809",
    "cwe_id": "CWE-352",
    "filename": "core/src/main/java/org/apache/struts2/util/TokenHelper.java",
    "is_vulnerable": 0,
    "class_name": "TokenHelper",
    "subclass_name": null,
    "function_name": "setSessionToken( String tokenName, String token )",
    "function_body": "{\n\t\tMap<String, Object> session = ActionContext.getContext().getSession();\n\t\ttry {\n\t\t\tsession.put(buildTokenSessionAttributeName(tokenName), token);\n\t\t} catch ( IllegalStateException e ) {\n\t\t\t\n            String msg = \"Error creating HttpSession due response is commited to client. You can use the CreateSessionInterceptor or create the HttpSession from your action before the result is rendered to the client: \" + e.getMessage();\n            if (LOG.isErrorEnabled()) {\n                LOG.error(msg, e);\n            }\n\t\t\tthrow new IllegalArgumentException(msg);\n\t\t}\n\t}"
  },
  {
    "id": 32,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 3,
    "human_patch": "https://github.com/apache/struts/commit/1f301038a751bf16e525607c3db513db835b2999",
    "cve_id": "CVE-2014-7809",
    "cwe_id": "CWE-352",
    "filename": "core/src/main/java/org/apache/struts2/util/TokenHelper.java",
    "is_vulnerable": 0,
    "class_name": "TokenHelper",
    "subclass_name": null,
    "function_name": "buildTokenSessionAttributeName( String tokenName )",
    "function_body": "{\n\t\treturn TOKEN_NAMESPACE + \".\" + tokenName;\n\t}"
  },
  {
    "id": 32,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 4,
    "human_patch": "https://github.com/apache/struts/commit/1f301038a751bf16e525607c3db513db835b2999",
    "cve_id": "CVE-2014-7809",
    "cwe_id": "CWE-352",
    "filename": "core/src/main/java/org/apache/struts2/util/TokenHelper.java",
    "is_vulnerable": 0,
    "class_name": "TokenHelper",
    "subclass_name": null,
    "function_name": "getToken()",
    "function_body": "{\n        return getToken(DEFAULT_TOKEN_NAME);\n    }"
  },
  {
    "id": 32,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 5,
    "human_patch": "https://github.com/apache/struts/commit/1f301038a751bf16e525607c3db513db835b2999",
    "cve_id": "CVE-2014-7809",
    "cwe_id": "CWE-352",
    "filename": "core/src/main/java/org/apache/struts2/util/TokenHelper.java",
    "is_vulnerable": 0,
    "class_name": "TokenHelper",
    "subclass_name": null,
    "function_name": "getToken(String tokenName)",
    "function_body": "{\n        if (tokenName == null ) {\n            return null;\n        }\n        Map params = ActionContext.getContext().getParameters();\n        String[] tokens = (String[]) params.get(tokenName);\n        String token;\n\n        if ((tokens == null) || (tokens.length < 1)) {\n            if (LOG.isWarnEnabled()) {\n        \tLOG.warn(\"Could not find token mapped to token name \" + tokenName);\n            }\n\n            return null;\n        }\n\n        token = tokens[0];\n\n        return token;\n    }"
  },
  {
    "id": 32,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 6,
    "human_patch": "https://github.com/apache/struts/commit/1f301038a751bf16e525607c3db513db835b2999",
    "cve_id": "CVE-2014-7809",
    "cwe_id": "CWE-352",
    "filename": "core/src/main/java/org/apache/struts2/util/TokenHelper.java",
    "is_vulnerable": 0,
    "class_name": "TokenHelper",
    "subclass_name": null,
    "function_name": "getTokenName()",
    "function_body": "{\n        Map params = ActionContext.getContext().getParameters();\n\n        if (!params.containsKey(TOKEN_NAME_FIELD)) {\n            if (LOG.isWarnEnabled()) {\n        \tLOG.warn(\"Could not find token name in params.\");\n            }\n\n            return null;\n        }\n\n        String[] tokenNames = (String[]) params.get(TOKEN_NAME_FIELD);\n        String tokenName;\n\n        if ((tokenNames == null) || (tokenNames.length < 1)) {\n            if (LOG.isWarnEnabled()) {\n        \tLOG.warn(\"Got a null or empty token name.\");\n            }\n\n            return null;\n        }\n\n        tokenName = tokenNames[0];\n\n        return tokenName;\n    }"
  },
  {
    "id": 32,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 7,
    "human_patch": "https://github.com/apache/struts/commit/1f301038a751bf16e525607c3db513db835b2999",
    "cve_id": "CVE-2014-7809",
    "cwe_id": "CWE-352",
    "filename": "core/src/main/java/org/apache/struts2/util/TokenHelper.java",
    "is_vulnerable": 0,
    "class_name": "TokenHelper",
    "subclass_name": null,
    "function_name": "validToken()",
    "function_body": "{\n        String tokenName = getTokenName();\n\n        if (tokenName == null) {\n            if (LOG.isDebugEnabled()) {\n                LOG.debug(\"no token name found -> Invalid token \");\n            }\n            return false;\n        }\n\n        String token = getToken(tokenName);\n\n        if (token == null) {\n            if (LOG.isDebugEnabled()) {\n                LOG.debug(\"no token found for token name \"+tokenName+\" -> Invalid token \");\n            }\n            return false;\n        }\n\n        Map session = ActionContext.getContext().getSession();\n\t\tString tokenSessionName = buildTokenSessionAttributeName(tokenName);\n        String sessionToken = (String) session.get(tokenSessionName);\n\n        if (!token.equals(sessionToken)) {\n            if (LOG.isWarnEnabled()) {\n                LOG.warn(LocalizedTextUtil.findText(TokenHelper.class, \"struts.internal.invalid.token\", ActionContext.getContext().getLocale(), \"Form token {0} does not match the session token {1}.\", new Object[]{\n                        token, sessionToken\n                }));\n            }\n\n            return false;\n        }\n\n        \n        session.remove(tokenSessionName);\n\n        return true;\n    }"
  },
  {
    "id": 32,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 8,
    "human_patch": "https://github.com/apache/struts/commit/1f301038a751bf16e525607c3db513db835b2999",
    "cve_id": "CVE-2014-7809",
    "cwe_id": "CWE-352",
    "filename": "core/src/main/java/org/apache/struts2/util/TokenHelper.java",
    "is_vulnerable": 0,
    "class_name": "TokenHelper",
    "subclass_name": null,
    "function_name": "generateGUID()",
    "function_body": "{\n        return new BigInteger(165, RANDOM).toString(36).toUpperCase();\n    }"
  },
  {
    "id": 33,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 0,
    "human_patch": "https://github.com/apache/tika/commit/8a6a9e1344f5b10ebfa1a189dc3c30d0da2b9d4",
    "cve_id": "CVE-2018-8017",
    "cwe_id": "CWE-835",
    "filename": "tika-parsers/src/main/java/org/apache/tika/parser/iptc/IptcAnpaParser.java",
    "is_vulnerable": 0,
    "class_name": "IptcAnpaParser",
    "subclass_name": null,
    "function_name": "getSupportedTypes(ParseContext context)",
    "function_body": "{\n        return SUPPORTED_TYPES;\n    }"
  },
  {
    "id": 33,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 1,
    "human_patch": "https://github.com/apache/tika/commit/8a6a9e1344f5b10ebfa1a189dc3c30d0da2b9d4",
    "cve_id": "CVE-2018-8017",
    "cwe_id": "CWE-835",
    "filename": "tika-parsers/src/main/java/org/apache/tika/parser/iptc/IptcAnpaParser.java",
    "is_vulnerable": 0,
    "class_name": "IptcAnpaParser",
    "subclass_name": null,
    "function_name": "parse(\n           InputStream stream, ContentHandler handler,\n           Metadata metadata, ParseContext context) throws IOException, SAXException, TikaException",
    "function_body": "{\n\n        HashMap<String,String> properties = this.loadProperties(stream);\n        this.setMetadata(metadata, properties);\n\n        XHTMLContentHandler xhtml = new XHTMLContentHandler(handler, metadata);\n        xhtml.startDocument();\n        \n        xhtml.startElement(\"p\");\n        String body = clean(properties.get(\"body\"));\n        if (body != null)\n           xhtml.characters(body);\n        xhtml.endElement(\"p\");\n        xhtml.endDocument();\n    }"
  },
  {
    "id": 33,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 2,
    "human_patch": "https://github.com/apache/tika/commit/8a6a9e1344f5b10ebfa1a189dc3c30d0da2b9d4",
    "cve_id": "CVE-2018-8017",
    "cwe_id": "CWE-835",
    "filename": "tika-parsers/src/main/java/org/apache/tika/parser/iptc/IptcAnpaParser.java",
    "is_vulnerable": 0,
    "class_name": "IptcAnpaParser",
    "subclass_name": null,
    "function_name": "parse(\n            InputStream stream, ContentHandler handler, Metadata metadata) throws IOException, SAXException, TikaException",
    "function_body": "{\n        parse(stream, handler, metadata, new ParseContext());\n    }"
  },
  {
    "id": 33,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 3,
    "human_patch": "https://github.com/apache/tika/commit/8a6a9e1344f5b10ebfa1a189dc3c30d0da2b9d4",
    "cve_id": "CVE-2018-8017",
    "cwe_id": "CWE-835",
    "filename": "tika-parsers/src/main/java/org/apache/tika/parser/iptc/IptcAnpaParser.java",
    "is_vulnerable": 0,
    "class_name": "IptcAnpaParser",
    "subclass_name": null,
    "function_name": "loadProperties(InputStream is)",
    "function_body": "{\n      \n      HashMap<String,String> properties = new HashMap<String,String>();\n\n      FORMAT = this.scanFormat(is);\n\n      byte[] residual = this.getSection(is,\"residual\");\n\n      byte[] header = this.getSection(is,\"header\");\n      parseHeader(header, properties);\n\n      byte[] body = this.getSection(is,\"body\");\n      parseBody(body, properties);\n\n      byte[] footer = this.getSection(is,\"footer\");\n      parseFooter(footer, properties);\n       \n      return (properties);\n   }"
  },
  {
    "id": 33,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 4,
    "human_patch": "https://github.com/apache/tika/commit/8a6a9e1344f5b10ebfa1a189dc3c30d0da2b9d4",
    "cve_id": "CVE-2018-8017",
    "cwe_id": "CWE-835",
    "filename": "tika-parsers/src/main/java/org/apache/tika/parser/iptc/IptcAnpaParser.java",
    "is_vulnerable": 0,
    "class_name": "IptcAnpaParser",
    "subclass_name": null,
    "function_name": "scanFormat(InputStream is)",
    "function_body": "{\n      int format    = this.FORMAT;\n      int  maxsize  = 524288;     \n\n      byte[] buf = new byte[maxsize];\n      try {\n         if (is.markSupported()) {\n            is.mark(maxsize);\n         }\n         int msgsize = is.read(buf);                \n\n         String message = (new String(buf, UTF_8)).toLowerCase(Locale.ROOT);\n         \n         \n         \n         \n\n         if (message.contains(\"ap-wf\")) {\n            format = this.FMT_IPTC_AP;\n         }\n         if (message.contains(\"reuters\")) {\n            format = this.FMT_IPTC_RTR;\n         }\n         if (message.contains(\"new york times\")) {\n            format = this.FMT_IPTC_NYT;\n         }\n         if (message.contains(\"bloomberg news\")) {\n            format = this.FMT_IPTC_BLM;\n         }\n      }\n      catch (IOException eio) {\n         \n      }\n\n      try {\n         if (is.markSupported()) {\n            is.reset();\n         }\n      }\n      catch (IOException eio) {\n         \n      }\n      return (format);\n   }"
  },
  {
    "id": 33,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 5,
    "human_patch": "https://github.com/apache/tika/commit/8a6a9e1344f5b10ebfa1a189dc3c30d0da2b9d4",
    "cve_id": "CVE-2018-8017",
    "cwe_id": "CWE-835",
    "filename": "tika-parsers/src/main/java/org/apache/tika/parser/iptc/IptcAnpaParser.java",
    "is_vulnerable": 0,
    "class_name": "IptcAnpaParser",
    "subclass_name": null,
    "function_name": "setFormat(int format)",
    "function_body": "{\n      this.FORMAT = format;\n   }"
  },
  {
    "id": 33,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 6,
    "human_patch": "https://github.com/apache/tika/commit/8a6a9e1344f5b10ebfa1a189dc3c30d0da2b9d4",
    "cve_id": "CVE-2018-8017",
    "cwe_id": "CWE-835",
    "filename": "tika-parsers/src/main/java/org/apache/tika/parser/iptc/IptcAnpaParser.java",
    "is_vulnerable": 0,
    "class_name": "IptcAnpaParser",
    "subclass_name": null,
    "function_name": "getFormatName()",
    "function_body": "{\n      \n      String name = \"\";\n      \n      if (FORMAT == this.FMT_IPTC_AP) {\n         name = \"Associated Press\";\n      }\n      \n      else if(FORMAT == this.FMT_IPTC_BLM) {\n         name = \"Bloomberg\";\n      }\n\n      else if(FORMAT == this.FMT_IPTC_NYT) {\n         name = \"New York Times\";\n      }\n\n      else if(FORMAT == this.FMT_IPTC_RTR) {\n         name = \"Reuters\";\n      }\n\n      return (name);\n   }"
  },
  {
    "id": 33,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 7,
    "human_patch": "https://github.com/apache/tika/commit/8a6a9e1344f5b10ebfa1a189dc3c30d0da2b9d4",
    "cve_id": "CVE-2018-8017",
    "cwe_id": "CWE-835",
    "filename": "tika-parsers/src/main/java/org/apache/tika/parser/iptc/IptcAnpaParser.java",
    "is_vulnerable": 0,
    "class_name": "IptcAnpaParser",
    "subclass_name": null,
    "function_name": "getSection(InputStream is, String name)",
    "function_body": "{\n\n      byte[] value = new byte[0];\n\n      if (name.equals(\"residual\")) {\n         \n         int  maxsize  = 8192;     \n         byte bstart   = SYN;     \n         byte bfinish  = SOH;     \n         value = getSection(is, maxsize, bstart, bfinish, true);\n      }\n\n      else if(name.equals(\"header\")) {\n         \n         int  maxsize  = 8192;     \n         byte bstart   = SOH;     \n         byte bfinish  = STX;     \n         value = getSection(is, maxsize, bstart, bfinish, true);\n      }\n\n      else if (name.equals(\"body\")) {\n         \n         int  maxsize  = 524288;     \n         byte bstart   = STX;     \n         byte bfinish  = ETX;     \n         value = getSection(is, maxsize, bstart, bfinish, true);\n      }\n\n      else if (name.equals(\"footer\")) {\n         \n         int maxsize   = 8192;     \n         byte bstart   = ETX;     \n         byte bfinish  = EOT;     \n         value = getSection(is, maxsize, bstart, bfinish, true);\n      }\n\n      return (value);\n   }"
  },
  {
    "id": 33,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 8,
    "human_patch": "https://github.com/apache/tika/commit/8a6a9e1344f5b10ebfa1a189dc3c30d0da2b9d4",
    "cve_id": "CVE-2018-8017",
    "cwe_id": "CWE-835",
    "filename": "tika-parsers/src/main/java/org/apache/tika/parser/iptc/IptcAnpaParser.java",
    "is_vulnerable": 0,
    "class_name": "IptcAnpaParser",
    "subclass_name": null,
    "function_name": "getSection(InputStream is, int maxsize, byte bstart, byte bfinish, boolean ifincomplete)",
    "function_body": "{\n      byte[] value  = new byte[0];\n\n      try {\n         boolean started = false;                   \n         boolean finished = false;                  \n         int read = 0;                              \n         int start = 0;                             \n\n         \n         \n         int streammax = is.available();\n         maxsize = Math.min(maxsize, streammax);\n\n         is.mark(maxsize);\n         byte[] buf = new byte[maxsize];\n         int totsize = 0;\n         int remainder = maxsize - totsize;\n         while (remainder > 0) {\n            int msgsize = is.read(buf, maxsize-remainder, maxsize);    \n            if (msgsize == -1) {\n               remainder = msgsize = 0;\n            }\n            remainder -= msgsize;\n            totsize   += msgsize;\n         }\n\n         \n         for (read=0; read < totsize; read++) {\n            byte b = buf[read];\n\n            if (!started) {\n               started = (b == bstart);\n               start = read + 1;\n               continue;\n            }\n\n            if (finished = (b == bfinish)) {\n\n               break;\n            }\n\n            \n            continue;\n         }\n\n         \n         is.reset();\n\n         if (finished) {\n            \n            is.skip(read);\n            value = new byte[read-start];\n            System.arraycopy(buf, start, value, 0, read-start);\n         }\n         else {\n            if (ifincomplete && started) {\n               \n               value = new byte[read-start];\n               System.arraycopy(buf, start, value, 0, read-start);\n            }\n         }\n      }\n      catch (IOException eio) {\n         \n      }\n\n      return (value);\n   }"
  },
  {
    "id": 33,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 9,
    "human_patch": "https://github.com/apache/tika/commit/8a6a9e1344f5b10ebfa1a189dc3c30d0da2b9d4",
    "cve_id": "CVE-2018-8017",
    "cwe_id": "CWE-835",
    "filename": "tika-parsers/src/main/java/org/apache/tika/parser/iptc/IptcAnpaParser.java",
    "is_vulnerable": 0,
    "class_name": "IptcAnpaParser",
    "subclass_name": null,
    "function_name": "parseHeader(byte[] value, HashMap<String,String> properties)",
    "function_body": "{\n      boolean added = false;\n\n      String env_serviceid = \"\";\n      String env_category = \"\";\n      String env_urgency = \"\";\n      String hdr_edcode = \"\";\n      String hdr_subject = \"\";\n      String hdr_date = \"\";\n      String hdr_time = \"\";\n\n      int read = 0;\n\n      while (read < value.length) {\n\n         \n         while (read < value.length) {\n            byte val_next = value[read++];\n            if (val_next != FS) {\n               env_serviceid += (char)(val_next & 0xff);  \n            }\n            else {\n               break;\n            }\n         }\n\n         \n         while (read < value.length) {\n            byte val_next = value[read++];\n            if (val_next != XS) {   \n               env_category += (char)(val_next & 0xff);  \n            }\n            else {\n               val_next = value[read];  \n               if (val_next == XQ) {\n                  read++;\n               }\n               break;\n            }\n         }\n\n         \n         while (read < value.length) {\n            boolean subject = true;\n            byte val_next = value[read++];\n            while ((subject) && (val_next != SP) && (val_next != 0x00)) {  \n               hdr_subject += (char)(val_next & 0xff);  \n               val_next =  (read < value.length) ? value[read++] : 0x00;\n               while (val_next == SP) {  \n                  subject = false;\n                  val_next =  (read < value.length) ? value[read++] : 0x00;\n                  if (val_next != SP) {\n                     --read;  \n                  }\n               }\n            }\n            if (!subject) {\n               break;\n            }\n         }\n\n         \n         while (read < value.length) {\n            byte val_next = value[read++];\n            if (hdr_date.length() == 0) {\n               while (((val_next >= (byte)0x30) && (val_next <= (byte)0x39))  \n                  ||   (val_next == HY)) {\n                  hdr_date += (char)(val_next & 0xff);  \n                  val_next =  (read < value.length) ? value[read++] : 0x00;\n               }\n            }\n            else if (val_next == SP) {\n               while (val_next == SP) {  \n                  val_next =  (read < value.length) ? value[read++] : 0x00;\n               }\n               continue;\n            }\n            else {\n               while (((val_next >= (byte)0x30) && (val_next <= (byte)0x39))  \n                  ||   (val_next == HY)) {\n                  hdr_time += (char)(val_next & 0xff);  \n                  val_next =  (read < value.length) ? value[read++] : 0x00;\n               }\n            }\n         }\n         break; \n      }\n\n      \n\n      added = (env_serviceid.length() + env_category.length() + hdr_subject.length() + \n               hdr_date.length() + hdr_time.length()) > 0; \n      return added;\n   }"
  },
  {
    "id": 33,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 10,
    "human_patch": "https://github.com/apache/tika/commit/8a6a9e1344f5b10ebfa1a189dc3c30d0da2b9d4",
    "cve_id": "CVE-2018-8017",
    "cwe_id": "CWE-835",
    "filename": "tika-parsers/src/main/java/org/apache/tika/parser/iptc/IptcAnpaParser.java",
    "is_vulnerable": 1,
    "class_name": "IptcAnpaParser",
    "subclass_name": null,
    "function_name": "parseBody(byte[] value, HashMap<String,String> properties)",
    "function_body": "{\n      boolean added = false;\n\n      String bdy_heading = \"\";\n      String bdy_title = \"\";\n      String bdy_source = \"\";\n      String bdy_author = \"\";\n      String bdy_body = \"\";\n\n      int read = 0;\n      boolean done = false;\n\n      while (!done && (read < value.length)) {\n\n         \n         while (read < value.length) {\n            byte val_next = value[read++];\n            if (val_next == CT) {      \n               val_next =  (read < value.length) ? value[read++] : 0x00;\n               \n               while ((val_next != LT) && (val_next != CR) && (val_next != LF)) {   \n                  bdy_heading += (char)(val_next & 0xff);  \n                  val_next =  (read < value.length) ? value[read++] : 0x00;\n                  if (read > value.length) { break; }  \n               }\n               if (val_next == LT) {\n                  \n                  val_next =  (read < value.length) ? value[read++] : 0x00;\n               }\n               while (bdy_heading.length() > 0 && ((val_next == CR) || (val_next == LF))) {\n                  val_next =  (read < value.length) ? value[read++] : 0x00;  \n                  if ((val_next != CR) && (val_next != LF)) {\n                     --read;\n                  }\n               }\n            }\n            else {\n               \n\n               \n               if (FORMAT == this.FMT_IPTC_RTR) {\n                  if (val_next != CT) {\n                     \n                     if ((val_next != SP) && (val_next != TB) && (val_next != CR) && (val_next != LF)) {\n                        \n                        if (read == 1) {\n                           byte[] resize = new byte[value.length + 1];\n                           System.arraycopy(value, 0, resize, 1, value.length);\n                           value = resize;\n                        }\n                     }\n                     value[--read] = CT;\n                     continue;\n                  }\n               }\n            }\n            break;\n         }\n\n         \n         while (read < value.length) {\n            byte val_next = value[read++];\n            if (val_next == CT) {      \n               val_next =  (read < value.length) ? value[read++] : 0x00;\n               \n               while ((val_next != LT) && (val_next != CT) && (val_next != CR) && (val_next != LF)) {   \n                  bdy_title += (char)(val_next & 0xff);  \n                  val_next =  (read < value.length) ? value[read++] : 0x00;\n                  if (read > value.length) { break; }  \n               }\n\n               if (val_next == CT) {      \n                   --read;\n               }\n\n               if (val_next == LT) {\n                  \n                  val_next =  (read < value.length) ? value[read++] : 0x00;\n               }\n\n               while (bdy_title.length() > 0 && ((val_next == CR) || (val_next == LF))) {\n                  val_next =  (read < value.length) ? value[read++] : 0x00;  \n                  if ((val_next != CR) && (val_next != LF)) {\n                     --read;\n                  }\n               }\n            }\n            else {\n               \n\n               \n               if (FORMAT == this.FMT_IPTC_BLM) {\n                  if (val_next == TB) {\n                     value[--read] = CT;\n                     continue;\n                  }\n               }\n\n               \n               if (FORMAT == this.FMT_IPTC_RTR) {\n                  if (val_next != CT) {\n                     \n                     if ((val_next != SP) && (val_next != TB) && (val_next != CR) && (val_next != LF)) {\n                        --read;\n                     }\n                     value[--read] = CT;\n                     continue;\n                  }\n               }\n            }\n            break;\n         }\n\n\n         \n         \n         \n         boolean metastarted = false;\n         String longline = \"\";\n         String longkey = \"\";\n         while (read < value.length) {\n            byte val_next = value[read++];\n\n            \n            if ((val_next == SP) || (val_next == TB) || (val_next == CR) || (val_next == LF)) {\n               continue;\n            }\n\n            if (val_next == CT) {      \n               val_next =  (read < value.length) ? value[read++] : 0x00;\n               String tmp_line = \"\";\n               while ((val_next != LT) && (val_next != CT) && (val_next != CR) && (val_next != LF) && (val_next != 0))  {\n                  \n                  tmp_line += (char)(val_next & 0xff);  \n                  val_next =  (read < value.length) ? value[read++] : 0x00;\n                  if (read > value.length) { break; }  \n               }\n\n               if (val_next == CT) {      \n                   --read;\n               }\n\n               if (val_next == LT) {\n                  \n                  val_next =  (read < value.length) ? value[read++] : 0x00;\n               }\n\n               while ((val_next == CR) || (val_next == LF)) {\n                  val_next =  (read < value.length) ? value[read++] : 0x00;  \n                  if ((val_next != CR) && (val_next != LF)) {\n                     --read;\n                  }\n               }\n               if (tmp_line.toLowerCase(Locale.ROOT).startsWith(\"by\") || longline.equals(\"bdy_author\")) {\n                  longkey = \"bdy_author\";\n\n                  \n                  tmp_line = (longline.equals(longkey) ? \" \" : \"\") + tmp_line;\n\n                  \n                  int term = tmp_line.length();\n                  term = Math.min(term, (tmp_line.contains(\"<\") ? tmp_line.indexOf(\"<\")  : term));\n                  term = Math.min(term, (tmp_line.contains(\"=\") ? tmp_line.indexOf(\"=\")  : term));\n                  term = Math.min(term, (tmp_line.contains(\"\\n\") ? tmp_line.indexOf(\"\\n\") : term));\n                  term = (term > 0 ) ? term : tmp_line.length();\n                  bdy_author += tmp_line.substring(tmp_line.indexOf(\" \"), term);\n                  metastarted = true;\n                  longline = ((tmp_line.contains(\"=\")) && (!longline.equals(longkey)) ? longkey : \"\");\n               }\n               else if (FORMAT == this.FMT_IPTC_BLM) {\n                  String byline = \"   by \";\n                  if (tmp_line.toLowerCase(Locale.ROOT).contains(byline)) {\n                     longkey = \"bdy_author\";\n\n                     int term = tmp_line.length();\n                     term = Math.min(term, (tmp_line.contains(\"<\") ? tmp_line.indexOf(\"<\")  : term));\n                     term = Math.min(term, (tmp_line.contains(\"=\") ? tmp_line.indexOf(\"=\")  : term));\n                     term = Math.min(term, (tmp_line.contains(\"\\n\") ? tmp_line.indexOf(\"\\n\") : term));\n                     term = (term > 0 ) ? term : tmp_line.length();\n                     \n                     bdy_author += tmp_line.substring(tmp_line.toLowerCase(Locale.ROOT).indexOf(byline) + byline.length(), term) + \" \";\n                     metastarted = true;\n                     longline = ((tmp_line.contains(\"=\")) && (!longline.equals(longkey)) ? longkey : \"\");\n                  }\n                  else if(tmp_line.toLowerCase(Locale.ROOT).startsWith(\"c.\")) {\n                     \n                     \n                     if (val_next == TB) {\n                        value[--read] = CT;\n                        continue;\n                     }\n                  }\n                  else if(tmp_line.toLowerCase(Locale.ROOT).trim().startsWith(\"(\") && tmp_line.toLowerCase(Locale.ROOT).trim().endsWith(\")\")) {\n                     \n                     \n                     if (val_next == TB) {\n                        value[--read] = CT;\n                        continue;\n                     }\n                  }\n               }\n\n               else if (tmp_line.toLowerCase(Locale.ROOT).startsWith(\"eds\") || longline.equals(\"bdy_source\")) {\n                  longkey = \"bdy_source\";\n                  \n                  tmp_line = (longline.equals(longkey) ? \" \" : \"\") + tmp_line;\n\n                  \n                  int term = tmp_line.length();\n                  term = Math.min(term, (tmp_line.contains(\"<\") ? tmp_line.indexOf(\"<\")  : term));\n                  term = Math.min(term, (tmp_line.contains(\"=\") ? tmp_line.indexOf(\"=\")  : term));\n\n                  term = (term > 0 ) ? term : tmp_line.length();\n                  bdy_source += tmp_line.substring(tmp_line.indexOf(\" \") + 1, term) + \" \";\n                  metastarted = true;\n                  longline = (!longline.equals(longkey) ? longkey  : \"\");\n               }\n               else {\n                  \n                  \n                  if (!metastarted) {\n                     bdy_title += \" , \" + tmp_line;     \n                  }\n                  else {\n                     \n                     bdy_body += \" \" + tmp_line + \" , \";     \n                  }\n               }\n            }\n            else {  \n               while ((read < value.length) && (val_next != 0))  {\n                  \n                  bdy_body += (char)(val_next & 0xff);  \n                  val_next =  (read < value.length) ? value[read++] : 0x00;\n                  if (read > value.length) { break; }  \n               }\n\n            }\n            \n         }\n         done = true; \n      }\n      properties.put(\"body\", bdy_body);\n      properties.put(\"title\", bdy_title);\n      properties.put(\"subject\", bdy_heading);\n      properties.put(\"author\", bdy_author);\n      properties.put(\"source\", bdy_source);\n\n      added = (bdy_body.length() + bdy_title.length() + bdy_heading.length() + bdy_author.length() +\n               bdy_source.length()) > 0;\n      return added;\n   }"
  },
  {
    "id": 33,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 11,
    "human_patch": "https://github.com/apache/tika/commit/8a6a9e1344f5b10ebfa1a189dc3c30d0da2b9d4",
    "cve_id": "CVE-2018-8017",
    "cwe_id": "CWE-835",
    "filename": "tika-parsers/src/main/java/org/apache/tika/parser/iptc/IptcAnpaParser.java",
    "is_vulnerable": 1,
    "class_name": "IptcAnpaParser",
    "subclass_name": null,
    "function_name": "parseFooter(byte[] value, HashMap<String,String> properties)",
    "function_body": "{\n      boolean added = false;\n\n      String ftr_source = \"\";\n      String ftr_datetime = \"\";\n\n      int read = 0;\n      boolean done = false;\n\n      while (!done && (read < value.length)) {\n\n         \n         byte val_next = value[read++];\n         byte val_peek =  (read < value.length) ? value[read+1] : 0x00;  \n\n         while (((val_next < (byte)0x30) || (val_next > (byte)0x39)) && (val_next != 0)) {  \n            ftr_source += (char)(val_next & 0xff);  \n            val_next =  (read < value.length) ? value[read] : 0x00;  \n            read++;\n            if (read > value.length) { break; }  \n         }\n\n         while ((val_next != LT) && (val_next != CR) && (val_next != LF) && (val_next != 0))  {  \n            \n            ftr_datetime += (char)(val_next & 0xff);  \n            val_next =  (read < value.length) ? value[read++] : 0x00;  \n            if (read > value.length) { break; }  \n         }\n         if (val_next == LT) {\n            \n            val_next =  (read < value.length) ? value[read++] : 0x00;\n         }\n\n         if (ftr_datetime.length() > 0) {\n            \n            String format_out = \"yyyy-MM-dd'T'HH:mm:ss'Z'\";\n            Date dateunix = new Date();\n            try {\n               \n               String format_in = \"MM-dd-yy HHmmzzz\";\n\n               if (FORMAT == this.FMT_IPTC_RTR) {\n                  \n                  format_in = \"HH:mm MM-dd-yy\";\n               }\n               SimpleDateFormat dfi = new SimpleDateFormat(format_in, Locale.ROOT);\n               dfi.setTimeZone(TimeZone.getTimeZone(\"UTC\"));\n               dateunix = dfi.parse(ftr_datetime);\n            }\n            catch (ParseException ep) {\n               \n            }\n            SimpleDateFormat dfo = new SimpleDateFormat(format_out, Locale.ROOT);\n            dfo.setTimeZone(TimeZone.getTimeZone(\"UTC\"));\n            ftr_datetime = dfo.format(dateunix);\n         }\n         while ((val_next == CR) || (val_next == LF)) {\n            val_next =  (read < value.length) ? value[read++] : 0x00;  \n            if ((val_next != CR) && (val_next != LF)) {\n               --read;\n            }\n         }\n         done = true; \n      }\n\n      properties.put(\"publisher\", ftr_source);\n      properties.put(\"created\", ftr_datetime);\n      properties.put(\"modified\", ftr_datetime);\n\n      added = (ftr_source.length() + ftr_datetime.length()) > 0; \n      return added;\n   }"
  },
  {
    "id": 33,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 12,
    "human_patch": "https://github.com/apache/tika/commit/8a6a9e1344f5b10ebfa1a189dc3c30d0da2b9d4",
    "cve_id": "CVE-2018-8017",
    "cwe_id": "CWE-835",
    "filename": "tika-parsers/src/main/java/org/apache/tika/parser/iptc/IptcAnpaParser.java",
    "is_vulnerable": 0,
    "class_name": "IptcAnpaParser",
    "subclass_name": null,
    "function_name": "setMetadata(Metadata metadata, HashMap<String,String> properties)",
    "function_body": "{\n\n      \n      \n      metadata.set(Metadata.CONTENT_TYPE,  clean(\"text/anpa-1312\"));\n      metadata.set(TikaCoreProperties.TITLE,         clean(properties.get(\"title\")));\n      metadata.set(TikaCoreProperties.SUBJECT,       clean(properties.get(\"subject\")));\n      metadata.set(TikaCoreProperties.CREATOR,        clean(properties.get(\"author\")));\n      metadata.set(TikaCoreProperties.CREATED, clean(properties.get(\"created\")));\n      metadata.set(TikaCoreProperties.MODIFIED,      clean(properties.get(\"modified\")));\n      metadata.set(TikaCoreProperties.SOURCE,      clean(properties.get(\"source\")));\n\n      metadata.set(TikaCoreProperties.PUBLISHER,     clean(this.getFormatName()));\n\n\n   }"
  },
  {
    "id": 33,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 13,
    "human_patch": "https://github.com/apache/tika/commit/8a6a9e1344f5b10ebfa1a189dc3c30d0da2b9d4",
    "cve_id": "CVE-2018-8017",
    "cwe_id": "CWE-835",
    "filename": "tika-parsers/src/main/java/org/apache/tika/parser/iptc/IptcAnpaParser.java",
    "is_vulnerable": 0,
    "class_name": "IptcAnpaParser",
    "subclass_name": null,
    "function_name": "clean(String value)",
    "function_body": "{\n      if (value == null) {\n         value = \"\";\n      }\n\n      value = value.replaceAll(\"``\", \"`\");\n      value = value.replaceAll(\"''\", \"'\");\n      value = value.replaceAll(new String(new char[] {SL}), \"'\");\n      value = value.replaceAll(new String(new char[] {SR}), \"'\");\n      value = value.replaceAll(new String(new char[] {DL}), \"\\\"\");\n      value = value.replaceAll(new String(new char[] {DR}), \"\\\"\");\n      value = value.trim();\n\n      return (value);\n   }"
  },
  {
    "id": 34,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 0,
    "human_patch": "https://github.com/apache/tomee/commit/58cdbbef9c77ab2b44870f9d606593b49cde76d9",
    "cve_id": "CVE-2015-8581",
    "cwe_id": "CWE-502",
    "filename": "arquillian/arquillian-tomee-common/src/main/java/org/apache/openejb/arquillian/common/Setup.java",
    "is_vulnerable": 0,
    "class_name": "Setup",
    "subclass_name": null,
    "function_name": "javaVersion()",
    "function_body": "{\n        try {\n            return Double.parseDouble(System.getProperty(\"java.version\", \"1.7\").substring(0, 3));\n        } catch (final Exception nfe) {\n            return 1.6;\n        }\n    }"
  },
  {
    "id": 34,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 1,
    "human_patch": "https://github.com/apache/tomee/commit/58cdbbef9c77ab2b44870f9d606593b49cde76d9",
    "cve_id": "CVE-2015-8581",
    "cwe_id": "CWE-502",
    "filename": "arquillian/arquillian-tomee-common/src/main/java/org/apache/openejb/arquillian/common/Setup.java",
    "is_vulnerable": 0,
    "class_name": "Setup",
    "subclass_name": null,
    "function_name": "exportProperties(final File tomeeHome, final TomEEConfiguration c, final boolean defaultMem)",
    "function_body": "{\n        final int httpPort = c.getHttpPort();\n        System.setProperty(\"java.naming.provider.url\", \"http://\" + c.getHost() + \":\" + httpPort + \"/tomee/ejb\");\n        System.setProperty(\"connect.tries\", \"90\");\n        System.setProperty(\"server.http.port\", String.valueOf(httpPort));\n        System.setProperty(\"server.shutdown.port\", String.valueOf(c.getStopPort()));\n        if (defaultMem) {\n            System.setProperty(\"java.opts\", DEFAULT_MEM_CONFIG + \" -Dtomee.httpPort=\" + httpPort);\n        } else {\n            System.setProperty(\"java.opts\", \"-Dtomee.httpPort=\" + httpPort);\n        }\n        System.setProperty(\"openejb.home\", tomeeHome.getAbsolutePath());\n        System.setProperty(\"tomee.home\", tomeeHome.getAbsolutePath());\n    }"
  },
  {
    "id": 34,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 2,
    "human_patch": "https://github.com/apache/tomee/commit/58cdbbef9c77ab2b44870f9d606593b49cde76d9",
    "cve_id": "CVE-2015-8581",
    "cwe_id": "CWE-502",
    "filename": "arquillian/arquillian-tomee-common/src/main/java/org/apache/openejb/arquillian/common/Setup.java",
    "is_vulnerable": 0,
    "class_name": "Setup",
    "subclass_name": null,
    "function_name": "updateServerXml(final File tomeeHome, final TomEEConfiguration configuration) throws IOException",
    "function_body": "{\n        final File serverXml = Files.path(new File(tomeeHome.getAbsolutePath()), \"conf\", \"server.xml\");\n        if (!serverXml.exists()) {\n            return;\n        }\n\n        final QuickServerXmlParser ports = QuickServerXmlParser.parse(serverXml);\n        if (configuration.getKeepServerXmlAsThis()) {\n            \n            configuration.setHttpPort(Integer.parseInt(ports.http()));\n            configuration.setStopPort(Integer.parseInt(ports.stop()));\n            return; \n        }\n\n        final Map<String, String> replacements = new HashMap<>();\n        replacements.put(ports.http(), String.valueOf(configuration.getHttpPort()));\n        replacements.put(ports.https(), String.valueOf(configuration.getHttpsPort()));\n        replacements.put(ports.stop(), String.valueOf(configuration.getStopPort()));\n        replacements.put(ports.ajp(), String.valueOf(ajpPort(configuration)));\n\n        if (configuration.isUnpackWars()) {\n            replacements.put(\"unpackWARs=\\\"false\\\"\", \"unpackWARs=\\\"true\\\"\");\n        } else {\n            replacements.put(\"unpackWARs=\\\"true\\\"\", \"unpackWARs=\\\"false\\\"\");\n        }\n\n        replace(replacements, serverXml, true);\n    }"
  },
  {
    "id": 34,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 3,
    "human_patch": "https://github.com/apache/tomee/commit/58cdbbef9c77ab2b44870f9d606593b49cde76d9",
    "cve_id": "CVE-2015-8581",
    "cwe_id": "CWE-502",
    "filename": "arquillian/arquillian-tomee-common/src/main/java/org/apache/openejb/arquillian/common/Setup.java",
    "is_vulnerable": 0,
    "class_name": "Setup",
    "subclass_name": null,
    "function_name": "findHome(File directory)",
    "function_body": "{\n\n        directory = directory.getAbsoluteFile();\n\n        final File f = findHomeImpl(directory);\n\n        if (null == f) {\n            LOGGER.log(Level.INFO, \"Unable to find home in: \" + directory);\n        }\n\n        return f;\n    }"
  },
  {
    "id": 34,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 4,
    "human_patch": "https://github.com/apache/tomee/commit/58cdbbef9c77ab2b44870f9d606593b49cde76d9",
    "cve_id": "CVE-2015-8581",
    "cwe_id": "CWE-502",
    "filename": "arquillian/arquillian-tomee-common/src/main/java/org/apache/openejb/arquillian/common/Setup.java",
    "is_vulnerable": 0,
    "class_name": "Setup",
    "subclass_name": null,
    "function_name": "findHomeImpl(final File directory)",
    "function_body": "{\n        final File conf = new File(directory, \"conf\").getAbsoluteFile();\n        final File webapps = new File(directory, \"webapps\").getAbsoluteFile();\n\n        if (conf.exists() && conf.isDirectory() && webapps.exists() && webapps.isDirectory()) {\n            return directory;\n        }\n\n        final File[] files = directory.listFiles();\n        if (null != files) {\n\n            for (final File file : files) {\n                if (\".\".equals(file.getName()) || \"..\".equals(file.getName())) {\n                    continue;\n                }\n\n                final File found = findHome(file);\n\n                if (found != null) {\n                    return found;\n                }\n            }\n        }\n\n        return null;\n    }"
  },
  {
    "id": 34,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 5,
    "human_patch": "https://github.com/apache/tomee/commit/58cdbbef9c77ab2b44870f9d606593b49cde76d9",
    "cve_id": "CVE-2015-8581",
    "cwe_id": "CWE-502",
    "filename": "arquillian/arquillian-tomee-common/src/main/java/org/apache/openejb/arquillian/common/Setup.java",
    "is_vulnerable": 0,
    "class_name": "Setup",
    "subclass_name": null,
    "function_name": "downloadAndUnpack(final File dir, final String artifactID, final String defaultTempDir) throws LifecycleException",
    "function_body": "{\n\n        final File zipFile = downloadFile(artifactID, null, defaultTempDir);\n\n        Zips.unzip(zipFile, dir);\n\n        return findHome(dir);\n    }"
  },
  {
    "id": 34,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 6,
    "human_patch": "https://github.com/apache/tomee/commit/58cdbbef9c77ab2b44870f9d606593b49cde76d9",
    "cve_id": "CVE-2015-8581",
    "cwe_id": "CWE-502",
    "filename": "arquillian/arquillian-tomee-common/src/main/java/org/apache/openejb/arquillian/common/Setup.java",
    "is_vulnerable": 0,
    "class_name": "Setup",
    "subclass_name": null,
    "function_name": "downloadFile(final String artifactName, final String altUrl, final String defaultTempDir)",
    "function_body": "{\n        final String cache = SystemInstance.isInitialized() ?\n            SystemInstance.get().getOptions().get(ProvisioningResolver.OPENEJB_DEPLOYER_CACHE_FOLDER, (String) null) :\n            System.getProperty(ProvisioningResolver.OPENEJB_DEPLOYER_CACHE_FOLDER);\n        if (cache == null && defaultTempDir != null) { \n            System.setProperty(ProvisioningResolver.OPENEJB_DEPLOYER_CACHE_FOLDER, defaultTempDir);\n        }\n\n        try {\n            final File artifact = MavenCache.getArtifact(artifactName, altUrl);\n            if (artifact == null) {\n                throw new NullPointerException(String.format(\"No such artifact: %s\", artifactName));\n            }\n            return artifact.getAbsoluteFile();\n        } finally {\n            if (cache == null) {\n                System.clearProperty(ProvisioningResolver.OPENEJB_DEPLOYER_CACHE_FOLDER);\n            }\n        }\n    }"
  },
  {
    "id": 34,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 7,
    "human_patch": "https://github.com/apache/tomee/commit/58cdbbef9c77ab2b44870f9d606593b49cde76d9",
    "cve_id": "CVE-2015-8581",
    "cwe_id": "CWE-502",
    "filename": "arquillian/arquillian-tomee-common/src/main/java/org/apache/openejb/arquillian/common/Setup.java",
    "is_vulnerable": 0,
    "class_name": "Setup",
    "subclass_name": null,
    "function_name": "isRunning(final String host, final int port)",
    "function_body": "{\n        Socket socket = null;\n        try {\n            socket = new Socket(host, port);\n            socket.getOutputStream().close();\n            return true;\n        } catch (final Exception e) {\n            return false;\n        } finally {\n            if (socket != null) {\n                try {\n                    socket.close();\n                } catch (final IOException ignored) {\n                    \n                }\n            }\n        }\n    }"
  },
  {
    "id": 34,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 8,
    "human_patch": "https://github.com/apache/tomee/commit/58cdbbef9c77ab2b44870f9d606593b49cde76d9",
    "cve_id": "CVE-2015-8581",
    "cwe_id": "CWE-502",
    "filename": "arquillian/arquillian-tomee-common/src/main/java/org/apache/openejb/arquillian/common/Setup.java",
    "is_vulnerable": 0,
    "class_name": "Setup",
    "subclass_name": null,
    "function_name": "replace(final Map<String, String> replacements, final File file, final boolean escape) throws IOException",
    "function_body": "{\n\n        InputStream in = IO.read(file);\n\n        if (escape) {\n            final Map<String, String> escaped = new HashMap<>();\n            for (final Map.Entry<String, String> entry : replacements.entrySet()) {\n                final String key = entry.getKey();\n                final String value = entry.getValue();\n                if (key.startsWith(\"\\\"\") && key.endsWith(\"\\\"\")) {\n                    escaped.put(key, value);\n                } else {\n                    escaped.put(\"\\\"\" + key + \"\\\"\", \"\\\"\" + value + \"\\\"\");\n                }\n            }\n\n            replacements.clear();\n            replacements.putAll(escaped);\n        }\n\n        in = new ReplaceStringsInputStream(in, replacements);\n\n        final String data = IO.slurp(in);\n\n        IO.copy(data.getBytes(), file);\n\n        if (LOGGER.isLoggable(Level.FINE)) {\n            IO.copy(data.getBytes(), System.out);\n        }\n    }"
  },
  {
    "id": 34,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 9,
    "human_patch": "https://github.com/apache/tomee/commit/58cdbbef9c77ab2b44870f9d606593b49cde76d9",
    "cve_id": "CVE-2015-8581",
    "cwe_id": "CWE-502",
    "filename": "arquillian/arquillian-tomee-common/src/main/java/org/apache/openejb/arquillian/common/Setup.java",
    "is_vulnerable": 0,
    "class_name": "Setup",
    "subclass_name": null,
    "function_name": "removeUselessWebapps(final File tomeeHome, final String... exceptions)",
    "function_body": "{\n        final File webapps = new File(tomeeHome, \"webapps\");\n        if (webapps.isDirectory()) {\n            final File[] files = webapps.listFiles();\n            if (files != null) {\n                for (final File webapp : files) {\n                    boolean delete = true;\n                    if (exceptions != null) {\n                        for (final String ignore : exceptions) {\n                            if (webapp.getName().equals(ignore)) {\n                                delete = false;\n                                break;\n                            }\n                        }\n                    }\n                    if (delete) {\n                        org.apache.openejb.loader.Files.delete(webapp);\n                    }\n                }\n            }\n        }\n    }"
  },
  {
    "id": 34,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 10,
    "human_patch": "https://github.com/apache/tomee/commit/58cdbbef9c77ab2b44870f9d606593b49cde76d9",
    "cve_id": "CVE-2015-8581",
    "cwe_id": "CWE-502",
    "filename": "arquillian/arquillian-tomee-common/src/main/java/org/apache/openejb/arquillian/common/Setup.java",
    "is_vulnerable": 0,
    "class_name": "Setup",
    "subclass_name": null,
    "function_name": "configureServerXml(final File tomeeHome, final TomEEConfiguration configuration) throws IOException",
    "function_body": "{\n\n        if (configuration.getServerXml() != null) {\n\n            final File serverXml = new File(configuration.getServerXml());\n\n            if (!serverXml.exists()) {\n                LOGGER.severe(\"Provided server.xml doesn't exist: '\" + serverXml.getPath() + \"'\");\n            } else {\n\n                \n                final String data = IO.slurp(serverXml);\n\n                IO.copy(data.getBytes(), Files.path(tomeeHome, \"conf\", \"server.xml\"));\n            }\n        }\n        updateServerXml(tomeeHome, configuration);\n    }"
  },
  {
    "id": 34,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 11,
    "human_patch": "https://github.com/apache/tomee/commit/58cdbbef9c77ab2b44870f9d606593b49cde76d9",
    "cve_id": "CVE-2015-8581",
    "cwe_id": "CWE-502",
    "filename": "arquillian/arquillian-tomee-common/src/main/java/org/apache/openejb/arquillian/common/Setup.java",
    "is_vulnerable": 0,
    "class_name": "Setup",
    "subclass_name": null,
    "function_name": "ajpPort(final TomEEConfiguration config)",
    "function_body": "{\n        try {\n            final Method ajbPort = config.getClass().getMethod(\"getAjpPort\");\n            return (Integer) ajbPort.invoke(config);\n        } catch (final Exception e) {\n            return Integer.parseInt(QuickServerXmlParser.DEFAULT_AJP_PORT);\n        }\n    }"
  },
  {
    "id": 34,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 12,
    "human_patch": "https://github.com/apache/tomee/commit/58cdbbef9c77ab2b44870f9d606593b49cde76d9",
    "cve_id": "CVE-2015-8581",
    "cwe_id": "CWE-502",
    "filename": "arquillian/arquillian-tomee-common/src/main/java/org/apache/openejb/arquillian/common/Setup.java",
    "is_vulnerable": 1,
    "class_name": "Setup",
    "subclass_name": null,
    "function_name": "configureSystemProperties(final File tomeeHome, final TomEEConfiguration configuration)",
    "function_body": "{\n        final File file = Files.path(tomeeHome, \"conf\", \"system.properties\");\n\n        \n        final Properties properties = new Properties();\n\n        if (file.exists()) {\n            try {\n                IO.readProperties(file, properties);\n            } catch (final IOException e) {\n                LOGGER.log(Level.SEVERE, \"Can't read \" + file.getAbsolutePath(), e);\n            }\n        }\n\n        if (configuration.getProperties() != null) {\n            try {\n                final InputStream bytes = IO.read(configuration.getProperties().getBytes());\n                IO.readProperties(bytes, properties);\n            } catch (final IOException e) {\n                LOGGER.log(Level.SEVERE, \"Can't parse <property name=\\\"properties\\\"> value '\" + configuration.getProperties() + \"'\", e);\n            }\n        }\n\n        if (configuration.isQuickSession()) {\n            properties.put(\"openejb.session.manager\", \"org.apache.tomee.catalina.session.QuickSessionManager\");\n        }\n\n        try {\n            IO.writeProperties(file, properties);\n        } catch (final IOException e) {\n            LOGGER.log(Level.SEVERE, \"Can't save system properties \" + file.getAbsolutePath(), e);\n        }\n    }"
  },
  {
    "id": 34,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 13,
    "human_patch": "https://github.com/apache/tomee/commit/58cdbbef9c77ab2b44870f9d606593b49cde76d9",
    "cve_id": "CVE-2015-8581",
    "cwe_id": "CWE-502",
    "filename": "arquillian/arquillian-tomee-common/src/main/java/org/apache/openejb/arquillian/common/Setup.java",
    "is_vulnerable": 0,
    "class_name": "Setup",
    "subclass_name": null,
    "function_name": "synchronizeFolder(final File tomeeHome, final String src, final String dir)",
    "function_body": "{\n        if (src != null && !src.isEmpty()) {\n            final File confSrc = new File(src);\n            if (confSrc.exists()) {\n                final File conf = new File(tomeeHome, dir);\n                final Collection<File> files = org.apache.openejb.loader.Files.collect(confSrc, TrueFilter.INSTANCE);\n                files.remove(confSrc);\n                for (final File f : files) {\n                    if (f.equals(confSrc) || f.getName().startsWith(\".\")) {\n                        continue;\n                    }\n\n                    final String relativize = relativize(f, confSrc);\n                    if (f.isDirectory()) {\n                        final String path = dir + '/' + relativize;\n                        Files.mkdir(new File(tomeeHome, path));\n                        synchronizeFolder(tomeeHome, f.getAbsolutePath(), path);\n                    } else {\n                        try {\n                            final File to = new File(conf, relativize);\n                            Files.mkdir(to.getParentFile());\n                            org.apache.openejb.loader.IO.copy(f, to);\n                        } catch (final Exception e) {\n                            LOGGER.log(Level.WARNING, \"Ignoring copy of \" + f.getAbsolutePath(), e);\n                        }\n                    }\n                }\n            } else {\n                LOGGER.warning(\"Can't find \" + confSrc.getAbsolutePath());\n            }\n        }\n    }"
  },
  {
    "id": 34,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 14,
    "human_patch": "https://github.com/apache/tomee/commit/58cdbbef9c77ab2b44870f9d606593b49cde76d9",
    "cve_id": "CVE-2015-8581",
    "cwe_id": "CWE-502",
    "filename": "arquillian/arquillian-tomee-common/src/main/java/org/apache/openejb/arquillian/common/Setup.java",
    "is_vulnerable": 0,
    "class_name": "Setup",
    "subclass_name": null,
    "function_name": "relativize(final File f, final File base)",
    "function_body": "{\n        return f.getAbsolutePath().substring(base.getAbsolutePath().length() + 1);\n    }"
  },
  {
    "id": 34,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 15,
    "human_patch": "https://github.com/apache/tomee/commit/58cdbbef9c77ab2b44870f9d606593b49cde76d9",
    "cve_id": "CVE-2015-8581",
    "cwe_id": "CWE-502",
    "filename": "arquillian/arquillian-tomee-common/src/main/java/org/apache/openejb/arquillian/common/Setup.java",
    "is_vulnerable": 0,
    "class_name": "Setup",
    "subclass_name": null,
    "function_name": "installArquillianBeanDiscoverer(final File home)",
    "function_body": "{\n        final File destination = new File(home, TOMEE_BEAN_DISCOVERER_JAR);\n        ShrinkWrap.create(JavaArchive.class, destination.getName())\n                .addClasses(BeanDicovererInstaller.class, TestClassDiscoverer.class, ArquillianFilterRunner.class, Discover.class)\n                .addAsManifestResource(new StringAsset(BeanDicovererInstaller.class.getName()), ArchivePaths.create(\"org.apache.openejb.extension\"))\n                .as(ZipExporter.class).exportTo(destination, false);\n    }"
  },
  {
    "id": 34,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 16,
    "human_patch": "https://github.com/apache/tomee/commit/58cdbbef9c77ab2b44870f9d606593b49cde76d9",
    "cve_id": "CVE-2015-8581",
    "cwe_id": "CWE-502",
    "filename": "arquillian/arquillian-tomee-common/src/main/java/org/apache/openejb/arquillian/common/Setup.java",
    "is_vulnerable": 0,
    "class_name": "Setup",
    "subclass_name": null,
    "function_name": "removeArquillianBeanDiscoverer(final File home)",
    "function_body": "{\n        final File destination = new File(home, TOMEE_BEAN_DISCOVERER_JAR);\n        Files.delete(destination);\n    }"
  },
  {
    "id": 34,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 17,
    "human_patch": "https://github.com/apache/tomee/commit/58cdbbef9c77ab2b44870f9d606593b49cde76d9",
    "cve_id": "CVE-2015-8581",
    "cwe_id": "CWE-502",
    "filename": "arquillian/arquillian-tomee-common/src/main/java/org/apache/openejb/arquillian/common/Setup.java",
    "is_vulnerable": 0,
    "class_name": "Setup",
    "subclass_name": null,
    "function_name": "addTomEELibraries(final File libFolder, final String additionalLibs, final boolean parseArgs)",
    "function_body": "{\n        if (additionalLibs == null) {\n            return emptyMap();\n        }\n        final String libs = additionalLibs.trim();\n        if (libs.isEmpty()) {\n            return emptyMap();\n        }\n\n        try { \n            if (!SystemInstance.isInitialized()) {\n                SystemInstance.init(new Properties());\n            }\n        } catch (final Exception e) {\n            \n        }\n\n        final Map<File, String> configs = new HashMap<>();\n        for (final String lib : libs.split(\"\\n\")) {\n            final String trim = lib.trim();\n            if (trim.isEmpty() || trim.startsWith(\"#\")) {\n                continue;\n            }\n\n            final String args;\n            if (parseArgs) { \n                int argsIdx = trim.indexOf('=');\n                if (argsIdx < 0) {\n                    argsIdx = trim.indexOf('?');\n                }\n                if (argsIdx > 0) {\n                    args = trim.substring(argsIdx);\n                } else {\n                    args = \"\";\n                }\n            } else {\n                args = null;\n            }\n\n            final Set<String> locations = ProvisioningUtil.realLocation(trim);\n            for (final String location : locations) {\n                final File from = new File(location);\n                try {\n                    final File to = new File(libFolder, from.getName());\n                    org.apache.openejb.loader.IO.copy(from, to);\n                    if (args != null) {\n                        configs.put(to, args);\n                    }\n                } catch (final IOException e) {\n                    throw new IllegalArgumentException(e);\n                }\n            }\n        }\n        return configs;\n    }"
  },
  {
    "id": 34,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 18,
    "human_patch": "https://github.com/apache/tomee/commit/58cdbbef9c77ab2b44870f9d606593b49cde76d9",
    "cve_id": "CVE-2015-8581",
    "cwe_id": "CWE-502",
    "filename": "arquillian/arquillian-tomee-common/src/main/java/org/apache/openejb/arquillian/common/Setup.java",
    "is_vulnerable": 0,
    "class_name": "Setup",
    "subclass_name": "TrueFilter",
    "function_name": "accept(final File pathname)",
    "function_body": "{\n            return true;\n        }"
  },
  {
    "id": 34,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 0,
    "human_patch": "https://github.com/apache/tomee/commit/58cdbbef9c77ab2b44870f9d606593b49cde76d9",
    "cve_id": "CVE-2015-8581",
    "cwe_id": "CWE-502",
    "filename": "arquillian/arquillian-tomee-common/src/main/java/org/apache/openejb/arquillian/common/TomEEConfiguration.java",
    "is_vulnerable": 0,
    "class_name": "TomEEConfiguration",
    "subclass_name": null,
    "function_name": "isUnpackWars()",
    "function_body": "{\n        return unpackWars;\n    }"
  },
  {
    "id": 34,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 1,
    "human_patch": "https://github.com/apache/tomee/commit/58cdbbef9c77ab2b44870f9d606593b49cde76d9",
    "cve_id": "CVE-2015-8581",
    "cwe_id": "CWE-502",
    "filename": "arquillian/arquillian-tomee-common/src/main/java/org/apache/openejb/arquillian/common/TomEEConfiguration.java",
    "is_vulnerable": 0,
    "class_name": "TomEEConfiguration",
    "subclass_name": null,
    "function_name": "setUnpackWars(final boolean unpackWars)",
    "function_body": "{\n        this.unpackWars = unpackWars;\n    }"
  },
  {
    "id": 34,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 2,
    "human_patch": "https://github.com/apache/tomee/commit/58cdbbef9c77ab2b44870f9d606593b49cde76d9",
    "cve_id": "CVE-2015-8581",
    "cwe_id": "CWE-502",
    "filename": "arquillian/arquillian-tomee-common/src/main/java/org/apache/openejb/arquillian/common/TomEEConfiguration.java",
    "is_vulnerable": 0,
    "class_name": "TomEEConfiguration",
    "subclass_name": null,
    "function_name": "getHttpsPort()",
    "function_body": "{\n        return httpsPort;\n    }"
  },
  {
    "id": 34,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 3,
    "human_patch": "https://github.com/apache/tomee/commit/58cdbbef9c77ab2b44870f9d606593b49cde76d9",
    "cve_id": "CVE-2015-8581",
    "cwe_id": "CWE-502",
    "filename": "arquillian/arquillian-tomee-common/src/main/java/org/apache/openejb/arquillian/common/TomEEConfiguration.java",
    "is_vulnerable": 0,
    "class_name": "TomEEConfiguration",
    "subclass_name": null,
    "function_name": "setHttpsPort(final int httpsPort)",
    "function_body": "{\n        this.httpsPort = httpsPort;\n    }"
  },
  {
    "id": 34,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 4,
    "human_patch": "https://github.com/apache/tomee/commit/58cdbbef9c77ab2b44870f9d606593b49cde76d9",
    "cve_id": "CVE-2015-8581",
    "cwe_id": "CWE-502",
    "filename": "arquillian/arquillian-tomee-common/src/main/java/org/apache/openejb/arquillian/common/TomEEConfiguration.java",
    "is_vulnerable": 0,
    "class_name": "TomEEConfiguration",
    "subclass_name": null,
    "function_name": "getHttpPort()",
    "function_body": "{\n        return httpPort;\n    }"
  },
  {
    "id": 34,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 5,
    "human_patch": "https://github.com/apache/tomee/commit/58cdbbef9c77ab2b44870f9d606593b49cde76d9",
    "cve_id": "CVE-2015-8581",
    "cwe_id": "CWE-502",
    "filename": "arquillian/arquillian-tomee-common/src/main/java/org/apache/openejb/arquillian/common/TomEEConfiguration.java",
    "is_vulnerable": 0,
    "class_name": "TomEEConfiguration",
    "subclass_name": null,
    "function_name": "setHttpPort(final int httpPort)",
    "function_body": "{\n        this.httpPort = httpPort;\n    }"
  },
  {
    "id": 34,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 6,
    "human_patch": "https://github.com/apache/tomee/commit/58cdbbef9c77ab2b44870f9d606593b49cde76d9",
    "cve_id": "CVE-2015-8581",
    "cwe_id": "CWE-502",
    "filename": "arquillian/arquillian-tomee-common/src/main/java/org/apache/openejb/arquillian/common/TomEEConfiguration.java",
    "is_vulnerable": 0,
    "class_name": "TomEEConfiguration",
    "subclass_name": null,
    "function_name": "getStopPort()",
    "function_body": "{\n        return stopPort;\n    }"
  },
  {
    "id": 34,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 7,
    "human_patch": "https://github.com/apache/tomee/commit/58cdbbef9c77ab2b44870f9d606593b49cde76d9",
    "cve_id": "CVE-2015-8581",
    "cwe_id": "CWE-502",
    "filename": "arquillian/arquillian-tomee-common/src/main/java/org/apache/openejb/arquillian/common/TomEEConfiguration.java",
    "is_vulnerable": 0,
    "class_name": "TomEEConfiguration",
    "subclass_name": null,
    "function_name": "setStopPort(final int stopPort)",
    "function_body": "{\n        this.stopPort = stopPort;\n    }"
  },
  {
    "id": 34,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 8,
    "human_patch": "https://github.com/apache/tomee/commit/58cdbbef9c77ab2b44870f9d606593b49cde76d9",
    "cve_id": "CVE-2015-8581",
    "cwe_id": "CWE-502",
    "filename": "arquillian/arquillian-tomee-common/src/main/java/org/apache/openejb/arquillian/common/TomEEConfiguration.java",
    "is_vulnerable": 0,
    "class_name": "TomEEConfiguration",
    "subclass_name": null,
    "function_name": "getDir()",
    "function_body": "{\n        return dir;\n    }"
  },
  {
    "id": 34,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 9,
    "human_patch": "https://github.com/apache/tomee/commit/58cdbbef9c77ab2b44870f9d606593b49cde76d9",
    "cve_id": "CVE-2015-8581",
    "cwe_id": "CWE-502",
    "filename": "arquillian/arquillian-tomee-common/src/main/java/org/apache/openejb/arquillian/common/TomEEConfiguration.java",
    "is_vulnerable": 0,
    "class_name": "TomEEConfiguration",
    "subclass_name": null,
    "function_name": "setDir(final String dir)",
    "function_body": "{\n        this.dir = dir;\n    }"
  },
  {
    "id": 34,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 10,
    "human_patch": "https://github.com/apache/tomee/commit/58cdbbef9c77ab2b44870f9d606593b49cde76d9",
    "cve_id": "CVE-2015-8581",
    "cwe_id": "CWE-502",
    "filename": "arquillian/arquillian-tomee-common/src/main/java/org/apache/openejb/arquillian/common/TomEEConfiguration.java",
    "is_vulnerable": 0,
    "class_name": "TomEEConfiguration",
    "subclass_name": null,
    "function_name": "getAppWorkingDir()",
    "function_body": "{\n        return appWorkingDir;\n    }"
  },
  {
    "id": 34,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 11,
    "human_patch": "https://github.com/apache/tomee/commit/58cdbbef9c77ab2b44870f9d606593b49cde76d9",
    "cve_id": "CVE-2015-8581",
    "cwe_id": "CWE-502",
    "filename": "arquillian/arquillian-tomee-common/src/main/java/org/apache/openejb/arquillian/common/TomEEConfiguration.java",
    "is_vulnerable": 0,
    "class_name": "TomEEConfiguration",
    "subclass_name": null,
    "function_name": "setAppWorkingDir(final String appWorkingDir)",
    "function_body": "{\n        this.appWorkingDir = appWorkingDir;\n    }"
  },
  {
    "id": 34,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 12,
    "human_patch": "https://github.com/apache/tomee/commit/58cdbbef9c77ab2b44870f9d606593b49cde76d9",
    "cve_id": "CVE-2015-8581",
    "cwe_id": "CWE-502",
    "filename": "arquillian/arquillian-tomee-common/src/main/java/org/apache/openejb/arquillian/common/TomEEConfiguration.java",
    "is_vulnerable": 0,
    "class_name": "TomEEConfiguration",
    "subclass_name": null,
    "function_name": "validate() throws ConfigurationException",
    "function_body": "{\n    }"
  },
  {
    "id": 34,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 13,
    "human_patch": "https://github.com/apache/tomee/commit/58cdbbef9c77ab2b44870f9d606593b49cde76d9",
    "cve_id": "CVE-2015-8581",
    "cwe_id": "CWE-502",
    "filename": "arquillian/arquillian-tomee-common/src/main/java/org/apache/openejb/arquillian/common/TomEEConfiguration.java",
    "is_vulnerable": 0,
    "class_name": "TomEEConfiguration",
    "subclass_name": null,
    "function_name": "getExportConfAsSystemProperty()",
    "function_body": "{\n        return exportConfAsSystemProperty;\n    }"
  },
  {
    "id": 34,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 14,
    "human_patch": "https://github.com/apache/tomee/commit/58cdbbef9c77ab2b44870f9d606593b49cde76d9",
    "cve_id": "CVE-2015-8581",
    "cwe_id": "CWE-502",
    "filename": "arquillian/arquillian-tomee-common/src/main/java/org/apache/openejb/arquillian/common/TomEEConfiguration.java",
    "is_vulnerable": 0,
    "class_name": "TomEEConfiguration",
    "subclass_name": null,
    "function_name": "setExportConfAsSystemProperty(final boolean exportConfAsSystemProperty)",
    "function_body": "{\n        this.exportConfAsSystemProperty = exportConfAsSystemProperty;\n    }"
  },
  {
    "id": 34,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 15,
    "human_patch": "https://github.com/apache/tomee/commit/58cdbbef9c77ab2b44870f9d606593b49cde76d9",
    "cve_id": "CVE-2015-8581",
    "cwe_id": "CWE-502",
    "filename": "arquillian/arquillian-tomee-common/src/main/java/org/apache/openejb/arquillian/common/TomEEConfiguration.java",
    "is_vulnerable": 0,
    "class_name": "TomEEConfiguration",
    "subclass_name": null,
    "function_name": "getHost()",
    "function_body": "{\n        return host;\n    }"
  },
  {
    "id": 34,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 16,
    "human_patch": "https://github.com/apache/tomee/commit/58cdbbef9c77ab2b44870f9d606593b49cde76d9",
    "cve_id": "CVE-2015-8581",
    "cwe_id": "CWE-502",
    "filename": "arquillian/arquillian-tomee-common/src/main/java/org/apache/openejb/arquillian/common/TomEEConfiguration.java",
    "is_vulnerable": 0,
    "class_name": "TomEEConfiguration",
    "subclass_name": null,
    "function_name": "setHost(final String host)",
    "function_body": "{\n        this.host = host;\n    }"
  },
  {
    "id": 34,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 17,
    "human_patch": "https://github.com/apache/tomee/commit/58cdbbef9c77ab2b44870f9d606593b49cde76d9",
    "cve_id": "CVE-2015-8581",
    "cwe_id": "CWE-502",
    "filename": "arquillian/arquillian-tomee-common/src/main/java/org/apache/openejb/arquillian/common/TomEEConfiguration.java",
    "is_vulnerable": 0,
    "class_name": "TomEEConfiguration",
    "subclass_name": null,
    "function_name": "getServerXml()",
    "function_body": "{\n        return serverXml;\n    }"
  },
  {
    "id": 34,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 18,
    "human_patch": "https://github.com/apache/tomee/commit/58cdbbef9c77ab2b44870f9d606593b49cde76d9",
    "cve_id": "CVE-2015-8581",
    "cwe_id": "CWE-502",
    "filename": "arquillian/arquillian-tomee-common/src/main/java/org/apache/openejb/arquillian/common/TomEEConfiguration.java",
    "is_vulnerable": 0,
    "class_name": "TomEEConfiguration",
    "subclass_name": null,
    "function_name": "setServerXml(final String serverXml)",
    "function_body": "{\n        this.serverXml = serverXml;\n    }"
  },
  {
    "id": 34,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 19,
    "human_patch": "https://github.com/apache/tomee/commit/58cdbbef9c77ab2b44870f9d606593b49cde76d9",
    "cve_id": "CVE-2015-8581",
    "cwe_id": "CWE-502",
    "filename": "arquillian/arquillian-tomee-common/src/main/java/org/apache/openejb/arquillian/common/TomEEConfiguration.java",
    "is_vulnerable": 0,
    "class_name": "TomEEConfiguration",
    "subclass_name": null,
    "function_name": "getProperties()",
    "function_body": "{\n        return properties;\n    }"
  },
  {
    "id": 34,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 20,
    "human_patch": "https://github.com/apache/tomee/commit/58cdbbef9c77ab2b44870f9d606593b49cde76d9",
    "cve_id": "CVE-2015-8581",
    "cwe_id": "CWE-502",
    "filename": "arquillian/arquillian-tomee-common/src/main/java/org/apache/openejb/arquillian/common/TomEEConfiguration.java",
    "is_vulnerable": 0,
    "class_name": "TomEEConfiguration",
    "subclass_name": null,
    "function_name": "setProperties(final String properties)",
    "function_body": "{\n        this.properties = properties;\n    }"
  },
  {
    "id": 34,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 21,
    "human_patch": "https://github.com/apache/tomee/commit/58cdbbef9c77ab2b44870f9d606593b49cde76d9",
    "cve_id": "CVE-2015-8581",
    "cwe_id": "CWE-502",
    "filename": "arquillian/arquillian-tomee-common/src/main/java/org/apache/openejb/arquillian/common/TomEEConfiguration.java",
    "is_vulnerable": 0,
    "class_name": "TomEEConfiguration",
    "subclass_name": null,
    "function_name": "systemProperties()",
    "function_body": "{\n        return properties.replaceAll(\"\\n *\", \"\\n\");\n    }"
  },
  {
    "id": 34,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 22,
    "human_patch": "https://github.com/apache/tomee/commit/58cdbbef9c77ab2b44870f9d606593b49cde76d9",
    "cve_id": "CVE-2015-8581",
    "cwe_id": "CWE-502",
    "filename": "arquillian/arquillian-tomee-common/src/main/java/org/apache/openejb/arquillian/common/TomEEConfiguration.java",
    "is_vulnerable": 0,
    "class_name": "TomEEConfiguration",
    "subclass_name": null,
    "function_name": "getPortRange()",
    "function_body": "{\n        return portRange;\n    }"
  },
  {
    "id": 34,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 23,
    "human_patch": "https://github.com/apache/tomee/commit/58cdbbef9c77ab2b44870f9d606593b49cde76d9",
    "cve_id": "CVE-2015-8581",
    "cwe_id": "CWE-502",
    "filename": "arquillian/arquillian-tomee-common/src/main/java/org/apache/openejb/arquillian/common/TomEEConfiguration.java",
    "is_vulnerable": 0,
    "class_name": "TomEEConfiguration",
    "subclass_name": null,
    "function_name": "setPortRange(final String portRange)",
    "function_body": "{\n        this.portRange = portRange;\n    }"
  },
  {
    "id": 34,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 24,
    "human_patch": "https://github.com/apache/tomee/commit/58cdbbef9c77ab2b44870f9d606593b49cde76d9",
    "cve_id": "CVE-2015-8581",
    "cwe_id": "CWE-502",
    "filename": "arquillian/arquillian-tomee-common/src/main/java/org/apache/openejb/arquillian/common/TomEEConfiguration.java",
    "is_vulnerable": 0,
    "class_name": "TomEEConfiguration",
    "subclass_name": null,
    "function_name": "isQuickSession()",
    "function_body": "{\n        return quickSession;\n    }"
  },
  {
    "id": 34,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 25,
    "human_patch": "https://github.com/apache/tomee/commit/58cdbbef9c77ab2b44870f9d606593b49cde76d9",
    "cve_id": "CVE-2015-8581",
    "cwe_id": "CWE-502",
    "filename": "arquillian/arquillian-tomee-common/src/main/java/org/apache/openejb/arquillian/common/TomEEConfiguration.java",
    "is_vulnerable": 0,
    "class_name": "TomEEConfiguration",
    "subclass_name": null,
    "function_name": "setQuickSession(final boolean quickSession)",
    "function_body": "{\n        this.quickSession = quickSession;\n    }"
  },
  {
    "id": 34,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 26,
    "human_patch": "https://github.com/apache/tomee/commit/58cdbbef9c77ab2b44870f9d606593b49cde76d9",
    "cve_id": "CVE-2015-8581",
    "cwe_id": "CWE-502",
    "filename": "arquillian/arquillian-tomee-common/src/main/java/org/apache/openejb/arquillian/common/TomEEConfiguration.java",
    "is_vulnerable": 0,
    "class_name": "TomEEConfiguration",
    "subclass_name": null,
    "function_name": "portsAlreadySet()",
    "function_body": "{\n        final List<Integer> value = new ArrayList<Integer>();\n        if (stopPort > 0) {\n            value.add(stopPort);\n        }\n        if (httpPort > 0) {\n            value.add(httpPort);\n        }\n        if (httpsPort > 0) {\n            value.add(httpsPort);\n        }\n        return toInts(value);\n    }"
  },
  {
    "id": 34,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 27,
    "human_patch": "https://github.com/apache/tomee/commit/58cdbbef9c77ab2b44870f9d606593b49cde76d9",
    "cve_id": "CVE-2015-8581",
    "cwe_id": "CWE-502",
    "filename": "arquillian/arquillian-tomee-common/src/main/java/org/apache/openejb/arquillian/common/TomEEConfiguration.java",
    "is_vulnerable": 0,
    "class_name": "TomEEConfiguration",
    "subclass_name": null,
    "function_name": "toInts(final List<Integer> values)",
    "function_body": "{\n        final int[] array = new int[values.size()];\n        for (int i = 0; i < array.length; i++) {\n            array[i] = values.get(i);\n        }\n        return array;\n    }"
  },
  {
    "id": 34,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 28,
    "human_patch": "https://github.com/apache/tomee/commit/58cdbbef9c77ab2b44870f9d606593b49cde76d9",
    "cve_id": "CVE-2015-8581",
    "cwe_id": "CWE-502",
    "filename": "arquillian/arquillian-tomee-common/src/main/java/org/apache/openejb/arquillian/common/TomEEConfiguration.java",
    "is_vulnerable": 0,
    "class_name": "TomEEConfiguration",
    "subclass_name": null,
    "function_name": "getStopHost()",
    "function_body": "{\n        return stopHost;\n    }"
  },
  {
    "id": 34,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 29,
    "human_patch": "https://github.com/apache/tomee/commit/58cdbbef9c77ab2b44870f9d606593b49cde76d9",
    "cve_id": "CVE-2015-8581",
    "cwe_id": "CWE-502",
    "filename": "arquillian/arquillian-tomee-common/src/main/java/org/apache/openejb/arquillian/common/TomEEConfiguration.java",
    "is_vulnerable": 0,
    "class_name": "TomEEConfiguration",
    "subclass_name": null,
    "function_name": "setStopHost(final String stopHost)",
    "function_body": "{\n        this.stopHost = stopHost;\n    }"
  },
  {
    "id": 34,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 30,
    "human_patch": "https://github.com/apache/tomee/commit/58cdbbef9c77ab2b44870f9d606593b49cde76d9",
    "cve_id": "CVE-2015-8581",
    "cwe_id": "CWE-502",
    "filename": "arquillian/arquillian-tomee-common/src/main/java/org/apache/openejb/arquillian/common/TomEEConfiguration.java",
    "is_vulnerable": 0,
    "class_name": "TomEEConfiguration",
    "subclass_name": null,
    "function_name": "getStopCommand()",
    "function_body": "{\n        return stopCommand + Character.toString((char) 0); \n    }"
  },
  {
    "id": 34,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 31,
    "human_patch": "https://github.com/apache/tomee/commit/58cdbbef9c77ab2b44870f9d606593b49cde76d9",
    "cve_id": "CVE-2015-8581",
    "cwe_id": "CWE-502",
    "filename": "arquillian/arquillian-tomee-common/src/main/java/org/apache/openejb/arquillian/common/TomEEConfiguration.java",
    "is_vulnerable": 0,
    "class_name": "TomEEConfiguration",
    "subclass_name": null,
    "function_name": "setStopCommand(final String stopCommand)",
    "function_body": "{\n        this.stopCommand = stopCommand;\n    }"
  },
  {
    "id": 34,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 32,
    "human_patch": "https://github.com/apache/tomee/commit/58cdbbef9c77ab2b44870f9d606593b49cde76d9",
    "cve_id": "CVE-2015-8581",
    "cwe_id": "CWE-502",
    "filename": "arquillian/arquillian-tomee-common/src/main/java/org/apache/openejb/arquillian/common/TomEEConfiguration.java",
    "is_vulnerable": 0,
    "class_name": "TomEEConfiguration",
    "subclass_name": null,
    "function_name": "getPreloadClasses()",
    "function_body": "{\n        return preloadClasses;\n    }"
  },
  {
    "id": 34,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 33,
    "human_patch": "https://github.com/apache/tomee/commit/58cdbbef9c77ab2b44870f9d606593b49cde76d9",
    "cve_id": "CVE-2015-8581",
    "cwe_id": "CWE-502",
    "filename": "arquillian/arquillian-tomee-common/src/main/java/org/apache/openejb/arquillian/common/TomEEConfiguration.java",
    "is_vulnerable": 0,
    "class_name": "TomEEConfiguration",
    "subclass_name": null,
    "function_name": "setPreloadClasses(final String preloadClasses)",
    "function_body": "{\n        this.preloadClasses = preloadClasses;\n    }"
  },
  {
    "id": 34,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 34,
    "human_patch": "https://github.com/apache/tomee/commit/58cdbbef9c77ab2b44870f9d606593b49cde76d9",
    "cve_id": "CVE-2015-8581",
    "cwe_id": "CWE-502",
    "filename": "arquillian/arquillian-tomee-common/src/main/java/org/apache/openejb/arquillian/common/TomEEConfiguration.java",
    "is_vulnerable": 0,
    "class_name": "TomEEConfiguration",
    "subclass_name": null,
    "function_name": "getWebContextToUseWithEars()",
    "function_body": "{\n        return webContextToUseWithEars;\n    }"
  },
  {
    "id": 34,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 35,
    "human_patch": "https://github.com/apache/tomee/commit/58cdbbef9c77ab2b44870f9d606593b49cde76d9",
    "cve_id": "CVE-2015-8581",
    "cwe_id": "CWE-502",
    "filename": "arquillian/arquillian-tomee-common/src/main/java/org/apache/openejb/arquillian/common/TomEEConfiguration.java",
    "is_vulnerable": 0,
    "class_name": "TomEEConfiguration",
    "subclass_name": null,
    "function_name": "setWebContextToUseWithEars(final String webContextToUseWithEars)",
    "function_body": "{\n        this.webContextToUseWithEars = webContextToUseWithEars;\n    }"
  },
  {
    "id": 34,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 36,
    "human_patch": "https://github.com/apache/tomee/commit/58cdbbef9c77ab2b44870f9d606593b49cde76d9",
    "cve_id": "CVE-2015-8581",
    "cwe_id": "CWE-502",
    "filename": "arquillian/arquillian-tomee-common/src/main/java/org/apache/openejb/arquillian/common/TomEEConfiguration.java",
    "is_vulnerable": 0,
    "class_name": "TomEEConfiguration",
    "subclass_name": null,
    "function_name": "getKeepServerXmlAsThis()",
    "function_body": "{\n        return keepServerXmlAsThis;\n    }"
  },
  {
    "id": 34,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 37,
    "human_patch": "https://github.com/apache/tomee/commit/58cdbbef9c77ab2b44870f9d606593b49cde76d9",
    "cve_id": "CVE-2015-8581",
    "cwe_id": "CWE-502",
    "filename": "arquillian/arquillian-tomee-common/src/main/java/org/apache/openejb/arquillian/common/TomEEConfiguration.java",
    "is_vulnerable": 0,
    "class_name": "TomEEConfiguration",
    "subclass_name": null,
    "function_name": "setKeepServerXmlAsThis(final boolean keepServerXmlAsThis)",
    "function_body": "{\n        this.keepServerXmlAsThis = keepServerXmlAsThis;\n    }"
  },
  {
    "id": 34,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 38,
    "human_patch": "https://github.com/apache/tomee/commit/58cdbbef9c77ab2b44870f9d606593b49cde76d9",
    "cve_id": "CVE-2015-8581",
    "cwe_id": "CWE-502",
    "filename": "arquillian/arquillian-tomee-common/src/main/java/org/apache/openejb/arquillian/common/TomEEConfiguration.java",
    "is_vulnerable": 0,
    "class_name": "TomEEConfiguration",
    "subclass_name": null,
    "function_name": "isSingleDumpByArchiveName()",
    "function_body": "{\n        return singleDumpByArchiveName;\n    }"
  },
  {
    "id": 34,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 39,
    "human_patch": "https://github.com/apache/tomee/commit/58cdbbef9c77ab2b44870f9d606593b49cde76d9",
    "cve_id": "CVE-2015-8581",
    "cwe_id": "CWE-502",
    "filename": "arquillian/arquillian-tomee-common/src/main/java/org/apache/openejb/arquillian/common/TomEEConfiguration.java",
    "is_vulnerable": 0,
    "class_name": "TomEEConfiguration",
    "subclass_name": null,
    "function_name": "setSingleDumpByArchiveName(final boolean singleDumpByArchiveName)",
    "function_body": "{\n        this.singleDumpByArchiveName = singleDumpByArchiveName;\n    }"
  },
  {
    "id": 34,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 40,
    "human_patch": "https://github.com/apache/tomee/commit/58cdbbef9c77ab2b44870f9d606593b49cde76d9",
    "cve_id": "CVE-2015-8581",
    "cwe_id": "CWE-502",
    "filename": "arquillian/arquillian-tomee-common/src/main/java/org/apache/openejb/arquillian/common/TomEEConfiguration.java",
    "is_vulnerable": 0,
    "class_name": "TomEEConfiguration",
    "subclass_name": null,
    "function_name": "isSingleDeploymentByArchiveName(final String name)",
    "function_body": "{\n        return singleDeploymentByArchiveName.contains(name) || singleDeploymentByArchiveName.contains(\"*\") || singleDeploymentByArchiveName.contains(\"true\");\n    }"
  },
  {
    "id": 34,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 41,
    "human_patch": "https://github.com/apache/tomee/commit/58cdbbef9c77ab2b44870f9d606593b49cde76d9",
    "cve_id": "CVE-2015-8581",
    "cwe_id": "CWE-502",
    "filename": "arquillian/arquillian-tomee-common/src/main/java/org/apache/openejb/arquillian/common/TomEEConfiguration.java",
    "is_vulnerable": 0,
    "class_name": "TomEEConfiguration",
    "subclass_name": null,
    "function_name": "setSingleDeploymentByArchiveName(final String singleDeploymentByArchiveName)",
    "function_body": "{\n        this.singleDeploymentByArchiveName = singleDeploymentByArchiveName == null || singleDeploymentByArchiveName.trim().isEmpty() ?\n                Collections.<String>emptyList() : new HashSet<String>(asList(singleDeploymentByArchiveName.split(\" *, *\")));\n        this.singleDumpByArchiveName = true; \n    }"
  },
  {
    "id": 34,
    "sub_id": 2,
    "code_id": 0,
    "function_id": 0,
    "human_patch": "https://github.com/apache/tomee/commit/58cdbbef9c77ab2b44870f9d606593b49cde76d9",
    "cve_id": "CVE-2015-8581",
    "cwe_id": "CWE-502",
    "filename": "arquillian/arquillian-tomee-embedded/src/main/java/org/apache/openejb/arquillian/embedded/EmbeddedTomEEConfiguration.java",
    "is_vulnerable": 0,
    "class_name": "EmbeddedTomEEConfiguration",
    "subclass_name": null,
    "function_name": "isWebResourcesCached()",
    "function_body": "{\n        return webResourcesCached;\n    }"
  },
  {
    "id": 34,
    "sub_id": 2,
    "code_id": 0,
    "function_id": 1,
    "human_patch": "https://github.com/apache/tomee/commit/58cdbbef9c77ab2b44870f9d606593b49cde76d9",
    "cve_id": "CVE-2015-8581",
    "cwe_id": "CWE-502",
    "filename": "arquillian/arquillian-tomee-embedded/src/main/java/org/apache/openejb/arquillian/embedded/EmbeddedTomEEConfiguration.java",
    "is_vulnerable": 0,
    "class_name": "EmbeddedTomEEConfiguration",
    "subclass_name": null,
    "function_name": "setWebResourcesCached(final boolean webResourcesCached)",
    "function_body": "{\n        this.webResourcesCached = webResourcesCached;\n    }"
  },
  {
    "id": 34,
    "sub_id": 2,
    "code_id": 0,
    "function_id": 2,
    "human_patch": "https://github.com/apache/tomee/commit/58cdbbef9c77ab2b44870f9d606593b49cde76d9",
    "cve_id": "CVE-2015-8581",
    "cwe_id": "CWE-502",
    "filename": "arquillian/arquillian-tomee-embedded/src/main/java/org/apache/openejb/arquillian/embedded/EmbeddedTomEEConfiguration.java",
    "is_vulnerable": 0,
    "class_name": "EmbeddedTomEEConfiguration",
    "subclass_name": null,
    "function_name": "isWithEjbRemote()",
    "function_body": "{\n        return withEjbRemote;\n    }"
  },
  {
    "id": 34,
    "sub_id": 2,
    "code_id": 0,
    "function_id": 3,
    "human_patch": "https://github.com/apache/tomee/commit/58cdbbef9c77ab2b44870f9d606593b49cde76d9",
    "cve_id": "CVE-2015-8581",
    "cwe_id": "CWE-502",
    "filename": "arquillian/arquillian-tomee-embedded/src/main/java/org/apache/openejb/arquillian/embedded/EmbeddedTomEEConfiguration.java",
    "is_vulnerable": 0,
    "class_name": "EmbeddedTomEEConfiguration",
    "subclass_name": null,
    "function_name": "setWithEjbRemote(final boolean withEjbRemote)",
    "function_body": "{\n        this.withEjbRemote = withEjbRemote;\n    }"
  },
  {
    "id": 34,
    "sub_id": 2,
    "code_id": 0,
    "function_id": 4,
    "human_patch": "https://github.com/apache/tomee/commit/58cdbbef9c77ab2b44870f9d606593b49cde76d9",
    "cve_id": "CVE-2015-8581",
    "cwe_id": "CWE-502",
    "filename": "arquillian/arquillian-tomee-embedded/src/main/java/org/apache/openejb/arquillian/embedded/EmbeddedTomEEConfiguration.java",
    "is_vulnerable": 0,
    "class_name": "EmbeddedTomEEConfiguration",
    "subclass_name": null,
    "function_name": "getHttpsPort()",
    "function_body": "{\n        return httpsPort;\n    }"
  },
  {
    "id": 34,
    "sub_id": 2,
    "code_id": 0,
    "function_id": 5,
    "human_patch": "https://github.com/apache/tomee/commit/58cdbbef9c77ab2b44870f9d606593b49cde76d9",
    "cve_id": "CVE-2015-8581",
    "cwe_id": "CWE-502",
    "filename": "arquillian/arquillian-tomee-embedded/src/main/java/org/apache/openejb/arquillian/embedded/EmbeddedTomEEConfiguration.java",
    "is_vulnerable": 0,
    "class_name": "EmbeddedTomEEConfiguration",
    "subclass_name": null,
    "function_name": "setHttpsPort(final int httpsPort)",
    "function_body": "{\n        this.httpsPort = httpsPort;\n    }"
  },
  {
    "id": 34,
    "sub_id": 2,
    "code_id": 0,
    "function_id": 6,
    "human_patch": "https://github.com/apache/tomee/commit/58cdbbef9c77ab2b44870f9d606593b49cde76d9",
    "cve_id": "CVE-2015-8581",
    "cwe_id": "CWE-502",
    "filename": "arquillian/arquillian-tomee-embedded/src/main/java/org/apache/openejb/arquillian/embedded/EmbeddedTomEEConfiguration.java",
    "is_vulnerable": 0,
    "class_name": "EmbeddedTomEEConfiguration",
    "subclass_name": null,
    "function_name": "isSsl()",
    "function_body": "{\n        return ssl;\n    }"
  },
  {
    "id": 34,
    "sub_id": 2,
    "code_id": 0,
    "function_id": 7,
    "human_patch": "https://github.com/apache/tomee/commit/58cdbbef9c77ab2b44870f9d606593b49cde76d9",
    "cve_id": "CVE-2015-8581",
    "cwe_id": "CWE-502",
    "filename": "arquillian/arquillian-tomee-embedded/src/main/java/org/apache/openejb/arquillian/embedded/EmbeddedTomEEConfiguration.java",
    "is_vulnerable": 0,
    "class_name": "EmbeddedTomEEConfiguration",
    "subclass_name": null,
    "function_name": "setSsl(final boolean ssl)",
    "function_body": "{\n        this.ssl = ssl;\n    }"
  },
  {
    "id": 34,
    "sub_id": 2,
    "code_id": 0,
    "function_id": 8,
    "human_patch": "https://github.com/apache/tomee/commit/58cdbbef9c77ab2b44870f9d606593b49cde76d9",
    "cve_id": "CVE-2015-8581",
    "cwe_id": "CWE-502",
    "filename": "arquillian/arquillian-tomee-embedded/src/main/java/org/apache/openejb/arquillian/embedded/EmbeddedTomEEConfiguration.java",
    "is_vulnerable": 0,
    "class_name": "EmbeddedTomEEConfiguration",
    "subclass_name": null,
    "function_name": "getKeystoreFile()",
    "function_body": "{\n        return keystoreFile;\n    }"
  },
  {
    "id": 34,
    "sub_id": 2,
    "code_id": 0,
    "function_id": 9,
    "human_patch": "https://github.com/apache/tomee/commit/58cdbbef9c77ab2b44870f9d606593b49cde76d9",
    "cve_id": "CVE-2015-8581",
    "cwe_id": "CWE-502",
    "filename": "arquillian/arquillian-tomee-embedded/src/main/java/org/apache/openejb/arquillian/embedded/EmbeddedTomEEConfiguration.java",
    "is_vulnerable": 0,
    "class_name": "EmbeddedTomEEConfiguration",
    "subclass_name": null,
    "function_name": "setKeystoreFile(final String keystoreFile)",
    "function_body": "{\n        this.keystoreFile = keystoreFile;\n    }"
  },
  {
    "id": 34,
    "sub_id": 2,
    "code_id": 0,
    "function_id": 10,
    "human_patch": "https://github.com/apache/tomee/commit/58cdbbef9c77ab2b44870f9d606593b49cde76d9",
    "cve_id": "CVE-2015-8581",
    "cwe_id": "CWE-502",
    "filename": "arquillian/arquillian-tomee-embedded/src/main/java/org/apache/openejb/arquillian/embedded/EmbeddedTomEEConfiguration.java",
    "is_vulnerable": 0,
    "class_name": "EmbeddedTomEEConfiguration",
    "subclass_name": null,
    "function_name": "getKeystorePass()",
    "function_body": "{\n        return keystorePass;\n    }"
  },
  {
    "id": 34,
    "sub_id": 2,
    "code_id": 0,
    "function_id": 11,
    "human_patch": "https://github.com/apache/tomee/commit/58cdbbef9c77ab2b44870f9d606593b49cde76d9",
    "cve_id": "CVE-2015-8581",
    "cwe_id": "CWE-502",
    "filename": "arquillian/arquillian-tomee-embedded/src/main/java/org/apache/openejb/arquillian/embedded/EmbeddedTomEEConfiguration.java",
    "is_vulnerable": 0,
    "class_name": "EmbeddedTomEEConfiguration",
    "subclass_name": null,
    "function_name": "setKeystorePass(final String keystorePass)",
    "function_body": "{\n        this.keystorePass = keystorePass;\n    }"
  },
  {
    "id": 34,
    "sub_id": 2,
    "code_id": 0,
    "function_id": 12,
    "human_patch": "https://github.com/apache/tomee/commit/58cdbbef9c77ab2b44870f9d606593b49cde76d9",
    "cve_id": "CVE-2015-8581",
    "cwe_id": "CWE-502",
    "filename": "arquillian/arquillian-tomee-embedded/src/main/java/org/apache/openejb/arquillian/embedded/EmbeddedTomEEConfiguration.java",
    "is_vulnerable": 0,
    "class_name": "EmbeddedTomEEConfiguration",
    "subclass_name": null,
    "function_name": "getKeystoreType()",
    "function_body": "{\n        return keystoreType;\n    }"
  },
  {
    "id": 34,
    "sub_id": 2,
    "code_id": 0,
    "function_id": 13,
    "human_patch": "https://github.com/apache/tomee/commit/58cdbbef9c77ab2b44870f9d606593b49cde76d9",
    "cve_id": "CVE-2015-8581",
    "cwe_id": "CWE-502",
    "filename": "arquillian/arquillian-tomee-embedded/src/main/java/org/apache/openejb/arquillian/embedded/EmbeddedTomEEConfiguration.java",
    "is_vulnerable": 0,
    "class_name": "EmbeddedTomEEConfiguration",
    "subclass_name": null,
    "function_name": "setKeystoreType(final String keystoreType)",
    "function_body": "{\n        this.keystoreType = keystoreType;\n    }"
  },
  {
    "id": 34,
    "sub_id": 2,
    "code_id": 0,
    "function_id": 14,
    "human_patch": "https://github.com/apache/tomee/commit/58cdbbef9c77ab2b44870f9d606593b49cde76d9",
    "cve_id": "CVE-2015-8581",
    "cwe_id": "CWE-502",
    "filename": "arquillian/arquillian-tomee-embedded/src/main/java/org/apache/openejb/arquillian/embedded/EmbeddedTomEEConfiguration.java",
    "is_vulnerable": 0,
    "class_name": "EmbeddedTomEEConfiguration",
    "subclass_name": null,
    "function_name": "getClientAuth()",
    "function_body": "{\n        return clientAuth;\n    }"
  },
  {
    "id": 34,
    "sub_id": 2,
    "code_id": 0,
    "function_id": 15,
    "human_patch": "https://github.com/apache/tomee/commit/58cdbbef9c77ab2b44870f9d606593b49cde76d9",
    "cve_id": "CVE-2015-8581",
    "cwe_id": "CWE-502",
    "filename": "arquillian/arquillian-tomee-embedded/src/main/java/org/apache/openejb/arquillian/embedded/EmbeddedTomEEConfiguration.java",
    "is_vulnerable": 0,
    "class_name": "EmbeddedTomEEConfiguration",
    "subclass_name": null,
    "function_name": "setClientAuth(final String clientAuth)",
    "function_body": "{\n        this.clientAuth = clientAuth;\n    }"
  },
  {
    "id": 34,
    "sub_id": 2,
    "code_id": 0,
    "function_id": 16,
    "human_patch": "https://github.com/apache/tomee/commit/58cdbbef9c77ab2b44870f9d606593b49cde76d9",
    "cve_id": "CVE-2015-8581",
    "cwe_id": "CWE-502",
    "filename": "arquillian/arquillian-tomee-embedded/src/main/java/org/apache/openejb/arquillian/embedded/EmbeddedTomEEConfiguration.java",
    "is_vulnerable": 0,
    "class_name": "EmbeddedTomEEConfiguration",
    "subclass_name": null,
    "function_name": "getKeyAlias()",
    "function_body": "{\n        return keyAlias;\n    }"
  },
  {
    "id": 34,
    "sub_id": 2,
    "code_id": 0,
    "function_id": 17,
    "human_patch": "https://github.com/apache/tomee/commit/58cdbbef9c77ab2b44870f9d606593b49cde76d9",
    "cve_id": "CVE-2015-8581",
    "cwe_id": "CWE-502",
    "filename": "arquillian/arquillian-tomee-embedded/src/main/java/org/apache/openejb/arquillian/embedded/EmbeddedTomEEConfiguration.java",
    "is_vulnerable": 0,
    "class_name": "EmbeddedTomEEConfiguration",
    "subclass_name": null,
    "function_name": "setKeyAlias(final String keyAlias)",
    "function_body": "{\n        this.keyAlias = keyAlias;\n    }"
  },
  {
    "id": 34,
    "sub_id": 2,
    "code_id": 0,
    "function_id": 18,
    "human_patch": "https://github.com/apache/tomee/commit/58cdbbef9c77ab2b44870f9d606593b49cde76d9",
    "cve_id": "CVE-2015-8581",
    "cwe_id": "CWE-502",
    "filename": "arquillian/arquillian-tomee-embedded/src/main/java/org/apache/openejb/arquillian/embedded/EmbeddedTomEEConfiguration.java",
    "is_vulnerable": 0,
    "class_name": "EmbeddedTomEEConfiguration",
    "subclass_name": null,
    "function_name": "getSslProtocol()",
    "function_body": "{\n        return sslProtocol;\n    }"
  },
  {
    "id": 34,
    "sub_id": 2,
    "code_id": 0,
    "function_id": 19,
    "human_patch": "https://github.com/apache/tomee/commit/58cdbbef9c77ab2b44870f9d606593b49cde76d9",
    "cve_id": "CVE-2015-8581",
    "cwe_id": "CWE-502",
    "filename": "arquillian/arquillian-tomee-embedded/src/main/java/org/apache/openejb/arquillian/embedded/EmbeddedTomEEConfiguration.java",
    "is_vulnerable": 0,
    "class_name": "EmbeddedTomEEConfiguration",
    "subclass_name": null,
    "function_name": "setSslProtocol(final String sslProtocol)",
    "function_body": "{\n        this.sslProtocol = sslProtocol;\n    }"
  },
  {
    "id": 34,
    "sub_id": 2,
    "code_id": 0,
    "function_id": 20,
    "human_patch": "https://github.com/apache/tomee/commit/58cdbbef9c77ab2b44870f9d606593b49cde76d9",
    "cve_id": "CVE-2015-8581",
    "cwe_id": "CWE-502",
    "filename": "arquillian/arquillian-tomee-embedded/src/main/java/org/apache/openejb/arquillian/embedded/EmbeddedTomEEConfiguration.java",
    "is_vulnerable": 0,
    "class_name": "EmbeddedTomEEConfiguration",
    "subclass_name": null,
    "function_name": "getUsers()",
    "function_body": "{\n        return users;\n    }"
  },
  {
    "id": 34,
    "sub_id": 2,
    "code_id": 0,
    "function_id": 21,
    "human_patch": "https://github.com/apache/tomee/commit/58cdbbef9c77ab2b44870f9d606593b49cde76d9",
    "cve_id": "CVE-2015-8581",
    "cwe_id": "CWE-502",
    "filename": "arquillian/arquillian-tomee-embedded/src/main/java/org/apache/openejb/arquillian/embedded/EmbeddedTomEEConfiguration.java",
    "is_vulnerable": 0,
    "class_name": "EmbeddedTomEEConfiguration",
    "subclass_name": null,
    "function_name": "getUsersAsProperties()",
    "function_body": "{\n        return toProperties(users);\n    }"
  },
  {
    "id": 34,
    "sub_id": 2,
    "code_id": 0,
    "function_id": 22,
    "human_patch": "https://github.com/apache/tomee/commit/58cdbbef9c77ab2b44870f9d606593b49cde76d9",
    "cve_id": "CVE-2015-8581",
    "cwe_id": "CWE-502",
    "filename": "arquillian/arquillian-tomee-embedded/src/main/java/org/apache/openejb/arquillian/embedded/EmbeddedTomEEConfiguration.java",
    "is_vulnerable": 0,
    "class_name": "EmbeddedTomEEConfiguration",
    "subclass_name": null,
    "function_name": "setUsers(final String users)",
    "function_body": "{\n        this.users = users;\n    }"
  },
  {
    "id": 34,
    "sub_id": 2,
    "code_id": 0,
    "function_id": 23,
    "human_patch": "https://github.com/apache/tomee/commit/58cdbbef9c77ab2b44870f9d606593b49cde76d9",
    "cve_id": "CVE-2015-8581",
    "cwe_id": "CWE-502",
    "filename": "arquillian/arquillian-tomee-embedded/src/main/java/org/apache/openejb/arquillian/embedded/EmbeddedTomEEConfiguration.java",
    "is_vulnerable": 0,
    "class_name": "EmbeddedTomEEConfiguration",
    "subclass_name": null,
    "function_name": "getRoles()",
    "function_body": "{\n        return roles;\n    }"
  },
  {
    "id": 34,
    "sub_id": 2,
    "code_id": 0,
    "function_id": 24,
    "human_patch": "https://github.com/apache/tomee/commit/58cdbbef9c77ab2b44870f9d606593b49cde76d9",
    "cve_id": "CVE-2015-8581",
    "cwe_id": "CWE-502",
    "filename": "arquillian/arquillian-tomee-embedded/src/main/java/org/apache/openejb/arquillian/embedded/EmbeddedTomEEConfiguration.java",
    "is_vulnerable": 0,
    "class_name": "EmbeddedTomEEConfiguration",
    "subclass_name": null,
    "function_name": "getRolesAsProperties()",
    "function_body": "{\n        return toProperties(roles);\n    }"
  },
  {
    "id": 34,
    "sub_id": 2,
    "code_id": 0,
    "function_id": 25,
    "human_patch": "https://github.com/apache/tomee/commit/58cdbbef9c77ab2b44870f9d606593b49cde76d9",
    "cve_id": "CVE-2015-8581",
    "cwe_id": "CWE-502",
    "filename": "arquillian/arquillian-tomee-embedded/src/main/java/org/apache/openejb/arquillian/embedded/EmbeddedTomEEConfiguration.java",
    "is_vulnerable": 0,
    "class_name": "EmbeddedTomEEConfiguration",
    "subclass_name": null,
    "function_name": "setRoles(final String roles)",
    "function_body": "{\n        this.roles = roles;\n    }"
  },
  {
    "id": 34,
    "sub_id": 2,
    "code_id": 0,
    "function_id": 26,
    "human_patch": "https://github.com/apache/tomee/commit/58cdbbef9c77ab2b44870f9d606593b49cde76d9",
    "cve_id": "CVE-2015-8581",
    "cwe_id": "CWE-502",
    "filename": "arquillian/arquillian-tomee-embedded/src/main/java/org/apache/openejb/arquillian/embedded/EmbeddedTomEEConfiguration.java",
    "is_vulnerable": 0,
    "class_name": "EmbeddedTomEEConfiguration",
    "subclass_name": null,
    "function_name": "portsAlreadySet()",
    "function_body": "{\n        final List<Integer> value = new ArrayList<Integer>();\n        if (getStopPort() > 0) {\n            value.add(getStopPort());\n        }\n        if (getHttpPort() > 0) {\n            value.add(getHttpPort());\n        }\n        if (getHttpsPort() > 0) {\n            value.add(getHttpsPort());\n        }\n        return toInts(value);\n    }"
  },
  {
    "id": 34,
    "sub_id": 2,
    "code_id": 0,
    "function_id": 27,
    "human_patch": "https://github.com/apache/tomee/commit/58cdbbef9c77ab2b44870f9d606593b49cde76d9",
    "cve_id": "CVE-2015-8581",
    "cwe_id": "CWE-502",
    "filename": "arquillian/arquillian-tomee-embedded/src/main/java/org/apache/openejb/arquillian/embedded/EmbeddedTomEEConfiguration.java",
    "is_vulnerable": 1,
    "class_name": "EmbeddedTomEEConfiguration",
    "subclass_name": null,
    "function_name": "systemPropertiesAsProperties()",
    "function_body": "{\n        if (properties == null || properties.isEmpty()) {\n            return new Properties();\n        }\n\n        return toProperties(properties);\n    }"
  },
  {
    "id": 34,
    "sub_id": 2,
    "code_id": 0,
    "function_id": 28,
    "human_patch": "https://github.com/apache/tomee/commit/58cdbbef9c77ab2b44870f9d606593b49cde76d9",
    "cve_id": "CVE-2015-8581",
    "cwe_id": "CWE-502",
    "filename": "arquillian/arquillian-tomee-embedded/src/main/java/org/apache/openejb/arquillian/embedded/EmbeddedTomEEConfiguration.java",
    "is_vulnerable": 0,
    "class_name": "EmbeddedTomEEConfiguration",
    "subclass_name": null,
    "function_name": "toProperties(final String value)",
    "function_body": "{\n        if (value == null || value.isEmpty()) {\n            return null;\n        }\n\n        final Properties properties = new Properties();\n        final ByteArrayInputStream bais = new ByteArrayInputStream(value.getBytes());\n        try {\n            properties.load(bais);\n        } catch (final IOException e) {\n            throw new OpenEJBRuntimeException(e);\n        } finally {\n            try {\n                IO.close(bais);\n            } catch (final IOException ignored) {\n                \n            }\n        }\n        return properties;\n    }"
  },
  {
    "id": 34,
    "sub_id": 3,
    "code_id": 0,
    "function_id": 0,
    "human_patch": "https://github.com/apache/tomee/commit/58cdbbef9c77ab2b44870f9d606593b49cde76d9",
    "cve_id": "CVE-2015-8581",
    "cwe_id": "CWE-502",
    "filename": "container/openejb-core/src/main/java/org/apache/openejb/core/rmi/BlacklistClassResolver.java",
    "is_vulnerable": 0,
    "class_name": "BlacklistClassResolver",
    "subclass_name": null,
    "function_name": "isBlacklisted(final String name)",
    "function_body": "{\n        return (whitelist != null && !contains(whitelist, name)) || contains(blacklist, name);\n    }"
  },
  {
    "id": 34,
    "sub_id": 3,
    "code_id": 0,
    "function_id": 1,
    "human_patch": "https://github.com/apache/tomee/commit/58cdbbef9c77ab2b44870f9d606593b49cde76d9",
    "cve_id": "CVE-2015-8581",
    "cwe_id": "CWE-502",
    "filename": "container/openejb-core/src/main/java/org/apache/openejb/core/rmi/BlacklistClassResolver.java",
    "is_vulnerable": 0,
    "class_name": "BlacklistClassResolver",
    "subclass_name": null,
    "function_name": "check(final ObjectStreamClass classDesc)",
    "function_body": "{\n        check(classDesc.getName());\n        return classDesc;\n    }"
  },
  {
    "id": 34,
    "sub_id": 3,
    "code_id": 0,
    "function_id": 2,
    "human_patch": "https://github.com/apache/tomee/commit/58cdbbef9c77ab2b44870f9d606593b49cde76d9",
    "cve_id": "CVE-2015-8581",
    "cwe_id": "CWE-502",
    "filename": "container/openejb-core/src/main/java/org/apache/openejb/core/rmi/BlacklistClassResolver.java",
    "is_vulnerable": 0,
    "class_name": "BlacklistClassResolver",
    "subclass_name": null,
    "function_name": "check(final String name)",
    "function_body": "{\n        if (isBlacklisted(name)) {\n            throw new SecurityException(name + \" is not whitelisted as deserialisable, prevented before loading.\");\n        }\n        return name;\n    }"
  },
  {
    "id": 34,
    "sub_id": 3,
    "code_id": 0,
    "function_id": 3,
    "human_patch": "https://github.com/apache/tomee/commit/58cdbbef9c77ab2b44870f9d606593b49cde76d9",
    "cve_id": "CVE-2015-8581",
    "cwe_id": "CWE-502",
    "filename": "container/openejb-core/src/main/java/org/apache/openejb/core/rmi/BlacklistClassResolver.java",
    "is_vulnerable": 0,
    "class_name": "BlacklistClassResolver",
    "subclass_name": null,
    "function_name": "toArray(final String property)",
    "function_body": "{\n        return property == null ? null : property.split(\" *, *\");\n    }"
  },
  {
    "id": 34,
    "sub_id": 3,
    "code_id": 0,
    "function_id": 4,
    "human_patch": "https://github.com/apache/tomee/commit/58cdbbef9c77ab2b44870f9d606593b49cde76d9",
    "cve_id": "CVE-2015-8581",
    "cwe_id": "CWE-502",
    "filename": "container/openejb-core/src/main/java/org/apache/openejb/core/rmi/BlacklistClassResolver.java",
    "is_vulnerable": 1,
    "class_name": "BlacklistClassResolver",
    "subclass_name": null,
    "function_name": "contains(final String[] list, final String name)",
    "function_body": "{\n        if (list != null) {\n            for (final String white : list) {\n                if (name.startsWith(white)) {\n                    return true;\n                }\n            }\n        }\n        return false;\n    }"
  },
  {
    "id": 34,
    "sub_id": 4,
    "code_id": 0,
    "function_id": 0,
    "human_patch": "https://github.com/apache/tomee/commit/58cdbbef9c77ab2b44870f9d606593b49cde76d9",
    "cve_id": "CVE-2015-8581",
    "cwe_id": "CWE-502",
    "filename": "container/openejb-core/src/test/java/org/apache/openejb/core/rmi/BlacklistClassResolverTest.java",
    "is_vulnerable": 0,
    "class_name": "BlacklistClassResolverTest",
    "subclass_name": null,
    "function_name": "blacklistDefault()",
    "function_body": "{\n        assertTrue(BlacklistClassResolver.DEFAULT.isBlacklisted(\"org.codehaus.groovy.runtime.Foo\"));\n        assertTrue(BlacklistClassResolver.DEFAULT.isBlacklisted(\"org.apache.commons.collections.functors.Foo\"));\n        assertTrue(BlacklistClassResolver.DEFAULT.isBlacklisted(\"org.apache.xalan.Foo\"));\n    }"
  },
  {
    "id": 34,
    "sub_id": 4,
    "code_id": 0,
    "function_id": 1,
    "human_patch": "https://github.com/apache/tomee/commit/58cdbbef9c77ab2b44870f9d606593b49cde76d9",
    "cve_id": "CVE-2015-8581",
    "cwe_id": "CWE-502",
    "filename": "container/openejb-core/src/test/java/org/apache/openejb/core/rmi/BlacklistClassResolverTest.java",
    "is_vulnerable": 0,
    "class_name": "BlacklistClassResolverTest",
    "subclass_name": null,
    "function_name": "implicitWhiteList()",
    "function_body": "{\n        assertFalse(BlacklistClassResolver.DEFAULT.isBlacklisted(\"org.apache.tomee.Foo\"));\n    }"
  },
  {
    "id": 34,
    "sub_id": 4,
    "code_id": 0,
    "function_id": 2,
    "human_patch": "https://github.com/apache/tomee/commit/58cdbbef9c77ab2b44870f9d606593b49cde76d9",
    "cve_id": "CVE-2015-8581",
    "cwe_id": "CWE-502",
    "filename": "container/openejb-core/src/test/java/org/apache/openejb/core/rmi/BlacklistClassResolverTest.java",
    "is_vulnerable": 0,
    "class_name": "BlacklistClassResolverTest",
    "subclass_name": null,
    "function_name": "whiteList()",
    "function_body": "{\n        assertFalse(new BlacklistClassResolver(null, new String[] { \"org.apache.xalan\" }).isBlacklisted(\"org.apache.xalan.Foo\"));\n    }"
  },
  {
    "id": 34,
    "sub_id": 5,
    "code_id": 0,
    "function_id": 0,
    "human_patch": "https://github.com/apache/tomee/commit/58cdbbef9c77ab2b44870f9d606593b49cde76d9",
    "cve_id": "CVE-2015-8581",
    "cwe_id": "CWE-502",
    "filename": "server/openejb-client/src/main/java/org/apache/openejb/client/EjbObjectInputStream.java",
    "is_vulnerable": 0,
    "class_name": "EjbObjectInputStream",
    "subclass_name": null,
    "function_name": "resolveClass(final ObjectStreamClass classDesc) throws IOException, ClassNotFoundException",
    "function_body": "{\n        final String n = DEFAULT.check(classDesc.getName());\n        final ClassLoader classloader = getClassloader();\n        try {\n            return Class.forName(n, false, classloader);\n        } catch (ClassNotFoundException e) {\n\n            if (n.equals(\"boolean\")) {\n                return boolean.class;\n            }\n            if (n.equals(\"byte\")) {\n                return byte.class;\n            }\n            if (n.equals(\"char\")) {\n                return char.class;\n            }\n            if (n.equals(\"short\")) {\n                return short.class;\n            }\n            if (n.equals(\"int\")) {\n                return int.class;\n            }\n            if (n.equals(\"long\")) {\n                return long.class;\n            }\n            if (n.equals(\"float\")) {\n                return float.class;\n            }\n            if (n.equals(\"double\")) {\n                return double.class;\n            }\n\n            \n            return Class.forName(n, false, null);\n        }\n    }"
  },
  {
    "id": 34,
    "sub_id": 5,
    "code_id": 0,
    "function_id": 1,
    "human_patch": "https://github.com/apache/tomee/commit/58cdbbef9c77ab2b44870f9d606593b49cde76d9",
    "cve_id": "CVE-2015-8581",
    "cwe_id": "CWE-502",
    "filename": "server/openejb-client/src/main/java/org/apache/openejb/client/EjbObjectInputStream.java",
    "is_vulnerable": 0,
    "class_name": "EjbObjectInputStream",
    "subclass_name": null,
    "function_name": "resolveProxyClass(final String[] interfaces) throws IOException, ClassNotFoundException",
    "function_body": "{\n        final Class[] cinterfaces = new Class[interfaces.length];\n        for (int i = 0; i < interfaces.length; i++) {\n            cinterfaces[i] = getClassloader().loadClass(interfaces[i]);\n        }\n\n        try {\n            return Proxy.getProxyClass(getClassloader(), cinterfaces);\n        } catch (IllegalArgumentException e) {\n            throw new ClassNotFoundException(null, e);\n        }\n    }"
  },
  {
    "id": 34,
    "sub_id": 5,
    "code_id": 0,
    "function_id": 2,
    "human_patch": "https://github.com/apache/tomee/commit/58cdbbef9c77ab2b44870f9d606593b49cde76d9",
    "cve_id": "CVE-2015-8581",
    "cwe_id": "CWE-502",
    "filename": "server/openejb-client/src/main/java/org/apache/openejb/client/EjbObjectInputStream.java",
    "is_vulnerable": 0,
    "class_name": "EjbObjectInputStream",
    "subclass_name": null,
    "function_name": "getClassloader()",
    "function_body": "{\n        return Thread.currentThread().getContextClassLoader();\n    }"
  },
  {
    "id": 34,
    "sub_id": 5,
    "code_id": 0,
    "function_id": 3,
    "human_patch": "https://github.com/apache/tomee/commit/58cdbbef9c77ab2b44870f9d606593b49cde76d9",
    "cve_id": "CVE-2015-8581",
    "cwe_id": "CWE-502",
    "filename": "server/openejb-client/src/main/java/org/apache/openejb/client/EjbObjectInputStream.java",
    "is_vulnerable": 0,
    "class_name": "EjbObjectInputStream",
    "subclass_name": "BlacklistClassResolver",
    "function_name": "isBlacklisted(final String name)",
    "function_body": "{\n            return (whitelist != null && !contains(whitelist, name)) || contains(blacklist, name);\n        }"
  },
  {
    "id": 34,
    "sub_id": 5,
    "code_id": 0,
    "function_id": 4,
    "human_patch": "https://github.com/apache/tomee/commit/58cdbbef9c77ab2b44870f9d606593b49cde76d9",
    "cve_id": "CVE-2015-8581",
    "cwe_id": "CWE-502",
    "filename": "server/openejb-client/src/main/java/org/apache/openejb/client/EjbObjectInputStream.java",
    "is_vulnerable": 0,
    "class_name": "EjbObjectInputStream",
    "subclass_name": "BlacklistClassResolver",
    "function_name": "check(final String name)",
    "function_body": "{\n            if (isBlacklisted(name)) {\n                throw new SecurityException(name + \" is not whitelisted as deserialisable, prevented before loading.\");\n            }\n            return name;\n        }"
  },
  {
    "id": 34,
    "sub_id": 5,
    "code_id": 0,
    "function_id": 5,
    "human_patch": "https://github.com/apache/tomee/commit/58cdbbef9c77ab2b44870f9d606593b49cde76d9",
    "cve_id": "CVE-2015-8581",
    "cwe_id": "CWE-502",
    "filename": "server/openejb-client/src/main/java/org/apache/openejb/client/EjbObjectInputStream.java",
    "is_vulnerable": 0,
    "class_name": "EjbObjectInputStream",
    "subclass_name": "BlacklistClassResolver",
    "function_name": "toArray(final String property)",
    "function_body": "{\n            return property == null ? null : property.split(\" *, *\");\n        }"
  },
  {
    "id": 34,
    "sub_id": 5,
    "code_id": 0,
    "function_id": 6,
    "human_patch": "https://github.com/apache/tomee/commit/58cdbbef9c77ab2b44870f9d606593b49cde76d9",
    "cve_id": "CVE-2015-8581",
    "cwe_id": "CWE-502",
    "filename": "server/openejb-client/src/main/java/org/apache/openejb/client/EjbObjectInputStream.java",
    "is_vulnerable": 1,
    "class_name": "EjbObjectInputStream",
    "subclass_name": "BlacklistClassResolver",
    "function_name": "contains(final String[] list, String name)",
    "function_body": "{\n            if (list != null) {\n                for (final String white : list) {\n                    if (name.startsWith(white)) {\n                        return true;\n                    }\n                }\n            }\n            return false;\n        }"
  },
  {
    "id": 34,
    "sub_id": 6,
    "code_id": 0,
    "function_id": 0,
    "human_patch": "https://github.com/apache/tomee/commit/58cdbbef9c77ab2b44870f9d606593b49cde76d9",
    "cve_id": "CVE-2015-8581",
    "cwe_id": "CWE-502",
    "filename": "tomee/tomee-common/src/main/java/org/apache/tomee/installer/Installer.java",
    "is_vulnerable": 0,
    "class_name": "Installer",
    "subclass_name": null,
    "function_name": "isListenerInstalled()",
    "function_body": "{\n        return listenerInstalled;\n    }"
  },
  {
    "id": 34,
    "sub_id": 6,
    "code_id": 0,
    "function_id": 1,
    "human_patch": "https://github.com/apache/tomee/commit/58cdbbef9c77ab2b44870f9d606593b49cde76d9",
    "cve_id": "CVE-2015-8581",
    "cwe_id": "CWE-502",
    "filename": "tomee/tomee-common/src/main/java/org/apache/tomee/installer/Installer.java",
    "is_vulnerable": 0,
    "class_name": "Installer",
    "subclass_name": null,
    "function_name": "isAgentInstalled()",
    "function_body": "{\n        return agentInstalled;\n    }"
  },
  {
    "id": 34,
    "sub_id": 6,
    "code_id": 0,
    "function_id": 2,
    "human_patch": "https://github.com/apache/tomee/commit/58cdbbef9c77ab2b44870f9d606593b49cde76d9",
    "cve_id": "CVE-2015-8581",
    "cwe_id": "CWE-502",
    "filename": "tomee/tomee-common/src/main/java/org/apache/tomee/installer/Installer.java",
    "is_vulnerable": 0,
    "class_name": "Installer",
    "subclass_name": null,
    "function_name": "getPaths()",
    "function_body": "{\n        return paths;\n    }"
  },
  {
    "id": 34,
    "sub_id": 6,
    "code_id": 0,
    "function_id": 3,
    "human_patch": "https://github.com/apache/tomee/commit/58cdbbef9c77ab2b44870f9d606593b49cde76d9",
    "cve_id": "CVE-2015-8581",
    "cwe_id": "CWE-502",
    "filename": "tomee/tomee-common/src/main/java/org/apache/tomee/installer/Installer.java",
    "is_vulnerable": 0,
    "class_name": "Installer",
    "subclass_name": null,
    "function_name": "getAlerts()",
    "function_body": "{\n        return alerts;\n    }"
  },
  {
    "id": 34,
    "sub_id": 6,
    "code_id": 0,
    "function_id": 4,
    "human_patch": "https://github.com/apache/tomee/commit/58cdbbef9c77ab2b44870f9d606593b49cde76d9",
    "cve_id": "CVE-2015-8581",
    "cwe_id": "CWE-502",
    "filename": "tomee/tomee-common/src/main/java/org/apache/tomee/installer/Installer.java",
    "is_vulnerable": 0,
    "class_name": "Installer",
    "subclass_name": null,
    "function_name": "reset()",
    "function_body": "{\n        alerts.reset();\n    }"
  },
  {
    "id": 34,
    "sub_id": 6,
    "code_id": 0,
    "function_id": 5,
    "human_patch": "https://github.com/apache/tomee/commit/58cdbbef9c77ab2b44870f9d606593b49cde76d9",
    "cve_id": "CVE-2015-8581",
    "cwe_id": "CWE-502",
    "filename": "tomee/tomee-common/src/main/java/org/apache/tomee/installer/Installer.java",
    "is_vulnerable": 0,
    "class_name": "Installer",
    "subclass_name": null,
    "function_name": "getStatus()",
    "function_body": "{\n        return status;\n    }"
  },
  {
    "id": 34,
    "sub_id": 6,
    "code_id": 0,
    "function_id": 6,
    "human_patch": "https://github.com/apache/tomee/commit/58cdbbef9c77ab2b44870f9d606593b49cde76d9",
    "cve_id": "CVE-2015-8581",
    "cwe_id": "CWE-502",
    "filename": "tomee/tomee-common/src/main/java/org/apache/tomee/installer/Installer.java",
    "is_vulnerable": 0,
    "class_name": "Installer",
    "subclass_name": null,
    "function_name": "installAll()",
    "function_body": "{\n        installListener();\n        installJavaagent();\n        installConfigFiles(false);\n\n        removeTomcatLibJar(\"annotations-api.jar\");\n        \n        addTomEEJuli();\n\n        addTomEEAdminConfInTomcatUsers();\n        addTomEELinkToTomcatHome();\n\n        workaroundOnBat();\n\n        if (!alerts.hasErrors()) {\n            status = Status.REBOOT_REQUIRED;\n        }\n    }"
  },
  {
    "id": 34,
    "sub_id": 6,
    "code_id": 0,
    "function_id": 7,
    "human_patch": "https://github.com/apache/tomee/commit/58cdbbef9c77ab2b44870f9d606593b49cde76d9",
    "cve_id": "CVE-2015-8581",
    "cwe_id": "CWE-502",
    "filename": "tomee/tomee-common/src/main/java/org/apache/tomee/installer/Installer.java",
    "is_vulnerable": 0,
    "class_name": "Installer",
    "subclass_name": null,
    "function_name": "addTomEEJuli()",
    "function_body": "{\n        final File original = new File(paths.getCatalinaBinDir(), \"tomcat-juli.jar\");\n\n        final File juli = paths.findOpenEJBJar(\"tomee-juli\");\n        try {\n            Installers.copyFile(juli, new File(original.getAbsolutePath()));\n            if (!juli.delete()) { \n                juli.deleteOnExit();\n            }\n        } catch (final IOException e) {\n            alerts.addInfo(\"Add tomee user to tomcat-users.xml\");\n        }\n    }"
  },
  {
    "id": 34,
    "sub_id": 6,
    "code_id": 0,
    "function_id": 8,
    "human_patch": "https://github.com/apache/tomee/commit/58cdbbef9c77ab2b44870f9d606593b49cde76d9",
    "cve_id": "CVE-2015-8581",
    "cwe_id": "CWE-502",
    "filename": "tomee/tomee-common/src/main/java/org/apache/tomee/installer/Installer.java",
    "is_vulnerable": 0,
    "class_name": "Installer",
    "subclass_name": null,
    "function_name": "addTomEEAdminConfInTomcatUsers()",
    "function_body": "{\n        addTomEEAdminConfInTomcatUsers(false);\n    }"
  },
  {
    "id": 34,
    "sub_id": 6,
    "code_id": 0,
    "function_id": 9,
    "human_patch": "https://github.com/apache/tomee/commit/58cdbbef9c77ab2b44870f9d606593b49cde76d9",
    "cve_id": "CVE-2015-8581",
    "cwe_id": "CWE-502",
    "filename": "tomee/tomee-common/src/main/java/org/apache/tomee/installer/Installer.java",
    "is_vulnerable": 0,
    "class_name": "Installer",
    "subclass_name": null,
    "function_name": "addTomEEAdminConfInTomcatUsers(final boolean securityActivated)",
    "function_body": "{\n        \n        final String tomcatUsersXml = Installers.readAll(paths.getTomcatUsersXml(), alerts);\n\n        \n        if (tomcatUsersXml == null) {\n            return;\n        }\n\n        if (tomcatUsersXml.contains(\"tomee-admin\")) {\n            alerts.addWarning(\"Can't add tomee user to tomcat-users.xml\");\n            return;\n        }\n\n        \n        if (!Installers.backup(paths.getTomcatUsersXml(), alerts)) {\n            return;\n        }\n\n        \n        final String roleUserTags =\n                \"  <role rolename=\\\"tomee-admin\\\" />\\n\" +\n                        \"  <user username=\\\"tomee\\\" password=\\\"tomee\\\" roles=\\\"tomee-admin,manager-gui\\\" />\\n\";\n        final String content;\n        if (!securityActivated) {\n            content =\n                    \"  <!-- Activate those lines to get access to TomEE GUI -->\\n\" +\n                            \"  <!--\\n\" +\n                            roleUserTags +\n                            \"  -->\\n\" +\n                            \"</tomcat-users>\\n\";\n        } else {\n            content =\n                    \"  <!-- Activate those lines to get access to TomEE GUI\\n -->\" +\n                            roleUserTags +\n                            \"</tomcat-users>\\n\";\n\n        }\n        final String newTomcatUsers = tomcatUsersXml.replace(\"</tomcat-users>\", content);\n\n        \n        if (Installers.writeAll(paths.getTomcatUsersXml(), newTomcatUsers, alerts)) {\n            alerts.addInfo(\"Add tomee user to tomcat-users.xml\");\n        }\n    }"
  },
  {
    "id": 34,
    "sub_id": 6,
    "code_id": 0,
    "function_id": 10,
    "human_patch": "https://github.com/apache/tomee/commit/58cdbbef9c77ab2b44870f9d606593b49cde76d9",
    "cve_id": "CVE-2015-8581",
    "cwe_id": "CWE-502",
    "filename": "tomee/tomee-common/src/main/java/org/apache/tomee/installer/Installer.java",
    "is_vulnerable": 0,
    "class_name": "Installer",
    "subclass_name": null,
    "function_name": "installFull()",
    "function_body": "{\n        installListener(\"org.apache.tomee.catalina.ServerListener\");\n        installJavaagent();\n\n        commentDeploymentDir();\n        installConfigFiles(true);\n\n        removeTomcatLibJar(\"annotations-api.jar\");\n        \n        addTomEEJuli(); \n        moveLibs();\n\n        addTomEEAdminConfInTomcatUsers();\n        addTomEELinkToTomcatHome();\n\n        workaroundOnBat();\n\n        if (!alerts.hasErrors()) {\n            status = Status.REBOOT_REQUIRED;\n        }\n    }"
  },
  {
    "id": 34,
    "sub_id": 6,
    "code_id": 0,
    "function_id": 11,
    "human_patch": "https://github.com/apache/tomee/commit/58cdbbef9c77ab2b44870f9d606593b49cde76d9",
    "cve_id": "CVE-2015-8581",
    "cwe_id": "CWE-502",
    "filename": "tomee/tomee-common/src/main/java/org/apache/tomee/installer/Installer.java",
    "is_vulnerable": 0,
    "class_name": "Installer",
    "subclass_name": null,
    "function_name": "workaroundOnBat()",
    "function_body": "{\n        final File setclasspath = new File(paths.getCatalinaBinDir(), \"setclasspath.bat\");\n        String bat = Installers.readAll(setclasspath, alerts);\n        if (bat == null || bat.contains(\" NOT DEFINED \") ) {\n            return;\n        }\n\n        \n        bat = bat \n                .replace(\"not \\\"%JRE_HOME%\\\" == \\\"\\\"\", \"DEFINED JRE_HOME\")\n                .replace(\"not \\\"%JAVA_HOME%\\\" == \\\"\\\"\", \"DEFINED JAVA_HOME\")\n                .replace(\"not \\\"%_RUNJAVA%\\\" == \\\"\\\"\", \"DEFINED _RUNJAVA\")\n                .replace(\"not \\\"%_RUNJDB%\\\" == \\\"\\\"\", \"DEFINED _RUNJDB\")\n                .replace(\"\\\"%JAVA_HOME%\\\" == \\\"\\\"\", \"NOT DEFINED JAVA_HOME\");\n\n        \n        if (!Installers.writeAll(setclasspath, bat, alerts)) {\n            alerts.addInfo(\"Can't add workarounds for setclasspath.bat\");\n        }\n    }"
  },
  {
    "id": 34,
    "sub_id": 6,
    "code_id": 0,
    "function_id": 12,
    "human_patch": "https://github.com/apache/tomee/commit/58cdbbef9c77ab2b44870f9d606593b49cde76d9",
    "cve_id": "CVE-2015-8581",
    "cwe_id": "CWE-502",
    "filename": "tomee/tomee-common/src/main/java/org/apache/tomee/installer/Installer.java",
    "is_vulnerable": 0,
    "class_name": "Installer",
    "subclass_name": null,
    "function_name": "removeTomcatLibJar(final String name)",
    "function_body": "{\n        final File jar = new File(paths.getCatalinaLibDir(), name);\n        removeJar(jar);\n    }"
  },
  {
    "id": 34,
    "sub_id": 6,
    "code_id": 0,
    "function_id": 13,
    "human_patch": "https://github.com/apache/tomee/commit/58cdbbef9c77ab2b44870f9d606593b49cde76d9",
    "cve_id": "CVE-2015-8581",
    "cwe_id": "CWE-502",
    "filename": "tomee/tomee-common/src/main/java/org/apache/tomee/installer/Installer.java",
    "is_vulnerable": 0,
    "class_name": "Installer",
    "subclass_name": null,
    "function_name": "commentDeploymentDir()",
    "function_body": "{\n        final File tomeeXml = new File(paths.getCatalinaConfDir(), \"tomee.xml\");\n        if (!tomeeXml.exists()) {\n            Installers.writeAll(tomeeXml,\n                    \"<?xml version=\\\"1.0\\\" encoding=\\\"UTF-8\\\"?>\\n\" +\n                            \"<tomee>\\n\" +\n                            \"  <!-- see http://tomee.apache.org/containers-and-resources.html -->\\n\\n\" +\n                            \"  <!-- activate next line to be able to deploy applications in apps -->\\n\" +\n                            \"  <!-- <Deployments dir=\\\"apps\\\" /> -->\\n\" +\n                            \"</tomee>\\n\", alerts);\n        }\n    }"
  },
  {
    "id": 34,
    "sub_id": 6,
    "code_id": 0,
    "function_id": 14,
    "human_patch": "https://github.com/apache/tomee/commit/58cdbbef9c77ab2b44870f9d606593b49cde76d9",
    "cve_id": "CVE-2015-8581",
    "cwe_id": "CWE-502",
    "filename": "tomee/tomee-common/src/main/java/org/apache/tomee/installer/Installer.java",
    "is_vulnerable": 0,
    "class_name": "Installer",
    "subclass_name": null,
    "function_name": "addTomEELinkToTomcatHome()",
    "function_body": "{\n        final File home = paths.getHome();\n        if(!home.exists()) {\n            return;\n        }\n        final String indeJsp = Installers.readAll(home, alerts);\n        if (indeJsp == null) {\n            return;\n        }\n\n        if (!indeJsp.contains(\"tomcatUrl\")) { \n            alerts.addWarning(\"webapps/ROOT/index.jsp was modified\");\n            return;\n        }\n\n        final String newIndeJsp = indeJsp.replaceFirst(\"<div id=\\\"actions\\\">\",\n                \"<div id=\\\"actions\\\">\\n\" +\n                        \"                    <div class=\\\"button\\\">\\n\" +\n                        \"                        <a class=\\\"container shadow\\\" href=\\\"/tomee\\\"><span>TomEE Gui</span></a>\\n\" +\n                        \"                    </div>\");\n        Installers.writeAll(home, newIndeJsp, alerts);\n    }"
  },
  {
    "id": 34,
    "sub_id": 6,
    "code_id": 0,
    "function_id": 15,
    "human_patch": "https://github.com/apache/tomee/commit/58cdbbef9c77ab2b44870f9d606593b49cde76d9",
    "cve_id": "CVE-2015-8581",
    "cwe_id": "CWE-502",
    "filename": "tomee/tomee-common/src/main/java/org/apache/tomee/installer/Installer.java",
    "is_vulnerable": 0,
    "class_name": "Installer",
    "subclass_name": null,
    "function_name": "moveLibs()",
    "function_body": "{\n        final File libs = paths.getCatalinaLibDir();\n        final File[] files = paths.getOpenEJBLibDir().listFiles();\n        if (files != null) {\n            for (final File file : files) {\n                if (file.isDirectory()) {\n                    continue;\n                }\n                if (!file.getName().endsWith(\".jar\")) {\n                    continue;\n                }\n\n                try {\n                    Installers.copyFile(file, new File(libs, file.getName()));\n                    if (!file.delete()) {\n                        file.deleteOnExit();\n                    }\n                    alerts.addInfo(\"Copy \" + file.getName() + \" to lib\");\n                } catch (final IOException e) {\n                    alerts.addError(\"Unable to \" + file.getName() + \" to Tomcat lib directory.  This will need to be \" +\n                            \"performed manually.\", e);\n                }\n            }\n        }\n    }"
  },
  {
    "id": 34,
    "sub_id": 6,
    "code_id": 0,
    "function_id": 16,
    "human_patch": "https://github.com/apache/tomee/commit/58cdbbef9c77ab2b44870f9d606593b49cde76d9",
    "cve_id": "CVE-2015-8581",
    "cwe_id": "CWE-502",
    "filename": "tomee/tomee-common/src/main/java/org/apache/tomee/installer/Installer.java",
    "is_vulnerable": 0,
    "class_name": "Installer",
    "subclass_name": null,
    "function_name": "removeJar(final File jar)",
    "function_body": "{\n        if (jar.exists()) {\n            if (!jar.delete()) {\n                jar.deleteOnExit();\n            }\n            alerts.addInfo(\"Please restart the server or delete manually \" + jar.getName());\n        }\n    }"
  },
  {
    "id": 34,
    "sub_id": 6,
    "code_id": 0,
    "function_id": 17,
    "human_patch": "https://github.com/apache/tomee/commit/58cdbbef9c77ab2b44870f9d606593b49cde76d9",
    "cve_id": "CVE-2015-8581",
    "cwe_id": "CWE-502",
    "filename": "tomee/tomee-common/src/main/java/org/apache/tomee/installer/Installer.java",
    "is_vulnerable": 0,
    "class_name": "Installer",
    "subclass_name": null,
    "function_name": "installListener()",
    "function_body": "{\n        installListener(\"org.apache.tomee.loader.OpenEJBListener\");\n    }"
  },
  {
    "id": 34,
    "sub_id": 6,
    "code_id": 0,
    "function_id": 18,
    "human_patch": "https://github.com/apache/tomee/commit/58cdbbef9c77ab2b44870f9d606593b49cde76d9",
    "cve_id": "CVE-2015-8581",
    "cwe_id": "CWE-502",
    "filename": "tomee/tomee-common/src/main/java/org/apache/tomee/installer/Installer.java",
    "is_vulnerable": 0,
    "class_name": "Installer",
    "subclass_name": null,
    "function_name": "installListener(final String listener)",
    "function_body": "{\n        if (listenerInstalled && !force) {\n            \n            return;\n        }\n        boolean copyOpenEJBLoader = true;\n\n        \n        final File destination = new File(paths.getCatalinaLibDir(), paths.getOpenEJBTomcatLoaderJar().getName());\n        if (destination.exists()) {\n            if (paths.getOpenEJBTomcatLoaderJar().length() == destination.length()) {\n                copyOpenEJBLoader = false;\n            }\n        }\n        if (copyOpenEJBLoader) {\n            try {\n                Installers.copyFile(paths.getOpenEJBTomcatLoaderJar(), destination);\n                alerts.addInfo(\"Copy \" + paths.getOpenEJBTomcatLoaderJar().getName() + \" to lib\");\n            } catch (final IOException e) {\n                alerts.addError(\"Unable to copy OpenEJB Tomcat loader jar to Tomcat lib directory.  This will need to be performed manually.\", e);\n            }\n        }\n\n        \n        final String serverXmlOriginal = Installers.readAll(paths.getServerXmlFile(), alerts);\n\n        \n        if (serverXmlOriginal == null) {\n            return;\n        }\n\n        \n        if (serverXmlOriginal.contains(listener)) {\n            alerts.addWarning(\"OpenEJB Listener already declared in Tomcat server.xml file.\");\n            return;\n        }\n\n        \n        if (!Installers.backup(paths.getServerXmlFile(), alerts)) {\n            return;\n        }\n\n        \n        String newServerXml = null;\n        try {\n            newServerXml = Installers.replace(serverXmlOriginal,\n                    \"<Server\",\n                    \"<Server\",\n                    \">\",\n                    \">\\r\\n\" +\n                            \"  <!-- TomEE plugin for Tomcat -->\\r\\n\" +\n                            \"  <Listener className=\\\"\" + listener + \"\\\" />\");\n        } catch (final IOException e) {\n            alerts.addError(\"Error while adding listener to server.xml file\", e);\n        }\n\n        \n        try {\n            newServerXml = Installers.replace(newServerXml,\n                    \"<Connector port=\\\"8080\\\"\",\n                    \"<Connector port=\\\"8080\\\"\",\n                    \"/>\",\n                    \"xpoweredBy=\\\"false\\\" server=\\\"Apache TomEE\\\" />\");\n\n            newServerXml = Installers.replace(newServerXml,\n                    \"<Connector port=\\\"8443\\\"\",\n                    \"<Connector port=\\\"8443\\\"\",\n                    \"/>\",\n                    \"xpoweredBy=\\\"false\\\" server=\\\"Apache TomEE\\\" />\");\n        } catch (final IOException e) {\n            alerts.addError(\"Error adding server attribute to server.xml file\", e);\n        }\n\n        \n        if (Installers.writeAll(paths.getServerXmlFile(), newServerXml, alerts)) {\n            alerts.addInfo(\"Add OpenEJB listener to server.xml\");\n        }\n    }"
  },
  {
    "id": 34,
    "sub_id": 6,
    "code_id": 0,
    "function_id": 19,
    "human_patch": "https://github.com/apache/tomee/commit/58cdbbef9c77ab2b44870f9d606593b49cde76d9",
    "cve_id": "CVE-2015-8581",
    "cwe_id": "CWE-502",
    "filename": "tomee/tomee-common/src/main/java/org/apache/tomee/installer/Installer.java",
    "is_vulnerable": 0,
    "class_name": "Installer",
    "subclass_name": null,
    "function_name": "installJavaagent()",
    "function_body": "{\n        if (agentInstalled && !force) {\n            \n            return;\n        }\n\n        \n        \n        \n        boolean copyJavaagentJar = true;\n        final File javaagentJar = new File(paths.getCatalinaLibDir(), \"openejb-javaagent.jar\");\n        if (javaagentJar.exists()) {\n            if (paths.getOpenEJBJavaagentJar().length() == javaagentJar.length()) {\n                copyJavaagentJar = false;\n            }\n        }\n\n        if (copyJavaagentJar) {\n            try {\n                Installers.copyFile(paths.getOpenEJBJavaagentJar(), javaagentJar);\n                alerts.addInfo(\"Copy \" + paths.getOpenEJBJavaagentJar().getName() + \" to lib\");\n            } catch (final IOException e) {\n                alerts.addError(\"Unable to copy OpenEJB javaagent jar to Tomcat lib directory.  This will need to be performed manually.\", e);\n            }\n        }\n\n\n        \n        \n        \n\n        \n        final String catalinaShOriginal = Installers.readAll(paths.getCatalinaShFile(), alerts);\n\n        \n        if (catalinaShOriginal == null) {\n            return;\n        }\n\n        \n        if (catalinaShOriginal.contains(\"Add OpenEJB javaagent\")) {\n            alerts.addWarning(\"OpenEJB javaagent already declared in Tomcat catalina.sh file.\");\n            return;\n        }\n\n        \n        if (!Installers.backup(paths.getCatalinaShFile(), alerts)) {\n            return;\n        }\n\n        \n        String openejbJavaagentPath = paths.getCatalinaHomeDir().toURI().relativize(javaagentJar.toURI()).getPath();\n        final String newCatalinaSh = catalinaShOriginal.replace(\"# ----- Execute The Requested Command\",\n                \"# Add OpenEJB javaagent\\n\" +\n                        \"if [ -r \\\"$CATALINA_HOME\\\"/\" + openejbJavaagentPath + \" ]; then\\n\" +\n                        \"  JAVA_OPTS=\\\"\\\\\\\"-javaagent:$CATALINA_HOME/\" + openejbJavaagentPath + \"\\\\\\\" $JAVA_OPTS\\\"\\n\" +\n                        \"fi\\n\" +\n                        \"\\n\" +\n                        \"# ----- Execute The Requested Command\");\n\n        \n        if (Installers.writeAll(paths.getCatalinaShFile(), newCatalinaSh, alerts)) {\n            alerts.addInfo(\"Add OpenEJB JavaAgent to catalina.sh\");\n        }\n\n        boolean isCatalinaShExecutable = paths.getCatalinaShFile().canExecute();\n        if(!isCatalinaShExecutable) {\n            try {\n                isCatalinaShExecutable = paths.getCatalinaShFile().setExecutable(true);\n            } catch (final SecurityException e) {\n                alerts.addWarning(\"Cannot change CatalinaSh executable attribute.\");\n            }\n        }\n        if(!isCatalinaShExecutable) {\n            alerts.addWarning(\"CatalinaSh is not executable.\");\n        }\n\n        \n        \n        \n\n        \n        final String catalinaBatOriginal = Installers.readAll(paths.getCatalinaBatFile(), alerts);\n\n        \n        if (catalinaBatOriginal == null) {\n            return;\n        }\n\n        \n        if (catalinaBatOriginal.contains(\"Add OpenEJB javaagent\")) {\n            alerts.addWarning(\"OpenEJB javaagent already declared in Tomcat catalina.bat file.\");\n            return;\n        }\n\n        \n        if (!Installers.backup(paths.getCatalinaBatFile(), alerts)) {\n            return;\n        }\n\n        \n        openejbJavaagentPath = openejbJavaagentPath.replace('/', '\\\\');\n        final String newCatalinaBat = catalinaBatOriginal.replace(\"rem ----- Execute The Requested Command\",\n                \"rem Add OpenEJB javaagent\\r\\n\" +\n                        \"if not exist \\\"%CATALINA_HOME%\\\\\" + openejbJavaagentPath + \"\\\" goto noOpenEJBJavaagent\\r\\n\" +\n                        \"set JAVA_OPTS=\\\"-javaagent:%CATALINA_HOME%\\\\\" + openejbJavaagentPath + \"\\\" %JAVA_OPTS%\\r\\n\" +\n                        \":noOpenEJBJavaagent\\r\\n\" +\n                        \"\\r\\n\" +\n                        \"rem ----- Execute The Requested Command\");\n\n        \n        if (Installers.writeAll(paths.getCatalinaBatFile(), newCatalinaBat, alerts)) {\n            alerts.addInfo(\"Add OpenEJB JavaAgent to catalina.bat\");\n        }\n    }"
  },
  {
    "id": 34,
    "sub_id": 6,
    "code_id": 0,
    "function_id": 20,
    "human_patch": "https://github.com/apache/tomee/commit/58cdbbef9c77ab2b44870f9d606593b49cde76d9",
    "cve_id": "CVE-2015-8581",
    "cwe_id": "CWE-502",
    "filename": "tomee/tomee-common/src/main/java/org/apache/tomee/installer/Installer.java",
    "is_vulnerable": 1,
    "class_name": "Installer",
    "subclass_name": null,
    "function_name": "installConfigFiles(final boolean builtIn)",
    "function_body": "{\n        final File openejbCoreJar = paths.getOpenEJBCoreJar();\n        final File confDir = paths.getCatalinaConfDir();\n        final Alerts alerts = this.alerts;\n\n        if (openejbCoreJar == null) {\n            \n            return;\n        }\n        final JarFile coreJar;\n        try {\n            coreJar = new JarFile(openejbCoreJar);\n        } catch (final IOException e) {\n            return;\n        }\n\n        \n        \n        \n        final File openEjbXmlFile = new File(confDir, \"tomee.xml\");\n        if (!openEjbXmlFile.exists()) {\n            \n            final String openEjbXml = Installers.readEntry(coreJar, \"default.openejb.conf\", alerts);\n            if (openEjbXml != null) {\n                if (Installers.writeAll(openEjbXmlFile, openEjbXml.replace(\"<openejb>\", \"<tomee>\").replace(\"</openejb>\", \"</tomee>\"), alerts)) {\n                    alerts.addInfo(\"Copy tomee.xml to conf\");\n                }\n            }\n        }\n\n\n        \n        \n        \n        \n        final String openejbLoggingProps = \"################################\\r\\n\" +\n                \"# OpenEJB/TomEE specific loggers\\r\\n\" +\n                \"################################\\r\\n\" +\n                \"#\\r\\n\" +\n                \"# ACTIVATE LEVEL/HANDLERS YOU WANT\\r\\n\" +\n                \"# IF YOU ACTIVATE 5tomee.org.apache.juli.FileHandler\\r\\n\" +\n                \"# ADD IT TO handlers LINE LIKE:\\r\\n\" +\n                \"#\\r\\n\" +\n                \"# handlers = 1catalina.org.apache.juli.FileHandler, 2localhost.org.apache.juli.FileHandler, 3manager.org.apache.juli.FileHandler, 4host-manager.org.apache.juli.FileHandler, 5tomee.org.apache.juli.FileHandler, java.util.logging.ConsoleHandler\\r\\n\" +\n                \"#\\r\\n\" +\n                \"# LEVELS:\\r\\n\" +\n                \"# =======\\r\\n\" +\n                \"#\\r\\n\" +\n                \"# OpenEJB.level             = WARNING\\r\\n\" +\n                \"# OpenEJB.options.level     = INFO\\r\\n\" +\n                \"# OpenEJB.server.level      = INFO\\r\\n\" +\n                \"# OpenEJB.startup.level     = INFO\\r\\n\" +\n                \"# OpenEJB.startup.service.level = WARNING\\r\\n\" +\n                \"# OpenEJB.startup.config.level = INFO\\r\\n\" +\n                \"# OpenEJB.hsql.level        = INFO\\r\\n\" +\n                \"# CORBA-Adapter.level       = WARNING\\r\\n\" +\n                \"# Transaction.level         = WARNING\\r\\n\" +\n                \"# org.apache.activemq.level = SEVERE\\r\\n\" +\n                \"# org.apache.geronimo.level = SEVERE\\r\\n\" +\n                \"# openjpa.level             = WARNING\\r\\n\" +\n                \"# OpenEJB.cdi.level         = INFO\\r\\n\" +\n                \"# org.apache.webbeans.level = INFO\\r\\n\" +\n                \"# org.apache.openejb.level = FINE\\r\\n\" +\n                \"#\\r\\n\" +\n                \"# HANDLERS:\\r\\n\" +\n                \"# =========\\r\\n\" +\n                \"#\\r\\n\" +\n                \"# OpenEJB.handlers             = 5tomee.org.apache.juli.FileHandler, java.util.logging.ConsoleHandler\\r\\n\" +\n                \"# OpenEJB.options.handlers     = 5tomee.org.apache.juli.FileHandler, java.util.logging.ConsoleHandler\\r\\n\" +\n                \"# OpenEJB.server.handlers      = 5tomee.org.apache.juli.FileHandler, java.util.logging.ConsoleHandler\\r\\n\" +\n                \"# OpenEJB.startup.handlers     = 5tomee.org.apache.juli.FileHandler, java.util.logging.ConsoleHandler\\r\\n\" +\n                \"# OpenEJB.startup.service.handlers = 5tomee.org.apache.juli.FileHandler, java.util.logging.ConsoleHandler\\r\\n\" +\n                \"# OpenEJB.startup.config.handlers = 5tomee.org.apache.juli.FileHandler, java.util.logging.ConsoleHandler\\r\\n\" +\n                \"# OpenEJB.hsql.handlers        = 5tomee.org.apache.juli.FileHandler, java.util.logging.ConsoleHandler\\r\\n\" +\n                \"# CORBA-Adapter.handlers       = 5tomee.org.apache.juli.FileHandler, java.util.logging.ConsoleHandler\\r\\n\" +\n                \"# Transaction.handlers         = 5tomee.org.apache.juli.FileHandler, java.util.logging.ConsoleHandler\\r\\n\" +\n                \"# org.apache.activemq.handlers = 5tomee.org.apache.juli.FileHandler, java.util.logging.ConsoleHandler\\r\\n\" +\n                \"# org.apache.geronimo.handlers = 5tomee.org.apache.juli.FileHandler, java.util.logging.ConsoleHandler\\r\\n\" +\n                \"# openjpa.handlers             = 5tomee.org.apache.juli.FileHandler, java.util.logging.ConsoleHandler\\r\\n\" +\n                \"# OpenEJB.cdi.handlers         = 5tomee.org.apache.juli.FileHandler, java.util.logging.ConsoleHandler\\r\\n\" +\n                \"# org.apache.webbeans.handlers = 5tomee.org.apache.juli.FileHandler, java.util.logging.ConsoleHandler\\r\\n\" +\n                \"# org.apache.openejb.handlers = 5tomee.org.apache.juli.FileHandler, java.util.logging.ConsoleHandler\\r\\n\" +\n                \"#\\r\\n\" +\n                \"# TOMEE HANDLER SAMPLE:\\r\\n\" +\n                \"# =====================\\r\\n\" +\n                \"#\\r\\n\" +\n                \"# 5tomee.org.apache.juli.FileHandler.level = FINEST\\r\\n\" +\n                \"# 5tomee.org.apache.juli.FileHandler.directory = ${catalina.base}/logs\\r\\n\" +\n                \"# 5tomee.org.apache.juli.FileHandler.prefix = tomee.\\r\\n\";\n        final File loggingPropsFile = new File(confDir, \"logging.properties\");\n        String newLoggingProps = null;\n        if (!loggingPropsFile.exists()) {\n            newLoggingProps = openejbLoggingProps;\n        } else {\n            final String loggingPropsOriginal = Installers.readAll(loggingPropsFile, alerts);\n            if (!loggingPropsOriginal.toLowerCase().contains(\"openejb\")) {\n                \n                newLoggingProps = loggingPropsOriginal +\n                        \"\\r\\n\\r\\n\" +\n                        openejbLoggingProps + \"\\r\\n\";\n            }\n        }\n        if (builtIn) {\n            installTomEEJuli(alerts, loggingPropsFile, newLoggingProps);\n        }\n\n        final File openejbSystemProperties = new File(confDir, \"system.properties\");\n        if (!openejbSystemProperties.exists()) {\n            FileWriter systemPropertiesWriter = null;\n            try {\n                systemPropertiesWriter = new FileWriter(openejbSystemProperties);\n\n                systemPropertiesWriter.write(\"# all this properties are added at JVM system properties at startup\\n\");\n                systemPropertiesWriter.write(\"# here some default Apache TomEE system properties\\n\");\n                systemPropertiesWriter.write(\"# for more information please see http://tomee.apache.org/properties-listing.html\\n\");\n\n                systemPropertiesWriter.write(\"\\n\");\n                systemPropertiesWriter.write(\"# openejb.check.classloader = false\\n\");\n                systemPropertiesWriter.write(\"# openejb.check.classloader.verbose = false\\n\");\n\n                systemPropertiesWriter.write(\"\\n\");\n                systemPropertiesWriter.write(\"# tomee.jaxws.subcontext = webservices\\n\");\n                systemPropertiesWriter.write(\"# tomee.jaxws.oldsubcontext = false\\n\");\n\n                systemPropertiesWriter.write(\"\\n\");\n                systemPropertiesWriter.write(\"# if you want to propagate a deployment on a cluster when a tomcat cluster is defined\\n\");\n                systemPropertiesWriter.write(\"# tomee.cluster.deployment = false\\n\");\n\n                systemPropertiesWriter.write(\"\\n\");\n                systemPropertiesWriter.write(\"# openejb.system.apps = true\\n\");\n                systemPropertiesWriter.write(\"# openejb.servicemanager.enabled = true\\n\");\n                systemPropertiesWriter.write(\"# openejb.jmx.active = false\\n\");\n                systemPropertiesWriter.write(\"# openejb.descriptors.output = false\\n\");\n                systemPropertiesWriter.write(\"# openejb.strict.interface.declaration = false\\n\");\n                systemPropertiesWriter.write(\"# openejb.conf.file = conf/tomee.xml\\n\");\n                systemPropertiesWriter.write(\"# openejb.debuggable-vm-hackery = false\\n\");\n                systemPropertiesWriter.write(\"# openejb.validation.skip = false\\n\");\n                systemPropertiesWriter.write(\"# openejb.webservices.enabled = true\\n\");\n                systemPropertiesWriter.write(\"# openejb.validation.output.level = MEDIUM\\n\");\n                systemPropertiesWriter.write(\"# openejb.user.mbeans.list = *\\n\");\n                systemPropertiesWriter.write(\"# openejb.deploymentId.format = {appId}/{ejbJarId}/{ejbName}\\n\");\n                systemPropertiesWriter.write(\"# openejb.jndiname.format = {deploymentId}{interfaceType.annotationName}\\n\");\n                systemPropertiesWriter.write(\"# openejb.deployments.package.include = .*\\n\");\n                systemPropertiesWriter.write(\"# openejb.deployments.package.exclude = \\n\");\n                systemPropertiesWriter.write(\"# openejb.autocreate.jta-datasource-from-non-jta-one = true\\n\");\n                systemPropertiesWriter.write(\"# openejb.altdd.prefix = \\n\");\n                systemPropertiesWriter.write(\"# org.apache.openejb.default.system.interceptors = \\n\");\n                systemPropertiesWriter.write(\"# openejb.jndiname.failoncollision = true\\n\");\n                systemPropertiesWriter.write(\"# openejb.wsAddress.format = /{ejbDeploymentId}\\n\");\n                systemPropertiesWriter.write(\"# org.apache.openejb.server.webservices.saaj.provider = \\n\");\n                systemPropertiesWriter.write(\"# openejb.nobanner = true\\n\");\n                systemPropertiesWriter.write(\"# openejb.offline = false\\n\");\n                systemPropertiesWriter.write(\"# openejb.jmx.active = true\\n\");\n                systemPropertiesWriter.write(\"# openejb.exclude-include.order = include-exclude\\n\");\n                systemPropertiesWriter.write(\"# openejb.additional.exclude =\\n\");\n                systemPropertiesWriter.write(\"# openejb.additional.include =\\n\");\n                systemPropertiesWriter.write(\"# openejb.crosscontext = false\\n\");\n                systemPropertiesWriter.write(\"# openejb.jsessionid-support = \\n\");\n                systemPropertiesWriter.write(\"# openejb.myfaces.disable-default-values = true\\n\");\n                systemPropertiesWriter.write(\"# openejb.web.xml.major = \\n\");\n                systemPropertiesWriter.write(\"# openjpa.Log = \\n\");\n                systemPropertiesWriter.write(\"# openejb.jdbc.log = false\\n\");\n                systemPropertiesWriter.write(\"# javax.persistence.provider = org.apache.openjpa.persistence.PersistenceProviderImpl\\n\");\n                systemPropertiesWriter.write(\"# javax.persistence.transactionType = \\n\");\n                systemPropertiesWriter.write(\"# javax.persistence.jtaDataSource = \\n\");\n                systemPropertiesWriter.write(\"# javax.persistence.nonJtaDataSource = \\n\");\n\n                systemPropertiesWriter.write(\"#\\n\");\n                systemPropertiesWriter.write(\"# Properties for JAS RS\\n\");\n                systemPropertiesWriter.write(\"# openejb.jaxrs.application = \\n\");\n                systemPropertiesWriter.write(\"# openejb.cxf-rs.wadl-generator.ignoreRequests = false\\n\");\n                systemPropertiesWriter.write(\"# openejb.cxf-rs.wadl-generator.ignoreMessageWriters = true\\n\");\n\n                systemPropertiesWriter.write(\"#\\n\");\n                systemPropertiesWriter.write(\"# These properties are only for cxf service (SOAP webservices) and TomEE+\\n\");\n                systemPropertiesWriter.write(\"# If you don't use special tricks and sun default implementation, uncommenting these 4 lines forces TomEE to use it without overhead at all = \\n\");\n                systemPropertiesWriter.write(\"# javax.xml.soap.MessageFactory = com.sun.xml.messaging.saaj.soap.ver1_1.SOAPMessageFactory1_1Impl\\n\");\n                systemPropertiesWriter.write(\"# javax.xml.soap.SOAPFactory = com.sun.xml.messaging.saaj.soap.ver1_1.SOAPFactory1_1Impl\\n\");\n                systemPropertiesWriter.write(\"# javax.xml.soap.SOAPConnectionFactory = com.sun.xml.messaging.saaj.client.p2p.HttpSOAPConnectionFactory\\n\");\n                systemPropertiesWriter.write(\"# javax.xml.soap.MetaFactory = com.sun.xml.messaging.saaj.soap.SAAJMetaFactoryImpl\\n\");\n            } catch (final IOException e) {\n                \n            } finally {\n                if (systemPropertiesWriter != null) {\n                    try {\n                        systemPropertiesWriter.close();\n                    } catch (final IOException e) {\n                        \n                    }\n                }\n            }\n        }\n\n        \n        \n        \n        final JarFile openejbTomcatCommonJar;\n        try {\n            openejbTomcatCommonJar = new JarFile(paths.geOpenEJBTomcatCommonJar());\n        } catch (final IOException e) {\n            return;\n        }\n        final File webXmlFile = new File(confDir, \"web.xml\");\n        final String webXml = Installers.readEntry(openejbTomcatCommonJar, \"conf/web.xml\", alerts);\n        if (Installers.writeAll(webXmlFile, webXml, alerts)) {\n            alerts.addInfo(\"Set jasper in production mode in TomEE web.xml\");\n        }\n    }"
  },
  {
    "id": 34,
    "sub_id": 6,
    "code_id": 0,
    "function_id": 21,
    "human_patch": "https://github.com/apache/tomee/commit/58cdbbef9c77ab2b44870f9d606593b49cde76d9",
    "cve_id": "CVE-2015-8581",
    "cwe_id": "CWE-502",
    "filename": "tomee/tomee-common/src/main/java/org/apache/tomee/installer/Installer.java",
    "is_vulnerable": 0,
    "class_name": "Installer",
    "subclass_name": null,
    "function_name": "installTomEEJuli(final Alerts alerts, final File loggingPropsFile, final String newLoggingProps)",
    "function_body": "{\n        if (newLoggingProps != null && Installers.writeAll(\n                loggingPropsFile,\n                newLoggingProps.replace(\"java.util.logging.ConsoleHandler\", \"org.apache.tomee.jul.formatter.AsyncConsoleHandler\"),\n                alerts)) {\n            alerts.addInfo(\"Append OpenEJB config to logging.properties\");\n        }\n    }"
  },
  {
    "id": 35,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 0,
    "human_patch": "https://github.com/apereo/java-cas-client/commit/ab6cbdc3daa451b4fef89c0bd0f4e6568f3aa9ef",
    "cve_id": "CVE-2014-4172",
    "cwe_id": "CWE-74",
    "filename": "cas-client-core/src/main/java/org/jasig/cas/client/validation/AbstractUrlBasedTicketValidator.java",
    "is_vulnerable": 0,
    "class_name": "AbstractUrlBasedTicketValidator",
    "subclass_name": null,
    "function_name": "populateUrlAttributeMap(final Map<String, String> urlParameters)",
    "function_body": "{\n        \n    }"
  },
  {
    "id": 35,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 1,
    "human_patch": "https://github.com/apereo/java-cas-client/commit/ab6cbdc3daa451b4fef89c0bd0f4e6568f3aa9ef",
    "cve_id": "CVE-2014-4172",
    "cwe_id": "CWE-74",
    "filename": "cas-client-core/src/main/java/org/jasig/cas/client/validation/AbstractUrlBasedTicketValidator.java",
    "is_vulnerable": 0,
    "class_name": "AbstractUrlBasedTicketValidator",
    "subclass_name": null,
    "function_name": "getUrlSuffix()",
    "function_body": null
  },
  {
    "id": 35,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 2,
    "human_patch": "https://github.com/apereo/java-cas-client/commit/ab6cbdc3daa451b4fef89c0bd0f4e6568f3aa9ef",
    "cve_id": "CVE-2014-4172",
    "cwe_id": "CWE-74",
    "filename": "cas-client-core/src/main/java/org/jasig/cas/client/validation/AbstractUrlBasedTicketValidator.java",
    "is_vulnerable": 0,
    "class_name": "AbstractUrlBasedTicketValidator",
    "subclass_name": null,
    "function_name": "setDisableXmlSchemaValidation(boolean disabled)",
    "function_body": null
  },
  {
    "id": 35,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 3,
    "human_patch": "https://github.com/apereo/java-cas-client/commit/ab6cbdc3daa451b4fef89c0bd0f4e6568f3aa9ef",
    "cve_id": "CVE-2014-4172",
    "cwe_id": "CWE-74",
    "filename": "cas-client-core/src/main/java/org/jasig/cas/client/validation/AbstractUrlBasedTicketValidator.java",
    "is_vulnerable": 1,
    "class_name": "AbstractUrlBasedTicketValidator",
    "subclass_name": null,
    "function_name": "constructValidationUrl(final String ticket, final String serviceUrl)",
    "function_body": "{\n        final Map<String, String> urlParameters = new HashMap<String, String>();\n\n        logger.debug(\"Placing URL parameters in map.\");\n        urlParameters.put(\"ticket\", ticket);\n        urlParameters.put(\"service\", encodeUrl(serviceUrl));\n\n        if (this.renew) {\n            urlParameters.put(\"renew\", \"true\");\n        }\n\n        logger.debug(\"Calling template URL attribute map.\");\n        populateUrlAttributeMap(urlParameters);\n\n        logger.debug(\"Loading custom parameters from configuration.\");\n        if (this.customParameters != null) {\n            urlParameters.putAll(this.customParameters);\n        }\n\n        final String suffix = getUrlSuffix();\n        final StringBuilder buffer = new StringBuilder(urlParameters.size() * 10 + this.casServerUrlPrefix.length()\n                + suffix.length() + 1);\n\n        int i = 0;\n\n        buffer.append(this.casServerUrlPrefix);\n        if (!this.casServerUrlPrefix.endsWith(\"/\")) {\n            buffer.append(\"/\");\n        }\n        buffer.append(suffix);\n\n        for (Map.Entry<String, String> entry : urlParameters.entrySet()) {\n            final String key = entry.getKey();\n            final String value = entry.getValue();\n\n            if (value != null) {\n                buffer.append(i++ == 0 ? \"?\" : \"&\");\n                buffer.append(key);\n                buffer.append(\"=\");\n                buffer.append(value);\n            }\n        }\n\n        return buffer.toString();\n\n    }"
  },
  {
    "id": 35,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 4,
    "human_patch": "https://github.com/apereo/java-cas-client/commit/ab6cbdc3daa451b4fef89c0bd0f4e6568f3aa9ef",
    "cve_id": "CVE-2014-4172",
    "cwe_id": "CWE-74",
    "filename": "cas-client-core/src/main/java/org/jasig/cas/client/validation/AbstractUrlBasedTicketValidator.java",
    "is_vulnerable": 0,
    "class_name": "AbstractUrlBasedTicketValidator",
    "subclass_name": null,
    "function_name": "encodeUrl(final String url)",
    "function_body": "{\n        if (url == null) {\n            return null;\n        }\n\n        try {\n            return URLEncoder.encode(url, \"UTF-8\");\n        } catch (final UnsupportedEncodingException e) {\n            return url;\n        }\n    }"
  },
  {
    "id": 35,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 5,
    "human_patch": "https://github.com/apereo/java-cas-client/commit/ab6cbdc3daa451b4fef89c0bd0f4e6568f3aa9ef",
    "cve_id": "CVE-2014-4172",
    "cwe_id": "CWE-74",
    "filename": "cas-client-core/src/main/java/org/jasig/cas/client/validation/AbstractUrlBasedTicketValidator.java",
    "is_vulnerable": 0,
    "class_name": "AbstractUrlBasedTicketValidator",
    "subclass_name": null,
    "function_name": "parseResponseFromServer(final String response) throws TicketValidationException",
    "function_body": null
  },
  {
    "id": 35,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 6,
    "human_patch": "https://github.com/apereo/java-cas-client/commit/ab6cbdc3daa451b4fef89c0bd0f4e6568f3aa9ef",
    "cve_id": "CVE-2014-4172",
    "cwe_id": "CWE-74",
    "filename": "cas-client-core/src/main/java/org/jasig/cas/client/validation/AbstractUrlBasedTicketValidator.java",
    "is_vulnerable": 0,
    "class_name": "AbstractUrlBasedTicketValidator",
    "subclass_name": null,
    "function_name": "retrieveResponseFromServer(URL validationUrl, String ticket)",
    "function_body": null
  },
  {
    "id": 35,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 7,
    "human_patch": "https://github.com/apereo/java-cas-client/commit/ab6cbdc3daa451b4fef89c0bd0f4e6568f3aa9ef",
    "cve_id": "CVE-2014-4172",
    "cwe_id": "CWE-74",
    "filename": "cas-client-core/src/main/java/org/jasig/cas/client/validation/AbstractUrlBasedTicketValidator.java",
    "is_vulnerable": 0,
    "class_name": "AbstractUrlBasedTicketValidator",
    "subclass_name": null,
    "function_name": "validate(final String ticket, final String service) throws TicketValidationException",
    "function_body": "{\n        final String validationUrl = constructValidationUrl(ticket, service);\n        logger.debug(\"Constructing validation url: {}\", validationUrl);\n\n        try {\n            logger.debug(\"Retrieving response from server.\");\n            final String serverResponse = retrieveResponseFromServer(new URL(validationUrl), ticket);\n\n            if (serverResponse == null) {\n                throw new TicketValidationException(\"The CAS server returned no response.\");\n            }\n\n            logger.debug(\"Server response: {}\", serverResponse);\n\n            return parseResponseFromServer(serverResponse);\n        } catch (final MalformedURLException e) {\n            throw new TicketValidationException(e);\n        }\n    }"
  },
  {
    "id": 35,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 8,
    "human_patch": "https://github.com/apereo/java-cas-client/commit/ab6cbdc3daa451b4fef89c0bd0f4e6568f3aa9ef",
    "cve_id": "CVE-2014-4172",
    "cwe_id": "CWE-74",
    "filename": "cas-client-core/src/main/java/org/jasig/cas/client/validation/AbstractUrlBasedTicketValidator.java",
    "is_vulnerable": 0,
    "class_name": "AbstractUrlBasedTicketValidator",
    "subclass_name": null,
    "function_name": "setRenew(final boolean renew)",
    "function_body": "{\n        this.renew = renew;\n    }"
  },
  {
    "id": 35,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 9,
    "human_patch": "https://github.com/apereo/java-cas-client/commit/ab6cbdc3daa451b4fef89c0bd0f4e6568f3aa9ef",
    "cve_id": "CVE-2014-4172",
    "cwe_id": "CWE-74",
    "filename": "cas-client-core/src/main/java/org/jasig/cas/client/validation/AbstractUrlBasedTicketValidator.java",
    "is_vulnerable": 0,
    "class_name": "AbstractUrlBasedTicketValidator",
    "subclass_name": null,
    "function_name": "setCustomParameters(final Map<String, String> customParameters)",
    "function_body": "{\n        this.customParameters = customParameters;\n    }"
  },
  {
    "id": 35,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 10,
    "human_patch": "https://github.com/apereo/java-cas-client/commit/ab6cbdc3daa451b4fef89c0bd0f4e6568f3aa9ef",
    "cve_id": "CVE-2014-4172",
    "cwe_id": "CWE-74",
    "filename": "cas-client-core/src/main/java/org/jasig/cas/client/validation/AbstractUrlBasedTicketValidator.java",
    "is_vulnerable": 0,
    "class_name": "AbstractUrlBasedTicketValidator",
    "subclass_name": null,
    "function_name": "setEncoding(final String encoding)",
    "function_body": "{\n        this.encoding = encoding;\n    }"
  },
  {
    "id": 35,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 11,
    "human_patch": "https://github.com/apereo/java-cas-client/commit/ab6cbdc3daa451b4fef89c0bd0f4e6568f3aa9ef",
    "cve_id": "CVE-2014-4172",
    "cwe_id": "CWE-74",
    "filename": "cas-client-core/src/main/java/org/jasig/cas/client/validation/AbstractUrlBasedTicketValidator.java",
    "is_vulnerable": 0,
    "class_name": "AbstractUrlBasedTicketValidator",
    "subclass_name": null,
    "function_name": "getEncoding()",
    "function_body": "{\n        return this.encoding;\n    }"
  },
  {
    "id": 35,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 12,
    "human_patch": "https://github.com/apereo/java-cas-client/commit/ab6cbdc3daa451b4fef89c0bd0f4e6568f3aa9ef",
    "cve_id": "CVE-2014-4172",
    "cwe_id": "CWE-74",
    "filename": "cas-client-core/src/main/java/org/jasig/cas/client/validation/AbstractUrlBasedTicketValidator.java",
    "is_vulnerable": 0,
    "class_name": "AbstractUrlBasedTicketValidator",
    "subclass_name": null,
    "function_name": "isRenew()",
    "function_body": "{\n        return this.renew;\n    }"
  },
  {
    "id": 35,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 13,
    "human_patch": "https://github.com/apereo/java-cas-client/commit/ab6cbdc3daa451b4fef89c0bd0f4e6568f3aa9ef",
    "cve_id": "CVE-2014-4172",
    "cwe_id": "CWE-74",
    "filename": "cas-client-core/src/main/java/org/jasig/cas/client/validation/AbstractUrlBasedTicketValidator.java",
    "is_vulnerable": 0,
    "class_name": "AbstractUrlBasedTicketValidator",
    "subclass_name": null,
    "function_name": "getCasServerUrlPrefix()",
    "function_body": "{\n        return this.casServerUrlPrefix;\n    }"
  },
  {
    "id": 35,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 14,
    "human_patch": "https://github.com/apereo/java-cas-client/commit/ab6cbdc3daa451b4fef89c0bd0f4e6568f3aa9ef",
    "cve_id": "CVE-2014-4172",
    "cwe_id": "CWE-74",
    "filename": "cas-client-core/src/main/java/org/jasig/cas/client/validation/AbstractUrlBasedTicketValidator.java",
    "is_vulnerable": 0,
    "class_name": "AbstractUrlBasedTicketValidator",
    "subclass_name": null,
    "function_name": "getCustomParameters()",
    "function_body": "{\n        return this.customParameters;\n    }"
  },
  {
    "id": 35,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 15,
    "human_patch": "https://github.com/apereo/java-cas-client/commit/ab6cbdc3daa451b4fef89c0bd0f4e6568f3aa9ef",
    "cve_id": "CVE-2014-4172",
    "cwe_id": "CWE-74",
    "filename": "cas-client-core/src/main/java/org/jasig/cas/client/validation/AbstractUrlBasedTicketValidator.java",
    "is_vulnerable": 0,
    "class_name": "AbstractUrlBasedTicketValidator",
    "subclass_name": null,
    "function_name": "getURLConnectionFactory()",
    "function_body": "{\n        return this.urlConnectionFactory;\n    }"
  },
  {
    "id": 35,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 16,
    "human_patch": "https://github.com/apereo/java-cas-client/commit/ab6cbdc3daa451b4fef89c0bd0f4e6568f3aa9ef",
    "cve_id": "CVE-2014-4172",
    "cwe_id": "CWE-74",
    "filename": "cas-client-core/src/main/java/org/jasig/cas/client/validation/AbstractUrlBasedTicketValidator.java",
    "is_vulnerable": 0,
    "class_name": "AbstractUrlBasedTicketValidator",
    "subclass_name": null,
    "function_name": "setURLConnectionFactory(final HttpURLConnectionFactory urlConnectionFactory)",
    "function_body": "{\n        this.urlConnectionFactory = urlConnectionFactory;\n    }"
  },
  {
    "id": 35,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 0,
    "human_patch": "https://github.com/apereo/java-cas-client/commit/ab6cbdc3daa451b4fef89c0bd0f4e6568f3aa9ef",
    "cve_id": "CVE-2014-4172",
    "cwe_id": "CWE-74",
    "filename": "cas-client-core/src/main/java/org/jasig/cas/client/validation/Cas20ServiceTicketValidator.java",
    "is_vulnerable": 1,
    "class_name": "Cas20ServiceTicketValidator",
    "subclass_name": null,
    "function_name": "populateUrlAttributeMap(final Map<String, String> urlParameters)",
    "function_body": "{\n        urlParameters.put(\"pgtUrl\", encodeUrl(this.proxyCallbackUrl));\n    }"
  },
  {
    "id": 35,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 1,
    "human_patch": "https://github.com/apereo/java-cas-client/commit/ab6cbdc3daa451b4fef89c0bd0f4e6568f3aa9ef",
    "cve_id": "CVE-2014-4172",
    "cwe_id": "CWE-74",
    "filename": "cas-client-core/src/main/java/org/jasig/cas/client/validation/Cas20ServiceTicketValidator.java",
    "is_vulnerable": 0,
    "class_name": "Cas20ServiceTicketValidator",
    "subclass_name": null,
    "function_name": "getUrlSuffix()",
    "function_body": "{\n        return \"serviceValidate\";\n    }"
  },
  {
    "id": 35,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 2,
    "human_patch": "https://github.com/apereo/java-cas-client/commit/ab6cbdc3daa451b4fef89c0bd0f4e6568f3aa9ef",
    "cve_id": "CVE-2014-4172",
    "cwe_id": "CWE-74",
    "filename": "cas-client-core/src/main/java/org/jasig/cas/client/validation/Cas20ServiceTicketValidator.java",
    "is_vulnerable": 0,
    "class_name": "Cas20ServiceTicketValidator",
    "subclass_name": null,
    "function_name": "parseResponseFromServer(final String response) throws TicketValidationException",
    "function_body": "{\n        final String error = XmlUtils.getTextForElement(response, \"authenticationFailure\");\n\n        if (CommonUtils.isNotBlank(error)) {\n            throw new TicketValidationException(error);\n        }\n\n        final String principal = XmlUtils.getTextForElement(response, \"user\");\n        final String proxyGrantingTicketIou = XmlUtils.getTextForElement(response, \"proxyGrantingTicket\");\n\n        final String proxyGrantingTicket;\n        if (CommonUtils.isBlank(proxyGrantingTicketIou) || this.proxyGrantingTicketStorage == null) {\n            proxyGrantingTicket = null;\n        } else {\n            proxyGrantingTicket = this.proxyGrantingTicketStorage.retrieve(proxyGrantingTicketIou);\n        }\n\n        if (CommonUtils.isEmpty(principal)) {\n            throw new TicketValidationException(\"No principal was found in the response from the CAS server.\");\n        }\n\n        final Assertion assertion;\n        final Map<String, Object> attributes = extractCustomAttributes(response);\n        if (CommonUtils.isNotBlank(proxyGrantingTicket)) {\n            final AttributePrincipal attributePrincipal = new AttributePrincipalImpl(principal, attributes,\n                    proxyGrantingTicket, this.proxyRetriever);\n            assertion = new AssertionImpl(attributePrincipal);\n        } else {\n            assertion = new AssertionImpl(new AttributePrincipalImpl(principal, attributes));\n        }\n\n        customParseResponse(response, assertion);\n\n        return assertion;\n    }"
  },
  {
    "id": 35,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 3,
    "human_patch": "https://github.com/apereo/java-cas-client/commit/ab6cbdc3daa451b4fef89c0bd0f4e6568f3aa9ef",
    "cve_id": "CVE-2014-4172",
    "cwe_id": "CWE-74",
    "filename": "cas-client-core/src/main/java/org/jasig/cas/client/validation/Cas20ServiceTicketValidator.java",
    "is_vulnerable": 0,
    "class_name": "Cas20ServiceTicketValidator",
    "subclass_name": null,
    "function_name": "extractCustomAttributes(final String xml)",
    "function_body": "{\n        final SAXParserFactory spf = SAXParserFactory.newInstance();\n        spf.setNamespaceAware(true);\n        spf.setValidating(false);\n        try {\n            final SAXParser saxParser = spf.newSAXParser();\n            final XMLReader xmlReader = saxParser.getXMLReader();\n            final CustomAttributeHandler handler = new CustomAttributeHandler();\n            xmlReader.setContentHandler(handler);\n            xmlReader.parse(new InputSource(new StringReader(xml)));\n            return handler.getAttributes();\n        } catch (final Exception e) {\n            logger.error(e.getMessage(), e);\n            return Collections.emptyMap();\n        }\n    }"
  },
  {
    "id": 35,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 4,
    "human_patch": "https://github.com/apereo/java-cas-client/commit/ab6cbdc3daa451b4fef89c0bd0f4e6568f3aa9ef",
    "cve_id": "CVE-2014-4172",
    "cwe_id": "CWE-74",
    "filename": "cas-client-core/src/main/java/org/jasig/cas/client/validation/Cas20ServiceTicketValidator.java",
    "is_vulnerable": 0,
    "class_name": "Cas20ServiceTicketValidator",
    "subclass_name": null,
    "function_name": "customParseResponse(final String response, final Assertion assertion) throws TicketValidationException",
    "function_body": "{\n        \n    }"
  },
  {
    "id": 35,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 5,
    "human_patch": "https://github.com/apereo/java-cas-client/commit/ab6cbdc3daa451b4fef89c0bd0f4e6568f3aa9ef",
    "cve_id": "CVE-2014-4172",
    "cwe_id": "CWE-74",
    "filename": "cas-client-core/src/main/java/org/jasig/cas/client/validation/Cas20ServiceTicketValidator.java",
    "is_vulnerable": 0,
    "class_name": "Cas20ServiceTicketValidator",
    "subclass_name": null,
    "function_name": "setProxyCallbackUrl(final String proxyCallbackUrl)",
    "function_body": "{\n        this.proxyCallbackUrl = proxyCallbackUrl;\n    }"
  },
  {
    "id": 35,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 6,
    "human_patch": "https://github.com/apereo/java-cas-client/commit/ab6cbdc3daa451b4fef89c0bd0f4e6568f3aa9ef",
    "cve_id": "CVE-2014-4172",
    "cwe_id": "CWE-74",
    "filename": "cas-client-core/src/main/java/org/jasig/cas/client/validation/Cas20ServiceTicketValidator.java",
    "is_vulnerable": 0,
    "class_name": "Cas20ServiceTicketValidator",
    "subclass_name": null,
    "function_name": "setProxyGrantingTicketStorage(final ProxyGrantingTicketStorage proxyGrantingTicketStorage)",
    "function_body": "{\n        this.proxyGrantingTicketStorage = proxyGrantingTicketStorage;\n    }"
  },
  {
    "id": 35,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 7,
    "human_patch": "https://github.com/apereo/java-cas-client/commit/ab6cbdc3daa451b4fef89c0bd0f4e6568f3aa9ef",
    "cve_id": "CVE-2014-4172",
    "cwe_id": "CWE-74",
    "filename": "cas-client-core/src/main/java/org/jasig/cas/client/validation/Cas20ServiceTicketValidator.java",
    "is_vulnerable": 0,
    "class_name": "Cas20ServiceTicketValidator",
    "subclass_name": null,
    "function_name": "setProxyRetriever(final ProxyRetriever proxyRetriever)",
    "function_body": "{\n        this.proxyRetriever = proxyRetriever;\n    }"
  },
  {
    "id": 35,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 8,
    "human_patch": "https://github.com/apereo/java-cas-client/commit/ab6cbdc3daa451b4fef89c0bd0f4e6568f3aa9ef",
    "cve_id": "CVE-2014-4172",
    "cwe_id": "CWE-74",
    "filename": "cas-client-core/src/main/java/org/jasig/cas/client/validation/Cas20ServiceTicketValidator.java",
    "is_vulnerable": 0,
    "class_name": "Cas20ServiceTicketValidator",
    "subclass_name": null,
    "function_name": "getProxyCallbackUrl()",
    "function_body": "{\n        return this.proxyCallbackUrl;\n    }"
  },
  {
    "id": 35,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 9,
    "human_patch": "https://github.com/apereo/java-cas-client/commit/ab6cbdc3daa451b4fef89c0bd0f4e6568f3aa9ef",
    "cve_id": "CVE-2014-4172",
    "cwe_id": "CWE-74",
    "filename": "cas-client-core/src/main/java/org/jasig/cas/client/validation/Cas20ServiceTicketValidator.java",
    "is_vulnerable": 0,
    "class_name": "Cas20ServiceTicketValidator",
    "subclass_name": null,
    "function_name": "getProxyGrantingTicketStorage()",
    "function_body": "{\n        return this.proxyGrantingTicketStorage;\n    }"
  },
  {
    "id": 35,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 10,
    "human_patch": "https://github.com/apereo/java-cas-client/commit/ab6cbdc3daa451b4fef89c0bd0f4e6568f3aa9ef",
    "cve_id": "CVE-2014-4172",
    "cwe_id": "CWE-74",
    "filename": "cas-client-core/src/main/java/org/jasig/cas/client/validation/Cas20ServiceTicketValidator.java",
    "is_vulnerable": 0,
    "class_name": "Cas20ServiceTicketValidator",
    "subclass_name": null,
    "function_name": "getProxyRetriever()",
    "function_body": "{\n        return this.proxyRetriever;\n    }"
  },
  {
    "id": 35,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 11,
    "human_patch": "https://github.com/apereo/java-cas-client/commit/ab6cbdc3daa451b4fef89c0bd0f4e6568f3aa9ef",
    "cve_id": "CVE-2014-4172",
    "cwe_id": "CWE-74",
    "filename": "cas-client-core/src/main/java/org/jasig/cas/client/validation/Cas20ServiceTicketValidator.java",
    "is_vulnerable": 0,
    "class_name": "Cas20ServiceTicketValidator",
    "subclass_name": "CustomAttributeHandler",
    "function_name": "startDocument() throws SAXException",
    "function_body": "{\n            this.attributes = new HashMap<String, Object>();\n        }"
  },
  {
    "id": 35,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 12,
    "human_patch": "https://github.com/apereo/java-cas-client/commit/ab6cbdc3daa451b4fef89c0bd0f4e6568f3aa9ef",
    "cve_id": "CVE-2014-4172",
    "cwe_id": "CWE-74",
    "filename": "cas-client-core/src/main/java/org/jasig/cas/client/validation/Cas20ServiceTicketValidator.java",
    "is_vulnerable": 0,
    "class_name": "Cas20ServiceTicketValidator",
    "subclass_name": "CustomAttributeHandler",
    "function_name": "startElement(final String namespaceURI, final String localName, final String qName,\n                final Attributes attributes) throws SAXException",
    "function_body": "{\n            if (\"attributes\".equals(localName)) {\n                this.foundAttributes = true;\n            } else if (this.foundAttributes) {\n                this.value = new StringBuilder();\n                this.currentAttribute = localName;\n            }\n        }"
  },
  {
    "id": 35,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 13,
    "human_patch": "https://github.com/apereo/java-cas-client/commit/ab6cbdc3daa451b4fef89c0bd0f4e6568f3aa9ef",
    "cve_id": "CVE-2014-4172",
    "cwe_id": "CWE-74",
    "filename": "cas-client-core/src/main/java/org/jasig/cas/client/validation/Cas20ServiceTicketValidator.java",
    "is_vulnerable": 0,
    "class_name": "Cas20ServiceTicketValidator",
    "subclass_name": "CustomAttributeHandler",
    "function_name": "characters(final char[] chars, final int start, final int length) throws SAXException",
    "function_body": "{\n            if (this.currentAttribute != null) {\n                value.append(chars, start, length);\n            }\n        }"
  },
  {
    "id": 35,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 14,
    "human_patch": "https://github.com/apereo/java-cas-client/commit/ab6cbdc3daa451b4fef89c0bd0f4e6568f3aa9ef",
    "cve_id": "CVE-2014-4172",
    "cwe_id": "CWE-74",
    "filename": "cas-client-core/src/main/java/org/jasig/cas/client/validation/Cas20ServiceTicketValidator.java",
    "is_vulnerable": 0,
    "class_name": "Cas20ServiceTicketValidator",
    "subclass_name": "CustomAttributeHandler",
    "function_name": "endElement(final String namespaceURI, final String localName, final String qName) throws SAXException",
    "function_body": "{\n            if (\"attributes\".equals(localName)) {\n                this.foundAttributes = false;\n                this.currentAttribute = null;\n            } else if (this.foundAttributes) {\n                final Object o = this.attributes.get(this.currentAttribute);\n\n                if (o == null) {\n                    this.attributes.put(this.currentAttribute, this.value.toString());\n                } else {\n                    final List<Object> items;\n                    if (o instanceof List) {\n                        items = (List<Object>) o;\n                    } else {\n                        items = new LinkedList<Object>();\n                        items.add(o);\n                        this.attributes.put(this.currentAttribute, items);\n                    }\n                    items.add(this.value.toString());\n                }\n            }\n        }"
  },
  {
    "id": 35,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 15,
    "human_patch": "https://github.com/apereo/java-cas-client/commit/ab6cbdc3daa451b4fef89c0bd0f4e6568f3aa9ef",
    "cve_id": "CVE-2014-4172",
    "cwe_id": "CWE-74",
    "filename": "cas-client-core/src/main/java/org/jasig/cas/client/validation/Cas20ServiceTicketValidator.java",
    "is_vulnerable": 0,
    "class_name": "Cas20ServiceTicketValidator",
    "subclass_name": "CustomAttributeHandler",
    "function_name": "getAttributes()",
    "function_body": "{\n            return this.attributes;\n        }"
  },
  {
    "id": 35,
    "sub_id": 2,
    "code_id": 0,
    "function_id": 0,
    "human_patch": "https://github.com/apereo/java-cas-client/commit/ab6cbdc3daa451b4fef89c0bd0f4e6568f3aa9ef",
    "cve_id": "CVE-2014-4172",
    "cwe_id": "CWE-74",
    "filename": "cas-client-core/src/test/java/org/jasig/cas/client/validation/Cas10TicketValidatorTests.java",
    "is_vulnerable": 0,
    "class_name": "Cas10TicketValidatorTests",
    "subclass_name": null,
    "function_name": "setUp() throws Exception",
    "function_body": "{\n        this.ticketValidator = new Cas10TicketValidator(CONST_CAS_SERVER_URL_PREFIX + \"8090\");\n    }"
  },
  {
    "id": 35,
    "sub_id": 2,
    "code_id": 0,
    "function_id": 1,
    "human_patch": "https://github.com/apereo/java-cas-client/commit/ab6cbdc3daa451b4fef89c0bd0f4e6568f3aa9ef",
    "cve_id": "CVE-2014-4172",
    "cwe_id": "CWE-74",
    "filename": "cas-client-core/src/test/java/org/jasig/cas/client/validation/Cas10TicketValidatorTests.java",
    "is_vulnerable": 0,
    "class_name": "Cas10TicketValidatorTests",
    "subclass_name": null,
    "function_name": "testNoResponse() throws Exception",
    "function_body": "{\n        server.content = \"no\\n\\n\".getBytes(server.encoding);\n        try {\n            this.ticketValidator.validate(\"testTicket\", \"myService\");\n            fail(\"ValidationException expected.\");\n        } catch (final TicketValidationException e) {\n            \n        }\n    }"
  },
  {
    "id": 35,
    "sub_id": 2,
    "code_id": 0,
    "function_id": 2,
    "human_patch": "https://github.com/apereo/java-cas-client/commit/ab6cbdc3daa451b4fef89c0bd0f4e6568f3aa9ef",
    "cve_id": "CVE-2014-4172",
    "cwe_id": "CWE-74",
    "filename": "cas-client-core/src/test/java/org/jasig/cas/client/validation/Cas10TicketValidatorTests.java",
    "is_vulnerable": 0,
    "class_name": "Cas10TicketValidatorTests",
    "subclass_name": null,
    "function_name": "testYesResponse() throws TicketValidationException, UnsupportedEncodingException",
    "function_body": "{\n        server.content = \"yes\\nusername\\n\\n\".getBytes(server.encoding);\n        final Assertion assertion = this.ticketValidator.validate(\"testTicket\", \"myService\");\n        assertEquals(CONST_USERNAME, assertion.getPrincipal().getName());\n    }"
  },
  {
    "id": 35,
    "sub_id": 2,
    "code_id": 0,
    "function_id": 3,
    "human_patch": "https://github.com/apereo/java-cas-client/commit/ab6cbdc3daa451b4fef89c0bd0f4e6568f3aa9ef",
    "cve_id": "CVE-2014-4172",
    "cwe_id": "CWE-74",
    "filename": "cas-client-core/src/test/java/org/jasig/cas/client/validation/Cas10TicketValidatorTests.java",
    "is_vulnerable": 0,
    "class_name": "Cas10TicketValidatorTests",
    "subclass_name": null,
    "function_name": "testBadResponse() throws UnsupportedEncodingException",
    "function_body": "{\n        server.content = \"falalala\\n\\n\".getBytes(server.encoding);\n        try {\n            this.ticketValidator.validate(\"testTicket\", \"myService\");\n            fail(\"ValidationException expected.\");\n        } catch (final TicketValidationException e) {\n            \n        }\n    }"
  },
  {
    "id": 36,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 0,
    "human_patch": "https://github.com/cloudfoundry/uaa/commit/a61bfabbad22f646ecf1f00016b448b26a60daf",
    "cve_id": "CVE-2018-1192",
    "cwe_id": "CWE-200",
    "filename": "server/src/main/java/org/cloudfoundry/identity/uaa/authentication/UaaAuthenticationDetails.java",
    "is_vulnerable": 0,
    "class_name": "UaaAuthenticationDetails",
    "subclass_name": null,
    "function_name": "getOrigin()",
    "function_body": "{\n        return origin;\n    }"
  },
  {
    "id": 36,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 1,
    "human_patch": "https://github.com/cloudfoundry/uaa/commit/a61bfabbad22f646ecf1f00016b448b26a60daf",
    "cve_id": "CVE-2018-1192",
    "cwe_id": "CWE-200",
    "filename": "server/src/main/java/org/cloudfoundry/identity/uaa/authentication/UaaAuthenticationDetails.java",
    "is_vulnerable": 0,
    "class_name": "UaaAuthenticationDetails",
    "subclass_name": null,
    "function_name": "getSessionId()",
    "function_body": "{\n        return sessionId;\n    }"
  },
  {
    "id": 36,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 2,
    "human_patch": "https://github.com/cloudfoundry/uaa/commit/a61bfabbad22f646ecf1f00016b448b26a60daf",
    "cve_id": "CVE-2018-1192",
    "cwe_id": "CWE-200",
    "filename": "server/src/main/java/org/cloudfoundry/identity/uaa/authentication/UaaAuthenticationDetails.java",
    "is_vulnerable": 0,
    "class_name": "UaaAuthenticationDetails",
    "subclass_name": null,
    "function_name": "getClientId()",
    "function_body": "{\n        return clientId;\n    }"
  },
  {
    "id": 36,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 3,
    "human_patch": "https://github.com/cloudfoundry/uaa/commit/a61bfabbad22f646ecf1f00016b448b26a60daf",
    "cve_id": "CVE-2018-1192",
    "cwe_id": "CWE-200",
    "filename": "server/src/main/java/org/cloudfoundry/identity/uaa/authentication/UaaAuthenticationDetails.java",
    "is_vulnerable": 0,
    "class_name": "UaaAuthenticationDetails",
    "subclass_name": null,
    "function_name": "isAddNew()",
    "function_body": "{\n        return addNew;\n    }"
  },
  {
    "id": 36,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 4,
    "human_patch": "https://github.com/cloudfoundry/uaa/commit/a61bfabbad22f646ecf1f00016b448b26a60daf",
    "cve_id": "CVE-2018-1192",
    "cwe_id": "CWE-200",
    "filename": "server/src/main/java/org/cloudfoundry/identity/uaa/authentication/UaaAuthenticationDetails.java",
    "is_vulnerable": 0,
    "class_name": "UaaAuthenticationDetails",
    "subclass_name": null,
    "function_name": "setAddNew(boolean addNew)",
    "function_body": "{\n        this.addNew = addNew;\n    }"
  },
  {
    "id": 36,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 5,
    "human_patch": "https://github.com/cloudfoundry/uaa/commit/a61bfabbad22f646ecf1f00016b448b26a60daf",
    "cve_id": "CVE-2018-1192",
    "cwe_id": "CWE-200",
    "filename": "server/src/main/java/org/cloudfoundry/identity/uaa/authentication/UaaAuthenticationDetails.java",
    "is_vulnerable": 1,
    "class_name": "UaaAuthenticationDetails",
    "subclass_name": null,
    "function_name": "toString()",
    "function_body": "{\n        StringBuilder sb = new StringBuilder();\n        if (origin != null) {\n            sb.append(\"remoteAddress=\").append(origin);\n        }\n        if (clientId != null) {\n            if (sb.length() > 0) {\n                sb.append(\", \");\n            }\n            sb.append(\"clientId=\").append(clientId);\n        }\n        if (sessionId != null) {\n            if (sb.length() > 0) {\n                sb.append(\", \");\n            }\n            sb.append(\"sessionId=\").append(sessionId);\n        }\n        return sb.toString();\n    }"
  },
  {
    "id": 36,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 6,
    "human_patch": "https://github.com/cloudfoundry/uaa/commit/a61bfabbad22f646ecf1f00016b448b26a60daf",
    "cve_id": "CVE-2018-1192",
    "cwe_id": "CWE-200",
    "filename": "server/src/main/java/org/cloudfoundry/identity/uaa/authentication/UaaAuthenticationDetails.java",
    "is_vulnerable": 0,
    "class_name": "UaaAuthenticationDetails",
    "subclass_name": null,
    "function_name": "hashCode()",
    "function_body": "{\n        final int prime = 31;\n        int result = 1;\n        result = prime * result + ((clientId == null) ? 0 : clientId.hashCode());\n        result = prime * result + ((origin == null) ? 0 : origin.hashCode());\n        result = prime * result + ((sessionId == null) ? 0 : sessionId.hashCode());\n        return result;\n    }"
  },
  {
    "id": 36,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 7,
    "human_patch": "https://github.com/cloudfoundry/uaa/commit/a61bfabbad22f646ecf1f00016b448b26a60daf",
    "cve_id": "CVE-2018-1192",
    "cwe_id": "CWE-200",
    "filename": "server/src/main/java/org/cloudfoundry/identity/uaa/authentication/UaaAuthenticationDetails.java",
    "is_vulnerable": 0,
    "class_name": "UaaAuthenticationDetails",
    "subclass_name": null,
    "function_name": "equals(Object obj)",
    "function_body": "{\n        if (this == obj)\n            return true;\n        if (obj == null)\n            return false;\n        if (getClass() != obj.getClass())\n            return false;\n        UaaAuthenticationDetails other = (UaaAuthenticationDetails) obj;\n        if (clientId == null) {\n            if (other.clientId != null)\n                return false;\n        }\n        else if (!clientId.equals(other.clientId))\n            return false;\n        if (origin == null) {\n            if (other.origin != null)\n                return false;\n        }\n        else if (!origin.equals(other.origin))\n            return false;\n        if (sessionId == null) {\n            if (other.sessionId != null)\n                return false;\n        }\n        else if (!sessionId.equals(other.sessionId))\n            return false;\n        return true;\n    }"
  },
  {
    "id": 37,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 0,
    "human_patch": "https://github.com/cloudfoundry/uaa/commit/daeedbe499453b06856556f5e9f7e80d2d1ceb03",
    "cve_id": "CVE-2019-3775",
    "cwe_id": "CWE-287",
    "filename": "server/src/main/java/org/cloudfoundry/identity/uaa/security/ScimUserSelfUpdateAllowed.java",
    "is_vulnerable": 1,
    "class_name": "ScimUserSelfUpdateAllowed",
    "subclass_name": null,
    "function_name": "isAllowed(HttpServletRequest request) throws IOException",
    "function_body": "{\n        String requestBody = IOUtils.toString(request.getReader());\n        ScimUser scimUserFromRequest = JsonUtils.readValue(requestBody, ScimUser.class);\n\n        String id = UaaUrlUtils.extractPathVariableFromUrl(USER_ID_PATH_PARAMETER_INDEX, UaaUrlUtils.getRequestPath(request));\n        String zoneId = IdentityZoneHolder.get().getId();\n        ScimUser scimUserFromDb;\n\n        try {\n            scimUserFromDb = scimUserProvisioning.retrieve(id, zoneId);\n        } catch (ScimResourceNotFoundException e) {\n            return true;\n        }\n\n        if (!scimUserFromDb.getPrimaryEmail().equals(scimUserFromRequest.getPrimaryEmail())) {\n            return false;\n        }\n\n        if (!scimUserFromDb.getUserName().equals(scimUserFromRequest.getUserName())) {\n            return false;\n        }\n\n        if (scimUserFromDb.isVerified() != scimUserFromRequest.isVerified()) {\n            return false;\n        }\n\n        if (scimUserFromDb.isActive() != (scimUserFromRequest.isActive())) {\n            return false;\n        }\n\n        if (!scimUserFromDb.getOrigin().equals(scimUserFromRequest.getOrigin())) {\n            return false;\n        }\n\n\n        return true;\n    }"
  },
  {
    "id": 37,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 0,
    "human_patch": "https://github.com/cloudfoundry/uaa/commit/daeedbe499453b06856556f5e9f7e80d2d1ceb03",
    "cve_id": "CVE-2019-3775",
    "cwe_id": "CWE-287",
    "filename": "server/src/test/java/org/cloudfoundry/identity/uaa/security/ScimUserSelfUpdateAllowedTest.java",
    "is_vulnerable": 0,
    "class_name": "ScimUserSelfUpdateAllowedTest",
    "subclass_name": null,
    "function_name": "setUp()",
    "function_body": "{\n        httpRequest = new MockHttpServletRequest();\n\n        mockScimUserProvisioning = mock(ScimUserProvisioning.class);\n        scimUserSelfUpdateAllowed = new ScimUserSelfUpdateAllowed(mockScimUserProvisioning);\n\n        scimUserFromRequest = new ScimUser();\n        scimUserID = RandomStringUtils.randomAlphabetic(5);\n        scimUserFromRequest.setUserName(\"originalUserName\");\n        scimUserFromRequest.setPrimaryEmail(\"originalEmail@uaa.com\");\n        ScimUser.Name scimUserName = new ScimUser.Name(\"originalGivenName\", \"originalFamilyName\");\n        scimUserFromRequest.setName(scimUserName);\n        scimUserFromRequest.setVerified(false);\n        scimUserFromRequest.setActive(false);\n        scimUserFromRequest.setOrigin(\"originalOrigin\");\n        httpRequest.setContent(JsonUtils.writeValueAsBytes(scimUserFromRequest));\n\n\n        scimUserFromDB = new ScimUser();\n        scimUserFromDB.setId(scimUserID);\n        scimUserFromDB.setUserName(\"originalUserName\");\n        scimUserFromDB.setPrimaryEmail(\"originalEmail@uaa.com\");\n        ScimUser.Name scimUserNameFromDB = new ScimUser.Name(\"originalGivenName\", \"originalFamilyName\");\n        scimUserFromDB.setName(scimUserNameFromDB);\n        scimUserFromDB.setVerified(false);\n        scimUserFromDB.setActive(false);\n        scimUserFromDB.setOrigin(\"originalOrigin\");\n\n        identityZone = MultitenancyFixture.identityZone(RandomStringUtils.randomAlphabetic(5), RandomStringUtils.randomAlphabetic(5));\n        IdentityZoneHolder.set(identityZone);\n\n        when(mockScimUserProvisioning.retrieve(scimUserID, identityZone.getId())).thenReturn(scimUserFromDB);\n        httpRequest.setPathInfo(\"/Users/\" + scimUserID);\n    }"
  },
  {
    "id": 37,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 1,
    "human_patch": "https://github.com/cloudfoundry/uaa/commit/daeedbe499453b06856556f5e9f7e80d2d1ceb03",
    "cve_id": "CVE-2019-3775",
    "cwe_id": "CWE-287",
    "filename": "server/src/test/java/org/cloudfoundry/identity/uaa/security/ScimUserSelfUpdateAllowedTest.java",
    "is_vulnerable": 0,
    "class_name": "ScimUserSelfUpdateAllowedTest",
    "subclass_name": "WithInternalUserStoreEnabled",
    "function_name": "isAllowedToUpdateScimUser_WithSameValue(String method) throws IOException",
    "function_body": "{\n            httpRequest.setMethod(method);\n\n            assertThat(scimUserSelfUpdateAllowed.isAllowed(httpRequest), is(true));\n        }"
  },
  {
    "id": 37,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 2,
    "human_patch": "https://github.com/cloudfoundry/uaa/commit/daeedbe499453b06856556f5e9f7e80d2d1ceb03",
    "cve_id": "CVE-2019-3775",
    "cwe_id": "CWE-287",
    "filename": "server/src/test/java/org/cloudfoundry/identity/uaa/security/ScimUserSelfUpdateAllowedTest.java",
    "is_vulnerable": 0,
    "class_name": "ScimUserSelfUpdateAllowedTest",
    "subclass_name": "WithInternalUserStoreEnabled",
    "function_name": "setupNoUserInDB()",
    "function_body": "{\n                when(mockScimUserProvisioning.retrieve(scimUserID, identityZone.getId())).thenThrow(ScimResourceNotFoundException.class);\n            }"
  },
  {
    "id": 37,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 3,
    "human_patch": "https://github.com/cloudfoundry/uaa/commit/daeedbe499453b06856556f5e9f7e80d2d1ceb03",
    "cve_id": "CVE-2019-3775",
    "cwe_id": "CWE-287",
    "filename": "server/src/test/java/org/cloudfoundry/identity/uaa/security/ScimUserSelfUpdateAllowedTest.java",
    "is_vulnerable": 0,
    "class_name": "ScimUserSelfUpdateAllowedTest",
    "subclass_name": "WithInternalUserStoreEnabled",
    "function_name": "isAllowed(String method) throws IOException",
    "function_body": "{\n                httpRequest.setMethod(method);\n\n                assertThat(scimUserSelfUpdateAllowed.isAllowed(httpRequest), is(true));\n            }"
  },
  {
    "id": 37,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 4,
    "human_patch": "https://github.com/cloudfoundry/uaa/commit/daeedbe499453b06856556f5e9f7e80d2d1ceb03",
    "cve_id": "CVE-2019-3775",
    "cwe_id": "CWE-287",
    "filename": "server/src/test/java/org/cloudfoundry/identity/uaa/security/ScimUserSelfUpdateAllowedTest.java",
    "is_vulnerable": 0,
    "class_name": "ScimUserSelfUpdateAllowedTest",
    "subclass_name": "WithInternalUserStoreEnabled",
    "function_name": "setup()",
    "function_body": "{\n                    scimUserFromRequest.setName(new ScimUser.Name(\"updatedGivenName\", \"updatedFamilyName\"));\n                    httpRequest.setContent(JsonUtils.writeValueAsBytes(scimUserFromRequest));\n                }"
  },
  {
    "id": 37,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 5,
    "human_patch": "https://github.com/cloudfoundry/uaa/commit/daeedbe499453b06856556f5e9f7e80d2d1ceb03",
    "cve_id": "CVE-2019-3775",
    "cwe_id": "CWE-287",
    "filename": "server/src/test/java/org/cloudfoundry/identity/uaa/security/ScimUserSelfUpdateAllowedTest.java",
    "is_vulnerable": 0,
    "class_name": "ScimUserSelfUpdateAllowedTest",
    "subclass_name": "WithInternalUserStoreEnabled",
    "function_name": "isAllowedToUpdateGivenAndFamilyName(String method) throws IOException",
    "function_body": "{\n                    httpRequest.setMethod(method);\n\n                    assertThat(scimUserSelfUpdateAllowed.isAllowed(httpRequest), is(true));\n                }"
  },
  {
    "id": 37,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 6,
    "human_patch": "https://github.com/cloudfoundry/uaa/commit/daeedbe499453b06856556f5e9f7e80d2d1ceb03",
    "cve_id": "CVE-2019-3775",
    "cwe_id": "CWE-287",
    "filename": "server/src/test/java/org/cloudfoundry/identity/uaa/security/ScimUserSelfUpdateAllowedTest.java",
    "is_vulnerable": 1,
    "class_name": "ScimUserSelfUpdateAllowedTest",
    "subclass_name": "WithInternalUserStoreEnabled",
    "function_name": "setup()",
    "function_body": "{\n                    scimUserFromRequest.setEmails(null);\n                    httpRequest.setContent(JsonUtils.writeValueAsBytes(scimUserFromRequest));\n                }"
  },
  {
    "id": 37,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 7,
    "human_patch": "https://github.com/cloudfoundry/uaa/commit/daeedbe499453b06856556f5e9f7e80d2d1ceb03",
    "cve_id": "CVE-2019-3775",
    "cwe_id": "CWE-287",
    "filename": "server/src/test/java/org/cloudfoundry/identity/uaa/security/ScimUserSelfUpdateAllowedTest.java",
    "is_vulnerable": 0,
    "class_name": "ScimUserSelfUpdateAllowedTest",
    "subclass_name": "WithInternalUserStoreEnabled",
    "function_name": "isNotAllowedToUpdateField(String method) throws IOException",
    "function_body": "{\n                    httpRequest.setMethod(method);\n\n                    assertThat(scimUserSelfUpdateAllowed.isAllowed(httpRequest), is(false));\n                }"
  },
  {
    "id": 37,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 8,
    "human_patch": "https://github.com/cloudfoundry/uaa/commit/daeedbe499453b06856556f5e9f7e80d2d1ceb03",
    "cve_id": "CVE-2019-3775",
    "cwe_id": "CWE-287",
    "filename": "server/src/test/java/org/cloudfoundry/identity/uaa/security/ScimUserSelfUpdateAllowedTest.java",
    "is_vulnerable": 1,
    "class_name": "ScimUserSelfUpdateAllowedTest",
    "subclass_name": "WithInternalUserStoreEnabled",
    "function_name": "setup()",
    "function_body": "{\n                    scimUserFromRequest.setUserName(null);\n                    httpRequest.setContent(JsonUtils.writeValueAsBytes(scimUserFromRequest));\n                }"
  },
  {
    "id": 37,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 9,
    "human_patch": "https://github.com/cloudfoundry/uaa/commit/daeedbe499453b06856556f5e9f7e80d2d1ceb03",
    "cve_id": "CVE-2019-3775",
    "cwe_id": "CWE-287",
    "filename": "server/src/test/java/org/cloudfoundry/identity/uaa/security/ScimUserSelfUpdateAllowedTest.java",
    "is_vulnerable": 0,
    "class_name": "ScimUserSelfUpdateAllowedTest",
    "subclass_name": "WithInternalUserStoreEnabled",
    "function_name": "isNotAllowedToUpdateField(String method) throws IOException",
    "function_body": "{\n                    httpRequest.setMethod(method);\n\n                    assertThat(scimUserSelfUpdateAllowed.isAllowed(httpRequest), is(false));\n                }"
  },
  {
    "id": 37,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 10,
    "human_patch": "https://github.com/cloudfoundry/uaa/commit/daeedbe499453b06856556f5e9f7e80d2d1ceb03",
    "cve_id": "CVE-2019-3775",
    "cwe_id": "CWE-287",
    "filename": "server/src/test/java/org/cloudfoundry/identity/uaa/security/ScimUserSelfUpdateAllowedTest.java",
    "is_vulnerable": 1,
    "class_name": "ScimUserSelfUpdateAllowedTest",
    "subclass_name": "WithInternalUserStoreEnabled",
    "function_name": "setup()",
    "function_body": "{\n                    scimUserFromRequest.setVerified(true);\n                    httpRequest.setContent(JsonUtils.writeValueAsBytes(scimUserFromRequest));\n                }"
  },
  {
    "id": 37,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 11,
    "human_patch": "https://github.com/cloudfoundry/uaa/commit/daeedbe499453b06856556f5e9f7e80d2d1ceb03",
    "cve_id": "CVE-2019-3775",
    "cwe_id": "CWE-287",
    "filename": "server/src/test/java/org/cloudfoundry/identity/uaa/security/ScimUserSelfUpdateAllowedTest.java",
    "is_vulnerable": 0,
    "class_name": "ScimUserSelfUpdateAllowedTest",
    "subclass_name": "WithInternalUserStoreEnabled",
    "function_name": "isNotAllowedToUpdateField(String method) throws IOException",
    "function_body": "{\n                    httpRequest.setMethod(method);\n\n                    assertThat(scimUserSelfUpdateAllowed.isAllowed(httpRequest), is(false));\n                }"
  },
  {
    "id": 37,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 12,
    "human_patch": "https://github.com/cloudfoundry/uaa/commit/daeedbe499453b06856556f5e9f7e80d2d1ceb03",
    "cve_id": "CVE-2019-3775",
    "cwe_id": "CWE-287",
    "filename": "server/src/test/java/org/cloudfoundry/identity/uaa/security/ScimUserSelfUpdateAllowedTest.java",
    "is_vulnerable": 1,
    "class_name": "ScimUserSelfUpdateAllowedTest",
    "subclass_name": "WithInternalUserStoreEnabled",
    "function_name": "setup()",
    "function_body": "{\n                    scimUserFromRequest.setActive(true);\n                    httpRequest.setContent(JsonUtils.writeValueAsBytes(scimUserFromRequest));\n                }"
  },
  {
    "id": 37,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 13,
    "human_patch": "https://github.com/cloudfoundry/uaa/commit/daeedbe499453b06856556f5e9f7e80d2d1ceb03",
    "cve_id": "CVE-2019-3775",
    "cwe_id": "CWE-287",
    "filename": "server/src/test/java/org/cloudfoundry/identity/uaa/security/ScimUserSelfUpdateAllowedTest.java",
    "is_vulnerable": 0,
    "class_name": "ScimUserSelfUpdateAllowedTest",
    "subclass_name": "WithInternalUserStoreEnabled",
    "function_name": "isNotAllowedToUpdateField(String method) throws IOException",
    "function_body": "{\n                    httpRequest.setMethod(method);\n\n                    assertThat(scimUserSelfUpdateAllowed.isAllowed(httpRequest), is(false));\n                }"
  },
  {
    "id": 37,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 14,
    "human_patch": "https://github.com/cloudfoundry/uaa/commit/daeedbe499453b06856556f5e9f7e80d2d1ceb03",
    "cve_id": "CVE-2019-3775",
    "cwe_id": "CWE-287",
    "filename": "server/src/test/java/org/cloudfoundry/identity/uaa/security/ScimUserSelfUpdateAllowedTest.java",
    "is_vulnerable": 1,
    "class_name": "ScimUserSelfUpdateAllowedTest",
    "subclass_name": "WithInternalUserStoreEnabled",
    "function_name": "setup()",
    "function_body": "{\n                    scimUserFromRequest.setOrigin(\"updatedOrigin\");\n                    httpRequest.setContent(JsonUtils.writeValueAsBytes(scimUserFromRequest));\n                }"
  },
  {
    "id": 37,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 15,
    "human_patch": "https://github.com/cloudfoundry/uaa/commit/daeedbe499453b06856556f5e9f7e80d2d1ceb03",
    "cve_id": "CVE-2019-3775",
    "cwe_id": "CWE-287",
    "filename": "server/src/test/java/org/cloudfoundry/identity/uaa/security/ScimUserSelfUpdateAllowedTest.java",
    "is_vulnerable": 0,
    "class_name": "ScimUserSelfUpdateAllowedTest",
    "subclass_name": "WithInternalUserStoreEnabled",
    "function_name": "isNotAllowedToUpdateField(String method) throws IOException",
    "function_body": "{\n                    httpRequest.setMethod(method);\n\n                    assertThat(scimUserSelfUpdateAllowed.isAllowed(httpRequest), is(false));\n                }"
  },
  {
    "id": 38,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 0,
    "human_patch": "https://github.com/codehaus-plexus/plexus-archiver/commit/58bc24e465c0842981692adbf6d75680298989de",
    "cve_id": "CVE-2018-1002200",
    "cwe_id": "CWE-22",
    "filename": "src/main/java/org/codehaus/plexus/archiver/AbstractUnArchiver.java",
    "is_vulnerable": 0,
    "class_name": "AbstractUnArchiver",
    "subclass_name": null,
    "function_name": "getDestDirectory()",
    "function_body": "{\n        return destDirectory;\n    }"
  },
  {
    "id": 38,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 1,
    "human_patch": "https://github.com/codehaus-plexus/plexus-archiver/commit/58bc24e465c0842981692adbf6d75680298989de",
    "cve_id": "CVE-2018-1002200",
    "cwe_id": "CWE-22",
    "filename": "src/main/java/org/codehaus/plexus/archiver/AbstractUnArchiver.java",
    "is_vulnerable": 0,
    "class_name": "AbstractUnArchiver",
    "subclass_name": null,
    "function_name": "setDestDirectory( final File destDirectory )",
    "function_body": "{\n        this.destDirectory = destDirectory;\n    }"
  },
  {
    "id": 38,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 2,
    "human_patch": "https://github.com/codehaus-plexus/plexus-archiver/commit/58bc24e465c0842981692adbf6d75680298989de",
    "cve_id": "CVE-2018-1002200",
    "cwe_id": "CWE-22",
    "filename": "src/main/java/org/codehaus/plexus/archiver/AbstractUnArchiver.java",
    "is_vulnerable": 0,
    "class_name": "AbstractUnArchiver",
    "subclass_name": null,
    "function_name": "getDestFile()",
    "function_body": "{\n        return destFile;\n    }"
  },
  {
    "id": 38,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 3,
    "human_patch": "https://github.com/codehaus-plexus/plexus-archiver/commit/58bc24e465c0842981692adbf6d75680298989de",
    "cve_id": "CVE-2018-1002200",
    "cwe_id": "CWE-22",
    "filename": "src/main/java/org/codehaus/plexus/archiver/AbstractUnArchiver.java",
    "is_vulnerable": 0,
    "class_name": "AbstractUnArchiver",
    "subclass_name": null,
    "function_name": "setDestFile( final File destFile )",
    "function_body": "{\n        this.destFile = destFile;\n    }"
  },
  {
    "id": 38,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 4,
    "human_patch": "https://github.com/codehaus-plexus/plexus-archiver/commit/58bc24e465c0842981692adbf6d75680298989de",
    "cve_id": "CVE-2018-1002200",
    "cwe_id": "CWE-22",
    "filename": "src/main/java/org/codehaus/plexus/archiver/AbstractUnArchiver.java",
    "is_vulnerable": 0,
    "class_name": "AbstractUnArchiver",
    "subclass_name": null,
    "function_name": "getSourceFile()",
    "function_body": "{\n        return sourceFile;\n    }"
  },
  {
    "id": 38,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 5,
    "human_patch": "https://github.com/codehaus-plexus/plexus-archiver/commit/58bc24e465c0842981692adbf6d75680298989de",
    "cve_id": "CVE-2018-1002200",
    "cwe_id": "CWE-22",
    "filename": "src/main/java/org/codehaus/plexus/archiver/AbstractUnArchiver.java",
    "is_vulnerable": 0,
    "class_name": "AbstractUnArchiver",
    "subclass_name": null,
    "function_name": "setSourceFile( final File sourceFile )",
    "function_body": "{\n        this.sourceFile = sourceFile;\n    }"
  },
  {
    "id": 38,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 6,
    "human_patch": "https://github.com/codehaus-plexus/plexus-archiver/commit/58bc24e465c0842981692adbf6d75680298989de",
    "cve_id": "CVE-2018-1002200",
    "cwe_id": "CWE-22",
    "filename": "src/main/java/org/codehaus/plexus/archiver/AbstractUnArchiver.java",
    "is_vulnerable": 0,
    "class_name": "AbstractUnArchiver",
    "subclass_name": null,
    "function_name": "isOverwrite()",
    "function_body": "{\n        return overwrite;\n    }"
  },
  {
    "id": 38,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 7,
    "human_patch": "https://github.com/codehaus-plexus/plexus-archiver/commit/58bc24e465c0842981692adbf6d75680298989de",
    "cve_id": "CVE-2018-1002200",
    "cwe_id": "CWE-22",
    "filename": "src/main/java/org/codehaus/plexus/archiver/AbstractUnArchiver.java",
    "is_vulnerable": 0,
    "class_name": "AbstractUnArchiver",
    "subclass_name": null,
    "function_name": "setOverwrite( final boolean b )",
    "function_body": "{\n        overwrite = b;\n    }"
  },
  {
    "id": 38,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 8,
    "human_patch": "https://github.com/codehaus-plexus/plexus-archiver/commit/58bc24e465c0842981692adbf6d75680298989de",
    "cve_id": "CVE-2018-1002200",
    "cwe_id": "CWE-22",
    "filename": "src/main/java/org/codehaus/plexus/archiver/AbstractUnArchiver.java",
    "is_vulnerable": 0,
    "class_name": "AbstractUnArchiver",
    "subclass_name": null,
    "function_name": "extract() throws ArchiverException",
    "function_body": "{\n        validate();\n        execute();\n        runArchiveFinalizers();\n    }"
  },
  {
    "id": 38,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 9,
    "human_patch": "https://github.com/codehaus-plexus/plexus-archiver/commit/58bc24e465c0842981692adbf6d75680298989de",
    "cve_id": "CVE-2018-1002200",
    "cwe_id": "CWE-22",
    "filename": "src/main/java/org/codehaus/plexus/archiver/AbstractUnArchiver.java",
    "is_vulnerable": 0,
    "class_name": "AbstractUnArchiver",
    "subclass_name": null,
    "function_name": "extract( final String path, final File outputDirectory ) throws ArchiverException",
    "function_body": "{\n        validate( path, outputDirectory );\n        execute( path, outputDirectory );\n        runArchiveFinalizers();\n    }"
  },
  {
    "id": 38,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 10,
    "human_patch": "https://github.com/codehaus-plexus/plexus-archiver/commit/58bc24e465c0842981692adbf6d75680298989de",
    "cve_id": "CVE-2018-1002200",
    "cwe_id": "CWE-22",
    "filename": "src/main/java/org/codehaus/plexus/archiver/AbstractUnArchiver.java",
    "is_vulnerable": 0,
    "class_name": "AbstractUnArchiver",
    "subclass_name": null,
    "function_name": "addArchiveFinalizer( final ArchiveFinalizer finalizer )",
    "function_body": "{\n        if ( finalizers == null )\n        {\n            finalizers = new ArrayList();\n        }\n\n        finalizers.add( finalizer );\n    }"
  },
  {
    "id": 38,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 11,
    "human_patch": "https://github.com/codehaus-plexus/plexus-archiver/commit/58bc24e465c0842981692adbf6d75680298989de",
    "cve_id": "CVE-2018-1002200",
    "cwe_id": "CWE-22",
    "filename": "src/main/java/org/codehaus/plexus/archiver/AbstractUnArchiver.java",
    "is_vulnerable": 0,
    "class_name": "AbstractUnArchiver",
    "subclass_name": null,
    "function_name": "setArchiveFinalizers( final List archiveFinalizers )",
    "function_body": "{\n        finalizers = archiveFinalizers;\n    }"
  },
  {
    "id": 38,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 12,
    "human_patch": "https://github.com/codehaus-plexus/plexus-archiver/commit/58bc24e465c0842981692adbf6d75680298989de",
    "cve_id": "CVE-2018-1002200",
    "cwe_id": "CWE-22",
    "filename": "src/main/java/org/codehaus/plexus/archiver/AbstractUnArchiver.java",
    "is_vulnerable": 0,
    "class_name": "AbstractUnArchiver",
    "subclass_name": null,
    "function_name": "runArchiveFinalizers() throws ArchiverException",
    "function_body": "{\n        if ( finalizers != null )\n        {\n            for ( Object finalizer1 : finalizers )\n            {\n                final ArchiveFinalizer finalizer = (ArchiveFinalizer) finalizer1;\n\n                finalizer.finalizeArchiveExtraction( this );\n            }\n        }\n    }"
  },
  {
    "id": 38,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 13,
    "human_patch": "https://github.com/codehaus-plexus/plexus-archiver/commit/58bc24e465c0842981692adbf6d75680298989de",
    "cve_id": "CVE-2018-1002200",
    "cwe_id": "CWE-22",
    "filename": "src/main/java/org/codehaus/plexus/archiver/AbstractUnArchiver.java",
    "is_vulnerable": 0,
    "class_name": "AbstractUnArchiver",
    "subclass_name": null,
    "function_name": "validate( final String path, final File outputDirectory )",
    "function_body": "{\n    }"
  },
  {
    "id": 38,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 14,
    "human_patch": "https://github.com/codehaus-plexus/plexus-archiver/commit/58bc24e465c0842981692adbf6d75680298989de",
    "cve_id": "CVE-2018-1002200",
    "cwe_id": "CWE-22",
    "filename": "src/main/java/org/codehaus/plexus/archiver/AbstractUnArchiver.java",
    "is_vulnerable": 0,
    "class_name": "AbstractUnArchiver",
    "subclass_name": null,
    "function_name": "validate() throws ArchiverException",
    "function_body": "{\n        if ( sourceFile == null )\n        {\n            throw new ArchiverException( \"The source file isn't defined.\" );\n        }\n\n        if ( sourceFile.isDirectory() )\n        {\n            throw new ArchiverException( \"The source must not be a directory.\" );\n        }\n\n        if ( !sourceFile.exists() )\n        {\n            throw new ArchiverException( \"The source file \" + sourceFile + \" doesn't exist.\" );\n        }\n\n        if ( destDirectory == null && destFile == null )\n        {\n            throw new ArchiverException( \"The destination isn't defined.\" );\n        }\n\n        if ( destDirectory != null && destFile != null )\n        {\n            throw new ArchiverException( \"You must choose between a destination directory and a destination file.\" );\n        }\n\n        if ( destDirectory != null && !destDirectory.isDirectory() )\n        {\n            destFile = destDirectory;\n            destDirectory = null;\n        }\n\n        if ( destFile != null && destFile.isDirectory() )\n        {\n            destDirectory = destFile;\n            destFile = null;\n        }\n    }"
  },
  {
    "id": 38,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 15,
    "human_patch": "https://github.com/codehaus-plexus/plexus-archiver/commit/58bc24e465c0842981692adbf6d75680298989de",
    "cve_id": "CVE-2018-1002200",
    "cwe_id": "CWE-22",
    "filename": "src/main/java/org/codehaus/plexus/archiver/AbstractUnArchiver.java",
    "is_vulnerable": 0,
    "class_name": "AbstractUnArchiver",
    "subclass_name": null,
    "function_name": "setFileSelectors( final FileSelector[] fileSelectors )",
    "function_body": "{\n        this.fileSelectors = fileSelectors;\n    }"
  },
  {
    "id": 38,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 16,
    "human_patch": "https://github.com/codehaus-plexus/plexus-archiver/commit/58bc24e465c0842981692adbf6d75680298989de",
    "cve_id": "CVE-2018-1002200",
    "cwe_id": "CWE-22",
    "filename": "src/main/java/org/codehaus/plexus/archiver/AbstractUnArchiver.java",
    "is_vulnerable": 0,
    "class_name": "AbstractUnArchiver",
    "subclass_name": null,
    "function_name": "getFileSelectors()",
    "function_body": "{\n        return fileSelectors;\n    }"
  },
  {
    "id": 38,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 17,
    "human_patch": "https://github.com/codehaus-plexus/plexus-archiver/commit/58bc24e465c0842981692adbf6d75680298989de",
    "cve_id": "CVE-2018-1002200",
    "cwe_id": "CWE-22",
    "filename": "src/main/java/org/codehaus/plexus/archiver/AbstractUnArchiver.java",
    "is_vulnerable": 0,
    "class_name": "AbstractUnArchiver",
    "subclass_name": null,
    "function_name": "isSelected( final String fileName, final PlexusIoResource fileInfo ) throws ArchiverException",
    "function_body": "{\n        if ( fileSelectors != null )\n        {\n            for ( FileSelector fileSelector : fileSelectors )\n            {\n                try\n                {\n\n                    if ( !fileSelector.isSelected( fileInfo ) )\n                    {\n                        return false;\n                    }\n                }\n                catch ( final IOException e )\n                {\n                    throw new ArchiverException(\n                        \"Failed to check, whether \" + fileInfo.getName() + \" is selected: \" + e.getMessage(), e );\n                }\n            }\n        }\n        return true;\n    }"
  },
  {
    "id": 38,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 18,
    "human_patch": "https://github.com/codehaus-plexus/plexus-archiver/commit/58bc24e465c0842981692adbf6d75680298989de",
    "cve_id": "CVE-2018-1002200",
    "cwe_id": "CWE-22",
    "filename": "src/main/java/org/codehaus/plexus/archiver/AbstractUnArchiver.java",
    "is_vulnerable": 0,
    "class_name": "AbstractUnArchiver",
    "subclass_name": null,
    "function_name": "execute() throws ArchiverException",
    "function_body": null
  },
  {
    "id": 38,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 19,
    "human_patch": "https://github.com/codehaus-plexus/plexus-archiver/commit/58bc24e465c0842981692adbf6d75680298989de",
    "cve_id": "CVE-2018-1002200",
    "cwe_id": "CWE-22",
    "filename": "src/main/java/org/codehaus/plexus/archiver/AbstractUnArchiver.java",
    "is_vulnerable": 0,
    "class_name": "AbstractUnArchiver",
    "subclass_name": null,
    "function_name": "execute( String path, File outputDirectory ) throws ArchiverException",
    "function_body": null
  },
  {
    "id": 38,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 20,
    "human_patch": "https://github.com/codehaus-plexus/plexus-archiver/commit/58bc24e465c0842981692adbf6d75680298989de",
    "cve_id": "CVE-2018-1002200",
    "cwe_id": "CWE-22",
    "filename": "src/main/java/org/codehaus/plexus/archiver/AbstractUnArchiver.java",
    "is_vulnerable": 0,
    "class_name": "AbstractUnArchiver",
    "subclass_name": null,
    "function_name": "isUseJvmChmod()",
    "function_body": "{\n        return useJvmChmod;\n    }"
  },
  {
    "id": 38,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 21,
    "human_patch": "https://github.com/codehaus-plexus/plexus-archiver/commit/58bc24e465c0842981692adbf6d75680298989de",
    "cve_id": "CVE-2018-1002200",
    "cwe_id": "CWE-22",
    "filename": "src/main/java/org/codehaus/plexus/archiver/AbstractUnArchiver.java",
    "is_vulnerable": 0,
    "class_name": "AbstractUnArchiver",
    "subclass_name": null,
    "function_name": "setUseJvmChmod( final boolean useJvmChmod )",
    "function_body": "{\n        this.useJvmChmod = useJvmChmod;\n    }"
  },
  {
    "id": 38,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 22,
    "human_patch": "https://github.com/codehaus-plexus/plexus-archiver/commit/58bc24e465c0842981692adbf6d75680298989de",
    "cve_id": "CVE-2018-1002200",
    "cwe_id": "CWE-22",
    "filename": "src/main/java/org/codehaus/plexus/archiver/AbstractUnArchiver.java",
    "is_vulnerable": 0,
    "class_name": "AbstractUnArchiver",
    "subclass_name": null,
    "function_name": "isIgnorePermissions()",
    "function_body": "{\n        return ignorePermissions;\n    }"
  },
  {
    "id": 38,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 23,
    "human_patch": "https://github.com/codehaus-plexus/plexus-archiver/commit/58bc24e465c0842981692adbf6d75680298989de",
    "cve_id": "CVE-2018-1002200",
    "cwe_id": "CWE-22",
    "filename": "src/main/java/org/codehaus/plexus/archiver/AbstractUnArchiver.java",
    "is_vulnerable": 0,
    "class_name": "AbstractUnArchiver",
    "subclass_name": null,
    "function_name": "setIgnorePermissions( final boolean ignorePermissions )",
    "function_body": "{\n        this.ignorePermissions = ignorePermissions;\n    }"
  },
  {
    "id": 38,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 24,
    "human_patch": "https://github.com/codehaus-plexus/plexus-archiver/commit/58bc24e465c0842981692adbf6d75680298989de",
    "cve_id": "CVE-2018-1002200",
    "cwe_id": "CWE-22",
    "filename": "src/main/java/org/codehaus/plexus/archiver/AbstractUnArchiver.java",
    "is_vulnerable": 1,
    "class_name": "AbstractUnArchiver",
    "subclass_name": null,
    "function_name": "extractFile( final File srcF, final File dir, final InputStream compressedInputStream,\n                                final String entryName, final Date entryDate, final boolean isDirectory,\n                                final Integer mode, String symlinkDestination ) throws IOException, ArchiverException",
    "function_body": "{\n        \n        final File f = FileUtils.resolveFile( dir, entryName );\n\n        try\n        {\n            if ( !isOverwrite() && f.exists() && ( f.lastModified() >= entryDate.getTime() ) )\n            {\n                return;\n            }\n\n            \n            final File dirF = f.getParentFile();\n            if ( dirF != null )\n            {\n                dirF.mkdirs();\n            }\n\n            if ( !StringUtils.isEmpty( symlinkDestination ) )\n            {\n                SymlinkUtils.createSymbolicLink( f, new File( symlinkDestination ) );\n            }\n            else if ( isDirectory )\n            {\n                f.mkdirs();\n            }\n            else\n            {\n                OutputStream out = null;\n                try\n                {\n                    out = new FileOutputStream( f );\n\n                    IOUtil.copy( compressedInputStream, out );\n                    out.close();\n                    out = null;\n                }\n                finally\n                {\n                    IOUtil.close( out );\n                }\n            }\n\n            f.setLastModified( entryDate.getTime() );\n\n            if ( !isIgnorePermissions() && mode != null && !isDirectory )\n            {\n                ArchiveEntryUtils.chmod( f, mode );\n            }\n        }\n        catch ( final FileNotFoundException ex )\n        {\n            getLogger().warn( \"Unable to expand to file \" + f.getPath() );\n        }\n    }"
  },
  {
    "id": 38,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 0,
    "human_patch": "https://github.com/codehaus-plexus/plexus-archiver/commit/58bc24e465c0842981692adbf6d75680298989de",
    "cve_id": "CVE-2018-1002200",
    "cwe_id": "CWE-22",
    "filename": "src/test/java/org/codehaus/plexus/archiver/zip/ZipUnArchiverTest.java",
    "is_vulnerable": 0,
    "class_name": "ZipUnArchiverTest",
    "subclass_name": null,
    "function_name": "testExtractingZipPreservesExecutableFlag() throws Exception",
    "function_body": "{\n\n        String s = \"target/zip-unarchiver-tests\";\n        File testZip = new File( getBasedir(), \"src/test/jars/test.zip\" );\n        File outputDirectory = new File( getBasedir(), s );\n\n        FileUtils.deleteDirectory( outputDirectory );\n\n        ZipUnArchiver zu = getZipUnArchiver( testZip );\n        zu.extract( \"\", outputDirectory );\n        File testScript = new File( outputDirectory, \"test.sh\" );\n\n        final Method canExecute;\n        try\n        {\n            canExecute = File.class.getMethod( \"canExecute\" );\n            canExecute.invoke( testScript );\n            assertTrue( (Boolean) canExecute.invoke( testScript ) );\n        }\n        catch ( NoSuchMethodException ignore )\n        {\n        }\n    }"
  },
  {
    "id": 38,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 1,
    "human_patch": "https://github.com/codehaus-plexus/plexus-archiver/commit/58bc24e465c0842981692adbf6d75680298989de",
    "cve_id": "CVE-2018-1002200",
    "cwe_id": "CWE-22",
    "filename": "src/test/java/org/codehaus/plexus/archiver/zip/ZipUnArchiverTest.java",
    "is_vulnerable": 0,
    "class_name": "ZipUnArchiverTest",
    "subclass_name": null,
    "function_name": "testZeroFileModeInZip() throws Exception",
    "function_body": "{\n\n        String s = \"target/zip-unarchiver-filemode-tests\";\n        File testZip = new File( getBasedir(), \"src/test/resources/zeroFileMode/foobar.zip\" );\n        File outputDirectory = new File( getBasedir(), s );\n\n        FileUtils.deleteDirectory( outputDirectory );\n\n        ZipUnArchiver zu = getZipUnArchiver( testZip );\n        zu.setIgnorePermissions( false );\n        zu.extract( \"\", outputDirectory );\n\n        File testScript = new File( outputDirectory, \"foo.txt\" );\n\n        final Method canRead;\n        try\n        {\n            canRead = File.class.getMethod( \"canRead\" );\n            canRead.invoke( testScript );\n            assertTrue( (Boolean) canRead.invoke( testScript ) );\n        }\n        catch ( NoSuchMethodException ignore )\n        {\n        }\n    }"
  },
  {
    "id": 38,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 2,
    "human_patch": "https://github.com/codehaus-plexus/plexus-archiver/commit/58bc24e465c0842981692adbf6d75680298989de",
    "cve_id": "CVE-2018-1002200",
    "cwe_id": "CWE-22",
    "filename": "src/test/java/org/codehaus/plexus/archiver/zip/ZipUnArchiverTest.java",
    "is_vulnerable": 0,
    "class_name": "ZipUnArchiverTest",
    "subclass_name": null,
    "function_name": "testUnarchiveUtf8() throws Exception",
    "function_body": "{\n        File dest = new File( \"target/output/unzip/utf8\" );\n        dest.mkdirs();\n\n        final File zipFile = new File( \"target/output/unzip/utf8-default.zip\" );\n        final ZipArchiver zipArchiver = getZipArchiver( zipFile );\n        zipArchiver.addDirectory( new File( \"src/test/resources/miscUtf8\" ) );\n        zipArchiver.createArchive();\n        final ZipUnArchiver unarchiver = getZipUnArchiver( zipFile );\n        unarchiver.setDestFile( dest );\n        unarchiver.extract();\n        assertTrue( new File( dest, \"aPi\\u00F1ata.txt\" ).exists() );\n        assertTrue( new File( dest, \"an\\u00FCmlaut.txt\" ).exists() );\n        assertTrue( new File( dest, \"\\u20acuro.txt\" ).exists() );\n    }"
  },
  {
    "id": 38,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 3,
    "human_patch": "https://github.com/codehaus-plexus/plexus-archiver/commit/58bc24e465c0842981692adbf6d75680298989de",
    "cve_id": "CVE-2018-1002200",
    "cwe_id": "CWE-22",
    "filename": "src/test/java/org/codehaus/plexus/archiver/zip/ZipUnArchiverTest.java",
    "is_vulnerable": 0,
    "class_name": "ZipUnArchiverTest",
    "subclass_name": null,
    "function_name": "runUnarchiver( String path, FileSelector[] selectors, boolean[] results ) throws Exception",
    "function_body": "{\n        String s = \"target/zip-unarchiver-tests\";\n\n        File testJar = new File( getBasedir(), \"src/test/jars/test.jar\" );\n\n        File outputDirectory = new File( getBasedir(), s );\n\n        ZipUnArchiver zu = getZipUnArchiver( testJar );\n        zu.setFileSelectors( selectors );\n\n        FileUtils.deleteDirectory( outputDirectory );\n\n        zu.extract( path, outputDirectory );\n\n        File f0 = new File( getBasedir(), s + \"/resources/artifactId/test.properties\" );\n\n        assertEquals( results[0], f0.exists() );\n\n        File f1 = new File( getBasedir(), s + \"/resources/artifactId/directory/test.properties\" );\n\n        assertEquals( results[1], f1.exists() );\n\n        File f2 = new File( getBasedir(), s + \"/META-INF/MANIFEST.MF\" );\n\n        assertEquals( results[2], f2.exists() );\n    }"
  },
  {
    "id": 38,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 4,
    "human_patch": "https://github.com/codehaus-plexus/plexus-archiver/commit/58bc24e465c0842981692adbf6d75680298989de",
    "cve_id": "CVE-2018-1002200",
    "cwe_id": "CWE-22",
    "filename": "src/test/java/org/codehaus/plexus/archiver/zip/ZipUnArchiverTest.java",
    "is_vulnerable": 0,
    "class_name": "ZipUnArchiverTest",
    "subclass_name": null,
    "function_name": "getZipUnArchiver( File testJar ) throws Exception",
    "function_body": "{\n        ZipUnArchiver zu = (ZipUnArchiver) lookup( UnArchiver.ROLE, \"zip\" );\n        zu.setSourceFile( testJar );\n        return zu;\n    }"
  },
  {
    "id": 38,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 5,
    "human_patch": "https://github.com/codehaus-plexus/plexus-archiver/commit/58bc24e465c0842981692adbf6d75680298989de",
    "cve_id": "CVE-2018-1002200",
    "cwe_id": "CWE-22",
    "filename": "src/test/java/org/codehaus/plexus/archiver/zip/ZipUnArchiverTest.java",
    "is_vulnerable": 0,
    "class_name": "ZipUnArchiverTest",
    "subclass_name": null,
    "function_name": "testExtractingADirectoryFromAJarFile() throws Exception",
    "function_body": "{\n        runUnarchiver( \"resources/artifactId\", null,\n                       new boolean[]\n                       {\n                           true, true, false\n                       } );\n        runUnarchiver( \"\", null,\n                       new boolean[]\n                       {\n                           true, true, true\n                       } );\n    }"
  },
  {
    "id": 38,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 6,
    "human_patch": "https://github.com/codehaus-plexus/plexus-archiver/commit/58bc24e465c0842981692adbf6d75680298989de",
    "cve_id": "CVE-2018-1002200",
    "cwe_id": "CWE-22",
    "filename": "src/test/java/org/codehaus/plexus/archiver/zip/ZipUnArchiverTest.java",
    "is_vulnerable": 0,
    "class_name": "ZipUnArchiverTest",
    "subclass_name": null,
    "function_name": "testSelectors() throws Exception",
    "function_body": "{\n        IncludeExcludeFileSelector fileSelector = new IncludeExcludeFileSelector();\n        runUnarchiver( \"\", new FileSelector[]\n                   {\n                       fileSelector\n        },\n                       new boolean[]\n                       {\n                           true, true, true\n                       } );\n        fileSelector.setExcludes( new String[]\n        {\n            \"**/test.properties\"\n        } );\n        runUnarchiver( \"\", new FileSelector[]\n                   {\n                       fileSelector\n        },\n                       new boolean[]\n                       {\n                           false, false, true\n                       } );\n        fileSelector.setIncludes( new String[]\n        {\n            \"**/test.properties\"\n        } );\n        fileSelector.setExcludes( null );\n        runUnarchiver( \"\", new FileSelector[]\n                   {\n                       fileSelector\n        },\n                       new boolean[]\n                       {\n                           true, true, false\n                       } );\n        fileSelector.setExcludes( new String[]\n        {\n            \"resources/artifactId/directory/test.properties\"\n        } );\n        runUnarchiver( \"\", new FileSelector[]\n                   {\n                       fileSelector\n        },\n                       new boolean[]\n                       {\n                           true, false, false\n                       } );\n    }"
  },
  {
    "id": 38,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 7,
    "human_patch": "https://github.com/codehaus-plexus/plexus-archiver/commit/58bc24e465c0842981692adbf6d75680298989de",
    "cve_id": "CVE-2018-1002200",
    "cwe_id": "CWE-22",
    "filename": "src/test/java/org/codehaus/plexus/archiver/zip/ZipUnArchiverTest.java",
    "is_vulnerable": 0,
    "class_name": "ZipUnArchiverTest",
    "subclass_name": null,
    "function_name": "getZipArchiver()",
    "function_body": "{\n        try\n        {\n            return (ZipArchiver) lookup( Archiver.ROLE, \"zip\" );\n        }\n        catch ( Exception e )\n        {\n            throw new RuntimeException( e );\n        }\n    }"
  },
  {
    "id": 38,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 8,
    "human_patch": "https://github.com/codehaus-plexus/plexus-archiver/commit/58bc24e465c0842981692adbf6d75680298989de",
    "cve_id": "CVE-2018-1002200",
    "cwe_id": "CWE-22",
    "filename": "src/test/java/org/codehaus/plexus/archiver/zip/ZipUnArchiverTest.java",
    "is_vulnerable": 0,
    "class_name": "ZipUnArchiverTest",
    "subclass_name": null,
    "function_name": "getZipArchiver( File destFile )",
    "function_body": "{\n        final ZipArchiver zipArchiver = getZipArchiver();\n        zipArchiver.setDestFile( destFile );\n        return zipArchiver;\n    }"
  },
  {
    "id": 39,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 0,
    "human_patch": "https://github.com/codehaus-plexus/plexus-utils/commit/b38a1b3a4352303e4312b2bb601a0d7ec6e28f41",
    "cve_id": "CVE-2017-1000487",
    "cwe_id": "CWE-78",
    "filename": "src/main/java/org/codehaus/plexus/util/cli/Commandline.java",
    "is_vulnerable": 0,
    "class_name": "Commandline",
    "subclass_name": null,
    "function_name": "getPid()",
    "function_body": "{\n        if ( pid == -1 )\n        {\n            pid = Long.parseLong( String.valueOf( System.currentTimeMillis() ) );\n        }\n\n        return pid;\n    }"
  },
  {
    "id": 39,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 1,
    "human_patch": "https://github.com/codehaus-plexus/plexus-utils/commit/b38a1b3a4352303e4312b2bb601a0d7ec6e28f41",
    "cve_id": "CVE-2017-1000487",
    "cwe_id": "CWE-78",
    "filename": "src/main/java/org/codehaus/plexus/util/cli/Commandline.java",
    "is_vulnerable": 0,
    "class_name": "Commandline",
    "subclass_name": null,
    "function_name": "setPid( long pid )",
    "function_body": "{\n        this.pid = pid;\n    }"
  },
  {
    "id": 39,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 2,
    "human_patch": "https://github.com/codehaus-plexus/plexus-utils/commit/b38a1b3a4352303e4312b2bb601a0d7ec6e28f41",
    "cve_id": "CVE-2017-1000487",
    "cwe_id": "CWE-78",
    "filename": "src/main/java/org/codehaus/plexus/util/cli/Commandline.java",
    "is_vulnerable": 1,
    "class_name": "Commandline",
    "subclass_name": "Marker",
    "function_name": "getPosition()",
    "function_body": "{\n            if ( realPos == -1 )\n            {\n                realPos = ( getExecutable() == null ? 0 : 1 );\n                for ( int i = 0; i < position; i++ )\n                {\n                    Arg arg = (Arg) arguments.elementAt( i );\n                    realPos += arg.getParts().length;\n                }\n            }\n            return realPos;\n        }"
  },
  {
    "id": 39,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 3,
    "human_patch": "https://github.com/codehaus-plexus/plexus-utils/commit/b38a1b3a4352303e4312b2bb601a0d7ec6e28f41",
    "cve_id": "CVE-2017-1000487",
    "cwe_id": "CWE-78",
    "filename": "src/main/java/org/codehaus/plexus/util/cli/Commandline.java",
    "is_vulnerable": 0,
    "class_name": "Commandline",
    "subclass_name": null,
    "function_name": "setDefaultShell()",
    "function_body": "{\n        \n        if ( Os.isFamily( Os.FAMILY_WINDOWS ) )\n        {\n            if ( Os.isFamily( Os.FAMILY_WIN9X ) )\n            {\n                setShell( new CommandShell() );\n            }\n            else\n            {\n                setShell( new CmdShell() );\n            }\n        }\n        else\n        {\n            setShell( new BourneShell() );\n        }\n    }"
  },
  {
    "id": 39,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 4,
    "human_patch": "https://github.com/codehaus-plexus/plexus-utils/commit/b38a1b3a4352303e4312b2bb601a0d7ec6e28f41",
    "cve_id": "CVE-2017-1000487",
    "cwe_id": "CWE-78",
    "filename": "src/main/java/org/codehaus/plexus/util/cli/Commandline.java",
    "is_vulnerable": 0,
    "class_name": "Commandline",
    "subclass_name": null,
    "function_name": "createArgument()",
    "function_body": "{\n        return this.createArgument( false );\n    }"
  },
  {
    "id": 39,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 5,
    "human_patch": "https://github.com/codehaus-plexus/plexus-utils/commit/b38a1b3a4352303e4312b2bb601a0d7ec6e28f41",
    "cve_id": "CVE-2017-1000487",
    "cwe_id": "CWE-78",
    "filename": "src/main/java/org/codehaus/plexus/util/cli/Commandline.java",
    "is_vulnerable": 0,
    "class_name": "Commandline",
    "subclass_name": null,
    "function_name": "createArgument( boolean insertAtStart )",
    "function_body": "{\n        Argument argument = new Argument();\n        if ( insertAtStart )\n        {\n            arguments.insertElementAt( argument, 0 );\n        }\n        else\n        {\n            arguments.addElement( argument );\n        }\n        return argument;\n    }"
  },
  {
    "id": 39,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 6,
    "human_patch": "https://github.com/codehaus-plexus/plexus-utils/commit/b38a1b3a4352303e4312b2bb601a0d7ec6e28f41",
    "cve_id": "CVE-2017-1000487",
    "cwe_id": "CWE-78",
    "filename": "src/main/java/org/codehaus/plexus/util/cli/Commandline.java",
    "is_vulnerable": 0,
    "class_name": "Commandline",
    "subclass_name": null,
    "function_name": "createArg()",
    "function_body": "{\n        return this.createArg( false );\n    }"
  },
  {
    "id": 39,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 7,
    "human_patch": "https://github.com/codehaus-plexus/plexus-utils/commit/b38a1b3a4352303e4312b2bb601a0d7ec6e28f41",
    "cve_id": "CVE-2017-1000487",
    "cwe_id": "CWE-78",
    "filename": "src/main/java/org/codehaus/plexus/util/cli/Commandline.java",
    "is_vulnerable": 0,
    "class_name": "Commandline",
    "subclass_name": null,
    "function_name": "createArg( boolean insertAtStart )",
    "function_body": "{\n        Arg argument = new Argument();\n        if ( insertAtStart )\n        {\n            arguments.insertElementAt( argument, 0 );\n        }\n        else\n        {\n            arguments.addElement( argument );\n        }\n        return argument;\n    }"
  },
  {
    "id": 39,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 8,
    "human_patch": "https://github.com/codehaus-plexus/plexus-utils/commit/b38a1b3a4352303e4312b2bb601a0d7ec6e28f41",
    "cve_id": "CVE-2017-1000487",
    "cwe_id": "CWE-78",
    "filename": "src/main/java/org/codehaus/plexus/util/cli/Commandline.java",
    "is_vulnerable": 0,
    "class_name": "Commandline",
    "subclass_name": null,
    "function_name": "addArg( Arg argument )",
    "function_body": "{\n        this.addArg( argument, false );\n    }"
  },
  {
    "id": 39,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 9,
    "human_patch": "https://github.com/codehaus-plexus/plexus-utils/commit/b38a1b3a4352303e4312b2bb601a0d7ec6e28f41",
    "cve_id": "CVE-2017-1000487",
    "cwe_id": "CWE-78",
    "filename": "src/main/java/org/codehaus/plexus/util/cli/Commandline.java",
    "is_vulnerable": 0,
    "class_name": "Commandline",
    "subclass_name": null,
    "function_name": "addArg( Arg argument, boolean insertAtStart )",
    "function_body": "{\n        if ( insertAtStart )\n        {\n            arguments.insertElementAt( argument, 0 );\n        }\n        else\n        {\n            arguments.addElement( argument );\n        }\n    }"
  },
  {
    "id": 39,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 10,
    "human_patch": "https://github.com/codehaus-plexus/plexus-utils/commit/b38a1b3a4352303e4312b2bb601a0d7ec6e28f41",
    "cve_id": "CVE-2017-1000487",
    "cwe_id": "CWE-78",
    "filename": "src/main/java/org/codehaus/plexus/util/cli/Commandline.java",
    "is_vulnerable": 0,
    "class_name": "Commandline",
    "subclass_name": null,
    "function_name": "setExecutable( String executable )",
    "function_body": "{\n        shell.setExecutable( executable );\n        this.executable = executable;\n    }"
  },
  {
    "id": 39,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 11,
    "human_patch": "https://github.com/codehaus-plexus/plexus-utils/commit/b38a1b3a4352303e4312b2bb601a0d7ec6e28f41",
    "cve_id": "CVE-2017-1000487",
    "cwe_id": "CWE-78",
    "filename": "src/main/java/org/codehaus/plexus/util/cli/Commandline.java",
    "is_vulnerable": 0,
    "class_name": "Commandline",
    "subclass_name": null,
    "function_name": "getExecutable()",
    "function_body": "{\n        String exec = shell.getExecutable();\n\n        if ( exec == null )\n        {\n            exec = executable;\n        }\n\n        return exec;\n    }"
  },
  {
    "id": 39,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 12,
    "human_patch": "https://github.com/codehaus-plexus/plexus-utils/commit/b38a1b3a4352303e4312b2bb601a0d7ec6e28f41",
    "cve_id": "CVE-2017-1000487",
    "cwe_id": "CWE-78",
    "filename": "src/main/java/org/codehaus/plexus/util/cli/Commandline.java",
    "is_vulnerable": 0,
    "class_name": "Commandline",
    "subclass_name": null,
    "function_name": "addArguments( String[] line )",
    "function_body": "{\n        for ( int i = 0; i < line.length; i++ )\n        {\n            createArgument().setValue( line[i] );\n        }\n    }"
  },
  {
    "id": 39,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 13,
    "human_patch": "https://github.com/codehaus-plexus/plexus-utils/commit/b38a1b3a4352303e4312b2bb601a0d7ec6e28f41",
    "cve_id": "CVE-2017-1000487",
    "cwe_id": "CWE-78",
    "filename": "src/main/java/org/codehaus/plexus/util/cli/Commandline.java",
    "is_vulnerable": 0,
    "class_name": "Commandline",
    "subclass_name": null,
    "function_name": "addEnvironment( String name, String value )",
    "function_body": "{\n        \n        envVars.put( name, value );\n    }"
  },
  {
    "id": 39,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 14,
    "human_patch": "https://github.com/codehaus-plexus/plexus-utils/commit/b38a1b3a4352303e4312b2bb601a0d7ec6e28f41",
    "cve_id": "CVE-2017-1000487",
    "cwe_id": "CWE-78",
    "filename": "src/main/java/org/codehaus/plexus/util/cli/Commandline.java",
    "is_vulnerable": 0,
    "class_name": "Commandline",
    "subclass_name": null,
    "function_name": "addSystemEnvironment() throws Exception",
    "function_body": "{\n        Properties systemEnvVars = CommandLineUtils.getSystemEnvVars();\n\n        for ( Iterator i = systemEnvVars.keySet().iterator(); i.hasNext(); )\n        {\n            String key = (String) i.next();\n            if ( !envVars.containsKey( key ) )\n            {\n                addEnvironment( key, systemEnvVars.getProperty( key ) );\n            }\n        }\n    }"
  },
  {
    "id": 39,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 15,
    "human_patch": "https://github.com/codehaus-plexus/plexus-utils/commit/b38a1b3a4352303e4312b2bb601a0d7ec6e28f41",
    "cve_id": "CVE-2017-1000487",
    "cwe_id": "CWE-78",
    "filename": "src/main/java/org/codehaus/plexus/util/cli/Commandline.java",
    "is_vulnerable": 0,
    "class_name": "Commandline",
    "subclass_name": null,
    "function_name": "getEnvironmentVariables() throws CommandLineException",
    "function_body": "{\n        try\n        {\n            addSystemEnvironment();\n        }\n        catch ( Exception e )\n        {\n            throw new CommandLineException( \"Error setting up environmental variables\", e );\n        }\n        String[] environmentVars = new String[envVars.size()];\n        int i = 0;\n        for ( Iterator iterator = envVars.keySet().iterator(); iterator.hasNext(); )\n        {\n            String name = (String) iterator.next();\n            String value = (String) envVars.get( name );\n            environmentVars[i] = name + \"=\" + value;\n            i++;\n        }\n        return environmentVars;\n    }"
  },
  {
    "id": 39,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 16,
    "human_patch": "https://github.com/codehaus-plexus/plexus-utils/commit/b38a1b3a4352303e4312b2bb601a0d7ec6e28f41",
    "cve_id": "CVE-2017-1000487",
    "cwe_id": "CWE-78",
    "filename": "src/main/java/org/codehaus/plexus/util/cli/Commandline.java",
    "is_vulnerable": 1,
    "class_name": "Commandline",
    "subclass_name": null,
    "function_name": "getCommandline()",
    "function_body": "{\n        final String[] args = getArguments();\n        String executable = getExecutable();\n\n        if ( executable == null )\n        {\n            return args;\n        }\n        final String[] result = new String[args.length + 1];\n        result[0] = executable;\n        System.arraycopy( args, 0, result, 1, args.length );\n        return result;\n    }"
  },
  {
    "id": 39,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 17,
    "human_patch": "https://github.com/codehaus-plexus/plexus-utils/commit/b38a1b3a4352303e4312b2bb601a0d7ec6e28f41",
    "cve_id": "CVE-2017-1000487",
    "cwe_id": "CWE-78",
    "filename": "src/main/java/org/codehaus/plexus/util/cli/Commandline.java",
    "is_vulnerable": 0,
    "class_name": "Commandline",
    "subclass_name": null,
    "function_name": "getShellCommandline()",
    "function_body": "{\n        \n        verifyShellState();\n\n        return (String[]) getShell().getShellCommandLine( getArguments() ).toArray( new String[0] );\n    }"
  },
  {
    "id": 39,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 18,
    "human_patch": "https://github.com/codehaus-plexus/plexus-utils/commit/b38a1b3a4352303e4312b2bb601a0d7ec6e28f41",
    "cve_id": "CVE-2017-1000487",
    "cwe_id": "CWE-78",
    "filename": "src/main/java/org/codehaus/plexus/util/cli/Commandline.java",
    "is_vulnerable": 0,
    "class_name": "Commandline",
    "subclass_name": null,
    "function_name": "getArguments()",
    "function_body": "{\n        Vector result = new Vector( arguments.size() * 2 );\n        for ( int i = 0; i < arguments.size(); i++ )\n        {\n            Argument arg = (Argument) arguments.elementAt( i );\n            String[] s = arg.getParts();\n            if ( s != null )\n            {\n                for ( int j = 0; j < s.length; j++ )\n                {\n                    result.addElement( s[j] );\n                }\n            }\n        }\n\n        String[] res = new String[result.size()];\n        result.copyInto( res );\n        return res;\n    }"
  },
  {
    "id": 39,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 19,
    "human_patch": "https://github.com/codehaus-plexus/plexus-utils/commit/b38a1b3a4352303e4312b2bb601a0d7ec6e28f41",
    "cve_id": "CVE-2017-1000487",
    "cwe_id": "CWE-78",
    "filename": "src/main/java/org/codehaus/plexus/util/cli/Commandline.java",
    "is_vulnerable": 0,
    "class_name": "Commandline",
    "subclass_name": null,
    "function_name": "toString()",
    "function_body": "{\n        return StringUtils.join( getShellCommandline(), \" \" );\n    }"
  },
  {
    "id": 39,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 20,
    "human_patch": "https://github.com/codehaus-plexus/plexus-utils/commit/b38a1b3a4352303e4312b2bb601a0d7ec6e28f41",
    "cve_id": "CVE-2017-1000487",
    "cwe_id": "CWE-78",
    "filename": "src/main/java/org/codehaus/plexus/util/cli/Commandline.java",
    "is_vulnerable": 0,
    "class_name": "Commandline",
    "subclass_name": null,
    "function_name": "size()",
    "function_body": "{\n        return getCommandline().length;\n    }"
  },
  {
    "id": 39,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 21,
    "human_patch": "https://github.com/codehaus-plexus/plexus-utils/commit/b38a1b3a4352303e4312b2bb601a0d7ec6e28f41",
    "cve_id": "CVE-2017-1000487",
    "cwe_id": "CWE-78",
    "filename": "src/main/java/org/codehaus/plexus/util/cli/Commandline.java",
    "is_vulnerable": 0,
    "class_name": "Commandline",
    "subclass_name": null,
    "function_name": "clone()",
    "function_body": "{\n        Commandline c = new Commandline( (Shell) shell.clone() );\n        c.executable = executable;\n        c.workingDir = workingDir;\n        c.addArguments( getArguments() );\n        return c;\n    }"
  },
  {
    "id": 39,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 22,
    "human_patch": "https://github.com/codehaus-plexus/plexus-utils/commit/b38a1b3a4352303e4312b2bb601a0d7ec6e28f41",
    "cve_id": "CVE-2017-1000487",
    "cwe_id": "CWE-78",
    "filename": "src/main/java/org/codehaus/plexus/util/cli/Commandline.java",
    "is_vulnerable": 0,
    "class_name": "Commandline",
    "subclass_name": null,
    "function_name": "clear()",
    "function_body": "{\n        executable = null;\n        workingDir = null;\n        shell.setExecutable( null );\n        shell.clearArguments();\n        arguments.removeAllElements();\n    }"
  },
  {
    "id": 39,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 23,
    "human_patch": "https://github.com/codehaus-plexus/plexus-utils/commit/b38a1b3a4352303e4312b2bb601a0d7ec6e28f41",
    "cve_id": "CVE-2017-1000487",
    "cwe_id": "CWE-78",
    "filename": "src/main/java/org/codehaus/plexus/util/cli/Commandline.java",
    "is_vulnerable": 0,
    "class_name": "Commandline",
    "subclass_name": null,
    "function_name": "clearArgs()",
    "function_body": "{\n        arguments.removeAllElements();\n    }"
  },
  {
    "id": 39,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 24,
    "human_patch": "https://github.com/codehaus-plexus/plexus-utils/commit/b38a1b3a4352303e4312b2bb601a0d7ec6e28f41",
    "cve_id": "CVE-2017-1000487",
    "cwe_id": "CWE-78",
    "filename": "src/main/java/org/codehaus/plexus/util/cli/Commandline.java",
    "is_vulnerable": 0,
    "class_name": "Commandline",
    "subclass_name": null,
    "function_name": "createMarker()",
    "function_body": "{\n        return new Marker( arguments.size() );\n    }"
  },
  {
    "id": 39,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 25,
    "human_patch": "https://github.com/codehaus-plexus/plexus-utils/commit/b38a1b3a4352303e4312b2bb601a0d7ec6e28f41",
    "cve_id": "CVE-2017-1000487",
    "cwe_id": "CWE-78",
    "filename": "src/main/java/org/codehaus/plexus/util/cli/Commandline.java",
    "is_vulnerable": 0,
    "class_name": "Commandline",
    "subclass_name": null,
    "function_name": "setWorkingDirectory( String path )",
    "function_body": "{\n        shell.setWorkingDirectory( path );\n        workingDir = new File( path );\n    }"
  },
  {
    "id": 39,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 26,
    "human_patch": "https://github.com/codehaus-plexus/plexus-utils/commit/b38a1b3a4352303e4312b2bb601a0d7ec6e28f41",
    "cve_id": "CVE-2017-1000487",
    "cwe_id": "CWE-78",
    "filename": "src/main/java/org/codehaus/plexus/util/cli/Commandline.java",
    "is_vulnerable": 0,
    "class_name": "Commandline",
    "subclass_name": null,
    "function_name": "setWorkingDirectory( File workingDirectory )",
    "function_body": "{\n        shell.setWorkingDirectory( workingDirectory );\n        workingDir = workingDirectory;\n    }"
  },
  {
    "id": 39,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 27,
    "human_patch": "https://github.com/codehaus-plexus/plexus-utils/commit/b38a1b3a4352303e4312b2bb601a0d7ec6e28f41",
    "cve_id": "CVE-2017-1000487",
    "cwe_id": "CWE-78",
    "filename": "src/main/java/org/codehaus/plexus/util/cli/Commandline.java",
    "is_vulnerable": 0,
    "class_name": "Commandline",
    "subclass_name": null,
    "function_name": "getWorkingDirectory()",
    "function_body": "{\n        File workDir = shell.getWorkingDirectory();\n\n        if ( workDir == null )\n        {\n            workDir = workingDir;\n        }\n\n        return workDir;\n    }"
  },
  {
    "id": 39,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 28,
    "human_patch": "https://github.com/codehaus-plexus/plexus-utils/commit/b38a1b3a4352303e4312b2bb601a0d7ec6e28f41",
    "cve_id": "CVE-2017-1000487",
    "cwe_id": "CWE-78",
    "filename": "src/main/java/org/codehaus/plexus/util/cli/Commandline.java",
    "is_vulnerable": 1,
    "class_name": "Commandline",
    "subclass_name": null,
    "function_name": "execute() throws CommandLineException",
    "function_body": "{\n        \n        verifyShellState();\n\n        Process process;\n\n        \n\n        String[] environment = getEnvironmentVariables();\n\n        File workingDir = shell.getWorkingDirectory();\n\n        try\n        {\n            if ( workingDir == null )\n            {\n                process = Runtime.getRuntime().exec( getShellCommandline(), environment );\n            }\n            else\n            {\n                if ( !workingDir.exists() )\n                {\n                    throw new CommandLineException( \"Working directory \\\"\" + workingDir.getPath()\n                        + \"\\\" does not exist!\" );\n                }\n                else if ( !workingDir.isDirectory() )\n                {\n                    throw new CommandLineException( \"Path \\\"\" + workingDir.getPath()\n                        + \"\\\" does not specify a directory.\" );\n                }\n\n                process = Runtime.getRuntime().exec( getShellCommandline(), environment, workingDir );\n            }\n        }\n        catch ( IOException ex )\n        {\n            throw new CommandLineException( \"Error while executing process.\", ex );\n        }\n\n        return process;\n    }"
  },
  {
    "id": 39,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 29,
    "human_patch": "https://github.com/codehaus-plexus/plexus-utils/commit/b38a1b3a4352303e4312b2bb601a0d7ec6e28f41",
    "cve_id": "CVE-2017-1000487",
    "cwe_id": "CWE-78",
    "filename": "src/main/java/org/codehaus/plexus/util/cli/Commandline.java",
    "is_vulnerable": 1,
    "class_name": "Commandline",
    "subclass_name": null,
    "function_name": "verifyShellState()",
    "function_body": "{\n        if ( shell.getWorkingDirectory() == null )\n        {\n            shell.setWorkingDirectory( workingDir );\n        }\n\n        if ( shell.getExecutable() == null )\n        {\n            shell.setExecutable( executable );\n        }\n    }"
  },
  {
    "id": 39,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 30,
    "human_patch": "https://github.com/codehaus-plexus/plexus-utils/commit/b38a1b3a4352303e4312b2bb601a0d7ec6e28f41",
    "cve_id": "CVE-2017-1000487",
    "cwe_id": "CWE-78",
    "filename": "src/main/java/org/codehaus/plexus/util/cli/Commandline.java",
    "is_vulnerable": 0,
    "class_name": "Commandline",
    "subclass_name": null,
    "function_name": "getSystemEnvVars() throws Exception",
    "function_body": "{\n        return CommandLineUtils.getSystemEnvVars();\n    }"
  },
  {
    "id": 39,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 31,
    "human_patch": "https://github.com/codehaus-plexus/plexus-utils/commit/b38a1b3a4352303e4312b2bb601a0d7ec6e28f41",
    "cve_id": "CVE-2017-1000487",
    "cwe_id": "CWE-78",
    "filename": "src/main/java/org/codehaus/plexus/util/cli/Commandline.java",
    "is_vulnerable": 0,
    "class_name": "Commandline",
    "subclass_name": null,
    "function_name": "setShell( Shell shell )",
    "function_body": "{\n        this.shell = shell;\n    }"
  },
  {
    "id": 39,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 32,
    "human_patch": "https://github.com/codehaus-plexus/plexus-utils/commit/b38a1b3a4352303e4312b2bb601a0d7ec6e28f41",
    "cve_id": "CVE-2017-1000487",
    "cwe_id": "CWE-78",
    "filename": "src/main/java/org/codehaus/plexus/util/cli/Commandline.java",
    "is_vulnerable": 0,
    "class_name": "Commandline",
    "subclass_name": null,
    "function_name": "getShell()",
    "function_body": "{\n        return shell;\n    }"
  },
  {
    "id": 39,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 33,
    "human_patch": "https://github.com/codehaus-plexus/plexus-utils/commit/b38a1b3a4352303e4312b2bb601a0d7ec6e28f41",
    "cve_id": "CVE-2017-1000487",
    "cwe_id": "CWE-78",
    "filename": "src/main/java/org/codehaus/plexus/util/cli/Commandline.java",
    "is_vulnerable": 0,
    "class_name": "Commandline",
    "subclass_name": null,
    "function_name": "translateCommandline( String toProcess ) throws Exception",
    "function_body": "{\n        return CommandLineUtils.translateCommandline( toProcess );\n    }"
  },
  {
    "id": 39,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 34,
    "human_patch": "https://github.com/codehaus-plexus/plexus-utils/commit/b38a1b3a4352303e4312b2bb601a0d7ec6e28f41",
    "cve_id": "CVE-2017-1000487",
    "cwe_id": "CWE-78",
    "filename": "src/main/java/org/codehaus/plexus/util/cli/Commandline.java",
    "is_vulnerable": 0,
    "class_name": "Commandline",
    "subclass_name": null,
    "function_name": "quoteArgument( String argument ) throws CommandLineException",
    "function_body": "{\n        return CommandLineUtils.quote( argument );\n    }"
  },
  {
    "id": 39,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 35,
    "human_patch": "https://github.com/codehaus-plexus/plexus-utils/commit/b38a1b3a4352303e4312b2bb601a0d7ec6e28f41",
    "cve_id": "CVE-2017-1000487",
    "cwe_id": "CWE-78",
    "filename": "src/main/java/org/codehaus/plexus/util/cli/Commandline.java",
    "is_vulnerable": 0,
    "class_name": "Commandline",
    "subclass_name": null,
    "function_name": "toString( String[] line )",
    "function_body": "{\n        return CommandLineUtils.toString( line );\n    }"
  },
  {
    "id": 39,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 36,
    "human_patch": "https://github.com/codehaus-plexus/plexus-utils/commit/b38a1b3a4352303e4312b2bb601a0d7ec6e28f41",
    "cve_id": "CVE-2017-1000487",
    "cwe_id": "CWE-78",
    "filename": "src/main/java/org/codehaus/plexus/util/cli/Commandline.java",
    "is_vulnerable": 0,
    "class_name": "Commandline",
    "subclass_name": "Argument",
    "function_name": "setValue( String value )",
    "function_body": "{\n            if ( value != null )\n            {\n                parts = new String[] { value };\n            }\n        }"
  },
  {
    "id": 39,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 37,
    "human_patch": "https://github.com/codehaus-plexus/plexus-utils/commit/b38a1b3a4352303e4312b2bb601a0d7ec6e28f41",
    "cve_id": "CVE-2017-1000487",
    "cwe_id": "CWE-78",
    "filename": "src/main/java/org/codehaus/plexus/util/cli/Commandline.java",
    "is_vulnerable": 0,
    "class_name": "Commandline",
    "subclass_name": "Argument",
    "function_name": "setLine( String line )",
    "function_body": "{\n            if ( line == null )\n            {\n                return;\n            }\n            try\n            {\n                parts = CommandLineUtils.translateCommandline( line );\n            }\n            catch ( Exception e )\n            {\n                System.err.println( \"Error translating Commandline.\" );\n            }\n        }"
  },
  {
    "id": 39,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 38,
    "human_patch": "https://github.com/codehaus-plexus/plexus-utils/commit/b38a1b3a4352303e4312b2bb601a0d7ec6e28f41",
    "cve_id": "CVE-2017-1000487",
    "cwe_id": "CWE-78",
    "filename": "src/main/java/org/codehaus/plexus/util/cli/Commandline.java",
    "is_vulnerable": 0,
    "class_name": "Commandline",
    "subclass_name": "Argument",
    "function_name": "setFile( File value )",
    "function_body": "{\n            parts = new String[] { value.getAbsolutePath() };\n        }"
  },
  {
    "id": 39,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 39,
    "human_patch": "https://github.com/codehaus-plexus/plexus-utils/commit/b38a1b3a4352303e4312b2bb601a0d7ec6e28f41",
    "cve_id": "CVE-2017-1000487",
    "cwe_id": "CWE-78",
    "filename": "src/main/java/org/codehaus/plexus/util/cli/Commandline.java",
    "is_vulnerable": 0,
    "class_name": "Commandline",
    "subclass_name": "Argument",
    "function_name": "getParts()",
    "function_body": "{\n            return parts;\n        }"
  },
  {
    "id": 39,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 0,
    "human_patch": "https://github.com/codehaus-plexus/plexus-utils/commit/b38a1b3a4352303e4312b2bb601a0d7ec6e28f41",
    "cve_id": "CVE-2017-1000487",
    "cwe_id": "CWE-78",
    "filename": "src/main/java/org/codehaus/plexus/util/cli/shell/BourneShell.java",
    "is_vulnerable": 1,
    "class_name": "BourneShell",
    "subclass_name": null,
    "function_name": "getExecutable()",
    "function_body": "{\n        if ( Os.isFamily( Os.FAMILY_WINDOWS ) )\n        {\n            return super.getExecutable();\n        }\n\n        return unifyQuotes( super.getExecutable());\n    }"
  },
  {
    "id": 39,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 1,
    "human_patch": "https://github.com/codehaus-plexus/plexus-utils/commit/b38a1b3a4352303e4312b2bb601a0d7ec6e28f41",
    "cve_id": "CVE-2017-1000487",
    "cwe_id": "CWE-78",
    "filename": "src/main/java/org/codehaus/plexus/util/cli/shell/BourneShell.java",
    "is_vulnerable": 0,
    "class_name": "BourneShell",
    "subclass_name": null,
    "function_name": "getShellArgsList()",
    "function_body": "{\n        List<String> shellArgs = new ArrayList<String>();\n        List<String> existingShellArgs = super.getShellArgsList();\n\n        if ( ( existingShellArgs != null ) && !existingShellArgs.isEmpty() )\n        {\n            shellArgs.addAll( existingShellArgs );\n        }\n\n        shellArgs.add( \"-c\" );\n\n        return shellArgs;\n    }"
  },
  {
    "id": 39,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 2,
    "human_patch": "https://github.com/codehaus-plexus/plexus-utils/commit/b38a1b3a4352303e4312b2bb601a0d7ec6e28f41",
    "cve_id": "CVE-2017-1000487",
    "cwe_id": "CWE-78",
    "filename": "src/main/java/org/codehaus/plexus/util/cli/shell/BourneShell.java",
    "is_vulnerable": 0,
    "class_name": "BourneShell",
    "subclass_name": null,
    "function_name": "getShellArgs()",
    "function_body": "{\n        String[] shellArgs = super.getShellArgs();\n        if ( shellArgs == null )\n        {\n            shellArgs = new String[0];\n        }\n\n        if ( ( shellArgs.length > 0 ) && !shellArgs[shellArgs.length - 1].equals( \"-c\" ) )\n        {\n            String[] newArgs = new String[shellArgs.length + 1];\n\n            System.arraycopy( shellArgs, 0, newArgs, 0, shellArgs.length );\n            newArgs[shellArgs.length] = \"-c\";\n\n            shellArgs = newArgs;\n        }\n\n        return shellArgs;\n    }"
  },
  {
    "id": 39,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 3,
    "human_patch": "https://github.com/codehaus-plexus/plexus-utils/commit/b38a1b3a4352303e4312b2bb601a0d7ec6e28f41",
    "cve_id": "CVE-2017-1000487",
    "cwe_id": "CWE-78",
    "filename": "src/main/java/org/codehaus/plexus/util/cli/shell/BourneShell.java",
    "is_vulnerable": 1,
    "class_name": "BourneShell",
    "subclass_name": null,
    "function_name": "getExecutionPreamble()",
    "function_body": "{\n        if ( getWorkingDirectoryAsString() == null )\n        {\n            return null;\n        }\n\n        String dir = getWorkingDirectoryAsString();\n        StringBuilder sb = new StringBuilder();\n        sb.append( \"cd \" );\n\n        sb.append( unifyQuotes( dir ) );\n        sb.append( \" && \" );\n\n        return sb.toString();\n    }"
  },
  {
    "id": 39,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 4,
    "human_patch": "https://github.com/codehaus-plexus/plexus-utils/commit/b38a1b3a4352303e4312b2bb601a0d7ec6e28f41",
    "cve_id": "CVE-2017-1000487",
    "cwe_id": "CWE-78",
    "filename": "src/main/java/org/codehaus/plexus/util/cli/shell/BourneShell.java",
    "is_vulnerable": 0,
    "class_name": "BourneShell",
    "subclass_name": null,
    "function_name": "getQuotingTriggerChars()",
    "function_body": "{\n        return BASH_QUOTING_TRIGGER_CHARS;\n    }"
  },
  {
    "id": 39,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 5,
    "human_patch": "https://github.com/codehaus-plexus/plexus-utils/commit/b38a1b3a4352303e4312b2bb601a0d7ec6e28f41",
    "cve_id": "CVE-2017-1000487",
    "cwe_id": "CWE-78",
    "filename": "src/main/java/org/codehaus/plexus/util/cli/shell/BourneShell.java",
    "is_vulnerable": 0,
    "class_name": "BourneShell",
    "subclass_name": null,
    "function_name": "unifyQuotes( String path )",
    "function_body": "{\n        if ( path == null )\n        {\n            return null;\n        }\n\n        if ( path.indexOf( \" \" ) == -1 && path.indexOf( \"'\" ) != -1 && path.indexOf( \"\\\"\" ) == -1 )\n        {\n            return StringUtils.escape( path );\n        }\n\n        return StringUtils.quoteAndEscape( path, '\\\"', BASH_QUOTING_TRIGGER_CHARS );\n    }"
  },
  {
    "id": 39,
    "sub_id": 2,
    "code_id": 0,
    "function_id": 0,
    "human_patch": "https://github.com/codehaus-plexus/plexus-utils/commit/b38a1b3a4352303e4312b2bb601a0d7ec6e28f41",
    "cve_id": "CVE-2017-1000487",
    "cwe_id": "CWE-78",
    "filename": "src/main/java/org/codehaus/plexus/util/cli/shell/Shell.java",
    "is_vulnerable": 0,
    "class_name": "Shell",
    "subclass_name": null,
    "function_name": "setShellCommand( String shellCommand )",
    "function_body": "{\n        this.shellCommand = shellCommand;\n    }"
  },
  {
    "id": 39,
    "sub_id": 2,
    "code_id": 0,
    "function_id": 1,
    "human_patch": "https://github.com/codehaus-plexus/plexus-utils/commit/b38a1b3a4352303e4312b2bb601a0d7ec6e28f41",
    "cve_id": "CVE-2017-1000487",
    "cwe_id": "CWE-78",
    "filename": "src/main/java/org/codehaus/plexus/util/cli/shell/Shell.java",
    "is_vulnerable": 0,
    "class_name": "Shell",
    "subclass_name": null,
    "function_name": "getShellCommand()",
    "function_body": "{\n        return shellCommand;\n    }"
  },
  {
    "id": 39,
    "sub_id": 2,
    "code_id": 0,
    "function_id": 2,
    "human_patch": "https://github.com/codehaus-plexus/plexus-utils/commit/b38a1b3a4352303e4312b2bb601a0d7ec6e28f41",
    "cve_id": "CVE-2017-1000487",
    "cwe_id": "CWE-78",
    "filename": "src/main/java/org/codehaus/plexus/util/cli/shell/Shell.java",
    "is_vulnerable": 0,
    "class_name": "Shell",
    "subclass_name": null,
    "function_name": "setShellArgs( String[] shellArgs )",
    "function_body": "{\n        this.shellArgs.clear();\n        this.shellArgs.addAll( Arrays.asList( shellArgs ) );\n    }"
  },
  {
    "id": 39,
    "sub_id": 2,
    "code_id": 0,
    "function_id": 3,
    "human_patch": "https://github.com/codehaus-plexus/plexus-utils/commit/b38a1b3a4352303e4312b2bb601a0d7ec6e28f41",
    "cve_id": "CVE-2017-1000487",
    "cwe_id": "CWE-78",
    "filename": "src/main/java/org/codehaus/plexus/util/cli/shell/Shell.java",
    "is_vulnerable": 0,
    "class_name": "Shell",
    "subclass_name": null,
    "function_name": "getShellArgs()",
    "function_body": "{\n        if ( ( shellArgs == null ) || shellArgs.isEmpty() )\n        {\n            return null;\n        }\n        else\n        {\n            return (String[]) shellArgs.toArray( new String[shellArgs.size()] );\n        }\n    }"
  },
  {
    "id": 39,
    "sub_id": 2,
    "code_id": 0,
    "function_id": 4,
    "human_patch": "https://github.com/codehaus-plexus/plexus-utils/commit/b38a1b3a4352303e4312b2bb601a0d7ec6e28f41",
    "cve_id": "CVE-2017-1000487",
    "cwe_id": "CWE-78",
    "filename": "src/main/java/org/codehaus/plexus/util/cli/shell/Shell.java",
    "is_vulnerable": 0,
    "class_name": "Shell",
    "subclass_name": null,
    "function_name": "getCommandLine( String executable, String[] arguments )",
    "function_body": "{\n        return getRawCommandLine( executable, arguments );\n    }"
  },
  {
    "id": 39,
    "sub_id": 2,
    "code_id": 0,
    "function_id": 5,
    "human_patch": "https://github.com/codehaus-plexus/plexus-utils/commit/b38a1b3a4352303e4312b2bb601a0d7ec6e28f41",
    "cve_id": "CVE-2017-1000487",
    "cwe_id": "CWE-78",
    "filename": "src/main/java/org/codehaus/plexus/util/cli/shell/Shell.java",
    "is_vulnerable": 1,
    "class_name": "Shell",
    "subclass_name": null,
    "function_name": "getRawCommandLine( String executable, String[] arguments )",
    "function_body": "{\n        List<String> commandLine = new ArrayList<String>();\n        StringBuilder sb = new StringBuilder();\n\n        if ( executable != null )\n        {\n            String preamble = getExecutionPreamble();\n            if ( preamble != null )\n            {\n                sb.append( preamble );\n            }\n\n            if ( isQuotedExecutableEnabled() )\n            {\n                char[] escapeChars = getEscapeChars( isSingleQuotedExecutableEscaped(), isDoubleQuotedExecutableEscaped() );\n\n                sb.append( StringUtils.quoteAndEscape( getExecutable(), getExecutableQuoteDelimiter(), escapeChars, getQuotingTriggerChars(), '\\\\', false ) );\n            }\n            else\n            {\n                sb.append( getExecutable() );\n            }\n        }\n        for ( int i = 0; i < arguments.length; i++ )\n        {\n            if ( sb.length() > 0 )\n            {\n                sb.append( \" \" );\n            }\n\n            if ( isQuotedArgumentsEnabled() )\n            {\n                char[] escapeChars = getEscapeChars( isSingleQuotedArgumentEscaped(), isDoubleQuotedArgumentEscaped() );\n\n                sb.append( StringUtils.quoteAndEscape( arguments[i], getArgumentQuoteDelimiter(), escapeChars, getQuotingTriggerChars(), getArgumentEscapePattern(), false ) );\n            }\n            else\n            {\n                sb.append( arguments[i] );\n            }\n        }\n\n        commandLine.add( sb.toString() );\n\n        return commandLine;\n    }"
  },
  {
    "id": 39,
    "sub_id": 2,
    "code_id": 0,
    "function_id": 6,
    "human_patch": "https://github.com/codehaus-plexus/plexus-utils/commit/b38a1b3a4352303e4312b2bb601a0d7ec6e28f41",
    "cve_id": "CVE-2017-1000487",
    "cwe_id": "CWE-78",
    "filename": "src/main/java/org/codehaus/plexus/util/cli/shell/Shell.java",
    "is_vulnerable": 0,
    "class_name": "Shell",
    "subclass_name": null,
    "function_name": "getQuotingTriggerChars()",
    "function_body": "{\n        return DEFAULT_QUOTING_TRIGGER_CHARS;\n    }"
  },
  {
    "id": 39,
    "sub_id": 2,
    "code_id": 0,
    "function_id": 7,
    "human_patch": "https://github.com/codehaus-plexus/plexus-utils/commit/b38a1b3a4352303e4312b2bb601a0d7ec6e28f41",
    "cve_id": "CVE-2017-1000487",
    "cwe_id": "CWE-78",
    "filename": "src/main/java/org/codehaus/plexus/util/cli/shell/Shell.java",
    "is_vulnerable": 0,
    "class_name": "Shell",
    "subclass_name": null,
    "function_name": "getExecutionPreamble()",
    "function_body": "{\n        return null;\n    }"
  },
  {
    "id": 39,
    "sub_id": 2,
    "code_id": 0,
    "function_id": 8,
    "human_patch": "https://github.com/codehaus-plexus/plexus-utils/commit/b38a1b3a4352303e4312b2bb601a0d7ec6e28f41",
    "cve_id": "CVE-2017-1000487",
    "cwe_id": "CWE-78",
    "filename": "src/main/java/org/codehaus/plexus/util/cli/shell/Shell.java",
    "is_vulnerable": 0,
    "class_name": "Shell",
    "subclass_name": null,
    "function_name": "getEscapeChars( boolean includeSingleQuote, boolean includeDoubleQuote )",
    "function_body": "{\n        StringBuilder buf = new StringBuilder( 2 );\n        if ( includeSingleQuote )\n        {\n            buf.append( '\\'' );\n        }\n\n        if ( includeDoubleQuote )\n        {\n            buf.append( '\\\"' );\n        }\n\n        char[] result = new char[buf.length()];\n        buf.getChars( 0, buf.length(), result, 0 );\n\n        return result;\n    }"
  },
  {
    "id": 39,
    "sub_id": 2,
    "code_id": 0,
    "function_id": 9,
    "human_patch": "https://github.com/codehaus-plexus/plexus-utils/commit/b38a1b3a4352303e4312b2bb601a0d7ec6e28f41",
    "cve_id": "CVE-2017-1000487",
    "cwe_id": "CWE-78",
    "filename": "src/main/java/org/codehaus/plexus/util/cli/shell/Shell.java",
    "is_vulnerable": 0,
    "class_name": "Shell",
    "subclass_name": null,
    "function_name": "isDoubleQuotedArgumentEscaped()",
    "function_body": "{\n        return doubleQuotedArgumentEscaped;\n    }"
  },
  {
    "id": 39,
    "sub_id": 2,
    "code_id": 0,
    "function_id": 10,
    "human_patch": "https://github.com/codehaus-plexus/plexus-utils/commit/b38a1b3a4352303e4312b2bb601a0d7ec6e28f41",
    "cve_id": "CVE-2017-1000487",
    "cwe_id": "CWE-78",
    "filename": "src/main/java/org/codehaus/plexus/util/cli/shell/Shell.java",
    "is_vulnerable": 0,
    "class_name": "Shell",
    "subclass_name": null,
    "function_name": "isSingleQuotedArgumentEscaped()",
    "function_body": "{\n        return singleQuotedArgumentEscaped;\n    }"
  },
  {
    "id": 39,
    "sub_id": 2,
    "code_id": 0,
    "function_id": 11,
    "human_patch": "https://github.com/codehaus-plexus/plexus-utils/commit/b38a1b3a4352303e4312b2bb601a0d7ec6e28f41",
    "cve_id": "CVE-2017-1000487",
    "cwe_id": "CWE-78",
    "filename": "src/main/java/org/codehaus/plexus/util/cli/shell/Shell.java",
    "is_vulnerable": 0,
    "class_name": "Shell",
    "subclass_name": null,
    "function_name": "isDoubleQuotedExecutableEscaped()",
    "function_body": "{\n        return doubleQuotedExecutableEscaped;\n    }"
  },
  {
    "id": 39,
    "sub_id": 2,
    "code_id": 0,
    "function_id": 12,
    "human_patch": "https://github.com/codehaus-plexus/plexus-utils/commit/b38a1b3a4352303e4312b2bb601a0d7ec6e28f41",
    "cve_id": "CVE-2017-1000487",
    "cwe_id": "CWE-78",
    "filename": "src/main/java/org/codehaus/plexus/util/cli/shell/Shell.java",
    "is_vulnerable": 0,
    "class_name": "Shell",
    "subclass_name": null,
    "function_name": "isSingleQuotedExecutableEscaped()",
    "function_body": "{\n        return singleQuotedExecutableEscaped;\n    }"
  },
  {
    "id": 39,
    "sub_id": 2,
    "code_id": 0,
    "function_id": 13,
    "human_patch": "https://github.com/codehaus-plexus/plexus-utils/commit/b38a1b3a4352303e4312b2bb601a0d7ec6e28f41",
    "cve_id": "CVE-2017-1000487",
    "cwe_id": "CWE-78",
    "filename": "src/main/java/org/codehaus/plexus/util/cli/shell/Shell.java",
    "is_vulnerable": 0,
    "class_name": "Shell",
    "subclass_name": null,
    "function_name": "setArgumentQuoteDelimiter( char argQuoteDelimiter )",
    "function_body": "{\n        this.argQuoteDelimiter = argQuoteDelimiter;\n    }"
  },
  {
    "id": 39,
    "sub_id": 2,
    "code_id": 0,
    "function_id": 14,
    "human_patch": "https://github.com/codehaus-plexus/plexus-utils/commit/b38a1b3a4352303e4312b2bb601a0d7ec6e28f41",
    "cve_id": "CVE-2017-1000487",
    "cwe_id": "CWE-78",
    "filename": "src/main/java/org/codehaus/plexus/util/cli/shell/Shell.java",
    "is_vulnerable": 0,
    "class_name": "Shell",
    "subclass_name": null,
    "function_name": "getArgumentQuoteDelimiter()",
    "function_body": "{\n        return argQuoteDelimiter;\n    }"
  },
  {
    "id": 39,
    "sub_id": 2,
    "code_id": 0,
    "function_id": 15,
    "human_patch": "https://github.com/codehaus-plexus/plexus-utils/commit/b38a1b3a4352303e4312b2bb601a0d7ec6e28f41",
    "cve_id": "CVE-2017-1000487",
    "cwe_id": "CWE-78",
    "filename": "src/main/java/org/codehaus/plexus/util/cli/shell/Shell.java",
    "is_vulnerable": 0,
    "class_name": "Shell",
    "subclass_name": null,
    "function_name": "setExecutableQuoteDelimiter( char exeQuoteDelimiter )",
    "function_body": "{\n        this.exeQuoteDelimiter = exeQuoteDelimiter;\n    }"
  },
  {
    "id": 39,
    "sub_id": 2,
    "code_id": 0,
    "function_id": 16,
    "human_patch": "https://github.com/codehaus-plexus/plexus-utils/commit/b38a1b3a4352303e4312b2bb601a0d7ec6e28f41",
    "cve_id": "CVE-2017-1000487",
    "cwe_id": "CWE-78",
    "filename": "src/main/java/org/codehaus/plexus/util/cli/shell/Shell.java",
    "is_vulnerable": 0,
    "class_name": "Shell",
    "subclass_name": null,
    "function_name": "getExecutableQuoteDelimiter()",
    "function_body": "{\n        return exeQuoteDelimiter;\n    }"
  },
  {
    "id": 39,
    "sub_id": 2,
    "code_id": 0,
    "function_id": 17,
    "human_patch": "https://github.com/codehaus-plexus/plexus-utils/commit/b38a1b3a4352303e4312b2bb601a0d7ec6e28f41",
    "cve_id": "CVE-2017-1000487",
    "cwe_id": "CWE-78",
    "filename": "src/main/java/org/codehaus/plexus/util/cli/shell/Shell.java",
    "is_vulnerable": 0,
    "class_name": "Shell",
    "subclass_name": null,
    "function_name": "setArgumentEscapePattern(String argumentEscapePattern)",
    "function_body": "{\n        this.argumentEscapePattern = argumentEscapePattern;\n    }"
  },
  {
    "id": 39,
    "sub_id": 2,
    "code_id": 0,
    "function_id": 18,
    "human_patch": "https://github.com/codehaus-plexus/plexus-utils/commit/b38a1b3a4352303e4312b2bb601a0d7ec6e28f41",
    "cve_id": "CVE-2017-1000487",
    "cwe_id": "CWE-78",
    "filename": "src/main/java/org/codehaus/plexus/util/cli/shell/Shell.java",
    "is_vulnerable": 0,
    "class_name": "Shell",
    "subclass_name": null,
    "function_name": "getArgumentEscapePattern()",
    "function_body": "{\n        return argumentEscapePattern;\n    }"
  },
  {
    "id": 39,
    "sub_id": 2,
    "code_id": 0,
    "function_id": 19,
    "human_patch": "https://github.com/codehaus-plexus/plexus-utils/commit/b38a1b3a4352303e4312b2bb601a0d7ec6e28f41",
    "cve_id": "CVE-2017-1000487",
    "cwe_id": "CWE-78",
    "filename": "src/main/java/org/codehaus/plexus/util/cli/shell/Shell.java",
    "is_vulnerable": 1,
    "class_name": "Shell",
    "subclass_name": null,
    "function_name": "getShellCommandLine( String[] arguments )",
    "function_body": "{\n\n        List<String> commandLine = new ArrayList<String>();\n\n        if ( getShellCommand() != null )\n        {\n            commandLine.add( getShellCommand() );\n        }\n\n        if ( getShellArgs() != null )\n        {\n            commandLine.addAll( getShellArgsList() );\n        }\n\n        commandLine.addAll( getCommandLine( getExecutable(), arguments ) );\n\n        return commandLine;\n\n    }"
  },
  {
    "id": 39,
    "sub_id": 2,
    "code_id": 0,
    "function_id": 20,
    "human_patch": "https://github.com/codehaus-plexus/plexus-utils/commit/b38a1b3a4352303e4312b2bb601a0d7ec6e28f41",
    "cve_id": "CVE-2017-1000487",
    "cwe_id": "CWE-78",
    "filename": "src/main/java/org/codehaus/plexus/util/cli/shell/Shell.java",
    "is_vulnerable": 0,
    "class_name": "Shell",
    "subclass_name": null,
    "function_name": "getShellArgsList()",
    "function_body": "{\n        return shellArgs;\n    }"
  },
  {
    "id": 39,
    "sub_id": 2,
    "code_id": 0,
    "function_id": 21,
    "human_patch": "https://github.com/codehaus-plexus/plexus-utils/commit/b38a1b3a4352303e4312b2bb601a0d7ec6e28f41",
    "cve_id": "CVE-2017-1000487",
    "cwe_id": "CWE-78",
    "filename": "src/main/java/org/codehaus/plexus/util/cli/shell/Shell.java",
    "is_vulnerable": 0,
    "class_name": "Shell",
    "subclass_name": null,
    "function_name": "addShellArg( String arg )",
    "function_body": "{\n        shellArgs.add( arg );\n    }"
  },
  {
    "id": 39,
    "sub_id": 2,
    "code_id": 0,
    "function_id": 22,
    "human_patch": "https://github.com/codehaus-plexus/plexus-utils/commit/b38a1b3a4352303e4312b2bb601a0d7ec6e28f41",
    "cve_id": "CVE-2017-1000487",
    "cwe_id": "CWE-78",
    "filename": "src/main/java/org/codehaus/plexus/util/cli/shell/Shell.java",
    "is_vulnerable": 0,
    "class_name": "Shell",
    "subclass_name": null,
    "function_name": "setQuotedArgumentsEnabled( boolean quotedArgumentsEnabled )",
    "function_body": "{\n        this.quotedArgumentsEnabled = quotedArgumentsEnabled;\n    }"
  },
  {
    "id": 39,
    "sub_id": 2,
    "code_id": 0,
    "function_id": 23,
    "human_patch": "https://github.com/codehaus-plexus/plexus-utils/commit/b38a1b3a4352303e4312b2bb601a0d7ec6e28f41",
    "cve_id": "CVE-2017-1000487",
    "cwe_id": "CWE-78",
    "filename": "src/main/java/org/codehaus/plexus/util/cli/shell/Shell.java",
    "is_vulnerable": 0,
    "class_name": "Shell",
    "subclass_name": null,
    "function_name": "isQuotedArgumentsEnabled()",
    "function_body": "{\n        return quotedArgumentsEnabled;\n    }"
  },
  {
    "id": 39,
    "sub_id": 2,
    "code_id": 0,
    "function_id": 24,
    "human_patch": "https://github.com/codehaus-plexus/plexus-utils/commit/b38a1b3a4352303e4312b2bb601a0d7ec6e28f41",
    "cve_id": "CVE-2017-1000487",
    "cwe_id": "CWE-78",
    "filename": "src/main/java/org/codehaus/plexus/util/cli/shell/Shell.java",
    "is_vulnerable": 0,
    "class_name": "Shell",
    "subclass_name": null,
    "function_name": "setQuotedExecutableEnabled( boolean quotedExecutableEnabled )",
    "function_body": "{\n        this.quotedExecutableEnabled = quotedExecutableEnabled;\n    }"
  },
  {
    "id": 39,
    "sub_id": 2,
    "code_id": 0,
    "function_id": 25,
    "human_patch": "https://github.com/codehaus-plexus/plexus-utils/commit/b38a1b3a4352303e4312b2bb601a0d7ec6e28f41",
    "cve_id": "CVE-2017-1000487",
    "cwe_id": "CWE-78",
    "filename": "src/main/java/org/codehaus/plexus/util/cli/shell/Shell.java",
    "is_vulnerable": 0,
    "class_name": "Shell",
    "subclass_name": null,
    "function_name": "isQuotedExecutableEnabled()",
    "function_body": "{\n        return quotedExecutableEnabled;\n    }"
  },
  {
    "id": 39,
    "sub_id": 2,
    "code_id": 0,
    "function_id": 26,
    "human_patch": "https://github.com/codehaus-plexus/plexus-utils/commit/b38a1b3a4352303e4312b2bb601a0d7ec6e28f41",
    "cve_id": "CVE-2017-1000487",
    "cwe_id": "CWE-78",
    "filename": "src/main/java/org/codehaus/plexus/util/cli/shell/Shell.java",
    "is_vulnerable": 0,
    "class_name": "Shell",
    "subclass_name": null,
    "function_name": "setExecutable( String executable )",
    "function_body": "{\n        if ( ( executable == null ) || ( executable.length() == 0 ) )\n        {\n            return;\n        }\n        this.executable = executable.replace( '/', File.separatorChar ).replace( '\\\\', File.separatorChar );\n    }"
  },
  {
    "id": 39,
    "sub_id": 2,
    "code_id": 0,
    "function_id": 27,
    "human_patch": "https://github.com/codehaus-plexus/plexus-utils/commit/b38a1b3a4352303e4312b2bb601a0d7ec6e28f41",
    "cve_id": "CVE-2017-1000487",
    "cwe_id": "CWE-78",
    "filename": "src/main/java/org/codehaus/plexus/util/cli/shell/Shell.java",
    "is_vulnerable": 0,
    "class_name": "Shell",
    "subclass_name": null,
    "function_name": "getExecutable()",
    "function_body": "{\n        return executable;\n    }"
  },
  {
    "id": 39,
    "sub_id": 2,
    "code_id": 0,
    "function_id": 28,
    "human_patch": "https://github.com/codehaus-plexus/plexus-utils/commit/b38a1b3a4352303e4312b2bb601a0d7ec6e28f41",
    "cve_id": "CVE-2017-1000487",
    "cwe_id": "CWE-78",
    "filename": "src/main/java/org/codehaus/plexus/util/cli/shell/Shell.java",
    "is_vulnerable": 0,
    "class_name": "Shell",
    "subclass_name": null,
    "function_name": "setWorkingDirectory( String path )",
    "function_body": "{\n        if ( path != null )\n        {\n            workingDir = path;\n        }\n    }"
  },
  {
    "id": 39,
    "sub_id": 2,
    "code_id": 0,
    "function_id": 29,
    "human_patch": "https://github.com/codehaus-plexus/plexus-utils/commit/b38a1b3a4352303e4312b2bb601a0d7ec6e28f41",
    "cve_id": "CVE-2017-1000487",
    "cwe_id": "CWE-78",
    "filename": "src/main/java/org/codehaus/plexus/util/cli/shell/Shell.java",
    "is_vulnerable": 0,
    "class_name": "Shell",
    "subclass_name": null,
    "function_name": "setWorkingDirectory( File workingDir )",
    "function_body": "{\n        if ( workingDir != null )\n        {\n            this.workingDir = workingDir.getAbsolutePath();\n        }\n    }"
  },
  {
    "id": 39,
    "sub_id": 2,
    "code_id": 0,
    "function_id": 30,
    "human_patch": "https://github.com/codehaus-plexus/plexus-utils/commit/b38a1b3a4352303e4312b2bb601a0d7ec6e28f41",
    "cve_id": "CVE-2017-1000487",
    "cwe_id": "CWE-78",
    "filename": "src/main/java/org/codehaus/plexus/util/cli/shell/Shell.java",
    "is_vulnerable": 0,
    "class_name": "Shell",
    "subclass_name": null,
    "function_name": "getWorkingDirectory()",
    "function_body": "{\n        return workingDir == null ? null : new File( workingDir );\n    }"
  },
  {
    "id": 39,
    "sub_id": 2,
    "code_id": 0,
    "function_id": 31,
    "human_patch": "https://github.com/codehaus-plexus/plexus-utils/commit/b38a1b3a4352303e4312b2bb601a0d7ec6e28f41",
    "cve_id": "CVE-2017-1000487",
    "cwe_id": "CWE-78",
    "filename": "src/main/java/org/codehaus/plexus/util/cli/shell/Shell.java",
    "is_vulnerable": 0,
    "class_name": "Shell",
    "subclass_name": null,
    "function_name": "getWorkingDirectoryAsString()",
    "function_body": "{\n        return workingDir;\n    }"
  },
  {
    "id": 39,
    "sub_id": 2,
    "code_id": 0,
    "function_id": 32,
    "human_patch": "https://github.com/codehaus-plexus/plexus-utils/commit/b38a1b3a4352303e4312b2bb601a0d7ec6e28f41",
    "cve_id": "CVE-2017-1000487",
    "cwe_id": "CWE-78",
    "filename": "src/main/java/org/codehaus/plexus/util/cli/shell/Shell.java",
    "is_vulnerable": 0,
    "class_name": "Shell",
    "subclass_name": null,
    "function_name": "clearArguments()",
    "function_body": "{\n        shellArgs.clear();\n    }"
  },
  {
    "id": 39,
    "sub_id": 2,
    "code_id": 0,
    "function_id": 33,
    "human_patch": "https://github.com/codehaus-plexus/plexus-utils/commit/b38a1b3a4352303e4312b2bb601a0d7ec6e28f41",
    "cve_id": "CVE-2017-1000487",
    "cwe_id": "CWE-78",
    "filename": "src/main/java/org/codehaus/plexus/util/cli/shell/Shell.java",
    "is_vulnerable": 0,
    "class_name": "Shell",
    "subclass_name": null,
    "function_name": "clone()",
    "function_body": "{\n        Shell shell = new Shell();\n        shell.setExecutable( getExecutable() );\n        shell.setWorkingDirectory( getWorkingDirectory() );\n        shell.setShellArgs( getShellArgs() );\n        return shell;\n    }"
  },
  {
    "id": 39,
    "sub_id": 2,
    "code_id": 0,
    "function_id": 34,
    "human_patch": "https://github.com/codehaus-plexus/plexus-utils/commit/b38a1b3a4352303e4312b2bb601a0d7ec6e28f41",
    "cve_id": "CVE-2017-1000487",
    "cwe_id": "CWE-78",
    "filename": "src/main/java/org/codehaus/plexus/util/cli/shell/Shell.java",
    "is_vulnerable": 0,
    "class_name": "Shell",
    "subclass_name": null,
    "function_name": "getOriginalExecutable()",
    "function_body": "{\n        return executable;\n    }"
  },
  {
    "id": 39,
    "sub_id": 2,
    "code_id": 0,
    "function_id": 35,
    "human_patch": "https://github.com/codehaus-plexus/plexus-utils/commit/b38a1b3a4352303e4312b2bb601a0d7ec6e28f41",
    "cve_id": "CVE-2017-1000487",
    "cwe_id": "CWE-78",
    "filename": "src/main/java/org/codehaus/plexus/util/cli/shell/Shell.java",
    "is_vulnerable": 0,
    "class_name": "Shell",
    "subclass_name": null,
    "function_name": "getOriginalCommandLine( String executable, String[] arguments )",
    "function_body": "{\n        return getRawCommandLine( executable, arguments );\n    }"
  },
  {
    "id": 39,
    "sub_id": 2,
    "code_id": 0,
    "function_id": 36,
    "human_patch": "https://github.com/codehaus-plexus/plexus-utils/commit/b38a1b3a4352303e4312b2bb601a0d7ec6e28f41",
    "cve_id": "CVE-2017-1000487",
    "cwe_id": "CWE-78",
    "filename": "src/main/java/org/codehaus/plexus/util/cli/shell/Shell.java",
    "is_vulnerable": 0,
    "class_name": "Shell",
    "subclass_name": null,
    "function_name": "setDoubleQuotedArgumentEscaped( boolean doubleQuotedArgumentEscaped )",
    "function_body": "{\n        this.doubleQuotedArgumentEscaped = doubleQuotedArgumentEscaped;\n    }"
  },
  {
    "id": 39,
    "sub_id": 2,
    "code_id": 0,
    "function_id": 37,
    "human_patch": "https://github.com/codehaus-plexus/plexus-utils/commit/b38a1b3a4352303e4312b2bb601a0d7ec6e28f41",
    "cve_id": "CVE-2017-1000487",
    "cwe_id": "CWE-78",
    "filename": "src/main/java/org/codehaus/plexus/util/cli/shell/Shell.java",
    "is_vulnerable": 0,
    "class_name": "Shell",
    "subclass_name": null,
    "function_name": "setDoubleQuotedExecutableEscaped( boolean doubleQuotedExecutableEscaped )",
    "function_body": "{\n        this.doubleQuotedExecutableEscaped = doubleQuotedExecutableEscaped;\n    }"
  },
  {
    "id": 39,
    "sub_id": 2,
    "code_id": 0,
    "function_id": 38,
    "human_patch": "https://github.com/codehaus-plexus/plexus-utils/commit/b38a1b3a4352303e4312b2bb601a0d7ec6e28f41",
    "cve_id": "CVE-2017-1000487",
    "cwe_id": "CWE-78",
    "filename": "src/main/java/org/codehaus/plexus/util/cli/shell/Shell.java",
    "is_vulnerable": 0,
    "class_name": "Shell",
    "subclass_name": null,
    "function_name": "setSingleQuotedArgumentEscaped( boolean singleQuotedArgumentEscaped )",
    "function_body": "{\n        this.singleQuotedArgumentEscaped = singleQuotedArgumentEscaped;\n    }"
  },
  {
    "id": 39,
    "sub_id": 2,
    "code_id": 0,
    "function_id": 39,
    "human_patch": "https://github.com/codehaus-plexus/plexus-utils/commit/b38a1b3a4352303e4312b2bb601a0d7ec6e28f41",
    "cve_id": "CVE-2017-1000487",
    "cwe_id": "CWE-78",
    "filename": "src/main/java/org/codehaus/plexus/util/cli/shell/Shell.java",
    "is_vulnerable": 0,
    "class_name": "Shell",
    "subclass_name": null,
    "function_name": "setSingleQuotedExecutableEscaped( boolean singleQuotedExecutableEscaped )",
    "function_body": "{\n        this.singleQuotedExecutableEscaped = singleQuotedExecutableEscaped;\n    }"
  },
  {
    "id": 39,
    "sub_id": 3,
    "code_id": 0,
    "function_id": 0,
    "human_patch": "https://github.com/codehaus-plexus/plexus-utils/commit/b38a1b3a4352303e4312b2bb601a0d7ec6e28f41",
    "cve_id": "CVE-2017-1000487",
    "cwe_id": "CWE-78",
    "filename": "src/test/java/org/codehaus/plexus/util/cli/CommandlineTest.java",
    "is_vulnerable": 0,
    "class_name": "CommandlineTest",
    "subclass_name": null,
    "function_name": "setUp() throws Exception",
    "function_body": "{\n        super.setUp();\n        baseDir = System.getProperty( \"basedir\" );\n\n        if ( baseDir == null )\n        {\n            baseDir = new File( \".\" ).getCanonicalPath();\n        }\n    }"
  },
  {
    "id": 39,
    "sub_id": 3,
    "code_id": 0,
    "function_id": 1,
    "human_patch": "https://github.com/codehaus-plexus/plexus-utils/commit/b38a1b3a4352303e4312b2bb601a0d7ec6e28f41",
    "cve_id": "CVE-2017-1000487",
    "cwe_id": "CWE-78",
    "filename": "src/test/java/org/codehaus/plexus/util/cli/CommandlineTest.java",
    "is_vulnerable": 0,
    "class_name": "CommandlineTest",
    "subclass_name": null,
    "function_name": "testCommandlineWithoutCommandInConstructor()",
    "function_body": "{\n        try\n        {\n            Commandline cmd = new Commandline( new Shell() );\n            cmd.setWorkingDirectory( baseDir );\n            cmd.createArgument().setValue( \"cd\" );\n            cmd.createArgument().setValue( \".\" );\n\n            \n            assertEquals( \"cd .\", cmd.toString() );\n        }\n        catch ( Exception e )\n        {\n            fail( e.getMessage() );\n        }\n    }"
  },
  {
    "id": 39,
    "sub_id": 3,
    "code_id": 0,
    "function_id": 2,
    "human_patch": "https://github.com/codehaus-plexus/plexus-utils/commit/b38a1b3a4352303e4312b2bb601a0d7ec6e28f41",
    "cve_id": "CVE-2017-1000487",
    "cwe_id": "CWE-78",
    "filename": "src/test/java/org/codehaus/plexus/util/cli/CommandlineTest.java",
    "is_vulnerable": 0,
    "class_name": "CommandlineTest",
    "subclass_name": null,
    "function_name": "testCommandlineWithCommandInConstructor()",
    "function_body": "{\n        try\n        {\n            Commandline cmd = new Commandline( \"cd .\", new Shell() );\n            cmd.setWorkingDirectory( baseDir );\n\n            \n            assertEquals( \"cd .\", cmd.toString() );\n        }\n        catch ( Exception e )\n        {\n            fail( e.getMessage() );\n        }\n    }"
  },
  {
    "id": 39,
    "sub_id": 3,
    "code_id": 0,
    "function_id": 3,
    "human_patch": "https://github.com/codehaus-plexus/plexus-utils/commit/b38a1b3a4352303e4312b2bb601a0d7ec6e28f41",
    "cve_id": "CVE-2017-1000487",
    "cwe_id": "CWE-78",
    "filename": "src/test/java/org/codehaus/plexus/util/cli/CommandlineTest.java",
    "is_vulnerable": 0,
    "class_name": "CommandlineTest",
    "subclass_name": null,
    "function_name": "testExecute()",
    "function_body": "{\n        try\n        {\n            \n            Commandline cmd = new Commandline();\n            cmd.setWorkingDirectory( baseDir );\n            cmd.setExecutable( \"echo\" );\n            assertEquals( \"echo\", cmd.getShell().getOriginalExecutable() );\n            cmd.createArgument().setValue( \"Hello\" );\n\n            StringWriter swriter = new StringWriter();\n            Process process = cmd.execute();\n\n            Reader reader = new InputStreamReader( process.getInputStream() );\n\n            char[] chars = new char[16];\n            int read = -1;\n            while ( ( read = reader.read( chars ) ) > -1 )\n            {\n                swriter.write( chars, 0, read );\n            }\n\n            String output = swriter.toString().trim();\n\n            assertEquals( \"Hello\", output );\n        }\n        catch ( Exception e )\n        {\n            fail( e.getMessage() );\n        }\n    }"
  },
  {
    "id": 39,
    "sub_id": 3,
    "code_id": 0,
    "function_id": 4,
    "human_patch": "https://github.com/codehaus-plexus/plexus-utils/commit/b38a1b3a4352303e4312b2bb601a0d7ec6e28f41",
    "cve_id": "CVE-2017-1000487",
    "cwe_id": "CWE-78",
    "filename": "src/test/java/org/codehaus/plexus/util/cli/CommandlineTest.java",
    "is_vulnerable": 0,
    "class_name": "CommandlineTest",
    "subclass_name": null,
    "function_name": "testSetLine()",
    "function_body": "{\n        try\n        {\n            Commandline cmd = new Commandline( new Shell() );\n            cmd.setWorkingDirectory( baseDir );\n            cmd.setExecutable( \"echo\" );\n            cmd.createArgument().setLine( null );\n            cmd.createArgument().setLine( \"Hello\" );\n\n            \n            assertEquals( \"echo Hello\", cmd.toString() );\n        }\n        catch ( Exception e )\n        {\n            fail( e.getMessage() );\n        }\n    }"
  },
  {
    "id": 39,
    "sub_id": 3,
    "code_id": 0,
    "function_id": 5,
    "human_patch": "https://github.com/codehaus-plexus/plexus-utils/commit/b38a1b3a4352303e4312b2bb601a0d7ec6e28f41",
    "cve_id": "CVE-2017-1000487",
    "cwe_id": "CWE-78",
    "filename": "src/test/java/org/codehaus/plexus/util/cli/CommandlineTest.java",
    "is_vulnerable": 0,
    "class_name": "CommandlineTest",
    "subclass_name": null,
    "function_name": "testCreateCommandInReverseOrder()",
    "function_body": "{\n        try\n        {\n            Commandline cmd = new Commandline( new Shell() );\n            cmd.setWorkingDirectory( baseDir );\n            cmd.createArgument().setValue( \".\" );\n            cmd.createArgument( true ).setValue( \"cd\" );\n\n            \n            assertEquals( \"cd .\", cmd.toString() );\n        }\n        catch ( Exception e )\n        {\n            fail( e.getMessage() );\n        }\n    }"
  },
  {
    "id": 39,
    "sub_id": 3,
    "code_id": 0,
    "function_id": 6,
    "human_patch": "https://github.com/codehaus-plexus/plexus-utils/commit/b38a1b3a4352303e4312b2bb601a0d7ec6e28f41",
    "cve_id": "CVE-2017-1000487",
    "cwe_id": "CWE-78",
    "filename": "src/test/java/org/codehaus/plexus/util/cli/CommandlineTest.java",
    "is_vulnerable": 0,
    "class_name": "CommandlineTest",
    "subclass_name": null,
    "function_name": "testSetFile()",
    "function_body": "{\n        try\n        {\n            Commandline cmd = new Commandline( new Shell() );\n            cmd.setWorkingDirectory( baseDir );\n            cmd.createArgument().setValue( \"more\" );\n            File f = new File( \"test.txt\" );\n            cmd.createArgument().setFile( f );\n            String fileName = f.getAbsolutePath();\n            if ( fileName.indexOf( \" \" ) >= 0 )\n            {\n                fileName = \"\\\"\" + fileName + \"\\\"\";\n            }\n\n            \n            assertEquals( \"more \" + fileName, cmd.toString() );\n        }\n        catch ( Exception e )\n        {\n            fail( e.getMessage() );\n        }\n    }"
  },
  {
    "id": 39,
    "sub_id": 3,
    "code_id": 0,
    "function_id": 7,
    "human_patch": "https://github.com/codehaus-plexus/plexus-utils/commit/b38a1b3a4352303e4312b2bb601a0d7ec6e28f41",
    "cve_id": "CVE-2017-1000487",
    "cwe_id": "CWE-78",
    "filename": "src/test/java/org/codehaus/plexus/util/cli/CommandlineTest.java",
    "is_vulnerable": 0,
    "class_name": "CommandlineTest",
    "subclass_name": null,
    "function_name": "testGetShellCommandLineWindows() throws Exception",
    "function_body": "{\n        Commandline cmd = new Commandline( new CmdShell() );\n        cmd.setExecutable( \"c:\\\\Program Files\\\\xxx\" );\n        cmd.addArguments( new String[] {\n            \"a\",\n            \"b\"\n        } );\n        String[] shellCommandline = cmd.getShellCommandline();\n\n        assertEquals( \"Command line size\", 4, shellCommandline.length );\n\n        assertEquals( \"cmd.exe\", shellCommandline[0] );\n        assertEquals( \"/X\", shellCommandline[1] );\n        assertEquals( \"/C\", shellCommandline[2] );\n        String expectedShellCmd = \"\\\"c:\" + File.separator + \"Program Files\" + File.separator\n                                  + \"xxx\\\" a b\";\n        expectedShellCmd = \"\\\"\" + expectedShellCmd + \"\\\"\";\n        assertEquals( expectedShellCmd, shellCommandline[3] );\n    }"
  },
  {
    "id": 39,
    "sub_id": 3,
    "code_id": 0,
    "function_id": 8,
    "human_patch": "https://github.com/codehaus-plexus/plexus-utils/commit/b38a1b3a4352303e4312b2bb601a0d7ec6e28f41",
    "cve_id": "CVE-2017-1000487",
    "cwe_id": "CWE-78",
    "filename": "src/test/java/org/codehaus/plexus/util/cli/CommandlineTest.java",
    "is_vulnerable": 0,
    "class_name": "CommandlineTest",
    "subclass_name": null,
    "function_name": "testGetShellCommandLineWindowsWithSeveralQuotes() throws Exception",
    "function_body": "{\n        Commandline cmd = new Commandline( new CmdShell() );\n        cmd.setExecutable( \"c:\\\\Program Files\\\\xxx\" );\n        cmd.addArguments( new String[] {\n            \"c:\\\\Documents and Settings\\\\whatever\",\n            \"b\"\n        } );\n        String[] shellCommandline = cmd.getShellCommandline();\n\n        assertEquals( \"Command line size\", 4, shellCommandline.length );\n\n        assertEquals( \"cmd.exe\", shellCommandline[0] );\n        assertEquals( \"/X\", shellCommandline[1] );\n        assertEquals( \"/C\", shellCommandline[2] );\n        String expectedShellCmd = \"\\\"c:\" + File.separator + \"Program Files\" + File.separator\n                                  + \"xxx\\\" \\\"c:\\\\Documents and Settings\\\\whatever\\\" b\";\n        expectedShellCmd = \"\\\"\" + expectedShellCmd + \"\\\"\";\n        assertEquals( expectedShellCmd, shellCommandline[3] );\n    }"
  },
  {
    "id": 39,
    "sub_id": 3,
    "code_id": 0,
    "function_id": 9,
    "human_patch": "https://github.com/codehaus-plexus/plexus-utils/commit/b38a1b3a4352303e4312b2bb601a0d7ec6e28f41",
    "cve_id": "CVE-2017-1000487",
    "cwe_id": "CWE-78",
    "filename": "src/test/java/org/codehaus/plexus/util/cli/CommandlineTest.java",
    "is_vulnerable": 1,
    "class_name": "CommandlineTest",
    "subclass_name": null,
    "function_name": "testGetShellCommandLineBash() throws Exception",
    "function_body": "{\n        Commandline cmd = new Commandline( new BourneShell() );\n        cmd.setExecutable( \"/bin/echo\" );\n        cmd.addArguments( new String[] {\n            \"hello world\"\n        } );\n\n        String[] shellCommandline = cmd.getShellCommandline();\n\n        assertEquals( \"Command line size\", 3, shellCommandline.length );\n\n        assertEquals( \"/bin/sh\", shellCommandline[0] );\n        assertEquals( \"-c\", shellCommandline[1] );\n        String expectedShellCmd = \"/bin/echo \\'hello world\\'\";\n        if ( Os.isFamily( Os.FAMILY_WINDOWS ) )\n        {\n            expectedShellCmd = \"\\\\bin\\\\echo \\'hello world\\'\";\n        }\n        assertEquals( expectedShellCmd, shellCommandline[2] );\n    }"
  },
  {
    "id": 39,
    "sub_id": 3,
    "code_id": 0,
    "function_id": 10,
    "human_patch": "https://github.com/codehaus-plexus/plexus-utils/commit/b38a1b3a4352303e4312b2bb601a0d7ec6e28f41",
    "cve_id": "CVE-2017-1000487",
    "cwe_id": "CWE-78",
    "filename": "src/test/java/org/codehaus/plexus/util/cli/CommandlineTest.java",
    "is_vulnerable": 1,
    "class_name": "CommandlineTest",
    "subclass_name": null,
    "function_name": "testGetShellCommandLineBash_WithWorkingDirectory() throws Exception",
    "function_body": "{\n        Commandline cmd = new Commandline( new BourneShell() );\n        cmd.setExecutable( \"/bin/echo\" );\n        cmd.addArguments( new String[] {\n            \"hello world\"\n        } );\n        File root = File.listRoots()[0];\n        File workingDirectory = new File( root, \"path with spaces\" );\n        cmd.setWorkingDirectory( workingDirectory );\n\n        String[] shellCommandline = cmd.getShellCommandline();\n\n        assertEquals( \"Command line size\", 3, shellCommandline.length );\n\n        assertEquals( \"/bin/sh\", shellCommandline[0] );\n        assertEquals( \"-c\", shellCommandline[1] );\n        String expectedShellCmd = \"cd \\\"\" + root.getAbsolutePath()\n                                  + \"path with spaces\\\" && /bin/echo \\'hello world\\'\";\n        if ( Os.isFamily( Os.FAMILY_WINDOWS ) )\n        {\n            expectedShellCmd = \"cd \\\"\" + root.getAbsolutePath()\n                               + \"path with spaces\\\" && \\\\bin\\\\echo \\'hello world\\'\";\n        }\n        assertEquals( expectedShellCmd, shellCommandline[2] );\n    }"
  },
  {
    "id": 39,
    "sub_id": 3,
    "code_id": 0,
    "function_id": 11,
    "human_patch": "https://github.com/codehaus-plexus/plexus-utils/commit/b38a1b3a4352303e4312b2bb601a0d7ec6e28f41",
    "cve_id": "CVE-2017-1000487",
    "cwe_id": "CWE-78",
    "filename": "src/test/java/org/codehaus/plexus/util/cli/CommandlineTest.java",
    "is_vulnerable": 1,
    "class_name": "CommandlineTest",
    "subclass_name": null,
    "function_name": "testGetShellCommandLineBash_WithSingleQuotedArg() throws Exception",
    "function_body": "{\n        Commandline cmd = new Commandline( new BourneShell() );\n        cmd.setExecutable( \"/bin/echo\" );\n        cmd.addArguments( new String[] {\n            \"\\'hello world\\'\"\n        } );\n\n        String[] shellCommandline = cmd.getShellCommandline();\n\n        assertEquals( \"Command line size\", 3, shellCommandline.length );\n\n        assertEquals( \"/bin/sh\", shellCommandline[0] );\n        assertEquals( \"-c\", shellCommandline[1] );\n        String expectedShellCmd = \"/bin/echo \\'hello world\\'\";\n        if ( Os.isFamily( Os.FAMILY_WINDOWS ) )\n        {\n            expectedShellCmd = \"\\\\bin\\\\echo \\'hello world\\'\";\n        }\n        assertEquals( expectedShellCmd, shellCommandline[2] );\n    }"
  },
  {
    "id": 39,
    "sub_id": 3,
    "code_id": 0,
    "function_id": 12,
    "human_patch": "https://github.com/codehaus-plexus/plexus-utils/commit/b38a1b3a4352303e4312b2bb601a0d7ec6e28f41",
    "cve_id": "CVE-2017-1000487",
    "cwe_id": "CWE-78",
    "filename": "src/test/java/org/codehaus/plexus/util/cli/CommandlineTest.java",
    "is_vulnerable": 1,
    "class_name": "CommandlineTest",
    "subclass_name": null,
    "function_name": "testGetShellCommandLineNonWindows() throws Exception",
    "function_body": "{\n        Commandline cmd = new Commandline( new BourneShell() );\n        cmd.setExecutable( \"/usr/bin\" );\n        cmd.addArguments( new String[] {\n            \"a\",\n            \"b\"\n        } );\n        String[] shellCommandline = cmd.getShellCommandline();\n\n        assertEquals( \"Command line size\", 3, shellCommandline.length );\n\n        assertEquals( \"/bin/sh\", shellCommandline[0] );\n        assertEquals( \"-c\", shellCommandline[1] );\n\n        if ( Os.isFamily( Os.FAMILY_WINDOWS ) )\n        {\n            assertEquals( \"\\\\usr\\\\bin a b\", shellCommandline[2] );\n        }\n        else\n        {\n            assertEquals( \"/usr/bin a b\", shellCommandline[2] );\n        }\n    }"
  },
  {
    "id": 39,
    "sub_id": 3,
    "code_id": 0,
    "function_id": 13,
    "human_patch": "https://github.com/codehaus-plexus/plexus-utils/commit/b38a1b3a4352303e4312b2bb601a0d7ec6e28f41",
    "cve_id": "CVE-2017-1000487",
    "cwe_id": "CWE-78",
    "filename": "src/test/java/org/codehaus/plexus/util/cli/CommandlineTest.java",
    "is_vulnerable": 0,
    "class_name": "CommandlineTest",
    "subclass_name": null,
    "function_name": "testEnvironment() throws Exception",
    "function_body": "{\n        Commandline cmd = new Commandline();\n        cmd.addEnvironment( \"name\", \"value\" );\n        assertEquals( \"name=value\", cmd.getEnvironmentVariables()[0] );\n    }"
  },
  {
    "id": 39,
    "sub_id": 3,
    "code_id": 0,
    "function_id": 14,
    "human_patch": "https://github.com/codehaus-plexus/plexus-utils/commit/b38a1b3a4352303e4312b2bb601a0d7ec6e28f41",
    "cve_id": "CVE-2017-1000487",
    "cwe_id": "CWE-78",
    "filename": "src/test/java/org/codehaus/plexus/util/cli/CommandlineTest.java",
    "is_vulnerable": 0,
    "class_name": "CommandlineTest",
    "subclass_name": null,
    "function_name": "testEnvironmentWitOverrideSystemEnvironment() throws Exception",
    "function_body": "{\n        Commandline cmd = new Commandline();\n        cmd.addSystemEnvironment();\n        cmd.addEnvironment( \"JAVA_HOME\", \"/usr/jdk1.5\" );\n        String[] environmentVariables = cmd.getEnvironmentVariables();\n\n        for ( int i = 0, size = environmentVariables.length; i < size; i++ )\n        {\n            if ( \"JAVA_HOME=/usr/jdk1.5\".equals( environmentVariables[i] ) )\n            {\n                return;\n            }\n        }\n\n        fail( \"can't find JAVA_HOME=/usr/jdk1.5\" );\n    }"
  },
  {
    "id": 39,
    "sub_id": 3,
    "code_id": 0,
    "function_id": 15,
    "human_patch": "https://github.com/codehaus-plexus/plexus-utils/commit/b38a1b3a4352303e4312b2bb601a0d7ec6e28f41",
    "cve_id": "CVE-2017-1000487",
    "cwe_id": "CWE-78",
    "filename": "src/test/java/org/codehaus/plexus/util/cli/CommandlineTest.java",
    "is_vulnerable": 0,
    "class_name": "CommandlineTest",
    "subclass_name": null,
    "function_name": "testQuotedPathWithSingleApostrophe() throws Exception",
    "function_body": "{\n        File dir = new File( System.getProperty( \"basedir\" ), \"target/test/quotedpath'test\" );\n        createAndCallScript( dir, \"echo Quoted\" );\n\n        dir = new File( System.getProperty( \"basedir\" ), \"target/test/quoted path'test\" );\n        createAndCallScript( dir, \"echo Quoted\" );\n    }"
  },
  {
    "id": 39,
    "sub_id": 3,
    "code_id": 0,
    "function_id": 16,
    "human_patch": "https://github.com/codehaus-plexus/plexus-utils/commit/b38a1b3a4352303e4312b2bb601a0d7ec6e28f41",
    "cve_id": "CVE-2017-1000487",
    "cwe_id": "CWE-78",
    "filename": "src/test/java/org/codehaus/plexus/util/cli/CommandlineTest.java",
    "is_vulnerable": 0,
    "class_name": "CommandlineTest",
    "subclass_name": null,
    "function_name": "testQuotedPathWithQuotationMark() throws Exception",
    "function_body": "{\n        if ( Os.isFamily( Os.FAMILY_WINDOWS ) )\n        {\n            System.out.println( \"testQuotedPathWithQuotationMark() skipped on Windows\" );\n            return;\n        }\n\n        File dir = new File( System.getProperty( \"basedir\" ), \"target/test/quotedpath\\\"test\" );\n        createAndCallScript( dir, \"echo Quoted\" );\n\n        dir = new File( System.getProperty( \"basedir\" ), \"target/test/quoted path\\\"test\" );\n        createAndCallScript( dir, \"echo Quoted\" );\n    }"
  },
  {
    "id": 39,
    "sub_id": 3,
    "code_id": 0,
    "function_id": 17,
    "human_patch": "https://github.com/codehaus-plexus/plexus-utils/commit/b38a1b3a4352303e4312b2bb601a0d7ec6e28f41",
    "cve_id": "CVE-2017-1000487",
    "cwe_id": "CWE-78",
    "filename": "src/test/java/org/codehaus/plexus/util/cli/CommandlineTest.java",
    "is_vulnerable": 0,
    "class_name": "CommandlineTest",
    "subclass_name": null,
    "function_name": "testQuotedPathWithQuotationMarkAndApostrophe() throws Exception",
    "function_body": "{\n        if ( Os.isFamily( Os.FAMILY_WINDOWS ) )\n        {\n            System.out.println( \"testQuotedPathWithQuotationMarkAndApostrophe() skipped on Windows\" );\n            return;\n        }\n\n        File dir = new File( System.getProperty( \"basedir\" ), \"target/test/quotedpath\\\"'test\" );\n        createAndCallScript( dir, \"echo Quoted\" );\n\n        dir = new File( System.getProperty( \"basedir\" ), \"target/test/quoted path\\\"'test\" );\n        createAndCallScript( dir, \"echo Quoted\" );\n    }"
  },
  {
    "id": 39,
    "sub_id": 3,
    "code_id": 0,
    "function_id": 18,
    "human_patch": "https://github.com/codehaus-plexus/plexus-utils/commit/b38a1b3a4352303e4312b2bb601a0d7ec6e28f41",
    "cve_id": "CVE-2017-1000487",
    "cwe_id": "CWE-78",
    "filename": "src/test/java/org/codehaus/plexus/util/cli/CommandlineTest.java",
    "is_vulnerable": 0,
    "class_name": "CommandlineTest",
    "subclass_name": null,
    "function_name": "testOnlyQuotedPath() throws Exception",
    "function_body": "{\n        File dir = new File( System.getProperty( \"basedir\" ), \"target/test/quotedpath\\'test\" );\n\n        File javaHome = new File( System.getProperty( \"java.home\" ) );\n        File java;\n        if ( Os.isFamily( Os.FAMILY_WINDOWS ) )\n        {\n            java = new File( javaHome, \"/bin/java.exe\" );\n        }\n        else\n        {\n            java = new File( javaHome, \"/bin/java\" );\n        }\n\n        if ( !java.exists() )\n        {\n            throw new IOException( java.getAbsolutePath() + \" doesn't exist\" );\n        }\n\n        createAndCallScript( dir, java.getAbsolutePath() + \" -version\" );\n    }"
  },
  {
    "id": 39,
    "sub_id": 3,
    "code_id": 0,
    "function_id": 19,
    "human_patch": "https://github.com/codehaus-plexus/plexus-utils/commit/b38a1b3a4352303e4312b2bb601a0d7ec6e28f41",
    "cve_id": "CVE-2017-1000487",
    "cwe_id": "CWE-78",
    "filename": "src/test/java/org/codehaus/plexus/util/cli/CommandlineTest.java",
    "is_vulnerable": 0,
    "class_name": "CommandlineTest",
    "subclass_name": null,
    "function_name": "testDollarSignInArgumentPath() throws Exception",
    "function_body": "{\n        File dir = new File( System.getProperty( \"basedir\" ), \"target/test\" );\n        if ( !dir.exists() )\n        {\n            assertTrue( \"Can't create dir:\" + dir.getAbsolutePath(), dir.mkdirs() );\n        }\n\n        FileWriter writer = null;\n        try\n        {\n            writer = new FileWriter( new File( dir, \"test$1.txt\" ) );\n            IOUtil.copy( \"Success\", writer );\n        }\n        finally\n        {\n            IOUtil.close( writer );\n        }\n\n        Commandline cmd = new Commandline();\n        \n        cmd.getShell().setQuotedArgumentsEnabled( true );\n        cmd.setExecutable( \"cat\" );\n        if ( Os.isFamily( Os.FAMILY_WINDOWS ) )\n        {\n            cmd.setExecutable( \"dir\" );\n        }\n        cmd.setWorkingDirectory( dir );\n        cmd.createArg().setLine( \"test$1.txt\" );\n\n        executeCommandLine( cmd );\n    }"
  },
  {
    "id": 39,
    "sub_id": 3,
    "code_id": 0,
    "function_id": 20,
    "human_patch": "https://github.com/codehaus-plexus/plexus-utils/commit/b38a1b3a4352303e4312b2bb601a0d7ec6e28f41",
    "cve_id": "CVE-2017-1000487",
    "cwe_id": "CWE-78",
    "filename": "src/test/java/org/codehaus/plexus/util/cli/CommandlineTest.java",
    "is_vulnerable": 0,
    "class_name": "CommandlineTest",
    "subclass_name": null,
    "function_name": "testTimeOutException() throws Exception",
    "function_body": "{\n        File javaHome = new File( System.getProperty( \"java.home\" ) );\n        File java;\n        if ( Os.isFamily( Os.FAMILY_WINDOWS ) )\n        {\n            java = new File( javaHome, \"/bin/java.exe\" );\n        }\n        else\n        {\n            java = new File( javaHome, \"/bin/java\" );\n        }\n\n        if ( !java.exists() )\n        {\n            throw new IOException( java.getAbsolutePath() + \" doesn't exist\" );\n        }\n        \n        Commandline cli = new Commandline();\n        cli.setExecutable( java.getAbsolutePath() );\n        cli.createArg().setLine( \"-version\" );\n        CommandLineUtils.StringStreamConsumer err = new CommandLineUtils.StringStreamConsumer();\n        try\n        {\n            \n            CommandLineUtils.executeCommandLine( cli, new DefaultConsumer(), err, 1 );\n        }\n        catch ( CommandLineTimeOutException e )\n        {\n            \n        }\n        \n    }"
  },
  {
    "id": 39,
    "sub_id": 3,
    "code_id": 0,
    "function_id": 21,
    "human_patch": "https://github.com/codehaus-plexus/plexus-utils/commit/b38a1b3a4352303e4312b2bb601a0d7ec6e28f41",
    "cve_id": "CVE-2017-1000487",
    "cwe_id": "CWE-78",
    "filename": "src/test/java/org/codehaus/plexus/util/cli/CommandlineTest.java",
    "is_vulnerable": 0,
    "class_name": "CommandlineTest",
    "subclass_name": null,
    "function_name": "makeExecutable( File path ) throws IOException",
    "function_body": "{\n        if ( path == null )\n        {\n            throw new IllegalArgumentException( \"The file is null\" );\n        }\n\n        if ( !path.isFile() )\n        {\n            throw new IllegalArgumentException( \"The file '\" + path.getAbsolutePath() + \"' should be a file\" );\n        }\n\n        if ( !Os.isFamily( Os.FAMILY_WINDOWS ) )\n        {\n            Process proc = Runtime.getRuntime().exec( new String[] { \"chmod\", \"a+x\", path.getAbsolutePath() } );\n            while ( true )\n            {\n                try\n                {\n                    proc.waitFor();\n                    break;\n                }\n                catch ( InterruptedException e )\n                {\n                    \n                }\n            }\n        }\n    }"
  },
  {
    "id": 39,
    "sub_id": 3,
    "code_id": 0,
    "function_id": 22,
    "human_patch": "https://github.com/codehaus-plexus/plexus-utils/commit/b38a1b3a4352303e4312b2bb601a0d7ec6e28f41",
    "cve_id": "CVE-2017-1000487",
    "cwe_id": "CWE-78",
    "filename": "src/test/java/org/codehaus/plexus/util/cli/CommandlineTest.java",
    "is_vulnerable": 0,
    "class_name": "CommandlineTest",
    "subclass_name": null,
    "function_name": "createAndCallScript( File dir, String content ) throws Exception",
    "function_body": "{\n        if ( !dir.exists() )\n        {\n            assertTrue( \"Can't create dir:\" + dir.getAbsolutePath(), dir.mkdirs() );\n        }\n\n        \n        File bat;\n        if ( Os.isFamily( Os.FAMILY_WINDOWS ) )\n        {\n            bat = new File( dir, \"echo.bat\" );\n        }\n        else\n        {\n            bat = new File( dir, \"echo\" );\n        }\n\n        Writer w = new FileWriter( bat );\n        try\n        {\n            IOUtil.copy( content, w );\n        }\n        finally\n        {\n            IOUtil.close( w );\n        }\n\n        \n        makeExecutable( bat );\n\n        Commandline cmd = new Commandline();\n        cmd.setExecutable( bat.getAbsolutePath() );\n        cmd.setWorkingDirectory( dir );\n\n        \n        executeCommandLine( cmd );\n    }"
  },
  {
    "id": 39,
    "sub_id": 3,
    "code_id": 0,
    "function_id": 23,
    "human_patch": "https://github.com/codehaus-plexus/plexus-utils/commit/b38a1b3a4352303e4312b2bb601a0d7ec6e28f41",
    "cve_id": "CVE-2017-1000487",
    "cwe_id": "CWE-78",
    "filename": "src/test/java/org/codehaus/plexus/util/cli/CommandlineTest.java",
    "is_vulnerable": 0,
    "class_name": "CommandlineTest",
    "subclass_name": null,
    "function_name": "executeCommandLine( Commandline cmd ) throws Exception",
    "function_body": "{\n        CommandLineUtils.StringStreamConsumer err = new CommandLineUtils.StringStreamConsumer();\n\n        try\n        {\n            System.out.println( \"Command line is: \" + StringUtils.join( cmd.getShellCommandline(), \" \" ) );\n\n            int exitCode = CommandLineUtils.executeCommandLine( cmd, new DefaultConsumer(), err );\n\n            if ( exitCode != 0 )\n            {\n                String msg = \"Exit code: \" + exitCode + \" - \" + err.getOutput();\n                throw new Exception( msg.toString() );\n            }\n        }\n        catch ( CommandLineException e )\n        {\n            throw new Exception( \"Unable to execute command: \" + e.getMessage(), e );\n        }\n    }"
  },
  {
    "id": 39,
    "sub_id": 4,
    "code_id": 0,
    "function_id": 0,
    "human_patch": "https://github.com/codehaus-plexus/plexus-utils/commit/b38a1b3a4352303e4312b2bb601a0d7ec6e28f41",
    "cve_id": "CVE-2017-1000487",
    "cwe_id": "CWE-78",
    "filename": "src/test/java/org/codehaus/plexus/util/cli/shell/BourneShellTest.java",
    "is_vulnerable": 0,
    "class_name": "BourneShellTest",
    "subclass_name": null,
    "function_name": "newShell()",
    "function_body": "{\n        return new BourneShell();\n    }"
  },
  {
    "id": 39,
    "sub_id": 4,
    "code_id": 0,
    "function_id": 1,
    "human_patch": "https://github.com/codehaus-plexus/plexus-utils/commit/b38a1b3a4352303e4312b2bb601a0d7ec6e28f41",
    "cve_id": "CVE-2017-1000487",
    "cwe_id": "CWE-78",
    "filename": "src/test/java/org/codehaus/plexus/util/cli/shell/BourneShellTest.java",
    "is_vulnerable": 1,
    "class_name": "BourneShellTest",
    "subclass_name": null,
    "function_name": "testQuoteWorkingDirectoryAndExecutable()",
    "function_body": "{\n        Shell sh = newShell();\n\n        sh.setWorkingDirectory( \"/usr/local/bin\" );\n        sh.setExecutable( \"chmod\" );\n\n        String executable = StringUtils.join( sh.getShellCommandLine( new String[]{} ).iterator(), \" \" );\n\n        assertEquals( \"/bin/sh -c cd /usr/local/bin && chmod\", executable );\n    }"
  },
  {
    "id": 39,
    "sub_id": 4,
    "code_id": 0,
    "function_id": 2,
    "human_patch": "https://github.com/codehaus-plexus/plexus-utils/commit/b38a1b3a4352303e4312b2bb601a0d7ec6e28f41",
    "cve_id": "CVE-2017-1000487",
    "cwe_id": "CWE-78",
    "filename": "src/test/java/org/codehaus/plexus/util/cli/shell/BourneShellTest.java",
    "is_vulnerable": 1,
    "class_name": "BourneShellTest",
    "subclass_name": null,
    "function_name": "testQuoteWorkingDirectoryAndExecutable_WDPathWithSingleQuotes()",
    "function_body": "{\n        Shell sh = newShell();\n\n        sh.setWorkingDirectory( \"/usr/local/'something else'\" );\n        sh.setExecutable( \"chmod\" );\n\n        String executable = StringUtils.join( sh.getShellCommandLine( new String[]{} ).iterator(), \" \" );\n\n        assertEquals( \"/bin/sh -c cd \\\"/usr/local/\\'something else\\'\\\" && chmod\", executable );\n    }"
  },
  {
    "id": 39,
    "sub_id": 4,
    "code_id": 0,
    "function_id": 3,
    "human_patch": "https://github.com/codehaus-plexus/plexus-utils/commit/b38a1b3a4352303e4312b2bb601a0d7ec6e28f41",
    "cve_id": "CVE-2017-1000487",
    "cwe_id": "CWE-78",
    "filename": "src/test/java/org/codehaus/plexus/util/cli/shell/BourneShellTest.java",
    "is_vulnerable": 1,
    "class_name": "BourneShellTest",
    "subclass_name": null,
    "function_name": "testQuoteWorkingDirectoryAndExecutable_WDPathWithSingleQuotes_BackslashFileSep()",
    "function_body": "{\n        Shell sh = newShell();\n\n        sh.setWorkingDirectory( \"\\\\usr\\\\local\\\\'something else'\" );\n        sh.setExecutable( \"chmod\" );\n\n        String executable = StringUtils.join( sh.getShellCommandLine( new String[]{} ).iterator(), \" \" );\n\n        assertEquals( \"/bin/sh -c cd \\\"\\\\usr\\\\local\\\\\\'something else\\'\\\" && chmod\", executable );\n    }"
  },
  {
    "id": 39,
    "sub_id": 4,
    "code_id": 0,
    "function_id": 4,
    "human_patch": "https://github.com/codehaus-plexus/plexus-utils/commit/b38a1b3a4352303e4312b2bb601a0d7ec6e28f41",
    "cve_id": "CVE-2017-1000487",
    "cwe_id": "CWE-78",
    "filename": "src/test/java/org/codehaus/plexus/util/cli/shell/BourneShellTest.java",
    "is_vulnerable": 1,
    "class_name": "BourneShellTest",
    "subclass_name": null,
    "function_name": "testPreserveSingleQuotesOnArgument()",
    "function_body": "{\n        Shell sh = newShell();\n\n        sh.setWorkingDirectory( \"/usr/bin\" );\n        sh.setExecutable( \"chmod\" );\n\n        String[] args = { \"\\'some arg with spaces\\'\" };\n\n        List shellCommandLine = sh.getShellCommandLine( args );\n\n        String cli = StringUtils.join( shellCommandLine.iterator(), \" \" );\n        System.out.println( cli );\n        assertTrue( cli.endsWith( args[0] ) );\n    }"
  },
  {
    "id": 39,
    "sub_id": 4,
    "code_id": 0,
    "function_id": 5,
    "human_patch": "https://github.com/codehaus-plexus/plexus-utils/commit/b38a1b3a4352303e4312b2bb601a0d7ec6e28f41",
    "cve_id": "CVE-2017-1000487",
    "cwe_id": "CWE-78",
    "filename": "src/test/java/org/codehaus/plexus/util/cli/shell/BourneShellTest.java",
    "is_vulnerable": 0,
    "class_name": "BourneShellTest",
    "subclass_name": null,
    "function_name": "testAddSingleQuotesOnArgumentWithSpaces()",
    "function_body": "{\n        Shell sh = newShell();\n\n        sh.setWorkingDirectory( \"/usr/bin\" );\n        sh.setExecutable( \"chmod\" );\n\n        String[] args = { \"some arg with spaces\" };\n\n        List shellCommandLine = sh.getShellCommandLine( args );\n\n        String cli = StringUtils.join( shellCommandLine.iterator(), \" \" );\n        System.out.println( cli );\n        assertTrue( cli.endsWith( \"\\'\" + args[0] + \"\\'\" ) );\n    }"
  },
  {
    "id": 39,
    "sub_id": 4,
    "code_id": 0,
    "function_id": 6,
    "human_patch": "https://github.com/codehaus-plexus/plexus-utils/commit/b38a1b3a4352303e4312b2bb601a0d7ec6e28f41",
    "cve_id": "CVE-2017-1000487",
    "cwe_id": "CWE-78",
    "filename": "src/test/java/org/codehaus/plexus/util/cli/shell/BourneShellTest.java",
    "is_vulnerable": 1,
    "class_name": "BourneShellTest",
    "subclass_name": null,
    "function_name": "testEscapeSingleQuotesOnArgument()",
    "function_body": "{\n        Shell sh = newShell();\n\n        sh.setWorkingDirectory( \"/usr/bin\" );\n        sh.setExecutable( \"chmod\" );\n\n        String[] args = { \"arg'withquote\" };\n\n        List shellCommandLine = sh.getShellCommandLine( args );\n\n        String cli = StringUtils.join( shellCommandLine.iterator(), \" \" );\n        System.out.println( cli );\n        assertEquals(\"cd /usr/bin && chmod 'arg'\\\\''withquote'\", shellCommandLine.get(shellCommandLine.size() - 1));\n    }"
  },
  {
    "id": 39,
    "sub_id": 4,
    "code_id": 0,
    "function_id": 7,
    "human_patch": "https://github.com/codehaus-plexus/plexus-utils/commit/b38a1b3a4352303e4312b2bb601a0d7ec6e28f41",
    "cve_id": "CVE-2017-1000487",
    "cwe_id": "CWE-78",
    "filename": "src/test/java/org/codehaus/plexus/util/cli/shell/BourneShellTest.java",
    "is_vulnerable": 1,
    "class_name": "BourneShellTest",
    "subclass_name": null,
    "function_name": "testArgumentsWithsemicolon()",
    "function_body": "{\n\n        System.out.println( \"---- semi colon tests ----\" );\n\n        Shell sh = newShell();\n\n        sh.setWorkingDirectory( \"/usr/bin\" );\n        sh.setExecutable( \"chmod\" );\n\n        String[] args = { \";some&argwithunix$chars\" };\n\n        List shellCommandLine = sh.getShellCommandLine( args );\n\n        String cli = StringUtils.join( shellCommandLine.iterator(), \" \" );\n        System.out.println( cli );\n        assertTrue( cli.endsWith( \"\\'\" + args[0] + \"\\'\" ) );\n\n        Commandline commandline = new Commandline( newShell() );\n        commandline.setExecutable( \"chmod\" );\n        commandline.getShell().setQuotedArgumentsEnabled( true );\n        commandline.createArg().setValue( \"--password\" );\n        commandline.createArg().setValue( \";password\" );\n\n        String[] lines = commandline.getShellCommandline();\n        System.out.println( Arrays.asList( lines ) );\n\n        assertEquals( \"/bin/sh\", lines[0] );\n        assertEquals( \"-c\", lines[1] );\n        assertEquals( \"chmod --password ';password'\", lines[2] );\n\n        commandline = new Commandline( newShell() );\n        commandline.setExecutable( \"chmod\" );\n        commandline.getShell().setQuotedArgumentsEnabled( true );\n        commandline.createArg().setValue( \"--password\" );\n        commandline.createArg().setValue( \";password\" );\n        lines = commandline.getShellCommandline();\n        System.out.println( Arrays.asList( lines ) );\n\n        assertEquals( \"/bin/sh\", lines[0] );\n        assertEquals( \"-c\", lines[1] );\n        assertEquals( \"chmod --password ';password'\", lines[2] );\n\n        commandline = new Commandline( new CmdShell() );\n        commandline.getShell().setQuotedArgumentsEnabled( true );\n        commandline.createArg().setValue( \"--password\" );\n        commandline.createArg().setValue( \";password\" );\n        lines = commandline.getShellCommandline();\n        System.out.println( Arrays.asList( lines ) );\n\n        assertEquals( \"cmd.exe\", lines[0] );\n        assertEquals( \"/X\", lines[1] );\n        assertEquals( \"/C\", lines[2] );\n        assertEquals( \"\\\"--password ;password\\\"\", lines[3] );\n    }"
  },
  {
    "id": 39,
    "sub_id": 4,
    "code_id": 0,
    "function_id": 8,
    "human_patch": "https://github.com/codehaus-plexus/plexus-utils/commit/b38a1b3a4352303e4312b2bb601a0d7ec6e28f41",
    "cve_id": "CVE-2017-1000487",
    "cwe_id": "CWE-78",
    "filename": "src/test/java/org/codehaus/plexus/util/cli/shell/BourneShellTest.java",
    "is_vulnerable": 1,
    "class_name": "BourneShellTest",
    "subclass_name": null,
    "function_name": "testBourneShellQuotingCharacters() throws Exception",
    "function_body": "{\n        \n        \n        Commandline commandline = new Commandline( newShell() );\n        commandline.setExecutable( \"chmod\" );\n        commandline.getShell().setQuotedArgumentsEnabled( true );\n        commandline.createArg().setValue( \" \" );\n        commandline.createArg().setValue( \"|\" );\n        commandline.createArg().setValue( \"&&\" );\n        commandline.createArg().setValue( \"||\" );\n        commandline.createArg().setValue( \";\" );\n        commandline.createArg().setValue( \";;\" );\n        commandline.createArg().setValue( \"&\" );\n        commandline.createArg().setValue( \"()\" );\n        commandline.createArg().setValue( \"<\" );\n        commandline.createArg().setValue( \"<<\" );\n        commandline.createArg().setValue( \">\" );\n        commandline.createArg().setValue( \">>\" );\n        commandline.createArg().setValue( \"*\" );\n        commandline.createArg().setValue( \"?\" );\n        commandline.createArg().setValue( \"[\" );\n        commandline.createArg().setValue( \"]\" );\n        commandline.createArg().setValue( \"{\" );\n        commandline.createArg().setValue( \"}\" );\n        commandline.createArg().setValue( \"`\" );\n\n        String[] lines = commandline.getShellCommandline();\n        System.out.println( Arrays.asList( lines ) );\n\n        assertEquals( \"/bin/sh\", lines[0] );\n        assertEquals( \"-c\", lines[1] );\n        assertEquals( \"chmod ' ' '|' '&&' '||' ';' ';;' '&' '()' '<' '<<' '>' '>>' '*' '?' '[' ']' '{' '}' '`'\",\n                      lines[2] );\n\n    }"
  },
  {
    "id": 40,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 0,
    "human_patch": "https://github.com/eclipse/rdf4j/commit/df15a4d7a8f2789c043b27c9eafe1b30316cfa79",
    "cve_id": "CVE-2018-20227",
    "cwe_id": "CWE-22",
    "filename": "util/src/main/java/org/eclipse/rdf4j/common/io/ZipUtil.java",
    "is_vulnerable": 0,
    "class_name": "ZipUtil",
    "subclass_name": null,
    "function_name": "isZipStream(InputStream in) throws IOException",
    "function_body": "{\n\t\tin.mark(MAGIC_NUMBER.length);\n\t\tbyte[] fileHeader = IOUtil.readBytes(in, MAGIC_NUMBER.length);\n\t\tin.reset();\n\t\treturn Arrays.equals(MAGIC_NUMBER, fileHeader);\n\t}"
  },
  {
    "id": 40,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 1,
    "human_patch": "https://github.com/eclipse/rdf4j/commit/df15a4d7a8f2789c043b27c9eafe1b30316cfa79",
    "cve_id": "CVE-2018-20227",
    "cwe_id": "CWE-22",
    "filename": "util/src/main/java/org/eclipse/rdf4j/common/io/ZipUtil.java",
    "is_vulnerable": 0,
    "class_name": "ZipUtil",
    "subclass_name": null,
    "function_name": "extract(File zipFile, File destDir) throws IOException",
    "function_body": "{\n\t\ttry (ZipFile zf = new ZipFile(zipFile)) {\n\t\t\textract(zf, destDir);\n\t\t}\n\t}"
  },
  {
    "id": 40,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 2,
    "human_patch": "https://github.com/eclipse/rdf4j/commit/df15a4d7a8f2789c043b27c9eafe1b30316cfa79",
    "cve_id": "CVE-2018-20227",
    "cwe_id": "CWE-22",
    "filename": "util/src/main/java/org/eclipse/rdf4j/common/io/ZipUtil.java",
    "is_vulnerable": 0,
    "class_name": "ZipUtil",
    "subclass_name": null,
    "function_name": "extract(ZipFile zipFile, File destDir) throws IOException",
    "function_body": "{\n\t\tassert destDir.isDirectory();\n\n\t\tEnumeration<? extends ZipEntry> entries = zipFile.entries();\n\t\twhile (entries.hasMoreElements()) {\n\t\t\tZipEntry entry = entries.nextElement();\n\t\t\twriteEntry(zipFile, entry, destDir);\n\t\t}\n\t}"
  },
  {
    "id": 40,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 3,
    "human_patch": "https://github.com/eclipse/rdf4j/commit/df15a4d7a8f2789c043b27c9eafe1b30316cfa79",
    "cve_id": "CVE-2018-20227",
    "cwe_id": "CWE-22",
    "filename": "util/src/main/java/org/eclipse/rdf4j/common/io/ZipUtil.java",
    "is_vulnerable": 1,
    "class_name": "ZipUtil",
    "subclass_name": null,
    "function_name": "writeEntry(ZipFile zipFile, ZipEntry entry, File destDir) throws IOException",
    "function_body": "{\n\t\tFile outFile = new File(destDir, entry.getName());\n\n\t\tif (entry.isDirectory()) {\n\t\t\toutFile.mkdirs();\n\t\t}\n\t\telse {\n\t\t\toutFile.getParentFile().mkdirs();\n\n\t\t\ttry (InputStream in = zipFile.getInputStream(entry)) {\n\t\t\t\tIOUtil.writeStream(in, outFile);\n\t\t\t}\n\t\t}\n\t}"
  },
  {
    "id": 41,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 0,
    "human_patch": "https://github.com/ESAPI/esapi-java-legacy/commit/b7cbc53f9cc967cf1a5a9463d8c6fef9ed6ef4f7",
    "cve_id": "CVE-2013-5960",
    "cwe_id": "CWE-310",
    "filename": "src/main/java/org/owasp/esapi/codecs/PercentCodec.java",
    "is_vulnerable": 0,
    "class_name": "PercentCodec",
    "subclass_name": null,
    "function_name": "toUtf8Bytes(String str)",
    "function_body": "{\n\t\ttry\n\t\t{\n\t\t\treturn str.getBytes(\"UTF-8\");\n\t\t}\n\t\tcatch(UnsupportedEncodingException e)\n\t\t{\n\t\t\tthrow new IllegalStateException(\"The Java spec requires UTF-8 support.\", e);\n\t\t}\n\t}"
  },
  {
    "id": 41,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 1,
    "human_patch": "https://github.com/ESAPI/esapi-java-legacy/commit/b7cbc53f9cc967cf1a5a9463d8c6fef9ed6ef4f7",
    "cve_id": "CVE-2013-5960",
    "cwe_id": "CWE-310",
    "filename": "src/main/java/org/owasp/esapi/codecs/PercentCodec.java",
    "is_vulnerable": 0,
    "class_name": "PercentCodec",
    "subclass_name": null,
    "function_name": "appendTwoUpperHex(StringBuilder sb, int b)",
    "function_body": "{\n\t\tif(b < Byte.MIN_VALUE || b > Byte.MAX_VALUE)\n\t\t\tthrow new IllegalArgumentException(\"b is not a byte (was \" + b + ')');\n\t\tb &= 0xFF;\n\t\tif(b<0x10)\n\t\t\tsb.append('0');\n\t\treturn sb.append(Integer.toHexString(b).toUpperCase());\n\t}"
  },
  {
    "id": 41,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 2,
    "human_patch": "https://github.com/ESAPI/esapi-java-legacy/commit/b7cbc53f9cc967cf1a5a9463d8c6fef9ed6ef4f7",
    "cve_id": "CVE-2013-5960",
    "cwe_id": "CWE-310",
    "filename": "src/main/java/org/owasp/esapi/codecs/PercentCodec.java",
    "is_vulnerable": 1,
    "class_name": "PercentCodec",
    "subclass_name": null,
    "function_name": "encodeCharacter( char[] immune, Character c )",
    "function_body": "{\n\t\tString cStr = String.valueOf(c.charValue());\n\t\tbyte[] bytes;\n\t\tStringBuilder sb;\n\n\t\tif(UNENCODED_SET.contains(c))\n\t\t\treturn cStr;\n\n\t\tbytes = toUtf8Bytes(cStr);\n\t\tsb = new StringBuilder(bytes.length * 3);\n\t\tfor(byte b : bytes)\n\t\t\tappendTwoUpperHex(sb.append('%'), b);\n\t\treturn sb.toString();\n\t}"
  },
  {
    "id": 41,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 3,
    "human_patch": "https://github.com/ESAPI/esapi-java-legacy/commit/b7cbc53f9cc967cf1a5a9463d8c6fef9ed6ef4f7",
    "cve_id": "CVE-2013-5960",
    "cwe_id": "CWE-310",
    "filename": "src/main/java/org/owasp/esapi/codecs/PercentCodec.java",
    "is_vulnerable": 0,
    "class_name": "PercentCodec",
    "subclass_name": null,
    "function_name": "decodeCharacter( PushbackString input )",
    "function_body": "{\n\t\tinput.mark();\n\t\tCharacter first = input.next();\n\t\tif ( first == null ) {\n\t\t\tinput.reset();\n\t\t\treturn null;\n\t\t}\n\n\t\t\n\t\tif (first != '%' ) {\n\t\t\tinput.reset();\n\t\t\treturn null;\n\t\t}\n\n\t\t\n\t\tStringBuilder sb = new StringBuilder();\n\t\tfor ( int i=0; i<2; i++ ) {\n\t\t\tCharacter c = input.nextHex();\n\t\t\tif ( c != null ) sb.append( c );\n\t\t}\n\t\tif ( sb.length() == 2 ) {\n\t\t\ttry {\n\t\t\t\t\n\t\t\t\tint i = Integer.parseInt(sb.toString(), 16);\n\t\t\t\tif (Character.isValidCodePoint(i)) {\n\t\t\t\t\treturn (char) i;\n\t\t\t\t}\n\t\t\t} catch( NumberFormatException ignored ) { }\n\t\t}\n\t\tinput.reset();\n\t\treturn null;\n\t}"
  },
  {
    "id": 42,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 0,
    "human_patch": "https://github.com/esigate/esigate/commit/30cad23a8f282600c9b045e1af09f6f8a65357b1",
    "cve_id": "CVE-2018-1000854",
    "cwe_id": "CWE-74",
    "filename": "esigate-core/src/main/java/org/esigate/xml/XsltRenderer.java",
    "is_vulnerable": 1,
    "class_name": "XsltRenderer",
    "subclass_name": null,
    "function_name": "createTransformer(InputStream templateStream) throws IOException",
    "function_body": "{\n        try {\n            return TRANSFORMER_FACTORY.newTransformer(new StreamSource(templateStream));\n        } catch (TransformerConfigurationException e) {\n            throw new ProcessingFailedException(\"Failed to create XSLT template\", e);\n        } finally {\n            templateStream.close();\n        }\n    }"
  },
  {
    "id": 42,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 1,
    "human_patch": "https://github.com/esigate/esigate/commit/30cad23a8f282600c9b045e1af09f6f8a65357b1",
    "cve_id": "CVE-2018-1000854",
    "cwe_id": "CWE-74",
    "filename": "esigate-core/src/main/java/org/esigate/xml/XsltRenderer.java",
    "is_vulnerable": 0,
    "class_name": "XsltRenderer",
    "subclass_name": null,
    "function_name": "render(DriverRequest httpRequest, String src, Writer out) throws IOException",
    "function_body": "{\n        try {\n            HtmlDocumentBuilder htmlDocumentBuilder = new HtmlDocumentBuilder();\n            htmlDocumentBuilder.setDoctypeExpectation(DoctypeExpectation.NO_DOCTYPE_ERRORS);\n            Document document = htmlDocumentBuilder.parse(new InputSource(new StringReader(src)));\n            Source source = new DOMSource(document);\n            DOMResult result = new DOMResult();\n            transformer.transform(source, result);\n            XhtmlSerializer serializer = new XhtmlSerializer(out);\n            Dom2Sax dom2Sax = new Dom2Sax(serializer, serializer);\n            dom2Sax.parse(result.getNode());\n        } catch (TransformerException e) {\n            throw new ProcessingFailedException(\"Failed to transform source\", e);\n        } catch (SAXException e) {\n            throw new ProcessingFailedException(\"Failed serialize transformation result\", e);\n        }\n    }"
  },
  {
    "id": 42,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 0,
    "human_patch": "https://github.com/esigate/esigate/commit/30cad23a8f282600c9b045e1af09f6f8a65357b1",
    "cve_id": "CVE-2018-1000854",
    "cwe_id": "CWE-74",
    "filename": "esigate-core/src/test/java/org/esigate/xml/XsltRendererTest.java",
    "is_vulnerable": 1,
    "class_name": "XsltRendererTest",
    "subclass_name": null,
    "function_name": "testXslt() throws IOException",
    "function_body": "{\n        String src = \"<html><body>The body<br></body></html>\";\n        String result = extractBody(src);\n        assertEquals(\"<body>The body<br /></body>\", result);\n    }"
  },
  {
    "id": 42,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 1,
    "human_patch": "https://github.com/esigate/esigate/commit/30cad23a8f282600c9b045e1af09f6f8a65357b1",
    "cve_id": "CVE-2018-1000854",
    "cwe_id": "CWE-74",
    "filename": "esigate-core/src/test/java/org/esigate/xml/XsltRendererTest.java",
    "is_vulnerable": 0,
    "class_name": "XsltRendererTest",
    "subclass_name": null,
    "function_name": "extractBody(String src) throws IOException",
    "function_body": "{\n        String template = \"<?xml version=\\\"1.0\\\"?>\";\n        template +=\n                \"<xsl:stylesheet version=\\\"1.0\\\" xmlns=\\\"http://www.w3.org/1999/xhtml\\\" \"\n                        + \"xmlns:html=\\\"http://www.w3.org/1999/xhtml\\\" \"\n                        + \"xmlns:xsl=\\\"http://www.w3.org/1999/XSL/Transform\\\">\";\n        template += \"<xsl:output method=\\\"xml\\\" omit-xml-declaration=\\\"yes\\\"/>\";\n        template += \"<xsl:template match=\\\"//html:body\\\">\";\n        template += \"<xsl:copy-of select=\\\".\\\"/>\";\n        template += \"</xsl:template>\";\n        template += \"<xsl:template match=\\\"text()\\\"/>\";\n        template += \"</xsl:stylesheet>\";\n        StringBuilderWriter out = new StringBuilderWriter();\n        XsltRenderer tested = new XsltRenderer(template);\n        tested.render(null, src, out);\n        return out.toString();\n    }"
  },
  {
    "id": 42,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 2,
    "human_patch": "https://github.com/esigate/esigate/commit/30cad23a8f282600c9b045e1af09f6f8a65357b1",
    "cve_id": "CVE-2018-1000854",
    "cwe_id": "CWE-74",
    "filename": "esigate-core/src/test/java/org/esigate/xml/XsltRendererTest.java",
    "is_vulnerable": 1,
    "class_name": "XsltRendererTest",
    "subclass_name": null,
    "function_name": "testParserSupportsUnescapedAmpersandCharacter() throws Exception",
    "function_body": "{\n        String src =\n                \"<!DOCTYPE html PUBLIC \\\"-//W3C//DTD XHTML 1.0 Strict//EN\\\" \"\n                        + \"\\\"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd\\\">\"\n                        + \"<html lang=\\\"fr\\\" xml:lang=\\\"fr\\\" xmlns=\\\"http://www.w3.org/1999/xhtml\\\">\"\n                        + \"<head><title>The header</title></head><body>&x=</body></html>\";\n        String result = extractBody(src);\n        assertEquals(\"<body>&amp;x=</body>\", result);\n    }"
  },
  {
    "id": 42,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 3,
    "human_patch": "https://github.com/esigate/esigate/commit/30cad23a8f282600c9b045e1af09f6f8a65357b1",
    "cve_id": "CVE-2018-1000854",
    "cwe_id": "CWE-74",
    "filename": "esigate-core/src/test/java/org/esigate/xml/XsltRendererTest.java",
    "is_vulnerable": 1,
    "class_name": "XsltRendererTest",
    "subclass_name": null,
    "function_name": "testParserSupportsDuplicatedId() throws Exception",
    "function_body": "{\n        String src =\n                \"<!DOCTYPE html PUBLIC \\\"-//W3C//DTD XHTML 1.0 Strict//EN\\\" \"\n                        + \"\\\"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd\\\">\"\n                        + \"<html lang=\\\"fr\\\" xml:lang=\\\"fr\\\" xmlns=\\\"http://www.w3.org/1999/xhtml\\\">\"\n                        + \"<head><title>The header</title></head><body>\"\n                        + \"<span id=\\\"test\\\">a</span><span id=\\\"test\\\">b</span></body></html>\";\n        String result = extractBody(src);\n        assertEquals(\"<body><span id=\\\"test\\\">a</span><span id=\\\"test\\\">b</span></body>\", result);\n    }"
  },
  {
    "id": 43,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 0,
    "human_patch": "https://github.com/FasterXML/jackson-dataformat-xml/commit/f0f19a4c924d9db9a1e2830434061c8640092cc0",
    "cve_id": "CVE-2016-3720",
    "cwe_id": "Not Mapping",
    "filename": "src/main/java/com/fasterxml/jackson/dataformat/xml/XmlFactory.java",
    "is_vulnerable": 0,
    "class_name": "XmlFactory",
    "subclass_name": null,
    "function_name": "_initFactories(XMLInputFactory xmlIn, XMLOutputFactory xmlOut)",
    "function_body": "{\n        \n        xmlOut.setProperty(XMLOutputFactory.IS_REPAIRING_NAMESPACES, Boolean.TRUE);\n        \n        xmlIn.setProperty(XMLInputFactory.IS_COALESCING, Boolean.TRUE);\n    }"
  },
  {
    "id": 43,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 1,
    "human_patch": "https://github.com/FasterXML/jackson-dataformat-xml/commit/f0f19a4c924d9db9a1e2830434061c8640092cc0",
    "cve_id": "CVE-2016-3720",
    "cwe_id": "Not Mapping",
    "filename": "src/main/java/com/fasterxml/jackson/dataformat/xml/XmlFactory.java",
    "is_vulnerable": 0,
    "class_name": "XmlFactory",
    "subclass_name": null,
    "function_name": "copy()",
    "function_body": "{\n        _checkInvalidCopy(XmlFactory.class);\n        return new XmlFactory(this, null);\n    }"
  },
  {
    "id": 43,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 2,
    "human_patch": "https://github.com/FasterXML/jackson-dataformat-xml/commit/f0f19a4c924d9db9a1e2830434061c8640092cc0",
    "cve_id": "CVE-2016-3720",
    "cwe_id": "Not Mapping",
    "filename": "src/main/java/com/fasterxml/jackson/dataformat/xml/XmlFactory.java",
    "is_vulnerable": 0,
    "class_name": "XmlFactory",
    "subclass_name": null,
    "function_name": "version()",
    "function_body": "{\n        return PackageVersion.VERSION;\n    }"
  },
  {
    "id": 43,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 3,
    "human_patch": "https://github.com/FasterXML/jackson-dataformat-xml/commit/f0f19a4c924d9db9a1e2830434061c8640092cc0",
    "cve_id": "CVE-2016-3720",
    "cwe_id": "Not Mapping",
    "filename": "src/main/java/com/fasterxml/jackson/dataformat/xml/XmlFactory.java",
    "is_vulnerable": 0,
    "class_name": "XmlFactory",
    "subclass_name": null,
    "function_name": "readResolve()",
    "function_body": "{\n        if (_jdkXmlInFactory == null) {\n            throw new IllegalStateException(\"No XMLInputFactory class name read during JDK deserialization\");\n        }\n        if (_jdkXmlOutFactory == null) {\n            throw new IllegalStateException(\"No XMLOutputFactory class name read during JDK deserialization\");\n        }\n        try {\n            XMLInputFactory inf = (XMLInputFactory) Class.forName(_jdkXmlInFactory).newInstance();\n            XMLOutputFactory outf = (XMLOutputFactory) Class.forName(_jdkXmlOutFactory).newInstance();\n            return new XmlFactory(_objectCodec, _xmlParserFeatures, _xmlGeneratorFeatures,\n                    inf, outf, _cfgNameForTextElement);\n        } catch (ClassNotFoundException e) {\n            throw new IllegalArgumentException(e);\n        } catch (InstantiationException e) {\n            throw new IllegalArgumentException(e);\n        } catch (IllegalAccessException e) {\n            throw new IllegalArgumentException(e);\n        }\n    }"
  },
  {
    "id": 43,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 4,
    "human_patch": "https://github.com/FasterXML/jackson-dataformat-xml/commit/f0f19a4c924d9db9a1e2830434061c8640092cc0",
    "cve_id": "CVE-2016-3720",
    "cwe_id": "Not Mapping",
    "filename": "src/main/java/com/fasterxml/jackson/dataformat/xml/XmlFactory.java",
    "is_vulnerable": 0,
    "class_name": "XmlFactory",
    "subclass_name": null,
    "function_name": "readObject(ObjectInputStream in) throws IOException, ClassNotFoundException",
    "function_body": "{\n        in.defaultReadObject();\n        _jdkXmlInFactory = in.readUTF();\n        _jdkXmlOutFactory = in.readUTF();\n    }"
  },
  {
    "id": 43,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 5,
    "human_patch": "https://github.com/FasterXML/jackson-dataformat-xml/commit/f0f19a4c924d9db9a1e2830434061c8640092cc0",
    "cve_id": "CVE-2016-3720",
    "cwe_id": "Not Mapping",
    "filename": "src/main/java/com/fasterxml/jackson/dataformat/xml/XmlFactory.java",
    "is_vulnerable": 0,
    "class_name": "XmlFactory",
    "subclass_name": null,
    "function_name": "writeObject(ObjectOutputStream out) throws IOException",
    "function_body": "{\n        out.defaultWriteObject();\n        out.writeUTF(_xmlInputFactory.getClass().getName());\n        out.writeUTF(_xmlOutputFactory.getClass().getName());\n    }"
  },
  {
    "id": 43,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 6,
    "human_patch": "https://github.com/FasterXML/jackson-dataformat-xml/commit/f0f19a4c924d9db9a1e2830434061c8640092cc0",
    "cve_id": "CVE-2016-3720",
    "cwe_id": "Not Mapping",
    "filename": "src/main/java/com/fasterxml/jackson/dataformat/xml/XmlFactory.java",
    "is_vulnerable": 0,
    "class_name": "XmlFactory",
    "subclass_name": null,
    "function_name": "setXMLTextElementName(String name)",
    "function_body": "{\n        _cfgNameForTextElement = name;\n    }"
  },
  {
    "id": 43,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 7,
    "human_patch": "https://github.com/FasterXML/jackson-dataformat-xml/commit/f0f19a4c924d9db9a1e2830434061c8640092cc0",
    "cve_id": "CVE-2016-3720",
    "cwe_id": "Not Mapping",
    "filename": "src/main/java/com/fasterxml/jackson/dataformat/xml/XmlFactory.java",
    "is_vulnerable": 0,
    "class_name": "XmlFactory",
    "subclass_name": null,
    "function_name": "getXMLTextElementName()",
    "function_body": "{\n        return _cfgNameForTextElement;\n    }"
  },
  {
    "id": 43,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 8,
    "human_patch": "https://github.com/FasterXML/jackson-dataformat-xml/commit/f0f19a4c924d9db9a1e2830434061c8640092cc0",
    "cve_id": "CVE-2016-3720",
    "cwe_id": "Not Mapping",
    "filename": "src/main/java/com/fasterxml/jackson/dataformat/xml/XmlFactory.java",
    "is_vulnerable": 0,
    "class_name": "XmlFactory",
    "subclass_name": null,
    "function_name": "configure(FromXmlParser.Feature f, boolean state)",
    "function_body": "{\n        if (state) {\n            enable(f);\n        } else {\n            disable(f);\n        }\n        return this;\n    }"
  },
  {
    "id": 43,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 9,
    "human_patch": "https://github.com/FasterXML/jackson-dataformat-xml/commit/f0f19a4c924d9db9a1e2830434061c8640092cc0",
    "cve_id": "CVE-2016-3720",
    "cwe_id": "Not Mapping",
    "filename": "src/main/java/com/fasterxml/jackson/dataformat/xml/XmlFactory.java",
    "is_vulnerable": 0,
    "class_name": "XmlFactory",
    "subclass_name": null,
    "function_name": "enable(FromXmlParser.Feature f)",
    "function_body": "{\n        _xmlParserFeatures |= f.getMask();\n        return this;\n    }"
  },
  {
    "id": 43,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 10,
    "human_patch": "https://github.com/FasterXML/jackson-dataformat-xml/commit/f0f19a4c924d9db9a1e2830434061c8640092cc0",
    "cve_id": "CVE-2016-3720",
    "cwe_id": "Not Mapping",
    "filename": "src/main/java/com/fasterxml/jackson/dataformat/xml/XmlFactory.java",
    "is_vulnerable": 0,
    "class_name": "XmlFactory",
    "subclass_name": null,
    "function_name": "disable(FromXmlParser.Feature f)",
    "function_body": "{\n        _xmlParserFeatures &= ~f.getMask();\n        return this;\n    }"
  },
  {
    "id": 43,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 11,
    "human_patch": "https://github.com/FasterXML/jackson-dataformat-xml/commit/f0f19a4c924d9db9a1e2830434061c8640092cc0",
    "cve_id": "CVE-2016-3720",
    "cwe_id": "Not Mapping",
    "filename": "src/main/java/com/fasterxml/jackson/dataformat/xml/XmlFactory.java",
    "is_vulnerable": 0,
    "class_name": "XmlFactory",
    "subclass_name": null,
    "function_name": "isEnabled(FromXmlParser.Feature f)",
    "function_body": "{\n        return (_xmlParserFeatures & f.getMask()) != 0;\n    }"
  },
  {
    "id": 43,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 12,
    "human_patch": "https://github.com/FasterXML/jackson-dataformat-xml/commit/f0f19a4c924d9db9a1e2830434061c8640092cc0",
    "cve_id": "CVE-2016-3720",
    "cwe_id": "Not Mapping",
    "filename": "src/main/java/com/fasterxml/jackson/dataformat/xml/XmlFactory.java",
    "is_vulnerable": 0,
    "class_name": "XmlFactory",
    "subclass_name": null,
    "function_name": "configure(ToXmlGenerator.Feature f, boolean state)",
    "function_body": "{\n        if (state) {\n            enable(f);\n        } else {\n            disable(f);\n        }\n        return this;\n    }"
  },
  {
    "id": 43,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 13,
    "human_patch": "https://github.com/FasterXML/jackson-dataformat-xml/commit/f0f19a4c924d9db9a1e2830434061c8640092cc0",
    "cve_id": "CVE-2016-3720",
    "cwe_id": "Not Mapping",
    "filename": "src/main/java/com/fasterxml/jackson/dataformat/xml/XmlFactory.java",
    "is_vulnerable": 0,
    "class_name": "XmlFactory",
    "subclass_name": null,
    "function_name": "enable(ToXmlGenerator.Feature f)",
    "function_body": "{\n        _xmlGeneratorFeatures |= f.getMask();\n        return this;\n    }"
  },
  {
    "id": 43,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 14,
    "human_patch": "https://github.com/FasterXML/jackson-dataformat-xml/commit/f0f19a4c924d9db9a1e2830434061c8640092cc0",
    "cve_id": "CVE-2016-3720",
    "cwe_id": "Not Mapping",
    "filename": "src/main/java/com/fasterxml/jackson/dataformat/xml/XmlFactory.java",
    "is_vulnerable": 0,
    "class_name": "XmlFactory",
    "subclass_name": null,
    "function_name": "disable(ToXmlGenerator.Feature f)",
    "function_body": "{\n        _xmlGeneratorFeatures &= ~f.getMask();\n        return this;\n    }"
  },
  {
    "id": 43,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 15,
    "human_patch": "https://github.com/FasterXML/jackson-dataformat-xml/commit/f0f19a4c924d9db9a1e2830434061c8640092cc0",
    "cve_id": "CVE-2016-3720",
    "cwe_id": "Not Mapping",
    "filename": "src/main/java/com/fasterxml/jackson/dataformat/xml/XmlFactory.java",
    "is_vulnerable": 0,
    "class_name": "XmlFactory",
    "subclass_name": null,
    "function_name": "isEnabled(ToXmlGenerator.Feature f)",
    "function_body": "{\n        return (_xmlGeneratorFeatures & f.getMask()) != 0;\n    }"
  },
  {
    "id": 43,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 16,
    "human_patch": "https://github.com/FasterXML/jackson-dataformat-xml/commit/f0f19a4c924d9db9a1e2830434061c8640092cc0",
    "cve_id": "CVE-2016-3720",
    "cwe_id": "Not Mapping",
    "filename": "src/main/java/com/fasterxml/jackson/dataformat/xml/XmlFactory.java",
    "is_vulnerable": 0,
    "class_name": "XmlFactory",
    "subclass_name": null,
    "function_name": "getXMLInputFactory()",
    "function_body": "{\n        return _xmlInputFactory;\n    }"
  },
  {
    "id": 43,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 17,
    "human_patch": "https://github.com/FasterXML/jackson-dataformat-xml/commit/f0f19a4c924d9db9a1e2830434061c8640092cc0",
    "cve_id": "CVE-2016-3720",
    "cwe_id": "Not Mapping",
    "filename": "src/main/java/com/fasterxml/jackson/dataformat/xml/XmlFactory.java",
    "is_vulnerable": 0,
    "class_name": "XmlFactory",
    "subclass_name": null,
    "function_name": "setXMLInputFactory(XMLInputFactory f)",
    "function_body": "{\n        _xmlInputFactory = f;\n    }"
  },
  {
    "id": 43,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 18,
    "human_patch": "https://github.com/FasterXML/jackson-dataformat-xml/commit/f0f19a4c924d9db9a1e2830434061c8640092cc0",
    "cve_id": "CVE-2016-3720",
    "cwe_id": "Not Mapping",
    "filename": "src/main/java/com/fasterxml/jackson/dataformat/xml/XmlFactory.java",
    "is_vulnerable": 0,
    "class_name": "XmlFactory",
    "subclass_name": null,
    "function_name": "getXMLOutputFactory()",
    "function_body": "{\n        return _xmlOutputFactory;\n    }"
  },
  {
    "id": 43,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 19,
    "human_patch": "https://github.com/FasterXML/jackson-dataformat-xml/commit/f0f19a4c924d9db9a1e2830434061c8640092cc0",
    "cve_id": "CVE-2016-3720",
    "cwe_id": "Not Mapping",
    "filename": "src/main/java/com/fasterxml/jackson/dataformat/xml/XmlFactory.java",
    "is_vulnerable": 0,
    "class_name": "XmlFactory",
    "subclass_name": null,
    "function_name": "setXMLOutputFactory(XMLOutputFactory f)",
    "function_body": "{\n        _xmlOutputFactory = f;\n    }"
  },
  {
    "id": 43,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 20,
    "human_patch": "https://github.com/FasterXML/jackson-dataformat-xml/commit/f0f19a4c924d9db9a1e2830434061c8640092cc0",
    "cve_id": "CVE-2016-3720",
    "cwe_id": "Not Mapping",
    "filename": "src/main/java/com/fasterxml/jackson/dataformat/xml/XmlFactory.java",
    "is_vulnerable": 0,
    "class_name": "XmlFactory",
    "subclass_name": null,
    "function_name": "getFormatName()",
    "function_body": "{\n        return FORMAT_NAME_XML;\n    }"
  },
  {
    "id": 43,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 21,
    "human_patch": "https://github.com/FasterXML/jackson-dataformat-xml/commit/f0f19a4c924d9db9a1e2830434061c8640092cc0",
    "cve_id": "CVE-2016-3720",
    "cwe_id": "Not Mapping",
    "filename": "src/main/java/com/fasterxml/jackson/dataformat/xml/XmlFactory.java",
    "is_vulnerable": 0,
    "class_name": "XmlFactory",
    "subclass_name": null,
    "function_name": "hasFormat(InputAccessor acc) throws IOException",
    "function_body": "{\n        return hasXMLFormat(acc);\n    }"
  },
  {
    "id": 43,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 22,
    "human_patch": "https://github.com/FasterXML/jackson-dataformat-xml/commit/f0f19a4c924d9db9a1e2830434061c8640092cc0",
    "cve_id": "CVE-2016-3720",
    "cwe_id": "Not Mapping",
    "filename": "src/main/java/com/fasterxml/jackson/dataformat/xml/XmlFactory.java",
    "is_vulnerable": 0,
    "class_name": "XmlFactory",
    "subclass_name": null,
    "function_name": "requiresCustomCodec()",
    "function_body": "{ return true; }"
  },
  {
    "id": 43,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 23,
    "human_patch": "https://github.com/FasterXML/jackson-dataformat-xml/commit/f0f19a4c924d9db9a1e2830434061c8640092cc0",
    "cve_id": "CVE-2016-3720",
    "cwe_id": "Not Mapping",
    "filename": "src/main/java/com/fasterxml/jackson/dataformat/xml/XmlFactory.java",
    "is_vulnerable": 0,
    "class_name": "XmlFactory",
    "subclass_name": null,
    "function_name": "canUseCharArrays()",
    "function_body": "{ return false; }"
  },
  {
    "id": 43,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 24,
    "human_patch": "https://github.com/FasterXML/jackson-dataformat-xml/commit/f0f19a4c924d9db9a1e2830434061c8640092cc0",
    "cve_id": "CVE-2016-3720",
    "cwe_id": "Not Mapping",
    "filename": "src/main/java/com/fasterxml/jackson/dataformat/xml/XmlFactory.java",
    "is_vulnerable": 0,
    "class_name": "XmlFactory",
    "subclass_name": null,
    "function_name": "getFormatReadFeatureType()",
    "function_body": "{\n        return FromXmlParser.Feature.class;\n    }"
  },
  {
    "id": 43,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 25,
    "human_patch": "https://github.com/FasterXML/jackson-dataformat-xml/commit/f0f19a4c924d9db9a1e2830434061c8640092cc0",
    "cve_id": "CVE-2016-3720",
    "cwe_id": "Not Mapping",
    "filename": "src/main/java/com/fasterxml/jackson/dataformat/xml/XmlFactory.java",
    "is_vulnerable": 0,
    "class_name": "XmlFactory",
    "subclass_name": null,
    "function_name": "getFormatWriteFeatureType()",
    "function_body": "{\n        return ToXmlGenerator.Feature.class;\n    }"
  },
  {
    "id": 43,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 26,
    "human_patch": "https://github.com/FasterXML/jackson-dataformat-xml/commit/f0f19a4c924d9db9a1e2830434061c8640092cc0",
    "cve_id": "CVE-2016-3720",
    "cwe_id": "Not Mapping",
    "filename": "src/main/java/com/fasterxml/jackson/dataformat/xml/XmlFactory.java",
    "is_vulnerable": 0,
    "class_name": "XmlFactory",
    "subclass_name": null,
    "function_name": "createParser(String content) throws IOException",
    "function_body": "{\n        Reader r = new StringReader(content);\n        IOContext ctxt = _createContext(r, true);\n        if (_inputDecorator != null) {\n            r = _inputDecorator.decorate(ctxt, r);\n        }\n        return _createParser(r, ctxt);\n    }"
  },
  {
    "id": 43,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 27,
    "human_patch": "https://github.com/FasterXML/jackson-dataformat-xml/commit/f0f19a4c924d9db9a1e2830434061c8640092cc0",
    "cve_id": "CVE-2016-3720",
    "cwe_id": "Not Mapping",
    "filename": "src/main/java/com/fasterxml/jackson/dataformat/xml/XmlFactory.java",
    "is_vulnerable": 0,
    "class_name": "XmlFactory",
    "subclass_name": null,
    "function_name": "createGenerator(OutputStream out) throws IOException",
    "function_body": "{\n        return createGenerator(out, JsonEncoding.UTF8);\n    }"
  },
  {
    "id": 43,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 28,
    "human_patch": "https://github.com/FasterXML/jackson-dataformat-xml/commit/f0f19a4c924d9db9a1e2830434061c8640092cc0",
    "cve_id": "CVE-2016-3720",
    "cwe_id": "Not Mapping",
    "filename": "src/main/java/com/fasterxml/jackson/dataformat/xml/XmlFactory.java",
    "is_vulnerable": 0,
    "class_name": "XmlFactory",
    "subclass_name": null,
    "function_name": "createGenerator(OutputStream out, JsonEncoding enc) throws IOException",
    "function_body": "{\n        \n        IOContext ctxt = _createContext(out, false);\n        ctxt.setEncoding(enc);\n        return new ToXmlGenerator(ctxt,\n                _generatorFeatures, _xmlGeneratorFeatures,\n                _objectCodec, _createXmlWriter(out));\n    }"
  },
  {
    "id": 43,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 29,
    "human_patch": "https://github.com/FasterXML/jackson-dataformat-xml/commit/f0f19a4c924d9db9a1e2830434061c8640092cc0",
    "cve_id": "CVE-2016-3720",
    "cwe_id": "Not Mapping",
    "filename": "src/main/java/com/fasterxml/jackson/dataformat/xml/XmlFactory.java",
    "is_vulnerable": 0,
    "class_name": "XmlFactory",
    "subclass_name": null,
    "function_name": "createGenerator(Writer out) throws IOException",
    "function_body": "{\n        return new ToXmlGenerator(_createContext(out, false),\n                _generatorFeatures, _xmlGeneratorFeatures,\n                _objectCodec, _createXmlWriter(out));\n    }"
  },
  {
    "id": 43,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 30,
    "human_patch": "https://github.com/FasterXML/jackson-dataformat-xml/commit/f0f19a4c924d9db9a1e2830434061c8640092cc0",
    "cve_id": "CVE-2016-3720",
    "cwe_id": "Not Mapping",
    "filename": "src/main/java/com/fasterxml/jackson/dataformat/xml/XmlFactory.java",
    "is_vulnerable": 0,
    "class_name": "XmlFactory",
    "subclass_name": null,
    "function_name": "createGenerator(File f, JsonEncoding enc) throws IOException",
    "function_body": "{\n        OutputStream out = new FileOutputStream(f);\n        \n        IOContext ctxt = _createContext(out, true);\n        ctxt.setEncoding(enc);\n        return new ToXmlGenerator(ctxt, _generatorFeatures, _xmlGeneratorFeatures,\n                _objectCodec, _createXmlWriter(out));\n    }"
  },
  {
    "id": 43,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 31,
    "human_patch": "https://github.com/FasterXML/jackson-dataformat-xml/commit/f0f19a4c924d9db9a1e2830434061c8640092cc0",
    "cve_id": "CVE-2016-3720",
    "cwe_id": "Not Mapping",
    "filename": "src/main/java/com/fasterxml/jackson/dataformat/xml/XmlFactory.java",
    "is_vulnerable": 0,
    "class_name": "XmlFactory",
    "subclass_name": null,
    "function_name": "createParser(XMLStreamReader sr) throws IOException",
    "function_body": "{\n        \n        if (sr.getEventType() != XMLStreamConstants.START_ELEMENT) {\n            try {\n                sr = _initializeXmlReader(sr);\n            } catch (XMLStreamException e) {\n                return StaxUtil.throwXmlAsIOException(e);\n            }\n        }\n\n        \n        FromXmlParser xp = new FromXmlParser(_createContext(sr, false),\n                _generatorFeatures, _xmlGeneratorFeatures, _objectCodec, sr);\n        if (_cfgNameForTextElement != null) {\n            xp.setXMLTextElementName(_cfgNameForTextElement);\n        }\n        return xp;\n    }"
  },
  {
    "id": 43,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 32,
    "human_patch": "https://github.com/FasterXML/jackson-dataformat-xml/commit/f0f19a4c924d9db9a1e2830434061c8640092cc0",
    "cve_id": "CVE-2016-3720",
    "cwe_id": "Not Mapping",
    "filename": "src/main/java/com/fasterxml/jackson/dataformat/xml/XmlFactory.java",
    "is_vulnerable": 0,
    "class_name": "XmlFactory",
    "subclass_name": null,
    "function_name": "createGenerator(XMLStreamWriter sw) throws IOException",
    "function_body": "{\n        try {\n            sw = _initializeXmlWriter(sw);\n        } catch (XMLStreamException e) {\n            return StaxUtil.throwXmlAsIOException(e);\n        }\n        IOContext ctxt = _createContext(sw, false);\n        return new ToXmlGenerator(ctxt, _generatorFeatures, _xmlGeneratorFeatures,\n                _objectCodec, sw);\n    }"
  },
  {
    "id": 43,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 33,
    "human_patch": "https://github.com/FasterXML/jackson-dataformat-xml/commit/f0f19a4c924d9db9a1e2830434061c8640092cc0",
    "cve_id": "CVE-2016-3720",
    "cwe_id": "Not Mapping",
    "filename": "src/main/java/com/fasterxml/jackson/dataformat/xml/XmlFactory.java",
    "is_vulnerable": 0,
    "class_name": "XmlFactory",
    "subclass_name": null,
    "function_name": "_createParser(InputStream in, IOContext ctxt) throws IOException",
    "function_body": "{\n        XMLStreamReader sr;\n        try {\n            sr = _xmlInputFactory.createXMLStreamReader(in);\n            sr = _initializeXmlReader(sr);\n        } catch (XMLStreamException e) {\n            return StaxUtil.throwXmlAsIOException(e);\n        }\n        FromXmlParser xp = new FromXmlParser(ctxt, _generatorFeatures, _xmlGeneratorFeatures,\n                _objectCodec, sr);\n        if (_cfgNameForTextElement != null) {\n            xp.setXMLTextElementName(_cfgNameForTextElement);\n        }\n        return xp;\n    }"
  },
  {
    "id": 43,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 34,
    "human_patch": "https://github.com/FasterXML/jackson-dataformat-xml/commit/f0f19a4c924d9db9a1e2830434061c8640092cc0",
    "cve_id": "CVE-2016-3720",
    "cwe_id": "Not Mapping",
    "filename": "src/main/java/com/fasterxml/jackson/dataformat/xml/XmlFactory.java",
    "is_vulnerable": 0,
    "class_name": "XmlFactory",
    "subclass_name": null,
    "function_name": "_createParser(Reader r, IOContext ctxt) throws IOException",
    "function_body": "{\n        XMLStreamReader sr;\n        try {\n            sr = _xmlInputFactory.createXMLStreamReader(r);\n            sr = _initializeXmlReader(sr);\n        } catch (XMLStreamException e) {\n            return StaxUtil.throwXmlAsIOException(e);\n        }\n        FromXmlParser xp = new FromXmlParser(ctxt, _generatorFeatures, _xmlGeneratorFeatures,\n                _objectCodec, sr);\n        if (_cfgNameForTextElement != null) {\n            xp.setXMLTextElementName(_cfgNameForTextElement);\n        }\n        return xp;\n    }"
  },
  {
    "id": 43,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 35,
    "human_patch": "https://github.com/FasterXML/jackson-dataformat-xml/commit/f0f19a4c924d9db9a1e2830434061c8640092cc0",
    "cve_id": "CVE-2016-3720",
    "cwe_id": "Not Mapping",
    "filename": "src/main/java/com/fasterxml/jackson/dataformat/xml/XmlFactory.java",
    "is_vulnerable": 0,
    "class_name": "XmlFactory",
    "subclass_name": null,
    "function_name": "_createParser(char[] data, int offset, int len, IOContext ctxt,\n            boolean recycleBuffer) throws IOException",
    "function_body": "{\n        \n        \n        XMLStreamReader sr;\n        try {\n            sr = _xmlInputFactory.createXMLStreamReader(new Stax2CharArraySource(data, offset, len));\n            sr = _initializeXmlReader(sr);\n        } catch (XMLStreamException e) {\n            return StaxUtil.throwXmlAsIOException(e);\n        }\n        FromXmlParser xp = new FromXmlParser(ctxt, _generatorFeatures, _xmlGeneratorFeatures,\n                _objectCodec, sr);\n        if (_cfgNameForTextElement != null) {\n            xp.setXMLTextElementName(_cfgNameForTextElement);\n        }\n        return xp;\n    }"
  },
  {
    "id": 43,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 36,
    "human_patch": "https://github.com/FasterXML/jackson-dataformat-xml/commit/f0f19a4c924d9db9a1e2830434061c8640092cc0",
    "cve_id": "CVE-2016-3720",
    "cwe_id": "Not Mapping",
    "filename": "src/main/java/com/fasterxml/jackson/dataformat/xml/XmlFactory.java",
    "is_vulnerable": 0,
    "class_name": "XmlFactory",
    "subclass_name": null,
    "function_name": "_createParser(byte[] data, int offset, int len, IOContext ctxt) throws IOException",
    "function_body": "{\n        XMLStreamReader sr;\n        try {\n            sr = _xmlInputFactory.createXMLStreamReader(new Stax2ByteArraySource(data, offset, len));\n            sr = _initializeXmlReader(sr);\n        } catch (XMLStreamException e) {\n            return StaxUtil.throwXmlAsIOException(e);\n        }\n        FromXmlParser xp = new FromXmlParser(ctxt, _generatorFeatures, _xmlGeneratorFeatures,\n                _objectCodec, sr);\n        if (_cfgNameForTextElement != null) {\n            xp.setXMLTextElementName(_cfgNameForTextElement);\n        }\n        return xp;\n    }"
  },
  {
    "id": 43,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 37,
    "human_patch": "https://github.com/FasterXML/jackson-dataformat-xml/commit/f0f19a4c924d9db9a1e2830434061c8640092cc0",
    "cve_id": "CVE-2016-3720",
    "cwe_id": "Not Mapping",
    "filename": "src/main/java/com/fasterxml/jackson/dataformat/xml/XmlFactory.java",
    "is_vulnerable": 0,
    "class_name": "XmlFactory",
    "subclass_name": null,
    "function_name": "_createGenerator(Writer out, IOContext ctxt) throws IOException",
    "function_body": "{\n        \n        VersionUtil.throwInternal();\n        return null;\n    }"
  },
  {
    "id": 43,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 38,
    "human_patch": "https://github.com/FasterXML/jackson-dataformat-xml/commit/f0f19a4c924d9db9a1e2830434061c8640092cc0",
    "cve_id": "CVE-2016-3720",
    "cwe_id": "Not Mapping",
    "filename": "src/main/java/com/fasterxml/jackson/dataformat/xml/XmlFactory.java",
    "is_vulnerable": 0,
    "class_name": "XmlFactory",
    "subclass_name": null,
    "function_name": "_createXmlWriter(OutputStream out) throws IOException",
    "function_body": "{\n        try {\n            return _initializeXmlWriter(_xmlOutputFactory.createXMLStreamWriter(out, \"UTF-8\"));\n        } catch (XMLStreamException e) {\n            return StaxUtil.throwXmlAsIOException(e);\n        }\n    }"
  },
  {
    "id": 43,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 39,
    "human_patch": "https://github.com/FasterXML/jackson-dataformat-xml/commit/f0f19a4c924d9db9a1e2830434061c8640092cc0",
    "cve_id": "CVE-2016-3720",
    "cwe_id": "Not Mapping",
    "filename": "src/main/java/com/fasterxml/jackson/dataformat/xml/XmlFactory.java",
    "is_vulnerable": 0,
    "class_name": "XmlFactory",
    "subclass_name": null,
    "function_name": "_createXmlWriter(Writer w) throws IOException",
    "function_body": "{\n        try {\n            return _initializeXmlWriter(_xmlOutputFactory.createXMLStreamWriter(w));\n        } catch (XMLStreamException e) {\n            return StaxUtil.throwXmlAsIOException(e);\n        }\n    }"
  },
  {
    "id": 43,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 40,
    "human_patch": "https://github.com/FasterXML/jackson-dataformat-xml/commit/f0f19a4c924d9db9a1e2830434061c8640092cc0",
    "cve_id": "CVE-2016-3720",
    "cwe_id": "Not Mapping",
    "filename": "src/main/java/com/fasterxml/jackson/dataformat/xml/XmlFactory.java",
    "is_vulnerable": 0,
    "class_name": "XmlFactory",
    "subclass_name": null,
    "function_name": "_initializeXmlWriter(XMLStreamWriter sw) throws IOException, XMLStreamException",
    "function_body": "{\n        \n        \n        sw.setDefaultNamespace(\"\");\n        return sw;\n    }"
  },
  {
    "id": 43,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 41,
    "human_patch": "https://github.com/FasterXML/jackson-dataformat-xml/commit/f0f19a4c924d9db9a1e2830434061c8640092cc0",
    "cve_id": "CVE-2016-3720",
    "cwe_id": "Not Mapping",
    "filename": "src/main/java/com/fasterxml/jackson/dataformat/xml/XmlFactory.java",
    "is_vulnerable": 0,
    "class_name": "XmlFactory",
    "subclass_name": null,
    "function_name": "_initializeXmlReader(XMLStreamReader sr) throws IOException, XMLStreamException",
    "function_body": "{\n        \n        while (sr.next() != XMLStreamConstants.START_ELEMENT) {\n            ;\n        }\n        return sr;\n    }"
  },
  {
    "id": 43,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 42,
    "human_patch": "https://github.com/FasterXML/jackson-dataformat-xml/commit/f0f19a4c924d9db9a1e2830434061c8640092cc0",
    "cve_id": "CVE-2016-3720",
    "cwe_id": "Not Mapping",
    "filename": "src/main/java/com/fasterxml/jackson/dataformat/xml/XmlFactory.java",
    "is_vulnerable": 0,
    "class_name": "XmlFactory",
    "subclass_name": null,
    "function_name": "hasXMLFormat(InputAccessor acc) throws IOException",
    "function_body": "{\n        \n        if (!acc.hasMoreBytes()) {\n            return MatchStrength.INCONCLUSIVE;\n        }\n        byte b = acc.nextByte();\n        \n        if (b == UTF8_BOM_1) { \n            if (!acc.hasMoreBytes()) {\n                return MatchStrength.INCONCLUSIVE;\n            }\n            if (acc.nextByte() != UTF8_BOM_2) {\n                return MatchStrength.NO_MATCH;\n            }\n            if (!acc.hasMoreBytes()) {\n                return MatchStrength.INCONCLUSIVE;\n            }\n            if (acc.nextByte() != UTF8_BOM_3) {\n                return MatchStrength.NO_MATCH;\n            }\n            if (!acc.hasMoreBytes()) {\n                return MatchStrength.INCONCLUSIVE;\n            }\n            b = acc.nextByte();\n        }\n        \n        boolean maybeXmlDecl = (b == BYTE_LT);\n        if (!maybeXmlDecl) {\n            int ch = skipSpace(acc, b);\n            if (ch < 0) {\n                return MatchStrength.INCONCLUSIVE;\n            }\n            b = (byte) ch;\n            \n           if (b != BYTE_LT) {\n                return MatchStrength.NO_MATCH;\n            }\n        }\n        if (!acc.hasMoreBytes()) {\n            return MatchStrength.INCONCLUSIVE;\n        }\n        b = acc.nextByte();\n        \n        if (b == BYTE_QMARK) { \n            b = acc.nextByte();\n            if (b == BYTE_x) {\n                if (maybeXmlDecl) {\n                    if (acc.hasMoreBytes() && acc.nextByte() == BYTE_m) {\n                        if (acc.hasMoreBytes() && acc.nextByte() == BYTE_l) {\n                            return MatchStrength.FULL_MATCH;\n                        }\n                    }\n                }\n                \n                return MatchStrength.SOLID_MATCH;\n            }\n            \n            if (validXmlNameStartChar(acc, b)) {\n                return MatchStrength.SOLID_MATCH;\n            }\n        } else if (b == BYTE_EXCL) {\n            \n            if (!acc.hasMoreBytes()) {\n                return MatchStrength.INCONCLUSIVE;\n            }\n            b = acc.nextByte();\n            if (b == BYTE_HYPHEN) {\n                if (!acc.hasMoreBytes()) {\n                    return MatchStrength.INCONCLUSIVE;\n                }\n                if (acc.nextByte() == BYTE_HYPHEN) {\n                    return MatchStrength.SOLID_MATCH;\n                }\n            } else if (b == BYTE_D) {\n                return tryMatch(acc, \"OCTYPE\", MatchStrength.SOLID_MATCH);\n            }\n        } else {\n            \n            if (validXmlNameStartChar(acc, b)) {\n                return MatchStrength.SOLID_MATCH;\n            }\n        }\n        return MatchStrength.NO_MATCH;\n    }"
  },
  {
    "id": 43,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 43,
    "human_patch": "https://github.com/FasterXML/jackson-dataformat-xml/commit/f0f19a4c924d9db9a1e2830434061c8640092cc0",
    "cve_id": "CVE-2016-3720",
    "cwe_id": "Not Mapping",
    "filename": "src/main/java/com/fasterxml/jackson/dataformat/xml/XmlFactory.java",
    "is_vulnerable": 0,
    "class_name": "XmlFactory",
    "subclass_name": null,
    "function_name": "validXmlNameStartChar(InputAccessor acc, byte b) throws IOException",
    "function_body": "{\n        \n        int ch = (int) b & 0xFF;\n        if (ch >= 'A') { \n            \n            return true;\n        }\n        return false;\n    }"
  },
  {
    "id": 43,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 44,
    "human_patch": "https://github.com/FasterXML/jackson-dataformat-xml/commit/f0f19a4c924d9db9a1e2830434061c8640092cc0",
    "cve_id": "CVE-2016-3720",
    "cwe_id": "Not Mapping",
    "filename": "src/main/java/com/fasterxml/jackson/dataformat/xml/XmlFactory.java",
    "is_vulnerable": 0,
    "class_name": "XmlFactory",
    "subclass_name": null,
    "function_name": "tryMatch(InputAccessor acc, String matchStr, MatchStrength fullMatchStrength) throws IOException",
    "function_body": "{\n        for (int i = 0, len = matchStr.length(); i < len; ++i) {\n            if (!acc.hasMoreBytes()) {\n                return MatchStrength.INCONCLUSIVE;\n            }\n            if (acc.nextByte() != matchStr.charAt(i)) {\n                return MatchStrength.NO_MATCH;\n            }\n        }\n        return fullMatchStrength;\n    }"
  },
  {
    "id": 43,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 45,
    "human_patch": "https://github.com/FasterXML/jackson-dataformat-xml/commit/f0f19a4c924d9db9a1e2830434061c8640092cc0",
    "cve_id": "CVE-2016-3720",
    "cwe_id": "Not Mapping",
    "filename": "src/main/java/com/fasterxml/jackson/dataformat/xml/XmlFactory.java",
    "is_vulnerable": 0,
    "class_name": "XmlFactory",
    "subclass_name": null,
    "function_name": "skipSpace(InputAccessor acc, byte b) throws IOException",
    "function_body": "{\n        while (true) {\n            int ch = (int) b & 0xFF;\n            if (!(ch == ' ' || ch == '\\r' || ch == '\\n' || ch == '\\t')) {\n                return ch;\n            }\n            if (!acc.hasMoreBytes()) {\n                return -1;\n            }\n            b = acc.nextByte();\n            ch = (int) b & 0xFF;\n        }\n    }"
  },
  {
    "id": 44,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 0,
    "human_patch": "https://github.com/FasterXML/jackson-dataformat-xml/commit/eeff2c312e9d4caa8c9f27b8f740c7529d00524a",
    "cve_id": "CVE-2016-7051",
    "cwe_id": "CWE-611",
    "filename": "src/main/java/com/fasterxml/jackson/dataformat/xml/XmlFactory.java",
    "is_vulnerable": 0,
    "class_name": "XmlFactory",
    "subclass_name": null,
    "function_name": "_initFactories(XMLInputFactory xmlIn, XMLOutputFactory xmlOut)",
    "function_body": "{\n        \n        xmlOut.setProperty(XMLOutputFactory.IS_REPAIRING_NAMESPACES, Boolean.TRUE);\n        \n        xmlIn.setProperty(XMLInputFactory.IS_COALESCING, Boolean.TRUE);\n    }"
  },
  {
    "id": 44,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 1,
    "human_patch": "https://github.com/FasterXML/jackson-dataformat-xml/commit/eeff2c312e9d4caa8c9f27b8f740c7529d00524a",
    "cve_id": "CVE-2016-7051",
    "cwe_id": "CWE-611",
    "filename": "src/main/java/com/fasterxml/jackson/dataformat/xml/XmlFactory.java",
    "is_vulnerable": 0,
    "class_name": "XmlFactory",
    "subclass_name": null,
    "function_name": "copy()",
    "function_body": "{\n        _checkInvalidCopy(XmlFactory.class);\n        return new XmlFactory(this, null);\n    }"
  },
  {
    "id": 44,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 2,
    "human_patch": "https://github.com/FasterXML/jackson-dataformat-xml/commit/eeff2c312e9d4caa8c9f27b8f740c7529d00524a",
    "cve_id": "CVE-2016-7051",
    "cwe_id": "CWE-611",
    "filename": "src/main/java/com/fasterxml/jackson/dataformat/xml/XmlFactory.java",
    "is_vulnerable": 0,
    "class_name": "XmlFactory",
    "subclass_name": null,
    "function_name": "version()",
    "function_body": "{\n        return PackageVersion.VERSION;\n    }"
  },
  {
    "id": 44,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 3,
    "human_patch": "https://github.com/FasterXML/jackson-dataformat-xml/commit/eeff2c312e9d4caa8c9f27b8f740c7529d00524a",
    "cve_id": "CVE-2016-7051",
    "cwe_id": "CWE-611",
    "filename": "src/main/java/com/fasterxml/jackson/dataformat/xml/XmlFactory.java",
    "is_vulnerable": 0,
    "class_name": "XmlFactory",
    "subclass_name": null,
    "function_name": "readResolve()",
    "function_body": "{\n        if (_jdkXmlInFactory == null) {\n            throw new IllegalStateException(\"No XMLInputFactory class name read during JDK deserialization\");\n        }\n        if (_jdkXmlOutFactory == null) {\n            throw new IllegalStateException(\"No XMLOutputFactory class name read during JDK deserialization\");\n        }\n        try {\n            XMLInputFactory inf = (XMLInputFactory) Class.forName(_jdkXmlInFactory).newInstance();\n            XMLOutputFactory outf = (XMLOutputFactory) Class.forName(_jdkXmlOutFactory).newInstance();\n            return new XmlFactory(_objectCodec, _xmlParserFeatures, _xmlGeneratorFeatures,\n                    inf, outf, _cfgNameForTextElement);\n        } catch (ClassNotFoundException e) {\n            throw new IllegalArgumentException(e);\n        } catch (InstantiationException e) {\n            throw new IllegalArgumentException(e);\n        } catch (IllegalAccessException e) {\n            throw new IllegalArgumentException(e);\n        }\n    }"
  },
  {
    "id": 44,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 4,
    "human_patch": "https://github.com/FasterXML/jackson-dataformat-xml/commit/eeff2c312e9d4caa8c9f27b8f740c7529d00524a",
    "cve_id": "CVE-2016-7051",
    "cwe_id": "CWE-611",
    "filename": "src/main/java/com/fasterxml/jackson/dataformat/xml/XmlFactory.java",
    "is_vulnerable": 0,
    "class_name": "XmlFactory",
    "subclass_name": null,
    "function_name": "readObject(ObjectInputStream in) throws IOException, ClassNotFoundException",
    "function_body": "{\n        in.defaultReadObject();\n        _jdkXmlInFactory = in.readUTF();\n        _jdkXmlOutFactory = in.readUTF();\n    }"
  },
  {
    "id": 44,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 5,
    "human_patch": "https://github.com/FasterXML/jackson-dataformat-xml/commit/eeff2c312e9d4caa8c9f27b8f740c7529d00524a",
    "cve_id": "CVE-2016-7051",
    "cwe_id": "CWE-611",
    "filename": "src/main/java/com/fasterxml/jackson/dataformat/xml/XmlFactory.java",
    "is_vulnerable": 0,
    "class_name": "XmlFactory",
    "subclass_name": null,
    "function_name": "writeObject(ObjectOutputStream out) throws IOException",
    "function_body": "{\n        out.defaultWriteObject();\n        out.writeUTF(_xmlInputFactory.getClass().getName());\n        out.writeUTF(_xmlOutputFactory.getClass().getName());\n    }"
  },
  {
    "id": 44,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 6,
    "human_patch": "https://github.com/FasterXML/jackson-dataformat-xml/commit/eeff2c312e9d4caa8c9f27b8f740c7529d00524a",
    "cve_id": "CVE-2016-7051",
    "cwe_id": "CWE-611",
    "filename": "src/main/java/com/fasterxml/jackson/dataformat/xml/XmlFactory.java",
    "is_vulnerable": 0,
    "class_name": "XmlFactory",
    "subclass_name": null,
    "function_name": "setXMLTextElementName(String name)",
    "function_body": "{\n        _cfgNameForTextElement = name;\n    }"
  },
  {
    "id": 44,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 7,
    "human_patch": "https://github.com/FasterXML/jackson-dataformat-xml/commit/eeff2c312e9d4caa8c9f27b8f740c7529d00524a",
    "cve_id": "CVE-2016-7051",
    "cwe_id": "CWE-611",
    "filename": "src/main/java/com/fasterxml/jackson/dataformat/xml/XmlFactory.java",
    "is_vulnerable": 0,
    "class_name": "XmlFactory",
    "subclass_name": null,
    "function_name": "getXMLTextElementName()",
    "function_body": "{\n        return _cfgNameForTextElement;\n    }"
  },
  {
    "id": 44,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 8,
    "human_patch": "https://github.com/FasterXML/jackson-dataformat-xml/commit/eeff2c312e9d4caa8c9f27b8f740c7529d00524a",
    "cve_id": "CVE-2016-7051",
    "cwe_id": "CWE-611",
    "filename": "src/main/java/com/fasterxml/jackson/dataformat/xml/XmlFactory.java",
    "is_vulnerable": 0,
    "class_name": "XmlFactory",
    "subclass_name": null,
    "function_name": "configure(FromXmlParser.Feature f, boolean state)",
    "function_body": "{\n        if (state) {\n            enable(f);\n        } else {\n            disable(f);\n        }\n        return this;\n    }"
  },
  {
    "id": 44,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 9,
    "human_patch": "https://github.com/FasterXML/jackson-dataformat-xml/commit/eeff2c312e9d4caa8c9f27b8f740c7529d00524a",
    "cve_id": "CVE-2016-7051",
    "cwe_id": "CWE-611",
    "filename": "src/main/java/com/fasterxml/jackson/dataformat/xml/XmlFactory.java",
    "is_vulnerable": 0,
    "class_name": "XmlFactory",
    "subclass_name": null,
    "function_name": "enable(FromXmlParser.Feature f)",
    "function_body": "{\n        _xmlParserFeatures |= f.getMask();\n        return this;\n    }"
  },
  {
    "id": 44,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 10,
    "human_patch": "https://github.com/FasterXML/jackson-dataformat-xml/commit/eeff2c312e9d4caa8c9f27b8f740c7529d00524a",
    "cve_id": "CVE-2016-7051",
    "cwe_id": "CWE-611",
    "filename": "src/main/java/com/fasterxml/jackson/dataformat/xml/XmlFactory.java",
    "is_vulnerable": 0,
    "class_name": "XmlFactory",
    "subclass_name": null,
    "function_name": "disable(FromXmlParser.Feature f)",
    "function_body": "{\n        _xmlParserFeatures &= ~f.getMask();\n        return this;\n    }"
  },
  {
    "id": 44,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 11,
    "human_patch": "https://github.com/FasterXML/jackson-dataformat-xml/commit/eeff2c312e9d4caa8c9f27b8f740c7529d00524a",
    "cve_id": "CVE-2016-7051",
    "cwe_id": "CWE-611",
    "filename": "src/main/java/com/fasterxml/jackson/dataformat/xml/XmlFactory.java",
    "is_vulnerable": 0,
    "class_name": "XmlFactory",
    "subclass_name": null,
    "function_name": "isEnabled(FromXmlParser.Feature f)",
    "function_body": "{\n        return (_xmlParserFeatures & f.getMask()) != 0;\n    }"
  },
  {
    "id": 44,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 12,
    "human_patch": "https://github.com/FasterXML/jackson-dataformat-xml/commit/eeff2c312e9d4caa8c9f27b8f740c7529d00524a",
    "cve_id": "CVE-2016-7051",
    "cwe_id": "CWE-611",
    "filename": "src/main/java/com/fasterxml/jackson/dataformat/xml/XmlFactory.java",
    "is_vulnerable": 0,
    "class_name": "XmlFactory",
    "subclass_name": null,
    "function_name": "configure(ToXmlGenerator.Feature f, boolean state)",
    "function_body": "{\n        if (state) {\n            enable(f);\n        } else {\n            disable(f);\n        }\n        return this;\n    }"
  },
  {
    "id": 44,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 13,
    "human_patch": "https://github.com/FasterXML/jackson-dataformat-xml/commit/eeff2c312e9d4caa8c9f27b8f740c7529d00524a",
    "cve_id": "CVE-2016-7051",
    "cwe_id": "CWE-611",
    "filename": "src/main/java/com/fasterxml/jackson/dataformat/xml/XmlFactory.java",
    "is_vulnerable": 0,
    "class_name": "XmlFactory",
    "subclass_name": null,
    "function_name": "enable(ToXmlGenerator.Feature f)",
    "function_body": "{\n        _xmlGeneratorFeatures |= f.getMask();\n        return this;\n    }"
  },
  {
    "id": 44,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 14,
    "human_patch": "https://github.com/FasterXML/jackson-dataformat-xml/commit/eeff2c312e9d4caa8c9f27b8f740c7529d00524a",
    "cve_id": "CVE-2016-7051",
    "cwe_id": "CWE-611",
    "filename": "src/main/java/com/fasterxml/jackson/dataformat/xml/XmlFactory.java",
    "is_vulnerable": 0,
    "class_name": "XmlFactory",
    "subclass_name": null,
    "function_name": "disable(ToXmlGenerator.Feature f)",
    "function_body": "{\n        _xmlGeneratorFeatures &= ~f.getMask();\n        return this;\n    }"
  },
  {
    "id": 44,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 15,
    "human_patch": "https://github.com/FasterXML/jackson-dataformat-xml/commit/eeff2c312e9d4caa8c9f27b8f740c7529d00524a",
    "cve_id": "CVE-2016-7051",
    "cwe_id": "CWE-611",
    "filename": "src/main/java/com/fasterxml/jackson/dataformat/xml/XmlFactory.java",
    "is_vulnerable": 0,
    "class_name": "XmlFactory",
    "subclass_name": null,
    "function_name": "isEnabled(ToXmlGenerator.Feature f)",
    "function_body": "{\n        return (_xmlGeneratorFeatures & f.getMask()) != 0;\n    }"
  },
  {
    "id": 44,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 16,
    "human_patch": "https://github.com/FasterXML/jackson-dataformat-xml/commit/eeff2c312e9d4caa8c9f27b8f740c7529d00524a",
    "cve_id": "CVE-2016-7051",
    "cwe_id": "CWE-611",
    "filename": "src/main/java/com/fasterxml/jackson/dataformat/xml/XmlFactory.java",
    "is_vulnerable": 0,
    "class_name": "XmlFactory",
    "subclass_name": null,
    "function_name": "getXMLInputFactory()",
    "function_body": "{\n        return _xmlInputFactory;\n    }"
  },
  {
    "id": 44,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 17,
    "human_patch": "https://github.com/FasterXML/jackson-dataformat-xml/commit/eeff2c312e9d4caa8c9f27b8f740c7529d00524a",
    "cve_id": "CVE-2016-7051",
    "cwe_id": "CWE-611",
    "filename": "src/main/java/com/fasterxml/jackson/dataformat/xml/XmlFactory.java",
    "is_vulnerable": 0,
    "class_name": "XmlFactory",
    "subclass_name": null,
    "function_name": "setXMLInputFactory(XMLInputFactory f)",
    "function_body": "{\n        _xmlInputFactory = f;\n    }"
  },
  {
    "id": 44,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 18,
    "human_patch": "https://github.com/FasterXML/jackson-dataformat-xml/commit/eeff2c312e9d4caa8c9f27b8f740c7529d00524a",
    "cve_id": "CVE-2016-7051",
    "cwe_id": "CWE-611",
    "filename": "src/main/java/com/fasterxml/jackson/dataformat/xml/XmlFactory.java",
    "is_vulnerable": 0,
    "class_name": "XmlFactory",
    "subclass_name": null,
    "function_name": "getXMLOutputFactory()",
    "function_body": "{\n        return _xmlOutputFactory;\n    }"
  },
  {
    "id": 44,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 19,
    "human_patch": "https://github.com/FasterXML/jackson-dataformat-xml/commit/eeff2c312e9d4caa8c9f27b8f740c7529d00524a",
    "cve_id": "CVE-2016-7051",
    "cwe_id": "CWE-611",
    "filename": "src/main/java/com/fasterxml/jackson/dataformat/xml/XmlFactory.java",
    "is_vulnerable": 0,
    "class_name": "XmlFactory",
    "subclass_name": null,
    "function_name": "setXMLOutputFactory(XMLOutputFactory f)",
    "function_body": "{\n        _xmlOutputFactory = f;\n    }"
  },
  {
    "id": 44,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 20,
    "human_patch": "https://github.com/FasterXML/jackson-dataformat-xml/commit/eeff2c312e9d4caa8c9f27b8f740c7529d00524a",
    "cve_id": "CVE-2016-7051",
    "cwe_id": "CWE-611",
    "filename": "src/main/java/com/fasterxml/jackson/dataformat/xml/XmlFactory.java",
    "is_vulnerable": 0,
    "class_name": "XmlFactory",
    "subclass_name": null,
    "function_name": "getFormatName()",
    "function_body": "{\n        return FORMAT_NAME_XML;\n    }"
  },
  {
    "id": 44,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 21,
    "human_patch": "https://github.com/FasterXML/jackson-dataformat-xml/commit/eeff2c312e9d4caa8c9f27b8f740c7529d00524a",
    "cve_id": "CVE-2016-7051",
    "cwe_id": "CWE-611",
    "filename": "src/main/java/com/fasterxml/jackson/dataformat/xml/XmlFactory.java",
    "is_vulnerable": 0,
    "class_name": "XmlFactory",
    "subclass_name": null,
    "function_name": "hasFormat(InputAccessor acc) throws IOException",
    "function_body": "{\n        return hasXMLFormat(acc);\n    }"
  },
  {
    "id": 44,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 22,
    "human_patch": "https://github.com/FasterXML/jackson-dataformat-xml/commit/eeff2c312e9d4caa8c9f27b8f740c7529d00524a",
    "cve_id": "CVE-2016-7051",
    "cwe_id": "CWE-611",
    "filename": "src/main/java/com/fasterxml/jackson/dataformat/xml/XmlFactory.java",
    "is_vulnerable": 0,
    "class_name": "XmlFactory",
    "subclass_name": null,
    "function_name": "requiresCustomCodec()",
    "function_body": "{ return true; }"
  },
  {
    "id": 44,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 23,
    "human_patch": "https://github.com/FasterXML/jackson-dataformat-xml/commit/eeff2c312e9d4caa8c9f27b8f740c7529d00524a",
    "cve_id": "CVE-2016-7051",
    "cwe_id": "CWE-611",
    "filename": "src/main/java/com/fasterxml/jackson/dataformat/xml/XmlFactory.java",
    "is_vulnerable": 0,
    "class_name": "XmlFactory",
    "subclass_name": null,
    "function_name": "canUseCharArrays()",
    "function_body": "{ return false; }"
  },
  {
    "id": 44,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 24,
    "human_patch": "https://github.com/FasterXML/jackson-dataformat-xml/commit/eeff2c312e9d4caa8c9f27b8f740c7529d00524a",
    "cve_id": "CVE-2016-7051",
    "cwe_id": "CWE-611",
    "filename": "src/main/java/com/fasterxml/jackson/dataformat/xml/XmlFactory.java",
    "is_vulnerable": 0,
    "class_name": "XmlFactory",
    "subclass_name": null,
    "function_name": "getFormatReadFeatureType()",
    "function_body": "{\n        return FromXmlParser.Feature.class;\n    }"
  },
  {
    "id": 44,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 25,
    "human_patch": "https://github.com/FasterXML/jackson-dataformat-xml/commit/eeff2c312e9d4caa8c9f27b8f740c7529d00524a",
    "cve_id": "CVE-2016-7051",
    "cwe_id": "CWE-611",
    "filename": "src/main/java/com/fasterxml/jackson/dataformat/xml/XmlFactory.java",
    "is_vulnerable": 0,
    "class_name": "XmlFactory",
    "subclass_name": null,
    "function_name": "getFormatWriteFeatureType()",
    "function_body": "{\n        return ToXmlGenerator.Feature.class;\n    }"
  },
  {
    "id": 44,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 26,
    "human_patch": "https://github.com/FasterXML/jackson-dataformat-xml/commit/eeff2c312e9d4caa8c9f27b8f740c7529d00524a",
    "cve_id": "CVE-2016-7051",
    "cwe_id": "CWE-611",
    "filename": "src/main/java/com/fasterxml/jackson/dataformat/xml/XmlFactory.java",
    "is_vulnerable": 0,
    "class_name": "XmlFactory",
    "subclass_name": null,
    "function_name": "createParser(String content) throws IOException",
    "function_body": "{\n        Reader r = new StringReader(content);\n        IOContext ctxt = _createContext(r, true);\n        if (_inputDecorator != null) {\n            r = _inputDecorator.decorate(ctxt, r);\n        }\n        return _createParser(r, ctxt);\n    }"
  },
  {
    "id": 44,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 27,
    "human_patch": "https://github.com/FasterXML/jackson-dataformat-xml/commit/eeff2c312e9d4caa8c9f27b8f740c7529d00524a",
    "cve_id": "CVE-2016-7051",
    "cwe_id": "CWE-611",
    "filename": "src/main/java/com/fasterxml/jackson/dataformat/xml/XmlFactory.java",
    "is_vulnerable": 0,
    "class_name": "XmlFactory",
    "subclass_name": null,
    "function_name": "createGenerator(OutputStream out) throws IOException",
    "function_body": "{\n        return createGenerator(out, JsonEncoding.UTF8);\n    }"
  },
  {
    "id": 44,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 28,
    "human_patch": "https://github.com/FasterXML/jackson-dataformat-xml/commit/eeff2c312e9d4caa8c9f27b8f740c7529d00524a",
    "cve_id": "CVE-2016-7051",
    "cwe_id": "CWE-611",
    "filename": "src/main/java/com/fasterxml/jackson/dataformat/xml/XmlFactory.java",
    "is_vulnerable": 0,
    "class_name": "XmlFactory",
    "subclass_name": null,
    "function_name": "createGenerator(OutputStream out, JsonEncoding enc) throws IOException",
    "function_body": "{\n        \n        IOContext ctxt = _createContext(out, false);\n        ctxt.setEncoding(enc);\n        return new ToXmlGenerator(ctxt,\n                _generatorFeatures, _xmlGeneratorFeatures,\n                _objectCodec, _createXmlWriter(out));\n    }"
  },
  {
    "id": 44,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 29,
    "human_patch": "https://github.com/FasterXML/jackson-dataformat-xml/commit/eeff2c312e9d4caa8c9f27b8f740c7529d00524a",
    "cve_id": "CVE-2016-7051",
    "cwe_id": "CWE-611",
    "filename": "src/main/java/com/fasterxml/jackson/dataformat/xml/XmlFactory.java",
    "is_vulnerable": 0,
    "class_name": "XmlFactory",
    "subclass_name": null,
    "function_name": "createGenerator(Writer out) throws IOException",
    "function_body": "{\n        return new ToXmlGenerator(_createContext(out, false),\n                _generatorFeatures, _xmlGeneratorFeatures,\n                _objectCodec, _createXmlWriter(out));\n    }"
  },
  {
    "id": 44,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 30,
    "human_patch": "https://github.com/FasterXML/jackson-dataformat-xml/commit/eeff2c312e9d4caa8c9f27b8f740c7529d00524a",
    "cve_id": "CVE-2016-7051",
    "cwe_id": "CWE-611",
    "filename": "src/main/java/com/fasterxml/jackson/dataformat/xml/XmlFactory.java",
    "is_vulnerable": 0,
    "class_name": "XmlFactory",
    "subclass_name": null,
    "function_name": "createGenerator(File f, JsonEncoding enc) throws IOException",
    "function_body": "{\n        OutputStream out = new FileOutputStream(f);\n        \n        IOContext ctxt = _createContext(out, true);\n        ctxt.setEncoding(enc);\n        return new ToXmlGenerator(ctxt, _generatorFeatures, _xmlGeneratorFeatures,\n                _objectCodec, _createXmlWriter(out));\n    }"
  },
  {
    "id": 44,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 31,
    "human_patch": "https://github.com/FasterXML/jackson-dataformat-xml/commit/eeff2c312e9d4caa8c9f27b8f740c7529d00524a",
    "cve_id": "CVE-2016-7051",
    "cwe_id": "CWE-611",
    "filename": "src/main/java/com/fasterxml/jackson/dataformat/xml/XmlFactory.java",
    "is_vulnerable": 0,
    "class_name": "XmlFactory",
    "subclass_name": null,
    "function_name": "createParser(XMLStreamReader sr) throws IOException",
    "function_body": "{\n        \n        if (sr.getEventType() != XMLStreamConstants.START_ELEMENT) {\n            try {\n                sr = _initializeXmlReader(sr);\n            } catch (XMLStreamException e) {\n                return StaxUtil.throwXmlAsIOException(e);\n            }\n        }\n\n        \n        FromXmlParser xp = new FromXmlParser(_createContext(sr, false),\n                _generatorFeatures, _xmlGeneratorFeatures, _objectCodec, sr);\n        if (_cfgNameForTextElement != null) {\n            xp.setXMLTextElementName(_cfgNameForTextElement);\n        }\n        return xp;\n    }"
  },
  {
    "id": 44,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 32,
    "human_patch": "https://github.com/FasterXML/jackson-dataformat-xml/commit/eeff2c312e9d4caa8c9f27b8f740c7529d00524a",
    "cve_id": "CVE-2016-7051",
    "cwe_id": "CWE-611",
    "filename": "src/main/java/com/fasterxml/jackson/dataformat/xml/XmlFactory.java",
    "is_vulnerable": 0,
    "class_name": "XmlFactory",
    "subclass_name": null,
    "function_name": "createGenerator(XMLStreamWriter sw) throws IOException",
    "function_body": "{\n        try {\n            sw = _initializeXmlWriter(sw);\n        } catch (XMLStreamException e) {\n            return StaxUtil.throwXmlAsIOException(e);\n        }\n        IOContext ctxt = _createContext(sw, false);\n        return new ToXmlGenerator(ctxt, _generatorFeatures, _xmlGeneratorFeatures,\n                _objectCodec, sw);\n    }"
  },
  {
    "id": 44,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 33,
    "human_patch": "https://github.com/FasterXML/jackson-dataformat-xml/commit/eeff2c312e9d4caa8c9f27b8f740c7529d00524a",
    "cve_id": "CVE-2016-7051",
    "cwe_id": "CWE-611",
    "filename": "src/main/java/com/fasterxml/jackson/dataformat/xml/XmlFactory.java",
    "is_vulnerable": 0,
    "class_name": "XmlFactory",
    "subclass_name": null,
    "function_name": "_createParser(InputStream in, IOContext ctxt) throws IOException",
    "function_body": "{\n        XMLStreamReader sr;\n        try {\n            sr = _xmlInputFactory.createXMLStreamReader(in);\n            sr = _initializeXmlReader(sr);\n        } catch (XMLStreamException e) {\n            return StaxUtil.throwXmlAsIOException(e);\n        }\n        FromXmlParser xp = new FromXmlParser(ctxt, _generatorFeatures, _xmlGeneratorFeatures,\n                _objectCodec, sr);\n        if (_cfgNameForTextElement != null) {\n            xp.setXMLTextElementName(_cfgNameForTextElement);\n        }\n        return xp;\n    }"
  },
  {
    "id": 44,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 34,
    "human_patch": "https://github.com/FasterXML/jackson-dataformat-xml/commit/eeff2c312e9d4caa8c9f27b8f740c7529d00524a",
    "cve_id": "CVE-2016-7051",
    "cwe_id": "CWE-611",
    "filename": "src/main/java/com/fasterxml/jackson/dataformat/xml/XmlFactory.java",
    "is_vulnerable": 0,
    "class_name": "XmlFactory",
    "subclass_name": null,
    "function_name": "_createParser(Reader r, IOContext ctxt) throws IOException",
    "function_body": "{\n        XMLStreamReader sr;\n        try {\n            sr = _xmlInputFactory.createXMLStreamReader(r);\n            sr = _initializeXmlReader(sr);\n        } catch (XMLStreamException e) {\n            return StaxUtil.throwXmlAsIOException(e);\n        }\n        FromXmlParser xp = new FromXmlParser(ctxt, _generatorFeatures, _xmlGeneratorFeatures,\n                _objectCodec, sr);\n        if (_cfgNameForTextElement != null) {\n            xp.setXMLTextElementName(_cfgNameForTextElement);\n        }\n        return xp;\n    }"
  },
  {
    "id": 44,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 35,
    "human_patch": "https://github.com/FasterXML/jackson-dataformat-xml/commit/eeff2c312e9d4caa8c9f27b8f740c7529d00524a",
    "cve_id": "CVE-2016-7051",
    "cwe_id": "CWE-611",
    "filename": "src/main/java/com/fasterxml/jackson/dataformat/xml/XmlFactory.java",
    "is_vulnerable": 0,
    "class_name": "XmlFactory",
    "subclass_name": null,
    "function_name": "_createParser(char[] data, int offset, int len, IOContext ctxt,\n            boolean recycleBuffer) throws IOException",
    "function_body": "{\n        \n        \n        XMLStreamReader sr;\n        try {\n            sr = _xmlInputFactory.createXMLStreamReader(new Stax2CharArraySource(data, offset, len));\n            sr = _initializeXmlReader(sr);\n        } catch (XMLStreamException e) {\n            return StaxUtil.throwXmlAsIOException(e);\n        }\n        FromXmlParser xp = new FromXmlParser(ctxt, _generatorFeatures, _xmlGeneratorFeatures,\n                _objectCodec, sr);\n        if (_cfgNameForTextElement != null) {\n            xp.setXMLTextElementName(_cfgNameForTextElement);\n        }\n        return xp;\n    }"
  },
  {
    "id": 44,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 36,
    "human_patch": "https://github.com/FasterXML/jackson-dataformat-xml/commit/eeff2c312e9d4caa8c9f27b8f740c7529d00524a",
    "cve_id": "CVE-2016-7051",
    "cwe_id": "CWE-611",
    "filename": "src/main/java/com/fasterxml/jackson/dataformat/xml/XmlFactory.java",
    "is_vulnerable": 0,
    "class_name": "XmlFactory",
    "subclass_name": null,
    "function_name": "_createParser(byte[] data, int offset, int len, IOContext ctxt) throws IOException",
    "function_body": "{\n        XMLStreamReader sr;\n        try {\n            sr = _xmlInputFactory.createXMLStreamReader(new Stax2ByteArraySource(data, offset, len));\n            sr = _initializeXmlReader(sr);\n        } catch (XMLStreamException e) {\n            return StaxUtil.throwXmlAsIOException(e);\n        }\n        FromXmlParser xp = new FromXmlParser(ctxt, _generatorFeatures, _xmlGeneratorFeatures,\n                _objectCodec, sr);\n        if (_cfgNameForTextElement != null) {\n            xp.setXMLTextElementName(_cfgNameForTextElement);\n        }\n        return xp;\n    }"
  },
  {
    "id": 44,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 37,
    "human_patch": "https://github.com/FasterXML/jackson-dataformat-xml/commit/eeff2c312e9d4caa8c9f27b8f740c7529d00524a",
    "cve_id": "CVE-2016-7051",
    "cwe_id": "CWE-611",
    "filename": "src/main/java/com/fasterxml/jackson/dataformat/xml/XmlFactory.java",
    "is_vulnerable": 0,
    "class_name": "XmlFactory",
    "subclass_name": null,
    "function_name": "_createGenerator(Writer out, IOContext ctxt) throws IOException",
    "function_body": "{\n        \n        VersionUtil.throwInternal();\n        return null;\n    }"
  },
  {
    "id": 44,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 38,
    "human_patch": "https://github.com/FasterXML/jackson-dataformat-xml/commit/eeff2c312e9d4caa8c9f27b8f740c7529d00524a",
    "cve_id": "CVE-2016-7051",
    "cwe_id": "CWE-611",
    "filename": "src/main/java/com/fasterxml/jackson/dataformat/xml/XmlFactory.java",
    "is_vulnerable": 0,
    "class_name": "XmlFactory",
    "subclass_name": null,
    "function_name": "_createXmlWriter(OutputStream out) throws IOException",
    "function_body": "{\n        try {\n            return _initializeXmlWriter(_xmlOutputFactory.createXMLStreamWriter(out, \"UTF-8\"));\n        } catch (XMLStreamException e) {\n            return StaxUtil.throwXmlAsIOException(e);\n        }\n    }"
  },
  {
    "id": 44,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 39,
    "human_patch": "https://github.com/FasterXML/jackson-dataformat-xml/commit/eeff2c312e9d4caa8c9f27b8f740c7529d00524a",
    "cve_id": "CVE-2016-7051",
    "cwe_id": "CWE-611",
    "filename": "src/main/java/com/fasterxml/jackson/dataformat/xml/XmlFactory.java",
    "is_vulnerable": 0,
    "class_name": "XmlFactory",
    "subclass_name": null,
    "function_name": "_createXmlWriter(Writer w) throws IOException",
    "function_body": "{\n        try {\n            return _initializeXmlWriter(_xmlOutputFactory.createXMLStreamWriter(w));\n        } catch (XMLStreamException e) {\n            return StaxUtil.throwXmlAsIOException(e);\n        }\n    }"
  },
  {
    "id": 44,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 40,
    "human_patch": "https://github.com/FasterXML/jackson-dataformat-xml/commit/eeff2c312e9d4caa8c9f27b8f740c7529d00524a",
    "cve_id": "CVE-2016-7051",
    "cwe_id": "CWE-611",
    "filename": "src/main/java/com/fasterxml/jackson/dataformat/xml/XmlFactory.java",
    "is_vulnerable": 0,
    "class_name": "XmlFactory",
    "subclass_name": null,
    "function_name": "_initializeXmlWriter(XMLStreamWriter sw) throws IOException, XMLStreamException",
    "function_body": "{\n        \n        \n        sw.setDefaultNamespace(\"\");\n        return sw;\n    }"
  },
  {
    "id": 44,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 41,
    "human_patch": "https://github.com/FasterXML/jackson-dataformat-xml/commit/eeff2c312e9d4caa8c9f27b8f740c7529d00524a",
    "cve_id": "CVE-2016-7051",
    "cwe_id": "CWE-611",
    "filename": "src/main/java/com/fasterxml/jackson/dataformat/xml/XmlFactory.java",
    "is_vulnerable": 0,
    "class_name": "XmlFactory",
    "subclass_name": null,
    "function_name": "_initializeXmlReader(XMLStreamReader sr) throws IOException, XMLStreamException",
    "function_body": "{\n        \n        while (sr.next() != XMLStreamConstants.START_ELEMENT) {\n            ;\n        }\n        return sr;\n    }"
  },
  {
    "id": 44,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 42,
    "human_patch": "https://github.com/FasterXML/jackson-dataformat-xml/commit/eeff2c312e9d4caa8c9f27b8f740c7529d00524a",
    "cve_id": "CVE-2016-7051",
    "cwe_id": "CWE-611",
    "filename": "src/main/java/com/fasterxml/jackson/dataformat/xml/XmlFactory.java",
    "is_vulnerable": 0,
    "class_name": "XmlFactory",
    "subclass_name": null,
    "function_name": "hasXMLFormat(InputAccessor acc) throws IOException",
    "function_body": "{\n        \n        if (!acc.hasMoreBytes()) {\n            return MatchStrength.INCONCLUSIVE;\n        }\n        byte b = acc.nextByte();\n        \n        if (b == UTF8_BOM_1) { \n            if (!acc.hasMoreBytes()) {\n                return MatchStrength.INCONCLUSIVE;\n            }\n            if (acc.nextByte() != UTF8_BOM_2) {\n                return MatchStrength.NO_MATCH;\n            }\n            if (!acc.hasMoreBytes()) {\n                return MatchStrength.INCONCLUSIVE;\n            }\n            if (acc.nextByte() != UTF8_BOM_3) {\n                return MatchStrength.NO_MATCH;\n            }\n            if (!acc.hasMoreBytes()) {\n                return MatchStrength.INCONCLUSIVE;\n            }\n            b = acc.nextByte();\n        }\n        \n        boolean maybeXmlDecl = (b == BYTE_LT);\n        if (!maybeXmlDecl) {\n            int ch = skipSpace(acc, b);\n            if (ch < 0) {\n                return MatchStrength.INCONCLUSIVE;\n            }\n            b = (byte) ch;\n            \n           if (b != BYTE_LT) {\n                return MatchStrength.NO_MATCH;\n            }\n        }\n        if (!acc.hasMoreBytes()) {\n            return MatchStrength.INCONCLUSIVE;\n        }\n        b = acc.nextByte();\n        \n        if (b == BYTE_QMARK) { \n            b = acc.nextByte();\n            if (b == BYTE_x) {\n                if (maybeXmlDecl) {\n                    if (acc.hasMoreBytes() && acc.nextByte() == BYTE_m) {\n                        if (acc.hasMoreBytes() && acc.nextByte() == BYTE_l) {\n                            return MatchStrength.FULL_MATCH;\n                        }\n                    }\n                }\n                \n                return MatchStrength.SOLID_MATCH;\n            }\n            \n            if (validXmlNameStartChar(acc, b)) {\n                return MatchStrength.SOLID_MATCH;\n            }\n        } else if (b == BYTE_EXCL) {\n            \n            if (!acc.hasMoreBytes()) {\n                return MatchStrength.INCONCLUSIVE;\n            }\n            b = acc.nextByte();\n            if (b == BYTE_HYPHEN) {\n                if (!acc.hasMoreBytes()) {\n                    return MatchStrength.INCONCLUSIVE;\n                }\n                if (acc.nextByte() == BYTE_HYPHEN) {\n                    return MatchStrength.SOLID_MATCH;\n                }\n            } else if (b == BYTE_D) {\n                return tryMatch(acc, \"OCTYPE\", MatchStrength.SOLID_MATCH);\n            }\n        } else {\n            \n            if (validXmlNameStartChar(acc, b)) {\n                return MatchStrength.SOLID_MATCH;\n            }\n        }\n        return MatchStrength.NO_MATCH;\n    }"
  },
  {
    "id": 44,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 43,
    "human_patch": "https://github.com/FasterXML/jackson-dataformat-xml/commit/eeff2c312e9d4caa8c9f27b8f740c7529d00524a",
    "cve_id": "CVE-2016-7051",
    "cwe_id": "CWE-611",
    "filename": "src/main/java/com/fasterxml/jackson/dataformat/xml/XmlFactory.java",
    "is_vulnerable": 0,
    "class_name": "XmlFactory",
    "subclass_name": null,
    "function_name": "validXmlNameStartChar(InputAccessor acc, byte b) throws IOException",
    "function_body": "{\n        \n        int ch = (int) b & 0xFF;\n        if (ch >= 'A') { \n            \n            return true;\n        }\n        return false;\n    }"
  },
  {
    "id": 44,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 44,
    "human_patch": "https://github.com/FasterXML/jackson-dataformat-xml/commit/eeff2c312e9d4caa8c9f27b8f740c7529d00524a",
    "cve_id": "CVE-2016-7051",
    "cwe_id": "CWE-611",
    "filename": "src/main/java/com/fasterxml/jackson/dataformat/xml/XmlFactory.java",
    "is_vulnerable": 0,
    "class_name": "XmlFactory",
    "subclass_name": null,
    "function_name": "tryMatch(InputAccessor acc, String matchStr, MatchStrength fullMatchStrength) throws IOException",
    "function_body": "{\n        for (int i = 0, len = matchStr.length(); i < len; ++i) {\n            if (!acc.hasMoreBytes()) {\n                return MatchStrength.INCONCLUSIVE;\n            }\n            if (acc.nextByte() != matchStr.charAt(i)) {\n                return MatchStrength.NO_MATCH;\n            }\n        }\n        return fullMatchStrength;\n    }"
  },
  {
    "id": 44,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 45,
    "human_patch": "https://github.com/FasterXML/jackson-dataformat-xml/commit/eeff2c312e9d4caa8c9f27b8f740c7529d00524a",
    "cve_id": "CVE-2016-7051",
    "cwe_id": "CWE-611",
    "filename": "src/main/java/com/fasterxml/jackson/dataformat/xml/XmlFactory.java",
    "is_vulnerable": 0,
    "class_name": "XmlFactory",
    "subclass_name": null,
    "function_name": "skipSpace(InputAccessor acc, byte b) throws IOException",
    "function_body": "{\n        while (true) {\n            int ch = (int) b & 0xFF;\n            if (!(ch == ' ' || ch == '\\r' || ch == '\\n' || ch == '\\t')) {\n                return ch;\n            }\n            if (!acc.hasMoreBytes()) {\n                return -1;\n            }\n            b = acc.nextByte();\n            ch = (int) b & 0xFF;\n        }\n    }"
  },
  {
    "id": 45,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 0,
    "human_patch": "https://github.com/inversoft/prime-jwt/commit/abb0d479389a2509f939452a6767dc424bb5e6ba",
    "cve_id": "CVE-2018-1000531",
    "cwe_id": "CWE-20",
    "filename": "src/main/java/org/primeframework/jwt/JWTDecoder.java",
    "is_vulnerable": 0,
    "class_name": "JWTDecoder",
    "subclass_name": null,
    "function_name": "getInstance()",
    "function_body": "{\n    if (instance == null) {\n      instance = new JWTDecoder();\n    }\n\n    return instance;\n  }"
  },
  {
    "id": 45,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 1,
    "human_patch": "https://github.com/inversoft/prime-jwt/commit/abb0d479389a2509f939452a6767dc424bb5e6ba",
    "cve_id": "CVE-2018-1000531",
    "cwe_id": "CWE-20",
    "filename": "src/main/java/org/primeframework/jwt/JWTDecoder.java",
    "is_vulnerable": 0,
    "class_name": "JWTDecoder",
    "subclass_name": null,
    "function_name": "decode(String encodedJWT, Verifier... verifiers)",
    "function_body": "{\n    Objects.requireNonNull(encodedJWT);\n    Objects.requireNonNull(verifiers);\n\n    \n    String[] parts = getParts(encodedJWT);\n    Header header = Mapper.deserialize(base64Decode(parts[0].getBytes(StandardCharsets.UTF_8)), Header.class);\n\n    \n    if (parts.length == 2 && verifiers.length == 0) {\n      if (header.algorithm == Algorithm.none) {\n        return Mapper.deserialize(base64Decode(parts[1].getBytes(StandardCharsets.UTF_8)), JWT.class);\n      } else {\n        throw new InvalidJWTSignatureException();\n      }\n    }\n\n    \n    Verifier verifier = null;\n    for (Verifier v : verifiers) {\n      if (v.canVerify(header.algorithm)) {\n        verifier = v;\n      }\n    }\n\n    return decode(encodedJWT, header, parts, verifier);\n  }"
  },
  {
    "id": 45,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 2,
    "human_patch": "https://github.com/inversoft/prime-jwt/commit/abb0d479389a2509f939452a6767dc424bb5e6ba",
    "cve_id": "CVE-2018-1000531",
    "cwe_id": "CWE-20",
    "filename": "src/main/java/org/primeframework/jwt/JWTDecoder.java",
    "is_vulnerable": 0,
    "class_name": "JWTDecoder",
    "subclass_name": null,
    "function_name": "decode(String encodedJWT, Map<String, Verifier> verifiers)",
    "function_body": "{\n    return decode(encodedJWT, verifiers, h -> h.get(\"kid\"));\n  }"
  },
  {
    "id": 45,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 3,
    "human_patch": "https://github.com/inversoft/prime-jwt/commit/abb0d479389a2509f939452a6767dc424bb5e6ba",
    "cve_id": "CVE-2018-1000531",
    "cwe_id": "CWE-20",
    "filename": "src/main/java/org/primeframework/jwt/JWTDecoder.java",
    "is_vulnerable": 0,
    "class_name": "JWTDecoder",
    "subclass_name": null,
    "function_name": "decode(String encodedJWT, Map<String, Verifier> verifiers, Function<Header, String> keyFunction)",
    "function_body": "{\n    Objects.requireNonNull(encodedJWT);\n    Objects.requireNonNull(verifiers);\n    Objects.requireNonNull(keyFunction);\n\n    String[] parts = getParts(encodedJWT);\n    Header header = Mapper.deserialize(base64Decode(parts[0].getBytes(StandardCharsets.UTF_8)), Header.class);\n    \n    if (parts.length == 2 && verifiers.isEmpty()) {\n      if (header.algorithm == Algorithm.none) {\n        return Mapper.deserialize(base64Decode(parts[1].getBytes(StandardCharsets.UTF_8)), JWT.class);\n      } else {\n        throw new InvalidJWTSignatureException();\n      }\n    }\n\n    \n    String key = keyFunction.apply(header);\n    Verifier verifier = verifiers.get(key);\n    if (verifier != null) {\n      if (!verifier.canVerify(header.algorithm)) {\n        verifier = null;\n      }\n    }\n\n    return decode(encodedJWT, header, parts, verifier);\n  }"
  },
  {
    "id": 45,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 4,
    "human_patch": "https://github.com/inversoft/prime-jwt/commit/abb0d479389a2509f939452a6767dc424bb5e6ba",
    "cve_id": "CVE-2018-1000531",
    "cwe_id": "CWE-20",
    "filename": "src/main/java/org/primeframework/jwt/JWTDecoder.java",
    "is_vulnerable": 0,
    "class_name": "JWTDecoder",
    "subclass_name": null,
    "function_name": "base64Decode(byte[] bytes)",
    "function_body": "{\n    try {\n      return Base64.getUrlDecoder().decode(bytes);\n    } catch (IllegalArgumentException e) {\n      throw new InvalidJWTException(\"The encoded JWT is not properly Base64 encoded.\", e);\n    }\n  }"
  },
  {
    "id": 45,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 5,
    "human_patch": "https://github.com/inversoft/prime-jwt/commit/abb0d479389a2509f939452a6767dc424bb5e6ba",
    "cve_id": "CVE-2018-1000531",
    "cwe_id": "CWE-20",
    "filename": "src/main/java/org/primeframework/jwt/JWTDecoder.java",
    "is_vulnerable": 1,
    "class_name": "JWTDecoder",
    "subclass_name": null,
    "function_name": "decode(String encodedJWT, Header header, String[] parts, Verifier verifier)",
    "function_body": "{\n    int index = encodedJWT.lastIndexOf(\".\");\n    \n    byte[] message = encodedJWT.substring(0, index).getBytes(StandardCharsets.UTF_8);\n\n    \n    if (parts.length == 3 && verifier == null) {\n      throw new MissingVerifierException(\"No Verifier has been provided for verify a signature signed using [\" + header.algorithm.getName() + \"]\");\n    }\n\n    \n    if (parts.length == 2 && verifier != null) {\n      throw new InvalidJWTSignatureException();\n    }\n\n    if (parts.length == 3) {\n      \n      byte[] signature = base64Decode(parts[2].getBytes(StandardCharsets.UTF_8));\n      verifier.verify(header.algorithm, message, signature);\n    }\n\n    JWT jwt = Mapper.deserialize(base64Decode(parts[1].getBytes(StandardCharsets.UTF_8)), JWT.class);\n\n    \n    if (jwt.isExpired()) {\n      throw new JWTExpiredException();\n    }\n\n    \n    if (jwt.isUnavailableForProcessing()) {\n      throw new JWTUnavailableForProcessingException();\n    }\n\n    return jwt;\n  }"
  },
  {
    "id": 45,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 6,
    "human_patch": "https://github.com/inversoft/prime-jwt/commit/abb0d479389a2509f939452a6767dc424bb5e6ba",
    "cve_id": "CVE-2018-1000531",
    "cwe_id": "CWE-20",
    "filename": "src/main/java/org/primeframework/jwt/JWTDecoder.java",
    "is_vulnerable": 0,
    "class_name": "JWTDecoder",
    "subclass_name": null,
    "function_name": "getParts(String encodedJWT)",
    "function_body": "{\n    String[] parts = encodedJWT.split(\"\\\\.\");\n    \n    if (parts.length == 3 || (parts.length == 2 && encodedJWT.endsWith(\".\"))) {\n      return parts;\n    }\n\n    throw new InvalidJWTException(\"The encoded JWT is not properly formatted. Expected a three part dot separated string.\");\n  }"
  },
  {
    "id": 45,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 0,
    "human_patch": "https://github.com/inversoft/prime-jwt/commit/abb0d479389a2509f939452a6767dc424bb5e6ba",
    "cve_id": "CVE-2018-1000531",
    "cwe_id": "CWE-20",
    "filename": "src/test/java/org/primeframework/jwt/VulnerabilityTest.java",
    "is_vulnerable": 0,
    "class_name": "VulnerabilityTest",
    "subclass_name": null,
    "function_name": "test_SignedWithoutSignature() throws Exception",
    "function_body": "{\n    JWT inputJwt = new JWT()\n        .setSubject(\"123456789\")\n        .setIssuedAt(ZonedDateTime.now(ZoneOffset.UTC))\n        .setExpiration(ZonedDateTime.now(ZoneOffset.UTC).plusHours(2));\n\n    String encodedJWT = JWT.getEncoder().encode(inputJwt, HMACSigner.newSHA256Signer(\"secret\"));\n    String encodedJWTNoSignature = encodedJWT.substring(0, encodedJWT.lastIndexOf('.') + 1);\n\n    expectException(InvalidJWTSignatureException.class, () -> JWT.getDecoder().decode(encodedJWTNoSignature, HMACVerifier.newVerifier(\"secret\")));\n\n    \n    expectException(InvalidJWTSignatureException.class, () -> JWT.getDecoder().decode(encodedJWTNoSignature));\n  }"
  },
  {
    "id": 45,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 1,
    "human_patch": "https://github.com/inversoft/prime-jwt/commit/abb0d479389a2509f939452a6767dc424bb5e6ba",
    "cve_id": "CVE-2018-1000531",
    "cwe_id": "CWE-20",
    "filename": "src/test/java/org/primeframework/jwt/VulnerabilityTest.java",
    "is_vulnerable": 1,
    "class_name": "VulnerabilityTest",
    "subclass_name": null,
    "function_name": "test_encodedJwtWithSignatureRemoved() throws Exception",
    "function_body": "{\n    \n    JWT jwt = new JWT().setSubject(\"art\");\n    String encodedJWT = JWT.getEncoder().encode(jwt, HMACSigner.newSHA256Signer(\"secret\"));\n\n    String hackedJWT = encodedJWT.substring(0, encodedJWT.lastIndexOf(\".\"));\n\n    expectException(InvalidJWTException.class, ()\n        -> JWT.getDecoder().decode(hackedJWT, HMACVerifier.newVerifier(\"secret\")));\n  }"
  },
  {
    "id": 45,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 2,
    "human_patch": "https://github.com/inversoft/prime-jwt/commit/abb0d479389a2509f939452a6767dc424bb5e6ba",
    "cve_id": "CVE-2018-1000531",
    "cwe_id": "CWE-20",
    "filename": "src/test/java/org/primeframework/jwt/VulnerabilityTest.java",
    "is_vulnerable": 1,
    "class_name": "VulnerabilityTest",
    "subclass_name": null,
    "function_name": "test_noVerification() throws Exception",
    "function_body": "{\n    \n    JWT jwt = new JWT().setSubject(\"art\");\n    String encodedJWT = JWT.getEncoder().encode(jwt, HMACSigner.newSHA256Signer(\"secret\"));\n\n    expectException(MissingVerifierException.class, ()\n        -> JWT.getDecoder().decode(encodedJWT));\n  }"
  },
  {
    "id": 45,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 3,
    "human_patch": "https://github.com/inversoft/prime-jwt/commit/abb0d479389a2509f939452a6767dc424bb5e6ba",
    "cve_id": "CVE-2018-1000531",
    "cwe_id": "CWE-20",
    "filename": "src/test/java/org/primeframework/jwt/VulnerabilityTest.java",
    "is_vulnerable": 0,
    "class_name": "VulnerabilityTest",
    "subclass_name": null,
    "function_name": "test_vulnerability_HMAC_forgery() throws Exception",
    "function_body": "{\n    \n\n    \n    \n    \n\n    JWT jwt = new JWT().setSubject(\"123456789\");\n    \n    Signer hackedSigner = HMACSigner.newSHA512Signer(new String(Files.readAllBytes(Paths.get(\"src/test/resources/rsa_public_key_2048.pem\"))));\n\n    \n    String hmacSignedJWT = JWTEncoder.getInstance().encode(jwt, hackedSigner, h -> h.set(\"kid\", \"abc\"));\n\n    \n    Verifier rsaVerifier = RSAVerifier.newVerifier(new String(Files.readAllBytes(Paths.get(\"src/test/resources/rsa_public_key_2048.pem\"))));\n    Verifier hmacVerifier = HMACVerifier.newVerifier(\"secret\");\n\n    \n    \n    expectException(InvalidJWTSignatureException.class, () -> JWTDecoder.getInstance().decode(hmacSignedJWT, rsaVerifier, hmacVerifier));\n\n    Map<String, Verifier> verifierMap = new HashMap<>();\n    verifierMap.put(\"abc\", rsaVerifier);\n    verifierMap.put(\"def\", hmacVerifier);\n\n    \n    \n    expectException(MissingVerifierException.class, () -> JWTDecoder.getInstance().decode(hmacSignedJWT, verifierMap));\n\n    \n    String hmacSignedJWTTakeTwo = JWTEncoder.getInstance().encode(jwt, hackedSigner, h -> h.set(\"kid\", \"def\"));\n\n    \n    expectException(InvalidJWTSignatureException.class, () -> JWTDecoder.getInstance().decode(hmacSignedJWTTakeTwo, rsaVerifier, hmacVerifier));\n    \n    \n    expectException(InvalidJWTSignatureException.class, () -> JWTDecoder.getInstance().decode(hmacSignedJWTTakeTwo, verifierMap));\n  }"
  },
  {
    "id": 46,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 0,
    "human_patch": "https://github.com/inversoft/prime-jwt/commit/0d94dcef0133d699f21d217e922564adbb83a227",
    "cve_id": "CVE-2018-1000125",
    "cwe_id": "CWE-20",
    "filename": "src/main/java/org/primeframework/jwt/JWTDecoder.java",
    "is_vulnerable": 0,
    "class_name": "JWTDecoder",
    "subclass_name": null,
    "function_name": "getInstance()",
    "function_body": "{\n    if (instance == null) {\n      instance = new JWTDecoder();\n    }\n\n    return instance;\n  }"
  },
  {
    "id": 46,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 1,
    "human_patch": "https://github.com/inversoft/prime-jwt/commit/0d94dcef0133d699f21d217e922564adbb83a227",
    "cve_id": "CVE-2018-1000125",
    "cwe_id": "CWE-20",
    "filename": "src/main/java/org/primeframework/jwt/JWTDecoder.java",
    "is_vulnerable": 1,
    "class_name": "JWTDecoder",
    "subclass_name": null,
    "function_name": "decode(String encodedJWT, Verifier... verifiers)",
    "function_body": "{\n    Objects.requireNonNull(encodedJWT);\n    Objects.requireNonNull(verifiers);\n\n    \n    String[] parts = getParts(encodedJWT);\n    Header header = Mapper.deserialize(base64Decode(parts[0].getBytes(StandardCharsets.UTF_8)), Header.class);\n\n    \n    if (header.algorithm == Algorithm.none && parts.length == 2 && verifiers.length == 0) {\n      return Mapper.deserialize(base64Decode(parts[1].getBytes(StandardCharsets.UTF_8)), JWT.class);\n    }\n\n    \n    Verifier verifier = null;\n    for (Verifier v : verifiers) {\n      if (v.canVerify(header.algorithm)) {\n        verifier = v;\n      }\n    }\n\n    return decode(encodedJWT, header, parts, verifier);\n  }"
  },
  {
    "id": 46,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 2,
    "human_patch": "https://github.com/inversoft/prime-jwt/commit/0d94dcef0133d699f21d217e922564adbb83a227",
    "cve_id": "CVE-2018-1000125",
    "cwe_id": "CWE-20",
    "filename": "src/main/java/org/primeframework/jwt/JWTDecoder.java",
    "is_vulnerable": 0,
    "class_name": "JWTDecoder",
    "subclass_name": null,
    "function_name": "decode(String encodedJWT, Map<String, Verifier> verifiers)",
    "function_body": "{\n    return decode(encodedJWT, verifiers, h -> h.get(\"kid\"));\n  }"
  },
  {
    "id": 46,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 3,
    "human_patch": "https://github.com/inversoft/prime-jwt/commit/0d94dcef0133d699f21d217e922564adbb83a227",
    "cve_id": "CVE-2018-1000125",
    "cwe_id": "CWE-20",
    "filename": "src/main/java/org/primeframework/jwt/JWTDecoder.java",
    "is_vulnerable": 1,
    "class_name": "JWTDecoder",
    "subclass_name": null,
    "function_name": "decode(String encodedJWT, Map<String, Verifier> verifiers, Function<Header, String> keyFunction)",
    "function_body": "{\n    Objects.requireNonNull(encodedJWT);\n    Objects.requireNonNull(verifiers);\n\n    String[] parts = getParts(encodedJWT);\n    Header header = Mapper.deserialize(base64Decode(parts[0].getBytes(StandardCharsets.UTF_8)), Header.class);\n    \n    if (header.algorithm == Algorithm.none && parts.length == 2 && verifiers.isEmpty()) {\n      return Mapper.deserialize(base64Decode(parts[1].getBytes(StandardCharsets.UTF_8)), JWT.class);\n    }\n\n    \n    String key = keyFunction.apply(header);\n    Verifier verifier = verifiers.get(key);\n    if (verifier != null) {\n      if (!verifier.canVerify(header.algorithm)) {\n        verifier = null;\n      }\n    }\n\n    return decode(encodedJWT, header, parts, verifier);\n  }"
  },
  {
    "id": 46,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 4,
    "human_patch": "https://github.com/inversoft/prime-jwt/commit/0d94dcef0133d699f21d217e922564adbb83a227",
    "cve_id": "CVE-2018-1000125",
    "cwe_id": "CWE-20",
    "filename": "src/main/java/org/primeframework/jwt/JWTDecoder.java",
    "is_vulnerable": 0,
    "class_name": "JWTDecoder",
    "subclass_name": null,
    "function_name": "base64Decode(byte[] bytes)",
    "function_body": "{\n    try {\n      return Base64.getUrlDecoder().decode(bytes);\n    } catch (IllegalArgumentException e) {\n      throw new InvalidJWTException(\"The encoded JWT is not properly Base64 encoded.\", e);\n    }\n  }"
  },
  {
    "id": 46,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 5,
    "human_patch": "https://github.com/inversoft/prime-jwt/commit/0d94dcef0133d699f21d217e922564adbb83a227",
    "cve_id": "CVE-2018-1000125",
    "cwe_id": "CWE-20",
    "filename": "src/main/java/org/primeframework/jwt/JWTDecoder.java",
    "is_vulnerable": 1,
    "class_name": "JWTDecoder",
    "subclass_name": null,
    "function_name": "decode(String encodedJWT, Header header, String[] parts, Verifier verifier)",
    "function_body": "{\n    int index = encodedJWT.lastIndexOf(\".\");\n    \n    byte[] message = encodedJWT.substring(0, index).getBytes(StandardCharsets.UTF_8);\n\n    \n    if (parts.length == 3 && verifier == null) {\n      throw new MissingVerifierException(\"No Verifier has been provided for verify a signature signed using [\" + header.algorithm.getName() + \"]\");\n    }\n\n    if (parts.length == 3) {\n      \n      byte[] signature = base64Decode(parts[2].getBytes(StandardCharsets.UTF_8));\n      verifier.verify(header.algorithm, message, signature);\n    }\n\n    JWT jwt = Mapper.deserialize(base64Decode(parts[1].getBytes(StandardCharsets.UTF_8)), JWT.class);\n\n    \n    if (jwt.isExpired()) {\n      throw new JWTExpiredException();\n    }\n\n    \n    if (jwt.isUnavailableForProcessing()) {\n      throw new JWTUnavailableForProcessingException();\n    }\n\n    return jwt;\n  }"
  },
  {
    "id": 46,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 6,
    "human_patch": "https://github.com/inversoft/prime-jwt/commit/0d94dcef0133d699f21d217e922564adbb83a227",
    "cve_id": "CVE-2018-1000125",
    "cwe_id": "CWE-20",
    "filename": "src/main/java/org/primeframework/jwt/JWTDecoder.java",
    "is_vulnerable": 0,
    "class_name": "JWTDecoder",
    "subclass_name": null,
    "function_name": "getParts(String encodedJWT)",
    "function_body": "{\n    String[] parts = encodedJWT.split(\"\\\\.\");\n    \n    if (parts.length == 3 || (parts.length == 2 && encodedJWT.endsWith(\".\"))) {\n      return parts;\n    }\n\n    throw new InvalidJWTException(\"The encoded JWT is not properly formatted. Expected a three part dot separated string.\");\n  }"
  },
  {
    "id": 46,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 0,
    "human_patch": "https://github.com/inversoft/prime-jwt/commit/0d94dcef0133d699f21d217e922564adbb83a227",
    "cve_id": "CVE-2018-1000125",
    "cwe_id": "CWE-20",
    "filename": "src/test/java/org/primeframework/jwt/JWTTest.java",
    "is_vulnerable": 0,
    "class_name": "JWTTest",
    "subclass_name": null,
    "function_name": "decoding_performance() throws Exception",
    "function_body": "{\n    String secret = JWTUtils.generateSHA256HMACSecret();\n    Signer hmacSigner = HMACSigner.newSHA256Signer(secret);\n    Signer rsaSigner = RSASigner.newSHA256Signer(new String(Files.readAllBytes(Paths.get(\"src/test/resources/rsa_private_key_2048.pem\"))));\n\n    Verifier hmacVerifier = HMACVerifier.newVerifier(secret);\n    Verifier rsaVerifier = RSAVerifier.newVerifier(new String(Files.readAllBytes(Paths.get(\"src/test/resources/rsa_public_key_2048.pem\"))));\n\n    JWT jwt = new JWT().setSubject(UUID.randomUUID().toString())\n        .addClaim(\"exp\", ZonedDateTime.now(ZoneOffset.UTC).plusMinutes(5).toInstant().toEpochMilli())\n        .setAudience(UUID.randomUUID().toString())\n        .addClaim(\"roles\", new ArrayList<>(Arrays.asList(\"admin\", \"user\")))\n        .addClaim(\"iat\", ZonedDateTime.now(ZoneOffset.UTC).toInstant().toEpochMilli())\n        .setIssuer(\"inversoft.com\");\n\n    long iterationCount = 250_000;\n    for (Verifier verifier : Arrays.asList(hmacVerifier, rsaVerifier)) {\n      Instant start = Instant.now();\n      Signer signer = verifier instanceof HMACVerifier ? hmacSigner : rsaSigner;\n\n\n      String encodedJWT = JWT.getEncoder().encode(jwt, signer);\n\n      for (int i = 0; i < iterationCount; i++) {\n        JWT.getDecoder().decode(encodedJWT, verifier);\n\n\n      }\n\n      Duration duration = Duration.between(start, Instant.now());\n      BigDecimal durationInMillis = BigDecimal.valueOf(duration.toMillis());\n      BigDecimal average = durationInMillis.divide(BigDecimal.valueOf(iterationCount), RoundingMode.HALF_DOWN);\n      long perSecond = iterationCount / (duration.toMillis() / 1000);\n\n      System.out.println(\"[\" + signer.getAlgorithm().getName() + \"] \" + duration.toMillis() + \" milliseconds total. [\" + iterationCount + \"] iterations. [\" + average + \"] milliseconds per iteration. Approx. [\" + perSecond + \"] per second.\");\n\n    }\n  }"
  },
  {
    "id": 46,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 1,
    "human_patch": "https://github.com/inversoft/prime-jwt/commit/0d94dcef0133d699f21d217e922564adbb83a227",
    "cve_id": "CVE-2018-1000125",
    "cwe_id": "CWE-20",
    "filename": "src/test/java/org/primeframework/jwt/JWTTest.java",
    "is_vulnerable": 0,
    "class_name": "JWTTest",
    "subclass_name": null,
    "function_name": "encoding_performance() throws Exception",
    "function_body": "{\n    Signer hmacSigner = HMACSigner.newSHA256Signer(JWTUtils.generateSHA256HMACSecret());\n    Signer rsaSigner = RSASigner.newSHA256Signer(new String(Files.readAllBytes(Paths.get(\"src/test/resources/rsa_private_key_2048.pem\"))));\n\n    JWT jwt = new JWT().setSubject(UUID.randomUUID().toString())\n        .addClaim(\"exp\", ZonedDateTime.now(ZoneOffset.UTC).plusMinutes(5).toInstant().toEpochMilli())\n        .setAudience(UUID.randomUUID().toString())\n        .addClaim(\"roles\", new ArrayList<>(Arrays.asList(\"admin\", \"user\")))\n        .addClaim(\"iat\", ZonedDateTime.now(ZoneOffset.UTC).toInstant().toEpochMilli())\n        .setIssuer(\"inversoft.com\");\n\n    long iterationCount = 10_000;\n    for (Signer signer : Arrays.asList(hmacSigner, rsaSigner)) {\n\n\n      Instant start = Instant.now();\n      for (int i = 0; i < iterationCount; i++) {\n        JWT.getEncoder().encode(jwt, signer);\n      }\n      Duration duration = Duration.between(start, Instant.now());\n      BigDecimal durationInMillis = BigDecimal.valueOf(duration.toMillis());\n      BigDecimal average = durationInMillis.divide(BigDecimal.valueOf(iterationCount), RoundingMode.HALF_DOWN);\n      long perSecond = iterationCount / (duration.toMillis() / 1000);\n\n      System.out.println(\"[\" + signer.getAlgorithm().getName() + \"] \" + duration.toMillis() + \" milliseconds total. [\" + iterationCount + \"] iterations. [\" + average + \"] milliseconds per iteration. Approx. [\" + perSecond + \"] per second.\");\n    }\n  }"
  },
  {
    "id": 46,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 2,
    "human_patch": "https://github.com/inversoft/prime-jwt/commit/0d94dcef0133d699f21d217e922564adbb83a227",
    "cve_id": "CVE-2018-1000125",
    "cwe_id": "CWE-20",
    "filename": "src/test/java/org/primeframework/jwt/JWTTest.java",
    "is_vulnerable": 0,
    "class_name": "JWTTest",
    "subclass_name": null,
    "function_name": "expired() throws Exception",
    "function_body": "{\n    \n    assertFalse(new JWT()\n        .setSubject(\"123456789\").isExpired());\n\n    assertFalse(new JWT()\n        .setExpiration(ZonedDateTime.now(ZoneOffset.UTC).plusMinutes(1))\n        .setSubject(\"123456789\").isExpired());\n\n    assertTrue(new JWT()\n        .setExpiration(ZonedDateTime.now(ZoneOffset.UTC).minusMinutes(1))\n        .setSubject(\"123456789\").isExpired());\n  }"
  },
  {
    "id": 46,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 3,
    "human_patch": "https://github.com/inversoft/prime-jwt/commit/0d94dcef0133d699f21d217e922564adbb83a227",
    "cve_id": "CVE-2018-1000125",
    "cwe_id": "CWE-20",
    "filename": "src/test/java/org/primeframework/jwt/JWTTest.java",
    "is_vulnerable": 0,
    "class_name": "JWTTest",
    "subclass_name": null,
    "function_name": "test_HS256() throws Exception",
    "function_body": "{\n    JWT jwt = new JWT().setSubject(\"123456789\");\n    Signer signer = HMACSigner.newSHA256Signer(\"secret\");\n\n    assertEquals(JWT.getEncoder().encode(jwt, signer), \"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMjM0NTY3ODkifQ.qHdut1UR4-2FSAvh7U3YdeRR5r5boVqjIGQ16Ztp894\");\n  }"
  },
  {
    "id": 46,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 4,
    "human_patch": "https://github.com/inversoft/prime-jwt/commit/0d94dcef0133d699f21d217e922564adbb83a227",
    "cve_id": "CVE-2018-1000125",
    "cwe_id": "CWE-20",
    "filename": "src/test/java/org/primeframework/jwt/JWTTest.java",
    "is_vulnerable": 0,
    "class_name": "JWTTest",
    "subclass_name": null,
    "function_name": "test_HS256_manualAddedClaim() throws Exception",
    "function_body": "{\n    JWT jwt = new JWT().addClaim(\"test\", \"123456789\");\n    Signer signer = HMACSigner.newSHA256Signer(\"secret\");\n\n    assertEquals(JWT.getEncoder().encode(jwt, signer), \"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ0ZXN0IjoiMTIzNDU2Nzg5In0.0qgr4ztqB0mNXA8mtqaBSL6UJT3aqEyjHMrWDZmT4Bc\");\n  }"
  },
  {
    "id": 46,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 5,
    "human_patch": "https://github.com/inversoft/prime-jwt/commit/0d94dcef0133d699f21d217e922564adbb83a227",
    "cve_id": "CVE-2018-1000125",
    "cwe_id": "CWE-20",
    "filename": "src/test/java/org/primeframework/jwt/JWTTest.java",
    "is_vulnerable": 0,
    "class_name": "JWTTest",
    "subclass_name": null,
    "function_name": "test_HS384() throws Exception",
    "function_body": "{\n    JWT jwt = new JWT().setSubject(\"123456789\");\n    Signer signer = HMACSigner.newSHA384Signer(\"secret\");\n\n    String encodedJWT = JWT.getEncoder().encode(jwt, signer);\n    assertEquals(encodedJWT, \"eyJhbGciOiJIUzM4NCIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMjM0NTY3ODkifQ.sCHKynlQkBveA063_Z-fwcXmRYp_lKQ0fRqGNzplb14qMUj5CV3CfXwluclTF17P\");\n\n    assertEquals(JWT.getDecoder().decode(encodedJWT, HMACVerifier.newVerifier(\"secret\")).subject, jwt.subject);\n  }"
  },
  {
    "id": 46,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 6,
    "human_patch": "https://github.com/inversoft/prime-jwt/commit/0d94dcef0133d699f21d217e922564adbb83a227",
    "cve_id": "CVE-2018-1000125",
    "cwe_id": "CWE-20",
    "filename": "src/test/java/org/primeframework/jwt/JWTTest.java",
    "is_vulnerable": 0,
    "class_name": "JWTTest",
    "subclass_name": null,
    "function_name": "test_HS512() throws Exception",
    "function_body": "{\n    JWT jwt = new JWT().setSubject(\"123456789\");\n    Signer signer = HMACSigner.newSHA512Signer(\"secret\");\n\n    assertEquals(JWT.getEncoder().encode(jwt, signer), \"eyJhbGciOiJIUzUxMiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMjM0NTY3ODkifQ.MgAi9gfGkep-IoFYPHMhHz6w2Kxf0u8TZ-wNeQOLPwc8emLNKOMqBU-5dJXeaY5-8wQ1CvZycWHbEilvHgN6Ug\");\n  }"
  },
  {
    "id": 46,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 7,
    "human_patch": "https://github.com/inversoft/prime-jwt/commit/0d94dcef0133d699f21d217e922564adbb83a227",
    "cve_id": "CVE-2018-1000125",
    "cwe_id": "CWE-20",
    "filename": "src/test/java/org/primeframework/jwt/JWTTest.java",
    "is_vulnerable": 0,
    "class_name": "JWTTest",
    "subclass_name": null,
    "function_name": "test_RS256() throws Exception",
    "function_body": "{\n    JWT jwt = new JWT().setSubject(\"123456789\");\n    Signer signer = RSASigner.newSHA256Signer(new String(Files.readAllBytes(Paths.get(\"src/test/resources/rsa_private_key_4096.pem\"))));\n\n    assertEquals(JWT.getEncoder().encode(jwt, signer), \"eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMjM0NTY3ODkifQ.kRXJkOHC98D0LCT2oPg5fTmQJDFXkMRQJopbt7QM6prmQDHwjJL_xO-_EXRXnbvf5NLORto45By3XNn2ZzWmY3pAOxj46MlQ5elhROx2S-EnHZNLfQhoG8ZXPZ54q-Obz_6K7ZSlkAQ8jmeZUO3Ryi8jRlHQ2PT4LbBtLpaf982SGJfeTyUMw1LbvowZUTZSF-E6JARaokmmx8M2GeLuKcFhU-YsBTXUarKp0IJCy3jpMQ2zW_HGjyVWH8WwSIbSdpBn7ztoQEJYO-R5H3qVaAz2BsTuGLRxoyIu1iy2-QcDp5uTufmX1roXM8ciQMpcfwKGiyNpKVIZm-lF8aROXRL4kk4rqp6KUzJuOPljPXRU--xKSua-DeR0BEerKzI9hbwIMWiblCslAciNminoSc9G7pUyVwV5Z5IT8CGJkVgoyVGELeBmYCDy7LHwXrr0poc0hPbE3mJXhzolga4BB84nCg2Hb9tCNiHU8F-rKgZWCONaSSIdhQ49x8OiPafFh2DJBEBe5Xbm6xdCfh3KVG0qe4XL18R5s98aIP9UIC4i62UEgPy6W7Fr7QgUxpXrjRCERBV3MiNu4L8NNJb3oZleq5lQi72EfdS-Bt8ZUOVInIcAvSmu-3i8jB_2sF38XUXdl8gkW8k_b9dJkzDcivCFehvSqGmm3vBm5X4bNmk\");\n  }"
  },
  {
    "id": 46,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 8,
    "human_patch": "https://github.com/inversoft/prime-jwt/commit/0d94dcef0133d699f21d217e922564adbb83a227",
    "cve_id": "CVE-2018-1000125",
    "cwe_id": "CWE-20",
    "filename": "src/test/java/org/primeframework/jwt/JWTTest.java",
    "is_vulnerable": 0,
    "class_name": "JWTTest",
    "subclass_name": null,
    "function_name": "test_badEncoding() throws Exception",
    "function_body": "{\n    Verifier verifier = RSAVerifier.newVerifier(new String(Files.readAllBytes(Paths.get(\"src/test/resources/rsa_public_key_2048.pem\"))));\n    \n    expectException(InvalidJWTException.class, ()\n        -> JWT.getDecoder().decode(\"eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9 .foo.bar\", verifier));\n  }"
  },
  {
    "id": 46,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 9,
    "human_patch": "https://github.com/inversoft/prime-jwt/commit/0d94dcef0133d699f21d217e922564adbb83a227",
    "cve_id": "CVE-2018-1000125",
    "cwe_id": "CWE-20",
    "filename": "src/test/java/org/primeframework/jwt/JWTTest.java",
    "is_vulnerable": 0,
    "class_name": "JWTTest",
    "subclass_name": null,
    "function_name": "test_RS384() throws Exception",
    "function_body": "{\n    JWT jwt = new JWT().setSubject(\"123456789\");\n    Signer signer = RSASigner.newSHA384Signer(new String(Files.readAllBytes(Paths.get(\"src/test/resources/rsa_private_key_4096.pem\"))));\n\n    String encodedJWT = JWT.getEncoder().encode(jwt, signer);\n    assertEquals(encodedJWT, \"eyJhbGciOiJSUzM4NCIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMjM0NTY3ODkifQ.OkmWXzhTm7mtfpeMVNLlFjw3fJvc7yMQ1rgI5BXBPqaLSb_fpLHYAq_q5pQDDaIGg8klg9y2f784smc7-o9czX3JnzEDvO9e_sA10YIEA6Q9qRh17EATNXFG-WzSocpxPgEOQZ8lqSqZ_0waCGaUMwK5J5BB1A_70AcNGPnI7PrX76lWNNHwdK0OjkhkxX7vHR6B-uAIzih0ntQP_afr1UIzXkllmnnb1oU9cgFFD1AGDa3V0XCgitVYZA_ozbGELGMrUl_7fB_uNVEvcreUoZIEI4cfUKI6iZ8Ll4j_iLAdlpH4GRGNiQ7gMLq35AqqxKbEG8r-S-SrlRL6PkKlaJ-viMVLxoHreZow634r8A1fxR1mnrdUnn0vGmOthyjpP_TgfAsER9EJ_UUIamsKC8s6pip2jcPB7G6huHocyKBTxsoxclQgk1jOy4lZq4Js2KKM5sGfcq5SWQTW4B44KlUU1kWWmUg21jtflna38sWFdTk845phi5ITOBZ_ElJ9MdYVAgjvDsRFs_XxFENlwpwKeLD9PsaCiJhdG7EJN5qJvVogYuUMM0wyS-SOGZ1ILsTeYsjc7TtI0JUKndlUXFPubwaaxW_06zrCJR-dvWye99fIDH-u3I74XK5MKhknlgewzsXpsiPdvsMW59WUbdIZqkvok5vdkIlm4XGIqcM\");\n\n    assertEquals(JWT.getDecoder().decode(encodedJWT, RSAVerifier.newVerifier(new String(Files.readAllBytes(Paths.get(\"src/test/resources/rsa_public_key_4096.pem\"))))).subject, jwt.subject);\n  }"
  },
  {
    "id": 46,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 10,
    "human_patch": "https://github.com/inversoft/prime-jwt/commit/0d94dcef0133d699f21d217e922564adbb83a227",
    "cve_id": "CVE-2018-1000125",
    "cwe_id": "CWE-20",
    "filename": "src/test/java/org/primeframework/jwt/JWTTest.java",
    "is_vulnerable": 0,
    "class_name": "JWTTest",
    "subclass_name": null,
    "function_name": "test_RS512() throws Exception",
    "function_body": "{\n    JWT jwt = new JWT().setSubject(\"123456789\");\n    Signer signer = RSASigner.newSHA512Signer(new String(Files.readAllBytes(Paths.get(\"src/test/resources/rsa_private_key_4096.pem\"))));\n\n    assertEquals(JWT.getEncoder().encode(jwt, signer), \"eyJhbGciOiJSUzUxMiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMjM0NTY3ODkifQ.ei28WNoJdUpMlLnHr78HiTnnuKwSRLYcOpgUC3daVInT5RAc0kk2Ipx16Z-bHL_eFLSYgF3TSKdymFpNf8cnEu5T6rH0azYSZLrPmVCetDxjo-ixXK9asPOF3JuIbDjN7ow3K-CMbMCWzWp04ZAh-DNecYEd3HiGgooPVGA4HuVXZFHH8XfQ9TD-64ppBQTWgW32vkna8ILKyIXdwWXSEfCZYfLzLZnilJrz820wZJ5JMXimv2au0OwwRobUMLEBUM4iuEPXLf5wFJU6LcU0XMuovavfIXKDpvP9Yfz6UplMlFvIr9y72xExfaNt32vwneAP-Fpg2x9wYvR0W8LhXKZaFRfcYwhbj17GCAbpx34hjiqnwyFStn5Qx_QHz_Y7ck-ZXB2MGUkiYGj9y_8bQNx-LIaTQUX6sONTNdVVCfnOnMHFqVbupGho24K7885-8BxCRojvA0ggneF6dsKCQvAt2rsVRso0TrCVxwYItb9tRsyhCbWou-zh_08JlYGVXPiGY3RRQDfxCc9RHQUflWRS9CBcPtoaco4mFKZSM-9e_xoYx__DEzM3UjaI4jReLM-IARwlVPoHJa2Vcb5wngZTaxGf2ToMq7R_8KecZymb3OaA2X1e8GS2300ySwsXbOz0sJv2a7_JUncSEBPSsb2vMMurxSJ4E3RTAc4s3aU\");\n  }"
  },
  {
    "id": 46,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 11,
    "human_patch": "https://github.com/inversoft/prime-jwt/commit/0d94dcef0133d699f21d217e922564adbb83a227",
    "cve_id": "CVE-2018-1000125",
    "cwe_id": "CWE-20",
    "filename": "src/test/java/org/primeframework/jwt/JWTTest.java",
    "is_vulnerable": 0,
    "class_name": "JWTTest",
    "subclass_name": null,
    "function_name": "test_RSA_1024Key() throws Exception",
    "function_body": "{\n    expectException(InvalidKeyLengthException.class, ()\n        -> RSASigner.newSHA256Signer(new String(Files.readAllBytes(Paths.get(\"src/test/resources/rsa_private_key_1024.pem\")))));\n    expectException(InvalidKeyLengthException.class, ()\n        -> RSAVerifier.newVerifier(new String(Files.readAllBytes(Paths.get(\"src/test/resources/rsa_public_key_1024.pem\")))));\n  }"
  },
  {
    "id": 46,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 12,
    "human_patch": "https://github.com/inversoft/prime-jwt/commit/0d94dcef0133d699f21d217e922564adbb83a227",
    "cve_id": "CVE-2018-1000125",
    "cwe_id": "CWE-20",
    "filename": "src/test/java/org/primeframework/jwt/JWTTest.java",
    "is_vulnerable": 0,
    "class_name": "JWTTest",
    "subclass_name": null,
    "function_name": "test_complexPayload() throws Exception",
    "function_body": "{\n    JWT expectedJWT = new JWT()\n        .setAudience(Arrays.asList(\"www.acme.com\", \"www.vandelayindustries.com\"))\n        .setExpiration(ZonedDateTime.now(ZoneOffset.UTC).plusMinutes(60).truncatedTo(ChronoUnit.SECONDS))\n        .setIssuedAt(ZonedDateTime.now(ZoneOffset.UTC).truncatedTo(ChronoUnit.SECONDS))\n        .setIssuer(\"www.inversoft.com\")\n        .setNotBefore(ZonedDateTime.now(ZoneOffset.UTC).minusMinutes(5).truncatedTo(ChronoUnit.SECONDS))\n        .setUniqueId(UUID.randomUUID().toString())\n        .setSubject(\"123456789\")\n        .addClaim(\"foo\", \"bar\")\n        .addClaim(\"timestamp\", 1476062602926L)\n        .addClaim(\"meaningOfLife\", 42)\n        .addClaim(\"bar\", Arrays.asList(\"bing\", \"bam\", \"boo\"))\n        .addClaim(\"www.inversoft.com/claims/is_admin\", true);\n\n    Signer signer = HMACSigner.newSHA256Signer(\"secret\");\n    Verifier verifier = HMACVerifier.newVerifier(\"secret\");\n\n    String encodedJWT = JWT.getEncoder().encode(expectedJWT, signer);\n    JWT actualJwt = JWT.getDecoder().decode(encodedJWT, verifier);\n\n    assertEquals(actualJwt.audience, expectedJWT.audience);\n    assertEquals(actualJwt.expiration, expectedJWT.expiration);\n    assertEquals(actualJwt.issuedAt, expectedJWT.issuedAt);\n    assertEquals(actualJwt.issuer, expectedJWT.issuer);\n    assertEquals(actualJwt.notBefore, expectedJWT.notBefore);\n    assertEquals(actualJwt.uniqueId, expectedJWT.uniqueId);\n    assertEquals(actualJwt.subject, expectedJWT.subject);\n    assertEquals(actualJwt.getString(\"foo\"), expectedJWT.getString(\"foo\"));\n    assertEquals(actualJwt.getLong(\"timestamp\"), expectedJWT.getLong(\"timestamp\"));\n    assertEquals(actualJwt.getInteger(\"meaningOfLife\"), expectedJWT.getInteger(\"meaningOfLife\"));\n    assertEquals(actualJwt.getObject(\"bar\"), expectedJWT.getObject(\"bar\"));\n    assertEquals(actualJwt.getBoolean(\"www.inversoft.com/claims/is_admin\"), expectedJWT.getBoolean(\"www.inversoft.com/claims/is_admin\"));\n\n    \n    Map<String, Object> rawClaims = actualJwt.getRawClaims();\n    assertEquals(rawClaims.get(\"aud\"), expectedJWT.audience);\n    assertEquals(rawClaims.get(\"exp\"), expectedJWT.expiration.toEpochSecond());\n    assertEquals(rawClaims.get(\"iat\"), expectedJWT.issuedAt.toEpochSecond());\n    assertEquals(rawClaims.get(\"iss\"), expectedJWT.issuer);\n    assertEquals(rawClaims.get(\"nbf\"), expectedJWT.notBefore.toEpochSecond());\n    assertEquals(rawClaims.get(\"jti\"), expectedJWT.uniqueId);\n    assertEquals(rawClaims.get(\"sub\"), expectedJWT.subject);\n    assertEquals(rawClaims.get(\"foo\"), expectedJWT.getString(\"foo\"));\n    assertEquals(rawClaims.get(\"timestamp\"), expectedJWT.getLong(\"timestamp\"));\n    assertEquals(rawClaims.get(\"meaningOfLife\"), expectedJWT.getInteger(\"meaningOfLife\"));\n    assertEquals(rawClaims.get(\"bar\"), expectedJWT.getObject(\"bar\"));\n    assertEquals(rawClaims.get(\"www.inversoft.com/claims/is_admin\"), expectedJWT.getBoolean(\"www.inversoft.com/claims/is_admin\"));\n  }"
  },
  {
    "id": 46,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 13,
    "human_patch": "https://github.com/inversoft/prime-jwt/commit/0d94dcef0133d699f21d217e922564adbb83a227",
    "cve_id": "CVE-2018-1000125",
    "cwe_id": "CWE-20",
    "filename": "src/test/java/org/primeframework/jwt/JWTTest.java",
    "is_vulnerable": 0,
    "class_name": "JWTTest",
    "subclass_name": null,
    "function_name": "test_encodedJwtWithSignatureRemoved() throws Exception",
    "function_body": "{\n    \n    JWT jwt = new JWT().setSubject(\"art\");\n    String encodedJWT = JWT.getEncoder().encode(jwt, HMACSigner.newSHA256Signer(\"secret\"));\n\n    String hackedJWT = encodedJWT.substring(0, encodedJWT.lastIndexOf(\".\"));\n\n    expectException(InvalidJWTException.class, ()\n        -> JWT.getDecoder().decode(hackedJWT, HMACVerifier.newVerifier(\"secret\")));\n  }"
  },
  {
    "id": 46,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 14,
    "human_patch": "https://github.com/inversoft/prime-jwt/commit/0d94dcef0133d699f21d217e922564adbb83a227",
    "cve_id": "CVE-2018-1000125",
    "cwe_id": "CWE-20",
    "filename": "src/test/java/org/primeframework/jwt/JWTTest.java",
    "is_vulnerable": 0,
    "class_name": "JWTTest",
    "subclass_name": null,
    "function_name": "test_expiredThrows() throws Exception",
    "function_body": "{\n    JWT expectedJWT = new JWT()\n        .setExpiration(ZonedDateTime.now(ZoneOffset.UTC).minusMinutes(1).truncatedTo(ChronoUnit.SECONDS));\n\n    Signer signer = HMACSigner.newSHA256Signer(\"secret\");\n    Verifier verifier = HMACVerifier.newVerifier(\"secret\");\n\n    String encodedJWT = JWT.getEncoder().encode(expectedJWT, signer);\n\n    expectException(JWTExpiredException.class, ()\n        -> JWT.getDecoder().decode(encodedJWT, verifier));\n  }"
  },
  {
    "id": 46,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 15,
    "human_patch": "https://github.com/inversoft/prime-jwt/commit/0d94dcef0133d699f21d217e922564adbb83a227",
    "cve_id": "CVE-2018-1000125",
    "cwe_id": "CWE-20",
    "filename": "src/test/java/org/primeframework/jwt/JWTTest.java",
    "is_vulnerable": 0,
    "class_name": "JWTTest",
    "subclass_name": null,
    "function_name": "test_multipleSignersAndVerifiers() throws Exception",
    "function_body": "{\n    JWT jwt = new JWT().setSubject(\"123456789\");\n\n    \n    Signer signer1 = HMACSigner.newSHA512Signer(\"secret1\");\n    Signer signer2 = HMACSigner.newSHA512Signer(\"secret2\");\n    Signer signer3 = RSASigner.newSHA256Signer(new String(Files.readAllBytes(Paths.get(\"src/test/resources/rsa_private_key_2048.pem\"))));\n\n    \n    String encodedJWT1 = JWT.getEncoder().encode(jwt, signer1, h -> h.set(\"kid\", \"verifier1\"));\n    String encodedJWT2 = JWT.getEncoder().encode(jwt, signer2, h -> h.set(\"kid\", \"verifier2\"));\n    String encodedJWT3 = JWT.getEncoder().encode(jwt, signer3, h -> h.set(\"kid\", \"verifier3\"));\n\n    Verifier verifier1 = HMACVerifier.newVerifier(\"secret1\");\n    Verifier verifier2 = HMACVerifier.newVerifier(\"secret2\");\n    Verifier verifier3 = RSAVerifier.newVerifier(new String(Files.readAllBytes(Paths.get(\"src/test/resources/rsa_public_key_2048.pem\"))));\n\n    Map<String, Verifier> verifiers = new HashMap<>();\n    verifiers.put(\"verifier1\", verifier1);\n    verifiers.put(\"verifier2\", verifier2);\n    verifiers.put(\"verifier3\", verifier3);\n\n    \n    JWT jwt1 = JWT.getDecoder().decode(encodedJWT1, verifiers);\n    JWT jwt2 = JWT.getDecoder().decode(encodedJWT2, verifiers);\n    JWT jwt3 = JWT.getDecoder().decode(encodedJWT3, verifiers);\n\n    assertEquals(jwt1.subject, jwt2.subject);\n    assertEquals(jwt2.subject, jwt3.subject);\n  }"
  },
  {
    "id": 46,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 16,
    "human_patch": "https://github.com/inversoft/prime-jwt/commit/0d94dcef0133d699f21d217e922564adbb83a227",
    "cve_id": "CVE-2018-1000125",
    "cwe_id": "CWE-20",
    "filename": "src/test/java/org/primeframework/jwt/JWTTest.java",
    "is_vulnerable": 0,
    "class_name": "JWTTest",
    "subclass_name": null,
    "function_name": "test_noVerification() throws Exception",
    "function_body": "{\n    \n    JWT jwt = new JWT().setSubject(\"art\");\n    String encodedJWT = JWT.getEncoder().encode(jwt, HMACSigner.newSHA256Signer(\"secret\"));\n\n    expectException(MissingVerifierException.class, ()\n        -> JWT.getDecoder().decode(encodedJWT));\n  }"
  },
  {
    "id": 46,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 17,
    "human_patch": "https://github.com/inversoft/prime-jwt/commit/0d94dcef0133d699f21d217e922564adbb83a227",
    "cve_id": "CVE-2018-1000125",
    "cwe_id": "CWE-20",
    "filename": "src/test/java/org/primeframework/jwt/JWTTest.java",
    "is_vulnerable": 0,
    "class_name": "JWTTest",
    "subclass_name": null,
    "function_name": "test_none() throws Exception",
    "function_body": "{\n    JWT jwt = new JWT().setSubject(\"123456789\");\n    Signer signer = new UnsecuredSigner();\n\n    String encodedJWT = JWT.getEncoder().encode(jwt, signer);\n    assertEquals(encodedJWT, \"eyJhbGciOiJub25lIiwidHlwIjoiSldUIn0.eyJzdWIiOiIxMjM0NTY3ODkifQ.\");\n\n    JWT actual = JWT.getDecoder().decode(encodedJWT);\n    assertEquals(actual.subject, jwt.subject);\n  }"
  },
  {
    "id": 46,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 18,
    "human_patch": "https://github.com/inversoft/prime-jwt/commit/0d94dcef0133d699f21d217e922564adbb83a227",
    "cve_id": "CVE-2018-1000125",
    "cwe_id": "CWE-20",
    "filename": "src/test/java/org/primeframework/jwt/JWTTest.java",
    "is_vulnerable": 0,
    "class_name": "JWTTest",
    "subclass_name": null,
    "function_name": "test_notBeforeThrows() throws Exception",
    "function_body": "{\n    JWT expectedJWT = new JWT()\n        .setExpiration(ZonedDateTime.now(ZoneOffset.UTC).plusMinutes(60).truncatedTo(ChronoUnit.SECONDS))\n        .setIssuedAt(ZonedDateTime.now(ZoneOffset.UTC).truncatedTo(ChronoUnit.SECONDS))\n        .setIssuer(\"www.inversoft.com\")\n        .setNotBefore(ZonedDateTime.now(ZoneOffset.UTC).plusMinutes(5).truncatedTo(ChronoUnit.SECONDS));\n\n    Signer signer = HMACSigner.newSHA256Signer(\"secret\");\n    Verifier verifier = HMACVerifier.newVerifier(\"secret\");\n\n    String encodedJWT = JWT.getEncoder().encode(expectedJWT, signer);\n\n    expectException(JWTUnavailableForProcessingException.class, ()\n        -> JWT.getDecoder().decode(encodedJWT, verifier));\n  }"
  },
  {
    "id": 46,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 19,
    "human_patch": "https://github.com/inversoft/prime-jwt/commit/0d94dcef0133d699f21d217e922564adbb83a227",
    "cve_id": "CVE-2018-1000125",
    "cwe_id": "CWE-20",
    "filename": "src/test/java/org/primeframework/jwt/JWTTest.java",
    "is_vulnerable": 0,
    "class_name": "JWTTest",
    "subclass_name": null,
    "function_name": "test_zonedDateTime() throws Exception",
    "function_body": "{\n    ZonedDateTime expiration = ZonedDateTime.now(ZoneOffset.UTC).plusMinutes(60).truncatedTo(ChronoUnit.SECONDS);\n    JWT expectedJWT = new JWT().setExpiration(expiration);\n\n    Signer signer = HMACSigner.newSHA256Signer(\"secret\");\n    Verifier verifier = HMACVerifier.newVerifier(\"secret\");\n\n    String encodedJWT1 = JWT.getEncoder().encode(expectedJWT, signer);\n    JWT actualJWT1 = JWT.getDecoder().decode(encodedJWT1, verifier);\n\n    assertEquals(actualJWT1.expiration, expectedJWT.expiration);\n  }"
  },
  {
    "id": 46,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 20,
    "human_patch": "https://github.com/inversoft/prime-jwt/commit/0d94dcef0133d699f21d217e922564adbb83a227",
    "cve_id": "CVE-2018-1000125",
    "cwe_id": "CWE-20",
    "filename": "src/test/java/org/primeframework/jwt/JWTTest.java",
    "is_vulnerable": 0,
    "class_name": "JWTTest",
    "subclass_name": null,
    "function_name": "expectException(Class<? extends Exception> expected, ThrowingRunnable runnable)",
    "function_body": "{\n    try {\n      runnable.run();\n      fail(\"Expected [\" + expected.getCanonicalName() + \"] to be thrown. No Exception was thrown.\");\n    } catch (Exception e) {\n      if (!e.getClass().isAssignableFrom(expected)) {\n        fail(\"Expected [\" + expected.getCanonicalName() + \"] to be thrown. Caught this instead [\" + e.getClass().getCanonicalName() + \"]\");\n      }\n    }\n  }"
  },
  {
    "id": 46,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 21,
    "human_patch": "https://github.com/inversoft/prime-jwt/commit/0d94dcef0133d699f21d217e922564adbb83a227",
    "cve_id": "CVE-2018-1000125",
    "cwe_id": "CWE-20",
    "filename": "src/test/java/org/primeframework/jwt/JWTTest.java",
    "is_vulnerable": 0,
    "class_name": "JWTTest",
    "subclass_name": "ThrowingRunnable",
    "function_name": "run() throws Exception",
    "function_body": null
  },
  {
    "id": 47,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 0,
    "human_patch": "https://github.com/javamelody/javamelody/commit/aacbc46151ff4ac1ca34ce0899c2a6113071c66e",
    "cve_id": "CVE-2013-4378",
    "cwe_id": "CWE-79",
    "filename": "javamelody-core/src/main/java/net/bull/javamelody/HtmlSessionInformationsReport.java",
    "is_vulnerable": 0,
    "class_name": "HtmlSessionInformationsReport",
    "subclass_name": null,
    "function_name": "toHtml() throws IOException",
    "function_body": "{\r\n\t\twriteBackAndRefreshLinks();\r\n\t\twriteln(\"<br/>\");\r\n\r\n\t\tassert sessionsInformations != null;\r\n\t\tif (sessionsInformations.isEmpty()) {\r\n\t\t\twriteln(\"#Aucune_session#\");\r\n\t\t\treturn;\r\n\t\t}\r\n\t\twriteTitle(\"system-users.png\", getString(\"Sessions\"));\r\n\t\twriteSessions(sessionsInformations);\r\n\t\tlong totalSerializedSize = 0;\r\n\t\tint nbSerializableSessions = 0;\r\n\t\tfor (final SessionInformations sessionInformations : sessionsInformations) {\r\n\t\t\tfinal int size = sessionInformations.getSerializedSize();\r\n\t\t\tif (size >= 0) {\r\n\t\t\t\ttotalSerializedSize += size;\r\n\t\t\t\tnbSerializableSessions++;\r\n\t\t\t}\r\n\t\t}\r\n\t\tfinal long meanSerializedSize;\r\n\t\tif (nbSerializableSessions > 0) {\r\n\t\t\tmeanSerializedSize = totalSerializedSize / nbSerializableSessions;\r\n\t\t} else {\r\n\t\t\tmeanSerializedSize = -1;\r\n\t\t}\r\n\t\twriteln(\"<div align='right'>\"\r\n\t\t\t\t+ getFormattedString(\"nb_sessions\", sessionsInformations.size()) + \"<br/><br/>\"\r\n\t\t\t\t+ getFormattedString(\"taille_moyenne_sessions\", meanSerializedSize) + \"</div>\");\r\n\t}"
  },
  {
    "id": 47,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 1,
    "human_patch": "https://github.com/javamelody/javamelody/commit/aacbc46151ff4ac1ca34ce0899c2a6113071c66e",
    "cve_id": "CVE-2013-4378",
    "cwe_id": "CWE-79",
    "filename": "javamelody-core/src/main/java/net/bull/javamelody/HtmlSessionInformationsReport.java",
    "is_vulnerable": 0,
    "class_name": "HtmlSessionInformationsReport",
    "subclass_name": null,
    "function_name": "writeSessions(List<SessionInformations> sessions) throws IOException",
    "function_body": "{\r\n\t\tboolean displayUser = false;\r\n\t\tfor (final SessionInformations sessionInformations : sessions) {\r\n\t\t\tif (sessionInformations.getRemoteUser() != null) {\r\n\t\t\t\tdisplayUser = true;\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\t\tfinal HtmlTable table = new HtmlTable();\r\n\t\ttable.beginTable(getString(\"Sessions\"));\r\n\t\twrite(\"<th>#Session_id#</th><th class='sorttable_numeric'>#Dernier_acces#</th>\");\r\n\t\twrite(\"<th class='sorttable_numeric'>#Age#</th><th class='sorttable_date'>#Expiration#</th>\");\r\n\t\twrite(\"<th class='sorttable_numeric'>#Nb_attributs#</th><th>#Serialisable#</th><th>#Taille_serialisee#</th>\");\r\n\t\twrite(\"<th class='sorttable_numeric'>#Adresse_IP#</th><th>#Pays#</th>\");\r\n\t\tif (displayUser) {\r\n\t\t\twrite(\"<th>#Utilisateur#</th>\");\r\n\t\t}\r\n\t\twrite(\"<th class='noPrint'>#Invalider#</th>\");\r\n\t\tfor (final SessionInformations session : sessions) {\r\n\t\t\ttable.nextRow();\r\n\t\t\twriteSession(session, displayUser);\r\n\t\t}\r\n\t\ttable.endTable();\r\n\t}"
  },
  {
    "id": 47,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 2,
    "human_patch": "https://github.com/javamelody/javamelody/commit/aacbc46151ff4ac1ca34ce0899c2a6113071c66e",
    "cve_id": "CVE-2013-4378",
    "cwe_id": "CWE-79",
    "filename": "javamelody-core/src/main/java/net/bull/javamelody/HtmlSessionInformationsReport.java",
    "is_vulnerable": 0,
    "class_name": "HtmlSessionInformationsReport",
    "subclass_name": null,
    "function_name": "writeBackAndRefreshLinks() throws IOException",
    "function_body": "{\r\n\t\twriteln(\"<div class='noPrint'>\");\r\n\t\twriteln(\"<a href='javascript:history.back()'>\");\r\n\t\twriteln(\"<img src='?resource=action_back.png' alt='#Retour#'/> #Retour#</a>\");\r\n\t\twriteln(\"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\");\r\n\t\twriteln(A_HREF_PART_SESSIONS + \"'>\");\r\n\t\twriteln(\"<img src='?resource=action_refresh.png' alt='#Actualiser#'/> #Actualiser#</a>\");\r\n\t\tif (isPdfEnabled()) {\r\n\t\t\twriteln(\"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\");\r\n\t\t\twrite(A_HREF_PART_SESSIONS + \"&amp;format=pdf' title='#afficher_PDF#'>\");\r\n\t\t\twrite(\"<img src='?resource=pdf.png' alt='#PDF#'/> #PDF#</a>\");\r\n\t\t}\r\n\t\twriteln(\"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\");\r\n\t\twriteln(A_HREF_PART_SESSIONS\r\n\t\t\t\t+ \"&amp;action=invalidate_sessions' onclick=\\\"javascript:return confirm('\"\r\n\t\t\t\t+ getStringForJavascript(\"confirm_invalidate_sessions\") + \"');\\\">\");\r\n\t\twriteln(\"<img width='16' height='16' src='?resource=user-trash.png' alt='#invalidate_sessions#' title='#invalidate_sessions#' /> #invalidate_sessions#</a>\");\r\n\t\twriteln(\"</div>\");\r\n\t}"
  },
  {
    "id": 47,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 3,
    "human_patch": "https://github.com/javamelody/javamelody/commit/aacbc46151ff4ac1ca34ce0899c2a6113071c66e",
    "cve_id": "CVE-2013-4378",
    "cwe_id": "CWE-79",
    "filename": "javamelody-core/src/main/java/net/bull/javamelody/HtmlSessionInformationsReport.java",
    "is_vulnerable": 0,
    "class_name": "HtmlSessionInformationsReport",
    "subclass_name": null,
    "function_name": "writeBackAndRefreshLinksForSession(String sessionId) throws IOException",
    "function_body": "{\r\n\t\twriteln(\"<div class='noPrint'>\");\r\n\t\twriteln(\"<a href='javascript:history.back()'><img src='?resource=action_back.png' alt='#Retour#'/> #Retour#</a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\");\r\n\t\twriteln(A_HREF_PART_SESSIONS + \"&amp;sessionId=\" + urlEncode(sessionId) + \"'>\");\r\n\t\twriteln(\"<img src='?resource=action_refresh.png' alt='#Actualiser#'/> #Actualiser#</a>\");\r\n\t\twriteln(\"</div>\");\r\n\t}"
  },
  {
    "id": 47,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 4,
    "human_patch": "https://github.com/javamelody/javamelody/commit/aacbc46151ff4ac1ca34ce0899c2a6113071c66e",
    "cve_id": "CVE-2013-4378",
    "cwe_id": "CWE-79",
    "filename": "javamelody-core/src/main/java/net/bull/javamelody/HtmlSessionInformationsReport.java",
    "is_vulnerable": 1,
    "class_name": "HtmlSessionInformationsReport",
    "subclass_name": null,
    "function_name": "writeSession(SessionInformations session, boolean displayUser) throws IOException",
    "function_body": "{\r\n\t\tfinal String nextColumnAlignRight = \"</td><td align='right'>\";\r\n\t\tfinal String nextColumnAlignCenter = \"</td><td align='center'>\";\r\n\t\twrite(\"<td><a href='?part=sessions&amp;sessionId=\");\r\n\t\twrite(htmlEncodeButNotSpace(session.getId()));\r\n\t\twrite(\"'>\");\r\n\t\twrite(htmlEncodeButNotSpace(session.getId()));\r\n\t\twrite(\"</a>\");\r\n\t\twrite(nextColumnAlignRight);\r\n\t\twrite(durationFormat.format(session.getLastAccess()));\r\n\t\twrite(nextColumnAlignRight);\r\n\t\twrite(durationFormat.format(session.getAge()));\r\n\t\twrite(nextColumnAlignRight);\r\n\t\twrite(expiryFormat.format(session.getExpirationDate()));\r\n\r\n\t\twrite(nextColumnAlignRight);\r\n\t\twrite(integerFormat.format(session.getAttributeCount()));\r\n\t\twrite(nextColumnAlignCenter);\r\n\t\tif (session.isSerializable()) {\r\n\t\t\twrite(\"#oui#\");\r\n\t\t} else {\r\n\t\t\twrite(\"<span class='severe'>#non#</span>\");\r\n\t\t}\r\n\t\twrite(nextColumnAlignRight);\r\n\t\twrite(integerFormat.format(session.getSerializedSize()));\r\n\t\tfinal String nextColumn = \"</td><td>\";\r\n\t\twrite(nextColumn);\r\n\t\tfinal String remoteAddr = session.getRemoteAddr();\r\n\t\tif (remoteAddr == null) {\r\n\t\t\twrite(\"&nbsp;\");\r\n\t\t} else {\r\n\t\t\twrite(remoteAddr);\r\n\t\t}\r\n\t\twrite(nextColumnAlignCenter);\r\n\t\twriteCountry(session);\r\n\t\tif (displayUser) {\r\n\t\t\twrite(nextColumn);\r\n\t\t\tfinal String remoteUser = session.getRemoteUser();\r\n\t\t\tif (remoteUser == null) {\r\n\t\t\t\twrite(\"&nbsp;\");\r\n\t\t\t} else {\r\n\t\t\t\twriteDirectly(htmlEncodeButNotSpace(remoteUser));\r\n\t\t\t}\r\n\t\t}\r\n\t\twrite(\"</td><td align='center' class='noPrint'>\");\r\n\t\twrite(A_HREF_PART_SESSIONS);\r\n\t\twrite(\"&amp;action=invalidate_session&amp;sessionId=\");\r\n\t\twrite(urlEncode(session.getId()));\r\n\t\twrite(\"' onclick=\\\"javascript:return confirm('\"\r\n\t\t\t\t+ getStringForJavascript(\"confirm_invalidate_session\") + \"');\\\">\");\r\n\t\twrite(\"<img width='16' height='16' src='?resource=user-trash.png' alt='#invalidate_session#' title='#invalidate_session#' />\");\r\n\t\twrite(\"</a>\");\r\n\t\twrite(\"</td>\");\r\n\t}"
  },
  {
    "id": 47,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 5,
    "human_patch": "https://github.com/javamelody/javamelody/commit/aacbc46151ff4ac1ca34ce0899c2a6113071c66e",
    "cve_id": "CVE-2013-4378",
    "cwe_id": "CWE-79",
    "filename": "javamelody-core/src/main/java/net/bull/javamelody/HtmlSessionInformationsReport.java",
    "is_vulnerable": 0,
    "class_name": "HtmlSessionInformationsReport",
    "subclass_name": null,
    "function_name": "writeCountry(SessionInformations session) throws IOException",
    "function_body": "{\r\n\t\tfinal String country = session.getCountry();\r\n\t\tif (country == null) {\r\n\t\t\twrite(\"&nbsp;\");\r\n\t\t} else {\r\n\t\t\tfinal String fileName = \"flags/\" + country + \".gif\";\r\n\t\t\tif (getClass().getResource(Parameters.getResourcePath(fileName)) == null) {\r\n\t\t\t\twrite(country);\r\n\t\t\t} else {\r\n\t\t\t\twrite(\"<img src='?resource=\");\r\n\t\t\t\twrite(fileName);\r\n\t\t\t\twrite(\"' alt='\");\r\n\t\t\t\twrite(country);\r\n\t\t\t\twrite(\"' title='\");\r\n\t\t\t\twrite(session.getCountryDisplay());\r\n\t\t\t\twrite(\"' />\");\r\n\t\t\t}\r\n\t\t}\r\n\t}"
  },
  {
    "id": 47,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 6,
    "human_patch": "https://github.com/javamelody/javamelody/commit/aacbc46151ff4ac1ca34ce0899c2a6113071c66e",
    "cve_id": "CVE-2013-4378",
    "cwe_id": "CWE-79",
    "filename": "javamelody-core/src/main/java/net/bull/javamelody/HtmlSessionInformationsReport.java",
    "is_vulnerable": 0,
    "class_name": "HtmlSessionInformationsReport",
    "subclass_name": null,
    "function_name": "writeSessionDetails(String sessionId, SessionInformations sessionInformations) throws IOException",
    "function_body": "{\r\n\t\twriteBackAndRefreshLinksForSession(sessionId);\r\n\t\twriteln(\"<br/>\");\r\n\r\n\t\tif (sessionInformations == null) {\r\n\t\t\twriteln(getFormattedString(\"session_invalidee\", htmlEncodeButNotSpace(sessionId)));\r\n\t\t\treturn;\r\n\t\t}\r\n\t\twriteTitle(\"system-users.png\",\r\n\t\t\t\tgetFormattedString(\"Details_session\", htmlEncodeButNotSpace(sessionId)));\r\n\t\twriteSessions(Collections.singletonList(sessionInformations));\r\n\r\n\t\twriteln(\"<br/><b>#Attributs#</b>\");\r\n\t\twriteSessionAttributes(sessionInformations);\r\n\t}"
  },
  {
    "id": 47,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 7,
    "human_patch": "https://github.com/javamelody/javamelody/commit/aacbc46151ff4ac1ca34ce0899c2a6113071c66e",
    "cve_id": "CVE-2013-4378",
    "cwe_id": "CWE-79",
    "filename": "javamelody-core/src/main/java/net/bull/javamelody/HtmlSessionInformationsReport.java",
    "is_vulnerable": 0,
    "class_name": "HtmlSessionInformationsReport",
    "subclass_name": null,
    "function_name": "writeSessionAttributes(SessionInformations sessionInformations) throws IOException",
    "function_body": "{\r\n\t\tfinal HtmlTable table = new HtmlTable();\r\n\t\ttable.beginTable(getString(\"Attributs\"));\r\n\t\twrite(\"<th>#Nom#</th><th>Type</th><th>#Serialisable#</th><th>#Taille_serialisee#</th><th>#Contenu#</th>\");\r\n\t\tfor (final SessionAttribute sessionAttribute : sessionInformations.getAttributes()) {\r\n\t\t\ttable.nextRow();\r\n\t\t\twriteAttribute(sessionAttribute);\r\n\t\t}\r\n\t\ttable.endTable();\r\n\t}"
  },
  {
    "id": 47,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 8,
    "human_patch": "https://github.com/javamelody/javamelody/commit/aacbc46151ff4ac1ca34ce0899c2a6113071c66e",
    "cve_id": "CVE-2013-4378",
    "cwe_id": "CWE-79",
    "filename": "javamelody-core/src/main/java/net/bull/javamelody/HtmlSessionInformationsReport.java",
    "is_vulnerable": 0,
    "class_name": "HtmlSessionInformationsReport",
    "subclass_name": null,
    "function_name": "writeAttribute(SessionAttribute sessionAttribute) throws IOException",
    "function_body": "{\r\n\t\twrite(\"<td>\");\r\n\t\twriteDirectly(htmlEncodeButNotSpace(sessionAttribute.getName()));\r\n\t\twrite(\"</td><td>\");\r\n\t\twrite(String.valueOf(sessionAttribute.getType()));\r\n\t\twrite(\"</td><td align='center'>\");\r\n\t\tif (sessionAttribute.isSerializable()) {\r\n\t\t\twrite(\"#oui#\");\r\n\t\t} else {\r\n\t\t\twrite(\"<span class='severe'>#non#</span>\");\r\n\t\t}\r\n\t\twrite(\"</td><td align='right'>\");\r\n\t\twrite(integerFormat.format(sessionAttribute.getSerializedSize()));\r\n\t\twrite(\"</td><td>\");\r\n\t\twriteDirectly(htmlEncodeButNotSpace(String.valueOf(sessionAttribute.getContent())));\r\n\t\twrite(\"</td>\");\r\n\t}"
  },
  {
    "id": 48,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 0,
    "human_patch": "https://github.com/jenkinsci/ccm-plugin/commit/066cb43b4413b3490d822ec8b8a32072ebd213ca",
    "cve_id": "CVE-2018-1000054",
    "cwe_id": "CWE-918",
    "filename": "src/main/java/hudson/plugins/ccm/parser/CcmParser.java",
    "is_vulnerable": 0,
    "class_name": "CcmParser",
    "subclass_name": null,
    "function_name": "parse(InputStream file, String moduleName) throws InvocationTargetException",
    "function_body": "{\n\t\ttry {\n            Ccm module = parseCCMXmlFile(file);\n\t\t\tif (module == null) {\n                throw new SAXException(\"Input stream is not a CCM file.\");\n            }\n\n            return convert(module, moduleName);\n        }\n        catch (IOException exception) {\n            throw new InvocationTargetException(exception);\n        }\n        catch (SAXException exception) {\n            throw new InvocationTargetException(exception);\n        }\n\t}"
  },
  {
    "id": 48,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 1,
    "human_patch": "https://github.com/jenkinsci/ccm-plugin/commit/066cb43b4413b3490d822ec8b8a32072ebd213ca",
    "cve_id": "CVE-2018-1000054",
    "cwe_id": "CWE-918",
    "filename": "src/main/java/hudson/plugins/ccm/parser/CcmParser.java",
    "is_vulnerable": 1,
    "class_name": "CcmParser",
    "subclass_name": null,
    "function_name": "parseCCMXmlFile(InputStream ccmXmlFile) throws IOException, SAXException",
    "function_body": "{\n\t\tDigester digester = new Digester();\n\t\tdigester.setValidating(false);\n\t\tdigester.setClassLoader(CcmParser.class.getClassLoader());\n\n\t\tString rootXPath = \"ccm\";\n\t\tdigester.addObjectCreate(rootXPath, Ccm.class);\n\t\tdigester.addSetProperties(rootXPath);\n\n\t\tString fileMetric = \"ccm/metric\";\n\t\tdigester.addObjectCreate(fileMetric, Metric.class);\n\t\tdigester.addSetProperties(fileMetric);\n\t\tdigester.addBeanPropertySetter(\"ccm/metric/complexity\");\n\t\tdigester.addBeanPropertySetter(\"ccm/metric/unit\");\n\t\tdigester.addBeanPropertySetter(\"ccm/metric/classification\");\n\t\tdigester.addBeanPropertySetter(\"ccm/metric/file\");\n\t\tdigester.addBeanPropertySetter(\"ccm/metric/startLineNumber\");\n\t\tdigester.addBeanPropertySetter(\"ccm/metric/endLineNumber\");\n\t\tdigester.addSetNext(fileMetric, \"addMetric\", Metric.class.getName());\n\n\t\treturn (Ccm)digester.parse(ccmXmlFile);\n\t}"
  },
  {
    "id": 48,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 2,
    "human_patch": "https://github.com/jenkinsci/ccm-plugin/commit/066cb43b4413b3490d822ec8b8a32072ebd213ca",
    "cve_id": "CVE-2018-1000054",
    "cwe_id": "CWE-918",
    "filename": "src/main/java/hudson/plugins/ccm/parser/CcmParser.java",
    "is_vulnerable": 0,
    "class_name": "CcmParser",
    "subclass_name": null,
    "function_name": "convert(Ccm collection, String moduleName)",
    "function_body": "{\n\t\tArrayList<FileAnnotation> annotations = new ArrayList<FileAnnotation>();\n\t\t\n\t\tfor (Metric metric : collection.getMetrics()) {\n\t\t\tPriority priority = calculateMetricPriority(metric);\n\n\t\t\tString complexity = String.format(\"%s has a complexity of %d\", metric.getUnit(), metric.getComplexity());\n\n\t\t\tBug bug = new Bug(priority, complexity, metric.getClassification(),\n\t\t\t\t\t\"Cyclomatic Complexity\", metric.getStartLineNumber(), metric.getEndLineNumber());\n\t\t\tbug.setPackageName(\"-\");\n\t\t\tbug.setModuleName(moduleName);\n\t\t\tbug.setFileName(metric.getFile());\n\t\t\tbug.setColumnPosition(0, 0);\n\n\t\t\ttry {\n\t\t\t\tbug.setContextHashCode(createContextHashCode(metric.getFile() + metric.getUnit() + metric.getClassification(), 0));\n\t\t\t} catch (IOException exception) {\n\t\t\t\t\n\t\t\t}\n\n\t\t\tannotations.add(bug);\n\t\t}\n\n\t\treturn annotations;\n\t}"
  },
  {
    "id": 48,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 3,
    "human_patch": "https://github.com/jenkinsci/ccm-plugin/commit/066cb43b4413b3490d822ec8b8a32072ebd213ca",
    "cve_id": "CVE-2018-1000054",
    "cwe_id": "CWE-918",
    "filename": "src/main/java/hudson/plugins/ccm/parser/CcmParser.java",
    "is_vulnerable": 0,
    "class_name": "CcmParser",
    "subclass_name": null,
    "function_name": "calculateMetricPriority(Metric metric)",
    "function_body": "{\n\t\tPriority priority;\n\t\tif (isMetricHighPriority(metric)) {\n\t\t\tpriority = Priority.HIGH;\n\t\t} else if (isMetricModeratePriority(metric)) {\n\t\t\tpriority = Priority.NORMAL;\n\t\t} else {\n\t\t\tpriority = Priority.LOW;\n\t\t}\n\n\t\treturn priority;\n\t}"
  },
  {
    "id": 48,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 4,
    "human_patch": "https://github.com/jenkinsci/ccm-plugin/commit/066cb43b4413b3490d822ec8b8a32072ebd213ca",
    "cve_id": "CVE-2018-1000054",
    "cwe_id": "CWE-918",
    "filename": "src/main/java/hudson/plugins/ccm/parser/CcmParser.java",
    "is_vulnerable": 0,
    "class_name": "CcmParser",
    "subclass_name": null,
    "function_name": "isMetricHighPriority(Metric metric)",
    "function_body": "{\n\t\tString metricClassification = metric.getClassification();\n\t\tif (metricClassification.contains(\"high\")){\n\t\t\treturn true;\n\t\t}\n\t\telse if (metricClassification.contentEquals(\"C\") || metricClassification.contentEquals(\"D\") ||\n\t\t\t\tmetricClassification.contentEquals(\"E\") || metricClassification.contentEquals((\"F\"))){\n\t\t\treturn true;\n\t\t}\n\t\telse {\n\t\t\treturn false;\n\t\t}\n\t}"
  },
  {
    "id": 48,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 5,
    "human_patch": "https://github.com/jenkinsci/ccm-plugin/commit/066cb43b4413b3490d822ec8b8a32072ebd213ca",
    "cve_id": "CVE-2018-1000054",
    "cwe_id": "CWE-918",
    "filename": "src/main/java/hudson/plugins/ccm/parser/CcmParser.java",
    "is_vulnerable": 0,
    "class_name": "CcmParser",
    "subclass_name": null,
    "function_name": "isMetricModeratePriority(Metric metric)",
    "function_body": "{\n\t\tString metricClassification = metric.getClassification();\n\t\tif (metricClassification.contains(\"moderate\")) {\n\t\t\treturn true;\n\t\t}\n\t\telse if (metricClassification.contentEquals(\"B\")) {\n\t\t\treturn true;\n\t\t}\n\t\telse {\n\t\t\treturn false;\n\t\t}\n\t}"
  },
  {
    "id": 49,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 0,
    "human_patch": "https://github.com/jenkinsci/groovy-sandbox/commit/0cd7ec12b7c56cfa3167d99c5f43147ce05449d3",
    "cve_id": "CVE-2018-1000865",
    "cwe_id": "CWE-269",
    "filename": "src/main/java/org/kohsuke/groovy/sandbox/SandboxTransformer.java",
    "is_vulnerable": 1,
    "class_name": "SandboxTransformer",
    "subclass_name": null,
    "function_name": "call(final SourceUnit source, GeneratorContext context, ClassNode classNode)",
    "function_body": "{\n        if (classNode == null) { \n            return;\n        }\n\n        ClassCodeExpressionTransformer visitor = createVisitor(source, classNode);\n\n        processConstructors(visitor, classNode);\n        for (MethodNode m : classNode.getMethods()) {\n            visitor.visitMethod(m);\n        }\n        for (Statement s : classNode.getObjectInitializerStatements()) {\n            s.visit(visitor);\n        }\n        for (FieldNode f : classNode.getFields()) {\n            visitor.visitField(f);\n        }\n    }"
  },
  {
    "id": 49,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 1,
    "human_patch": "https://github.com/jenkinsci/groovy-sandbox/commit/0cd7ec12b7c56cfa3167d99c5f43147ce05449d3",
    "cve_id": "CVE-2018-1000865",
    "cwe_id": "CWE-269",
    "filename": "src/main/java/org/kohsuke/groovy/sandbox/SandboxTransformer.java",
    "is_vulnerable": 0,
    "class_name": "SandboxTransformer",
    "subclass_name": null,
    "function_name": "processConstructors(final ClassCodeExpressionTransformer visitor, ClassNode classNode)",
    "function_body": "{\n        ClassNode superClass = classNode.getSuperClass();\n        List<ConstructorNode> declaredConstructors = classNode.getDeclaredConstructors();\n        if (TRIVIAL_CONSTRUCTORS.contains(superClass.getName())) {\n            for (ConstructorNode c : declaredConstructors) {\n                visitor.visitMethod(c);\n            }\n        } else {\n            if (declaredConstructors.isEmpty()) {\n                ConstructorNode syntheticConstructor = new ConstructorNode(Modifier.PUBLIC, new BlockStatement());\n                declaredConstructors = Collections.singletonList(syntheticConstructor);\n                classNode.addConstructor(syntheticConstructor);\n            } else {\n                declaredConstructors = new ArrayList<>(declaredConstructors);\n            }\n            for (ConstructorNode c : declaredConstructors) {\n                Statement code = c.getCode();\n                List<Statement> body;\n                if (code instanceof BlockStatement) {\n                    body = ((BlockStatement) code).getStatements();\n                } else {\n                    body = Collections.singletonList(code);\n                }\n                TupleExpression superArgs = new TupleExpression();\n                if (!body.isEmpty() && body.get(0) instanceof ExpressionStatement && ((ExpressionStatement) body.get(0)).getExpression() instanceof ConstructorCallExpression) {\n                    ConstructorCallExpression cce = (ConstructorCallExpression) ((ExpressionStatement) body.get(0)).getExpression();\n                    if (cce.isThisCall()) { \n                        visitor.visitMethod(c);\n                        continue;\n                    } else if (cce.isSuperCall()) {\n                        body = body.subList(1, body.size());\n                        superArgs = ((TupleExpression) cce.getArguments());\n                    }\n                }\n                List<Expression> thisArgs = new ArrayList<>();\n                final TupleExpression _superArgs = superArgs;\n                final AtomicReference<Expression> superArgsTransformed = new AtomicReference<>();\n                ((ScopeTrackingClassCodeExpressionTransformer) visitor).withMethod(c, new Runnable() {\n                    @Override\n                    public void run() {\n                        superArgsTransformed.set(((VisitorImpl) visitor).transformArguments(_superArgs));\n                    }\n                });\n                thisArgs.add(((VisitorImpl) visitor).makeCheckedCall(\"checkedSuperConstructor\", new ClassExpression(superClass), superArgsTransformed.get()));\n                Parameter[] origParams = c.getParameters();\n                for (Parameter p : origParams) {\n                    thisArgs.add(new VariableExpression(p));\n                }\n                c.setCode(new BlockStatement(new Statement[] {new ExpressionStatement(new ConstructorCallExpression(ClassNode.THIS, new TupleExpression(thisArgs)))}, c.getVariableScope()));\n                Parameter[] params = new Parameter[origParams.length + 1];\n                params[0] = new Parameter(new ClassNode(Checker.SuperConstructorWrapper.class), \"$scw\");\n                System.arraycopy(origParams, 0, params, 1, origParams.length);\n                List<Expression> scwArgs = new ArrayList<>();\n                int x = 0;\n                for (Expression superArg : superArgs) {\n                    scwArgs.add(new MethodCallExpression(new VariableExpression(\"$scw\"), \"arg\", new ConstantExpression(x++)));\n                }\n                List<Statement> body2 = new ArrayList<>();\n                body2.add(0, new ExpressionStatement(new ConstructorCallExpression(ClassNode.SUPER, new ArgumentListExpression(scwArgs))));\n                for (final Statement s : body) {\n                    ((ScopeTrackingClassCodeExpressionTransformer) visitor).withMethod(c, new Runnable() {\n                        @Override\n                        public void run() {\n                            s.visit(visitor);\n                        }\n                    });\n                    body2.add(s);\n                }\n                ConstructorNode c2 = new ConstructorNode(Modifier.PRIVATE, params, c.getExceptions(), new BlockStatement(body2, c.getVariableScope()));\n                \n                classNode.addConstructor(c2);\n            }\n        }\n    }"
  },
  {
    "id": 49,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 2,
    "human_patch": "https://github.com/jenkinsci/groovy-sandbox/commit/0cd7ec12b7c56cfa3167d99c5f43147ce05449d3",
    "cve_id": "CVE-2018-1000865",
    "cwe_id": "CWE-269",
    "filename": "src/main/java/org/kohsuke/groovy/sandbox/SandboxTransformer.java",
    "is_vulnerable": 0,
    "class_name": "SandboxTransformer",
    "subclass_name": null,
    "function_name": "run()",
    "function_body": "{\n                        superArgsTransformed.set(((VisitorImpl) visitor).transformArguments(_superArgs));\n                    }"
  },
  {
    "id": 49,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 3,
    "human_patch": "https://github.com/jenkinsci/groovy-sandbox/commit/0cd7ec12b7c56cfa3167d99c5f43147ce05449d3",
    "cve_id": "CVE-2018-1000865",
    "cwe_id": "CWE-269",
    "filename": "src/main/java/org/kohsuke/groovy/sandbox/SandboxTransformer.java",
    "is_vulnerable": 1,
    "class_name": "SandboxTransformer",
    "subclass_name": null,
    "function_name": "run()",
    "function_body": "{\n                            s.visit(visitor);\n                        }"
  },
  {
    "id": 49,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 4,
    "human_patch": "https://github.com/jenkinsci/groovy-sandbox/commit/0cd7ec12b7c56cfa3167d99c5f43147ce05449d3",
    "cve_id": "CVE-2018-1000865",
    "cwe_id": "CWE-269",
    "filename": "src/main/java/org/kohsuke/groovy/sandbox/SandboxTransformer.java",
    "is_vulnerable": 0,
    "class_name": "SandboxTransformer",
    "subclass_name": null,
    "function_name": "createVisitor(SourceUnit source)",
    "function_body": "{\n        return createVisitor(source, null);\n    }"
  },
  {
    "id": 49,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 5,
    "human_patch": "https://github.com/jenkinsci/groovy-sandbox/commit/0cd7ec12b7c56cfa3167d99c5f43147ce05449d3",
    "cve_id": "CVE-2018-1000865",
    "cwe_id": "CWE-269",
    "filename": "src/main/java/org/kohsuke/groovy/sandbox/SandboxTransformer.java",
    "is_vulnerable": 0,
    "class_name": "SandboxTransformer",
    "subclass_name": null,
    "function_name": "createVisitor(SourceUnit source, ClassNode clazz)",
    "function_body": "{\n        return new VisitorImpl(source, clazz);\n    }"
  },
  {
    "id": 49,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 6,
    "human_patch": "https://github.com/jenkinsci/groovy-sandbox/commit/0cd7ec12b7c56cfa3167d99c5f43147ce05449d3",
    "cve_id": "CVE-2018-1000865",
    "cwe_id": "CWE-269",
    "filename": "src/main/java/org/kohsuke/groovy/sandbox/SandboxTransformer.java",
    "is_vulnerable": 0,
    "class_name": "SandboxTransformer",
    "subclass_name": "VisitorImpl",
    "function_name": "visitMethod(MethodNode node)",
    "function_body": "{\n            if (clazz == null) { \n                clazz = node.getDeclaringClass();\n            }\n            super.visitMethod(node);\n        }"
  },
  {
    "id": 49,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 7,
    "human_patch": "https://github.com/jenkinsci/groovy-sandbox/commit/0cd7ec12b7c56cfa3167d99c5f43147ce05449d3",
    "cve_id": "CVE-2018-1000865",
    "cwe_id": "CWE-269",
    "filename": "src/main/java/org/kohsuke/groovy/sandbox/SandboxTransformer.java",
    "is_vulnerable": 0,
    "class_name": "SandboxTransformer",
    "subclass_name": "VisitorImpl",
    "function_name": "transformArguments(Expression e)",
    "function_body": "{\n            List<Expression> l;\n            if (e instanceof TupleExpression) {\n                List<Expression> expressions = ((TupleExpression) e).getExpressions();\n                l = new ArrayList<>(expressions.size());\n                for (Expression expression : expressions) {\n                    l.add(transform(expression));\n                }\n            } else {\n                l = Collections.singletonList(transform(e));\n            }\n\n            \n            return withLoc(e,new MethodCallExpression(new ListExpression(l),\"toArray\",new ArgumentListExpression()));\n        }"
  },
  {
    "id": 49,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 8,
    "human_patch": "https://github.com/jenkinsci/groovy-sandbox/commit/0cd7ec12b7c56cfa3167d99c5f43147ce05449d3",
    "cve_id": "CVE-2018-1000865",
    "cwe_id": "CWE-269",
    "filename": "src/main/java/org/kohsuke/groovy/sandbox/SandboxTransformer.java",
    "is_vulnerable": 0,
    "class_name": "SandboxTransformer",
    "subclass_name": "VisitorImpl",
    "function_name": "makeCheckedCall(String name, Expression... arguments)",
    "function_body": "{\n            return new StaticMethodCallExpression(checkerClass,name,\n                new ArgumentListExpression(arguments));\n        }"
  },
  {
    "id": 49,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 9,
    "human_patch": "https://github.com/jenkinsci/groovy-sandbox/commit/0cd7ec12b7c56cfa3167d99c5f43147ce05449d3",
    "cve_id": "CVE-2018-1000865",
    "cwe_id": "CWE-269",
    "filename": "src/main/java/org/kohsuke/groovy/sandbox/SandboxTransformer.java",
    "is_vulnerable": 0,
    "class_name": "SandboxTransformer",
    "subclass_name": "VisitorImpl",
    "function_name": "transform(Expression exp)",
    "function_body": "{\n            Expression o = innerTransform(exp);\n            if (o!=exp) {\n                o.setSourcePosition(exp);\n            }\n            return o;\n        }"
  },
  {
    "id": 49,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 10,
    "human_patch": "https://github.com/jenkinsci/groovy-sandbox/commit/0cd7ec12b7c56cfa3167d99c5f43147ce05449d3",
    "cve_id": "CVE-2018-1000865",
    "cwe_id": "CWE-269",
    "filename": "src/main/java/org/kohsuke/groovy/sandbox/SandboxTransformer.java",
    "is_vulnerable": 0,
    "class_name": "SandboxTransformer",
    "subclass_name": "VisitorImpl",
    "function_name": "innerTransform(Expression exp)",
    "function_body": "{\n            if (exp instanceof ClosureExpression) {\n                \n                ClosureExpression ce = (ClosureExpression)exp;\n                try (StackVariableSet scope = new StackVariableSet(this)) {\n                    Parameter[] parameters = ce.getParameters();\n                    if (parameters != null) {\n                        \n                        if (parameters.length > 0) {\n                            for (Parameter p : parameters) {\n                                declareVariable(p);\n                            }\n                        } else {\n                            \n                            declareVariable(new Parameter(ClassHelper.DYNAMIC_TYPE, \"it\"));\n                        }\n                    }\n                    boolean old = visitingClosureBody;\n                    visitingClosureBody = true;\n                    try {\n                        ce.getCode().visit(this);\n                    } finally {\n                        visitingClosureBody = old;\n                    }\n                }\n            }\n\n            if (exp instanceof MethodCallExpression && interceptMethodCall) {\n                \n                \n                \n                \n                MethodCallExpression call = (MethodCallExpression) exp;\n\n                Expression objExp;\n                if (call.isImplicitThis() && visitingClosureBody && !isLocalVariableExpression(call.getObjectExpression()))\n                    objExp = CLOSURE_THIS;\n                else\n                    objExp = transform(call.getObjectExpression());\n\n                Expression arg1 = call.getMethod();\n                Expression arg2 = transformArguments(call.getArguments());\n\n                if (call.getObjectExpression() instanceof VariableExpression && ((VariableExpression) call.getObjectExpression()).getName().equals(\"super\")) {\n                    if (clazz == null) {\n                        throw new IllegalStateException(\"owning class not defined\");\n                    }\n                    return makeCheckedCall(\"checkedSuperCall\", new ClassExpression(clazz), objExp, arg1, arg2);\n                } else {\n                    return makeCheckedCall(\"checkedCall\",\n                            objExp,\n                            boolExp(call.isSafe()),\n                            boolExp(call.isSpreadSafe()),\n                            arg1,\n                            arg2);\n                }\n            }\n            \n            if (exp instanceof StaticMethodCallExpression && interceptMethodCall) {\n                \n                StaticMethodCallExpression call = (StaticMethodCallExpression) exp;\n                return makeCheckedCall(\"checkedStaticCall\",\n                            new ClassExpression(call.getOwnerType()),\n                            new ConstantExpression(call.getMethod()),\n                            transformArguments(call.getArguments())\n                    );\n            }\n\n            if (exp instanceof MethodPointerExpression && interceptMethodCall) {\n                MethodPointerExpression mpe = (MethodPointerExpression) exp;\n                return new ConstructorCallExpression(\n                        new ClassNode(SandboxedMethodClosure.class),\n                        new ArgumentListExpression(mpe.getExpression(), mpe.getMethodName())\n                );\n            }\n\n            if (exp instanceof ConstructorCallExpression && interceptConstructor) {\n                if (!((ConstructorCallExpression) exp).isSpecialCall()) {\n                    \n                    return makeCheckedCall(\"checkedConstructor\",\n                            new ClassExpression(exp.getType()),\n                            transformArguments(((ConstructorCallExpression) exp).getArguments())\n                    );\n                } else {\n                    \n                    \n                    \n                }\n            }\n\n            if (exp instanceof AttributeExpression && interceptAttribute) {\n                AttributeExpression ae = (AttributeExpression) exp;\n                return makeCheckedCall(\"checkedGetAttribute\",\n                    transform(ae.getObjectExpression()),\n                    boolExp(ae.isSafe()),\n                    boolExp(ae.isSpreadSafe()),\n                    transform(ae.getProperty())\n                );\n            }\n\n            if (exp instanceof PropertyExpression && interceptProperty) {\n                PropertyExpression pe = (PropertyExpression) exp;\n                return makeCheckedCall(\"checkedGetProperty\",\n                    transformObjectExpression(pe),\n                    boolExp(pe.isSafe()),\n                    boolExp(pe.isSpreadSafe()),\n                    transform(pe.getProperty())\n                );\n            }\n\n            if (exp instanceof VariableExpression && interceptProperty) {\n                VariableExpression vexp = (VariableExpression) exp;\n                if (isLocalVariable(vexp.getName()) || vexp.getName().equals(\"this\") || vexp.getName().equals(\"super\")) {\n                    \n                    return super.transform(exp);\n                } else {\n                    \n                    \n                    PropertyExpression pexp = new PropertyExpression(VariableExpression.THIS_EXPRESSION, vexp.getName());\n                    pexp.setImplicitThis(true);\n                    withLoc(exp,pexp);\n                    return transform(pexp);\n                }\n            }\n\n            if (exp instanceof DeclarationExpression) {\n                handleDeclarations((DeclarationExpression) exp);\n            }\n\n            if (exp instanceof BinaryExpression) {\n                BinaryExpression be = (BinaryExpression) exp;\n                \n                if (ofType(be.getOperation().getType(),ASSIGNMENT_OPERATOR)) {\n                    \n\n                    \n                    \n                    \n                    \n\n                    Expression lhs = be.getLeftExpression();\n                    if (lhs instanceof VariableExpression) {\n                        VariableExpression vexp = (VariableExpression) lhs;\n                        if (isLocalVariable(vexp.getName()) || vexp.getName().equals(\"this\") || vexp.getName().equals(\"super\")) {\n                            \n                            return super.transform(exp);\n                        } else {\n                            \n                            \n                            PropertyExpression pexp = new PropertyExpression(VariableExpression.THIS_EXPRESSION, vexp.getName());\n                            pexp.setImplicitThis(true);\n                            pexp.setSourcePosition(vexp);\n\n                            lhs = pexp;\n                        }\n                    } \n                    if (lhs instanceof PropertyExpression) {\n                        PropertyExpression pe = (PropertyExpression) lhs;\n                        String name = null;\n                        if (lhs instanceof AttributeExpression) {\n                            if (interceptAttribute)\n                                name = \"checkedSetAttribute\";\n                        } else {\n                            Expression receiver = pe.getObjectExpression();\n                            if (receiver instanceof VariableExpression && ((VariableExpression) receiver).getName().equals(\"this\")) {\n                                FieldNode field = clazz != null ? clazz.getField(pe.getPropertyAsString()) : null;\n                                if (field != null) { \n                                    \n                                    return new BinaryExpression(lhs, be.getOperation(), transform(be.getRightExpression()));\n                                } \n                            }\n                            if (interceptProperty)\n                                name = \"checkedSetProperty\";\n                        }\n                        if (name==null) \n                            return super.transform(exp);\n\n                        return makeCheckedCall(name,\n                                transformObjectExpression(pe),\n                                pe.getProperty(),\n                                boolExp(pe.isSafe()),\n                                boolExp(pe.isSpreadSafe()),\n                                intExp(be.getOperation().getType()),\n                                transform(be.getRightExpression())\n                        );\n                    } else\n                    if (lhs instanceof FieldExpression) {\n                        \n                        \n                        \n                        return super.transform(exp);\n                    } else\n                    if (lhs instanceof BinaryExpression) {\n                        BinaryExpression lbe = (BinaryExpression) lhs;\n                        if (lbe.getOperation().getType()==Types.LEFT_SQUARE_BRACKET && interceptArray) {\n                            return makeCheckedCall(\"checkedSetArray\",\n                                    transform(lbe.getLeftExpression()),\n                                    transform(lbe.getRightExpression()),\n                                    intExp(be.getOperation().getType()),\n                                    transform(be.getRightExpression())\n                            );\n                        }\n                    } else\n                        throw new AssertionError(\"Unexpected LHS of an assignment: \" + lhs.getClass());\n                }\n                if (be.getOperation().getType()==Types.LEFT_SQUARE_BRACKET) {\n                    if (interceptArray)\n                        return makeCheckedCall(\"checkedGetArray\",\n                                transform(be.getLeftExpression()),\n                                transform(be.getRightExpression())\n                        );\n                } else\n                if (be.getOperation().getType()==Types.KEYWORD_INSTANCEOF) {\n                    return super.transform(exp);\n                } else\n                if (Ops.isLogicalOperator(be.getOperation().getType())) {\n                    return super.transform(exp);\n                } else\n                if (be.getOperation().getType()==Types.KEYWORD_IN) {\n                    \n                    \n                    if (interceptMethodCall)\n                        return makeCheckedCall(\"checkedCall\",\n                                transform(be.getRightExpression()),\n                                boolExp(false),\n                                boolExp(false),\n                                stringExp(\"isCase\"),\n                                transform(be.getLeftExpression())\n\n                        );\n                } else\n                if (Ops.isRegexpComparisonOperator(be.getOperation().getType())) {\n                    if (interceptMethodCall)\n                        return makeCheckedCall(\"checkedStaticCall\",\n                                classExp(ScriptBytecodeAdapterClass),\n                                stringExp(Ops.binaryOperatorMethods(be.getOperation().getType())),\n                                transform(be.getLeftExpression()),\n                                transform(be.getRightExpression())\n                        );\n                } else\n                if (Ops.isComparisionOperator(be.getOperation().getType())) {\n                    if (interceptMethodCall) {\n                        return makeCheckedCall(\"checkedComparison\",\n                                transform(be.getLeftExpression()),\n                                intExp(be.getOperation().getType()),\n                                transform(be.getRightExpression())\n                        );\n                    }\n                } else\n                if (interceptMethodCall) {\n                    \n                    \n                    return makeCheckedCall(\"checkedBinaryOp\",\n                            transform(be.getLeftExpression()),\n                            intExp(be.getOperation().getType()),\n                            transform(be.getRightExpression())\n                    );\n                }\n            }\n\n            if (exp instanceof PostfixExpression) {\n                PostfixExpression pe = (PostfixExpression) exp;\n                return prefixPostfixExp(exp, pe.getExpression(), pe.getOperation(), \"Postfix\");\n            }\n            if (exp instanceof PrefixExpression) {\n                PrefixExpression pe = (PrefixExpression) exp;\n                return prefixPostfixExp(exp, pe.getExpression(), pe.getOperation(), \"Prefix\");\n            }\n\n            if (exp instanceof CastExpression) {\n                CastExpression ce = (CastExpression) exp;\n                return makeCheckedCall(\"checkedCast\",\n                        classExp(exp.getType()),\n                        transform(ce.getExpression()),\n                        boolExp(ce.isIgnoringAutoboxing()),\n                        boolExp(ce.isCoerce()),\n                        boolExp(ce.isStrict())\n                );\n            }\n\n            return super.transform(exp);\n        }"
  },
  {
    "id": 49,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 11,
    "human_patch": "https://github.com/jenkinsci/groovy-sandbox/commit/0cd7ec12b7c56cfa3167d99c5f43147ce05449d3",
    "cve_id": "CVE-2018-1000865",
    "cwe_id": "CWE-269",
    "filename": "src/main/java/org/kohsuke/groovy/sandbox/SandboxTransformer.java",
    "is_vulnerable": 0,
    "class_name": "SandboxTransformer",
    "subclass_name": "VisitorImpl",
    "function_name": "prefixPostfixExp(Expression whole, Expression atom, Token opToken, String mode)",
    "function_body": "{\n            String op = opToken.getText().equals(\"++\") ? \"next\" : \"previous\";\n\n            \n            if (atom instanceof BinaryExpression && ((BinaryExpression) atom).getOperation().getType()==Types.LEFT_SQUARE_BRACKET && interceptArray) {\n                return makeCheckedCall(\"checked\" + mode + \"Array\",\n                        transform(((BinaryExpression) atom).getLeftExpression()),\n                        transform(((BinaryExpression) atom).getRightExpression()),\n                        stringExp(op)\n                );\n            }\n\n            \n            if (atom instanceof VariableExpression) {\n                VariableExpression ve = (VariableExpression) atom;\n                if (isLocalVariable(ve.getName())) {\n                    if (mode.equals(\"Postfix\")) {\n                        \n                        \n                        return transform(withLoc(whole,new BinaryExpression(\n                                new ListExpression(Arrays.asList(\n                                    atom,\n                                    new BinaryExpression(atom, ASSIGNMENT_OP,\n                                        withLoc(atom,new MethodCallExpression(atom,op,EMPTY_ARGUMENTS)))\n                                )),\n                                new Token(Types.LEFT_SQUARE_BRACKET, \"[\", -1,-1),\n                                new ConstantExpression(0)\n                        )));\n                    } else {\n                        \n                        return transform(withLoc(whole,new BinaryExpression(atom,ASSIGNMENT_OP,\n                                withLoc(atom,new MethodCallExpression(atom,op,EMPTY_ARGUMENTS)))\n                        ));\n                    }\n                } else {\n                    \n                    \n                    PropertyExpression pexp = new PropertyExpression(VariableExpression.THIS_EXPRESSION, ve.getName());\n                    pexp.setImplicitThis(true);\n                    pexp.setSourcePosition(atom);\n\n                    atom = pexp;\n                    \n                }\n            }\n\n            \n            if (atom instanceof PropertyExpression && interceptProperty) {\n                PropertyExpression pe = (PropertyExpression) atom;\n                return makeCheckedCall(\"checked\" + mode + \"Property\",\n                        transformObjectExpression(pe),\n                        pe.getProperty(),\n                        boolExp(pe.isSafe()),\n                        boolExp(pe.isSpreadSafe()),\n                        stringExp(op)\n                );\n            }\n\n            return whole;\n        }"
  },
  {
    "id": 49,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 12,
    "human_patch": "https://github.com/jenkinsci/groovy-sandbox/commit/0cd7ec12b7c56cfa3167d99c5f43147ce05449d3",
    "cve_id": "CVE-2018-1000865",
    "cwe_id": "CWE-269",
    "filename": "src/main/java/org/kohsuke/groovy/sandbox/SandboxTransformer.java",
    "is_vulnerable": 0,
    "class_name": "SandboxTransformer",
    "subclass_name": "VisitorImpl",
    "function_name": "withLoc(ASTNode src, T t)",
    "function_body": "{\n            t.setSourcePosition(src);\n            return t;\n        }"
  },
  {
    "id": 49,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 13,
    "human_patch": "https://github.com/jenkinsci/groovy-sandbox/commit/0cd7ec12b7c56cfa3167d99c5f43147ce05449d3",
    "cve_id": "CVE-2018-1000865",
    "cwe_id": "CWE-269",
    "filename": "src/main/java/org/kohsuke/groovy/sandbox/SandboxTransformer.java",
    "is_vulnerable": 0,
    "class_name": "SandboxTransformer",
    "subclass_name": "VisitorImpl",
    "function_name": "transformObjectExpression(PropertyExpression exp)",
    "function_body": "{\n            if (exp.isImplicitThis() && visitingClosureBody && !isLocalVariableExpression(exp.getObjectExpression())) {\n                return CLOSURE_THIS;\n            } else {\n                return transform(exp.getObjectExpression());\n            }\n        }"
  },
  {
    "id": 49,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 14,
    "human_patch": "https://github.com/jenkinsci/groovy-sandbox/commit/0cd7ec12b7c56cfa3167d99c5f43147ce05449d3",
    "cve_id": "CVE-2018-1000865",
    "cwe_id": "CWE-269",
    "filename": "src/main/java/org/kohsuke/groovy/sandbox/SandboxTransformer.java",
    "is_vulnerable": 0,
    "class_name": "SandboxTransformer",
    "subclass_name": "VisitorImpl",
    "function_name": "isLocalVariableExpression(Expression exp)",
    "function_body": "{\n            if (exp != null && exp instanceof VariableExpression) {\n                return isLocalVariable(((VariableExpression) exp).getName());\n            }\n\n            return false;\n        }"
  },
  {
    "id": 49,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 15,
    "human_patch": "https://github.com/jenkinsci/groovy-sandbox/commit/0cd7ec12b7c56cfa3167d99c5f43147ce05449d3",
    "cve_id": "CVE-2018-1000865",
    "cwe_id": "CWE-269",
    "filename": "src/main/java/org/kohsuke/groovy/sandbox/SandboxTransformer.java",
    "is_vulnerable": 0,
    "class_name": "SandboxTransformer",
    "subclass_name": "VisitorImpl",
    "function_name": "boolExp(boolean v)",
    "function_body": "{\n            return v ? ConstantExpression.PRIM_TRUE : ConstantExpression.PRIM_FALSE;\n        }"
  },
  {
    "id": 49,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 16,
    "human_patch": "https://github.com/jenkinsci/groovy-sandbox/commit/0cd7ec12b7c56cfa3167d99c5f43147ce05449d3",
    "cve_id": "CVE-2018-1000865",
    "cwe_id": "CWE-269",
    "filename": "src/main/java/org/kohsuke/groovy/sandbox/SandboxTransformer.java",
    "is_vulnerable": 0,
    "class_name": "SandboxTransformer",
    "subclass_name": "VisitorImpl",
    "function_name": "intExp(int v)",
    "function_body": "{\n            return new ConstantExpression(v,true);\n        }"
  },
  {
    "id": 49,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 17,
    "human_patch": "https://github.com/jenkinsci/groovy-sandbox/commit/0cd7ec12b7c56cfa3167d99c5f43147ce05449d3",
    "cve_id": "CVE-2018-1000865",
    "cwe_id": "CWE-269",
    "filename": "src/main/java/org/kohsuke/groovy/sandbox/SandboxTransformer.java",
    "is_vulnerable": 0,
    "class_name": "SandboxTransformer",
    "subclass_name": "VisitorImpl",
    "function_name": "classExp(ClassNode c)",
    "function_body": "{\n            return new ClassExpression(c);\n        }"
  },
  {
    "id": 49,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 18,
    "human_patch": "https://github.com/jenkinsci/groovy-sandbox/commit/0cd7ec12b7c56cfa3167d99c5f43147ce05449d3",
    "cve_id": "CVE-2018-1000865",
    "cwe_id": "CWE-269",
    "filename": "src/main/java/org/kohsuke/groovy/sandbox/SandboxTransformer.java",
    "is_vulnerable": 0,
    "class_name": "SandboxTransformer",
    "subclass_name": "VisitorImpl",
    "function_name": "stringExp(String v)",
    "function_body": "{\n            return new ConstantExpression(v);\n        }"
  },
  {
    "id": 49,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 19,
    "human_patch": "https://github.com/jenkinsci/groovy-sandbox/commit/0cd7ec12b7c56cfa3167d99c5f43147ce05449d3",
    "cve_id": "CVE-2018-1000865",
    "cwe_id": "CWE-269",
    "filename": "src/main/java/org/kohsuke/groovy/sandbox/SandboxTransformer.java",
    "is_vulnerable": 0,
    "class_name": "SandboxTransformer",
    "subclass_name": "VisitorImpl",
    "function_name": "visitExpressionStatement(ExpressionStatement es)",
    "function_body": "{\n            Expression exp = es.getExpression();\n            if (exp instanceof DeclarationExpression) {\n                DeclarationExpression de = (DeclarationExpression) exp;\n                Expression leftExpression = de.getLeftExpression();\n                if (leftExpression instanceof VariableExpression) {\n                    \n                    if (!(de.getRightExpression() instanceof EmptyExpression) &&\n                            mightBePositionalArgumentConstructor((VariableExpression) leftExpression)) {\n                        CastExpression ce = new CastExpression(leftExpression.getType(), de.getRightExpression());\n                        ce.setCoerce(true);\n                        es.setExpression(transform(new DeclarationExpression(leftExpression, de.getOperation(), ce)));\n                        return;\n                    }\n                } else {\n                    throw new UnsupportedOperationException(\"not supporting tuples yet\"); \n                }\n            }\n            super.visitExpressionStatement(es);\n        }"
  },
  {
    "id": 49,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 20,
    "human_patch": "https://github.com/jenkinsci/groovy-sandbox/commit/0cd7ec12b7c56cfa3167d99c5f43147ce05449d3",
    "cve_id": "CVE-2018-1000865",
    "cwe_id": "CWE-269",
    "filename": "src/main/java/org/kohsuke/groovy/sandbox/SandboxTransformer.java",
    "is_vulnerable": 0,
    "class_name": "SandboxTransformer",
    "subclass_name": "VisitorImpl",
    "function_name": "getSourceUnit()",
    "function_body": "{\n            return sourceUnit;\n        }"
  },
  {
    "id": 49,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 21,
    "human_patch": "https://github.com/jenkinsci/groovy-sandbox/commit/0cd7ec12b7c56cfa3167d99c5f43147ce05449d3",
    "cve_id": "CVE-2018-1000865",
    "cwe_id": "CWE-269",
    "filename": "src/main/java/org/kohsuke/groovy/sandbox/SandboxTransformer.java",
    "is_vulnerable": 0,
    "class_name": "SandboxTransformer",
    "subclass_name": null,
    "function_name": "mightBePositionalArgumentConstructor(VariableExpression ve)",
    "function_body": "{\n        ClassNode type = ve.getType();\n        if (type.isArray()) {\n            return false; \n        }\n        Class clazz;\n        try {\n            clazz = type.getTypeClass();\n        } catch (GroovyBugError x) {\n            return false; \n        }\n        return clazz != null && clazz != Object.class && !Modifier.isAbstract(clazz.getModifiers());\n    }"
  },
  {
    "id": 50,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 0,
    "human_patch": "https://github.com/jenkinsci/jenkins/commit/e5046911c57e60a1d6d8aca9b21bd9093b0f3763",
    "cve_id": "CVE-2018-1999044",
    "cwe_id": "CWE-835",
    "filename": "core/src/main/java/hudson/scheduler/CronTab.java",
    "is_vulnerable": 0,
    "class_name": "CronTab",
    "subclass_name": null,
    "function_name": "set(String format, int line, Hash hash) throws ANTLRException",
    "function_body": "{\n        set(format, line, hash, null);\n    }"
  },
  {
    "id": 50,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 1,
    "human_patch": "https://github.com/jenkinsci/jenkins/commit/e5046911c57e60a1d6d8aca9b21bd9093b0f3763",
    "cve_id": "CVE-2018-1999044",
    "cwe_id": "CWE-835",
    "filename": "core/src/main/java/hudson/scheduler/CronTab.java",
    "is_vulnerable": 0,
    "class_name": "CronTab",
    "subclass_name": null,
    "function_name": "set(String format, int line, Hash hash, String timezone) throws ANTLRException",
    "function_body": "{\n        CrontabLexer lexer = new CrontabLexer(new StringReader(format));\n        lexer.setLine(line);\n        CrontabParser parser = new CrontabParser(lexer);\n        parser.setHash(hash);\n        spec = format;\n        specTimezone = timezone;\n\n        parser.startRule(this);\n        if((dayOfWeek&(1<<7))!=0) {\n            dayOfWeek |= 1; \n            dayOfWeek &= ~(1<<7); \n        }\n    }"
  },
  {
    "id": 50,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 2,
    "human_patch": "https://github.com/jenkinsci/jenkins/commit/e5046911c57e60a1d6d8aca9b21bd9093b0f3763",
    "cve_id": "CVE-2018-1999044",
    "cwe_id": "CWE-835",
    "filename": "core/src/main/java/hudson/scheduler/CronTab.java",
    "is_vulnerable": 0,
    "class_name": "CronTab",
    "subclass_name": null,
    "function_name": "check(Calendar cal)",
    "function_body": "{\n\n        Calendar checkCal = cal;\n\n        if(specTimezone != null && !specTimezone.isEmpty()) {\n            Calendar tzCal = Calendar.getInstance(TimeZone.getTimeZone(specTimezone));\n            tzCal.setTime(cal.getTime());\n            checkCal = tzCal;\n        }\n\n        if(!checkBits(bits[0],checkCal.get(MINUTE)))\n            return false;\n        if(!checkBits(bits[1],checkCal.get(HOUR_OF_DAY)))\n            return false;\n        if(!checkBits(bits[2],checkCal.get(DAY_OF_MONTH)))\n            return false;\n        if(!checkBits(bits[3],checkCal.get(MONTH)+1))\n            return false;\n        if(!checkBits(dayOfWeek,checkCal.get(Calendar.DAY_OF_WEEK)-1))\n            return false;\n\n        return true;\n    }"
  },
  {
    "id": 50,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 3,
    "human_patch": "https://github.com/jenkinsci/jenkins/commit/e5046911c57e60a1d6d8aca9b21bd9093b0f3763",
    "cve_id": "CVE-2018-1999044",
    "cwe_id": "CWE-835",
    "filename": "core/src/main/java/hudson/scheduler/CronTab.java",
    "is_vulnerable": 0,
    "class_name": "CronTab",
    "subclass_name": "CalendarField",
    "function_name": "valueOf(Calendar c)",
    "function_body": "{\n            return c.get(field)+offset;\n        }"
  },
  {
    "id": 50,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 4,
    "human_patch": "https://github.com/jenkinsci/jenkins/commit/e5046911c57e60a1d6d8aca9b21bd9093b0f3763",
    "cve_id": "CVE-2018-1999044",
    "cwe_id": "CWE-835",
    "filename": "core/src/main/java/hudson/scheduler/CronTab.java",
    "is_vulnerable": 0,
    "class_name": "CronTab",
    "subclass_name": "CalendarField",
    "function_name": "addTo(Calendar c, int i)",
    "function_body": "{\n            c.add(field,i);\n        }"
  },
  {
    "id": 50,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 5,
    "human_patch": "https://github.com/jenkinsci/jenkins/commit/e5046911c57e60a1d6d8aca9b21bd9093b0f3763",
    "cve_id": "CVE-2018-1999044",
    "cwe_id": "CWE-835",
    "filename": "core/src/main/java/hudson/scheduler/CronTab.java",
    "is_vulnerable": 1,
    "class_name": "CronTab",
    "subclass_name": "CalendarField",
    "function_name": "setTo(Calendar c, int i)",
    "function_body": "{\n            c.set(field,i-offset);\n        }"
  },
  {
    "id": 50,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 6,
    "human_patch": "https://github.com/jenkinsci/jenkins/commit/e5046911c57e60a1d6d8aca9b21bd9093b0f3763",
    "cve_id": "CVE-2018-1999044",
    "cwe_id": "CWE-835",
    "filename": "core/src/main/java/hudson/scheduler/CronTab.java",
    "is_vulnerable": 0,
    "class_name": "CronTab",
    "subclass_name": "CalendarField",
    "function_name": "clear(Calendar c)",
    "function_body": "{\n            setTo(c, min);\n        }"
  },
  {
    "id": 50,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 7,
    "human_patch": "https://github.com/jenkinsci/jenkins/commit/e5046911c57e60a1d6d8aca9b21bd9093b0f3763",
    "cve_id": "CVE-2018-1999044",
    "cwe_id": "CWE-835",
    "filename": "core/src/main/java/hudson/scheduler/CronTab.java",
    "is_vulnerable": 0,
    "class_name": "CronTab",
    "subclass_name": "CalendarField",
    "function_name": "ceil(CronTab c, int n)",
    "function_body": "{\n            long bits = bits(c);\n            while ((bits|(1L<<n))!=bits) {\n                if (n>60)   return -1;\n                n++;\n            }\n            return n;\n        }"
  },
  {
    "id": 50,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 8,
    "human_patch": "https://github.com/jenkinsci/jenkins/commit/e5046911c57e60a1d6d8aca9b21bd9093b0f3763",
    "cve_id": "CVE-2018-1999044",
    "cwe_id": "CWE-835",
    "filename": "core/src/main/java/hudson/scheduler/CronTab.java",
    "is_vulnerable": 0,
    "class_name": "CronTab",
    "subclass_name": "CalendarField",
    "function_name": "first(CronTab c)",
    "function_body": "{\n            return ceil(c,0);\n        }"
  },
  {
    "id": 50,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 9,
    "human_patch": "https://github.com/jenkinsci/jenkins/commit/e5046911c57e60a1d6d8aca9b21bd9093b0f3763",
    "cve_id": "CVE-2018-1999044",
    "cwe_id": "CWE-835",
    "filename": "core/src/main/java/hudson/scheduler/CronTab.java",
    "is_vulnerable": 0,
    "class_name": "CronTab",
    "subclass_name": "CalendarField",
    "function_name": "floor(CronTab c, int n)",
    "function_body": "{\n            long bits = bits(c);\n            while ((bits|(1L<<n))!=bits) {\n                if (n==0)   return -1;\n                n--;\n            }\n            return n;\n        }"
  },
  {
    "id": 50,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 10,
    "human_patch": "https://github.com/jenkinsci/jenkins/commit/e5046911c57e60a1d6d8aca9b21bd9093b0f3763",
    "cve_id": "CVE-2018-1999044",
    "cwe_id": "CWE-835",
    "filename": "core/src/main/java/hudson/scheduler/CronTab.java",
    "is_vulnerable": 0,
    "class_name": "CronTab",
    "subclass_name": "CalendarField",
    "function_name": "last(CronTab c)",
    "function_body": "{\n            return floor(c,63);\n        }"
  },
  {
    "id": 50,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 11,
    "human_patch": "https://github.com/jenkinsci/jenkins/commit/e5046911c57e60a1d6d8aca9b21bd9093b0f3763",
    "cve_id": "CVE-2018-1999044",
    "cwe_id": "CWE-835",
    "filename": "core/src/main/java/hudson/scheduler/CronTab.java",
    "is_vulnerable": 0,
    "class_name": "CronTab",
    "subclass_name": "CalendarField",
    "function_name": "bits(CronTab c)",
    "function_body": null
  },
  {
    "id": 50,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 12,
    "human_patch": "https://github.com/jenkinsci/jenkins/commit/e5046911c57e60a1d6d8aca9b21bd9093b0f3763",
    "cve_id": "CVE-2018-1999044",
    "cwe_id": "CWE-835",
    "filename": "core/src/main/java/hudson/scheduler/CronTab.java",
    "is_vulnerable": 0,
    "class_name": "CronTab",
    "subclass_name": "CalendarField",
    "function_name": "rollUp(Calendar cal, int i)",
    "function_body": null
  },
  {
    "id": 50,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 13,
    "human_patch": "https://github.com/jenkinsci/jenkins/commit/e5046911c57e60a1d6d8aca9b21bd9093b0f3763",
    "cve_id": "CVE-2018-1999044",
    "cwe_id": "CWE-835",
    "filename": "core/src/main/java/hudson/scheduler/CronTab.java",
    "is_vulnerable": 1,
    "class_name": "CronTab",
    "subclass_name": "CalendarField",
    "function_name": "bits(CronTab c)",
    "function_body": "{ return c.bits[0]; }"
  },
  {
    "id": 50,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 14,
    "human_patch": "https://github.com/jenkinsci/jenkins/commit/e5046911c57e60a1d6d8aca9b21bd9093b0f3763",
    "cve_id": "CVE-2018-1999044",
    "cwe_id": "CWE-835",
    "filename": "core/src/main/java/hudson/scheduler/CronTab.java",
    "is_vulnerable": 1,
    "class_name": "CronTab",
    "subclass_name": "CalendarField",
    "function_name": "rollUp(Calendar cal, int i)",
    "function_body": "{ cal.add(Calendar.HOUR_OF_DAY,i); }"
  },
  {
    "id": 50,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 15,
    "human_patch": "https://github.com/jenkinsci/jenkins/commit/e5046911c57e60a1d6d8aca9b21bd9093b0f3763",
    "cve_id": "CVE-2018-1999044",
    "cwe_id": "CWE-835",
    "filename": "core/src/main/java/hudson/scheduler/CronTab.java",
    "is_vulnerable": 1,
    "class_name": "CronTab",
    "subclass_name": "CalendarField",
    "function_name": "bits(CronTab c)",
    "function_body": "{ return c.bits[1]; }"
  },
  {
    "id": 50,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 16,
    "human_patch": "https://github.com/jenkinsci/jenkins/commit/e5046911c57e60a1d6d8aca9b21bd9093b0f3763",
    "cve_id": "CVE-2018-1999044",
    "cwe_id": "CWE-835",
    "filename": "core/src/main/java/hudson/scheduler/CronTab.java",
    "is_vulnerable": 1,
    "class_name": "CronTab",
    "subclass_name": "CalendarField",
    "function_name": "rollUp(Calendar cal, int i)",
    "function_body": "{ cal.add(Calendar.DAY_OF_MONTH,i); }"
  },
  {
    "id": 50,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 17,
    "human_patch": "https://github.com/jenkinsci/jenkins/commit/e5046911c57e60a1d6d8aca9b21bd9093b0f3763",
    "cve_id": "CVE-2018-1999044",
    "cwe_id": "CWE-835",
    "filename": "core/src/main/java/hudson/scheduler/CronTab.java",
    "is_vulnerable": 1,
    "class_name": "CronTab",
    "subclass_name": "CalendarField",
    "function_name": "bits(CronTab c)",
    "function_body": "{ return c.bits[2]; }"
  },
  {
    "id": 50,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 18,
    "human_patch": "https://github.com/jenkinsci/jenkins/commit/e5046911c57e60a1d6d8aca9b21bd9093b0f3763",
    "cve_id": "CVE-2018-1999044",
    "cwe_id": "CWE-835",
    "filename": "core/src/main/java/hudson/scheduler/CronTab.java",
    "is_vulnerable": 1,
    "class_name": "CronTab",
    "subclass_name": "CalendarField",
    "function_name": "rollUp(Calendar cal, int i)",
    "function_body": "{ cal.add(Calendar.MONTH,i); }"
  },
  {
    "id": 50,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 19,
    "human_patch": "https://github.com/jenkinsci/jenkins/commit/e5046911c57e60a1d6d8aca9b21bd9093b0f3763",
    "cve_id": "CVE-2018-1999044",
    "cwe_id": "CWE-835",
    "filename": "core/src/main/java/hudson/scheduler/CronTab.java",
    "is_vulnerable": 1,
    "class_name": "CronTab",
    "subclass_name": "CalendarField",
    "function_name": "bits(CronTab c)",
    "function_body": "{ return c.bits[3]; }"
  },
  {
    "id": 50,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 20,
    "human_patch": "https://github.com/jenkinsci/jenkins/commit/e5046911c57e60a1d6d8aca9b21bd9093b0f3763",
    "cve_id": "CVE-2018-1999044",
    "cwe_id": "CWE-835",
    "filename": "core/src/main/java/hudson/scheduler/CronTab.java",
    "is_vulnerable": 1,
    "class_name": "CronTab",
    "subclass_name": "CalendarField",
    "function_name": "rollUp(Calendar cal, int i)",
    "function_body": "{ cal.add(Calendar.YEAR,i); }"
  },
  {
    "id": 50,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 21,
    "human_patch": "https://github.com/jenkinsci/jenkins/commit/e5046911c57e60a1d6d8aca9b21bd9093b0f3763",
    "cve_id": "CVE-2018-1999044",
    "cwe_id": "CWE-835",
    "filename": "core/src/main/java/hudson/scheduler/CronTab.java",
    "is_vulnerable": 1,
    "class_name": "CronTab",
    "subclass_name": "CalendarField",
    "function_name": "bits(CronTab c)",
    "function_body": "{ return c.dayOfWeek; }"
  },
  {
    "id": 50,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 22,
    "human_patch": "https://github.com/jenkinsci/jenkins/commit/e5046911c57e60a1d6d8aca9b21bd9093b0f3763",
    "cve_id": "CVE-2018-1999044",
    "cwe_id": "CWE-835",
    "filename": "core/src/main/java/hudson/scheduler/CronTab.java",
    "is_vulnerable": 1,
    "class_name": "CronTab",
    "subclass_name": "CalendarField",
    "function_name": "rollUp(Calendar cal, int i)",
    "function_body": "{\n                cal.add(Calendar.DAY_OF_WEEK, 7 * i);\n            }"
  },
  {
    "id": 50,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 23,
    "human_patch": "https://github.com/jenkinsci/jenkins/commit/e5046911c57e60a1d6d8aca9b21bd9093b0f3763",
    "cve_id": "CVE-2018-1999044",
    "cwe_id": "CWE-835",
    "filename": "core/src/main/java/hudson/scheduler/CronTab.java",
    "is_vulnerable": 1,
    "class_name": "CronTab",
    "subclass_name": "CalendarField",
    "function_name": "setTo(Calendar c, int i)",
    "function_body": "{\n                int v = i-offset;\n                int was = c.get(field);\n                c.set(field,v);\n                final int firstDayOfWeek = c.getFirstDayOfWeek();\n                if (v < firstDayOfWeek && was >= firstDayOfWeek) {\n                    \n                    \n                    \n                    addTo(c,-7);\n                } else if (was < firstDayOfWeek && firstDayOfWeek <= v) {\n                    \n                    addTo(c, 7);\n                }\n            }"
  },
  {
    "id": 50,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 24,
    "human_patch": "https://github.com/jenkinsci/jenkins/commit/e5046911c57e60a1d6d8aca9b21bd9093b0f3763",
    "cve_id": "CVE-2018-1999044",
    "cwe_id": "CWE-835",
    "filename": "core/src/main/java/hudson/scheduler/CronTab.java",
    "is_vulnerable": 0,
    "class_name": "CronTab",
    "subclass_name": null,
    "function_name": "ceil(long t)",
    "function_body": "{\n        Calendar cal = new GregorianCalendar(Locale.US);\n        cal.setTimeInMillis(t);\n        return ceil(cal);\n    }"
  },
  {
    "id": 50,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 25,
    "human_patch": "https://github.com/jenkinsci/jenkins/commit/e5046911c57e60a1d6d8aca9b21bd9093b0f3763",
    "cve_id": "CVE-2018-1999044",
    "cwe_id": "CWE-835",
    "filename": "core/src/main/java/hudson/scheduler/CronTab.java",
    "is_vulnerable": 0,
    "class_name": "CronTab",
    "subclass_name": null,
    "function_name": "ceil(Calendar cal)",
    "function_body": "{\n        Calendar twoYearsFuture = (Calendar) cal.clone();\n        twoYearsFuture.add(Calendar.YEAR, 2);\n        OUTER:\n        while (true) {\n            if (cal.compareTo(twoYearsFuture) > 0) {\n                \n                throw new RareOrImpossibleDateException();\n            }\n            for (CalendarField f : CalendarField.ADJUST_ORDER) {\n                int cur = f.valueOf(cal);\n                int next = f.ceil(this,cur);\n                if (cur==next)  continue;   \n\n                \n                for (CalendarField l=f.lowerField; l!=null; l=l.lowerField)\n                    l.clear(cal);\n\n                if (next<0) {\n                    \n                    f.rollUp(cal, 1);\n                    f.setTo(cal,f.first(this));\n                    \n                    continue OUTER;\n                } else {\n                    f.setTo(cal,next);\n                    if (f.redoAdjustmentIfModified)\n                        continue OUTER; \n                }\n            }\n            return cal; \n        }\n    }"
  },
  {
    "id": 50,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 26,
    "human_patch": "https://github.com/jenkinsci/jenkins/commit/e5046911c57e60a1d6d8aca9b21bd9093b0f3763",
    "cve_id": "CVE-2018-1999044",
    "cwe_id": "CWE-835",
    "filename": "core/src/main/java/hudson/scheduler/CronTab.java",
    "is_vulnerable": 0,
    "class_name": "CronTab",
    "subclass_name": null,
    "function_name": "floor(long t)",
    "function_body": "{\n        Calendar cal = new GregorianCalendar(Locale.US);\n        cal.setTimeInMillis(t);\n        return floor(cal);\n    }"
  },
  {
    "id": 50,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 27,
    "human_patch": "https://github.com/jenkinsci/jenkins/commit/e5046911c57e60a1d6d8aca9b21bd9093b0f3763",
    "cve_id": "CVE-2018-1999044",
    "cwe_id": "CWE-835",
    "filename": "core/src/main/java/hudson/scheduler/CronTab.java",
    "is_vulnerable": 0,
    "class_name": "CronTab",
    "subclass_name": null,
    "function_name": "floor(Calendar cal)",
    "function_body": "{\n        Calendar twoYearsAgo = (Calendar) cal.clone();\n        twoYearsAgo.add(Calendar.YEAR, -2);\n\n        OUTER:\n        while (true) {\n            if (cal.compareTo(twoYearsAgo) < 0) {\n                \n                throw new RareOrImpossibleDateException();\n            }\n            for (CalendarField f : CalendarField.ADJUST_ORDER) {\n                int cur = f.valueOf(cal);\n                int next = f.floor(this,cur);\n                if (cur==next)  continue;   \n\n                \n                for (CalendarField l=f.lowerField; l!=null; l=l.lowerField)\n                    l.clear(cal);\n\n                if (next<0) {\n                    \n                    f.rollUp(cal,-1);\n                    \n                    \n                    \n                    f.setTo(cal,f.last(this));\n                    f.addTo(cal,1);\n                    \n                    \n                    CalendarField.MINUTE.addTo(cal,-1);\n                    \n                    continue OUTER;\n                } else {\n                    f.setTo(cal,next);\n                    f.addTo(cal,1);\n                    CalendarField.MINUTE.addTo(cal,-1);\n                    if (f.redoAdjustmentIfModified)\n                        continue OUTER; \n                }\n            }\n            return cal; \n        }\n    }"
  },
  {
    "id": 50,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 28,
    "human_patch": "https://github.com/jenkinsci/jenkins/commit/e5046911c57e60a1d6d8aca9b21bd9093b0f3763",
    "cve_id": "CVE-2018-1999044",
    "cwe_id": "CWE-835",
    "filename": "core/src/main/java/hudson/scheduler/CronTab.java",
    "is_vulnerable": 0,
    "class_name": "CronTab",
    "subclass_name": null,
    "function_name": "set(String format, Hash hash) throws ANTLRException",
    "function_body": "{\n        set(format,1,hash);\n    }"
  },
  {
    "id": 50,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 29,
    "human_patch": "https://github.com/jenkinsci/jenkins/commit/e5046911c57e60a1d6d8aca9b21bd9093b0f3763",
    "cve_id": "CVE-2018-1999044",
    "cwe_id": "CWE-835",
    "filename": "core/src/main/java/hudson/scheduler/CronTab.java",
    "is_vulnerable": 0,
    "class_name": "CronTab",
    "subclass_name": null,
    "function_name": "checkBits(long bitMask, int n)",
    "function_body": "{\n        return (bitMask|(1L<<n))==bitMask;\n    }"
  },
  {
    "id": 50,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 30,
    "human_patch": "https://github.com/jenkinsci/jenkins/commit/e5046911c57e60a1d6d8aca9b21bd9093b0f3763",
    "cve_id": "CVE-2018-1999044",
    "cwe_id": "CWE-835",
    "filename": "core/src/main/java/hudson/scheduler/CronTab.java",
    "is_vulnerable": 0,
    "class_name": "CronTab",
    "subclass_name": null,
    "function_name": "toString()",
    "function_body": "{\n        return super.toString()+\"[\"+\n            toString(\"minute\",bits[0])+','+\n            toString(\"hour\",bits[1])+','+\n            toString(\"dayOfMonth\",bits[2])+','+\n            toString(\"month\",bits[3])+','+\n            toString(\"dayOfWeek\",dayOfWeek)+']';\n    }"
  },
  {
    "id": 50,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 31,
    "human_patch": "https://github.com/jenkinsci/jenkins/commit/e5046911c57e60a1d6d8aca9b21bd9093b0f3763",
    "cve_id": "CVE-2018-1999044",
    "cwe_id": "CWE-835",
    "filename": "core/src/main/java/hudson/scheduler/CronTab.java",
    "is_vulnerable": 0,
    "class_name": "CronTab",
    "subclass_name": null,
    "function_name": "toString(String key, long bit)",
    "function_body": "{\n        return key+'='+Long.toHexString(bit);\n    }"
  },
  {
    "id": 50,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 32,
    "human_patch": "https://github.com/jenkinsci/jenkins/commit/e5046911c57e60a1d6d8aca9b21bd9093b0f3763",
    "cve_id": "CVE-2018-1999044",
    "cwe_id": "CWE-835",
    "filename": "core/src/main/java/hudson/scheduler/CronTab.java",
    "is_vulnerable": 0,
    "class_name": "CronTab",
    "subclass_name": null,
    "function_name": "checkSanity()",
    "function_body": "{\n        OUTER: for (int i = 0; i < 5; i++) {\n            long bitMask = (i<4)?bits[i]:(long)dayOfWeek;\n            for( int j=BaseParser.LOWER_BOUNDS[i]; j<=BaseParser.UPPER_BOUNDS[i]; j++ ) {\n                if(!checkBits(bitMask,j)) {\n                    \n                    \n                    if(i>0)\n                        return Messages.CronTab_do_you_really_mean_every_minute_when_you(spec, \"H \" + spec.substring(spec.indexOf(' ') + 1));\n                    \n                    break OUTER;\n                }\n            }\n        }\n\n        int daysOfMonth = 0;\n        for (int i = 1; i < 31; i++) {\n            if (checkBits(bits[2], i)) {\n                daysOfMonth++;\n            }\n        }\n        if (daysOfMonth > 5 && daysOfMonth < 28) { \n            return Messages.CronTab_short_cycles_in_the_day_of_month_field_w();\n        }\n\n        String hashified = hashify(spec);\n        if (hashified != null) {\n            return Messages.CronTab_spread_load_evenly_by_using_rather_than_(hashified, spec);\n        }\n\n        return null;\n    }"
  },
  {
    "id": 50,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 33,
    "human_patch": "https://github.com/jenkinsci/jenkins/commit/e5046911c57e60a1d6d8aca9b21bd9093b0f3763",
    "cve_id": "CVE-2018-1999044",
    "cwe_id": "CWE-835",
    "filename": "core/src/main/java/hudson/scheduler/CronTab.java",
    "is_vulnerable": 0,
    "class_name": "CronTab",
    "subclass_name": null,
    "function_name": "hashify(String spec)",
    "function_body": "{\n        if (spec.contains(\"H\")) {\n            \n            return null;\n        } else if (spec.startsWith(\"*/\")) {\n            return \"H\" + spec.substring(1);\n        } else if (spec.matches(\"\\\\d+ .+\")) {\n            return \"H \" + spec.substring(spec.indexOf(' ') + 1);\n        } else {\n            Matcher m = Pattern.compile(\"0(,(\\\\d+)(,\\\\d+)*)( .+)\").matcher(spec);\n            if (m.matches()) { \n                int period = Integer.parseInt(m.group(2));\n                if (period > 0) {\n                    StringBuilder b = new StringBuilder();\n                    for (int i = period; i < 60; i += period) {\n                        b.append(',').append(i);\n                    }\n                    if (b.toString().equals(m.group(1))) {\n                        return \"H/\" + period + m.group(4);\n                    }\n                }\n            }\n            return null;\n        }\n    }"
  },
  {
    "id": 50,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 34,
    "human_patch": "https://github.com/jenkinsci/jenkins/commit/e5046911c57e60a1d6d8aca9b21bd9093b0f3763",
    "cve_id": "CVE-2018-1999044",
    "cwe_id": "CWE-835",
    "filename": "core/src/main/java/hudson/scheduler/CronTab.java",
    "is_vulnerable": 0,
    "class_name": "CronTab",
    "subclass_name": null,
    "function_name": "getTimeZone()",
    "function_body": "{\n        if (this.specTimezone == null) {\n            return null;\n        }\n        return TimeZone.getTimeZone(this.specTimezone);\n    }"
  },
  {
    "id": 50,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 0,
    "human_patch": "https://github.com/jenkinsci/jenkins/commit/e5046911c57e60a1d6d8aca9b21bd9093b0f3763",
    "cve_id": "CVE-2018-1999044",
    "cwe_id": "CWE-835",
    "filename": "core/src/test/java/hudson/scheduler/CronTabTest.java",
    "is_vulnerable": 0,
    "class_name": "CronTabTest",
    "subclass_name": null,
    "function_name": "test1() throws ANTLRException",
    "function_body": "{\n        new CronTab(\"@yearly\");\n        new CronTab(\"@weekly\");\n        new CronTab(\"@midnight\");\n        new CronTab(\"@monthly\");\n        new CronTab(\"0 0 * 1-10/3 *\");\n    }"
  },
  {
    "id": 50,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 1,
    "human_patch": "https://github.com/jenkinsci/jenkins/commit/e5046911c57e60a1d6d8aca9b21bd9093b0f3763",
    "cve_id": "CVE-2018-1999044",
    "cwe_id": "CWE-835",
    "filename": "core/src/test/java/hudson/scheduler/CronTabTest.java",
    "is_vulnerable": 0,
    "class_name": "CronTabTest",
    "subclass_name": null,
    "function_name": "testCeil1() throws Exception",
    "function_body": "{\n        CronTab x = new CronTab(\"0,30 * * * *\");\n        Calendar c = new GregorianCalendar(2000,2,1,1,10);\n        compare(new GregorianCalendar(2000,2,1,1,30),x.ceil(c));\n\n        \n        c =     new GregorianCalendar(2000,2,1,1,40);\n        compare(new GregorianCalendar(2000,2,1,2, 0),x.ceil(c));\n    }"
  },
  {
    "id": 50,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 2,
    "human_patch": "https://github.com/jenkinsci/jenkins/commit/e5046911c57e60a1d6d8aca9b21bd9093b0f3763",
    "cve_id": "CVE-2018-1999044",
    "cwe_id": "CWE-835",
    "filename": "core/src/test/java/hudson/scheduler/CronTabTest.java",
    "is_vulnerable": 0,
    "class_name": "CronTabTest",
    "subclass_name": null,
    "function_name": "testCeil2() throws Exception",
    "function_body": "{\n        \n        CronTab x = new CronTab(\"15,45 3 * * *\");\n        Calendar c = new GregorianCalendar(2000,2,1,2,30);\n        compare(new GregorianCalendar(2000,2,1,3,15),x.ceil(c));\n    }"
  },
  {
    "id": 50,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 3,
    "human_patch": "https://github.com/jenkinsci/jenkins/commit/e5046911c57e60a1d6d8aca9b21bd9093b0f3763",
    "cve_id": "CVE-2018-1999044",
    "cwe_id": "CWE-835",
    "filename": "core/src/test/java/hudson/scheduler/CronTabTest.java",
    "is_vulnerable": 0,
    "class_name": "CronTabTest",
    "subclass_name": null,
    "function_name": "testCeil3() throws Exception",
    "function_body": "{\n        \n        CronTab x = new CronTab(\"0 0 1 * 0\");\n        Calendar c = new GregorianCalendar(2010,0,1,15,55);\n        \n        compare(new GregorianCalendar(2010,7,1,0,0),x.ceil(c));\n    }"
  },
  {
    "id": 50,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 4,
    "human_patch": "https://github.com/jenkinsci/jenkins/commit/e5046911c57e60a1d6d8aca9b21bd9093b0f3763",
    "cve_id": "CVE-2018-1999044",
    "cwe_id": "CWE-835",
    "filename": "core/src/test/java/hudson/scheduler/CronTabTest.java",
    "is_vulnerable": 0,
    "class_name": "CronTabTest",
    "subclass_name": null,
    "function_name": "testCeil3_DoW7() throws Exception",
    "function_body": "{\n        \n        CronTab x = new CronTab(\"0 0 1 * 7\");\n        Calendar c = new GregorianCalendar(2010,0,1,15,55);\n        \n        compare(new GregorianCalendar(2010, 7, 1, 0, 0), x.ceil(c));\n    }"
  },
  {
    "id": 50,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 5,
    "human_patch": "https://github.com/jenkinsci/jenkins/commit/e5046911c57e60a1d6d8aca9b21bd9093b0f3763",
    "cve_id": "CVE-2018-1999044",
    "cwe_id": "CWE-835",
    "filename": "core/src/test/java/hudson/scheduler/CronTabTest.java",
    "is_vulnerable": 0,
    "class_name": "CronTabTest",
    "subclass_name": null,
    "function_name": "testCeil4() throws ANTLRException",
    "function_body": "{\n        final Calendar cal = Calendar.getInstance(new Locale(\"de\", \"de\"));\n        cal.set(2011, 0, 16, 0, 0, 0); \n        final String cronStr = \"0 23 * * 1-5\"; \n\n        final CronTab cron = new CronTab(cronStr);\n        final Calendar next = cron.ceil(cal);\n\n        final Calendar expectedDate = Calendar.getInstance();\n        expectedDate.set(2011, 0, 17, 23, 0, 0); \n        assertEquals(expectedDate.get(Calendar.HOUR), next.get(Calendar.HOUR));\n        assertEquals(expectedDate.get(Calendar.MINUTE), next.get(Calendar.MINUTE));\n        assertEquals(expectedDate.get(Calendar.YEAR), next.get(Calendar.YEAR));\n        assertEquals(expectedDate.get(Calendar.MONTH), next.get(Calendar.MONTH));\n        assertEquals(expectedDate.get(Calendar.DAY_OF_MONTH), next.get(Calendar.DAY_OF_MONTH)); \n    }"
  },
  {
    "id": 50,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 6,
    "human_patch": "https://github.com/jenkinsci/jenkins/commit/e5046911c57e60a1d6d8aca9b21bd9093b0f3763",
    "cve_id": "CVE-2018-1999044",
    "cwe_id": "CWE-835",
    "filename": "core/src/test/java/hudson/scheduler/CronTabTest.java",
    "is_vulnerable": 0,
    "class_name": "CronTabTest",
    "subclass_name": null,
    "function_name": "testCeil5() throws ANTLRException",
    "function_body": "{\n        final Calendar cal = Calendar.getInstance(new Locale(\"de\", \"at\"));\n        cal.set(2011, 0, 16, 0, 0, 0); \n        final String cronStr = \"0 23 * * 1-5\"; \n\n        final CronTab cron = new CronTab(cronStr);\n        final Calendar next = cron.ceil(cal);\n\n        final Calendar expectedDate = Calendar.getInstance();\n        expectedDate.set(2011, 0, 17, 23, 0, 0); \n        assertEquals(expectedDate.get(Calendar.HOUR), next.get(Calendar.HOUR));\n        assertEquals(expectedDate.get(Calendar.MINUTE), next.get(Calendar.MINUTE));\n        assertEquals(expectedDate.get(Calendar.YEAR), next.get(Calendar.YEAR));\n        assertEquals(expectedDate.get(Calendar.MONTH), next.get(Calendar.MONTH));\n        assertEquals(expectedDate.get(Calendar.DAY_OF_MONTH), next.get(Calendar.DAY_OF_MONTH)); \n    }"
  },
  {
    "id": 50,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 7,
    "human_patch": "https://github.com/jenkinsci/jenkins/commit/e5046911c57e60a1d6d8aca9b21bd9093b0f3763",
    "cve_id": "CVE-2018-1999044",
    "cwe_id": "CWE-835",
    "filename": "core/src/test/java/hudson/scheduler/CronTabTest.java",
    "is_vulnerable": 0,
    "class_name": "CronTabTest",
    "subclass_name": null,
    "function_name": "testFloor1() throws Exception",
    "function_body": "{\n        CronTab x = new CronTab(\"30 * * * *\");\n        Calendar c = new GregorianCalendar(2000,2,1,1,40);\n        compare(new GregorianCalendar(2000,2,1,1,30),x.floor(c));\n\n        \n        c =     new GregorianCalendar(2000,2,1,1,10);\n        compare(new GregorianCalendar(2000,2,1,0,30),x.floor(c));\n    }"
  },
  {
    "id": 50,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 8,
    "human_patch": "https://github.com/jenkinsci/jenkins/commit/e5046911c57e60a1d6d8aca9b21bd9093b0f3763",
    "cve_id": "CVE-2018-1999044",
    "cwe_id": "CWE-835",
    "filename": "core/src/test/java/hudson/scheduler/CronTabTest.java",
    "is_vulnerable": 0,
    "class_name": "CronTabTest",
    "subclass_name": null,
    "function_name": "testFloor2() throws Exception",
    "function_body": "{\n        \n        CronTab x = new CronTab(\"15,45 3 * * *\");\n        Calendar c = new GregorianCalendar(2000,2,1,4,30);\n        compare(new GregorianCalendar(2000,2,1,3,45),x.floor(c));\n    }"
  },
  {
    "id": 50,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 9,
    "human_patch": "https://github.com/jenkinsci/jenkins/commit/e5046911c57e60a1d6d8aca9b21bd9093b0f3763",
    "cve_id": "CVE-2018-1999044",
    "cwe_id": "CWE-835",
    "filename": "core/src/test/java/hudson/scheduler/CronTabTest.java",
    "is_vulnerable": 0,
    "class_name": "CronTabTest",
    "subclass_name": null,
    "function_name": "testFloor3() throws Exception",
    "function_body": "{\n        \n        CronTab x = new CronTab(\"0 0 1 * 0\");\n        Calendar c = new GregorianCalendar(2011,0,1,15,55);\n        \n        compare(new GregorianCalendar(2010,7,1,0,0),x.floor(c));\n    }"
  },
  {
    "id": 50,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 10,
    "human_patch": "https://github.com/jenkinsci/jenkins/commit/e5046911c57e60a1d6d8aca9b21bd9093b0f3763",
    "cve_id": "CVE-2018-1999044",
    "cwe_id": "CWE-835",
    "filename": "core/src/test/java/hudson/scheduler/CronTabTest.java",
    "is_vulnerable": 0,
    "class_name": "CronTabTest",
    "subclass_name": null,
    "function_name": "testFloor4() throws Exception",
    "function_body": "{\n        \n        CronTab x = new CronTab(\"0 0 1 * 0\");\n        Calendar c = new GregorianCalendar(2011,0,1,15,55);\n        c.setFirstDayOfWeek(MONDAY);\n        \n        GregorianCalendar answer = new GregorianCalendar(2010, 7, 1, 0, 0);\n        answer.setFirstDayOfWeek(MONDAY);\n        compare(answer,x.floor(c));\n    }"
  },
  {
    "id": 50,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 11,
    "human_patch": "https://github.com/jenkinsci/jenkins/commit/e5046911c57e60a1d6d8aca9b21bd9093b0f3763",
    "cve_id": "CVE-2018-1999044",
    "cwe_id": "CWE-835",
    "filename": "core/src/test/java/hudson/scheduler/CronTabTest.java",
    "is_vulnerable": 0,
    "class_name": "CronTabTest",
    "subclass_name": null,
    "function_name": "checkSanity() throws Exception",
    "function_body": "{\n        assertEquals(null, new CronTab(\"@hourly\").checkSanity());\n        assertEquals(Messages.CronTab_do_you_really_mean_every_minute_when_you(\"* * * * *\", \"H * * * *\"), new CronTab(\"* * * * *\").checkSanity());\n        assertEquals(Messages.CronTab_do_you_really_mean_every_minute_when_you(\"*/1 * * * *\", \"H * * * *\"), new CronTab(\"*/1 * * * *\").checkSanity());\n        assertEquals(null, new CronTab(\"H H(0-2) * * *\", Hash.from(\"stuff\")).checkSanity());\n        assertEquals(Messages.CronTab_do_you_really_mean_every_minute_when_you(\"* 0 * * *\", \"H 0 * * *\"), new CronTab(\"* 0 * * *\").checkSanity());\n        assertEquals(Messages.CronTab_do_you_really_mean_every_minute_when_you(\"* 6,18 * * *\", \"H 6,18 * * *\"), new CronTab(\"* 6,18 * * *\").checkSanity());\n        \n        assertEquals(Messages.CronTab_do_you_really_mean_every_minute_when_you(\"* * 3 * *\", \"H * 3 * *\"), new CronTab(\"* * 3 * *\").checkSanity());\n        \n        assertEquals(Messages.CronTab_spread_load_evenly_by_using_rather_than_(\"H/15 * * * *\", \"*/15 * * * *\"), new CronTab(\"*/15 * * * *\").checkSanity());\n        assertEquals(Messages.CronTab_spread_load_evenly_by_using_rather_than_(\"H/15 * * * *\", \"0,15,30,45 * * * *\"), new CronTab(\"0,15,30,45 * * * *\").checkSanity());\n        assertEquals(Messages.CronTab_spread_load_evenly_by_using_rather_than_(\"H * * * *\", \"0 * * * *\"), new CronTab(\"0 * * * *\").checkSanity());\n        assertEquals(Messages.CronTab_spread_load_evenly_by_using_rather_than_(\"H * * * *\", \"5 * * * *\"), new CronTab(\"5 * * * *\").checkSanity());\n        \n        assertEquals(Messages.CronTab_spread_load_evenly_by_using_rather_than_(\"H 3 * * *\", \"0 3 * * *\"), new CronTab(\"0 3 * * *\").checkSanity());\n        assertEquals(Messages.CronTab_spread_load_evenly_by_using_rather_than_(\"H 22 * * 6\", \"00 22 * * 6\"), new CronTab(\"00 22 * * 6\").checkSanity());\n        assertEquals(null, new CronTab(\"H/15 * 1 1 *\").checkSanity());\n        assertEquals(null, new CronTab(\"0 3 H/15 * *\").checkSanity());\n        assertEquals(Messages.CronTab_short_cycles_in_the_day_of_month_field_w(), new CronTab(\"0 3 H/3 * *\").checkSanity());\n        assertEquals(Messages.CronTab_short_cycles_in_the_day_of_month_field_w(), new CronTab(\"0 3 */5 * *\").checkSanity());\n    }"
  },
  {
    "id": 50,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 12,
    "human_patch": "https://github.com/jenkinsci/jenkins/commit/e5046911c57e60a1d6d8aca9b21bd9093b0f3763",
    "cve_id": "CVE-2018-1999044",
    "cwe_id": "CWE-835",
    "filename": "core/src/test/java/hudson/scheduler/CronTabTest.java",
    "is_vulnerable": 0,
    "class_name": "CronTabTest",
    "subclass_name": null,
    "function_name": "compare(Calendar expected, Calendar actual)",
    "function_body": "{\n        DateFormat f = DateFormat.getDateTimeInstance();\n        assertEquals(f.format(expected.getTime()), f.format(actual.getTime()));\n    }"
  },
  {
    "id": 50,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 13,
    "human_patch": "https://github.com/jenkinsci/jenkins/commit/e5046911c57e60a1d6d8aca9b21bd9093b0f3763",
    "cve_id": "CVE-2018-1999044",
    "cwe_id": "CWE-835",
    "filename": "core/src/test/java/hudson/scheduler/CronTabTest.java",
    "is_vulnerable": 0,
    "class_name": "CronTabTest",
    "subclass_name": null,
    "function_name": "testHash1() throws Exception",
    "function_body": "{\n        CronTab x = new CronTab(\"H H(5-8) H/3 H(1-10)/4 *\",new Hash() {\n            public int next(int n) {\n                return n-1;\n            }\n        });\n\n        assertEquals(\"59;\", bitset(x.bits[0]));\n        assertEquals(\"8;\", bitset(x.bits[1]));\n        assertEquals(\"3;6;9;12;15;18;21;24;27;\", bitset(x.bits[2]));\n        assertEquals(\"4;8;\", bitset(x.bits[3]));\n    }"
  },
  {
    "id": 50,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 14,
    "human_patch": "https://github.com/jenkinsci/jenkins/commit/e5046911c57e60a1d6d8aca9b21bd9093b0f3763",
    "cve_id": "CVE-2018-1999044",
    "cwe_id": "CWE-835",
    "filename": "core/src/test/java/hudson/scheduler/CronTabTest.java",
    "is_vulnerable": 0,
    "class_name": "CronTabTest",
    "subclass_name": null,
    "function_name": "next(int n)",
    "function_body": "{\n                return n-1;\n            }"
  },
  {
    "id": 50,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 15,
    "human_patch": "https://github.com/jenkinsci/jenkins/commit/e5046911c57e60a1d6d8aca9b21bd9093b0f3763",
    "cve_id": "CVE-2018-1999044",
    "cwe_id": "CWE-835",
    "filename": "core/src/test/java/hudson/scheduler/CronTabTest.java",
    "is_vulnerable": 0,
    "class_name": "CronTabTest",
    "subclass_name": null,
    "function_name": "bitset(long bits)",
    "function_body": "{\n        StringBuilder b = new StringBuilder();\n        for (int i = 0; i < 64; i++) {\n            if ((bits & 1L << i) != 0) {\n                b.append(i).append(';');\n            }\n        }\n        return b.toString();\n    }"
  },
  {
    "id": 50,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 16,
    "human_patch": "https://github.com/jenkinsci/jenkins/commit/e5046911c57e60a1d6d8aca9b21bd9093b0f3763",
    "cve_id": "CVE-2018-1999044",
    "cwe_id": "CWE-835",
    "filename": "core/src/test/java/hudson/scheduler/CronTabTest.java",
    "is_vulnerable": 0,
    "class_name": "CronTabTest",
    "subclass_name": null,
    "function_name": "testHash2() throws Exception",
    "function_body": "{\n        CronTab x = new CronTab(\"H H(5-8) H/3 H(1-10)/4 *\",new Hash() {\n            public int next(int n) {\n                return 1;\n            }\n        });\n\n        assertEquals(\"1;\", bitset(x.bits[0]));\n        assertEquals(\"6;\", bitset(x.bits[1]));\n        assertEquals(\"2;5;8;11;14;17;20;23;26;\", bitset(x.bits[2]));\n        assertEquals(\"2;6;10;\", bitset(x.bits[3]));\n    }"
  },
  {
    "id": 50,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 17,
    "human_patch": "https://github.com/jenkinsci/jenkins/commit/e5046911c57e60a1d6d8aca9b21bd9093b0f3763",
    "cve_id": "CVE-2018-1999044",
    "cwe_id": "CWE-835",
    "filename": "core/src/test/java/hudson/scheduler/CronTabTest.java",
    "is_vulnerable": 1,
    "class_name": "CronTabTest",
    "subclass_name": null,
    "function_name": "next(int n)",
    "function_body": "{\n                return 1;\n            }"
  },
  {
    "id": 50,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 18,
    "human_patch": "https://github.com/jenkinsci/jenkins/commit/e5046911c57e60a1d6d8aca9b21bd9093b0f3763",
    "cve_id": "CVE-2018-1999044",
    "cwe_id": "CWE-835",
    "filename": "core/src/test/java/hudson/scheduler/CronTabTest.java",
    "is_vulnerable": 0,
    "class_name": "CronTabTest",
    "subclass_name": null,
    "function_name": "hashedMinute() throws Exception",
    "function_body": "{\n        long t = new GregorianCalendar(2013, 2, 21, 16, 21).getTimeInMillis();\n        compare(new GregorianCalendar(2013, 2, 21, 17, 56), new CronTab(\"H 17 * * *\", Hash.from(\"stuff\")).ceil(t));\n        compare(new GregorianCalendar(2013, 2, 21, 16, 56), new CronTab(\"H * * * *\", Hash.from(\"stuff\")).ceil(t));\n        compare(new GregorianCalendar(2013, 2, 21, 16, 56), new CronTab(\"@hourly\", Hash.from(\"stuff\")).ceil(t));\n        compare(new GregorianCalendar(2013, 2, 21, 17, 20), new CronTab(\"@hourly\", Hash.from(\"junk\")).ceil(t));\n        compare(new GregorianCalendar(2013, 2, 22, 13, 56), new CronTab(\"H H(12-13) * * *\", Hash.from(\"stuff\")).ceil(t));\n    }"
  },
  {
    "id": 50,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 19,
    "human_patch": "https://github.com/jenkinsci/jenkins/commit/e5046911c57e60a1d6d8aca9b21bd9093b0f3763",
    "cve_id": "CVE-2018-1999044",
    "cwe_id": "CWE-835",
    "filename": "core/src/test/java/hudson/scheduler/CronTabTest.java",
    "is_vulnerable": 0,
    "class_name": "CronTabTest",
    "subclass_name": null,
    "function_name": "hashSkips() throws Exception",
    "function_body": "{\n        compare(new GregorianCalendar(2013, 2, 21, 16, 26), new CronTab(\"H/15 * * * *\", Hash.from(\"stuff\")).ceil(new GregorianCalendar(2013, 2, 21, 16, 21)));\n        compare(new GregorianCalendar(2013, 2, 21, 16, 41), new CronTab(\"H/15 * * * *\", Hash.from(\"stuff\")).ceil(new GregorianCalendar(2013, 2, 21, 16, 31)));\n        compare(new GregorianCalendar(2013, 2, 21, 16, 56), new CronTab(\"H/15 * * * *\", Hash.from(\"stuff\")).ceil(new GregorianCalendar(2013, 2, 21, 16, 42)));\n        compare(new GregorianCalendar(2013, 2, 21, 17, 11), new CronTab(\"H/15 * * * *\", Hash.from(\"stuff\")).ceil(new GregorianCalendar(2013, 2, 21, 16, 59)));\n        compare(new GregorianCalendar(2013, 2, 21, 0, 2), new CronTab(\"H(0-15)/3 * * * *\", Hash.from(\"junk\")).ceil(new GregorianCalendar(2013, 2, 21, 0, 0)));\n        compare(new GregorianCalendar(2013, 2, 21, 0, 2), new CronTab(\"H(0-3)/4 * * * *\", Hash.from(\"junk\")).ceil(new GregorianCalendar(2013, 2, 21, 0, 0)));\n        compare(new GregorianCalendar(2013, 2, 21, 1, 2), new CronTab(\"H(0-3)/4 * * * *\", Hash.from(\"junk\")).ceil(new GregorianCalendar(2013, 2, 21, 0, 5)));\n        try {\n            compare(new GregorianCalendar(2013, 2, 21, 0, 0), new CronTab(\"H(0-3)/15 * * * *\", Hash.from(\"junk\")).ceil(new GregorianCalendar(2013, 2, 21, 0, 0)));\n            fail();\n        } catch (ANTLRException x) {\n            \n        }\n    }"
  },
  {
    "id": 50,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 20,
    "human_patch": "https://github.com/jenkinsci/jenkins/commit/e5046911c57e60a1d6d8aca9b21bd9093b0f3763",
    "cve_id": "CVE-2018-1999044",
    "cwe_id": "CWE-835",
    "filename": "core/src/test/java/hudson/scheduler/CronTabTest.java",
    "is_vulnerable": 0,
    "class_name": "CronTabTest",
    "subclass_name": null,
    "function_name": "repeatedHash() throws Exception",
    "function_body": "{\n        CronTabList tabs = CronTabList.create(\"H * * * *\\nH * * * *\", Hash.from(\"seed\"));\n        List<Integer> times = new ArrayList<Integer>();\n        for (int i = 0; i < 60; i++) {\n            if (tabs.check(new GregorianCalendar(2013, 3, 3, 11, i, 0))) {\n                times.add(i);\n            }\n        }\n        assertEquals(\"[35, 56]\", times.toString());\n    }"
  },
  {
    "id": 50,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 21,
    "human_patch": "https://github.com/jenkinsci/jenkins/commit/e5046911c57e60a1d6d8aca9b21bd9093b0f3763",
    "cve_id": "CVE-2018-1999044",
    "cwe_id": "CWE-835",
    "filename": "core/src/test/java/hudson/scheduler/CronTabTest.java",
    "is_vulnerable": 0,
    "class_name": "CronTabTest",
    "subclass_name": null,
    "function_name": "rangeBoundsCheckOK() throws Exception",
    "function_body": "{\n        new CronTab(\"H(0-59) H(0-23) H(1-31) H(1-12) H(0-7)\");\n    }"
  },
  {
    "id": 50,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 22,
    "human_patch": "https://github.com/jenkinsci/jenkins/commit/e5046911c57e60a1d6d8aca9b21bd9093b0f3763",
    "cve_id": "CVE-2018-1999044",
    "cwe_id": "CWE-835",
    "filename": "core/src/test/java/hudson/scheduler/CronTabTest.java",
    "is_vulnerable": 0,
    "class_name": "CronTabTest",
    "subclass_name": null,
    "function_name": "rangeBoundsCheckFailHour() throws Exception",
    "function_body": "{\n        try {\n            new CronTab(\"H H(12-24) * * *\");\n            fail();\n        } catch (ANTLRException e) {\n            \n        }\n    }"
  },
  {
    "id": 50,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 23,
    "human_patch": "https://github.com/jenkinsci/jenkins/commit/e5046911c57e60a1d6d8aca9b21bd9093b0f3763",
    "cve_id": "CVE-2018-1999044",
    "cwe_id": "CWE-835",
    "filename": "core/src/test/java/hudson/scheduler/CronTabTest.java",
    "is_vulnerable": 0,
    "class_name": "CronTabTest",
    "subclass_name": null,
    "function_name": "rangeBoundsCheckFailMinute() throws Exception",
    "function_body": "{\n        try {\n            new CronTab(\"H(33-66) * * * *\");\n            fail();\n        } catch (ANTLRException e) {\n            \n        }\n    }"
  },
  {
    "id": 50,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 24,
    "human_patch": "https://github.com/jenkinsci/jenkins/commit/e5046911c57e60a1d6d8aca9b21bd9093b0f3763",
    "cve_id": "CVE-2018-1999044",
    "cwe_id": "CWE-835",
    "filename": "core/src/test/java/hudson/scheduler/CronTabTest.java",
    "is_vulnerable": 0,
    "class_name": "CronTabTest",
    "subclass_name": null,
    "function_name": "testTimezone() throws Exception",
    "function_body": "{\n        CronTabList tabs = CronTabList.create(\"TZ=Australia/Sydney\\nH * * * *\\nH * * * *\", Hash.from(\"seed\"));\n        List<Integer> times = new ArrayList<Integer>();\n        for (int i = 0; i < 60; i++) {\n            if (tabs.check(new GregorianCalendar(2013, 3, 3, 11, i, 0))) {\n                times.add(i);\n            }\n        }\n        assertEquals(\"[35, 56]\", times.toString());\n    }"
  },
  {
    "id": 51,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 0,
    "human_patch": "https://github.com/jenkinsci/jenkins/commit/701ea95a52afe53bee28f76a3f96eb0e578852e9",
    "cve_id": "CVE-2017-1000355",
    "cwe_id": "CWE-502",
    "filename": "core/src/main/java/hudson/util/XStream2.java",
    "is_vulnerable": 0,
    "class_name": "XStream2",
    "subclass_name": null,
    "function_name": "unmarshal(HierarchicalStreamReader reader, Object root, DataHolder dataHolder)",
    "function_body": "{\n        \n        \n        Jenkins h = Jenkins.getInstance();\n        if(h!=null && h.pluginManager!=null && h.pluginManager.uberClassLoader!=null) {\n            setClassLoader(h.pluginManager.uberClassLoader);\n        }\n\n        Object o = super.unmarshal(reader,root,dataHolder);\n        if (oldData.get()!=null) {\n            oldData.remove();\n            if (o instanceof Saveable) OldDataMonitor.report((Saveable)o, \"1.106\");\n        }\n        return o;\n    }"
  },
  {
    "id": 51,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 1,
    "human_patch": "https://github.com/jenkinsci/jenkins/commit/701ea95a52afe53bee28f76a3f96eb0e578852e9",
    "cve_id": "CVE-2017-1000355",
    "cwe_id": "CWE-502",
    "filename": "core/src/main/java/hudson/util/XStream2.java",
    "is_vulnerable": 0,
    "class_name": "XStream2",
    "subclass_name": null,
    "function_name": "createDefaultConverter()",
    "function_body": "{\n        \n        reflectionConverter = new RobustReflectionConverter(getMapper(),new JVM().bestReflectionProvider(), new PluginClassOwnership());\n        return reflectionConverter;\n    }"
  },
  {
    "id": 51,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 2,
    "human_patch": "https://github.com/jenkinsci/jenkins/commit/701ea95a52afe53bee28f76a3f96eb0e578852e9",
    "cve_id": "CVE-2017-1000355",
    "cwe_id": "CWE-502",
    "filename": "core/src/main/java/hudson/util/XStream2.java",
    "is_vulnerable": 0,
    "class_name": "XStream2",
    "subclass_name": null,
    "function_name": "addCriticalField(Class<?> clazz, String field)",
    "function_body": "{\n        reflectionConverter.addCriticalField(clazz, field);\n    }"
  },
  {
    "id": 51,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 3,
    "human_patch": "https://github.com/jenkinsci/jenkins/commit/701ea95a52afe53bee28f76a3f96eb0e578852e9",
    "cve_id": "CVE-2017-1000355",
    "cwe_id": "CWE-502",
    "filename": "core/src/main/java/hudson/util/XStream2.java",
    "is_vulnerable": 0,
    "class_name": "XStream2",
    "subclass_name": null,
    "function_name": "trimVersion(String version)",
    "function_body": "{\n        \n        return version.replaceFirst(\" .+$\", \"\");\n    }"
  },
  {
    "id": 51,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 4,
    "human_patch": "https://github.com/jenkinsci/jenkins/commit/701ea95a52afe53bee28f76a3f96eb0e578852e9",
    "cve_id": "CVE-2017-1000355",
    "cwe_id": "CWE-502",
    "filename": "core/src/main/java/hudson/util/XStream2.java",
    "is_vulnerable": 1,
    "class_name": "XStream2",
    "subclass_name": null,
    "function_name": "init()",
    "function_body": "{\n        \n        addImmutableType(Result.class);\n\n        registerConverter(new RobustCollectionConverter(getMapper(),getReflectionProvider()),10);\n        registerConverter(new RobustMapConverter(getMapper()), 10);\n        registerConverter(new ImmutableMapConverter(getMapper(),getReflectionProvider()),10);\n        registerConverter(new ImmutableSortedSetConverter(getMapper(),getReflectionProvider()),10);\n        registerConverter(new ImmutableSetConverter(getMapper(),getReflectionProvider()),10);\n        registerConverter(new ImmutableListConverter(getMapper(),getReflectionProvider()),10);\n        registerConverter(new ConcurrentHashMapConverter(getMapper(),getReflectionProvider()),10);\n        registerConverter(new CopyOnWriteMap.Tree.ConverterImpl(getMapper()),10); \n        registerConverter(new DescribableList.ConverterImpl(getMapper()),10); \n        registerConverter(new Label.ConverterImpl(),10);\n\n        \n        \n        registerConverter(new AssociatedConverterImpl(this), -10);\n\n        registerConverter(new BlacklistedTypesConverter(), PRIORITY_VERY_HIGH); \n\n        registerConverter(new DynamicProxyConverter(getMapper()) { \n            @Override public boolean canConvert(Class type) {\n                return  type != null && super.canConvert(type);\n            }\n            @Override public Object unmarshal(HierarchicalStreamReader reader, UnmarshallingContext context) {\n                throw new ConversionException(\"<dynamic-proxy> not supported\");\n            }\n        }, PRIORITY_VERY_HIGH);\n    }"
  },
  {
    "id": 51,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 5,
    "human_patch": "https://github.com/jenkinsci/jenkins/commit/701ea95a52afe53bee28f76a3f96eb0e578852e9",
    "cve_id": "CVE-2017-1000355",
    "cwe_id": "CWE-502",
    "filename": "core/src/main/java/hudson/util/XStream2.java",
    "is_vulnerable": 0,
    "class_name": "XStream2",
    "subclass_name": null,
    "function_name": "canConvert(Class type)",
    "function_body": "{\n                return  type != null && super.canConvert(type);\n            }"
  },
  {
    "id": 51,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 6,
    "human_patch": "https://github.com/jenkinsci/jenkins/commit/701ea95a52afe53bee28f76a3f96eb0e578852e9",
    "cve_id": "CVE-2017-1000355",
    "cwe_id": "CWE-502",
    "filename": "core/src/main/java/hudson/util/XStream2.java",
    "is_vulnerable": 0,
    "class_name": "XStream2",
    "subclass_name": null,
    "function_name": "unmarshal(HierarchicalStreamReader reader, UnmarshallingContext context)",
    "function_body": "{\n                throw new ConversionException(\"<dynamic-proxy> not supported\");\n            }"
  },
  {
    "id": 51,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 7,
    "human_patch": "https://github.com/jenkinsci/jenkins/commit/701ea95a52afe53bee28f76a3f96eb0e578852e9",
    "cve_id": "CVE-2017-1000355",
    "cwe_id": "CWE-502",
    "filename": "core/src/main/java/hudson/util/XStream2.java",
    "is_vulnerable": 0,
    "class_name": "XStream2",
    "subclass_name": null,
    "function_name": "wrapMapper(MapperWrapper next)",
    "function_body": "{\n        Mapper m = new CompatibilityMapper(new MapperWrapper(next) {\n            @Override\n            public String serializedClass(Class type) {\n                if (type != null && ImmutableMap.class.isAssignableFrom(type))\n                    return super.serializedClass(ImmutableMap.class);\n                else if (type != null && ImmutableList.class.isAssignableFrom(type))\n                    return super.serializedClass(ImmutableList.class);\n                else\n                    return super.serializedClass(type);\n            }\n        });\n        AnnotationMapper a = new AnnotationMapper(m, getConverterRegistry(), getConverterLookup(), getClassLoader(), getReflectionProvider(), getJvm());\n        \n        a.autodetectAnnotations(true);\n\n        mapperInjectionPoint = new MapperInjectionPoint(a);\n\n        return mapperInjectionPoint;\n    }"
  },
  {
    "id": 51,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 8,
    "human_patch": "https://github.com/jenkinsci/jenkins/commit/701ea95a52afe53bee28f76a3f96eb0e578852e9",
    "cve_id": "CVE-2017-1000355",
    "cwe_id": "CWE-502",
    "filename": "core/src/main/java/hudson/util/XStream2.java",
    "is_vulnerable": 0,
    "class_name": "XStream2",
    "subclass_name": null,
    "function_name": "serializedClass(Class type)",
    "function_body": "{\n                if (type != null && ImmutableMap.class.isAssignableFrom(type))\n                    return super.serializedClass(ImmutableMap.class);\n                else if (type != null && ImmutableList.class.isAssignableFrom(type))\n                    return super.serializedClass(ImmutableList.class);\n                else\n                    return super.serializedClass(type);\n            }"
  },
  {
    "id": 51,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 9,
    "human_patch": "https://github.com/jenkinsci/jenkins/commit/701ea95a52afe53bee28f76a3f96eb0e578852e9",
    "cve_id": "CVE-2017-1000355",
    "cwe_id": "CWE-502",
    "filename": "core/src/main/java/hudson/util/XStream2.java",
    "is_vulnerable": 0,
    "class_name": "XStream2",
    "subclass_name": null,
    "function_name": "getMapperInjectionPoint()",
    "function_body": "{\n        return mapperInjectionPoint.getDelegate();\n    }"
  },
  {
    "id": 51,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 10,
    "human_patch": "https://github.com/jenkinsci/jenkins/commit/701ea95a52afe53bee28f76a3f96eb0e578852e9",
    "cve_id": "CVE-2017-1000355",
    "cwe_id": "CWE-502",
    "filename": "core/src/main/java/hudson/util/XStream2.java",
    "is_vulnerable": 0,
    "class_name": "XStream2",
    "subclass_name": null,
    "function_name": "toXML(Object obj, OutputStream out)",
    "function_body": "{\n        super.toXML(obj, out);\n    }"
  },
  {
    "id": 51,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 11,
    "human_patch": "https://github.com/jenkinsci/jenkins/commit/701ea95a52afe53bee28f76a3f96eb0e578852e9",
    "cve_id": "CVE-2017-1000355",
    "cwe_id": "CWE-502",
    "filename": "core/src/main/java/hudson/util/XStream2.java",
    "is_vulnerable": 0,
    "class_name": "XStream2",
    "subclass_name": null,
    "function_name": "toXMLUTF8(Object obj, OutputStream out) throws IOException",
    "function_body": "{\n        Writer w = new OutputStreamWriter(out, Charset.forName(\"UTF-8\"));\n        w.write(\"<?xml version=\\\"1.0\\\" encoding=\\\"UTF-8\\\"?>\\n\");\n        toXML(obj, w);\n    }"
  },
  {
    "id": 51,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 12,
    "human_patch": "https://github.com/jenkinsci/jenkins/commit/701ea95a52afe53bee28f76a3f96eb0e578852e9",
    "cve_id": "CVE-2017-1000355",
    "cwe_id": "CWE-502",
    "filename": "core/src/main/java/hudson/util/XStream2.java",
    "is_vulnerable": 0,
    "class_name": "XStream2",
    "subclass_name": null,
    "function_name": "setMapper(Mapper m)",
    "function_body": "{\n        mapperInjectionPoint.setDelegate(m);\n    }"
  },
  {
    "id": 51,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 13,
    "human_patch": "https://github.com/jenkinsci/jenkins/commit/701ea95a52afe53bee28f76a3f96eb0e578852e9",
    "cve_id": "CVE-2017-1000355",
    "cwe_id": "CWE-502",
    "filename": "core/src/main/java/hudson/util/XStream2.java",
    "is_vulnerable": 0,
    "class_name": "XStream2",
    "subclass_name": "MapperInjectionPoint",
    "function_name": "getDelegate()",
    "function_body": "{\n            return delegate;\n        }"
  },
  {
    "id": 51,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 14,
    "human_patch": "https://github.com/jenkinsci/jenkins/commit/701ea95a52afe53bee28f76a3f96eb0e578852e9",
    "cve_id": "CVE-2017-1000355",
    "cwe_id": "CWE-502",
    "filename": "core/src/main/java/hudson/util/XStream2.java",
    "is_vulnerable": 0,
    "class_name": "XStream2",
    "subclass_name": "MapperInjectionPoint",
    "function_name": "setDelegate(Mapper m)",
    "function_body": "{\n            delegate = m;\n        }"
  },
  {
    "id": 51,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 15,
    "human_patch": "https://github.com/jenkinsci/jenkins/commit/701ea95a52afe53bee28f76a3f96eb0e578852e9",
    "cve_id": "CVE-2017-1000355",
    "cwe_id": "CWE-502",
    "filename": "core/src/main/java/hudson/util/XStream2.java",
    "is_vulnerable": 0,
    "class_name": "XStream2",
    "subclass_name": null,
    "function_name": "addCompatibilityAlias(String oldClassName, Class newClass)",
    "function_body": "{\n        compatibilityAliases.put(oldClassName,newClass);\n    }"
  },
  {
    "id": 51,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 16,
    "human_patch": "https://github.com/jenkinsci/jenkins/commit/701ea95a52afe53bee28f76a3f96eb0e578852e9",
    "cve_id": "CVE-2017-1000355",
    "cwe_id": "CWE-502",
    "filename": "core/src/main/java/hudson/util/XStream2.java",
    "is_vulnerable": 0,
    "class_name": "XStream2",
    "subclass_name": "CompatibilityMapper",
    "function_name": "realClass(String elementName)",
    "function_body": "{\n            Class s = compatibilityAliases.get(elementName);\n            if (s!=null)    return s;\n\n            try {\n                return super.realClass(elementName);\n            } catch (CannotResolveClassException e) {\n                \n                if (elementName.indexOf('-') >= 0) try {\n                    Class c = super.realClass(elementName.replace('-', '$'));\n                    oldData.set(Boolean.TRUE);\n                    return c;\n                } catch (CannotResolveClassException e2) { }\n                \n                throw e;\n            }\n        }"
  },
  {
    "id": 51,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 17,
    "human_patch": "https://github.com/jenkinsci/jenkins/commit/701ea95a52afe53bee28f76a3f96eb0e578852e9",
    "cve_id": "CVE-2017-1000355",
    "cwe_id": "CWE-502",
    "filename": "core/src/main/java/hudson/util/XStream2.java",
    "is_vulnerable": 0,
    "class_name": "XStream2",
    "subclass_name": "AssociatedConverterImpl",
    "function_name": "findConverter(Class<?> t)",
    "function_body": "{\n            Converter result = cache.get(t);\n            if (result != null)\n                \n                return result == this ? null : result;\n            try {\n                if(t==null || t.getClassLoader()==null)\n                    return null;\n                Class<?> cl = t.getClassLoader().loadClass(t.getName() + \"$ConverterImpl\");\n                Constructor<?> c = cl.getConstructors()[0];\n\n                Class<?>[] p = c.getParameterTypes();\n                Object[] args = new Object[p.length];\n                for (int i = 0; i < p.length; i++) {\n                    if(p[i]==XStream.class || p[i]==XStream2.class)\n                        args[i] = xstream;\n                    else if(p[i]== Mapper.class)\n                        args[i] = xstream.getMapper();\n                    else\n                        throw new InstantiationError(\"Unrecognized constructor parameter: \"+p[i]);\n\n                }\n                ConverterMatcher cm = (ConverterMatcher)c.newInstance(args);\n                result = cm instanceof SingleValueConverter\n                        ? new SingleValueConverterWrapper((SingleValueConverter)cm)\n                        : (Converter)cm;\n                cache.put(t, result);\n                return result;\n            } catch (ClassNotFoundException e) {\n                cache.put(t, this);  \n                return null;\n            } catch (IllegalAccessException e) {\n                IllegalAccessError x = new IllegalAccessError();\n                x.initCause(e);\n                throw x;\n            } catch (InstantiationException e) {\n                InstantiationError x = new InstantiationError();\n                x.initCause(e);\n                throw x;\n            } catch (InvocationTargetException e) {\n                InstantiationError x = new InstantiationError();\n                x.initCause(e);\n                throw x;\n            }\n        }"
  },
  {
    "id": 51,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 18,
    "human_patch": "https://github.com/jenkinsci/jenkins/commit/701ea95a52afe53bee28f76a3f96eb0e578852e9",
    "cve_id": "CVE-2017-1000355",
    "cwe_id": "CWE-502",
    "filename": "core/src/main/java/hudson/util/XStream2.java",
    "is_vulnerable": 0,
    "class_name": "XStream2",
    "subclass_name": "AssociatedConverterImpl",
    "function_name": "canConvert(Class type)",
    "function_body": "{\n            return findConverter(type)!=null;\n        }"
  },
  {
    "id": 51,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 19,
    "human_patch": "https://github.com/jenkinsci/jenkins/commit/701ea95a52afe53bee28f76a3f96eb0e578852e9",
    "cve_id": "CVE-2017-1000355",
    "cwe_id": "CWE-502",
    "filename": "core/src/main/java/hudson/util/XStream2.java",
    "is_vulnerable": 0,
    "class_name": "XStream2",
    "subclass_name": "AssociatedConverterImpl",
    "function_name": "marshal(Object source, HierarchicalStreamWriter writer, MarshallingContext context)",
    "function_body": "{\n            findConverter(source.getClass()).marshal(source,writer,context);\n        }"
  },
  {
    "id": 51,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 20,
    "human_patch": "https://github.com/jenkinsci/jenkins/commit/701ea95a52afe53bee28f76a3f96eb0e578852e9",
    "cve_id": "CVE-2017-1000355",
    "cwe_id": "CWE-502",
    "filename": "core/src/main/java/hudson/util/XStream2.java",
    "is_vulnerable": 0,
    "class_name": "XStream2",
    "subclass_name": "AssociatedConverterImpl",
    "function_name": "unmarshal(HierarchicalStreamReader reader, UnmarshallingContext context)",
    "function_body": "{\n            return findConverter(context.getRequiredType()).unmarshal(reader,context);\n        }"
  },
  {
    "id": 51,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 21,
    "human_patch": "https://github.com/jenkinsci/jenkins/commit/701ea95a52afe53bee28f76a3f96eb0e578852e9",
    "cve_id": "CVE-2017-1000355",
    "cwe_id": "CWE-502",
    "filename": "core/src/main/java/hudson/util/XStream2.java",
    "is_vulnerable": 0,
    "class_name": "XStream2",
    "subclass_name": "PassthruConverter",
    "function_name": "canConvert(Class type)",
    "function_body": "{\n            \n            return false;\n        }"
  },
  {
    "id": 51,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 22,
    "human_patch": "https://github.com/jenkinsci/jenkins/commit/701ea95a52afe53bee28f76a3f96eb0e578852e9",
    "cve_id": "CVE-2017-1000355",
    "cwe_id": "CWE-502",
    "filename": "core/src/main/java/hudson/util/XStream2.java",
    "is_vulnerable": 0,
    "class_name": "XStream2",
    "subclass_name": "PassthruConverter",
    "function_name": "marshal(Object source, HierarchicalStreamWriter writer, MarshallingContext context)",
    "function_body": "{\n            converter.marshal(source, writer, context);\n        }"
  },
  {
    "id": 51,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 23,
    "human_patch": "https://github.com/jenkinsci/jenkins/commit/701ea95a52afe53bee28f76a3f96eb0e578852e9",
    "cve_id": "CVE-2017-1000355",
    "cwe_id": "CWE-502",
    "filename": "core/src/main/java/hudson/util/XStream2.java",
    "is_vulnerable": 0,
    "class_name": "XStream2",
    "subclass_name": "PassthruConverter",
    "function_name": "unmarshal(HierarchicalStreamReader reader, UnmarshallingContext context)",
    "function_body": "{\n            Object obj = converter.unmarshal(reader, context);\n            callback((T)obj, context);\n            return obj;\n        }"
  },
  {
    "id": 51,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 24,
    "human_patch": "https://github.com/jenkinsci/jenkins/commit/701ea95a52afe53bee28f76a3f96eb0e578852e9",
    "cve_id": "CVE-2017-1000355",
    "cwe_id": "CWE-502",
    "filename": "core/src/main/java/hudson/util/XStream2.java",
    "is_vulnerable": 0,
    "class_name": "XStream2",
    "subclass_name": "PassthruConverter",
    "function_name": "callback(T obj, UnmarshallingContext context)",
    "function_body": null
  },
  {
    "id": 51,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 25,
    "human_patch": "https://github.com/jenkinsci/jenkins/commit/701ea95a52afe53bee28f76a3f96eb0e578852e9",
    "cve_id": "CVE-2017-1000355",
    "cwe_id": "CWE-502",
    "filename": "core/src/main/java/hudson/util/XStream2.java",
    "is_vulnerable": 0,
    "class_name": "XStream2",
    "subclass_name": "ClassOwnership",
    "function_name": "ownerOf(Class<?> clazz)",
    "function_body": null
  },
  {
    "id": 51,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 26,
    "human_patch": "https://github.com/jenkinsci/jenkins/commit/701ea95a52afe53bee28f76a3f96eb0e578852e9",
    "cve_id": "CVE-2017-1000355",
    "cwe_id": "CWE-502",
    "filename": "core/src/main/java/hudson/util/XStream2.java",
    "is_vulnerable": 0,
    "class_name": "XStream2",
    "subclass_name": "PluginClassOwnership",
    "function_name": "ownerOf(Class<?> clazz)",
    "function_body": "{\n            if (classOwnership != null) {\n                return classOwnership.ownerOf(clazz);\n            }\n            if (pm == null) {\n                Jenkins j = Jenkins.getInstance();\n                if (j != null) {\n                    pm = j.getPluginManager();\n                }\n            }\n            if (pm == null) {\n                return null;\n            }\n            \n            PluginWrapper p = pm.whichPlugin(clazz);\n            return p != null ? p.getShortName() + '@' + trimVersion(p.getVersion()) : null;\n        }"
  },
  {
    "id": 51,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 27,
    "human_patch": "https://github.com/jenkinsci/jenkins/commit/701ea95a52afe53bee28f76a3f96eb0e578852e9",
    "cve_id": "CVE-2017-1000355",
    "cwe_id": "CWE-502",
    "filename": "core/src/main/java/hudson/util/XStream2.java",
    "is_vulnerable": 0,
    "class_name": "XStream2",
    "subclass_name": "BlacklistedTypesConverter",
    "function_name": "marshal(Object source, HierarchicalStreamWriter writer, MarshallingContext context)",
    "function_body": "{\n            throw new UnsupportedOperationException(\"Refusing to marshal \" + source.getClass().getName() + \" for security reasons\");\n        }"
  },
  {
    "id": 51,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 28,
    "human_patch": "https://github.com/jenkinsci/jenkins/commit/701ea95a52afe53bee28f76a3f96eb0e578852e9",
    "cve_id": "CVE-2017-1000355",
    "cwe_id": "CWE-502",
    "filename": "core/src/main/java/hudson/util/XStream2.java",
    "is_vulnerable": 0,
    "class_name": "XStream2",
    "subclass_name": "BlacklistedTypesConverter",
    "function_name": "unmarshal(HierarchicalStreamReader reader, UnmarshallingContext context)",
    "function_body": "{\n            throw new ConversionException(\"Refusing to unmarshal \" + reader.getNodeName() + \" for security reasons\");\n        }"
  },
  {
    "id": 51,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 29,
    "human_patch": "https://github.com/jenkinsci/jenkins/commit/701ea95a52afe53bee28f76a3f96eb0e578852e9",
    "cve_id": "CVE-2017-1000355",
    "cwe_id": "CWE-502",
    "filename": "core/src/main/java/hudson/util/XStream2.java",
    "is_vulnerable": 0,
    "class_name": "XStream2",
    "subclass_name": "BlacklistedTypesConverter",
    "function_name": "canConvert(Class type)",
    "function_body": "{\n            if (type == null) {\n                return false;\n            }\n            try {\n                ClassFilter.DEFAULT.check(type);\n                ClassFilter.DEFAULT.check(type.getName());\n            } catch (SecurityException se) {\n                \n                return true;\n            }\n            return false;\n        }"
  },
  {
    "id": 51,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 0,
    "human_patch": "https://github.com/jenkinsci/jenkins/commit/701ea95a52afe53bee28f76a3f96eb0e578852e9",
    "cve_id": "CVE-2017-1000355",
    "cwe_id": "CWE-502",
    "filename": "core/src/test/java/hudson/util/XStream2Test.java",
    "is_vulnerable": 0,
    "class_name": "XStream2Test",
    "subclass_name": null,
    "function_name": "marshalValue()",
    "function_body": "{\n        Foo f = new Foo();\n        f.r1 = f.r2 = Result.FAILURE;\n        String xml = Run.XSTREAM.toXML(f);\n        \n        assertEquals(xml, 3, xml.split(\"FAILURE\").length);\n    }"
  },
  {
    "id": 51,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 1,
    "human_patch": "https://github.com/jenkinsci/jenkins/commit/701ea95a52afe53bee28f76a3f96eb0e578852e9",
    "cve_id": "CVE-2017-1000355",
    "cwe_id": "CWE-502",
    "filename": "core/src/test/java/hudson/util/XStream2Test.java",
    "is_vulnerable": 0,
    "class_name": "XStream2Test",
    "subclass_name": null,
    "function_name": "xStream11Compatibility()",
    "function_body": "{\n        Bar b = (Bar)new XStream2().fromXML(\n                \"<hudson.util.XStream2Test-Bar><s>foo</s></hudson.util.XStream2Test-Bar>\");\n        assertEquals(\"foo\", b.s);\n    }"
  },
  {
    "id": 51,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 2,
    "human_patch": "https://github.com/jenkinsci/jenkins/commit/701ea95a52afe53bee28f76a3f96eb0e578852e9",
    "cve_id": "CVE-2017-1000355",
    "cwe_id": "CWE-502",
    "filename": "core/src/test/java/hudson/util/XStream2Test.java",
    "is_vulnerable": 0,
    "class_name": "XStream2Test",
    "subclass_name": null,
    "function_name": "xmlRoundTrip()",
    "function_body": "{\n        XStream2 xs = new XStream2();\n        __Foo_Bar$Class b = new __Foo_Bar$Class();\n\n        String xml = xs.toXML(b);\n        __Foo_Bar$Class b2 = (__Foo_Bar$Class)xs.fromXML(xml);\n\n        assertEquals(xml, b.under_1, b2.under_1);\n        assertEquals(xml, b.under__2, b2.under__2);\n        assertEquals(xml, b._leadUnder1, b2._leadUnder1);\n        assertEquals(xml, b.__leadUnder2, b2.__leadUnder2);\n        assertEquals(xml, b.$dollar, b2.$dollar);\n        assertEquals(xml, b.dollar$2, b2.dollar$2);\n    }"
  },
  {
    "id": 51,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 3,
    "human_patch": "https://github.com/jenkinsci/jenkins/commit/701ea95a52afe53bee28f76a3f96eb0e578852e9",
    "cve_id": "CVE-2017-1000355",
    "cwe_id": "CWE-502",
    "filename": "core/src/test/java/hudson/util/XStream2Test.java",
    "is_vulnerable": 0,
    "class_name": "XStream2Test",
    "subclass_name": null,
    "function_name": "unmarshalThrowableMissingField()",
    "function_body": "{\n        Level oldLevel = disableLogging();\n\n        Baz baz = new Baz();\n        baz.myFailure = new Exception(\"foo\");\n\n        XStream2 xs = new XStream2();\n        String xml = xs.toXML(baz);\n        baz = (Baz)xs.fromXML(xml);\n        assertEquals(\"foo\", baz.myFailure.getMessage());\n\n        baz = (Baz)xs.fromXML(\"<hudson.util.XStream2Test_-Baz><myFailure>\"\n                + \"<missingField>true</missingField>\"\n                + \"<detailMessage>hoho</detailMessage>\"\n                + \"<stackTrace><trace>\"\n                + \"hudson.util.XStream2Test.testUnmarshalThrowableMissingField(XStream2Test.java:97)\"\n                + \"</trace></stackTrace>\"\n                + \"</myFailure></hudson.util.XStream2Test_-Baz>\");\n        \n        assertEquals(\"hoho\", baz.myFailure.getMessage());\n\n        enableLogging(oldLevel);\n    }"
  },
  {
    "id": 51,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 4,
    "human_patch": "https://github.com/jenkinsci/jenkins/commit/701ea95a52afe53bee28f76a3f96eb0e578852e9",
    "cve_id": "CVE-2017-1000355",
    "cwe_id": "CWE-502",
    "filename": "core/src/test/java/hudson/util/XStream2Test.java",
    "is_vulnerable": 0,
    "class_name": "XStream2Test",
    "subclass_name": null,
    "function_name": "disableLogging()",
    "function_body": "{\n        Level oldLevel = Logger.getLogger(RobustReflectionConverter.class.getName()).getLevel();\n        Logger.getLogger(RobustReflectionConverter.class.getName()).setLevel(Level.OFF);\n        return oldLevel;\n    }"
  },
  {
    "id": 51,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 5,
    "human_patch": "https://github.com/jenkinsci/jenkins/commit/701ea95a52afe53bee28f76a3f96eb0e578852e9",
    "cve_id": "CVE-2017-1000355",
    "cwe_id": "CWE-502",
    "filename": "core/src/test/java/hudson/util/XStream2Test.java",
    "is_vulnerable": 0,
    "class_name": "XStream2Test",
    "subclass_name": null,
    "function_name": "enableLogging(Level oldLevel)",
    "function_body": "{\n        Logger.getLogger(RobustReflectionConverter.class.getName()).setLevel(oldLevel);\n    }"
  },
  {
    "id": 51,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 6,
    "human_patch": "https://github.com/jenkinsci/jenkins/commit/701ea95a52afe53bee28f76a3f96eb0e578852e9",
    "cve_id": "CVE-2017-1000355",
    "cwe_id": "CWE-502",
    "filename": "core/src/test/java/hudson/util/XStream2Test.java",
    "is_vulnerable": 0,
    "class_name": "XStream2Test",
    "subclass_name": null,
    "function_name": "immutableMap()",
    "function_body": "{\n        XStream2 xs = new XStream2();\n\n        roundtripImmutableMap(xs, ImmutableMap.of());\n        roundtripImmutableMap(xs, ImmutableMap.of(\"abc\", \"xyz\"));\n        roundtripImmutableMap(xs, ImmutableMap.of(\"abc\", \"xyz\", \"def\",\"ghi\"));\n\n        roundtripImmutableMapAsPlainMap(xs, ImmutableMap.of());\n        roundtripImmutableMapAsPlainMap(xs, ImmutableMap.of(\"abc\", \"xyz\"));\n        roundtripImmutableMapAsPlainMap(xs, ImmutableMap.of(\"abc\", \"xyz\", \"def\",\"ghi\"));\n    }"
  },
  {
    "id": 51,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 7,
    "human_patch": "https://github.com/jenkinsci/jenkins/commit/701ea95a52afe53bee28f76a3f96eb0e578852e9",
    "cve_id": "CVE-2017-1000355",
    "cwe_id": "CWE-502",
    "filename": "core/src/test/java/hudson/util/XStream2Test.java",
    "is_vulnerable": 0,
    "class_name": "XStream2Test",
    "subclass_name": null,
    "function_name": "roundtripImmutableMap(XStream2 xs, ImmutableMap<?,?> m)",
    "function_body": "{\n        ImmutableMapHolder a = new ImmutableMapHolder();\n        a.m = m;\n        String xml = xs.toXML(a);\n        \n        assertFalse(\"shouldn't contain the class name\",xml.contains(\"google\"));\n        assertFalse(\"shouldn't contain the class name\",xml.contains(\"class\"));\n        a = (ImmutableMapHolder)xs.fromXML(xml);\n\n        assertSame(m.getClass(),a.m.getClass());    \n        assertEquals(m,a.m);\n    }"
  },
  {
    "id": 51,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 8,
    "human_patch": "https://github.com/jenkinsci/jenkins/commit/701ea95a52afe53bee28f76a3f96eb0e578852e9",
    "cve_id": "CVE-2017-1000355",
    "cwe_id": "CWE-502",
    "filename": "core/src/test/java/hudson/util/XStream2Test.java",
    "is_vulnerable": 0,
    "class_name": "XStream2Test",
    "subclass_name": null,
    "function_name": "roundtripImmutableMapAsPlainMap(XStream2 xs, ImmutableMap<?,?> m)",
    "function_body": "{\n        MapHolder a = new MapHolder();\n        a.m = m;\n        String xml = xs.toXML(a);\n        \n        assertTrue(\"XML should mention the class name\",xml.contains('\\\"'+ImmutableMap.class.getName()+'\\\"'));\n        a = (MapHolder)xs.fromXML(xml);\n\n        assertSame(m.getClass(),a.m.getClass());    \n        assertEquals(m,a.m);\n    }"
  },
  {
    "id": 51,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 9,
    "human_patch": "https://github.com/jenkinsci/jenkins/commit/701ea95a52afe53bee28f76a3f96eb0e578852e9",
    "cve_id": "CVE-2017-1000355",
    "cwe_id": "CWE-502",
    "filename": "core/src/test/java/hudson/util/XStream2Test.java",
    "is_vulnerable": 0,
    "class_name": "XStream2Test",
    "subclass_name": null,
    "function_name": "immutableList()",
    "function_body": "{\n        XStream2 xs = new XStream2();\n\n        roundtripImmutableList(xs, ImmutableList.of());\n        roundtripImmutableList(xs, ImmutableList.of(\"abc\"));\n        roundtripImmutableList(xs, ImmutableList.of(\"abc\", \"def\"));\n\n        roundtripImmutableListAsPlainList(xs, ImmutableList.of());\n        roundtripImmutableListAsPlainList(xs, ImmutableList.of(\"abc\"));\n        roundtripImmutableListAsPlainList(xs, ImmutableList.of(\"abc\", \"def\"));\n    }"
  },
  {
    "id": 51,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 10,
    "human_patch": "https://github.com/jenkinsci/jenkins/commit/701ea95a52afe53bee28f76a3f96eb0e578852e9",
    "cve_id": "CVE-2017-1000355",
    "cwe_id": "CWE-502",
    "filename": "core/src/test/java/hudson/util/XStream2Test.java",
    "is_vulnerable": 0,
    "class_name": "XStream2Test",
    "subclass_name": null,
    "function_name": "roundtripImmutableList(XStream2 xs, ImmutableList<?> l)",
    "function_body": "{\n        ImmutableListHolder a = new ImmutableListHolder();\n        a.l = l;\n        String xml = xs.toXML(a);\n        \n        assertFalse(\"shouldn't contain the class name\",xml.contains(\"google\"));\n        assertFalse(\"shouldn't contain the class name\",xml.contains(\"class\"));\n        a = (ImmutableListHolder)xs.fromXML(xml);\n\n        assertSame(l.getClass(),a.l.getClass());    \n        assertEquals(l,a.l);\n    }"
  },
  {
    "id": 51,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 11,
    "human_patch": "https://github.com/jenkinsci/jenkins/commit/701ea95a52afe53bee28f76a3f96eb0e578852e9",
    "cve_id": "CVE-2017-1000355",
    "cwe_id": "CWE-502",
    "filename": "core/src/test/java/hudson/util/XStream2Test.java",
    "is_vulnerable": 0,
    "class_name": "XStream2Test",
    "subclass_name": null,
    "function_name": "roundtripImmutableListAsPlainList(XStream2 xs, ImmutableList<?> l)",
    "function_body": "{\n        ListHolder a = new ListHolder();\n        a.l = l;\n        String xml = xs.toXML(a);\n        \n        assertTrue(\"XML should mention the class name\",xml.contains('\\\"'+ImmutableList.class.getName()+'\\\"'));\n        a = (ListHolder)xs.fromXML(xml);\n\n        assertSame(l.getClass(),a.l.getClass());    \n        assertEquals(l,a.l);\n    }"
  },
  {
    "id": 51,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 12,
    "human_patch": "https://github.com/jenkinsci/jenkins/commit/701ea95a52afe53bee28f76a3f96eb0e578852e9",
    "cve_id": "CVE-2017-1000355",
    "cwe_id": "CWE-502",
    "filename": "core/src/test/java/hudson/util/XStream2Test.java",
    "is_vulnerable": 0,
    "class_name": "XStream2Test",
    "subclass_name": null,
    "function_name": "emptyStack()",
    "function_body": "{\n        assertEquals(\"<object-array><null/><null/></object-array>\",\n                     Run.XSTREAM.toXML(new Object[2]).replaceAll(\"[ \\n\\r\\t]+\", \"\"));\n    }"
  },
  {
    "id": 51,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 13,
    "human_patch": "https://github.com/jenkinsci/jenkins/commit/701ea95a52afe53bee28f76a3f96eb0e578852e9",
    "cve_id": "CVE-2017-1000355",
    "cwe_id": "CWE-502",
    "filename": "core/src/test/java/hudson/util/XStream2Test.java",
    "is_vulnerable": 0,
    "class_name": "XStream2Test",
    "subclass_name": null,
    "function_name": "compatibilityAlias()",
    "function_body": "{\n        XStream2 xs = new XStream2();\n        xs.addCompatibilityAlias(\"legacy.Point\",Point.class);\n        Point pt = (Point)xs.fromXML(\"<legacy.Point><x>1</x><y>2</y></legacy.Point>\");\n        assertEquals(1,pt.x);\n        assertEquals(2,pt.y);\n        String xml = xs.toXML(pt);\n        \n        assertFalse(\"Shouldn't use the alias when writing back\",xml.contains(\"legacy\"));\n    }"
  },
  {
    "id": 51,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 14,
    "human_patch": "https://github.com/jenkinsci/jenkins/commit/701ea95a52afe53bee28f76a3f96eb0e578852e9",
    "cve_id": "CVE-2017-1000355",
    "cwe_id": "CWE-502",
    "filename": "core/src/test/java/hudson/util/XStream2Test.java",
    "is_vulnerable": 0,
    "class_name": "XStream2Test",
    "subclass_name": null,
    "function_name": "dynamicProxyBlocked()",
    "function_body": "{\n        try {\n            ((Runnable) new XStream2().fromXML(\"<dynamic-proxy><interface>java.lang.Runnable</interface><handler class='java.beans.EventHandler'><target class='\" + Hacked.class.getName() + \"'/><action>oops</action></handler></dynamic-proxy>\")).run();\n        } catch (XStreamException x) {\n            \n        }\n        assertFalse(\"should never have run that\", Hacked.tripped);\n    }"
  },
  {
    "id": 51,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 15,
    "human_patch": "https://github.com/jenkinsci/jenkins/commit/701ea95a52afe53bee28f76a3f96eb0e578852e9",
    "cve_id": "CVE-2017-1000355",
    "cwe_id": "CWE-502",
    "filename": "core/src/test/java/hudson/util/XStream2Test.java",
    "is_vulnerable": 0,
    "class_name": "XStream2Test",
    "subclass_name": "Hacked",
    "function_name": "oops()",
    "function_body": "{\n            tripped = true;\n        }"
  },
  {
    "id": 51,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 16,
    "human_patch": "https://github.com/jenkinsci/jenkins/commit/701ea95a52afe53bee28f76a3f96eb0e578852e9",
    "cve_id": "CVE-2017-1000355",
    "cwe_id": "CWE-502",
    "filename": "core/src/test/java/hudson/util/XStream2Test.java",
    "is_vulnerable": 0,
    "class_name": "XStream2Test",
    "subclass_name": null,
    "function_name": "trimVersion()",
    "function_body": "{\n        assertEquals(\"3.2\", XStream2.trimVersion(\"3.2\"));\n        assertEquals(\"3.2.1\", XStream2.trimVersion(\"3.2.1\"));\n        assertEquals(\"3.2-SNAPSHOT\", XStream2.trimVersion(\"3.2-SNAPSHOT (private-09/23/2012 12:26-jhacker)\"));\n    }"
  },
  {
    "id": 52,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 0,
    "human_patch": "https://github.com/jenkinsci/jenkins/commit/73afa0ca786a87f05b5433e2e38f863826fcad17",
    "cve_id": "CVE-2018-1000864",
    "cwe_id": "CWE-835",
    "filename": "core/src/main/java/hudson/scheduler/CronTab.java",
    "is_vulnerable": 0,
    "class_name": "CronTab",
    "subclass_name": null,
    "function_name": "set(String format, int line, Hash hash) throws ANTLRException",
    "function_body": "{\n        set(format, line, hash, null);\n    }"
  },
  {
    "id": 52,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 1,
    "human_patch": "https://github.com/jenkinsci/jenkins/commit/73afa0ca786a87f05b5433e2e38f863826fcad17",
    "cve_id": "CVE-2018-1000864",
    "cwe_id": "CWE-835",
    "filename": "core/src/main/java/hudson/scheduler/CronTab.java",
    "is_vulnerable": 0,
    "class_name": "CronTab",
    "subclass_name": null,
    "function_name": "set(String format, int line, Hash hash, String timezone) throws ANTLRException",
    "function_body": "{\n        CrontabLexer lexer = new CrontabLexer(new StringReader(format));\n        lexer.setLine(line);\n        CrontabParser parser = new CrontabParser(lexer);\n        parser.setHash(hash);\n        spec = format;\n        specTimezone = timezone;\n\n        parser.startRule(this);\n        if((dayOfWeek&(1<<7))!=0) {\n            dayOfWeek |= 1; \n            dayOfWeek &= ~(1<<7); \n        }\n    }"
  },
  {
    "id": 52,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 2,
    "human_patch": "https://github.com/jenkinsci/jenkins/commit/73afa0ca786a87f05b5433e2e38f863826fcad17",
    "cve_id": "CVE-2018-1000864",
    "cwe_id": "CWE-835",
    "filename": "core/src/main/java/hudson/scheduler/CronTab.java",
    "is_vulnerable": 0,
    "class_name": "CronTab",
    "subclass_name": null,
    "function_name": "check(Calendar cal)",
    "function_body": "{\n\n        Calendar checkCal = cal;\n\n        if(specTimezone != null && !specTimezone.isEmpty()) {\n            Calendar tzCal = Calendar.getInstance(TimeZone.getTimeZone(specTimezone));\n            tzCal.setTime(cal.getTime());\n            checkCal = tzCal;\n        }\n\n        if(!checkBits(bits[0],checkCal.get(MINUTE)))\n            return false;\n        if(!checkBits(bits[1],checkCal.get(HOUR_OF_DAY)))\n            return false;\n        if(!checkBits(bits[2],checkCal.get(DAY_OF_MONTH)))\n            return false;\n        if(!checkBits(bits[3],checkCal.get(MONTH)+1))\n            return false;\n        if(!checkBits(dayOfWeek,checkCal.get(Calendar.DAY_OF_WEEK)-1))\n            return false;\n\n        return true;\n    }"
  },
  {
    "id": 52,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 3,
    "human_patch": "https://github.com/jenkinsci/jenkins/commit/73afa0ca786a87f05b5433e2e38f863826fcad17",
    "cve_id": "CVE-2018-1000864",
    "cwe_id": "CWE-835",
    "filename": "core/src/main/java/hudson/scheduler/CronTab.java",
    "is_vulnerable": 0,
    "class_name": "CronTab",
    "subclass_name": "CalendarField",
    "function_name": "valueOf(Calendar c)",
    "function_body": "{\n            return c.get(field)+offset;\n        }"
  },
  {
    "id": 52,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 4,
    "human_patch": "https://github.com/jenkinsci/jenkins/commit/73afa0ca786a87f05b5433e2e38f863826fcad17",
    "cve_id": "CVE-2018-1000864",
    "cwe_id": "CWE-835",
    "filename": "core/src/main/java/hudson/scheduler/CronTab.java",
    "is_vulnerable": 0,
    "class_name": "CronTab",
    "subclass_name": "CalendarField",
    "function_name": "addTo(Calendar c, int i)",
    "function_body": "{\n            c.add(field,i);\n        }"
  },
  {
    "id": 52,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 5,
    "human_patch": "https://github.com/jenkinsci/jenkins/commit/73afa0ca786a87f05b5433e2e38f863826fcad17",
    "cve_id": "CVE-2018-1000864",
    "cwe_id": "CWE-835",
    "filename": "core/src/main/java/hudson/scheduler/CronTab.java",
    "is_vulnerable": 0,
    "class_name": "CronTab",
    "subclass_name": "CalendarField",
    "function_name": "setTo(Calendar c, int i)",
    "function_body": "{\n            c.set(field,Math.min(i-offset, c.getActualMaximum(field)));\n        }"
  },
  {
    "id": 52,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 6,
    "human_patch": "https://github.com/jenkinsci/jenkins/commit/73afa0ca786a87f05b5433e2e38f863826fcad17",
    "cve_id": "CVE-2018-1000864",
    "cwe_id": "CWE-835",
    "filename": "core/src/main/java/hudson/scheduler/CronTab.java",
    "is_vulnerable": 0,
    "class_name": "CronTab",
    "subclass_name": "CalendarField",
    "function_name": "clear(Calendar c)",
    "function_body": "{\n            setTo(c, min);\n        }"
  },
  {
    "id": 52,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 7,
    "human_patch": "https://github.com/jenkinsci/jenkins/commit/73afa0ca786a87f05b5433e2e38f863826fcad17",
    "cve_id": "CVE-2018-1000864",
    "cwe_id": "CWE-835",
    "filename": "core/src/main/java/hudson/scheduler/CronTab.java",
    "is_vulnerable": 0,
    "class_name": "CronTab",
    "subclass_name": "CalendarField",
    "function_name": "ceil(CronTab c, int n)",
    "function_body": "{\n            long bits = bits(c);\n            while ((bits|(1L<<n))!=bits) {\n                if (n>60)   return -1;\n                n++;\n            }\n            return n;\n        }"
  },
  {
    "id": 52,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 8,
    "human_patch": "https://github.com/jenkinsci/jenkins/commit/73afa0ca786a87f05b5433e2e38f863826fcad17",
    "cve_id": "CVE-2018-1000864",
    "cwe_id": "CWE-835",
    "filename": "core/src/main/java/hudson/scheduler/CronTab.java",
    "is_vulnerable": 0,
    "class_name": "CronTab",
    "subclass_name": "CalendarField",
    "function_name": "first(CronTab c)",
    "function_body": "{\n            return ceil(c,0);\n        }"
  },
  {
    "id": 52,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 9,
    "human_patch": "https://github.com/jenkinsci/jenkins/commit/73afa0ca786a87f05b5433e2e38f863826fcad17",
    "cve_id": "CVE-2018-1000864",
    "cwe_id": "CWE-835",
    "filename": "core/src/main/java/hudson/scheduler/CronTab.java",
    "is_vulnerable": 0,
    "class_name": "CronTab",
    "subclass_name": "CalendarField",
    "function_name": "floor(CronTab c, int n)",
    "function_body": "{\n            long bits = bits(c);\n            while ((bits|(1L<<n))!=bits) {\n                if (n==0)   return -1;\n                n--;\n            }\n            return n;\n        }"
  },
  {
    "id": 52,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 10,
    "human_patch": "https://github.com/jenkinsci/jenkins/commit/73afa0ca786a87f05b5433e2e38f863826fcad17",
    "cve_id": "CVE-2018-1000864",
    "cwe_id": "CWE-835",
    "filename": "core/src/main/java/hudson/scheduler/CronTab.java",
    "is_vulnerable": 0,
    "class_name": "CronTab",
    "subclass_name": "CalendarField",
    "function_name": "last(CronTab c)",
    "function_body": "{\n            return floor(c,63);\n        }"
  },
  {
    "id": 52,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 11,
    "human_patch": "https://github.com/jenkinsci/jenkins/commit/73afa0ca786a87f05b5433e2e38f863826fcad17",
    "cve_id": "CVE-2018-1000864",
    "cwe_id": "CWE-835",
    "filename": "core/src/main/java/hudson/scheduler/CronTab.java",
    "is_vulnerable": 0,
    "class_name": "CronTab",
    "subclass_name": "CalendarField",
    "function_name": "bits(CronTab c)",
    "function_body": null
  },
  {
    "id": 52,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 12,
    "human_patch": "https://github.com/jenkinsci/jenkins/commit/73afa0ca786a87f05b5433e2e38f863826fcad17",
    "cve_id": "CVE-2018-1000864",
    "cwe_id": "CWE-835",
    "filename": "core/src/main/java/hudson/scheduler/CronTab.java",
    "is_vulnerable": 0,
    "class_name": "CronTab",
    "subclass_name": "CalendarField",
    "function_name": "rollUp(Calendar cal, int i)",
    "function_body": null
  },
  {
    "id": 52,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 13,
    "human_patch": "https://github.com/jenkinsci/jenkins/commit/73afa0ca786a87f05b5433e2e38f863826fcad17",
    "cve_id": "CVE-2018-1000864",
    "cwe_id": "CWE-835",
    "filename": "core/src/main/java/hudson/scheduler/CronTab.java",
    "is_vulnerable": 1,
    "class_name": "CronTab",
    "subclass_name": "CalendarField",
    "function_name": "bits(CronTab c)",
    "function_body": "{ return c.bits[0]; }"
  },
  {
    "id": 52,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 14,
    "human_patch": "https://github.com/jenkinsci/jenkins/commit/73afa0ca786a87f05b5433e2e38f863826fcad17",
    "cve_id": "CVE-2018-1000864",
    "cwe_id": "CWE-835",
    "filename": "core/src/main/java/hudson/scheduler/CronTab.java",
    "is_vulnerable": 1,
    "class_name": "CronTab",
    "subclass_name": "CalendarField",
    "function_name": "rollUp(Calendar cal, int i)",
    "function_body": "{ cal.add(Calendar.HOUR_OF_DAY,i); }"
  },
  {
    "id": 52,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 15,
    "human_patch": "https://github.com/jenkinsci/jenkins/commit/73afa0ca786a87f05b5433e2e38f863826fcad17",
    "cve_id": "CVE-2018-1000864",
    "cwe_id": "CWE-835",
    "filename": "core/src/main/java/hudson/scheduler/CronTab.java",
    "is_vulnerable": 1,
    "class_name": "CronTab",
    "subclass_name": "CalendarField",
    "function_name": "bits(CronTab c)",
    "function_body": "{ return c.bits[1]; }"
  },
  {
    "id": 52,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 16,
    "human_patch": "https://github.com/jenkinsci/jenkins/commit/73afa0ca786a87f05b5433e2e38f863826fcad17",
    "cve_id": "CVE-2018-1000864",
    "cwe_id": "CWE-835",
    "filename": "core/src/main/java/hudson/scheduler/CronTab.java",
    "is_vulnerable": 1,
    "class_name": "CronTab",
    "subclass_name": "CalendarField",
    "function_name": "rollUp(Calendar cal, int i)",
    "function_body": "{ cal.add(Calendar.DAY_OF_MONTH,i); }"
  },
  {
    "id": 52,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 17,
    "human_patch": "https://github.com/jenkinsci/jenkins/commit/73afa0ca786a87f05b5433e2e38f863826fcad17",
    "cve_id": "CVE-2018-1000864",
    "cwe_id": "CWE-835",
    "filename": "core/src/main/java/hudson/scheduler/CronTab.java",
    "is_vulnerable": 1,
    "class_name": "CronTab",
    "subclass_name": "CalendarField",
    "function_name": "bits(CronTab c)",
    "function_body": "{ return c.bits[2]; }"
  },
  {
    "id": 52,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 18,
    "human_patch": "https://github.com/jenkinsci/jenkins/commit/73afa0ca786a87f05b5433e2e38f863826fcad17",
    "cve_id": "CVE-2018-1000864",
    "cwe_id": "CWE-835",
    "filename": "core/src/main/java/hudson/scheduler/CronTab.java",
    "is_vulnerable": 1,
    "class_name": "CronTab",
    "subclass_name": "CalendarField",
    "function_name": "rollUp(Calendar cal, int i)",
    "function_body": "{ cal.add(Calendar.MONTH,i); }"
  },
  {
    "id": 52,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 19,
    "human_patch": "https://github.com/jenkinsci/jenkins/commit/73afa0ca786a87f05b5433e2e38f863826fcad17",
    "cve_id": "CVE-2018-1000864",
    "cwe_id": "CWE-835",
    "filename": "core/src/main/java/hudson/scheduler/CronTab.java",
    "is_vulnerable": 1,
    "class_name": "CronTab",
    "subclass_name": "CalendarField",
    "function_name": "bits(CronTab c)",
    "function_body": "{ return c.bits[3]; }"
  },
  {
    "id": 52,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 20,
    "human_patch": "https://github.com/jenkinsci/jenkins/commit/73afa0ca786a87f05b5433e2e38f863826fcad17",
    "cve_id": "CVE-2018-1000864",
    "cwe_id": "CWE-835",
    "filename": "core/src/main/java/hudson/scheduler/CronTab.java",
    "is_vulnerable": 1,
    "class_name": "CronTab",
    "subclass_name": "CalendarField",
    "function_name": "rollUp(Calendar cal, int i)",
    "function_body": "{ cal.add(Calendar.YEAR,i); }"
  },
  {
    "id": 52,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 21,
    "human_patch": "https://github.com/jenkinsci/jenkins/commit/73afa0ca786a87f05b5433e2e38f863826fcad17",
    "cve_id": "CVE-2018-1000864",
    "cwe_id": "CWE-835",
    "filename": "core/src/main/java/hudson/scheduler/CronTab.java",
    "is_vulnerable": 1,
    "class_name": "CronTab",
    "subclass_name": "CalendarField",
    "function_name": "bits(CronTab c)",
    "function_body": "{ return c.dayOfWeek; }"
  },
  {
    "id": 52,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 22,
    "human_patch": "https://github.com/jenkinsci/jenkins/commit/73afa0ca786a87f05b5433e2e38f863826fcad17",
    "cve_id": "CVE-2018-1000864",
    "cwe_id": "CWE-835",
    "filename": "core/src/main/java/hudson/scheduler/CronTab.java",
    "is_vulnerable": 1,
    "class_name": "CronTab",
    "subclass_name": "CalendarField",
    "function_name": "rollUp(Calendar cal, int i)",
    "function_body": "{\n                cal.add(Calendar.DAY_OF_WEEK, 7 * i);\n            }"
  },
  {
    "id": 52,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 23,
    "human_patch": "https://github.com/jenkinsci/jenkins/commit/73afa0ca786a87f05b5433e2e38f863826fcad17",
    "cve_id": "CVE-2018-1000864",
    "cwe_id": "CWE-835",
    "filename": "core/src/main/java/hudson/scheduler/CronTab.java",
    "is_vulnerable": 1,
    "class_name": "CronTab",
    "subclass_name": "CalendarField",
    "function_name": "setTo(Calendar c, int i)",
    "function_body": "{\n                int v = i-offset;\n                int was = c.get(field);\n                c.set(field,v);\n                final int firstDayOfWeek = c.getFirstDayOfWeek();\n                if (v < firstDayOfWeek && was >= firstDayOfWeek) {\n                    \n                    \n                    \n                    addTo(c,-7);\n                } else if (was < firstDayOfWeek && firstDayOfWeek <= v) {\n                    \n                    addTo(c, 7);\n                }\n            }"
  },
  {
    "id": 52,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 24,
    "human_patch": "https://github.com/jenkinsci/jenkins/commit/73afa0ca786a87f05b5433e2e38f863826fcad17",
    "cve_id": "CVE-2018-1000864",
    "cwe_id": "CWE-835",
    "filename": "core/src/main/java/hudson/scheduler/CronTab.java",
    "is_vulnerable": 0,
    "class_name": "CronTab",
    "subclass_name": null,
    "function_name": "ceil(long t)",
    "function_body": "{\n        Calendar cal = new GregorianCalendar(Locale.US);\n        cal.setTimeInMillis(t);\n        return ceil(cal);\n    }"
  },
  {
    "id": 52,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 25,
    "human_patch": "https://github.com/jenkinsci/jenkins/commit/73afa0ca786a87f05b5433e2e38f863826fcad17",
    "cve_id": "CVE-2018-1000864",
    "cwe_id": "CWE-835",
    "filename": "core/src/main/java/hudson/scheduler/CronTab.java",
    "is_vulnerable": 1,
    "class_name": "CronTab",
    "subclass_name": null,
    "function_name": "ceil(Calendar cal)",
    "function_body": "{\n        Calendar twoYearsFuture = (Calendar) cal.clone();\n        twoYearsFuture.add(Calendar.YEAR, 2);\n        OUTER:\n        while (true) {\n            if (cal.compareTo(twoYearsFuture) > 0) {\n                \n                throw new RareOrImpossibleDateException();\n            }\n            for (CalendarField f : CalendarField.ADJUST_ORDER) {\n                int cur = f.valueOf(cal);\n                int next = f.ceil(this,cur);\n                if (cur==next)  continue;   \n\n                \n                for (CalendarField l=f.lowerField; l!=null; l=l.lowerField)\n                    l.clear(cal);\n\n                if (next<0) {\n                    \n                    f.rollUp(cal, 1);\n                    f.setTo(cal,f.first(this));\n                    \n                    continue OUTER;\n                } else {\n                    f.setTo(cal,next);\n                    if (f.redoAdjustmentIfModified)\n                        continue OUTER; \n                }\n            }\n            return cal; \n        }\n    }"
  },
  {
    "id": 52,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 26,
    "human_patch": "https://github.com/jenkinsci/jenkins/commit/73afa0ca786a87f05b5433e2e38f863826fcad17",
    "cve_id": "CVE-2018-1000864",
    "cwe_id": "CWE-835",
    "filename": "core/src/main/java/hudson/scheduler/CronTab.java",
    "is_vulnerable": 0,
    "class_name": "CronTab",
    "subclass_name": null,
    "function_name": "floor(long t)",
    "function_body": "{\n        Calendar cal = new GregorianCalendar(Locale.US);\n        cal.setTimeInMillis(t);\n        return floor(cal);\n    }"
  },
  {
    "id": 52,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 27,
    "human_patch": "https://github.com/jenkinsci/jenkins/commit/73afa0ca786a87f05b5433e2e38f863826fcad17",
    "cve_id": "CVE-2018-1000864",
    "cwe_id": "CWE-835",
    "filename": "core/src/main/java/hudson/scheduler/CronTab.java",
    "is_vulnerable": 0,
    "class_name": "CronTab",
    "subclass_name": null,
    "function_name": "floor(Calendar cal)",
    "function_body": "{\n        Calendar twoYearsAgo = (Calendar) cal.clone();\n        twoYearsAgo.add(Calendar.YEAR, -2);\n\n        OUTER:\n        while (true) {\n            if (cal.compareTo(twoYearsAgo) < 0) {\n                \n                throw new RareOrImpossibleDateException();\n            }\n            for (CalendarField f : CalendarField.ADJUST_ORDER) {\n                int cur = f.valueOf(cal);\n                int next = f.floor(this,cur);\n                if (cur==next)  continue;   \n\n                \n                for (CalendarField l=f.lowerField; l!=null; l=l.lowerField)\n                    l.clear(cal);\n\n                if (next<0) {\n                    \n                    f.rollUp(cal,-1);\n                    \n                    \n                    \n                    f.setTo(cal,f.last(this));\n                    f.addTo(cal,1);\n                    \n                    \n                    CalendarField.MINUTE.addTo(cal,-1);\n                    \n                    continue OUTER;\n                } else {\n                    f.setTo(cal,next);\n                    f.addTo(cal,1);\n                    CalendarField.MINUTE.addTo(cal,-1);\n                    if (f.redoAdjustmentIfModified)\n                        continue OUTER; \n                }\n            }\n            return cal; \n        }\n    }"
  },
  {
    "id": 52,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 28,
    "human_patch": "https://github.com/jenkinsci/jenkins/commit/73afa0ca786a87f05b5433e2e38f863826fcad17",
    "cve_id": "CVE-2018-1000864",
    "cwe_id": "CWE-835",
    "filename": "core/src/main/java/hudson/scheduler/CronTab.java",
    "is_vulnerable": 0,
    "class_name": "CronTab",
    "subclass_name": null,
    "function_name": "set(String format, Hash hash) throws ANTLRException",
    "function_body": "{\n        set(format,1,hash);\n    }"
  },
  {
    "id": 52,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 29,
    "human_patch": "https://github.com/jenkinsci/jenkins/commit/73afa0ca786a87f05b5433e2e38f863826fcad17",
    "cve_id": "CVE-2018-1000864",
    "cwe_id": "CWE-835",
    "filename": "core/src/main/java/hudson/scheduler/CronTab.java",
    "is_vulnerable": 0,
    "class_name": "CronTab",
    "subclass_name": null,
    "function_name": "checkBits(long bitMask, int n)",
    "function_body": "{\n        return (bitMask|(1L<<n))==bitMask;\n    }"
  },
  {
    "id": 52,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 30,
    "human_patch": "https://github.com/jenkinsci/jenkins/commit/73afa0ca786a87f05b5433e2e38f863826fcad17",
    "cve_id": "CVE-2018-1000864",
    "cwe_id": "CWE-835",
    "filename": "core/src/main/java/hudson/scheduler/CronTab.java",
    "is_vulnerable": 0,
    "class_name": "CronTab",
    "subclass_name": null,
    "function_name": "toString()",
    "function_body": "{\n        return super.toString()+\"[\"+\n            toString(\"minute\",bits[0])+','+\n            toString(\"hour\",bits[1])+','+\n            toString(\"dayOfMonth\",bits[2])+','+\n            toString(\"month\",bits[3])+','+\n            toString(\"dayOfWeek\",dayOfWeek)+']';\n    }"
  },
  {
    "id": 52,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 31,
    "human_patch": "https://github.com/jenkinsci/jenkins/commit/73afa0ca786a87f05b5433e2e38f863826fcad17",
    "cve_id": "CVE-2018-1000864",
    "cwe_id": "CWE-835",
    "filename": "core/src/main/java/hudson/scheduler/CronTab.java",
    "is_vulnerable": 0,
    "class_name": "CronTab",
    "subclass_name": null,
    "function_name": "toString(String key, long bit)",
    "function_body": "{\n        return key+'='+Long.toHexString(bit);\n    }"
  },
  {
    "id": 52,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 32,
    "human_patch": "https://github.com/jenkinsci/jenkins/commit/73afa0ca786a87f05b5433e2e38f863826fcad17",
    "cve_id": "CVE-2018-1000864",
    "cwe_id": "CWE-835",
    "filename": "core/src/main/java/hudson/scheduler/CronTab.java",
    "is_vulnerable": 0,
    "class_name": "CronTab",
    "subclass_name": null,
    "function_name": "checkSanity()",
    "function_body": "{\n        OUTER: for (int i = 0; i < 5; i++) {\n            long bitMask = (i<4)?bits[i]:(long)dayOfWeek;\n            for( int j=BaseParser.LOWER_BOUNDS[i]; j<=BaseParser.UPPER_BOUNDS[i]; j++ ) {\n                if(!checkBits(bitMask,j)) {\n                    \n                    \n                    if(i>0)\n                        return Messages.CronTab_do_you_really_mean_every_minute_when_you(spec, \"H \" + spec.substring(spec.indexOf(' ') + 1));\n                    \n                    break OUTER;\n                }\n            }\n        }\n\n        int daysOfMonth = 0;\n        for (int i = 1; i < 31; i++) {\n            if (checkBits(bits[2], i)) {\n                daysOfMonth++;\n            }\n        }\n        if (daysOfMonth > 5 && daysOfMonth < 28) { \n            return Messages.CronTab_short_cycles_in_the_day_of_month_field_w();\n        }\n\n        String hashified = hashify(spec);\n        if (hashified != null) {\n            return Messages.CronTab_spread_load_evenly_by_using_rather_than_(hashified, spec);\n        }\n\n        return null;\n    }"
  },
  {
    "id": 52,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 33,
    "human_patch": "https://github.com/jenkinsci/jenkins/commit/73afa0ca786a87f05b5433e2e38f863826fcad17",
    "cve_id": "CVE-2018-1000864",
    "cwe_id": "CWE-835",
    "filename": "core/src/main/java/hudson/scheduler/CronTab.java",
    "is_vulnerable": 0,
    "class_name": "CronTab",
    "subclass_name": null,
    "function_name": "hashify(String spec)",
    "function_body": "{\n        if (spec.contains(\"H\")) {\n            \n            return null;\n        } else if (spec.startsWith(\"*/\")) {\n            return \"H\" + spec.substring(1);\n        } else if (spec.matches(\"\\\\d+ .+\")) {\n            return \"H \" + spec.substring(spec.indexOf(' ') + 1);\n        } else {\n            Matcher m = Pattern.compile(\"0(,(\\\\d+)(,\\\\d+)*)( .+)\").matcher(spec);\n            if (m.matches()) { \n                int period = Integer.parseInt(m.group(2));\n                if (period > 0) {\n                    StringBuilder b = new StringBuilder();\n                    for (int i = period; i < 60; i += period) {\n                        b.append(',').append(i);\n                    }\n                    if (b.toString().equals(m.group(1))) {\n                        return \"H/\" + period + m.group(4);\n                    }\n                }\n            }\n            return null;\n        }\n    }"
  },
  {
    "id": 52,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 34,
    "human_patch": "https://github.com/jenkinsci/jenkins/commit/73afa0ca786a87f05b5433e2e38f863826fcad17",
    "cve_id": "CVE-2018-1000864",
    "cwe_id": "CWE-835",
    "filename": "core/src/main/java/hudson/scheduler/CronTab.java",
    "is_vulnerable": 0,
    "class_name": "CronTab",
    "subclass_name": null,
    "function_name": "getTimeZone()",
    "function_body": "{\n        if (this.specTimezone == null) {\n            return null;\n        }\n        return TimeZone.getTimeZone(this.specTimezone);\n    }"
  },
  {
    "id": 52,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 0,
    "human_patch": "https://github.com/jenkinsci/jenkins/commit/73afa0ca786a87f05b5433e2e38f863826fcad17",
    "cve_id": "CVE-2018-1000864",
    "cwe_id": "CWE-835",
    "filename": "core/src/test/java/hudson/scheduler/CronTabTest.java",
    "is_vulnerable": 0,
    "class_name": "CronTabTest",
    "subclass_name": null,
    "function_name": "test1() throws ANTLRException",
    "function_body": "{\n        new CronTab(\"@yearly\");\n        new CronTab(\"@weekly\");\n        new CronTab(\"@midnight\");\n        new CronTab(\"@monthly\");\n        new CronTab(\"0 0 * 1-10/3 *\");\n    }"
  },
  {
    "id": 52,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 1,
    "human_patch": "https://github.com/jenkinsci/jenkins/commit/73afa0ca786a87f05b5433e2e38f863826fcad17",
    "cve_id": "CVE-2018-1000864",
    "cwe_id": "CWE-835",
    "filename": "core/src/test/java/hudson/scheduler/CronTabTest.java",
    "is_vulnerable": 0,
    "class_name": "CronTabTest",
    "subclass_name": null,
    "function_name": "testCeil1() throws Exception",
    "function_body": "{\n        CronTab x = new CronTab(\"0,30 * * * *\");\n        Calendar c = new GregorianCalendar(2000,2,1,1,10);\n        compare(new GregorianCalendar(2000,2,1,1,30),x.ceil(c));\n\n        \n        c =     new GregorianCalendar(2000,2,1,1,40);\n        compare(new GregorianCalendar(2000,2,1,2, 0),x.ceil(c));\n    }"
  },
  {
    "id": 52,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 2,
    "human_patch": "https://github.com/jenkinsci/jenkins/commit/73afa0ca786a87f05b5433e2e38f863826fcad17",
    "cve_id": "CVE-2018-1000864",
    "cwe_id": "CWE-835",
    "filename": "core/src/test/java/hudson/scheduler/CronTabTest.java",
    "is_vulnerable": 0,
    "class_name": "CronTabTest",
    "subclass_name": null,
    "function_name": "testCeil2() throws Exception",
    "function_body": "{\n        \n        CronTab x = new CronTab(\"15,45 3 * * *\");\n        Calendar c = new GregorianCalendar(2000,2,1,2,30);\n        compare(new GregorianCalendar(2000,2,1,3,15),x.ceil(c));\n    }"
  },
  {
    "id": 52,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 3,
    "human_patch": "https://github.com/jenkinsci/jenkins/commit/73afa0ca786a87f05b5433e2e38f863826fcad17",
    "cve_id": "CVE-2018-1000864",
    "cwe_id": "CWE-835",
    "filename": "core/src/test/java/hudson/scheduler/CronTabTest.java",
    "is_vulnerable": 0,
    "class_name": "CronTabTest",
    "subclass_name": null,
    "function_name": "testCeil3() throws Exception",
    "function_body": "{\n        \n        CronTab x = new CronTab(\"0 0 1 * 0\");\n        Calendar c = new GregorianCalendar(2010,0,1,15,55);\n        \n        compare(new GregorianCalendar(2010,7,1,0,0),x.ceil(c));\n    }"
  },
  {
    "id": 52,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 4,
    "human_patch": "https://github.com/jenkinsci/jenkins/commit/73afa0ca786a87f05b5433e2e38f863826fcad17",
    "cve_id": "CVE-2018-1000864",
    "cwe_id": "CWE-835",
    "filename": "core/src/test/java/hudson/scheduler/CronTabTest.java",
    "is_vulnerable": 0,
    "class_name": "CronTabTest",
    "subclass_name": null,
    "function_name": "testCeil3_DoW7() throws Exception",
    "function_body": "{\n        \n        CronTab x = new CronTab(\"0 0 1 * 7\");\n        Calendar c = new GregorianCalendar(2010,0,1,15,55);\n        \n        compare(new GregorianCalendar(2010, 7, 1, 0, 0), x.ceil(c));\n    }"
  },
  {
    "id": 52,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 5,
    "human_patch": "https://github.com/jenkinsci/jenkins/commit/73afa0ca786a87f05b5433e2e38f863826fcad17",
    "cve_id": "CVE-2018-1000864",
    "cwe_id": "CWE-835",
    "filename": "core/src/test/java/hudson/scheduler/CronTabTest.java",
    "is_vulnerable": 0,
    "class_name": "CronTabTest",
    "subclass_name": null,
    "function_name": "testCeil4() throws ANTLRException",
    "function_body": "{\n        final Calendar cal = Calendar.getInstance(new Locale(\"de\", \"de\"));\n        cal.set(2011, 0, 16, 0, 0, 0); \n        final String cronStr = \"0 23 * * 1-5\"; \n\n        final CronTab cron = new CronTab(cronStr);\n        final Calendar next = cron.ceil(cal);\n\n        final Calendar expectedDate = Calendar.getInstance();\n        expectedDate.set(2011, 0, 17, 23, 0, 0); \n        assertEquals(expectedDate.get(Calendar.HOUR), next.get(Calendar.HOUR));\n        assertEquals(expectedDate.get(Calendar.MINUTE), next.get(Calendar.MINUTE));\n        assertEquals(expectedDate.get(Calendar.YEAR), next.get(Calendar.YEAR));\n        assertEquals(expectedDate.get(Calendar.MONTH), next.get(Calendar.MONTH));\n        assertEquals(expectedDate.get(Calendar.DAY_OF_MONTH), next.get(Calendar.DAY_OF_MONTH)); \n    }"
  },
  {
    "id": 52,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 6,
    "human_patch": "https://github.com/jenkinsci/jenkins/commit/73afa0ca786a87f05b5433e2e38f863826fcad17",
    "cve_id": "CVE-2018-1000864",
    "cwe_id": "CWE-835",
    "filename": "core/src/test/java/hudson/scheduler/CronTabTest.java",
    "is_vulnerable": 0,
    "class_name": "CronTabTest",
    "subclass_name": null,
    "function_name": "testCeil5() throws ANTLRException",
    "function_body": "{\n        final Calendar cal = Calendar.getInstance(new Locale(\"de\", \"at\"));\n        cal.set(2011, 0, 16, 0, 0, 0); \n        final String cronStr = \"0 23 * * 1-5\"; \n\n        final CronTab cron = new CronTab(cronStr);\n        final Calendar next = cron.ceil(cal);\n\n        final Calendar expectedDate = Calendar.getInstance();\n        expectedDate.set(2011, 0, 17, 23, 0, 0); \n        assertEquals(expectedDate.get(Calendar.HOUR), next.get(Calendar.HOUR));\n        assertEquals(expectedDate.get(Calendar.MINUTE), next.get(Calendar.MINUTE));\n        assertEquals(expectedDate.get(Calendar.YEAR), next.get(Calendar.YEAR));\n        assertEquals(expectedDate.get(Calendar.MONTH), next.get(Calendar.MONTH));\n        assertEquals(expectedDate.get(Calendar.DAY_OF_MONTH), next.get(Calendar.DAY_OF_MONTH)); \n    }"
  },
  {
    "id": 52,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 7,
    "human_patch": "https://github.com/jenkinsci/jenkins/commit/73afa0ca786a87f05b5433e2e38f863826fcad17",
    "cve_id": "CVE-2018-1000864",
    "cwe_id": "CWE-835",
    "filename": "core/src/test/java/hudson/scheduler/CronTabTest.java",
    "is_vulnerable": 0,
    "class_name": "CronTabTest",
    "subclass_name": null,
    "function_name": "testFloor1() throws Exception",
    "function_body": "{\n        CronTab x = new CronTab(\"30 * * * *\");\n        Calendar c = new GregorianCalendar(2000,2,1,1,40);\n        compare(new GregorianCalendar(2000,2,1,1,30),x.floor(c));\n\n        \n        c =     new GregorianCalendar(2000,2,1,1,10);\n        compare(new GregorianCalendar(2000,2,1,0,30),x.floor(c));\n    }"
  },
  {
    "id": 52,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 8,
    "human_patch": "https://github.com/jenkinsci/jenkins/commit/73afa0ca786a87f05b5433e2e38f863826fcad17",
    "cve_id": "CVE-2018-1000864",
    "cwe_id": "CWE-835",
    "filename": "core/src/test/java/hudson/scheduler/CronTabTest.java",
    "is_vulnerable": 0,
    "class_name": "CronTabTest",
    "subclass_name": null,
    "function_name": "testFloor2() throws Exception",
    "function_body": "{\n        \n        CronTab x = new CronTab(\"15,45 3 * * *\");\n        Calendar c = new GregorianCalendar(2000,2,1,4,30);\n        compare(new GregorianCalendar(2000,2,1,3,45),x.floor(c));\n    }"
  },
  {
    "id": 52,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 9,
    "human_patch": "https://github.com/jenkinsci/jenkins/commit/73afa0ca786a87f05b5433e2e38f863826fcad17",
    "cve_id": "CVE-2018-1000864",
    "cwe_id": "CWE-835",
    "filename": "core/src/test/java/hudson/scheduler/CronTabTest.java",
    "is_vulnerable": 0,
    "class_name": "CronTabTest",
    "subclass_name": null,
    "function_name": "testFloor3() throws Exception",
    "function_body": "{\n        \n        CronTab x = new CronTab(\"0 0 1 * 0\");\n        Calendar c = new GregorianCalendar(2011,0,1,15,55);\n        \n        compare(new GregorianCalendar(2010,7,1,0,0),x.floor(c));\n    }"
  },
  {
    "id": 52,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 10,
    "human_patch": "https://github.com/jenkinsci/jenkins/commit/73afa0ca786a87f05b5433e2e38f863826fcad17",
    "cve_id": "CVE-2018-1000864",
    "cwe_id": "CWE-835",
    "filename": "core/src/test/java/hudson/scheduler/CronTabTest.java",
    "is_vulnerable": 0,
    "class_name": "CronTabTest",
    "subclass_name": null,
    "function_name": "testFloor4() throws Exception",
    "function_body": "{\n        \n        CronTab x = new CronTab(\"0 0 1 * 0\");\n        Calendar c = new GregorianCalendar(2011,0,1,15,55);\n        c.setFirstDayOfWeek(MONDAY);\n        \n        GregorianCalendar answer = new GregorianCalendar(2010, 7, 1, 0, 0);\n        answer.setFirstDayOfWeek(MONDAY);\n        compare(answer,x.floor(c));\n    }"
  },
  {
    "id": 52,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 11,
    "human_patch": "https://github.com/jenkinsci/jenkins/commit/73afa0ca786a87f05b5433e2e38f863826fcad17",
    "cve_id": "CVE-2018-1000864",
    "cwe_id": "CWE-835",
    "filename": "core/src/test/java/hudson/scheduler/CronTabTest.java",
    "is_vulnerable": 0,
    "class_name": "CronTabTest",
    "subclass_name": null,
    "function_name": "checkSanity() throws Exception",
    "function_body": "{\n        assertEquals(null, new CronTab(\"@hourly\").checkSanity());\n        assertEquals(Messages.CronTab_do_you_really_mean_every_minute_when_you(\"* * * * *\", \"H * * * *\"), new CronTab(\"* * * * *\").checkSanity());\n        assertEquals(Messages.CronTab_do_you_really_mean_every_minute_when_you(\"*/1 * * * *\", \"H * * * *\"), new CronTab(\"*/1 * * * *\").checkSanity());\n        assertEquals(null, new CronTab(\"H H(0-2) * * *\", Hash.from(\"stuff\")).checkSanity());\n        assertEquals(Messages.CronTab_do_you_really_mean_every_minute_when_you(\"* 0 * * *\", \"H 0 * * *\"), new CronTab(\"* 0 * * *\").checkSanity());\n        assertEquals(Messages.CronTab_do_you_really_mean_every_minute_when_you(\"* 6,18 * * *\", \"H 6,18 * * *\"), new CronTab(\"* 6,18 * * *\").checkSanity());\n        \n        assertEquals(Messages.CronTab_do_you_really_mean_every_minute_when_you(\"* * 3 * *\", \"H * 3 * *\"), new CronTab(\"* * 3 * *\").checkSanity());\n        \n        assertEquals(Messages.CronTab_spread_load_evenly_by_using_rather_than_(\"H/15 * * * *\", \"*/15 * * * *\"), new CronTab(\"*/15 * * * *\").checkSanity());\n        assertEquals(Messages.CronTab_spread_load_evenly_by_using_rather_than_(\"H/15 * * * *\", \"0,15,30,45 * * * *\"), new CronTab(\"0,15,30,45 * * * *\").checkSanity());\n        assertEquals(Messages.CronTab_spread_load_evenly_by_using_rather_than_(\"H * * * *\", \"0 * * * *\"), new CronTab(\"0 * * * *\").checkSanity());\n        assertEquals(Messages.CronTab_spread_load_evenly_by_using_rather_than_(\"H * * * *\", \"5 * * * *\"), new CronTab(\"5 * * * *\").checkSanity());\n        \n        assertEquals(Messages.CronTab_spread_load_evenly_by_using_rather_than_(\"H 3 * * *\", \"0 3 * * *\"), new CronTab(\"0 3 * * *\").checkSanity());\n        assertEquals(Messages.CronTab_spread_load_evenly_by_using_rather_than_(\"H 22 * * 6\", \"00 22 * * 6\"), new CronTab(\"00 22 * * 6\").checkSanity());\n        assertEquals(null, new CronTab(\"H/15 * 1 1 *\").checkSanity());\n        assertEquals(null, new CronTab(\"0 3 H/15 * *\").checkSanity());\n        assertEquals(Messages.CronTab_short_cycles_in_the_day_of_month_field_w(), new CronTab(\"0 3 H/3 * *\").checkSanity());\n        assertEquals(Messages.CronTab_short_cycles_in_the_day_of_month_field_w(), new CronTab(\"0 3 */5 * *\").checkSanity());\n    }"
  },
  {
    "id": 52,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 12,
    "human_patch": "https://github.com/jenkinsci/jenkins/commit/73afa0ca786a87f05b5433e2e38f863826fcad17",
    "cve_id": "CVE-2018-1000864",
    "cwe_id": "CWE-835",
    "filename": "core/src/test/java/hudson/scheduler/CronTabTest.java",
    "is_vulnerable": 0,
    "class_name": "CronTabTest",
    "subclass_name": null,
    "function_name": "compare(Calendar expected, Calendar actual)",
    "function_body": "{\n        DateFormat f = DateFormat.getDateTimeInstance();\n        assertEquals(f.format(expected.getTime()), f.format(actual.getTime()));\n    }"
  },
  {
    "id": 52,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 13,
    "human_patch": "https://github.com/jenkinsci/jenkins/commit/73afa0ca786a87f05b5433e2e38f863826fcad17",
    "cve_id": "CVE-2018-1000864",
    "cwe_id": "CWE-835",
    "filename": "core/src/test/java/hudson/scheduler/CronTabTest.java",
    "is_vulnerable": 0,
    "class_name": "CronTabTest",
    "subclass_name": null,
    "function_name": "testHash1() throws Exception",
    "function_body": "{\n        CronTab x = new CronTab(\"H H(5-8) H/3 H(1-10)/4 *\",new Hash() {\n            public int next(int n) {\n                return n-1;\n            }\n        });\n\n        assertEquals(\"59;\", bitset(x.bits[0]));\n        assertEquals(\"8;\", bitset(x.bits[1]));\n        assertEquals(\"3;6;9;12;15;18;21;24;27;\", bitset(x.bits[2]));\n        assertEquals(\"4;8;\", bitset(x.bits[3]));\n    }"
  },
  {
    "id": 52,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 14,
    "human_patch": "https://github.com/jenkinsci/jenkins/commit/73afa0ca786a87f05b5433e2e38f863826fcad17",
    "cve_id": "CVE-2018-1000864",
    "cwe_id": "CWE-835",
    "filename": "core/src/test/java/hudson/scheduler/CronTabTest.java",
    "is_vulnerable": 0,
    "class_name": "CronTabTest",
    "subclass_name": null,
    "function_name": "next(int n)",
    "function_body": "{\n                return n-1;\n            }"
  },
  {
    "id": 52,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 15,
    "human_patch": "https://github.com/jenkinsci/jenkins/commit/73afa0ca786a87f05b5433e2e38f863826fcad17",
    "cve_id": "CVE-2018-1000864",
    "cwe_id": "CWE-835",
    "filename": "core/src/test/java/hudson/scheduler/CronTabTest.java",
    "is_vulnerable": 0,
    "class_name": "CronTabTest",
    "subclass_name": null,
    "function_name": "bitset(long bits)",
    "function_body": "{\n        StringBuilder b = new StringBuilder();\n        for (int i = 0; i < 64; i++) {\n            if ((bits & 1L << i) != 0) {\n                b.append(i).append(';');\n            }\n        }\n        return b.toString();\n    }"
  },
  {
    "id": 52,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 16,
    "human_patch": "https://github.com/jenkinsci/jenkins/commit/73afa0ca786a87f05b5433e2e38f863826fcad17",
    "cve_id": "CVE-2018-1000864",
    "cwe_id": "CWE-835",
    "filename": "core/src/test/java/hudson/scheduler/CronTabTest.java",
    "is_vulnerable": 0,
    "class_name": "CronTabTest",
    "subclass_name": null,
    "function_name": "testHash2() throws Exception",
    "function_body": "{\n        CronTab x = new CronTab(\"H H(5-8) H/3 H(1-10)/4 *\",new Hash() {\n            public int next(int n) {\n                return 1;\n            }\n        });\n\n        assertEquals(\"1;\", bitset(x.bits[0]));\n        assertEquals(\"6;\", bitset(x.bits[1]));\n        assertEquals(\"2;5;8;11;14;17;20;23;26;\", bitset(x.bits[2]));\n        assertEquals(\"2;6;10;\", bitset(x.bits[3]));\n    }"
  },
  {
    "id": 52,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 17,
    "human_patch": "https://github.com/jenkinsci/jenkins/commit/73afa0ca786a87f05b5433e2e38f863826fcad17",
    "cve_id": "CVE-2018-1000864",
    "cwe_id": "CWE-835",
    "filename": "core/src/test/java/hudson/scheduler/CronTabTest.java",
    "is_vulnerable": 1,
    "class_name": "CronTabTest",
    "subclass_name": null,
    "function_name": "next(int n)",
    "function_body": "{\n                return 1;\n            }"
  },
  {
    "id": 52,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 18,
    "human_patch": "https://github.com/jenkinsci/jenkins/commit/73afa0ca786a87f05b5433e2e38f863826fcad17",
    "cve_id": "CVE-2018-1000864",
    "cwe_id": "CWE-835",
    "filename": "core/src/test/java/hudson/scheduler/CronTabTest.java",
    "is_vulnerable": 0,
    "class_name": "CronTabTest",
    "subclass_name": null,
    "function_name": "hashedMinute() throws Exception",
    "function_body": "{\n        long t = new GregorianCalendar(2013, 2, 21, 16, 21).getTimeInMillis();\n        compare(new GregorianCalendar(2013, 2, 21, 17, 56), new CronTab(\"H 17 * * *\", Hash.from(\"stuff\")).ceil(t));\n        compare(new GregorianCalendar(2013, 2, 21, 16, 56), new CronTab(\"H * * * *\", Hash.from(\"stuff\")).ceil(t));\n        compare(new GregorianCalendar(2013, 2, 21, 16, 56), new CronTab(\"@hourly\", Hash.from(\"stuff\")).ceil(t));\n        compare(new GregorianCalendar(2013, 2, 21, 17, 20), new CronTab(\"@hourly\", Hash.from(\"junk\")).ceil(t));\n        compare(new GregorianCalendar(2013, 2, 22, 13, 56), new CronTab(\"H H(12-13) * * *\", Hash.from(\"stuff\")).ceil(t));\n    }"
  },
  {
    "id": 52,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 19,
    "human_patch": "https://github.com/jenkinsci/jenkins/commit/73afa0ca786a87f05b5433e2e38f863826fcad17",
    "cve_id": "CVE-2018-1000864",
    "cwe_id": "CWE-835",
    "filename": "core/src/test/java/hudson/scheduler/CronTabTest.java",
    "is_vulnerable": 0,
    "class_name": "CronTabTest",
    "subclass_name": null,
    "function_name": "hashSkips() throws Exception",
    "function_body": "{\n        compare(new GregorianCalendar(2013, 2, 21, 16, 26), new CronTab(\"H/15 * * * *\", Hash.from(\"stuff\")).ceil(new GregorianCalendar(2013, 2, 21, 16, 21)));\n        compare(new GregorianCalendar(2013, 2, 21, 16, 41), new CronTab(\"H/15 * * * *\", Hash.from(\"stuff\")).ceil(new GregorianCalendar(2013, 2, 21, 16, 31)));\n        compare(new GregorianCalendar(2013, 2, 21, 16, 56), new CronTab(\"H/15 * * * *\", Hash.from(\"stuff\")).ceil(new GregorianCalendar(2013, 2, 21, 16, 42)));\n        compare(new GregorianCalendar(2013, 2, 21, 17, 11), new CronTab(\"H/15 * * * *\", Hash.from(\"stuff\")).ceil(new GregorianCalendar(2013, 2, 21, 16, 59)));\n        compare(new GregorianCalendar(2013, 2, 21, 0, 2), new CronTab(\"H(0-15)/3 * * * *\", Hash.from(\"junk\")).ceil(new GregorianCalendar(2013, 2, 21, 0, 0)));\n        compare(new GregorianCalendar(2013, 2, 21, 0, 2), new CronTab(\"H(0-3)/4 * * * *\", Hash.from(\"junk\")).ceil(new GregorianCalendar(2013, 2, 21, 0, 0)));\n        compare(new GregorianCalendar(2013, 2, 21, 1, 2), new CronTab(\"H(0-3)/4 * * * *\", Hash.from(\"junk\")).ceil(new GregorianCalendar(2013, 2, 21, 0, 5)));\n        try {\n            compare(new GregorianCalendar(2013, 2, 21, 0, 0), new CronTab(\"H(0-3)/15 * * * *\", Hash.from(\"junk\")).ceil(new GregorianCalendar(2013, 2, 21, 0, 0)));\n            fail();\n        } catch (ANTLRException x) {\n            \n        }\n    }"
  },
  {
    "id": 52,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 20,
    "human_patch": "https://github.com/jenkinsci/jenkins/commit/73afa0ca786a87f05b5433e2e38f863826fcad17",
    "cve_id": "CVE-2018-1000864",
    "cwe_id": "CWE-835",
    "filename": "core/src/test/java/hudson/scheduler/CronTabTest.java",
    "is_vulnerable": 0,
    "class_name": "CronTabTest",
    "subclass_name": null,
    "function_name": "repeatedHash() throws Exception",
    "function_body": "{\n        CronTabList tabs = CronTabList.create(\"H * * * *\\nH * * * *\", Hash.from(\"seed\"));\n        List<Integer> times = new ArrayList<Integer>();\n        for (int i = 0; i < 60; i++) {\n            if (tabs.check(new GregorianCalendar(2013, 3, 3, 11, i, 0))) {\n                times.add(i);\n            }\n        }\n        assertEquals(\"[35, 56]\", times.toString());\n    }"
  },
  {
    "id": 52,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 21,
    "human_patch": "https://github.com/jenkinsci/jenkins/commit/73afa0ca786a87f05b5433e2e38f863826fcad17",
    "cve_id": "CVE-2018-1000864",
    "cwe_id": "CWE-835",
    "filename": "core/src/test/java/hudson/scheduler/CronTabTest.java",
    "is_vulnerable": 0,
    "class_name": "CronTabTest",
    "subclass_name": null,
    "function_name": "rangeBoundsCheckOK() throws Exception",
    "function_body": "{\n        new CronTab(\"H(0-59) H(0-23) H(1-31) H(1-12) H(0-7)\");\n    }"
  },
  {
    "id": 52,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 22,
    "human_patch": "https://github.com/jenkinsci/jenkins/commit/73afa0ca786a87f05b5433e2e38f863826fcad17",
    "cve_id": "CVE-2018-1000864",
    "cwe_id": "CWE-835",
    "filename": "core/src/test/java/hudson/scheduler/CronTabTest.java",
    "is_vulnerable": 0,
    "class_name": "CronTabTest",
    "subclass_name": null,
    "function_name": "rangeBoundsCheckFailHour() throws Exception",
    "function_body": "{\n        try {\n            new CronTab(\"H H(12-24) * * *\");\n            fail();\n        } catch (ANTLRException e) {\n            \n        }\n    }"
  },
  {
    "id": 52,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 23,
    "human_patch": "https://github.com/jenkinsci/jenkins/commit/73afa0ca786a87f05b5433e2e38f863826fcad17",
    "cve_id": "CVE-2018-1000864",
    "cwe_id": "CWE-835",
    "filename": "core/src/test/java/hudson/scheduler/CronTabTest.java",
    "is_vulnerable": 0,
    "class_name": "CronTabTest",
    "subclass_name": null,
    "function_name": "rangeBoundsCheckFailMinute() throws Exception",
    "function_body": "{\n        try {\n            new CronTab(\"H(33-66) * * * *\");\n            fail();\n        } catch (ANTLRException e) {\n            \n        }\n    }"
  },
  {
    "id": 52,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 24,
    "human_patch": "https://github.com/jenkinsci/jenkins/commit/73afa0ca786a87f05b5433e2e38f863826fcad17",
    "cve_id": "CVE-2018-1000864",
    "cwe_id": "CWE-835",
    "filename": "core/src/test/java/hudson/scheduler/CronTabTest.java",
    "is_vulnerable": 0,
    "class_name": "CronTabTest",
    "subclass_name": null,
    "function_name": "testTimezone() throws Exception",
    "function_body": "{\n        CronTabList tabs = CronTabList.create(\"TZ=Australia/Sydney\\nH * * * *\\nH * * * *\", Hash.from(\"seed\"));\n        List<Integer> times = new ArrayList<Integer>();\n        for (int i = 0; i < 60; i++) {\n            if (tabs.check(new GregorianCalendar(2013, 3, 3, 11, i, 0))) {\n                times.add(i);\n            }\n        }\n        assertEquals(\"[35, 56]\", times.toString());\n    }"
  },
  {
    "id": 52,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 25,
    "human_patch": "https://github.com/jenkinsci/jenkins/commit/73afa0ca786a87f05b5433e2e38f863826fcad17",
    "cve_id": "CVE-2018-1000864",
    "cwe_id": "CWE-835",
    "filename": "core/src/test/java/hudson/scheduler/CronTabTest.java",
    "is_vulnerable": 0,
    "class_name": "CronTabTest",
    "subclass_name": null,
    "function_name": "testLongMonths() throws Exception",
    "function_body": "{\n        Calendar cal = Calendar.getInstance();\n        cal.set(Calendar.MONTH, Calendar.JULY);\n        new CronTab(\"0 0 31 7 *\").floor(cal); \n    }"
  },
  {
    "id": 53,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 0,
    "human_patch": "https://github.com/jenkinsci/junit-plugin/commit/15f39fc49d9f25bca872badb48e708a8bb815ea7",
    "cve_id": "CVE-2018-1000056",
    "cwe_id": "CWE-918",
    "filename": "src/main/java/hudson/tasks/junit/SuiteResult.java",
    "is_vulnerable": 0,
    "class_name": "SuiteResult",
    "subclass_name": null,
    "function_name": "casesByName()",
    "function_body": "{\n        if (casesByName == null) {\n            casesByName = new HashMap<>();\n            for (CaseResult c : cases) {\n                casesByName.put(c.getTransformedTestName(), c);\n            }\n        }\n        return casesByName;\n    }"
  },
  {
    "id": 53,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 1,
    "human_patch": "https://github.com/jenkinsci/junit-plugin/commit/15f39fc49d9f25bca872badb48e708a8bb815ea7",
    "cve_id": "CVE-2018-1000056",
    "cwe_id": "CWE-918",
    "filename": "src/main/java/hudson/tasks/junit/SuiteResult.java",
    "is_vulnerable": 1,
    "class_name": "SuiteResult",
    "subclass_name": null,
    "function_name": "parse(File xmlReport, boolean keepLongStdio, PipelineTestDetails pipelineTestDetails) throws DocumentException, IOException, InterruptedException",
    "function_body": "{\n        List<SuiteResult> r = new ArrayList<SuiteResult>();\n\n        \n        SAXReader saxReader = new SAXReader();\n        saxReader.setEntityResolver(new XMLEntityResolver());\n\n        FileInputStream xmlReportStream = new FileInputStream(xmlReport);\n        try {\n            Document result = saxReader.read(xmlReportStream);\n            Element root = result.getRootElement();\n\n            parseSuite(xmlReport, keepLongStdio, r, root, pipelineTestDetails);\n        } finally {\n            xmlReportStream.close();\n        }\n\n        return r;\n    }"
  },
  {
    "id": 53,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 2,
    "human_patch": "https://github.com/jenkinsci/junit-plugin/commit/15f39fc49d9f25bca872badb48e708a8bb815ea7",
    "cve_id": "CVE-2018-1000056",
    "cwe_id": "CWE-918",
    "filename": "src/main/java/hudson/tasks/junit/SuiteResult.java",
    "is_vulnerable": 0,
    "class_name": "SuiteResult",
    "subclass_name": null,
    "function_name": "parseSuite(File xmlReport, boolean keepLongStdio, List<SuiteResult> r, Element root,\n                                   PipelineTestDetails pipelineTestDetails) throws DocumentException, IOException",
    "function_body": "{\n        \n        @SuppressWarnings(\"unchecked\")\n        List<Element> testSuites = (List<Element>) root.elements(\"testsuite\");\n        for (Element suite : testSuites)\n            parseSuite(xmlReport, keepLongStdio, r, suite, pipelineTestDetails);\n\n        \n        \n        if (root.element(\"testcase\") != null || root.element(\"error\") != null)\n            r.add(new SuiteResult(xmlReport, root, keepLongStdio, pipelineTestDetails));\n    }"
  },
  {
    "id": 53,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 3,
    "human_patch": "https://github.com/jenkinsci/junit-plugin/commit/15f39fc49d9f25bca872badb48e708a8bb815ea7",
    "cve_id": "CVE-2018-1000056",
    "cwe_id": "CWE-918",
    "filename": "src/main/java/hudson/tasks/junit/SuiteResult.java",
    "is_vulnerable": 0,
    "class_name": "SuiteResult",
    "subclass_name": null,
    "function_name": "addCase(CaseResult cr)",
    "function_body": "{\n        cases.add(cr);\n        casesByName().put(cr.getTransformedTestName(), cr);\n\n        \n        if( !hasTimeAttr() ){\n            duration += cr.getDuration();\n        }\n    }"
  },
  {
    "id": 53,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 4,
    "human_patch": "https://github.com/jenkinsci/junit-plugin/commit/15f39fc49d9f25bca872badb48e708a8bb815ea7",
    "cve_id": "CVE-2018-1000056",
    "cwe_id": "CWE-918",
    "filename": "src/main/java/hudson/tasks/junit/SuiteResult.java",
    "is_vulnerable": 0,
    "class_name": "SuiteResult",
    "subclass_name": null,
    "function_name": "hasTimeAttr()",
    "function_body": "{\n        return time != null;\n    }"
  },
  {
    "id": 53,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 5,
    "human_patch": "https://github.com/jenkinsci/junit-plugin/commit/15f39fc49d9f25bca872badb48e708a8bb815ea7",
    "cve_id": "CVE-2018-1000056",
    "cwe_id": "CWE-918",
    "filename": "src/main/java/hudson/tasks/junit/SuiteResult.java",
    "is_vulnerable": 0,
    "class_name": "SuiteResult",
    "subclass_name": null,
    "function_name": "getName()",
    "function_body": "{\n        return name;\n    }"
  },
  {
    "id": 53,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 6,
    "human_patch": "https://github.com/jenkinsci/junit-plugin/commit/15f39fc49d9f25bca872badb48e708a8bb815ea7",
    "cve_id": "CVE-2018-1000056",
    "cwe_id": "CWE-918",
    "filename": "src/main/java/hudson/tasks/junit/SuiteResult.java",
    "is_vulnerable": 0,
    "class_name": "SuiteResult",
    "subclass_name": null,
    "function_name": "getDuration()",
    "function_body": "{\n        return duration;\n    }"
  },
  {
    "id": 53,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 7,
    "human_patch": "https://github.com/jenkinsci/junit-plugin/commit/15f39fc49d9f25bca872badb48e708a8bb815ea7",
    "cve_id": "CVE-2018-1000056",
    "cwe_id": "CWE-918",
    "filename": "src/main/java/hudson/tasks/junit/SuiteResult.java",
    "is_vulnerable": 0,
    "class_name": "SuiteResult",
    "subclass_name": null,
    "function_name": "getNodeId()",
    "function_body": "{\n        return nodeId;\n    }"
  },
  {
    "id": 53,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 8,
    "human_patch": "https://github.com/jenkinsci/junit-plugin/commit/15f39fc49d9f25bca872badb48e708a8bb815ea7",
    "cve_id": "CVE-2018-1000056",
    "cwe_id": "CWE-918",
    "filename": "src/main/java/hudson/tasks/junit/SuiteResult.java",
    "is_vulnerable": 0,
    "class_name": "SuiteResult",
    "subclass_name": null,
    "function_name": "getEnclosingBlocks()",
    "function_body": "{\n        if (enclosingBlocks != null) {\n            return Collections.unmodifiableList(enclosingBlocks);\n        } else {\n            return Collections.emptyList();\n        }\n    }"
  },
  {
    "id": 53,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 9,
    "human_patch": "https://github.com/jenkinsci/junit-plugin/commit/15f39fc49d9f25bca872badb48e708a8bb815ea7",
    "cve_id": "CVE-2018-1000056",
    "cwe_id": "CWE-918",
    "filename": "src/main/java/hudson/tasks/junit/SuiteResult.java",
    "is_vulnerable": 0,
    "class_name": "SuiteResult",
    "subclass_name": null,
    "function_name": "getEnclosingBlockNames()",
    "function_body": "{\n        if (enclosingBlockNames != null) {\n            return Collections.unmodifiableList(enclosingBlockNames);\n        } else {\n            return Collections.emptyList();\n        }\n    }"
  },
  {
    "id": 53,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 10,
    "human_patch": "https://github.com/jenkinsci/junit-plugin/commit/15f39fc49d9f25bca872badb48e708a8bb815ea7",
    "cve_id": "CVE-2018-1000056",
    "cwe_id": "CWE-918",
    "filename": "src/main/java/hudson/tasks/junit/SuiteResult.java",
    "is_vulnerable": 0,
    "class_name": "SuiteResult",
    "subclass_name": null,
    "function_name": "getStdout()",
    "function_body": "{\n        return stdout;\n    }"
  },
  {
    "id": 53,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 11,
    "human_patch": "https://github.com/jenkinsci/junit-plugin/commit/15f39fc49d9f25bca872badb48e708a8bb815ea7",
    "cve_id": "CVE-2018-1000056",
    "cwe_id": "CWE-918",
    "filename": "src/main/java/hudson/tasks/junit/SuiteResult.java",
    "is_vulnerable": 0,
    "class_name": "SuiteResult",
    "subclass_name": null,
    "function_name": "getStderr()",
    "function_body": "{\n        return stderr;\n    }"
  },
  {
    "id": 53,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 12,
    "human_patch": "https://github.com/jenkinsci/junit-plugin/commit/15f39fc49d9f25bca872badb48e708a8bb815ea7",
    "cve_id": "CVE-2018-1000056",
    "cwe_id": "CWE-918",
    "filename": "src/main/java/hudson/tasks/junit/SuiteResult.java",
    "is_vulnerable": 0,
    "class_name": "SuiteResult",
    "subclass_name": null,
    "function_name": "getFile()",
    "function_body": "{\n\t\treturn file;\n\t}"
  },
  {
    "id": 53,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 13,
    "human_patch": "https://github.com/jenkinsci/junit-plugin/commit/15f39fc49d9f25bca872badb48e708a8bb815ea7",
    "cve_id": "CVE-2018-1000056",
    "cwe_id": "CWE-918",
    "filename": "src/main/java/hudson/tasks/junit/SuiteResult.java",
    "is_vulnerable": 0,
    "class_name": "SuiteResult",
    "subclass_name": null,
    "function_name": "getParent()",
    "function_body": "{\n        return parent;\n    }"
  },
  {
    "id": 53,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 14,
    "human_patch": "https://github.com/jenkinsci/junit-plugin/commit/15f39fc49d9f25bca872badb48e708a8bb815ea7",
    "cve_id": "CVE-2018-1000056",
    "cwe_id": "CWE-918",
    "filename": "src/main/java/hudson/tasks/junit/SuiteResult.java",
    "is_vulnerable": 0,
    "class_name": "SuiteResult",
    "subclass_name": null,
    "function_name": "getTimestamp()",
    "function_body": "{\n        return timestamp;\n    }"
  },
  {
    "id": 53,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 15,
    "human_patch": "https://github.com/jenkinsci/junit-plugin/commit/15f39fc49d9f25bca872badb48e708a8bb815ea7",
    "cve_id": "CVE-2018-1000056",
    "cwe_id": "CWE-918",
    "filename": "src/main/java/hudson/tasks/junit/SuiteResult.java",
    "is_vulnerable": 0,
    "class_name": "SuiteResult",
    "subclass_name": null,
    "function_name": "getId()",
    "function_body": "{\n        return id;\n    }"
  },
  {
    "id": 53,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 16,
    "human_patch": "https://github.com/jenkinsci/junit-plugin/commit/15f39fc49d9f25bca872badb48e708a8bb815ea7",
    "cve_id": "CVE-2018-1000056",
    "cwe_id": "CWE-918",
    "filename": "src/main/java/hudson/tasks/junit/SuiteResult.java",
    "is_vulnerable": 0,
    "class_name": "SuiteResult",
    "subclass_name": null,
    "function_name": "getCases()",
    "function_body": "{\n        return cases;\n    }"
  },
  {
    "id": 53,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 17,
    "human_patch": "https://github.com/jenkinsci/junit-plugin/commit/15f39fc49d9f25bca872badb48e708a8bb815ea7",
    "cve_id": "CVE-2018-1000056",
    "cwe_id": "CWE-918",
    "filename": "src/main/java/hudson/tasks/junit/SuiteResult.java",
    "is_vulnerable": 0,
    "class_name": "SuiteResult",
    "subclass_name": null,
    "function_name": "getPreviousResult()",
    "function_body": "{\n        hudson.tasks.test.TestResult pr = parent.getPreviousResult();\n        if(pr==null)    return null;\n        if(pr instanceof hudson.tasks.junit.TestResult)\n            return ((hudson.tasks.junit.TestResult)pr).getSuite(name);\n        return null;\n    }"
  },
  {
    "id": 53,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 18,
    "human_patch": "https://github.com/jenkinsci/junit-plugin/commit/15f39fc49d9f25bca872badb48e708a8bb815ea7",
    "cve_id": "CVE-2018-1000056",
    "cwe_id": "CWE-918",
    "filename": "src/main/java/hudson/tasks/junit/SuiteResult.java",
    "is_vulnerable": 0,
    "class_name": "SuiteResult",
    "subclass_name": null,
    "function_name": "getCase(String name)",
    "function_body": "{\n        return casesByName().get(name);\n    }"
  },
  {
    "id": 53,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 19,
    "human_patch": "https://github.com/jenkinsci/junit-plugin/commit/15f39fc49d9f25bca872badb48e708a8bb815ea7",
    "cve_id": "CVE-2018-1000056",
    "cwe_id": "CWE-918",
    "filename": "src/main/java/hudson/tasks/junit/SuiteResult.java",
    "is_vulnerable": 0,
    "class_name": "SuiteResult",
    "subclass_name": null,
    "function_name": "getClassNames()",
    "function_body": "{\n\t\tSet<String> result = new HashSet<String>();\n\t\tfor (CaseResult c : cases) {\n\t\t\tresult.add(c.getClassName());\n\t\t}\n\t\treturn result;\n\t}"
  },
  {
    "id": 53,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 20,
    "human_patch": "https://github.com/jenkinsci/junit-plugin/commit/15f39fc49d9f25bca872badb48e708a8bb815ea7",
    "cve_id": "CVE-2018-1000056",
    "cwe_id": "CWE-918",
    "filename": "src/main/java/hudson/tasks/junit/SuiteResult.java",
    "is_vulnerable": 0,
    "class_name": "SuiteResult",
    "subclass_name": null,
    "function_name": "setParent(hudson.tasks.junit.TestResult parent)",
    "function_body": "{\n        this.parent = parent;\n    }"
  },
  {
    "id": 53,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 21,
    "human_patch": "https://github.com/jenkinsci/junit-plugin/commit/15f39fc49d9f25bca872badb48e708a8bb815ea7",
    "cve_id": "CVE-2018-1000056",
    "cwe_id": "CWE-918",
    "filename": "src/main/java/hudson/tasks/junit/SuiteResult.java",
    "is_vulnerable": 0,
    "class_name": "SuiteResult",
    "subclass_name": null,
    "function_name": "freeze(hudson.tasks.junit.TestResult owner)",
    "function_body": "{\n        if(this.parent!=null)\n            return false;   \n\n        this.parent = owner;\n        for (CaseResult c : cases)\n            c.freeze(this);\n        return true;\n    }"
  },
  {
    "id": 53,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 22,
    "human_patch": "https://github.com/jenkinsci/junit-plugin/commit/15f39fc49d9f25bca872badb48e708a8bb815ea7",
    "cve_id": "CVE-2018-1000056",
    "cwe_id": "CWE-918",
    "filename": "src/main/java/hudson/tasks/junit/SuiteResult.java",
    "is_vulnerable": 0,
    "class_name": "SuiteResult",
    "subclass_name": null,
    "function_name": "merge(SuiteResult sr)",
    "function_body": "{\n        if (sr.hasTimeAttr() ^ hasTimeAttr()){\n            LOGGER.warning(\"Merging of suiteresults with incompatible time attribute may lead to incorrect durations in reports.( \"+getFile()+\", \"+sr.getFile()+\")\");\n        }\n        if (hasTimeAttr()) {\n            duration += sr.getDuration();\n        }\n        for (CaseResult cr : sr.getCases()) {\n            addCase(cr);\n            cr.replaceParent(this);\n        }\n    }"
  },
  {
    "id": 53,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 0,
    "human_patch": "https://github.com/jenkinsci/junit-plugin/commit/15f39fc49d9f25bca872badb48e708a8bb815ea7",
    "cve_id": "CVE-2018-1000056",
    "cwe_id": "CWE-918",
    "filename": "src/main/java/hudson/tasks/junit/XMLEntityResolver.java",
    "is_vulnerable": 1,
    "class_name": "XMLEntityResolver",
    "subclass_name": null,
    "function_name": "resolveEntity(String publicId, String systemId) throws SAXException, IOException",
    "function_body": "{\n        if (systemId != null) {\n            if (LOGGER.isLoggable(Level.FINE)) {\n                LOGGER.fine(\"Will try to resolve systemId [\" + systemId + \"]\");\n            }\n            \n            if (systemId.startsWith(TESTNG_NAMESPACE)) {\n                LOGGER.fine(\"It's a TestNG document, will try to lookup DTD in classpath\");\n                String dtdFileName = systemId.substring(TESTNG_NAMESPACE.length());\n\n                URL url = getClass().getClassLoader().getResource(dtdFileName);\n                if (url != null)\n                    return new InputSource(url.toString());\n            }\n        }\n        \n        return null;\n    }"
  },
  {
    "id": 53,
    "sub_id": 2,
    "code_id": 0,
    "function_id": 0,
    "human_patch": "https://github.com/jenkinsci/junit-plugin/commit/15f39fc49d9f25bca872badb48e708a8bb815ea7",
    "cve_id": "CVE-2018-1000056",
    "cwe_id": "CWE-918",
    "filename": "src/test/java/hudson/tasks/junit/JUnitResultArchiverTest.java",
    "is_vulnerable": 0,
    "class_name": "JUnitResultArchiverTest",
    "subclass_name": null,
    "function_name": "setUp() throws Exception",
    "function_body": "{\n        project = j.createFreeStyleProject(\"junit\");\n        archiver = new JUnitResultArchiver(\"*.xml\");\n        project.getPublishersList().add(archiver);\n\n        project.getBuildersList().add(new TouchBuilder());\n    }"
  },
  {
    "id": 53,
    "sub_id": 2,
    "code_id": 0,
    "function_id": 1,
    "human_patch": "https://github.com/jenkinsci/junit-plugin/commit/15f39fc49d9f25bca872badb48e708a8bb815ea7",
    "cve_id": "CVE-2018-1000056",
    "cwe_id": "CWE-918",
    "filename": "src/test/java/hudson/tasks/junit/JUnitResultArchiverTest.java",
    "is_vulnerable": 0,
    "class_name": "JUnitResultArchiverTest",
    "subclass_name": null,
    "function_name": "basic() throws Exception",
    "function_body": "{\n        FreeStyleBuild build = project.scheduleBuild2(0).get(10, TimeUnit.SECONDS);\n\n        assertTestResults(build);\n\n        WebClient wc = j.new WebClient();\n        wc.getPage(project); \n        wc.getPage(build); \n        wc.getPage(build, \"testReport\");  \n        wc.getPage(build, \"testReport/hudson.security\"); \n        wc.getPage(build, \"testReport/hudson.security/HudsonPrivateSecurityRealmTest/\"); \n        wc.getPage(build, \"testReport/hudson.security/HudsonPrivateSecurityRealmTest/testDataCompatibilityWith1_282/\"); \n\n\n    }"
  },
  {
    "id": 53,
    "sub_id": 2,
    "code_id": 0,
    "function_id": 2,
    "human_patch": "https://github.com/jenkinsci/junit-plugin/commit/15f39fc49d9f25bca872badb48e708a8bb815ea7",
    "cve_id": "CVE-2018-1000056",
    "cwe_id": "CWE-918",
    "filename": "src/test/java/hudson/tasks/junit/JUnitResultArchiverTest.java",
    "is_vulnerable": 0,
    "class_name": "JUnitResultArchiverTest",
    "subclass_name": null,
    "function_name": "slave() throws Exception",
    "function_body": "{\n        DumbSlave s = j.createOnlineSlave();\n        project.setAssignedLabel(s.getSelfLabel());\n\n        FilePath src = new FilePath(j.jenkins.getRootPath(), \"jobs/junit/workspace/\");\n        assertNotNull(src);\n        FilePath dest = s.getWorkspaceFor(project);\n        assertNotNull(dest);\n        src.copyRecursiveTo(\"*.xml\", dest);\n\n        basic();\n    }"
  },
  {
    "id": 53,
    "sub_id": 2,
    "code_id": 0,
    "function_id": 3,
    "human_patch": "https://github.com/jenkinsci/junit-plugin/commit/15f39fc49d9f25bca872badb48e708a8bb815ea7",
    "cve_id": "CVE-2018-1000056",
    "cwe_id": "CWE-918",
    "filename": "src/test/java/hudson/tasks/junit/JUnitResultArchiverTest.java",
    "is_vulnerable": 0,
    "class_name": "JUnitResultArchiverTest",
    "subclass_name": null,
    "function_name": "assertTestResults(FreeStyleBuild build)",
    "function_body": "{\n        TestResultAction testResultAction = build.getAction(TestResultAction.class);\n        assertNotNull(\"no TestResultAction\", testResultAction);\n\n        TestResult result = testResultAction.getResult();\n        assertNotNull(\"no TestResult\", result);\n\n        assertEquals(\"should have 1 failing test\", 1, testResultAction.getFailCount());\n        assertEquals(\"should have 1 failing test\", 1, result.getFailCount());\n\n        assertEquals(\"should have 132 total tests\", 132, testResultAction.getTotalCount());\n        assertEquals(\"should have 132 total tests\", 132, result.getTotalCount());\n\n        for (SuiteResult suite : result.getSuites()) {\n            assertNull(\"No nodeId should be present on the SuiteResult\", suite.getNodeId());\n        }\n    }"
  },
  {
    "id": 53,
    "sub_id": 2,
    "code_id": 0,
    "function_id": 4,
    "human_patch": "https://github.com/jenkinsci/junit-plugin/commit/15f39fc49d9f25bca872badb48e708a8bb815ea7",
    "cve_id": "CVE-2018-1000056",
    "cwe_id": "CWE-918",
    "filename": "src/test/java/hudson/tasks/junit/JUnitResultArchiverTest.java",
    "is_vulnerable": 0,
    "class_name": "JUnitResultArchiverTest",
    "subclass_name": null,
    "function_name": "persistence() throws Exception",
    "function_body": "{\n        project.scheduleBuild2(0).get(60, TimeUnit.SECONDS);\n\n        reloadJenkins();\n\n        FreeStyleBuild build = project.getBuildByNumber(1);\n\n        assertTestResults(build);\n    }"
  },
  {
    "id": 53,
    "sub_id": 2,
    "code_id": 0,
    "function_id": 5,
    "human_patch": "https://github.com/jenkinsci/junit-plugin/commit/15f39fc49d9f25bca872badb48e708a8bb815ea7",
    "cve_id": "CVE-2018-1000056",
    "cwe_id": "CWE-918",
    "filename": "src/test/java/hudson/tasks/junit/JUnitResultArchiverTest.java",
    "is_vulnerable": 0,
    "class_name": "JUnitResultArchiverTest",
    "subclass_name": null,
    "function_name": "reloadJenkins() throws Exception",
    "function_body": "{\n        j.jenkins.reload();\n        project = (FreeStyleProject) j.jenkins.getItem(\"junit\");\n    }"
  },
  {
    "id": 53,
    "sub_id": 2,
    "code_id": 0,
    "function_id": 6,
    "human_patch": "https://github.com/jenkinsci/junit-plugin/commit/15f39fc49d9f25bca872badb48e708a8bb815ea7",
    "cve_id": "CVE-2018-1000056",
    "cwe_id": "CWE-918",
    "filename": "src/test/java/hudson/tasks/junit/JUnitResultArchiverTest.java",
    "is_vulnerable": 0,
    "class_name": "JUnitResultArchiverTest",
    "subclass_name": null,
    "function_name": "setDescription() throws Exception",
    "function_body": "{\n        FreeStyleBuild build = project.scheduleBuild2(0).get(10, TimeUnit.SECONDS);\n\n        CaseResult caseResult = build.getAction(TestResultAction.class).getFailedTests().get(0);\n        String url = build.getUrl() + \"/testReport/\" + caseResult.getRelativePathFrom(caseResult.getTestResult());\n\n        testSetDescription(url, caseResult);\n\n        ClassResult classResult = caseResult.getParent();\n        url = build.getUrl() + \"/testReport/\" + classResult.getParent().getSafeName() + \"/\" + classResult.getSafeName();\n        testSetDescription(url, classResult);\n\n        PackageResult packageResult = classResult.getParent();\n        url = build.getUrl() + \"/testReport/\" + classResult.getParent().getSafeName();\n        testSetDescription(url, packageResult);\n\n    }"
  },
  {
    "id": 53,
    "sub_id": 2,
    "code_id": 0,
    "function_id": 7,
    "human_patch": "https://github.com/jenkinsci/junit-plugin/commit/15f39fc49d9f25bca872badb48e708a8bb815ea7",
    "cve_id": "CVE-2018-1000056",
    "cwe_id": "CWE-918",
    "filename": "src/test/java/hudson/tasks/junit/JUnitResultArchiverTest.java",
    "is_vulnerable": 0,
    "class_name": "JUnitResultArchiverTest",
    "subclass_name": null,
    "function_name": "testSetDescription(String url, TestObject object) throws Exception",
    "function_body": "{\n        object.doSubmitDescription(\"description\");\n\n        \n        final WebClient wc = j.createWebClient();\n        HtmlPage page = wc.goTo(url);\n        page.getAnchorByHref(\"editDescription\").click();\n        wc.waitForBackgroundJavaScript(10000L);\n        HtmlForm form = findForm(page, \"submitDescription\");\n        j.submit(form);\n\n        assertEquals(\"description\", object.getDescription());\n    }"
  },
  {
    "id": 53,
    "sub_id": 2,
    "code_id": 0,
    "function_id": 8,
    "human_patch": "https://github.com/jenkinsci/junit-plugin/commit/15f39fc49d9f25bca872badb48e708a8bb815ea7",
    "cve_id": "CVE-2018-1000056",
    "cwe_id": "CWE-918",
    "filename": "src/test/java/hudson/tasks/junit/JUnitResultArchiverTest.java",
    "is_vulnerable": 0,
    "class_name": "JUnitResultArchiverTest",
    "subclass_name": null,
    "function_name": "findForm(HtmlPage page, String action)",
    "function_body": "{\n        for (HtmlForm form: page.getForms()) {\n            if (action.equals(form.getActionAttribute())) {\n                return form;\n            }\n        }\n        fail(\"no form found\");\n        return null;\n    }"
  },
  {
    "id": 53,
    "sub_id": 2,
    "code_id": 0,
    "function_id": 9,
    "human_patch": "https://github.com/jenkinsci/junit-plugin/commit/15f39fc49d9f25bca872badb48e708a8bb815ea7",
    "cve_id": "CVE-2018-1000056",
    "cwe_id": "CWE-918",
    "filename": "src/test/java/hudson/tasks/junit/JUnitResultArchiverTest.java",
    "is_vulnerable": 0,
    "class_name": "JUnitResultArchiverTest",
    "subclass_name": null,
    "function_name": "repeatedArchiving() throws Exception",
    "function_body": "{\n        doRepeatedArchiving(false);\n    }"
  },
  {
    "id": 53,
    "sub_id": 2,
    "code_id": 0,
    "function_id": 10,
    "human_patch": "https://github.com/jenkinsci/junit-plugin/commit/15f39fc49d9f25bca872badb48e708a8bb815ea7",
    "cve_id": "CVE-2018-1000056",
    "cwe_id": "CWE-918",
    "filename": "src/test/java/hudson/tasks/junit/JUnitResultArchiverTest.java",
    "is_vulnerable": 0,
    "class_name": "JUnitResultArchiverTest",
    "subclass_name": null,
    "function_name": "repeatedArchivingSlave() throws Exception",
    "function_body": "{\n        doRepeatedArchiving(true);\n    }"
  },
  {
    "id": 53,
    "sub_id": 2,
    "code_id": 0,
    "function_id": 11,
    "human_patch": "https://github.com/jenkinsci/junit-plugin/commit/15f39fc49d9f25bca872badb48e708a8bb815ea7",
    "cve_id": "CVE-2018-1000056",
    "cwe_id": "CWE-918",
    "filename": "src/test/java/hudson/tasks/junit/JUnitResultArchiverTest.java",
    "is_vulnerable": 0,
    "class_name": "JUnitResultArchiverTest",
    "subclass_name": null,
    "function_name": "doRepeatedArchiving(boolean slave) throws Exception",
    "function_body": "{\n        if (slave) {\n            DumbSlave s = j.createOnlineSlave();\n            project.setAssignedLabel(s.getSelfLabel());\n        }\n        project.getPublishersList().removeAll(JUnitResultArchiver.class);\n        project.getBuildersList().add(new SimpleArchive(\"A\", 7, 0));\n        project.getBuildersList().add(new SimpleArchive(\"B\", 0, 1));\n        FreeStyleBuild build = j.assertBuildStatus(Result.UNSTABLE, project.scheduleBuild2(0).get());\n        List<TestResultAction> actions = build.getActions(TestResultAction.class);\n        assertEquals(1, actions.size());\n        TestResultAction testResultAction = actions.get(0);\n        TestResult result = testResultAction.getResult();\n        assertNotNull(\"no TestResult\", result);\n        assertEquals(\"should have 1 failing test\", 1, testResultAction.getFailCount());\n        assertEquals(\"should have 1 failing test\", 1, result.getFailCount());\n        assertEquals(\"should have 8 total tests\", 8, testResultAction.getTotalCount());\n        assertEquals(\"should have 8 total tests\", 8, result.getTotalCount());\n        assertEquals(87, testResultAction.getBuildHealth().getScore());\n    }"
  },
  {
    "id": 53,
    "sub_id": 2,
    "code_id": 0,
    "function_id": 12,
    "human_patch": "https://github.com/jenkinsci/junit-plugin/commit/15f39fc49d9f25bca872badb48e708a8bb815ea7",
    "cve_id": "CVE-2018-1000056",
    "cwe_id": "CWE-918",
    "filename": "src/test/java/hudson/tasks/junit/JUnitResultArchiverTest.java",
    "is_vulnerable": 0,
    "class_name": "JUnitResultArchiverTest",
    "subclass_name": "SimpleArchive",
    "function_name": "perform(AbstractBuild<?, ?> build, Launcher launcher, BuildListener listener) throws InterruptedException, IOException",
    "function_body": "{\n            FilePath ws = build.getWorkspace();\n            OutputStream os = ws.child(name + \".xml\").write();\n            try {\n                PrintWriter pw = new PrintWriter(os);\n                pw.println(\"<testsuite failures=\\\"\" + fail + \"\\\" errors=\\\"0\\\" skipped=\\\"0\\\" tests=\\\"\" + (pass + fail) + \"\\\" name=\\\"\" + name + \"\\\">\");\n                for (int i = 0; i < pass; i++) {\n                    pw.println(\"<testcase classname=\\\"\" + name + \"\\\" name=\\\"passing\" + i + \"\\\"/>\");\n                }\n                for (int i = 0; i < fail; i++) {\n                    pw.println(\"<testcase classname=\\\"\" + name + \"\\\" name=\\\"failing\" + i + \"\\\"><error message=\\\"failure\\\"/></testcase>\");\n                }\n                pw.println(\"</testsuite>\");\n                pw.flush();\n            } finally {\n                os.close();\n            }\n            new JUnitResultArchiver(name + \".xml\").perform(build, ws, launcher, listener);\n            return true;\n        }"
  },
  {
    "id": 53,
    "sub_id": 2,
    "code_id": 0,
    "function_id": 13,
    "human_patch": "https://github.com/jenkinsci/junit-plugin/commit/15f39fc49d9f25bca872badb48e708a8bb815ea7",
    "cve_id": "CVE-2018-1000056",
    "cwe_id": "CWE-918",
    "filename": "src/test/java/hudson/tasks/junit/JUnitResultArchiverTest.java",
    "is_vulnerable": 0,
    "class_name": "JUnitResultArchiverTest",
    "subclass_name": "SimpleArchive",
    "function_name": "isApplicable(Class<? extends AbstractProject> jobType)",
    "function_body": "{\n                return true;\n            }"
  },
  {
    "id": 53,
    "sub_id": 2,
    "code_id": 0,
    "function_id": 14,
    "human_patch": "https://github.com/jenkinsci/junit-plugin/commit/15f39fc49d9f25bca872badb48e708a8bb815ea7",
    "cve_id": "CVE-2018-1000056",
    "cwe_id": "CWE-918",
    "filename": "src/test/java/hudson/tasks/junit/JUnitResultArchiverTest.java",
    "is_vulnerable": 0,
    "class_name": "JUnitResultArchiverTest",
    "subclass_name": "SimpleArchive",
    "function_name": "getDisplayName()",
    "function_body": "{\n                return \"Incremental JUnit result publishing\";\n            }"
  },
  {
    "id": 53,
    "sub_id": 2,
    "code_id": 0,
    "function_id": 15,
    "human_patch": "https://github.com/jenkinsci/junit-plugin/commit/15f39fc49d9f25bca872badb48e708a8bb815ea7",
    "cve_id": "CVE-2018-1000056",
    "cwe_id": "CWE-918",
    "filename": "src/test/java/hudson/tasks/junit/JUnitResultArchiverTest.java",
    "is_vulnerable": 0,
    "class_name": "JUnitResultArchiverTest",
    "subclass_name": null,
    "function_name": "configRoundTrip() throws Exception",
    "function_body": "{\n        JUnitResultArchiver a = new JUnitResultArchiver(\"TEST-*.xml\");\n        a.setKeepLongStdio(true);\n        a.setTestDataPublishers(Collections.<TestDataPublisher>singletonList(new MockTestDataPublisher(\"testing\")));\n        a.setHealthScaleFactor(0.77);\n        a = j.configRoundtrip(a);\n        assertEquals(\"TEST-*.xml\", a.getTestResults());\n        assertTrue(a.isKeepLongStdio());\n        List<? extends TestDataPublisher> testDataPublishers = a.getTestDataPublishers();\n        assertEquals(1, testDataPublishers.size());\n        assertEquals(MockTestDataPublisher.class, testDataPublishers.get(0).getClass());\n        assertEquals(\"testing\", ((MockTestDataPublisher) testDataPublishers.get(0)).getName());\n        assertEquals(0.77, a.getHealthScaleFactor(), 0.01);\n    }"
  },
  {
    "id": 53,
    "sub_id": 2,
    "code_id": 0,
    "function_id": 16,
    "human_patch": "https://github.com/jenkinsci/junit-plugin/commit/15f39fc49d9f25bca872badb48e708a8bb815ea7",
    "cve_id": "CVE-2018-1000056",
    "cwe_id": "CWE-918",
    "filename": "src/test/java/hudson/tasks/junit/JUnitResultArchiverTest.java",
    "is_vulnerable": 0,
    "class_name": "JUnitResultArchiverTest",
    "subclass_name": "MockTestDataPublisher",
    "function_name": "getName()",
    "function_body": "{\n            return name;\n        }"
  },
  {
    "id": 53,
    "sub_id": 2,
    "code_id": 0,
    "function_id": 17,
    "human_patch": "https://github.com/jenkinsci/junit-plugin/commit/15f39fc49d9f25bca872badb48e708a8bb815ea7",
    "cve_id": "CVE-2018-1000056",
    "cwe_id": "CWE-918",
    "filename": "src/test/java/hudson/tasks/junit/JUnitResultArchiverTest.java",
    "is_vulnerable": 0,
    "class_name": "JUnitResultArchiverTest",
    "subclass_name": "MockTestDataPublisher",
    "function_name": "contributeTestData(Run<?,?> run, FilePath workspace, Launcher launcher, TaskListener listener, TestResult testResult) throws IOException, InterruptedException",
    "function_body": "{\n            return null;\n        }"
  },
  {
    "id": 53,
    "sub_id": 2,
    "code_id": 0,
    "function_id": 18,
    "human_patch": "https://github.com/jenkinsci/junit-plugin/commit/15f39fc49d9f25bca872badb48e708a8bb815ea7",
    "cve_id": "CVE-2018-1000056",
    "cwe_id": "CWE-918",
    "filename": "src/test/java/hudson/tasks/junit/JUnitResultArchiverTest.java",
    "is_vulnerable": 0,
    "class_name": "JUnitResultArchiverTest",
    "subclass_name": "MockTestDataPublisher",
    "function_name": "getDisplayName()",
    "function_body": "{\n                return \"MockTestDataPublisher\";\n            }"
  },
  {
    "id": 53,
    "sub_id": 2,
    "code_id": 0,
    "function_id": 19,
    "human_patch": "https://github.com/jenkinsci/junit-plugin/commit/15f39fc49d9f25bca872badb48e708a8bb815ea7",
    "cve_id": "CVE-2018-1000056",
    "cwe_id": "CWE-918",
    "filename": "src/test/java/hudson/tasks/junit/JUnitResultArchiverTest.java",
    "is_vulnerable": 0,
    "class_name": "JUnitResultArchiverTest",
    "subclass_name": null,
    "function_name": "emptyDirectoryAllowEmptyResult() throws Exception",
    "function_body": "{\n        JUnitResultArchiver a = new JUnitResultArchiver(\"TEST-*.xml\");\n        a.setAllowEmptyResults(true);\n        FreeStyleProject freeStyleProject = j.createFreeStyleProject();\n        freeStyleProject.getPublishersList().add(a);\n        j.assertBuildStatus(Result.SUCCESS, freeStyleProject.scheduleBuild2(0).get());\n    }"
  },
  {
    "id": 53,
    "sub_id": 2,
    "code_id": 0,
    "function_id": 20,
    "human_patch": "https://github.com/jenkinsci/junit-plugin/commit/15f39fc49d9f25bca872badb48e708a8bb815ea7",
    "cve_id": "CVE-2018-1000056",
    "cwe_id": "CWE-918",
    "filename": "src/test/java/hudson/tasks/junit/JUnitResultArchiverTest.java",
    "is_vulnerable": 0,
    "class_name": "JUnitResultArchiverTest",
    "subclass_name": null,
    "function_name": "emptyDirectory() throws Exception",
    "function_body": "{\n        JUnitResultArchiver a = new JUnitResultArchiver(\"TEST-*.xml\");\n        a.setAllowEmptyResults(false);\n        FreeStyleProject freeStyleProject = j.createFreeStyleProject();\n        freeStyleProject.getPublishersList().add(a);\n        j.assertBuildStatus(Result.FAILURE, freeStyleProject.scheduleBuild2(0).get());\n    }"
  },
  {
    "id": 53,
    "sub_id": 2,
    "code_id": 0,
    "function_id": 21,
    "human_patch": "https://github.com/jenkinsci/junit-plugin/commit/15f39fc49d9f25bca872badb48e708a8bb815ea7",
    "cve_id": "CVE-2018-1000056",
    "cwe_id": "CWE-918",
    "filename": "src/test/java/hudson/tasks/junit/JUnitResultArchiverTest.java",
    "is_vulnerable": 0,
    "class_name": "JUnitResultArchiverTest",
    "subclass_name": null,
    "function_name": "specialCharsInRelativePath() throws Exception",
    "function_body": "{\n        final String ID_PREFIX = \"test-../a=%3C%7C%23)/testReport/org.twia.vendor/VendorManagerTest/testCreateAdjustingFirm/\";\n        final String EXPECTED = \"org.twia.dao.DAOException: [S2001] Hibernate encountered an error updating Claim [null]\";\n\n        MatrixProject p = j.jenkins.createProject(MatrixProject.class, \"test-\" + j.jenkins.getItems().size());\n        p.setAxes(new AxisList(new TextAxis(\"a\", \"<|#)\")));\n        p.setScm(new SingleFileSCM(\"report.xml\", getClass().getResource(\"junit-report-20090516.xml\")));\n        p.getPublishersList().add(new JUnitResultArchiver(\"report.xml\"));\n\n        MatrixBuild b = p.scheduleBuild2(0).get();\n        j.assertBuildStatus(Result.UNSTABLE, b);\n\n        WebClient wc = j.createWebClient();\n        HtmlPage page = wc.getPage(b, \"testReport\");\n\n        assertThat(page.asText(), not(containsString(EXPECTED)));\n\n        ((HtmlAnchor) page.getElementById(ID_PREFIX + \"-showlink\")).click();\n        wc.waitForBackgroundJavaScript(10000L);\n        assertThat(page.asText(), containsString(EXPECTED));\n\n        ((HtmlAnchor) page.getElementById(ID_PREFIX + \"-hidelink\")).click();\n        wc.waitForBackgroundJavaScript(10000L);\n        assertThat(page.asText(), not(containsString(EXPECTED)));\n    }"
  },
  {
    "id": 53,
    "sub_id": 2,
    "code_id": 0,
    "function_id": 22,
    "human_patch": "https://github.com/jenkinsci/junit-plugin/commit/15f39fc49d9f25bca872badb48e708a8bb815ea7",
    "cve_id": "CVE-2018-1000056",
    "cwe_id": "CWE-918",
    "filename": "src/test/java/hudson/tasks/junit/JUnitResultArchiverTest.java",
    "is_vulnerable": 0,
    "class_name": "JUnitResultArchiverTest",
    "subclass_name": null,
    "function_name": "testDescribableRoundTrip() throws Exception",
    "function_body": "{\n        DescribableModel<JUnitResultArchiver> model = new DescribableModel<JUnitResultArchiver>(JUnitResultArchiver.class);\n        Map<String,Object> args = new TreeMap<String,Object>();\n\n        args.put(\"testResults\", \"**/TEST-*.xml\");\n        JUnitResultArchiver j = model.instantiate(args);\n        assertEquals(\"**/TEST-*.xml\", j.getTestResults());\n        assertFalse(j.isAllowEmptyResults());\n        assertFalse(j.isKeepLongStdio());\n        assertEquals(1.0, j.getHealthScaleFactor(), 0);\n        assertTrue(j.getTestDataPublishers().isEmpty());\n        assertEquals(args, model.uninstantiate(model.instantiate(args)));\n\n        \n        Map<String,Object> describedPublisher = new HashMap<String, Object>();\n        describedPublisher.put(\"$class\", \"MockTestDataPublisher\");\n        describedPublisher.put(\"name\", \"test\");\n        args.put(\"testDataPublishers\", Collections.singletonList(describedPublisher));\n\n        Map<String,Object> described = model.uninstantiate(model.instantiate(args));\n        JUnitResultArchiver j2 = model.instantiate(described);\n        List<TestDataPublisher> testDataPublishers = j2.getTestDataPublishers();\n        assertFalse(testDataPublishers.isEmpty());\n        assertEquals(1, testDataPublishers.size());\n        assertEquals(MockTestDataPublisher.class, testDataPublishers.get(0).getClass());\n        assertEquals(\"test\", ((MockTestDataPublisher)testDataPublishers.get(0)).getName());\n\n        assertEquals(described, model.uninstantiate(model.instantiate(described)));\n    }"
  },
  {
    "id": 54,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 0,
    "human_patch": "https://github.com/jenkinsci/pipeline-build-step-plugin/commit/3dfefdec1f7b2a4ee0ef8902afdea720b1572cb3",
    "cve_id": "CVE-2018-1000089",
    "cwe_id": "CWE-532",
    "filename": "src/main/java/org/jenkinsci/plugins/workflow/support/steps/build/BuildTriggerStepExecution.java",
    "is_vulnerable": 1,
    "class_name": "BuildTriggerStepExecution",
    "subclass_name": null,
    "function_name": "start() throws Exception",
    "function_body": "{\n        String job = step.getJob();\n        Item item = Jenkins.getActiveInstance().getItem(job, invokingRun.getParent(), Item.class);\n        if (item == null) {\n            throw new AbortException(\"No item named \" + job + \" found\");\n        }\n        if (step.getWait() && !(item instanceof Job)) {\n            \n            throw new AbortException(\"Waiting for non-job items is not supported\");\n        }\n        if (item instanceof ParameterizedJobMixIn.ParameterizedJob) {\n            final ParameterizedJobMixIn.ParameterizedJob project = (ParameterizedJobMixIn.ParameterizedJob) item;\n            listener.getLogger().println(\"Scheduling project: \" + ModelHyperlinkNote.encodeTo(project));\n\n            node.addAction(new LabelAction(Messages.BuildTriggerStepExecution_building_(project.getFullDisplayName())));\n            List<Action> actions = new ArrayList<>();\n            if (step.getWait()) {\n                StepContext context = getContext();\n                actions.add(new BuildTriggerAction(context, step.isPropagate()));\n                LOGGER.log(Level.FINER, \"scheduling a build of {0} from {1}\", new Object[]{project, context});\n            }\n            actions.add(new CauseAction(new Cause.UpstreamCause(invokingRun)));\n            List<ParameterValue> parameters = step.getParameters();\n            if (parameters != null) {\n                parameters = completeDefaultParameters(parameters, (Job) project);\n                actions.add(new ParametersAction(parameters));\n            }\n            Integer quietPeriod = step.getQuietPeriod();\n            \n            if (quietPeriod == null) {\n                quietPeriod = project.getQuietPeriod();\n            }\n            QueueTaskFuture<?> f = new ParameterizedJobMixIn() {\n                @Override\n                protected Job asJob() {\n                    return (Job) project;\n                }\n            }.scheduleBuild2(quietPeriod, actions.toArray(new Action[actions.size()]));\n            if (f == null) {\n                throw new AbortException(\"Failed to trigger build of \" + project.getFullName());\n            }\n        } else if (item instanceof Queue.Task){\n            if (step.getParameters() != null && !step.getParameters().isEmpty()) {\n                throw new AbortException(\"Item type does not support parameters\");\n            }\n            Queue.Task task = (Queue.Task) item;\n            listener.getLogger().println(\"Scheduling item: \" + ModelHyperlinkNote.encodeTo(item));\n            node.addAction(new LabelAction(Messages.BuildTriggerStepExecution_building_(task.getFullDisplayName())));\n            List<Action> actions = new ArrayList<>();\n            if (step.getWait()) {\n                StepContext context = getContext();\n                actions.add(new BuildTriggerAction(context, step.isPropagate()));\n                LOGGER.log(Level.FINER, \"scheduling a build of {0} from {1}\", new Object[]{task, context});\n            }\n            actions.add(new CauseAction(new Cause.UpstreamCause(invokingRun)));\n            Integer quietPeriod = step.getQuietPeriod();\n            if (quietPeriod == null) {\n                try {\n                    Method getQuietPeriod = task.getClass().getMethod(\"getQuietPeriod\");\n                    if (getQuietPeriod.getReturnType().equals(int.class)) {\n                        quietPeriod = (Integer) getQuietPeriod.invoke(task);\n                    }\n                } catch (NoSuchMethodException e) {\n                    \n                } catch (IllegalAccessError | IllegalArgumentException | InvocationTargetException e) {\n                    LOGGER.log(Level.WARNING, \"Could not determine quiet period of \" + item.getFullName(), e);\n                }\n            }\n            if (quietPeriod == null) {\n                quietPeriod = Jenkins.getActiveInstance().getQuietPeriod();\n            }\n            ScheduleResult scheduleResult = Jenkins.getActiveInstance().getQueue().schedule2(task, quietPeriod,actions);\n            if (scheduleResult.isRefused()) {\n                throw new AbortException(\"Failed to trigger build of \" + item.getFullName());\n            }\n        } else {\n            throw new AbortException(\"The item named \" + job + \" is a \"\n                    + (item instanceof Describable\n                    ? ((Describable) item).getDescriptor().getDisplayName()\n                    : item.getClass().getName())\n                    + \" which is not something that can be built\");\n        }\n        if (step.getWait()) {\n            return false;\n        } else {\n            getContext().onSuccess(null);\n            return true;\n        }\n    }"
  },
  {
    "id": 54,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 1,
    "human_patch": "https://github.com/jenkinsci/pipeline-build-step-plugin/commit/3dfefdec1f7b2a4ee0ef8902afdea720b1572cb3",
    "cve_id": "CVE-2018-1000089",
    "cwe_id": "CWE-532",
    "filename": "src/main/java/org/jenkinsci/plugins/workflow/support/steps/build/BuildTriggerStepExecution.java",
    "is_vulnerable": 0,
    "class_name": "BuildTriggerStepExecution",
    "subclass_name": null,
    "function_name": "asJob()",
    "function_body": "{\n                    return (Job) project;\n                }"
  },
  {
    "id": 54,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 2,
    "human_patch": "https://github.com/jenkinsci/pipeline-build-step-plugin/commit/3dfefdec1f7b2a4ee0ef8902afdea720b1572cb3",
    "cve_id": "CVE-2018-1000089",
    "cwe_id": "CWE-532",
    "filename": "src/main/java/org/jenkinsci/plugins/workflow/support/steps/build/BuildTriggerStepExecution.java",
    "is_vulnerable": 0,
    "class_name": "BuildTriggerStepExecution",
    "subclass_name": null,
    "function_name": "completeDefaultParameters(List<ParameterValue> parameters, Job<?,?> project)",
    "function_body": "{\n        List<ParameterValue> completeListOfParameters = Lists.newArrayList(parameters);\n        List<String> names = Lists.transform(parameters, new Function<ParameterValue, String>() {\n            @Override public String apply(ParameterValue input) {\n                return input.getName();\n            }\n        });\n        if (project != null) {\n            ParametersDefinitionProperty pdp = project.getProperty(ParametersDefinitionProperty.class);\n            if (pdp != null) {\n                for (ParameterDefinition pDef : pdp.getParameterDefinitions()) {\n                    if (!names.contains(pDef.getName())) {\n                        ParameterValue defaultP = pDef.getDefaultParameterValue();\n                        if (defaultP != null) {\n                            completeListOfParameters.add(defaultP);\n                        }\n                    }\n                }\n            }\n        }\n        return completeListOfParameters;\n    }"
  },
  {
    "id": 54,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 3,
    "human_patch": "https://github.com/jenkinsci/pipeline-build-step-plugin/commit/3dfefdec1f7b2a4ee0ef8902afdea720b1572cb3",
    "cve_id": "CVE-2018-1000089",
    "cwe_id": "CWE-532",
    "filename": "src/main/java/org/jenkinsci/plugins/workflow/support/steps/build/BuildTriggerStepExecution.java",
    "is_vulnerable": 0,
    "class_name": "BuildTriggerStepExecution",
    "subclass_name": null,
    "function_name": "apply(ParameterValue input)",
    "function_body": "{\n                return input.getName();\n            }"
  },
  {
    "id": 54,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 4,
    "human_patch": "https://github.com/jenkinsci/pipeline-build-step-plugin/commit/3dfefdec1f7b2a4ee0ef8902afdea720b1572cb3",
    "cve_id": "CVE-2018-1000089",
    "cwe_id": "CWE-532",
    "filename": "src/main/java/org/jenkinsci/plugins/workflow/support/steps/build/BuildTriggerStepExecution.java",
    "is_vulnerable": 0,
    "class_name": "BuildTriggerStepExecution",
    "subclass_name": null,
    "function_name": "stop(Throwable cause)",
    "function_body": "{\n        StepContext context = getContext();\n        Jenkins jenkins = Jenkins.getInstance();\n        if (jenkins == null) {\n            context.onFailure(cause);\n            return;\n        }\n\n        boolean interrupted = false;\n\n        Queue q = jenkins.getQueue();\n        \n        \n        for (Queue.Item i : q.getItems()) {\n            for (BuildTriggerAction.Trigger trigger : BuildTriggerAction.triggersFor(i)) {\n                if (trigger.context.equals(context)) {\n                    \n                    \n                    \n                    q.cancel(i);\n                    interrupted = true;\n                }\n            }\n        }\n\n        \n        \n        \n        for (Computer c : jenkins.getComputers()) {\n            for (Executor e : c.getExecutors()) {\n                interrupted |= maybeInterrupt(e, cause, context);\n            }\n            for (Executor e : c.getOneOffExecutors()) {\n                interrupted |= maybeInterrupt(e, cause, context);\n            }\n        }\n\n        if (!interrupted) {\n            context.onFailure(cause);\n        }\n    }"
  },
  {
    "id": 54,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 5,
    "human_patch": "https://github.com/jenkinsci/pipeline-build-step-plugin/commit/3dfefdec1f7b2a4ee0ef8902afdea720b1572cb3",
    "cve_id": "CVE-2018-1000089",
    "cwe_id": "CWE-532",
    "filename": "src/main/java/org/jenkinsci/plugins/workflow/support/steps/build/BuildTriggerStepExecution.java",
    "is_vulnerable": 0,
    "class_name": "BuildTriggerStepExecution",
    "subclass_name": null,
    "function_name": "maybeInterrupt(Executor e, Throwable cause, StepContext context)",
    "function_body": "{\n        boolean interrupted = false;\n        Queue.Executable exec = e.getCurrentExecutable();\n        if (exec instanceof Run) {\n            for (BuildTriggerAction.Trigger trigger : BuildTriggerAction.triggersFor((Run) exec)) {\n                if (trigger.context.equals(context)) {\n                    e.interrupt(Result.ABORTED, new BuildTriggerCancelledCause(cause));\n                    trigger.interruption = cause;\n                    try {\n                        ((Run) exec).save();\n                    } catch (IOException x) {\n                        LOGGER.log(Level.WARNING, \"failed to save interrupt cause on \" + exec, x);\n                    }\n                    interrupted = true;\n                }\n            }\n        }\n        return interrupted;\n    }"
  },
  {
    "id": 54,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 6,
    "human_patch": "https://github.com/jenkinsci/pipeline-build-step-plugin/commit/3dfefdec1f7b2a4ee0ef8902afdea720b1572cb3",
    "cve_id": "CVE-2018-1000089",
    "cwe_id": "CWE-532",
    "filename": "src/main/java/org/jenkinsci/plugins/workflow/support/steps/build/BuildTriggerStepExecution.java",
    "is_vulnerable": 0,
    "class_name": "BuildTriggerStepExecution",
    "subclass_name": null,
    "function_name": "getStatus()",
    "function_body": "{\n        for (Queue.Item i : Queue.getInstance().getItems()) {\n            for (BuildTriggerAction.Trigger trigger : BuildTriggerAction.triggersFor(i)) {\n                if (trigger.context.equals(getContext())) {\n                    return \"waiting to schedule \" + i.task.getFullDisplayName() + \"; blocked: \" + i.getWhy();\n                }\n            }\n        }\n        for (Computer c : Jenkins.getActiveInstance().getComputers()) {\n            for (Executor e : c.getExecutors()) {\n                String r = running(e);\n                if (r != null) {\n                    return r;\n                }\n            }\n            for (Executor e : c.getOneOffExecutors()) {\n                String r = running(e);\n                if (r != null) {\n                    return r;\n                }\n            }\n        }\n        \n        return \"unsure what happened to downstream build\";\n    }"
  },
  {
    "id": 54,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 7,
    "human_patch": "https://github.com/jenkinsci/pipeline-build-step-plugin/commit/3dfefdec1f7b2a4ee0ef8902afdea720b1572cb3",
    "cve_id": "CVE-2018-1000089",
    "cwe_id": "CWE-532",
    "filename": "src/main/java/org/jenkinsci/plugins/workflow/support/steps/build/BuildTriggerStepExecution.java",
    "is_vulnerable": 0,
    "class_name": "BuildTriggerStepExecution",
    "subclass_name": null,
    "function_name": "running(@Nonnull Executor e)",
    "function_body": "{\n        Queue.Executable exec = e.getCurrentExecutable();\n        if (exec instanceof Run) {\n            Run<?,?> run = (Run) exec;\n            for (BuildTriggerAction.Trigger trigger : BuildTriggerAction.triggersFor(run)) {\n                if (trigger.context.equals(getContext())) {\n                    return \"running \" + run;\n                }\n            }\n        }\n        return null;\n    }"
  },
  {
    "id": 54,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 0,
    "human_patch": "https://github.com/jenkinsci/pipeline-build-step-plugin/commit/3dfefdec1f7b2a4ee0ef8902afdea720b1572cb3",
    "cve_id": "CVE-2018-1000089",
    "cwe_id": "CWE-532",
    "filename": "src/test/java/org/jenkinsci/plugins/workflow/support/steps/build/BuildTriggerStepTest.java",
    "is_vulnerable": 0,
    "class_name": "BuildTriggerStepTest",
    "subclass_name": null,
    "function_name": "runQuickly() throws IOException",
    "function_body": "{\n        j.jenkins.setQuietPeriod(0);\n    }"
  },
  {
    "id": 54,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 1,
    "human_patch": "https://github.com/jenkinsci/pipeline-build-step-plugin/commit/3dfefdec1f7b2a4ee0ef8902afdea720b1572cb3",
    "cve_id": "CVE-2018-1000089",
    "cwe_id": "CWE-532",
    "filename": "src/test/java/org/jenkinsci/plugins/workflow/support/steps/build/BuildTriggerStepTest.java",
    "is_vulnerable": 0,
    "class_name": "BuildTriggerStepTest",
    "subclass_name": null,
    "function_name": "buildTopLevelProject() throws Exception",
    "function_body": "{\n        FreeStyleProject ds = j.createFreeStyleProject(\"ds\");\n        WorkflowJob us = j.jenkins.createProject(WorkflowJob.class, \"us\");\n        us.setDefinition(new CpsFlowDefinition(\n            \"def ds = build 'ds'\\n\" +\n            \"echo \\\"ds.result=${ds.result} ds.number=${ds.number}\\\"\", true));\n        j.assertLogContains(\"ds.result=SUCCESS ds.number=1\", j.buildAndAssertSuccess(us));\n        \n        \n        ds.getBuildByNumber(1).delete();\n    }"
  },
  {
    "id": 54,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 2,
    "human_patch": "https://github.com/jenkinsci/pipeline-build-step-plugin/commit/3dfefdec1f7b2a4ee0ef8902afdea720b1572cb3",
    "cve_id": "CVE-2018-1000089",
    "cwe_id": "CWE-532",
    "filename": "src/test/java/org/jenkinsci/plugins/workflow/support/steps/build/BuildTriggerStepTest.java",
    "is_vulnerable": 0,
    "class_name": "BuildTriggerStepTest",
    "subclass_name": null,
    "function_name": "failingBuild() throws Exception",
    "function_body": "{\n        j.createFreeStyleProject(\"ds\").getBuildersList().add(new FailureBuilder());\n        WorkflowJob us = j.jenkins.createProject(WorkflowJob.class, \"us\");\n        us.setDefinition(new CpsFlowDefinition(\"build 'ds'\", true));\n        j.assertBuildStatus(Result.FAILURE, us.scheduleBuild2(0));\n        us.setDefinition(new CpsFlowDefinition(\"echo \\\"ds.result=${build(job: 'ds', propagate: false).result}\\\"\", true));\n        j.assertLogContains(\"ds.result=FAILURE\", j.buildAndAssertSuccess(us));\n    }"
  },
  {
    "id": 54,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 3,
    "human_patch": "https://github.com/jenkinsci/pipeline-build-step-plugin/commit/3dfefdec1f7b2a4ee0ef8902afdea720b1572cb3",
    "cve_id": "CVE-2018-1000089",
    "cwe_id": "CWE-532",
    "filename": "src/test/java/org/jenkinsci/plugins/workflow/support/steps/build/BuildTriggerStepTest.java",
    "is_vulnerable": 0,
    "class_name": "BuildTriggerStepTest",
    "subclass_name": null,
    "function_name": "buildFolderProject() throws Exception",
    "function_body": "{\n        MockFolder dir1 = j.createFolder(\"dir1\");\n        FreeStyleProject downstream = dir1.createProject(FreeStyleProject.class, \"downstream\");\n        downstream.getBuildersList().add(new SleepBuilder(1));\n\n        MockFolder dir2 = j.createFolder(\"dir2\");\n        WorkflowJob upstream = dir2.createProject(WorkflowJob.class, \"upstream\");\n        upstream.setDefinition(new CpsFlowDefinition(\"build '../dir1/downstream'\"));\n\n        j.buildAndAssertSuccess(upstream);\n        assertEquals(1, downstream.getBuilds().size());\n    }"
  },
  {
    "id": 54,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 4,
    "human_patch": "https://github.com/jenkinsci/pipeline-build-step-plugin/commit/3dfefdec1f7b2a4ee0ef8902afdea720b1572cb3",
    "cve_id": "CVE-2018-1000089",
    "cwe_id": "CWE-532",
    "filename": "src/test/java/org/jenkinsci/plugins/workflow/support/steps/build/BuildTriggerStepTest.java",
    "is_vulnerable": 0,
    "class_name": "BuildTriggerStepTest",
    "subclass_name": null,
    "function_name": "buildParallelTests() throws Exception",
    "function_body": "{\n        FreeStyleProject p1 = j.createFreeStyleProject(\"test1\");\n        p1.getBuildersList().add(new SleepBuilder(1));\n\n        FreeStyleProject p2 = j.createFreeStyleProject(\"test2\");\n        p2.getBuildersList().add(new SleepBuilder(1));\n\n        WorkflowJob foo = j.jenkins.createProject(WorkflowJob.class, \"foo\");\n        foo.setDefinition(new CpsFlowDefinition(StringUtils.join(Arrays.asList(\"parallel(test1: {\\n\" +\n                \"          build('test1');\\n\" +\n                \"        }, test2: {\\n\" +\n                \"          build('test2');\\n\" +\n                \"        })\"), \"\\n\"), true));\n\n        j.buildAndAssertSuccess(foo);\n    }"
  },
  {
    "id": 54,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 5,
    "human_patch": "https://github.com/jenkinsci/pipeline-build-step-plugin/commit/3dfefdec1f7b2a4ee0ef8902afdea720b1572cb3",
    "cve_id": "CVE-2018-1000089",
    "cwe_id": "CWE-532",
    "filename": "src/test/java/org/jenkinsci/plugins/workflow/support/steps/build/BuildTriggerStepTest.java",
    "is_vulnerable": 0,
    "class_name": "BuildTriggerStepTest",
    "subclass_name": null,
    "function_name": "abortBuild() throws Exception",
    "function_body": "{\n        FreeStyleProject p = j.createFreeStyleProject(\"test1\");\n        p.getBuildersList().add(new SleepBuilder(Long.MAX_VALUE));\n\n        WorkflowJob foo = j.jenkins.createProject(WorkflowJob.class, \"foo\");\n        foo.setDefinition(new CpsFlowDefinition(StringUtils.join(Arrays.asList(\"build('test1');\"), \"\\n\")));\n\n        QueueTaskFuture<WorkflowRun> q = foo.scheduleBuild2(0);\n        WorkflowRun b = q.getStartCondition().get();\n\n        CpsFlowExecution e = (CpsFlowExecution) b.getExecutionPromise().get();\n        e.waitForSuspension();\n\n        FreeStyleBuild fb=null;\n        while (fb==null) {\n            fb = p.getBuildByNumber(1);\n            Thread.sleep(10);\n        }\n        fb.getExecutor().interrupt();\n\n        j.assertBuildStatus(Result.ABORTED, j.waitForCompletion(fb));\n        j.assertBuildStatus(Result.FAILURE,q.get());\n    }"
  },
  {
    "id": 54,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 6,
    "human_patch": "https://github.com/jenkinsci/pipeline-build-step-plugin/commit/3dfefdec1f7b2a4ee0ef8902afdea720b1572cb3",
    "cve_id": "CVE-2018-1000089",
    "cwe_id": "CWE-532",
    "filename": "src/test/java/org/jenkinsci/plugins/workflow/support/steps/build/BuildTriggerStepTest.java",
    "is_vulnerable": 0,
    "class_name": "BuildTriggerStepTest",
    "subclass_name": null,
    "function_name": "cancelBuildQueue() throws Exception",
    "function_body": "{\n        FreeStyleProject p = j.createFreeStyleProject(\"test1\");\n        p.getBuildersList().add(new SleepBuilder(Long.MAX_VALUE));\n\n        WorkflowJob foo = j.jenkins.createProject(WorkflowJob.class, \"foo\");\n        foo.setDefinition(new CpsFlowDefinition(StringUtils.join(Arrays.asList(\"build('test1');\"), \"\\n\")));\n\n        j.jenkins.setNumExecutors(0); \n\n        QueueTaskFuture<WorkflowRun> q = foo.scheduleBuild2(0);\n\n        WorkflowRun b = q.getStartCondition().get();\n        CpsFlowExecution e = (CpsFlowExecution) b.getExecutionPromise().get();\n        e.waitForSuspension();\n\n        Queue.Item[] items = j.jenkins.getQueue().getItems();\n        assertEquals(1, items.length);\n        j.jenkins.getQueue().cancel(items[0]);\n\n        j.assertBuildStatus(Result.FAILURE,q.get());\n    }"
  },
  {
    "id": 54,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 7,
    "human_patch": "https://github.com/jenkinsci/pipeline-build-step-plugin/commit/3dfefdec1f7b2a4ee0ef8902afdea720b1572cb3",
    "cve_id": "CVE-2018-1000089",
    "cwe_id": "CWE-532",
    "filename": "src/test/java/org/jenkinsci/plugins/workflow/support/steps/build/BuildTriggerStepTest.java",
    "is_vulnerable": 0,
    "class_name": "BuildTriggerStepTest",
    "subclass_name": null,
    "function_name": "interruptFlow() throws Exception",
    "function_body": "{\n        FreeStyleProject ds1 = j.createFreeStyleProject(\"ds1\");\n        ds1.getBuildersList().add(new SleepBuilder(Long.MAX_VALUE));\n        FreeStyleProject ds2 = j.createFreeStyleProject(\"ds2\");\n        ds2.getBuildersList().add(new SleepBuilder(Long.MAX_VALUE));\n        FreeStyleProject ds3 = j.createFreeStyleProject(\"ds3\");\n        ds3.getBuildersList().add(new SleepBuilder(Long.MAX_VALUE));\n        WorkflowJob us = j.jenkins.createProject(WorkflowJob.class, \"us\");\n        us.setDefinition(new CpsFlowDefinition(\"parallel ds1: {build 'ds1'}, ds23: {parallel ds2: {build 'ds2'}, ds3: {build 'ds3'}}\", true));\n        j.jenkins.setNumExecutors(3);\n        j.jenkins.setNodes(j.jenkins.getNodes()); \n        WorkflowRun usb = us.scheduleBuild2(0).getStartCondition().get();\n        assertEquals(1, usb.getNumber());\n        FreeStyleBuild ds1b, ds2b, ds3b;\n        while ((ds1b = ds1.getLastBuild()) == null || (ds2b = ds2.getLastBuild()) == null || (ds3b = ds3.getLastBuild()) == null) {\n            Thread.sleep(100);\n        }\n        assertEquals(1, ds1b.getNumber());\n        assertEquals(1, ds2b.getNumber());\n        assertEquals(1, ds3b.getNumber());\n        \n        \n        \n        usb.doStop();\n        j.assertBuildStatus(Result.ABORTED, j.waitForCompletion(usb));\n        j.assertBuildStatus(Result.ABORTED, j.waitForCompletion(ds1b));\n        j.assertBuildStatus(Result.ABORTED, j.waitForCompletion(ds2b));\n        j.assertBuildStatus(Result.ABORTED, j.waitForCompletion(ds3b));\n    }"
  },
  {
    "id": 54,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 8,
    "human_patch": "https://github.com/jenkinsci/pipeline-build-step-plugin/commit/3dfefdec1f7b2a4ee0ef8902afdea720b1572cb3",
    "cve_id": "CVE-2018-1000089",
    "cwe_id": "CWE-532",
    "filename": "src/test/java/org/jenkinsci/plugins/workflow/support/steps/build/BuildTriggerStepTest.java",
    "is_vulnerable": 0,
    "class_name": "BuildTriggerStepTest",
    "subclass_name": null,
    "function_name": "interruptFlowDownstreamFlow() throws Exception",
    "function_body": "{\n        WorkflowJob ds = j.jenkins.createProject(WorkflowJob.class, \"ds\");\n        ds.setDefinition(new CpsFlowDefinition(\"semaphore 'ds'\", true));\n        WorkflowJob us = j.jenkins.createProject(WorkflowJob.class, \"us\");\n        us.setDefinition(new CpsFlowDefinition(\"build 'ds'\", true));\n        WorkflowRun usb = us.scheduleBuild2(0).getStartCondition().get();\n        assertEquals(1, usb.getNumber());\n        SemaphoreStep.waitForStart(\"ds/1\", null);\n        WorkflowRun dsb = ds.getLastBuild();\n        assertEquals(1, dsb.getNumber());\n        usb.doStop();\n        j.assertBuildStatus(Result.ABORTED, j.waitForCompletion(usb));\n        j.assertBuildStatus(Result.ABORTED, j.waitForCompletion(dsb));\n    }"
  },
  {
    "id": 54,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 9,
    "human_patch": "https://github.com/jenkinsci/pipeline-build-step-plugin/commit/3dfefdec1f7b2a4ee0ef8902afdea720b1572cb3",
    "cve_id": "CVE-2018-1000089",
    "cwe_id": "CWE-532",
    "filename": "src/test/java/org/jenkinsci/plugins/workflow/support/steps/build/BuildTriggerStepTest.java",
    "is_vulnerable": 0,
    "class_name": "BuildTriggerStepTest",
    "subclass_name": null,
    "function_name": "interruptFlowNonPropagate() throws Exception",
    "function_body": "{\n        WorkflowJob ds = j.jenkins.createProject(WorkflowJob.class, \"ds\");\n        ds.setDefinition(new CpsFlowDefinition(\"semaphore 'ds'\", true));\n        WorkflowJob us = j.jenkins.createProject(WorkflowJob.class, \"us\");\n        us.setDefinition(new CpsFlowDefinition(\"while (true) {build job: 'ds', propagate: false}\", true));\n        WorkflowRun usb = us.scheduleBuild2(0).getStartCondition().get();\n        assertEquals(1, usb.getNumber());\n        SemaphoreStep.waitForStart(\"ds/1\", null);\n        WorkflowRun dsb = ds.getLastBuild();\n        assertEquals(1, dsb.getNumber());\n        usb.doStop();\n        j.assertBuildStatus(Result.ABORTED, j.waitForCompletion(usb));\n        j.assertBuildStatus(Result.ABORTED, j.waitForCompletion(dsb));\n    }"
  },
  {
    "id": 54,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 10,
    "human_patch": "https://github.com/jenkinsci/pipeline-build-step-plugin/commit/3dfefdec1f7b2a4ee0ef8902afdea720b1572cb3",
    "cve_id": "CVE-2018-1000089",
    "cwe_id": "CWE-532",
    "filename": "src/test/java/org/jenkinsci/plugins/workflow/support/steps/build/BuildTriggerStepTest.java",
    "is_vulnerable": 0,
    "class_name": "BuildTriggerStepTest",
    "subclass_name": null,
    "function_name": "triggerWorkflow() throws Exception",
    "function_body": "{\n        WorkflowJob us = j.jenkins.createProject(WorkflowJob.class, \"us\");\n        us.setDefinition(new CpsFlowDefinition(\"build 'ds'\"));\n        WorkflowJob ds = j.jenkins.createProject(WorkflowJob.class, \"ds\");\n        ds.setDefinition(new CpsFlowDefinition(\"echo 'OK'\"));\n        j.buildAndAssertSuccess(us);\n        assertEquals(1, ds.getBuilds().size());\n    }"
  },
  {
    "id": 54,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 11,
    "human_patch": "https://github.com/jenkinsci/pipeline-build-step-plugin/commit/3dfefdec1f7b2a4ee0ef8902afdea720b1572cb3",
    "cve_id": "CVE-2018-1000089",
    "cwe_id": "CWE-532",
    "filename": "src/test/java/org/jenkinsci/plugins/workflow/support/steps/build/BuildTriggerStepTest.java",
    "is_vulnerable": 0,
    "class_name": "BuildTriggerStepTest",
    "subclass_name": null,
    "function_name": "parameters() throws Exception",
    "function_body": "{\n        WorkflowJob us = j.jenkins.createProject(WorkflowJob.class, \"us\");\n        FreeStyleProject ds = j.jenkins.createProject(FreeStyleProject.class, \"ds\");\n        ds.addProperty(new ParametersDefinitionProperty(new StringParameterDefinition(\"branch\", \"master\"), new BooleanParameterDefinition(\"extra\", false, null)));\n        CaptureEnvironmentBuilder env = new CaptureEnvironmentBuilder();\n        ds.getBuildersList().add(env);\n        us.setDefinition(new CpsFlowDefinition(\"build 'ds'\"));\n        WorkflowRun us1 = j.buildAndAssertSuccess(us);\n        assertEquals(\"1\", env.getEnvVars().get(\"BUILD_NUMBER\"));\n        assertEquals(\"master\", env.getEnvVars().get(\"branch\"));\n        assertEquals(\"false\", env.getEnvVars().get(\"extra\"));\n        Cause.UpstreamCause cause = ds.getBuildByNumber(1).getCause(Cause.UpstreamCause.class);\n        assertNotNull(cause);\n        assertEquals(us1, cause.getUpstreamRun());\n        us.setDefinition(new CpsFlowDefinition(\"build job: 'ds', parameters: [[$class: 'StringParameterValue', name: 'branch', value: 'release']]\", true));\n        j.buildAndAssertSuccess(us);\n        assertEquals(\"2\", env.getEnvVars().get(\"BUILD_NUMBER\"));\n        assertEquals(\"release\", env.getEnvVars().get(\"branch\"));\n        assertEquals(\"false\", env.getEnvVars().get(\"extra\")); \n        us.setDefinition(new CpsFlowDefinition(\"build job: 'ds', parameters: [[$class: 'StringParameterValue', name: 'branch', value: 'release'], [$class: 'BooleanParameterValue', name: 'extra', value: true]]\", true));\n        j.buildAndAssertSuccess(us);\n        assertEquals(\"3\", env.getEnvVars().get(\"BUILD_NUMBER\"));\n        assertEquals(\"release\", env.getEnvVars().get(\"branch\"));\n        assertEquals(\"true\", env.getEnvVars().get(\"extra\"));\n    }"
  },
  {
    "id": 54,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 12,
    "human_patch": "https://github.com/jenkinsci/pipeline-build-step-plugin/commit/3dfefdec1f7b2a4ee0ef8902afdea720b1572cb3",
    "cve_id": "CVE-2018-1000089",
    "cwe_id": "CWE-532",
    "filename": "src/test/java/org/jenkinsci/plugins/workflow/support/steps/build/BuildTriggerStepTest.java",
    "is_vulnerable": 0,
    "class_name": "BuildTriggerStepTest",
    "subclass_name": null,
    "function_name": "noWait() throws Exception",
    "function_body": "{\n        j.createFreeStyleProject(\"ds\").setAssignedLabel(Label.get(\"nonexistent\"));\n        WorkflowJob us = j.jenkins.createProject(WorkflowJob.class, \"us\");\n        us.setDefinition(new CpsFlowDefinition(\"build job: 'ds', wait: false\"));\n        j.buildAndAssertSuccess(us);\n    }"
  },
  {
    "id": 54,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 13,
    "human_patch": "https://github.com/jenkinsci/pipeline-build-step-plugin/commit/3dfefdec1f7b2a4ee0ef8902afdea720b1572cb3",
    "cve_id": "CVE-2018-1000089",
    "cwe_id": "CWE-532",
    "filename": "src/test/java/org/jenkinsci/plugins/workflow/support/steps/build/BuildTriggerStepTest.java",
    "is_vulnerable": 0,
    "class_name": "BuildTriggerStepTest",
    "subclass_name": null,
    "function_name": "rejectedStart() throws Exception",
    "function_body": "{\n        j.createFreeStyleProject(\"ds\");\n        WorkflowJob us = j.jenkins.createProject(WorkflowJob.class, \"us\");\n        \n        us.setDefinition(new CpsFlowDefinition(\"build job: 'ds', wait: false\"));\n        j.assertLogContains(\"Failed to trigger build of ds\", j.assertBuildStatus(Result.FAILURE, us.scheduleBuild2(0)));\n    }"
  },
  {
    "id": 54,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 14,
    "human_patch": "https://github.com/jenkinsci/pipeline-build-step-plugin/commit/3dfefdec1f7b2a4ee0ef8902afdea720b1572cb3",
    "cve_id": "CVE-2018-1000089",
    "cwe_id": "CWE-532",
    "filename": "src/test/java/org/jenkinsci/plugins/workflow/support/steps/build/BuildTriggerStepTest.java",
    "is_vulnerable": 0,
    "class_name": "BuildTriggerStepTest",
    "subclass_name": "QDH",
    "function_name": "shouldSchedule(Queue.Task p, List<Action> actions)",
    "function_body": "{\n            return p instanceof WorkflowJob; \n        }"
  },
  {
    "id": 54,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 15,
    "human_patch": "https://github.com/jenkinsci/pipeline-build-step-plugin/commit/3dfefdec1f7b2a4ee0ef8902afdea720b1572cb3",
    "cve_id": "CVE-2018-1000089",
    "cwe_id": "CWE-532",
    "filename": "src/test/java/org/jenkinsci/plugins/workflow/support/steps/build/BuildTriggerStepTest.java",
    "is_vulnerable": 0,
    "class_name": "BuildTriggerStepTest",
    "subclass_name": null,
    "function_name": "buildVariables() throws Exception",
    "function_body": "{\n        j.createFreeStyleProject(\"ds\").addProperty(new ParametersDefinitionProperty(new StringParameterDefinition(\"param\", \"default\")));\n        WorkflowJob us = j.jenkins.createProject(WorkflowJob.class, \"us\");\n        us.setDefinition(new CpsFlowDefinition(\"echo \\\"build var: ${build(job: 'ds', parameters: [[$class: 'StringParameterValue', name: 'param', value: 'override']]).buildVariables.param}\\\"\", true));\n        j.assertLogContains(\"build var: override\", j.buildAndAssertSuccess(us));\n    }"
  },
  {
    "id": 54,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 16,
    "human_patch": "https://github.com/jenkinsci/pipeline-build-step-plugin/commit/3dfefdec1f7b2a4ee0ef8902afdea720b1572cb3",
    "cve_id": "CVE-2018-1000089",
    "cwe_id": "CWE-532",
    "filename": "src/test/java/org/jenkinsci/plugins/workflow/support/steps/build/BuildTriggerStepTest.java",
    "is_vulnerable": 0,
    "class_name": "BuildTriggerStepTest",
    "subclass_name": null,
    "function_name": "buildVariablesWorkflow() throws Exception",
    "function_body": "{\n        WorkflowJob ds = j.jenkins.createProject(WorkflowJob.class, \"ds\");\n        ds.setDefinition(new CpsFlowDefinition(\"env.RESULT = \\\"ds-${env.BUILD_NUMBER}\\\"\", true));\n        WorkflowJob us = j.jenkins.createProject(WorkflowJob.class, \"us\");\n        us.setDefinition(new CpsFlowDefinition(\"def vars = build('ds').buildVariables; echo \\\"received RESULT=${vars.RESULT} vs. BUILD_NUMBER=${vars.BUILD_NUMBER}\\\"\", true));\n        j.assertLogContains(\"received RESULT=ds-1 vs. BUILD_NUMBER=null\", j.buildAndAssertSuccess(us));\n        ds.getBuildByNumber(1).delete();\n    }"
  },
  {
    "id": 54,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 17,
    "human_patch": "https://github.com/jenkinsci/pipeline-build-step-plugin/commit/3dfefdec1f7b2a4ee0ef8902afdea720b1572cb3",
    "cve_id": "CVE-2018-1000089",
    "cwe_id": "CWE-532",
    "filename": "src/test/java/org/jenkinsci/plugins/workflow/support/steps/build/BuildTriggerStepTest.java",
    "is_vulnerable": 0,
    "class_name": "BuildTriggerStepTest",
    "subclass_name": null,
    "function_name": "coalescedQueue() throws Exception",
    "function_body": "{\n        FreeStyleProject ds = j.createFreeStyleProject(\"ds\");\n        ds.setConcurrentBuild(true);\n        ds.getBuildersList().add(new SleepBuilder(3000));\n        WorkflowJob us = j.jenkins.createProject(WorkflowJob.class, \"us\");\n        us.setDefinition(new CpsFlowDefinition(\"echo \\\"triggered #${build('ds').number}\\\"\", true));\n        QueueTaskFuture<WorkflowRun> us1F = us.scheduleBuild2(0);\n        us1F.waitForStart(); \n        QueueTaskFuture<WorkflowRun> us2F = us.scheduleBuild2(0);\n        WorkflowRun us1 = us1F.get();\n        assertEquals(1, us1.getNumber());\n        j.assertLogContains(\"triggered #1\", us1);\n        WorkflowRun us2 = us2F.get();\n        assertEquals(2, us2.getNumber());\n        j.assertLogContains(\"triggered #1\", us2);\n        FreeStyleBuild ds1 = ds.getLastBuild();\n        assertEquals(1, ds1.getNumber());\n        assertEquals(2, ds1.getCauses().size()); \n    }"
  },
  {
    "id": 54,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 18,
    "human_patch": "https://github.com/jenkinsci/pipeline-build-step-plugin/commit/3dfefdec1f7b2a4ee0ef8902afdea720b1572cb3",
    "cve_id": "CVE-2018-1000089",
    "cwe_id": "CWE-532",
    "filename": "src/test/java/org/jenkinsci/plugins/workflow/support/steps/build/BuildTriggerStepTest.java",
    "is_vulnerable": 0,
    "class_name": "BuildTriggerStepTest",
    "subclass_name": null,
    "function_name": "nonCoalescedQueueParallel() throws Exception",
    "function_body": "{\n        j.jenkins.setNumExecutors(5);\n        FreeStyleProject ds = j.createFreeStyleProject(\"ds\");\n        ds.setConcurrentBuild(true);\n        ds.addProperty(new ParametersDefinitionProperty(new StringParameterDefinition(\"which\", null)));\n        ds.getBuildersList().add(new SleepBuilder(3000));\n        WorkflowJob us = j.jenkins.createProject(WorkflowJob.class, \"us\");\n        us.setDefinition(new CpsFlowDefinition(\n            \"def branches = [:]\\n\" +\n            \"for (int i = 0; i < 5; i++) {\\n\" +\n            \"  def which = \\\"${i}\\\"\\n\" +\n            \"  branches[\\\"branch${i}\\\"] = {\\n\" +\n            \"    build job: 'ds', parameters: [[$class: 'StringParameterValue', name: 'which', value: which]]\\n\" +\n            \"  }\\n\" +\n            \"}\\n\" +\n            \"parallel branches\", true));\n        j.buildAndAssertSuccess(us);\n        FreeStyleBuild ds1 = ds.getLastBuild();\n        assertEquals(5, ds1.getNumber());\n    }"
  },
  {
    "id": 54,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 19,
    "human_patch": "https://github.com/jenkinsci/pipeline-build-step-plugin/commit/3dfefdec1f7b2a4ee0ef8902afdea720b1572cb3",
    "cve_id": "CVE-2018-1000089",
    "cwe_id": "CWE-532",
    "filename": "src/test/java/org/jenkinsci/plugins/workflow/support/steps/build/BuildTriggerStepTest.java",
    "is_vulnerable": 0,
    "class_name": "BuildTriggerStepTest",
    "subclass_name": null,
    "function_name": "raceCondition() throws Exception",
    "function_body": "{\n        logging.record(BuildTriggerStepExecution.class.getPackage().getName(), Level.FINE).record(Queue.class, Level.FINE).record(Executor.class, Level.FINE);\n        j.jenkins.setQuietPeriod(0);\n        WorkflowJob ds = j.jenkins.createProject(WorkflowJob.class, \"ds\");\n        ds.setDefinition(new CpsFlowDefinition(\"sleep 1\", true));\n        WorkflowJob us = j.jenkins.createProject(WorkflowJob.class, \"us\");\n        us.setDefinition(new CpsFlowDefinition(\"def rebuild() {for (int i = 0; i < 20; i++) {build 'ds'}}; parallel A: {rebuild()}, B: {rebuild()}, C: {rebuild()}\", true));\n        j.buildAndAssertSuccess(us);\n    }"
  },
  {
    "id": 54,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 20,
    "human_patch": "https://github.com/jenkinsci/pipeline-build-step-plugin/commit/3dfefdec1f7b2a4ee0ef8902afdea720b1572cb3",
    "cve_id": "CVE-2018-1000089",
    "cwe_id": "CWE-532",
    "filename": "src/test/java/org/jenkinsci/plugins/workflow/support/steps/build/BuildTriggerStepTest.java",
    "is_vulnerable": 0,
    "class_name": "BuildTriggerStepTest",
    "subclass_name": null,
    "function_name": "defaultParameters() throws Exception",
    "function_body": "{\n        WorkflowJob us = j.jenkins.createProject(WorkflowJob.class, \"us\");\n        us.setDefinition(new CpsFlowDefinition(\"build job: 'ds', parameters: [[$class: 'StringParameterValue', name: 'PARAM1', value: 'first']] \"));\n        WorkflowJob ds = j.jenkins.createProject(WorkflowJob.class, \"ds\");\n        ds.addProperty(new ParametersDefinitionProperty(new StringParameterDefinition(\"PARAM1\", \"p1\"), new StringParameterDefinition(\"PARAM2\", \"p2\")));\n        \n        ds.setDefinition(new CpsFlowDefinition(\"echo \\\"${PARAM1} - ${PARAM2}\\\"\"));\n        j.buildAndAssertSuccess(us);\n        j.assertLogContains(\"first - p2\", ds.getLastBuild());\n    }"
  },
  {
    "id": 54,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 21,
    "human_patch": "https://github.com/jenkinsci/pipeline-build-step-plugin/commit/3dfefdec1f7b2a4ee0ef8902afdea720b1572cb3",
    "cve_id": "CVE-2018-1000089",
    "cwe_id": "CWE-532",
    "filename": "src/test/java/org/jenkinsci/plugins/workflow/support/steps/build/BuildTriggerStepTest.java",
    "is_vulnerable": 0,
    "class_name": "BuildTriggerStepTest",
    "subclass_name": null,
    "function_name": "storedForm() throws Exception",
    "function_body": "{\n        WorkflowJob us = j.jenkins.getItemByFullName(\"us\", WorkflowJob.class);\n        WorkflowRun us1 = us.getBuildByNumber(1);\n        WorkflowJob ds = j.jenkins.getItemByFullName(\"ds\", WorkflowJob.class);\n        WorkflowRun ds1 = ds.getBuildByNumber(1);\n        ds1.setDescription(\"something\");\n        j.assertBuildStatusSuccess(j.waitForCompletion(ds1));\n        j.assertBuildStatusSuccess(j.waitForCompletion(us1));\n    }"
  },
  {
    "id": 54,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 22,
    "human_patch": "https://github.com/jenkinsci/pipeline-build-step-plugin/commit/3dfefdec1f7b2a4ee0ef8902afdea720b1572cb3",
    "cve_id": "CVE-2018-1000089",
    "cwe_id": "CWE-532",
    "filename": "src/test/java/org/jenkinsci/plugins/workflow/support/steps/build/BuildTriggerStepTest.java",
    "is_vulnerable": 0,
    "class_name": "BuildTriggerStepTest",
    "subclass_name": null,
    "function_name": "triggerOrgFolder() throws Exception",
    "function_body": "{\n        try (MockSCMController c = MockSCMController.create()) {\n            c.createRepository(\"foo\");\n            WorkflowJob us = j.jenkins.createProject(WorkflowJob.class, \"us\");\n            us.setDefinition(new CpsFlowDefinition(\"build job:'ds', wait:false\"));\n            OrganizationFolder ds = j.jenkins.createProject(OrganizationFolder.class, \"ds\");\n            ds.getSCMNavigators().add(new MockSCMNavigator(c, true, false, false));\n            ds.getProjectFactories().add(new DummyMultiBranchProjectFactory());\n            j.waitUntilNoActivity();\n            assertThat(ds.getComputation().getResult(), nullValue());\n            j.buildAndAssertSuccess(us);\n            j.waitUntilNoActivity();\n            assertThat(ds.getComputation().getResult(), notNullValue());\n        }\n    }"
  },
  {
    "id": 54,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 23,
    "human_patch": "https://github.com/jenkinsci/pipeline-build-step-plugin/commit/3dfefdec1f7b2a4ee0ef8902afdea720b1572cb3",
    "cve_id": "CVE-2018-1000089",
    "cwe_id": "CWE-532",
    "filename": "src/test/java/org/jenkinsci/plugins/workflow/support/steps/build/BuildTriggerStepTest.java",
    "is_vulnerable": 0,
    "class_name": "BuildTriggerStepTest",
    "subclass_name": "DummyMultiBranchProjectFactory",
    "function_name": "recognizes(@NonNull ItemGroup<?> parent, @NonNull String name,\n                                  @NonNull List<? extends SCMSource> scmSources,\n                                  @NonNull Map<String, Object> attributes,\n                                  @CheckForNull SCMHeadEvent<?> event, @NonNull TaskListener listener) throws IOException, InterruptedException",
    "function_body": "{\n            return false;\n        }"
  },
  {
    "id": 54,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 24,
    "human_patch": "https://github.com/jenkinsci/pipeline-build-step-plugin/commit/3dfefdec1f7b2a4ee0ef8902afdea720b1572cb3",
    "cve_id": "CVE-2018-1000089",
    "cwe_id": "CWE-532",
    "filename": "src/test/java/org/jenkinsci/plugins/workflow/support/steps/build/BuildTriggerStepTest.java",
    "is_vulnerable": 0,
    "class_name": "BuildTriggerStepTest",
    "subclass_name": "DummyMultiBranchProjectFactory",
    "function_name": "newInstance()",
    "function_body": "{\n                return new DummyMultiBranchProjectFactory();\n            }"
  },
  {
    "id": 55,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 0,
    "human_patch": "https://github.com/jenkinsci/subversion-plugin/commit/25f6afbb02a5863f363b0a2f664ac717ace743b4",
    "cve_id": "CVE-2018-1000111",
    "cwe_id": "CWE-863",
    "filename": "src/main/java/hudson/scm/SubversionRepositoryStatus.java",
    "is_vulnerable": 0,
    "class_name": "SubversionRepositoryStatus",
    "subclass_name": null,
    "function_name": "getDisplayName()",
    "function_body": "{\n        return uuid.toString();\n    }"
  },
  {
    "id": 55,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 1,
    "human_patch": "https://github.com/jenkinsci/subversion-plugin/commit/25f6afbb02a5863f363b0a2f664ac717ace743b4",
    "cve_id": "CVE-2018-1000111",
    "cwe_id": "CWE-863",
    "filename": "src/main/java/hudson/scm/SubversionRepositoryStatus.java",
    "is_vulnerable": 0,
    "class_name": "SubversionRepositoryStatus",
    "subclass_name": null,
    "function_name": "getSearchUrl()",
    "function_body": "{\n        return uuid.toString();\n    }"
  },
  {
    "id": 55,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 2,
    "human_patch": "https://github.com/jenkinsci/subversion-plugin/commit/25f6afbb02a5863f363b0a2f664ac717ace743b4",
    "cve_id": "CVE-2018-1000111",
    "cwe_id": "CWE-863",
    "filename": "src/main/java/hudson/scm/SubversionRepositoryStatus.java",
    "is_vulnerable": 0,
    "class_name": "SubversionRepositoryStatus",
    "subclass_name": "JobProvider",
    "function_name": "getAllJobs()",
    "function_body": null
  },
  {
    "id": 55,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 3,
    "human_patch": "https://github.com/jenkinsci/subversion-plugin/commit/25f6afbb02a5863f363b0a2f664ac717ace743b4",
    "cve_id": "CVE-2018-1000111",
    "cwe_id": "CWE-863",
    "filename": "src/main/java/hudson/scm/SubversionRepositoryStatus.java",
    "is_vulnerable": 0,
    "class_name": "SubversionRepositoryStatus",
    "subclass_name": "Listener",
    "function_name": "onNotify(UUID uuid, long revision, Set<String> affectedPaths)",
    "function_body": null
  },
  {
    "id": 55,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 4,
    "human_patch": "https://github.com/jenkinsci/subversion-plugin/commit/25f6afbb02a5863f363b0a2f664ac717ace743b4",
    "cve_id": "CVE-2018-1000111",
    "cwe_id": "CWE-863",
    "filename": "src/main/java/hudson/scm/SubversionRepositoryStatus.java",
    "is_vulnerable": 1,
    "class_name": "SubversionRepositoryStatus",
    "subclass_name": null,
    "function_name": "doNotifyCommit(StaplerRequest req, StaplerResponse rsp) throws ServletException, IOException",
    "function_body": "{\n        requirePOST();\n\n        \n        Set<String> affectedPath = new HashSet<String>();\n        String line;\n        BufferedReader r = new BufferedReader(req.getReader());\n        \n        try {\n\t        while((line=r.readLine())!=null) {\n\t        \tif (LOGGER.isLoggable(FINER)) {\n\t        \t\tLOGGER.finer(\"Reading line: \"+line);\n\t        \t}\n\t            affectedPath.add(line.substring(4));\n\t            if (line.startsWith(\"svnlook changed --revision \")) {\n\t                String msg = \"Expecting the output from the svnlook command but instead you just sent me the svnlook invocation command line: \" + line;\n\t                LOGGER.warning(msg);\n\t                throw new IllegalArgumentException(msg);\n\t            }\n\t        }\n        } finally {\n        \tIOUtils.closeQuietly(r);\n        }\n\n        if(LOGGER.isLoggable(FINE))\n            LOGGER.fine(\"Change reported to Subversion repository \"+uuid+\" on \"+affectedPath);\n\n        \n        \n        \n        QueryParameterMap query = new QueryParameterMap(req);\n        String revParam = query.get(\"rev\");\n        if (revParam == null) {\n            revParam = req.getHeader(\"X-Hudson-Subversion-Revision\");\n        }\n\n        long rev = -1;\n        if (revParam != null) {\n            rev = Long.parseLong(revParam);\n        }\n\n        boolean listenerDidSomething = false;\n        for (Listener listener : ExtensionList.lookup(Listener.class)) {\n            try {\n                if (listener.onNotify(uuid, rev, affectedPath)) {\n                    listenerDidSomething = true;\n                }\n            } catch (Throwable t) {\n                LOGGER.log(WARNING, \"Listener \" + listener.getClass().getName() + \" threw an uncaught exception\", t);\n            }\n        }\n\n        if (!listenerDidSomething) LOGGER.log(Level.WARNING, \"No interest in change to repository UUID {0} found\", uuid);\n\n        rsp.setStatus(SC_OK);\n    }"
  },
  {
    "id": 55,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 5,
    "human_patch": "https://github.com/jenkinsci/subversion-plugin/commit/25f6afbb02a5863f363b0a2f664ac717ace743b4",
    "cve_id": "CVE-2018-1000111",
    "cwe_id": "CWE-863",
    "filename": "src/main/java/hudson/scm/SubversionRepositoryStatus.java",
    "is_vulnerable": 0,
    "class_name": "SubversionRepositoryStatus",
    "subclass_name": "JobTriggerListenerImpl",
    "function_name": "getAllJobs()",
    "function_body": "{\n                return Jenkins.getInstance().getAllItems(Job.class);\n            }"
  },
  {
    "id": 55,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 6,
    "human_patch": "https://github.com/jenkinsci/subversion-plugin/commit/25f6afbb02a5863f363b0a2f664ac717ace743b4",
    "cve_id": "CVE-2018-1000111",
    "cwe_id": "CWE-863",
    "filename": "src/main/java/hudson/scm/SubversionRepositoryStatus.java",
    "is_vulnerable": 0,
    "class_name": "SubversionRepositoryStatus",
    "subclass_name": "JobTriggerListenerImpl",
    "function_name": "setJobProvider(JobProvider jobProvider)",
    "function_body": "{\n            this.jobProvider = jobProvider;\n        }"
  },
  {
    "id": 55,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 7,
    "human_patch": "https://github.com/jenkinsci/subversion-plugin/commit/25f6afbb02a5863f363b0a2f664ac717ace743b4",
    "cve_id": "CVE-2018-1000111",
    "cwe_id": "CWE-863",
    "filename": "src/main/java/hudson/scm/SubversionRepositoryStatus.java",
    "is_vulnerable": 0,
    "class_name": "SubversionRepositoryStatus",
    "subclass_name": "JobTriggerListenerImpl",
    "function_name": "remoteUUIDAndRootPathFromCacheOrFromSVN(Job job, SCM scm, ModuleLocation moduleLocation, String urlFromConfiguration) throws SVNException",
    "function_body": "{\n            SubversionRepoUUIDAndRootPath uuidAndRootPath = null;\n            for (Map.Entry<String, UUID> e : remoteUUIDCache.entrySet()) {\n                String remoteRepoRootURL = e.getKey();\n                String remoteRepoRootURLWithSlash = remoteRepoRootURL + \"/\";\n                if (urlFromConfiguration.startsWith(remoteRepoRootURLWithSlash) || urlFromConfiguration.equals(remoteRepoRootURL)) {\n                    UUID uuid = e.getValue();\n                    String rootPath = SVNURL.parseURIDecoded(e.getKey()).getPath();\n                    uuidAndRootPath = new SubversionRepoUUIDAndRootPath(uuid, rootPath);\n\n                    LOGGER.finer(\"Using cached uuid for module location \" + urlFromConfiguration + \" of job \"+ job);\n                    break;\n                }\n            }\n\n            if (uuidAndRootPath == null) {\n                if (LOGGER.isLoggable(FINER)) {\n                    LOGGER.finer(\"Could not find \" + urlFromConfiguration + \" in \" + remoteUUIDCache.keySet());\n                }\n                UUID remoteUUID = moduleLocation.getUUID(job, scm);\n                SVNURL repositoryRoot = moduleLocation.getRepositoryRoot(job, scm);\n                remoteUUIDCache.put(repositoryRoot.toString(), remoteUUID);\n                uuidAndRootPath = new SubversionRepoUUIDAndRootPath(remoteUUID, repositoryRoot.getPath());\n            }\n            return uuidAndRootPath;\n        }"
  },
  {
    "id": 55,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 8,
    "human_patch": "https://github.com/jenkinsci/subversion-plugin/commit/25f6afbb02a5863f363b0a2f664ac717ace743b4",
    "cve_id": "CVE-2018-1000111",
    "cwe_id": "CWE-863",
    "filename": "src/main/java/hudson/scm/SubversionRepositoryStatus.java",
    "is_vulnerable": 0,
    "class_name": "SubversionRepositoryStatus",
    "subclass_name": "JobTriggerListenerImpl",
    "function_name": "doModuleLocationHasAPathFromAffectedPath(String configuredRepoFullPath, String rootRepoPath, Set<String> affectedPath)",
    "function_body": "{\n            boolean containsAnAffectedPath = false;\n            if (configuredRepoFullPath.startsWith(rootRepoPath)) {\n                String remainingRepoPath = configuredRepoFullPath.substring(rootRepoPath.length());\n                if (remainingRepoPath.startsWith(\"/\")) remainingRepoPath=remainingRepoPath.substring(1);\n                String remainingRepoPathSlash = remainingRepoPath + '/';\n\n                for (String path : affectedPath) {\n                    if (path.equals(remainingRepoPath)  || \n                            path.startsWith(remainingRepoPathSlash)  ||\n                            remainingRepoPath.length() == 0 ) {\n                        \n                        \n                        containsAnAffectedPath = true;\n                        break;\n                    }\n                }\n            }\n            return containsAnAffectedPath;\n        }"
  },
  {
    "id": 55,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 9,
    "human_patch": "https://github.com/jenkinsci/subversion-plugin/commit/25f6afbb02a5863f363b0a2f664ac717ace743b4",
    "cve_id": "CVE-2018-1000111",
    "cwe_id": "CWE-863",
    "filename": "src/main/java/hudson/scm/SubversionRepositoryStatus.java",
    "is_vulnerable": 0,
    "class_name": "SubversionRepositoryStatus",
    "subclass_name": "JobTriggerListenerImpl",
    "function_name": "scheduleImediatePollingOfJob(Job job, SCMTrigger trigger, List<SvnInfo> infos)",
    "function_body": "{\n            LOGGER.fine(\"Scheduling the immediate polling of \" + job);\n\n            final RevisionParameterAction[] actions;\n            if (infos.isEmpty()) {\n                actions = new RevisionParameterAction[0];\n            } else {\n                actions = new RevisionParameterAction[] { new RevisionParameterAction(infos) };\n            }\n\n            trigger.run(actions);\n        }"
  },
  {
    "id": 55,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 10,
    "human_patch": "https://github.com/jenkinsci/subversion-plugin/commit/25f6afbb02a5863f363b0a2f664ac717ace743b4",
    "cve_id": "CVE-2018-1000111",
    "cwe_id": "CWE-863",
    "filename": "src/main/java/hudson/scm/SubversionRepositoryStatus.java",
    "is_vulnerable": 0,
    "class_name": "SubversionRepositoryStatus",
    "subclass_name": "JobTriggerListenerImpl",
    "function_name": "onNotify(UUID uuid, long rev, Set<String> affectedPath)",
    "function_body": "{\n            boolean scmFound = false, triggerFound = false, uuidFound = false, pathFound = false;\n            LOGGER.fine(\"Starting subversion locations checks for all jobs\");\n            for (Job p : this.jobProvider.getAllJobs()) {\n                SCMTriggerItem scmTriggerItem = SCMTriggerItem.SCMTriggerItems.asSCMTriggerItem(p);\n                if (scmTriggerItem == null) {\n                    continue;\n                }\n                if (p instanceof AbstractProject && ((AbstractProject) p).isDisabled()) {\n                    continue;\n                }\n                String jobName = p.getName();\n                SCMS: for (SCM scm : scmTriggerItem.getSCMs()) {\n                    if (scm instanceof SubversionSCM) scmFound = true; else continue;\n\n                    SCMTrigger trigger = scmTriggerItem.getSCMTrigger();\n                    if (trigger!=null && !doesIgnorePostCommitHooks(trigger)) triggerFound = true; else continue;\n\n                    SubversionSCM sscm = (SubversionSCM) scm;\n\n                    List<SvnInfo> infos = new ArrayList<SvnInfo>();\n\n                    try {\n                        boolean projectMatches = false;\n                        for (ModuleLocation loc : sscm.getProjectLocations(p)) {\n                            String urlFromConfiguration = loc.getURL();\n                            \n                        \n                            try {\n                                SubversionRepoUUIDAndRootPath uuidAndRootPath = this.remoteUUIDAndRootPathFromCacheOrFromSVN(p, sscm, loc, urlFromConfiguration);\n                                UUID remoteUUID = uuidAndRootPath.uuid;\n                                if (remoteUUID.equals(uuid)) uuidFound = true; else continue;\n\n                                String configuredRepoFullPath = loc.getSVNURL().getPath();\n                                String rootRepoPath = uuidAndRootPath.rootPath;\n                                if (this.doModuleLocationHasAPathFromAffectedPath(configuredRepoFullPath, rootRepoPath, affectedPath)) {\n                                    projectMatches = true;\n                                    pathFound = true;\n                                }\n\n                                if ( rev != -1 ) {\n                                    infos.add(new SvnInfo(loc.getURL(), rev));\n                                }\n                            } catch (SVNCancelException e) {\n                                LOGGER.log(WARNING, \"Failed to handle Subversion commit notification (was trying to access \" + urlFromConfiguration + \" of job \" + jobName + \"). If you are using svn:externals feature ensure that the credentials of the externals are added on the Additional Credentials field\", e);\n                            } catch (SVNException e) {\n                                LOGGER.log(WARNING, \"Failed to handle Subversion commit notification (was trying to access \" + urlFromConfiguration + \" of job \" + jobName + \")\", e);\n                            }\n                            \n                            if (projectMatches) {\n                                this.scheduleImediatePollingOfJob(p, trigger, infos);\n                                break SCMS;\n                            }\n                        }\n                    } catch(IOException e) {\n                        LOGGER.log(WARNING, \"Failed to handle Subversion commit notification (getting module locations failed for job \" + jobName + \")\", e);\n                    }\n                }\n            }\n            LOGGER.fine(\"Ended subversion locations checks for all jobs\");\n\n            if (!scmFound)          LOGGER.warning(\"No subversion jobs found\");\n            else if (!triggerFound) LOGGER.warning(\"No subversion jobs using SCM polling or all jobs using SCM polling are ignoring post-commit hooks\");\n            else if (!uuidFound)    LOGGER.warning(\"No subversion jobs using repository: \" + uuid);\n            else if (!pathFound)    LOGGER.fine(\"No jobs found matching the modified files\");\n\n            return scmFound;\n        }"
  },
  {
    "id": 55,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 11,
    "human_patch": "https://github.com/jenkinsci/subversion-plugin/commit/25f6afbb02a5863f363b0a2f664ac717ace743b4",
    "cve_id": "CVE-2018-1000111",
    "cwe_id": "CWE-863",
    "filename": "src/main/java/hudson/scm/SubversionRepositoryStatus.java",
    "is_vulnerable": 0,
    "class_name": "SubversionRepositoryStatus",
    "subclass_name": null,
    "function_name": "doesIgnorePostCommitHooks(SCMTrigger trigger)",
    "function_body": "{\n        if (IS_IGNORE_POST_COMMIT_HOOKS_METHOD == null)\n            return false;\n        \n        try {\n            return (Boolean)IS_IGNORE_POST_COMMIT_HOOKS_METHOD.invoke(trigger, (Object[])null);\n        } catch (Exception e) {\n            LOGGER.log(WARNING,\"Failure when calling isIgnorePostCommitHooks\",e);\n            return false;\n        }\n    }"
  },
  {
    "id": 55,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 0,
    "human_patch": "https://github.com/jenkinsci/subversion-plugin/commit/25f6afbb02a5863f363b0a2f664ac717ace743b4",
    "cve_id": "CVE-2018-1000111",
    "cwe_id": "CWE-863",
    "filename": "src/main/java/hudson/scm/SubversionStatus.java",
    "is_vulnerable": 0,
    "class_name": "SubversionStatus",
    "subclass_name": null,
    "function_name": "getDisplayName()",
    "function_body": "{\n        return \"Subversion\";\n    }"
  },
  {
    "id": 55,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 1,
    "human_patch": "https://github.com/jenkinsci/subversion-plugin/commit/25f6afbb02a5863f363b0a2f664ac717ace743b4",
    "cve_id": "CVE-2018-1000111",
    "cwe_id": "CWE-863",
    "filename": "src/main/java/hudson/scm/SubversionStatus.java",
    "is_vulnerable": 0,
    "class_name": "SubversionStatus",
    "subclass_name": null,
    "function_name": "getSearchUrl()",
    "function_body": "{\n        return getUrlName();\n    }"
  },
  {
    "id": 55,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 2,
    "human_patch": "https://github.com/jenkinsci/subversion-plugin/commit/25f6afbb02a5863f363b0a2f664ac717ace743b4",
    "cve_id": "CVE-2018-1000111",
    "cwe_id": "CWE-863",
    "filename": "src/main/java/hudson/scm/SubversionStatus.java",
    "is_vulnerable": 0,
    "class_name": "SubversionStatus",
    "subclass_name": null,
    "function_name": "getIconFileName()",
    "function_body": "{\n        \n        return null;\n    }"
  },
  {
    "id": 55,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 3,
    "human_patch": "https://github.com/jenkinsci/subversion-plugin/commit/25f6afbb02a5863f363b0a2f664ac717ace743b4",
    "cve_id": "CVE-2018-1000111",
    "cwe_id": "CWE-863",
    "filename": "src/main/java/hudson/scm/SubversionStatus.java",
    "is_vulnerable": 0,
    "class_name": "SubversionStatus",
    "subclass_name": null,
    "function_name": "getUrlName()",
    "function_body": "{\n        return \"subversion\";\n    }"
  },
  {
    "id": 55,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 4,
    "human_patch": "https://github.com/jenkinsci/subversion-plugin/commit/25f6afbb02a5863f363b0a2f664ac717ace743b4",
    "cve_id": "CVE-2018-1000111",
    "cwe_id": "CWE-863",
    "filename": "src/main/java/hudson/scm/SubversionStatus.java",
    "is_vulnerable": 0,
    "class_name": "SubversionStatus",
    "subclass_name": null,
    "function_name": "getDynamic(String uuid)",
    "function_body": "{\n        if(UUID_PATTERN.matcher(uuid).matches())\n            return new SubversionRepositoryStatus(UUID.fromString(uuid));\n        return null;\n    }"
  },
  {
    "id": 56,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 0,
    "human_patch": "https://github.com/jhy/jsoup/commit/4edb78991f8d0bf87dafde5e01ccd8922065c9b2",
    "cve_id": "CVE-2015-6748",
    "cwe_id": "CWE-79",
    "filename": "src/main/java/org/jsoup/parser/TokeniserState.java",
    "is_vulnerable": 0,
    "class_name": "TokeniserState",
    "subclass_name": null,
    "function_name": "read(Tokeniser t, CharacterReader r)",
    "function_body": "{\n            switch (r.current()) {\n                case '&':\n                    t.advanceTransition(CharacterReferenceInData);\n                    break;\n                case '<':\n                    t.advanceTransition(TagOpen);\n                    break;\n                case nullChar:\n                    t.error(this); \n                    t.emit(r.consume());\n                    break;\n                case eof:\n                    t.emit(new Token.EOF());\n                    break;\n                default:\n                    String data = r.consumeData();\n                    t.emit(data);\n                    break;\n            }\n        }"
  },
  {
    "id": 56,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 1,
    "human_patch": "https://github.com/jhy/jsoup/commit/4edb78991f8d0bf87dafde5e01ccd8922065c9b2",
    "cve_id": "CVE-2015-6748",
    "cwe_id": "CWE-79",
    "filename": "src/main/java/org/jsoup/parser/TokeniserState.java",
    "is_vulnerable": 1,
    "class_name": "TokeniserState",
    "subclass_name": null,
    "function_name": "read(Tokeniser t, CharacterReader r)",
    "function_body": "{\n            char[] c = t.consumeCharacterReference(null, false);\n            if (c == null)\n                t.emit('&');\n            else\n                t.emit(c);\n            t.transition(Data);\n        }"
  },
  {
    "id": 56,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 2,
    "human_patch": "https://github.com/jhy/jsoup/commit/4edb78991f8d0bf87dafde5e01ccd8922065c9b2",
    "cve_id": "CVE-2015-6748",
    "cwe_id": "CWE-79",
    "filename": "src/main/java/org/jsoup/parser/TokeniserState.java",
    "is_vulnerable": 1,
    "class_name": "TokeniserState",
    "subclass_name": null,
    "function_name": "read(Tokeniser t, CharacterReader r)",
    "function_body": "{\n            switch (r.current()) {\n                case '&':\n                    t.advanceTransition(CharacterReferenceInRcdata);\n                    break;\n                case '<':\n                    t.advanceTransition(RcdataLessthanSign);\n                    break;\n                case nullChar:\n                    t.error(this);\n                    r.advance();\n                    t.emit(replacementChar);\n                    break;\n                case eof:\n                    t.emit(new Token.EOF());\n                    break;\n                default:\n                    String data = r.consumeToAny('&', '<', nullChar);\n                    t.emit(data);\n                    break;\n            }\n        }"
  },
  {
    "id": 56,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 3,
    "human_patch": "https://github.com/jhy/jsoup/commit/4edb78991f8d0bf87dafde5e01ccd8922065c9b2",
    "cve_id": "CVE-2015-6748",
    "cwe_id": "CWE-79",
    "filename": "src/main/java/org/jsoup/parser/TokeniserState.java",
    "is_vulnerable": 1,
    "class_name": "TokeniserState",
    "subclass_name": null,
    "function_name": "read(Tokeniser t, CharacterReader r)",
    "function_body": "{\n            char[] c = t.consumeCharacterReference(null, false);\n            if (c == null)\n                t.emit('&');\n            else\n                t.emit(c);\n            t.transition(Rcdata);\n        }"
  },
  {
    "id": 56,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 4,
    "human_patch": "https://github.com/jhy/jsoup/commit/4edb78991f8d0bf87dafde5e01ccd8922065c9b2",
    "cve_id": "CVE-2015-6748",
    "cwe_id": "CWE-79",
    "filename": "src/main/java/org/jsoup/parser/TokeniserState.java",
    "is_vulnerable": 1,
    "class_name": "TokeniserState",
    "subclass_name": null,
    "function_name": "read(Tokeniser t, CharacterReader r)",
    "function_body": "{\n            switch (r.current()) {\n                case '<':\n                    t.advanceTransition(RawtextLessthanSign);\n                    break;\n                case nullChar:\n                    t.error(this);\n                    r.advance();\n                    t.emit(replacementChar);\n                    break;\n                case eof:\n                    t.emit(new Token.EOF());\n                    break;\n                default:\n                    String data = r.consumeToAny('<', nullChar);\n                    t.emit(data);\n                    break;\n            }\n        }"
  },
  {
    "id": 56,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 5,
    "human_patch": "https://github.com/jhy/jsoup/commit/4edb78991f8d0bf87dafde5e01ccd8922065c9b2",
    "cve_id": "CVE-2015-6748",
    "cwe_id": "CWE-79",
    "filename": "src/main/java/org/jsoup/parser/TokeniserState.java",
    "is_vulnerable": 1,
    "class_name": "TokeniserState",
    "subclass_name": null,
    "function_name": "read(Tokeniser t, CharacterReader r)",
    "function_body": "{\n            switch (r.current()) {\n                case '<':\n                    t.advanceTransition(ScriptDataLessthanSign);\n                    break;\n                case nullChar:\n                    t.error(this);\n                    r.advance();\n                    t.emit(replacementChar);\n                    break;\n                case eof:\n                    t.emit(new Token.EOF());\n                    break;\n                default:\n                    String data = r.consumeToAny('<', nullChar);\n                    t.emit(data);\n                    break;\n            }\n        }"
  },
  {
    "id": 56,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 6,
    "human_patch": "https://github.com/jhy/jsoup/commit/4edb78991f8d0bf87dafde5e01ccd8922065c9b2",
    "cve_id": "CVE-2015-6748",
    "cwe_id": "CWE-79",
    "filename": "src/main/java/org/jsoup/parser/TokeniserState.java",
    "is_vulnerable": 1,
    "class_name": "TokeniserState",
    "subclass_name": null,
    "function_name": "read(Tokeniser t, CharacterReader r)",
    "function_body": "{\n            switch (r.current()) {\n                case nullChar:\n                    t.error(this);\n                    r.advance();\n                    t.emit(replacementChar);\n                    break;\n                case eof:\n                    t.emit(new Token.EOF());\n                    break;\n                default:\n                    String data = r.consumeTo(nullChar);\n                    t.emit(data);\n                    break;\n            }\n        }"
  },
  {
    "id": 56,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 7,
    "human_patch": "https://github.com/jhy/jsoup/commit/4edb78991f8d0bf87dafde5e01ccd8922065c9b2",
    "cve_id": "CVE-2015-6748",
    "cwe_id": "CWE-79",
    "filename": "src/main/java/org/jsoup/parser/TokeniserState.java",
    "is_vulnerable": 1,
    "class_name": "TokeniserState",
    "subclass_name": null,
    "function_name": "read(Tokeniser t, CharacterReader r)",
    "function_body": "{\n            switch (r.current()) {\n                case '!':\n                    t.advanceTransition(MarkupDeclarationOpen);\n                    break;\n                case '/':\n                    t.advanceTransition(EndTagOpen);\n                    break;\n                case '?':\n                    t.advanceTransition(BogusComment);\n                    break;\n                default:\n                    if (r.matchesLetter()) {\n                        t.createTagPending(true);\n                        t.transition(TagName);\n                    } else {\n                        t.error(this);\n                        t.emit('<'); \n                        t.transition(Data);\n                    }\n                    break;\n            }\n        }"
  },
  {
    "id": 56,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 8,
    "human_patch": "https://github.com/jhy/jsoup/commit/4edb78991f8d0bf87dafde5e01ccd8922065c9b2",
    "cve_id": "CVE-2015-6748",
    "cwe_id": "CWE-79",
    "filename": "src/main/java/org/jsoup/parser/TokeniserState.java",
    "is_vulnerable": 1,
    "class_name": "TokeniserState",
    "subclass_name": null,
    "function_name": "read(Tokeniser t, CharacterReader r)",
    "function_body": "{\n            if (r.isEmpty()) {\n                t.eofError(this);\n                t.emit(\"</\");\n                t.transition(Data);\n            } else if (r.matchesLetter()) {\n                t.createTagPending(false);\n                t.transition(TagName);\n            } else if (r.matches('>')) {\n                t.error(this);\n                t.advanceTransition(Data);\n            } else {\n                t.error(this);\n                t.advanceTransition(BogusComment);\n            }\n        }"
  },
  {
    "id": 56,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 9,
    "human_patch": "https://github.com/jhy/jsoup/commit/4edb78991f8d0bf87dafde5e01ccd8922065c9b2",
    "cve_id": "CVE-2015-6748",
    "cwe_id": "CWE-79",
    "filename": "src/main/java/org/jsoup/parser/TokeniserState.java",
    "is_vulnerable": 1,
    "class_name": "TokeniserState",
    "subclass_name": null,
    "function_name": "read(Tokeniser t, CharacterReader r)",
    "function_body": "{\n            \n            \n            String tagName = r.consumeTagName().toLowerCase();\n            t.tagPending.appendTagName(tagName);\n\n            switch (r.consume()) {\n                case '\\t':\n                case '\\n':\n                case '\\r':\n                case '\\f':\n                case ' ':\n                    t.transition(BeforeAttributeName);\n                    break;\n                case '/':\n                    t.transition(SelfClosingStartTag);\n                    break;\n                case '>':\n                    t.emitTagPending();\n                    t.transition(Data);\n                    break;\n                case nullChar: \n                    t.tagPending.appendTagName(replacementStr);\n                    break;\n                case eof: \n                    t.eofError(this);\n                    t.transition(Data);\n                \n            }\n        }"
  },
  {
    "id": 56,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 10,
    "human_patch": "https://github.com/jhy/jsoup/commit/4edb78991f8d0bf87dafde5e01ccd8922065c9b2",
    "cve_id": "CVE-2015-6748",
    "cwe_id": "CWE-79",
    "filename": "src/main/java/org/jsoup/parser/TokeniserState.java",
    "is_vulnerable": 1,
    "class_name": "TokeniserState",
    "subclass_name": null,
    "function_name": "read(Tokeniser t, CharacterReader r)",
    "function_body": "{\n            if (r.matches('/')) {\n                t.createTempBuffer();\n                t.advanceTransition(RCDATAEndTagOpen);\n            } else if (r.matchesLetter() && t.appropriateEndTagName() != null && !r.containsIgnoreCase(\"</\" + t.appropriateEndTagName())) {\n                \n                \n                t.tagPending = t.createTagPending(false).name(t.appropriateEndTagName());\n                t.emitTagPending();\n                r.unconsume(); \n                t.transition(Data);\n            } else {\n                t.emit(\"<\");\n                t.transition(Rcdata);\n            }\n        }"
  },
  {
    "id": 56,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 11,
    "human_patch": "https://github.com/jhy/jsoup/commit/4edb78991f8d0bf87dafde5e01ccd8922065c9b2",
    "cve_id": "CVE-2015-6748",
    "cwe_id": "CWE-79",
    "filename": "src/main/java/org/jsoup/parser/TokeniserState.java",
    "is_vulnerable": 1,
    "class_name": "TokeniserState",
    "subclass_name": null,
    "function_name": "read(Tokeniser t, CharacterReader r)",
    "function_body": "{\n            if (r.matchesLetter()) {\n                t.createTagPending(false);\n                t.tagPending.appendTagName(Character.toLowerCase(r.current()));\n                t.dataBuffer.append(Character.toLowerCase(r.current()));\n                t.advanceTransition(RCDATAEndTagName);\n            } else {\n                t.emit(\"</\");\n                t.transition(Rcdata);\n            }\n        }"
  },
  {
    "id": 56,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 12,
    "human_patch": "https://github.com/jhy/jsoup/commit/4edb78991f8d0bf87dafde5e01ccd8922065c9b2",
    "cve_id": "CVE-2015-6748",
    "cwe_id": "CWE-79",
    "filename": "src/main/java/org/jsoup/parser/TokeniserState.java",
    "is_vulnerable": 1,
    "class_name": "TokeniserState",
    "subclass_name": null,
    "function_name": "read(Tokeniser t, CharacterReader r)",
    "function_body": "{\n            if (r.matchesLetter()) {\n                String name = r.consumeLetterSequence();\n                t.tagPending.appendTagName(name.toLowerCase());\n                t.dataBuffer.append(name);\n                return;\n            }\n\n            char c = r.consume();\n            switch (c) {\n                case '\\t':\n                case '\\n':\n                case '\\r':\n                case '\\f':\n                case ' ':\n                    if (t.isAppropriateEndTagToken())\n                        t.transition(BeforeAttributeName);\n                    else\n                        anythingElse(t, r);\n                    break;\n                case '/':\n                    if (t.isAppropriateEndTagToken())\n                        t.transition(SelfClosingStartTag);\n                    else\n                        anythingElse(t, r);\n                    break;\n                case '>':\n                    if (t.isAppropriateEndTagToken()) {\n                        t.emitTagPending();\n                        t.transition(Data);\n                    }\n                    else\n                        anythingElse(t, r);\n                    break;\n                default:\n                    anythingElse(t, r);\n            }\n        }"
  },
  {
    "id": 56,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 13,
    "human_patch": "https://github.com/jhy/jsoup/commit/4edb78991f8d0bf87dafde5e01ccd8922065c9b2",
    "cve_id": "CVE-2015-6748",
    "cwe_id": "CWE-79",
    "filename": "src/main/java/org/jsoup/parser/TokeniserState.java",
    "is_vulnerable": 0,
    "class_name": "TokeniserState",
    "subclass_name": null,
    "function_name": "anythingElse(Tokeniser t, CharacterReader r)",
    "function_body": "{\n            t.emit(\"</\" + t.dataBuffer.toString());\n            r.unconsume();\n            t.transition(Rcdata);\n        }"
  },
  {
    "id": 56,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 14,
    "human_patch": "https://github.com/jhy/jsoup/commit/4edb78991f8d0bf87dafde5e01ccd8922065c9b2",
    "cve_id": "CVE-2015-6748",
    "cwe_id": "CWE-79",
    "filename": "src/main/java/org/jsoup/parser/TokeniserState.java",
    "is_vulnerable": 1,
    "class_name": "TokeniserState",
    "subclass_name": null,
    "function_name": "read(Tokeniser t, CharacterReader r)",
    "function_body": "{\n            if (r.matches('/')) {\n                t.createTempBuffer();\n                t.advanceTransition(RawtextEndTagOpen);\n            } else {\n                t.emit('<');\n                t.transition(Rawtext);\n            }\n        }"
  },
  {
    "id": 56,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 15,
    "human_patch": "https://github.com/jhy/jsoup/commit/4edb78991f8d0bf87dafde5e01ccd8922065c9b2",
    "cve_id": "CVE-2015-6748",
    "cwe_id": "CWE-79",
    "filename": "src/main/java/org/jsoup/parser/TokeniserState.java",
    "is_vulnerable": 1,
    "class_name": "TokeniserState",
    "subclass_name": null,
    "function_name": "read(Tokeniser t, CharacterReader r)",
    "function_body": "{\n            if (r.matchesLetter()) {\n                t.createTagPending(false);\n                t.transition(RawtextEndTagName);\n            } else {\n                t.emit(\"</\");\n                t.transition(Rawtext);\n            }\n        }"
  },
  {
    "id": 56,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 16,
    "human_patch": "https://github.com/jhy/jsoup/commit/4edb78991f8d0bf87dafde5e01ccd8922065c9b2",
    "cve_id": "CVE-2015-6748",
    "cwe_id": "CWE-79",
    "filename": "src/main/java/org/jsoup/parser/TokeniserState.java",
    "is_vulnerable": 1,
    "class_name": "TokeniserState",
    "subclass_name": null,
    "function_name": "read(Tokeniser t, CharacterReader r)",
    "function_body": "{\n            handleDataEndTag(t, r, Rawtext);\n        }"
  },
  {
    "id": 56,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 17,
    "human_patch": "https://github.com/jhy/jsoup/commit/4edb78991f8d0bf87dafde5e01ccd8922065c9b2",
    "cve_id": "CVE-2015-6748",
    "cwe_id": "CWE-79",
    "filename": "src/main/java/org/jsoup/parser/TokeniserState.java",
    "is_vulnerable": 1,
    "class_name": "TokeniserState",
    "subclass_name": null,
    "function_name": "read(Tokeniser t, CharacterReader r)",
    "function_body": "{\n            switch (r.consume()) {\n                case '/':\n                    t.createTempBuffer();\n                    t.transition(ScriptDataEndTagOpen);\n                    break;\n                case '!':\n                    t.emit(\"<!\");\n                    t.transition(ScriptDataEscapeStart);\n                    break;\n                default:\n                    t.emit(\"<\");\n                    r.unconsume();\n                    t.transition(ScriptData);\n            }\n        }"
  },
  {
    "id": 56,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 18,
    "human_patch": "https://github.com/jhy/jsoup/commit/4edb78991f8d0bf87dafde5e01ccd8922065c9b2",
    "cve_id": "CVE-2015-6748",
    "cwe_id": "CWE-79",
    "filename": "src/main/java/org/jsoup/parser/TokeniserState.java",
    "is_vulnerable": 1,
    "class_name": "TokeniserState",
    "subclass_name": null,
    "function_name": "read(Tokeniser t, CharacterReader r)",
    "function_body": "{\n            if (r.matchesLetter()) {\n                t.createTagPending(false);\n                t.transition(ScriptDataEndTagName);\n            } else {\n                t.emit(\"</\");\n                t.transition(ScriptData);\n            }\n\n        }"
  },
  {
    "id": 56,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 19,
    "human_patch": "https://github.com/jhy/jsoup/commit/4edb78991f8d0bf87dafde5e01ccd8922065c9b2",
    "cve_id": "CVE-2015-6748",
    "cwe_id": "CWE-79",
    "filename": "src/main/java/org/jsoup/parser/TokeniserState.java",
    "is_vulnerable": 1,
    "class_name": "TokeniserState",
    "subclass_name": null,
    "function_name": "read(Tokeniser t, CharacterReader r)",
    "function_body": "{\n            handleDataEndTag(t, r, ScriptData);\n        }"
  },
  {
    "id": 56,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 20,
    "human_patch": "https://github.com/jhy/jsoup/commit/4edb78991f8d0bf87dafde5e01ccd8922065c9b2",
    "cve_id": "CVE-2015-6748",
    "cwe_id": "CWE-79",
    "filename": "src/main/java/org/jsoup/parser/TokeniserState.java",
    "is_vulnerable": 1,
    "class_name": "TokeniserState",
    "subclass_name": null,
    "function_name": "read(Tokeniser t, CharacterReader r)",
    "function_body": "{\n            if (r.matches('-')) {\n                t.emit('-');\n                t.advanceTransition(ScriptDataEscapeStartDash);\n            } else {\n                t.transition(ScriptData);\n            }\n        }"
  },
  {
    "id": 56,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 21,
    "human_patch": "https://github.com/jhy/jsoup/commit/4edb78991f8d0bf87dafde5e01ccd8922065c9b2",
    "cve_id": "CVE-2015-6748",
    "cwe_id": "CWE-79",
    "filename": "src/main/java/org/jsoup/parser/TokeniserState.java",
    "is_vulnerable": 1,
    "class_name": "TokeniserState",
    "subclass_name": null,
    "function_name": "read(Tokeniser t, CharacterReader r)",
    "function_body": "{\n            if (r.matches('-')) {\n                t.emit('-');\n                t.advanceTransition(ScriptDataEscapedDashDash);\n            } else {\n                t.transition(ScriptData);\n            }\n        }"
  },
  {
    "id": 56,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 22,
    "human_patch": "https://github.com/jhy/jsoup/commit/4edb78991f8d0bf87dafde5e01ccd8922065c9b2",
    "cve_id": "CVE-2015-6748",
    "cwe_id": "CWE-79",
    "filename": "src/main/java/org/jsoup/parser/TokeniserState.java",
    "is_vulnerable": 1,
    "class_name": "TokeniserState",
    "subclass_name": null,
    "function_name": "read(Tokeniser t, CharacterReader r)",
    "function_body": "{\n            if (r.isEmpty()) {\n                t.eofError(this);\n                t.transition(Data);\n                return;\n            }\n\n            switch (r.current()) {\n                case '-':\n                    t.emit('-');\n                    t.advanceTransition(ScriptDataEscapedDash);\n                    break;\n                case '<':\n                    t.advanceTransition(ScriptDataEscapedLessthanSign);\n                    break;\n                case nullChar:\n                    t.error(this);\n                    r.advance();\n                    t.emit(replacementChar);\n                    break;\n                default:\n                    String data = r.consumeToAny('-', '<', nullChar);\n                    t.emit(data);\n            }\n        }"
  },
  {
    "id": 56,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 23,
    "human_patch": "https://github.com/jhy/jsoup/commit/4edb78991f8d0bf87dafde5e01ccd8922065c9b2",
    "cve_id": "CVE-2015-6748",
    "cwe_id": "CWE-79",
    "filename": "src/main/java/org/jsoup/parser/TokeniserState.java",
    "is_vulnerable": 1,
    "class_name": "TokeniserState",
    "subclass_name": null,
    "function_name": "read(Tokeniser t, CharacterReader r)",
    "function_body": "{\n            if (r.isEmpty()) {\n                t.eofError(this);\n                t.transition(Data);\n                return;\n            }\n\n            char c = r.consume();\n            switch (c) {\n                case '-':\n                    t.emit(c);\n                    t.transition(ScriptDataEscapedDashDash);\n                    break;\n                case '<':\n                    t.transition(ScriptDataEscapedLessthanSign);\n                    break;\n                case nullChar:\n                    t.error(this);\n                    t.emit(replacementChar);\n                    t.transition(ScriptDataEscaped);\n                    break;\n                default:\n                    t.emit(c);\n                    t.transition(ScriptDataEscaped);\n            }\n        }"
  },
  {
    "id": 56,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 24,
    "human_patch": "https://github.com/jhy/jsoup/commit/4edb78991f8d0bf87dafde5e01ccd8922065c9b2",
    "cve_id": "CVE-2015-6748",
    "cwe_id": "CWE-79",
    "filename": "src/main/java/org/jsoup/parser/TokeniserState.java",
    "is_vulnerable": 1,
    "class_name": "TokeniserState",
    "subclass_name": null,
    "function_name": "read(Tokeniser t, CharacterReader r)",
    "function_body": "{\n            if (r.isEmpty()) {\n                t.eofError(this);\n                t.transition(Data);\n                return;\n            }\n\n            char c = r.consume();\n            switch (c) {\n                case '-':\n                    t.emit(c);\n                    break;\n                case '<':\n                    t.transition(ScriptDataEscapedLessthanSign);\n                    break;\n                case '>':\n                    t.emit(c);\n                    t.transition(ScriptData);\n                    break;\n                case nullChar:\n                    t.error(this);\n                    t.emit(replacementChar);\n                    t.transition(ScriptDataEscaped);\n                    break;\n                default:\n                    t.emit(c);\n                    t.transition(ScriptDataEscaped);\n            }\n        }"
  },
  {
    "id": 56,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 25,
    "human_patch": "https://github.com/jhy/jsoup/commit/4edb78991f8d0bf87dafde5e01ccd8922065c9b2",
    "cve_id": "CVE-2015-6748",
    "cwe_id": "CWE-79",
    "filename": "src/main/java/org/jsoup/parser/TokeniserState.java",
    "is_vulnerable": 1,
    "class_name": "TokeniserState",
    "subclass_name": null,
    "function_name": "read(Tokeniser t, CharacterReader r)",
    "function_body": "{\n            if (r.matchesLetter()) {\n                t.createTempBuffer();\n                t.dataBuffer.append(Character.toLowerCase(r.current()));\n                t.emit(\"<\" + r.current());\n                t.advanceTransition(ScriptDataDoubleEscapeStart);\n            } else if (r.matches('/')) {\n                t.createTempBuffer();\n                t.advanceTransition(ScriptDataEscapedEndTagOpen);\n            } else {\n                t.emit('<');\n                t.transition(ScriptDataEscaped);\n            }\n        }"
  },
  {
    "id": 56,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 26,
    "human_patch": "https://github.com/jhy/jsoup/commit/4edb78991f8d0bf87dafde5e01ccd8922065c9b2",
    "cve_id": "CVE-2015-6748",
    "cwe_id": "CWE-79",
    "filename": "src/main/java/org/jsoup/parser/TokeniserState.java",
    "is_vulnerable": 1,
    "class_name": "TokeniserState",
    "subclass_name": null,
    "function_name": "read(Tokeniser t, CharacterReader r)",
    "function_body": "{\n            if (r.matchesLetter()) {\n                t.createTagPending(false);\n                t.tagPending.appendTagName(Character.toLowerCase(r.current()));\n                t.dataBuffer.append(r.current());\n                t.advanceTransition(ScriptDataEscapedEndTagName);\n            } else {\n                t.emit(\"</\");\n                t.transition(ScriptDataEscaped);\n            }\n        }"
  },
  {
    "id": 56,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 27,
    "human_patch": "https://github.com/jhy/jsoup/commit/4edb78991f8d0bf87dafde5e01ccd8922065c9b2",
    "cve_id": "CVE-2015-6748",
    "cwe_id": "CWE-79",
    "filename": "src/main/java/org/jsoup/parser/TokeniserState.java",
    "is_vulnerable": 1,
    "class_name": "TokeniserState",
    "subclass_name": null,
    "function_name": "read(Tokeniser t, CharacterReader r)",
    "function_body": "{\n            handleDataEndTag(t, r, ScriptDataEscaped);\n        }"
  },
  {
    "id": 56,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 28,
    "human_patch": "https://github.com/jhy/jsoup/commit/4edb78991f8d0bf87dafde5e01ccd8922065c9b2",
    "cve_id": "CVE-2015-6748",
    "cwe_id": "CWE-79",
    "filename": "src/main/java/org/jsoup/parser/TokeniserState.java",
    "is_vulnerable": 1,
    "class_name": "TokeniserState",
    "subclass_name": null,
    "function_name": "read(Tokeniser t, CharacterReader r)",
    "function_body": "{\n            handleDataDoubleEscapeTag(t, r, ScriptDataDoubleEscaped, ScriptDataEscaped);\n        }"
  },
  {
    "id": 56,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 29,
    "human_patch": "https://github.com/jhy/jsoup/commit/4edb78991f8d0bf87dafde5e01ccd8922065c9b2",
    "cve_id": "CVE-2015-6748",
    "cwe_id": "CWE-79",
    "filename": "src/main/java/org/jsoup/parser/TokeniserState.java",
    "is_vulnerable": 1,
    "class_name": "TokeniserState",
    "subclass_name": null,
    "function_name": "read(Tokeniser t, CharacterReader r)",
    "function_body": "{\n            char c = r.current();\n            switch (c) {\n                case '-':\n                    t.emit(c);\n                    t.advanceTransition(ScriptDataDoubleEscapedDash);\n                    break;\n                case '<':\n                    t.emit(c);\n                    t.advanceTransition(ScriptDataDoubleEscapedLessthanSign);\n                    break;\n                case nullChar:\n                    t.error(this);\n                    r.advance();\n                    t.emit(replacementChar);\n                    break;\n                case eof:\n                    t.eofError(this);\n                    t.transition(Data);\n                    break;\n                default:\n                    String data = r.consumeToAny('-', '<', nullChar);\n                    t.emit(data);\n            }\n        }"
  },
  {
    "id": 56,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 30,
    "human_patch": "https://github.com/jhy/jsoup/commit/4edb78991f8d0bf87dafde5e01ccd8922065c9b2",
    "cve_id": "CVE-2015-6748",
    "cwe_id": "CWE-79",
    "filename": "src/main/java/org/jsoup/parser/TokeniserState.java",
    "is_vulnerable": 1,
    "class_name": "TokeniserState",
    "subclass_name": null,
    "function_name": "read(Tokeniser t, CharacterReader r)",
    "function_body": "{\n            char c = r.consume();\n            switch (c) {\n                case '-':\n                    t.emit(c);\n                    t.transition(ScriptDataDoubleEscapedDashDash);\n                    break;\n                case '<':\n                    t.emit(c);\n                    t.transition(ScriptDataDoubleEscapedLessthanSign);\n                    break;\n                case nullChar:\n                    t.error(this);\n                    t.emit(replacementChar);\n                    t.transition(ScriptDataDoubleEscaped);\n                    break;\n                case eof:\n                    t.eofError(this);\n                    t.transition(Data);\n                    break;\n                default:\n                    t.emit(c);\n                    t.transition(ScriptDataDoubleEscaped);\n            }\n        }"
  },
  {
    "id": 56,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 31,
    "human_patch": "https://github.com/jhy/jsoup/commit/4edb78991f8d0bf87dafde5e01ccd8922065c9b2",
    "cve_id": "CVE-2015-6748",
    "cwe_id": "CWE-79",
    "filename": "src/main/java/org/jsoup/parser/TokeniserState.java",
    "is_vulnerable": 1,
    "class_name": "TokeniserState",
    "subclass_name": null,
    "function_name": "read(Tokeniser t, CharacterReader r)",
    "function_body": "{\n            char c = r.consume();\n            switch (c) {\n                case '-':\n                    t.emit(c);\n                    break;\n                case '<':\n                    t.emit(c);\n                    t.transition(ScriptDataDoubleEscapedLessthanSign);\n                    break;\n                case '>':\n                    t.emit(c);\n                    t.transition(ScriptData);\n                    break;\n                case nullChar:\n                    t.error(this);\n                    t.emit(replacementChar);\n                    t.transition(ScriptDataDoubleEscaped);\n                    break;\n                case eof:\n                    t.eofError(this);\n                    t.transition(Data);\n                    break;\n                default:\n                    t.emit(c);\n                    t.transition(ScriptDataDoubleEscaped);\n            }\n        }"
  },
  {
    "id": 56,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 32,
    "human_patch": "https://github.com/jhy/jsoup/commit/4edb78991f8d0bf87dafde5e01ccd8922065c9b2",
    "cve_id": "CVE-2015-6748",
    "cwe_id": "CWE-79",
    "filename": "src/main/java/org/jsoup/parser/TokeniserState.java",
    "is_vulnerable": 1,
    "class_name": "TokeniserState",
    "subclass_name": null,
    "function_name": "read(Tokeniser t, CharacterReader r)",
    "function_body": "{\n            if (r.matches('/')) {\n                t.emit('/');\n                t.createTempBuffer();\n                t.advanceTransition(ScriptDataDoubleEscapeEnd);\n            } else {\n                t.transition(ScriptDataDoubleEscaped);\n            }\n        }"
  },
  {
    "id": 56,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 33,
    "human_patch": "https://github.com/jhy/jsoup/commit/4edb78991f8d0bf87dafde5e01ccd8922065c9b2",
    "cve_id": "CVE-2015-6748",
    "cwe_id": "CWE-79",
    "filename": "src/main/java/org/jsoup/parser/TokeniserState.java",
    "is_vulnerable": 1,
    "class_name": "TokeniserState",
    "subclass_name": null,
    "function_name": "read(Tokeniser t, CharacterReader r)",
    "function_body": "{\n            handleDataDoubleEscapeTag(t,r, ScriptDataEscaped, ScriptDataDoubleEscaped);\n        }"
  },
  {
    "id": 56,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 34,
    "human_patch": "https://github.com/jhy/jsoup/commit/4edb78991f8d0bf87dafde5e01ccd8922065c9b2",
    "cve_id": "CVE-2015-6748",
    "cwe_id": "CWE-79",
    "filename": "src/main/java/org/jsoup/parser/TokeniserState.java",
    "is_vulnerable": 1,
    "class_name": "TokeniserState",
    "subclass_name": null,
    "function_name": "read(Tokeniser t, CharacterReader r)",
    "function_body": "{\n            char c = r.consume();\n            switch (c) {\n                case '\\t':\n                case '\\n':\n                case '\\r':\n                case '\\f':\n                case ' ':\n                    break; \n                case '/':\n                    t.transition(SelfClosingStartTag);\n                    break;\n                case '>':\n                    t.emitTagPending();\n                    t.transition(Data);\n                    break;\n                case nullChar:\n                    t.error(this);\n                    t.tagPending.newAttribute();\n                    r.unconsume();\n                    t.transition(AttributeName);\n                    break;\n                case eof:\n                    t.eofError(this);\n                    t.transition(Data);\n                    break;\n                case '\"':\n                case '\\'':\n                case '<':\n                case '=':\n                    t.error(this);\n                    t.tagPending.newAttribute();\n                    t.tagPending.appendAttributeName(c);\n                    t.transition(AttributeName);\n                    break;\n                default: \n                    t.tagPending.newAttribute();\n                    r.unconsume();\n                    t.transition(AttributeName);\n            }\n        }"
  },
  {
    "id": 56,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 35,
    "human_patch": "https://github.com/jhy/jsoup/commit/4edb78991f8d0bf87dafde5e01ccd8922065c9b2",
    "cve_id": "CVE-2015-6748",
    "cwe_id": "CWE-79",
    "filename": "src/main/java/org/jsoup/parser/TokeniserState.java",
    "is_vulnerable": 1,
    "class_name": "TokeniserState",
    "subclass_name": null,
    "function_name": "read(Tokeniser t, CharacterReader r)",
    "function_body": "{\n            String name = r.consumeToAnySorted(attributeNameCharsSorted);\n            t.tagPending.appendAttributeName(name.toLowerCase());\n\n            char c = r.consume();\n            switch (c) {\n                case '\\t':\n                case '\\n':\n                case '\\r':\n                case '\\f':\n                case ' ':\n                    t.transition(AfterAttributeName);\n                    break;\n                case '/':\n                    t.transition(SelfClosingStartTag);\n                    break;\n                case '=':\n                    t.transition(BeforeAttributeValue);\n                    break;\n                case '>':\n                    t.emitTagPending();\n                    t.transition(Data);\n                    break;\n                case nullChar:\n                    t.error(this);\n                    t.tagPending.appendAttributeName(replacementChar);\n                    break;\n                case eof:\n                    t.eofError(this);\n                    t.transition(Data);\n                    break;\n                case '\"':\n                case '\\'':\n                case '<':\n                    t.error(this);\n                    t.tagPending.appendAttributeName(c);\n                \n            }\n        }"
  },
  {
    "id": 56,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 36,
    "human_patch": "https://github.com/jhy/jsoup/commit/4edb78991f8d0bf87dafde5e01ccd8922065c9b2",
    "cve_id": "CVE-2015-6748",
    "cwe_id": "CWE-79",
    "filename": "src/main/java/org/jsoup/parser/TokeniserState.java",
    "is_vulnerable": 1,
    "class_name": "TokeniserState",
    "subclass_name": null,
    "function_name": "read(Tokeniser t, CharacterReader r)",
    "function_body": "{\n            char c = r.consume();\n            switch (c) {\n                case '\\t':\n                case '\\n':\n                case '\\r':\n                case '\\f':\n                case ' ':\n                    \n                    break;\n                case '/':\n                    t.transition(SelfClosingStartTag);\n                    break;\n                case '=':\n                    t.transition(BeforeAttributeValue);\n                    break;\n                case '>':\n                    t.emitTagPending();\n                    t.transition(Data);\n                    break;\n                case nullChar:\n                    t.error(this);\n                    t.tagPending.appendAttributeName(replacementChar);\n                    t.transition(AttributeName);\n                    break;\n                case eof:\n                    t.eofError(this);\n                    t.transition(Data);\n                    break;\n                case '\"':\n                case '\\'':\n                case '<':\n                    t.error(this);\n                    t.tagPending.newAttribute();\n                    t.tagPending.appendAttributeName(c);\n                    t.transition(AttributeName);\n                    break;\n                default: \n                    t.tagPending.newAttribute();\n                    r.unconsume();\n                    t.transition(AttributeName);\n            }\n        }"
  },
  {
    "id": 56,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 37,
    "human_patch": "https://github.com/jhy/jsoup/commit/4edb78991f8d0bf87dafde5e01ccd8922065c9b2",
    "cve_id": "CVE-2015-6748",
    "cwe_id": "CWE-79",
    "filename": "src/main/java/org/jsoup/parser/TokeniserState.java",
    "is_vulnerable": 1,
    "class_name": "TokeniserState",
    "subclass_name": null,
    "function_name": "read(Tokeniser t, CharacterReader r)",
    "function_body": "{\n            char c = r.consume();\n            switch (c) {\n                case '\\t':\n                case '\\n':\n                case '\\r':\n                case '\\f':\n                case ' ':\n                    \n                    break;\n                case '\"':\n                    t.transition(AttributeValue_doubleQuoted);\n                    break;\n                case '&':\n                    r.unconsume();\n                    t.transition(AttributeValue_unquoted);\n                    break;\n                case '\\'':\n                    t.transition(AttributeValue_singleQuoted);\n                    break;\n                case nullChar:\n                    t.error(this);\n                    t.tagPending.appendAttributeValue(replacementChar);\n                    t.transition(AttributeValue_unquoted);\n                    break;\n                case eof:\n                    t.eofError(this);\n                    t.transition(Data);\n                    break;\n                case '>':\n                    t.error(this);\n                    t.emitTagPending();\n                    t.transition(Data);\n                    break;\n                case '<':\n                case '=':\n                case '`':\n                    t.error(this);\n                    t.tagPending.appendAttributeValue(c);\n                    t.transition(AttributeValue_unquoted);\n                    break;\n                default:\n                    r.unconsume();\n                    t.transition(AttributeValue_unquoted);\n            }\n        }"
  },
  {
    "id": 56,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 38,
    "human_patch": "https://github.com/jhy/jsoup/commit/4edb78991f8d0bf87dafde5e01ccd8922065c9b2",
    "cve_id": "CVE-2015-6748",
    "cwe_id": "CWE-79",
    "filename": "src/main/java/org/jsoup/parser/TokeniserState.java",
    "is_vulnerable": 1,
    "class_name": "TokeniserState",
    "subclass_name": null,
    "function_name": "read(Tokeniser t, CharacterReader r)",
    "function_body": "{\n            String value = r.consumeToAnySorted(attributeDoubleValueCharsSorted);\n            if (value.length() > 0)\n                t.tagPending.appendAttributeValue(value);\n\n            char c = r.consume();\n            switch (c) {\n                case '\"':\n                    t.transition(AfterAttributeValue_quoted);\n                    break;\n                case '&':\n                    char[] ref = t.consumeCharacterReference('\"', true);\n                    if (ref != null)\n                        t.tagPending.appendAttributeValue(ref);\n                    else\n                        t.tagPending.appendAttributeValue('&');\n                    break;\n                case nullChar:\n                    t.error(this);\n                    t.tagPending.appendAttributeValue(replacementChar);\n                    break;\n                case eof:\n                    t.eofError(this);\n                    t.transition(Data);\n                    break;\n                \n            }\n        }"
  },
  {
    "id": 56,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 39,
    "human_patch": "https://github.com/jhy/jsoup/commit/4edb78991f8d0bf87dafde5e01ccd8922065c9b2",
    "cve_id": "CVE-2015-6748",
    "cwe_id": "CWE-79",
    "filename": "src/main/java/org/jsoup/parser/TokeniserState.java",
    "is_vulnerable": 1,
    "class_name": "TokeniserState",
    "subclass_name": null,
    "function_name": "read(Tokeniser t, CharacterReader r)",
    "function_body": "{\n            String value = r.consumeToAnySorted(attributeSingleValueCharsSorted);\n            if (value.length() > 0)\n                t.tagPending.appendAttributeValue(value);\n\n            char c = r.consume();\n            switch (c) {\n                case '\\'':\n                    t.transition(AfterAttributeValue_quoted);\n                    break;\n                case '&':\n                    char[] ref = t.consumeCharacterReference('\\'', true);\n                    if (ref != null)\n                        t.tagPending.appendAttributeValue(ref);\n                    else\n                        t.tagPending.appendAttributeValue('&');\n                    break;\n                case nullChar:\n                    t.error(this);\n                    t.tagPending.appendAttributeValue(replacementChar);\n                    break;\n                case eof:\n                    t.eofError(this);\n                    t.transition(Data);\n                    break;\n                \n            }\n        }"
  },
  {
    "id": 56,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 40,
    "human_patch": "https://github.com/jhy/jsoup/commit/4edb78991f8d0bf87dafde5e01ccd8922065c9b2",
    "cve_id": "CVE-2015-6748",
    "cwe_id": "CWE-79",
    "filename": "src/main/java/org/jsoup/parser/TokeniserState.java",
    "is_vulnerable": 1,
    "class_name": "TokeniserState",
    "subclass_name": null,
    "function_name": "read(Tokeniser t, CharacterReader r)",
    "function_body": "{\n            String value = r.consumeToAny('\\t', '\\n', '\\r', '\\f', ' ', '&', '>', nullChar, '\"', '\\'', '<', '=', '`');\n            if (value.length() > 0)\n                t.tagPending.appendAttributeValue(value);\n\n            char c = r.consume();\n            switch (c) {\n                case '\\t':\n                case '\\n':\n                case '\\r':\n                case '\\f':\n                case ' ':\n                    t.transition(BeforeAttributeName);\n                    break;\n                case '&':\n                    char[] ref = t.consumeCharacterReference('>', true);\n                    if (ref != null)\n                        t.tagPending.appendAttributeValue(ref);\n                    else\n                        t.tagPending.appendAttributeValue('&');\n                    break;\n                case '>':\n                    t.emitTagPending();\n                    t.transition(Data);\n                    break;\n                case nullChar:\n                    t.error(this);\n                    t.tagPending.appendAttributeValue(replacementChar);\n                    break;\n                case eof:\n                    t.eofError(this);\n                    t.transition(Data);\n                    break;\n                case '\"':\n                case '\\'':\n                case '<':\n                case '=':\n                case '`':\n                    t.error(this);\n                    t.tagPending.appendAttributeValue(c);\n                    break;\n                \n            }\n\n        }"
  },
  {
    "id": 56,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 41,
    "human_patch": "https://github.com/jhy/jsoup/commit/4edb78991f8d0bf87dafde5e01ccd8922065c9b2",
    "cve_id": "CVE-2015-6748",
    "cwe_id": "CWE-79",
    "filename": "src/main/java/org/jsoup/parser/TokeniserState.java",
    "is_vulnerable": 1,
    "class_name": "TokeniserState",
    "subclass_name": null,
    "function_name": "read(Tokeniser t, CharacterReader r)",
    "function_body": "{\n            char c = r.consume();\n            switch (c) {\n                case '\\t':\n                case '\\n':\n                case '\\r':\n                case '\\f':\n                case ' ':\n                    t.transition(BeforeAttributeName);\n                    break;\n                case '/':\n                    t.transition(SelfClosingStartTag);\n                    break;\n                case '>':\n                    t.emitTagPending();\n                    t.transition(Data);\n                    break;\n                case eof:\n                    t.eofError(this);\n                    t.transition(Data);\n                    break;\n                default:\n                    t.error(this);\n                    r.unconsume();\n                    t.transition(BeforeAttributeName);\n            }\n\n        }"
  },
  {
    "id": 56,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 42,
    "human_patch": "https://github.com/jhy/jsoup/commit/4edb78991f8d0bf87dafde5e01ccd8922065c9b2",
    "cve_id": "CVE-2015-6748",
    "cwe_id": "CWE-79",
    "filename": "src/main/java/org/jsoup/parser/TokeniserState.java",
    "is_vulnerable": 1,
    "class_name": "TokeniserState",
    "subclass_name": null,
    "function_name": "read(Tokeniser t, CharacterReader r)",
    "function_body": "{\n            char c = r.consume();\n            switch (c) {\n                case '>':\n                    t.tagPending.selfClosing = true;\n                    t.emitTagPending();\n                    t.transition(Data);\n                    break;\n                case eof:\n                    t.eofError(this);\n                    t.transition(Data);\n                    break;\n                default:\n                    t.error(this);\n                    t.transition(BeforeAttributeName);\n            }\n        }"
  },
  {
    "id": 56,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 43,
    "human_patch": "https://github.com/jhy/jsoup/commit/4edb78991f8d0bf87dafde5e01ccd8922065c9b2",
    "cve_id": "CVE-2015-6748",
    "cwe_id": "CWE-79",
    "filename": "src/main/java/org/jsoup/parser/TokeniserState.java",
    "is_vulnerable": 1,
    "class_name": "TokeniserState",
    "subclass_name": null,
    "function_name": "read(Tokeniser t, CharacterReader r)",
    "function_body": "{\n            \n            \n            r.unconsume();\n            Token.Comment comment = new Token.Comment();\n            comment.bogus = true;\n            comment.data.append(r.consumeTo('>'));\n            \n            t.emit(comment);\n            t.advanceTransition(Data);\n        }"
  },
  {
    "id": 56,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 44,
    "human_patch": "https://github.com/jhy/jsoup/commit/4edb78991f8d0bf87dafde5e01ccd8922065c9b2",
    "cve_id": "CVE-2015-6748",
    "cwe_id": "CWE-79",
    "filename": "src/main/java/org/jsoup/parser/TokeniserState.java",
    "is_vulnerable": 1,
    "class_name": "TokeniserState",
    "subclass_name": null,
    "function_name": "read(Tokeniser t, CharacterReader r)",
    "function_body": "{\n            if (r.matchConsume(\"--\")) {\n                t.createCommentPending();\n                t.transition(CommentStart);\n            } else if (r.matchConsumeIgnoreCase(\"DOCTYPE\")) {\n                t.transition(Doctype);\n            } else if (r.matchConsume(\"[CDATA[\")) {\n                \n                \n                \n                t.transition(CdataSection);\n            } else {\n                t.error(this);\n                t.advanceTransition(BogusComment); \n            }\n        }"
  },
  {
    "id": 56,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 45,
    "human_patch": "https://github.com/jhy/jsoup/commit/4edb78991f8d0bf87dafde5e01ccd8922065c9b2",
    "cve_id": "CVE-2015-6748",
    "cwe_id": "CWE-79",
    "filename": "src/main/java/org/jsoup/parser/TokeniserState.java",
    "is_vulnerable": 1,
    "class_name": "TokeniserState",
    "subclass_name": null,
    "function_name": "read(Tokeniser t, CharacterReader r)",
    "function_body": "{\n            char c = r.consume();\n            switch (c) {\n                case '-':\n                    t.transition(CommentStartDash);\n                    break;\n                case nullChar:\n                    t.error(this);\n                    t.commentPending.data.append(replacementChar);\n                    t.transition(Comment);\n                    break;\n                case '>':\n                    t.error(this);\n                    t.emitCommentPending();\n                    t.transition(Data);\n                    break;\n                case eof:\n                    t.eofError(this);\n                    t.emitCommentPending();\n                    t.transition(Data);\n                    break;\n                default:\n                    t.commentPending.data.append(c);\n                    t.transition(Comment);\n            }\n        }"
  },
  {
    "id": 56,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 46,
    "human_patch": "https://github.com/jhy/jsoup/commit/4edb78991f8d0bf87dafde5e01ccd8922065c9b2",
    "cve_id": "CVE-2015-6748",
    "cwe_id": "CWE-79",
    "filename": "src/main/java/org/jsoup/parser/TokeniserState.java",
    "is_vulnerable": 1,
    "class_name": "TokeniserState",
    "subclass_name": null,
    "function_name": "read(Tokeniser t, CharacterReader r)",
    "function_body": "{\n            char c = r.consume();\n            switch (c) {\n                case '-':\n                    t.transition(CommentStartDash);\n                    break;\n                case nullChar:\n                    t.error(this);\n                    t.commentPending.data.append(replacementChar);\n                    t.transition(Comment);\n                    break;\n                case '>':\n                    t.error(this);\n                    t.emitCommentPending();\n                    t.transition(Data);\n                    break;\n                case eof:\n                    t.eofError(this);\n                    t.emitCommentPending();\n                    t.transition(Data);\n                    break;\n                default:\n                    t.commentPending.data.append(c);\n                    t.transition(Comment);\n            }\n        }"
  },
  {
    "id": 56,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 47,
    "human_patch": "https://github.com/jhy/jsoup/commit/4edb78991f8d0bf87dafde5e01ccd8922065c9b2",
    "cve_id": "CVE-2015-6748",
    "cwe_id": "CWE-79",
    "filename": "src/main/java/org/jsoup/parser/TokeniserState.java",
    "is_vulnerable": 1,
    "class_name": "TokeniserState",
    "subclass_name": null,
    "function_name": "read(Tokeniser t, CharacterReader r)",
    "function_body": "{\n            char c = r.current();\n            switch (c) {\n                case '-':\n                    t.advanceTransition(CommentEndDash);\n                    break;\n                case nullChar:\n                    t.error(this);\n                    r.advance();\n                    t.commentPending.data.append(replacementChar);\n                    break;\n                case eof:\n                    t.eofError(this);\n                    t.emitCommentPending();\n                    t.transition(Data);\n                    break;\n                default:\n                    t.commentPending.data.append(r.consumeToAny('-', nullChar));\n            }\n        }"
  },
  {
    "id": 56,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 48,
    "human_patch": "https://github.com/jhy/jsoup/commit/4edb78991f8d0bf87dafde5e01ccd8922065c9b2",
    "cve_id": "CVE-2015-6748",
    "cwe_id": "CWE-79",
    "filename": "src/main/java/org/jsoup/parser/TokeniserState.java",
    "is_vulnerable": 1,
    "class_name": "TokeniserState",
    "subclass_name": null,
    "function_name": "read(Tokeniser t, CharacterReader r)",
    "function_body": "{\n            char c = r.consume();\n            switch (c) {\n                case '-':\n                    t.transition(CommentEnd);\n                    break;\n                case nullChar:\n                    t.error(this);\n                    t.commentPending.data.append('-').append(replacementChar);\n                    t.transition(Comment);\n                    break;\n                case eof:\n                    t.eofError(this);\n                    t.emitCommentPending();\n                    t.transition(Data);\n                    break;\n                default:\n                    t.commentPending.data.append('-').append(c);\n                    t.transition(Comment);\n            }\n        }"
  },
  {
    "id": 56,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 49,
    "human_patch": "https://github.com/jhy/jsoup/commit/4edb78991f8d0bf87dafde5e01ccd8922065c9b2",
    "cve_id": "CVE-2015-6748",
    "cwe_id": "CWE-79",
    "filename": "src/main/java/org/jsoup/parser/TokeniserState.java",
    "is_vulnerable": 1,
    "class_name": "TokeniserState",
    "subclass_name": null,
    "function_name": "read(Tokeniser t, CharacterReader r)",
    "function_body": "{\n            char c = r.consume();\n            switch (c) {\n                case '>':\n                    t.emitCommentPending();\n                    t.transition(Data);\n                    break;\n                case nullChar:\n                    t.error(this);\n                    t.commentPending.data.append(\"--\").append(replacementChar);\n                    t.transition(Comment);\n                    break;\n                case '!':\n                    t.error(this);\n                    t.transition(CommentEndBang);\n                    break;\n                case '-':\n                    t.error(this);\n                    t.commentPending.data.append('-');\n                    break;\n                case eof:\n                    t.eofError(this);\n                    t.emitCommentPending();\n                    t.transition(Data);\n                    break;\n                default:\n                    t.error(this);\n                    t.commentPending.data.append(\"--\").append(c);\n                    t.transition(Comment);\n            }\n        }"
  },
  {
    "id": 56,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 50,
    "human_patch": "https://github.com/jhy/jsoup/commit/4edb78991f8d0bf87dafde5e01ccd8922065c9b2",
    "cve_id": "CVE-2015-6748",
    "cwe_id": "CWE-79",
    "filename": "src/main/java/org/jsoup/parser/TokeniserState.java",
    "is_vulnerable": 1,
    "class_name": "TokeniserState",
    "subclass_name": null,
    "function_name": "read(Tokeniser t, CharacterReader r)",
    "function_body": "{\n            char c = r.consume();\n            switch (c) {\n                case '-':\n                    t.commentPending.data.append(\"--!\");\n                    t.transition(CommentEndDash);\n                    break;\n                case '>':\n                    t.emitCommentPending();\n                    t.transition(Data);\n                    break;\n                case nullChar:\n                    t.error(this);\n                    t.commentPending.data.append(\"--!\").append(replacementChar);\n                    t.transition(Comment);\n                    break;\n                case eof:\n                    t.eofError(this);\n                    t.emitCommentPending();\n                    t.transition(Data);\n                    break;\n                default:\n                    t.commentPending.data.append(\"--!\").append(c);\n                    t.transition(Comment);\n            }\n        }"
  },
  {
    "id": 56,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 51,
    "human_patch": "https://github.com/jhy/jsoup/commit/4edb78991f8d0bf87dafde5e01ccd8922065c9b2",
    "cve_id": "CVE-2015-6748",
    "cwe_id": "CWE-79",
    "filename": "src/main/java/org/jsoup/parser/TokeniserState.java",
    "is_vulnerable": 1,
    "class_name": "TokeniserState",
    "subclass_name": null,
    "function_name": "read(Tokeniser t, CharacterReader r)",
    "function_body": "{\n            char c = r.consume();\n            switch (c) {\n                case '\\t':\n                case '\\n':\n                case '\\r':\n                case '\\f':\n                case ' ':\n                    t.transition(BeforeDoctypeName);\n                    break;\n                case eof:\n                    t.eofError(this);\n                    \n                case '>': \n                    t.error(this);\n                    t.createDoctypePending();\n                    t.doctypePending.forceQuirks = true;\n                    t.emitDoctypePending();\n                    t.transition(Data);\n                    break;\n                default:\n                    t.error(this);\n                    t.transition(BeforeDoctypeName);\n            }\n        }"
  },
  {
    "id": 56,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 52,
    "human_patch": "https://github.com/jhy/jsoup/commit/4edb78991f8d0bf87dafde5e01ccd8922065c9b2",
    "cve_id": "CVE-2015-6748",
    "cwe_id": "CWE-79",
    "filename": "src/main/java/org/jsoup/parser/TokeniserState.java",
    "is_vulnerable": 1,
    "class_name": "TokeniserState",
    "subclass_name": null,
    "function_name": "read(Tokeniser t, CharacterReader r)",
    "function_body": "{\n            if (r.matchesLetter()) {\n                t.createDoctypePending();\n                t.transition(DoctypeName);\n                return;\n            }\n            char c = r.consume();\n            switch (c) {\n                case '\\t':\n                case '\\n':\n                case '\\r':\n                case '\\f':\n                case ' ':\n                    break; \n                case nullChar:\n                    t.error(this);\n                    t.createDoctypePending();\n                    t.doctypePending.name.append(replacementChar);\n                    t.transition(DoctypeName);\n                    break;\n                case eof:\n                    t.eofError(this);\n                    t.createDoctypePending();\n                    t.doctypePending.forceQuirks = true;\n                    t.emitDoctypePending();\n                    t.transition(Data);\n                    break;\n                default:\n                    t.createDoctypePending();\n                    t.doctypePending.name.append(c);\n                    t.transition(DoctypeName);\n            }\n        }"
  },
  {
    "id": 56,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 53,
    "human_patch": "https://github.com/jhy/jsoup/commit/4edb78991f8d0bf87dafde5e01ccd8922065c9b2",
    "cve_id": "CVE-2015-6748",
    "cwe_id": "CWE-79",
    "filename": "src/main/java/org/jsoup/parser/TokeniserState.java",
    "is_vulnerable": 1,
    "class_name": "TokeniserState",
    "subclass_name": null,
    "function_name": "read(Tokeniser t, CharacterReader r)",
    "function_body": "{\n            if (r.matchesLetter()) {\n                String name = r.consumeLetterSequence();\n                t.doctypePending.name.append(name.toLowerCase());\n                return;\n            }\n            char c = r.consume();\n            switch (c) {\n                case '>':\n                    t.emitDoctypePending();\n                    t.transition(Data);\n                    break;\n                case '\\t':\n                case '\\n':\n                case '\\r':\n                case '\\f':\n                case ' ':\n                    t.transition(AfterDoctypeName);\n                    break;\n                case nullChar:\n                    t.error(this);\n                    t.doctypePending.name.append(replacementChar);\n                    break;\n                case eof:\n                    t.eofError(this);\n                    t.doctypePending.forceQuirks = true;\n                    t.emitDoctypePending();\n                    t.transition(Data);\n                    break;\n                default:\n                    t.doctypePending.name.append(c);\n            }\n        }"
  },
  {
    "id": 56,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 54,
    "human_patch": "https://github.com/jhy/jsoup/commit/4edb78991f8d0bf87dafde5e01ccd8922065c9b2",
    "cve_id": "CVE-2015-6748",
    "cwe_id": "CWE-79",
    "filename": "src/main/java/org/jsoup/parser/TokeniserState.java",
    "is_vulnerable": 1,
    "class_name": "TokeniserState",
    "subclass_name": null,
    "function_name": "read(Tokeniser t, CharacterReader r)",
    "function_body": "{\n            if (r.isEmpty()) {\n                t.eofError(this);\n                t.doctypePending.forceQuirks = true;\n                t.emitDoctypePending();\n                t.transition(Data);\n                return;\n            }\n            if (r.matchesAny('\\t', '\\n', '\\r', '\\f', ' '))\n                r.advance(); \n            else if (r.matches('>')) {\n                t.emitDoctypePending();\n                t.advanceTransition(Data);\n            } else if (r.matchConsumeIgnoreCase(\"PUBLIC\")) {\n                t.transition(AfterDoctypePublicKeyword);\n            } else if (r.matchConsumeIgnoreCase(\"SYSTEM\")) {\n                t.transition(AfterDoctypeSystemKeyword);\n            } else {\n                t.error(this);\n                t.doctypePending.forceQuirks = true;\n                t.advanceTransition(BogusDoctype);\n            }\n\n        }"
  },
  {
    "id": 56,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 55,
    "human_patch": "https://github.com/jhy/jsoup/commit/4edb78991f8d0bf87dafde5e01ccd8922065c9b2",
    "cve_id": "CVE-2015-6748",
    "cwe_id": "CWE-79",
    "filename": "src/main/java/org/jsoup/parser/TokeniserState.java",
    "is_vulnerable": 1,
    "class_name": "TokeniserState",
    "subclass_name": null,
    "function_name": "read(Tokeniser t, CharacterReader r)",
    "function_body": "{\n            char c = r.consume();\n            switch (c) {\n                case '\\t':\n                case '\\n':\n                case '\\r':\n                case '\\f':\n                case ' ':\n                    t.transition(BeforeDoctypePublicIdentifier);\n                    break;\n                case '\"':\n                    t.error(this);\n                    \n                    t.transition(DoctypePublicIdentifier_doubleQuoted);\n                    break;\n                case '\\'':\n                    t.error(this);\n                    \n                    t.transition(DoctypePublicIdentifier_singleQuoted);\n                    break;\n                case '>':\n                    t.error(this);\n                    t.doctypePending.forceQuirks = true;\n                    t.emitDoctypePending();\n                    t.transition(Data);\n                    break;\n                case eof:\n                    t.eofError(this);\n                    t.doctypePending.forceQuirks = true;\n                    t.emitDoctypePending();\n                    t.transition(Data);\n                    break;\n                default:\n                    t.error(this);\n                    t.doctypePending.forceQuirks = true;\n                    t.transition(BogusDoctype);\n            }\n        }"
  },
  {
    "id": 56,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 56,
    "human_patch": "https://github.com/jhy/jsoup/commit/4edb78991f8d0bf87dafde5e01ccd8922065c9b2",
    "cve_id": "CVE-2015-6748",
    "cwe_id": "CWE-79",
    "filename": "src/main/java/org/jsoup/parser/TokeniserState.java",
    "is_vulnerable": 1,
    "class_name": "TokeniserState",
    "subclass_name": null,
    "function_name": "read(Tokeniser t, CharacterReader r)",
    "function_body": "{\n            char c = r.consume();\n            switch (c) {\n                case '\\t':\n                case '\\n':\n                case '\\r':\n                case '\\f':\n                case ' ':\n                    break;\n                case '\"':\n                    \n                    t.transition(DoctypePublicIdentifier_doubleQuoted);\n                    break;\n                case '\\'':\n                    \n                    t.transition(DoctypePublicIdentifier_singleQuoted);\n                    break;\n                case '>':\n                    t.error(this);\n                    t.doctypePending.forceQuirks = true;\n                    t.emitDoctypePending();\n                    t.transition(Data);\n                    break;\n                case eof:\n                    t.eofError(this);\n                    t.doctypePending.forceQuirks = true;\n                    t.emitDoctypePending();\n                    t.transition(Data);\n                    break;\n                default:\n                    t.error(this);\n                    t.doctypePending.forceQuirks = true;\n                    t.transition(BogusDoctype);\n            }\n        }"
  },
  {
    "id": 56,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 57,
    "human_patch": "https://github.com/jhy/jsoup/commit/4edb78991f8d0bf87dafde5e01ccd8922065c9b2",
    "cve_id": "CVE-2015-6748",
    "cwe_id": "CWE-79",
    "filename": "src/main/java/org/jsoup/parser/TokeniserState.java",
    "is_vulnerable": 1,
    "class_name": "TokeniserState",
    "subclass_name": null,
    "function_name": "read(Tokeniser t, CharacterReader r)",
    "function_body": "{\n            char c = r.consume();\n            switch (c) {\n                case '\"':\n                    t.transition(AfterDoctypePublicIdentifier);\n                    break;\n                case nullChar:\n                    t.error(this);\n                    t.doctypePending.publicIdentifier.append(replacementChar);\n                    break;\n                case '>':\n                    t.error(this);\n                    t.doctypePending.forceQuirks = true;\n                    t.emitDoctypePending();\n                    t.transition(Data);\n                    break;\n                case eof:\n                    t.eofError(this);\n                    t.doctypePending.forceQuirks = true;\n                    t.emitDoctypePending();\n                    t.transition(Data);\n                    break;\n                default:\n                    t.doctypePending.publicIdentifier.append(c);\n            }\n        }"
  },
  {
    "id": 56,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 58,
    "human_patch": "https://github.com/jhy/jsoup/commit/4edb78991f8d0bf87dafde5e01ccd8922065c9b2",
    "cve_id": "CVE-2015-6748",
    "cwe_id": "CWE-79",
    "filename": "src/main/java/org/jsoup/parser/TokeniserState.java",
    "is_vulnerable": 1,
    "class_name": "TokeniserState",
    "subclass_name": null,
    "function_name": "read(Tokeniser t, CharacterReader r)",
    "function_body": "{\n            char c = r.consume();\n            switch (c) {\n                case '\\'':\n                    t.transition(AfterDoctypePublicIdentifier);\n                    break;\n                case nullChar:\n                    t.error(this);\n                    t.doctypePending.publicIdentifier.append(replacementChar);\n                    break;\n                case '>':\n                    t.error(this);\n                    t.doctypePending.forceQuirks = true;\n                    t.emitDoctypePending();\n                    t.transition(Data);\n                    break;\n                case eof:\n                    t.eofError(this);\n                    t.doctypePending.forceQuirks = true;\n                    t.emitDoctypePending();\n                    t.transition(Data);\n                    break;\n                default:\n                    t.doctypePending.publicIdentifier.append(c);\n            }\n        }"
  },
  {
    "id": 56,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 59,
    "human_patch": "https://github.com/jhy/jsoup/commit/4edb78991f8d0bf87dafde5e01ccd8922065c9b2",
    "cve_id": "CVE-2015-6748",
    "cwe_id": "CWE-79",
    "filename": "src/main/java/org/jsoup/parser/TokeniserState.java",
    "is_vulnerable": 1,
    "class_name": "TokeniserState",
    "subclass_name": null,
    "function_name": "read(Tokeniser t, CharacterReader r)",
    "function_body": "{\n            char c = r.consume();\n            switch (c) {\n                case '\\t':\n                case '\\n':\n                case '\\r':\n                case '\\f':\n                case ' ':\n                    t.transition(BetweenDoctypePublicAndSystemIdentifiers);\n                    break;\n                case '>':\n                    t.emitDoctypePending();\n                    t.transition(Data);\n                    break;\n                case '\"':\n                    t.error(this);\n                    \n                    t.transition(DoctypeSystemIdentifier_doubleQuoted);\n                    break;\n                case '\\'':\n                    t.error(this);\n                    \n                    t.transition(DoctypeSystemIdentifier_singleQuoted);\n                    break;\n                case eof:\n                    t.eofError(this);\n                    t.doctypePending.forceQuirks = true;\n                    t.emitDoctypePending();\n                    t.transition(Data);\n                    break;\n                default:\n                    t.error(this);\n                    t.doctypePending.forceQuirks = true;\n                    t.transition(BogusDoctype);\n            }\n        }"
  },
  {
    "id": 56,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 60,
    "human_patch": "https://github.com/jhy/jsoup/commit/4edb78991f8d0bf87dafde5e01ccd8922065c9b2",
    "cve_id": "CVE-2015-6748",
    "cwe_id": "CWE-79",
    "filename": "src/main/java/org/jsoup/parser/TokeniserState.java",
    "is_vulnerable": 1,
    "class_name": "TokeniserState",
    "subclass_name": null,
    "function_name": "read(Tokeniser t, CharacterReader r)",
    "function_body": "{\n            char c = r.consume();\n            switch (c) {\n                case '\\t':\n                case '\\n':\n                case '\\r':\n                case '\\f':\n                case ' ':\n                    break;\n                case '>':\n                    t.emitDoctypePending();\n                    t.transition(Data);\n                    break;\n                case '\"':\n                    t.error(this);\n                    \n                    t.transition(DoctypeSystemIdentifier_doubleQuoted);\n                    break;\n                case '\\'':\n                    t.error(this);\n                    \n                    t.transition(DoctypeSystemIdentifier_singleQuoted);\n                    break;\n                case eof:\n                    t.eofError(this);\n                    t.doctypePending.forceQuirks = true;\n                    t.emitDoctypePending();\n                    t.transition(Data);\n                    break;\n                default:\n                    t.error(this);\n                    t.doctypePending.forceQuirks = true;\n                    t.transition(BogusDoctype);\n            }\n        }"
  },
  {
    "id": 56,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 61,
    "human_patch": "https://github.com/jhy/jsoup/commit/4edb78991f8d0bf87dafde5e01ccd8922065c9b2",
    "cve_id": "CVE-2015-6748",
    "cwe_id": "CWE-79",
    "filename": "src/main/java/org/jsoup/parser/TokeniserState.java",
    "is_vulnerable": 1,
    "class_name": "TokeniserState",
    "subclass_name": null,
    "function_name": "read(Tokeniser t, CharacterReader r)",
    "function_body": "{\n            char c = r.consume();\n            switch (c) {\n                case '\\t':\n                case '\\n':\n                case '\\r':\n                case '\\f':\n                case ' ':\n                    t.transition(BeforeDoctypeSystemIdentifier);\n                    break;\n                case '>':\n                    t.error(this);\n                    t.doctypePending.forceQuirks = true;\n                    t.emitDoctypePending();\n                    t.transition(Data);\n                    break;\n                case '\"':\n                    t.error(this);\n                    \n                    t.transition(DoctypeSystemIdentifier_doubleQuoted);\n                    break;\n                case '\\'':\n                    t.error(this);\n                    \n                    t.transition(DoctypeSystemIdentifier_singleQuoted);\n                    break;\n                case eof:\n                    t.eofError(this);\n                    t.doctypePending.forceQuirks = true;\n                    t.emitDoctypePending();\n                    t.transition(Data);\n                    break;\n                default:\n                    t.error(this);\n                    t.doctypePending.forceQuirks = true;\n                    t.emitDoctypePending();\n            }\n        }"
  },
  {
    "id": 56,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 62,
    "human_patch": "https://github.com/jhy/jsoup/commit/4edb78991f8d0bf87dafde5e01ccd8922065c9b2",
    "cve_id": "CVE-2015-6748",
    "cwe_id": "CWE-79",
    "filename": "src/main/java/org/jsoup/parser/TokeniserState.java",
    "is_vulnerable": 1,
    "class_name": "TokeniserState",
    "subclass_name": null,
    "function_name": "read(Tokeniser t, CharacterReader r)",
    "function_body": "{\n            char c = r.consume();\n            switch (c) {\n                case '\\t':\n                case '\\n':\n                case '\\r':\n                case '\\f':\n                case ' ':\n                    break;\n                case '\"':\n                    \n                    t.transition(DoctypeSystemIdentifier_doubleQuoted);\n                    break;\n                case '\\'':\n                    \n                    t.transition(DoctypeSystemIdentifier_singleQuoted);\n                    break;\n                case '>':\n                    t.error(this);\n                    t.doctypePending.forceQuirks = true;\n                    t.emitDoctypePending();\n                    t.transition(Data);\n                    break;\n                case eof:\n                    t.eofError(this);\n                    t.doctypePending.forceQuirks = true;\n                    t.emitDoctypePending();\n                    t.transition(Data);\n                    break;\n                default:\n                    t.error(this);\n                    t.doctypePending.forceQuirks = true;\n                    t.transition(BogusDoctype);\n            }\n        }"
  },
  {
    "id": 56,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 63,
    "human_patch": "https://github.com/jhy/jsoup/commit/4edb78991f8d0bf87dafde5e01ccd8922065c9b2",
    "cve_id": "CVE-2015-6748",
    "cwe_id": "CWE-79",
    "filename": "src/main/java/org/jsoup/parser/TokeniserState.java",
    "is_vulnerable": 1,
    "class_name": "TokeniserState",
    "subclass_name": null,
    "function_name": "read(Tokeniser t, CharacterReader r)",
    "function_body": "{\n            char c = r.consume();\n            switch (c) {\n                case '\"':\n                    t.transition(AfterDoctypeSystemIdentifier);\n                    break;\n                case nullChar:\n                    t.error(this);\n                    t.doctypePending.systemIdentifier.append(replacementChar);\n                    break;\n                case '>':\n                    t.error(this);\n                    t.doctypePending.forceQuirks = true;\n                    t.emitDoctypePending();\n                    t.transition(Data);\n                    break;\n                case eof:\n                    t.eofError(this);\n                    t.doctypePending.forceQuirks = true;\n                    t.emitDoctypePending();\n                    t.transition(Data);\n                    break;\n                default:\n                    t.doctypePending.systemIdentifier.append(c);\n            }\n        }"
  },
  {
    "id": 56,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 64,
    "human_patch": "https://github.com/jhy/jsoup/commit/4edb78991f8d0bf87dafde5e01ccd8922065c9b2",
    "cve_id": "CVE-2015-6748",
    "cwe_id": "CWE-79",
    "filename": "src/main/java/org/jsoup/parser/TokeniserState.java",
    "is_vulnerable": 1,
    "class_name": "TokeniserState",
    "subclass_name": null,
    "function_name": "read(Tokeniser t, CharacterReader r)",
    "function_body": "{\n            char c = r.consume();\n            switch (c) {\n                case '\\'':\n                    t.transition(AfterDoctypeSystemIdentifier);\n                    break;\n                case nullChar:\n                    t.error(this);\n                    t.doctypePending.systemIdentifier.append(replacementChar);\n                    break;\n                case '>':\n                    t.error(this);\n                    t.doctypePending.forceQuirks = true;\n                    t.emitDoctypePending();\n                    t.transition(Data);\n                    break;\n                case eof:\n                    t.eofError(this);\n                    t.doctypePending.forceQuirks = true;\n                    t.emitDoctypePending();\n                    t.transition(Data);\n                    break;\n                default:\n                    t.doctypePending.systemIdentifier.append(c);\n            }\n        }"
  },
  {
    "id": 56,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 65,
    "human_patch": "https://github.com/jhy/jsoup/commit/4edb78991f8d0bf87dafde5e01ccd8922065c9b2",
    "cve_id": "CVE-2015-6748",
    "cwe_id": "CWE-79",
    "filename": "src/main/java/org/jsoup/parser/TokeniserState.java",
    "is_vulnerable": 1,
    "class_name": "TokeniserState",
    "subclass_name": null,
    "function_name": "read(Tokeniser t, CharacterReader r)",
    "function_body": "{\n            char c = r.consume();\n            switch (c) {\n                case '\\t':\n                case '\\n':\n                case '\\r':\n                case '\\f':\n                case ' ':\n                    break;\n                case '>':\n                    t.emitDoctypePending();\n                    t.transition(Data);\n                    break;\n                case eof:\n                    t.eofError(this);\n                    t.doctypePending.forceQuirks = true;\n                    t.emitDoctypePending();\n                    t.transition(Data);\n                    break;\n                default:\n                    t.error(this);\n                    t.transition(BogusDoctype);\n                    \n            }\n        }"
  },
  {
    "id": 56,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 66,
    "human_patch": "https://github.com/jhy/jsoup/commit/4edb78991f8d0bf87dafde5e01ccd8922065c9b2",
    "cve_id": "CVE-2015-6748",
    "cwe_id": "CWE-79",
    "filename": "src/main/java/org/jsoup/parser/TokeniserState.java",
    "is_vulnerable": 1,
    "class_name": "TokeniserState",
    "subclass_name": null,
    "function_name": "read(Tokeniser t, CharacterReader r)",
    "function_body": "{\n            char c = r.consume();\n            switch (c) {\n                case '>':\n                    t.emitDoctypePending();\n                    t.transition(Data);\n                    break;\n                case eof:\n                    t.emitDoctypePending();\n                    t.transition(Data);\n                    break;\n                default:\n                    \n                    break;\n            }\n        }"
  },
  {
    "id": 56,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 67,
    "human_patch": "https://github.com/jhy/jsoup/commit/4edb78991f8d0bf87dafde5e01ccd8922065c9b2",
    "cve_id": "CVE-2015-6748",
    "cwe_id": "CWE-79",
    "filename": "src/main/java/org/jsoup/parser/TokeniserState.java",
    "is_vulnerable": 1,
    "class_name": "TokeniserState",
    "subclass_name": null,
    "function_name": "read(Tokeniser t, CharacterReader r)",
    "function_body": "{\n            String data = r.consumeTo(\"]]>\");\n            t.emit(data);\n            r.matchConsume(\"]]>\");\n            t.transition(Data);\n        }"
  },
  {
    "id": 56,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 68,
    "human_patch": "https://github.com/jhy/jsoup/commit/4edb78991f8d0bf87dafde5e01ccd8922065c9b2",
    "cve_id": "CVE-2015-6748",
    "cwe_id": "CWE-79",
    "filename": "src/main/java/org/jsoup/parser/TokeniserState.java",
    "is_vulnerable": 1,
    "class_name": "TokeniserState",
    "subclass_name": null,
    "function_name": "read(Tokeniser t, CharacterReader r)",
    "function_body": null
  },
  {
    "id": 56,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 69,
    "human_patch": "https://github.com/jhy/jsoup/commit/4edb78991f8d0bf87dafde5e01ccd8922065c9b2",
    "cve_id": "CVE-2015-6748",
    "cwe_id": "CWE-79",
    "filename": "src/main/java/org/jsoup/parser/TokeniserState.java",
    "is_vulnerable": 0,
    "class_name": "TokeniserState",
    "subclass_name": null,
    "function_name": "handleDataEndTag(Tokeniser t, CharacterReader r, TokeniserState elseTransition)",
    "function_body": "{\n        if (r.matchesLetter()) {\n            String name = r.consumeLetterSequence();\n            t.tagPending.appendTagName(name.toLowerCase());\n            t.dataBuffer.append(name);\n            return;\n        }\n\n        boolean needsExitTransition = false;\n        if (t.isAppropriateEndTagToken() && !r.isEmpty()) {\n            char c = r.consume();\n            switch (c) {\n                case '\\t':\n                case '\\n':\n                case '\\r':\n                case '\\f':\n                case ' ':\n                    t.transition(BeforeAttributeName);\n                    break;\n                case '/':\n                    t.transition(SelfClosingStartTag);\n                    break;\n                case '>':\n                    t.emitTagPending();\n                    t.transition(Data);\n                    break;\n                default:\n                    t.dataBuffer.append(c);\n                    needsExitTransition = true;\n            }\n        } else {\n            needsExitTransition = true;\n        }\n\n        if (needsExitTransition) {\n            t.emit(\"</\" + t.dataBuffer.toString());\n            t.transition(elseTransition);\n        }\n    }"
  },
  {
    "id": 56,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 70,
    "human_patch": "https://github.com/jhy/jsoup/commit/4edb78991f8d0bf87dafde5e01ccd8922065c9b2",
    "cve_id": "CVE-2015-6748",
    "cwe_id": "CWE-79",
    "filename": "src/main/java/org/jsoup/parser/TokeniserState.java",
    "is_vulnerable": 0,
    "class_name": "TokeniserState",
    "subclass_name": null,
    "function_name": "handleDataDoubleEscapeTag(Tokeniser t, CharacterReader r, TokeniserState primary, TokeniserState fallback)",
    "function_body": "{\n        if (r.matchesLetter()) {\n            String name = r.consumeLetterSequence();\n            t.dataBuffer.append(name.toLowerCase());\n            t.emit(name);\n            return;\n        }\n\n        char c = r.consume();\n        switch (c) {\n            case '\\t':\n            case '\\n':\n            case '\\r':\n            case '\\f':\n            case ' ':\n            case '/':\n            case '>':\n                if (t.dataBuffer.toString().equals(\"script\"))\n                    t.transition(primary);\n                else\n                    t.transition(fallback);\n                t.emit(c);\n                break;\n            default:\n                r.unconsume();\n                t.transition(fallback);\n        }\n    }"
  },
  {
    "id": 56,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 0,
    "human_patch": "https://github.com/jhy/jsoup/commit/4edb78991f8d0bf87dafde5e01ccd8922065c9b2",
    "cve_id": "CVE-2015-6748",
    "cwe_id": "CWE-79",
    "filename": "src/test/java/org/jsoup/parser/XmlTreeBuilderTest.java",
    "is_vulnerable": 0,
    "class_name": "XmlTreeBuilderTest",
    "subclass_name": null,
    "function_name": "testSimpleXmlParse()",
    "function_body": "{\n        String xml = \"<doc id=2 href='/bar'>Foo <br /><link>One</link><link>Two</link></doc>\";\n        XmlTreeBuilder tb = new XmlTreeBuilder();\n        Document doc = tb.parse(xml, \"http://foo.com/\");\n        assertEquals(\"<doc id=\\\"2\\\" href=\\\"/bar\\\">Foo <br /><link>One</link><link>Two</link></doc>\",\n                TextUtil.stripNewlines(doc.html()));\n        assertEquals(doc.getElementById(\"2\").absUrl(\"href\"), \"http://foo.com/bar\");\n    }"
  },
  {
    "id": 56,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 1,
    "human_patch": "https://github.com/jhy/jsoup/commit/4edb78991f8d0bf87dafde5e01ccd8922065c9b2",
    "cve_id": "CVE-2015-6748",
    "cwe_id": "CWE-79",
    "filename": "src/test/java/org/jsoup/parser/XmlTreeBuilderTest.java",
    "is_vulnerable": 0,
    "class_name": "XmlTreeBuilderTest",
    "subclass_name": null,
    "function_name": "testPopToClose()",
    "function_body": "{\n        \n        String xml = \"<doc><val>One<val>Two</val></bar>Three</doc>\";\n        XmlTreeBuilder tb = new XmlTreeBuilder();\n        Document doc = tb.parse(xml, \"http://foo.com/\");\n        assertEquals(\"<doc><val>One<val>Two</val>Three</val></doc>\",\n                TextUtil.stripNewlines(doc.html()));\n    }"
  },
  {
    "id": 56,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 2,
    "human_patch": "https://github.com/jhy/jsoup/commit/4edb78991f8d0bf87dafde5e01ccd8922065c9b2",
    "cve_id": "CVE-2015-6748",
    "cwe_id": "CWE-79",
    "filename": "src/test/java/org/jsoup/parser/XmlTreeBuilderTest.java",
    "is_vulnerable": 0,
    "class_name": "XmlTreeBuilderTest",
    "subclass_name": null,
    "function_name": "testCommentAndDocType()",
    "function_body": "{\n        String xml = \"<!DOCTYPE html><!-- a comment -->One <qux />Two\";\n        XmlTreeBuilder tb = new XmlTreeBuilder();\n        Document doc = tb.parse(xml, \"http://foo.com/\");\n        assertEquals(\"<!DOCTYPE html><!-- a comment -->One <qux />Two\",\n                TextUtil.stripNewlines(doc.html()));\n    }"
  },
  {
    "id": 56,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 3,
    "human_patch": "https://github.com/jhy/jsoup/commit/4edb78991f8d0bf87dafde5e01ccd8922065c9b2",
    "cve_id": "CVE-2015-6748",
    "cwe_id": "CWE-79",
    "filename": "src/test/java/org/jsoup/parser/XmlTreeBuilderTest.java",
    "is_vulnerable": 0,
    "class_name": "XmlTreeBuilderTest",
    "subclass_name": null,
    "function_name": "testSupplyParserToJsoupClass()",
    "function_body": "{\n        String xml = \"<doc><val>One<val>Two</val></bar>Three</doc>\";\n        Document doc = Jsoup.parse(xml, \"http://foo.com/\", Parser.xmlParser());\n        assertEquals(\"<doc><val>One<val>Two</val>Three</val></doc>\",\n                TextUtil.stripNewlines(doc.html()));\n    }"
  },
  {
    "id": 56,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 4,
    "human_patch": "https://github.com/jhy/jsoup/commit/4edb78991f8d0bf87dafde5e01ccd8922065c9b2",
    "cve_id": "CVE-2015-6748",
    "cwe_id": "CWE-79",
    "filename": "src/test/java/org/jsoup/parser/XmlTreeBuilderTest.java",
    "is_vulnerable": 0,
    "class_name": "XmlTreeBuilderTest",
    "subclass_name": null,
    "function_name": "testSupplyParserToConnection() throws IOException",
    "function_body": "{\n        String xmlUrl = \"http://direct.infohound.net/tools/jsoup-xml-test.xml\";\n\n        \n        Document xmlDoc = Jsoup.connect(xmlUrl).parser(Parser.xmlParser()).get();\n        Document htmlDoc = Jsoup.connect(xmlUrl).get();\n\n        assertEquals(\"<doc><val>One<val>Two</val>Three</val></doc>\",\n                TextUtil.stripNewlines(xmlDoc.html()));\n        assertNotSame(htmlDoc, xmlDoc);\n        assertEquals(1, htmlDoc.select(\"head\").size()); \n        assertEquals(0, xmlDoc.select(\"head\").size()); \n    }"
  },
  {
    "id": 56,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 5,
    "human_patch": "https://github.com/jhy/jsoup/commit/4edb78991f8d0bf87dafde5e01ccd8922065c9b2",
    "cve_id": "CVE-2015-6748",
    "cwe_id": "CWE-79",
    "filename": "src/test/java/org/jsoup/parser/XmlTreeBuilderTest.java",
    "is_vulnerable": 0,
    "class_name": "XmlTreeBuilderTest",
    "subclass_name": null,
    "function_name": "testSupplyParserToDataStream() throws IOException, URISyntaxException",
    "function_body": "{\n        File xmlFile = new File(XmlTreeBuilder.class.getResource(\"/htmltests/xml-test.xml\").toURI());\n        InputStream inStream = new FileInputStream(xmlFile);\n        Document doc = Jsoup.parse(inStream, null, \"http://foo.com\", Parser.xmlParser());\n        assertEquals(\"<doc><val>One<val>Two</val>Three</val></doc>\",\n                TextUtil.stripNewlines(doc.html()));\n    }"
  },
  {
    "id": 56,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 6,
    "human_patch": "https://github.com/jhy/jsoup/commit/4edb78991f8d0bf87dafde5e01ccd8922065c9b2",
    "cve_id": "CVE-2015-6748",
    "cwe_id": "CWE-79",
    "filename": "src/test/java/org/jsoup/parser/XmlTreeBuilderTest.java",
    "is_vulnerable": 0,
    "class_name": "XmlTreeBuilderTest",
    "subclass_name": null,
    "function_name": "testDoesNotForceSelfClosingKnownTags()",
    "function_body": "{\n        \n        Document htmlDoc = Jsoup.parse(\"<br>one</br>\");\n        assertEquals(\"<br>one\\n<br>\", htmlDoc.body().html());\n\n        Document xmlDoc = Jsoup.parse(\"<br>one</br>\", \"\", Parser.xmlParser());\n        assertEquals(\"<br>one</br>\", xmlDoc.html());\n    }"
  },
  {
    "id": 56,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 7,
    "human_patch": "https://github.com/jhy/jsoup/commit/4edb78991f8d0bf87dafde5e01ccd8922065c9b2",
    "cve_id": "CVE-2015-6748",
    "cwe_id": "CWE-79",
    "filename": "src/test/java/org/jsoup/parser/XmlTreeBuilderTest.java",
    "is_vulnerable": 0,
    "class_name": "XmlTreeBuilderTest",
    "subclass_name": null,
    "function_name": "handlesXmlDeclarationAsDeclaration()",
    "function_body": "{\n        String html = \"<?xml encoding='UTF-8' ?><body>One</body><!-- comment -->\";\n        Document doc = Jsoup.parse(html, \"\", Parser.xmlParser());\n        assertEquals(\"<?xml encoding='UTF-8' ?> <body> One </body> <!-- comment -->\",\n                StringUtil.normaliseWhitespace(doc.outerHtml()));\n        assertEquals(\"#declaration\", doc.childNode(0).nodeName());\n        assertEquals(\"#comment\", doc.childNode(2).nodeName());\n    }"
  },
  {
    "id": 56,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 8,
    "human_patch": "https://github.com/jhy/jsoup/commit/4edb78991f8d0bf87dafde5e01ccd8922065c9b2",
    "cve_id": "CVE-2015-6748",
    "cwe_id": "CWE-79",
    "filename": "src/test/java/org/jsoup/parser/XmlTreeBuilderTest.java",
    "is_vulnerable": 0,
    "class_name": "XmlTreeBuilderTest",
    "subclass_name": null,
    "function_name": "xmlFragment()",
    "function_body": "{\n        String xml = \"<one src='/foo/' />Two<three><four /></three>\";\n        List<Node> nodes = Parser.parseXmlFragment(xml, \"http://example.com/\");\n        assertEquals(3, nodes.size());\n\n        assertEquals(\"http://example.com/foo/\", nodes.get(0).absUrl(\"src\"));\n        assertEquals(\"one\", nodes.get(0).nodeName());\n        assertEquals(\"Two\", ((TextNode)nodes.get(1)).text());\n    }"
  },
  {
    "id": 56,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 9,
    "human_patch": "https://github.com/jhy/jsoup/commit/4edb78991f8d0bf87dafde5e01ccd8922065c9b2",
    "cve_id": "CVE-2015-6748",
    "cwe_id": "CWE-79",
    "filename": "src/test/java/org/jsoup/parser/XmlTreeBuilderTest.java",
    "is_vulnerable": 0,
    "class_name": "XmlTreeBuilderTest",
    "subclass_name": null,
    "function_name": "xmlParseDefaultsToHtmlOutputSyntax()",
    "function_body": "{\n        Document doc = Jsoup.parse(\"x\", \"\", Parser.xmlParser());\n        assertEquals(Syntax.xml, doc.outputSettings().syntax());\n    }"
  },
  {
    "id": 57,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 0,
    "human_patch": "https://github.com/nahsra/antisamy/commit/7313931dc3c0d1377b010f07faef2063dd359a36",
    "cve_id": "CVE-2016-10006",
    "cwe_id": "CWE-79",
    "filename": "src/main/java/org/owasp/validator/html/scan/MagicSAXFilter.java",
    "is_vulnerable": 0,
    "class_name": "MagicSAXFilter",
    "subclass_name": null,
    "function_name": "reset(InternalPolicy instance)",
    "function_body": "{\n        this.policy = instance;\n        isNofollowAnchors = policy.isNofollowAnchors();\n        isValidateParamAsEmbed = policy.isValidateParamAsEmbed();\n        preserveComments = policy.isPreserveComments();\n        maxInputSize = policy.getMaxInputSize();\n        externalCssScanner = policy.isEmbedStyleSheets();\n        operations.clear();\n        errorMessages.clear();\n        cssContent = null;\n        cssAttributes = null;\n        cssScanner = null;\n        inCdata = false;\n\n    }"
  },
  {
    "id": 57,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 1,
    "human_patch": "https://github.com/nahsra/antisamy/commit/7313931dc3c0d1377b010f07faef2063dd359a36",
    "cve_id": "CVE-2016-10006",
    "cwe_id": "CWE-79",
    "filename": "src/main/java/org/owasp/validator/html/scan/MagicSAXFilter.java",
    "is_vulnerable": 0,
    "class_name": "MagicSAXFilter",
    "subclass_name": null,
    "function_name": "characters(XMLString text, Augmentations augs) throws XNIException",
    "function_body": "{\n        \n        Ops topOp = peekTop();\n        \n        if (topOp ==  Ops.REMOVE) {\n\t\t\t\n\t\t} else if (topOp == Ops.CSS) {\n\t\t\t\n\t\t\t\n\t\t\tcssContent.append(text.ch, text.offset, text.length);\n\t\t} else {\n\t\t\t\n\t\t\tif ( inCdata ) {\n\t\t\t\tString encoded = HTMLEntityEncoder.htmlEntityEncode(text.toString());\n                addError(ErrorMessageUtil.ERROR_CDATA_FOUND, new Object[]{encoded});\n\t\t\t}\n\t\t\tsuper.characters(text, augs);\n\t\t}\n\t}"
  },
  {
    "id": 57,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 2,
    "human_patch": "https://github.com/nahsra/antisamy/commit/7313931dc3c0d1377b010f07faef2063dd359a36",
    "cve_id": "CVE-2016-10006",
    "cwe_id": "CWE-79",
    "filename": "src/main/java/org/owasp/validator/html/scan/MagicSAXFilter.java",
    "is_vulnerable": 0,
    "class_name": "MagicSAXFilter",
    "subclass_name": null,
    "function_name": "comment(XMLString text, Augmentations augs) throws XNIException",
    "function_body": "{\n\n\t\tif (preserveComments) {\n\t\t\tString value = text.toString();\n\t\t\t\n\t\t\t\n\t\t\tif (value != null) {\n                value = conditionalDirectives.matcher(value).replaceAll(\"\");\n\t\t\t\tsuper.comment(new XMLString(value.toCharArray(), 0, value.length()), augs);\n\t\t\t}\n\t\t}\n\t}"
  },
  {
    "id": 57,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 3,
    "human_patch": "https://github.com/nahsra/antisamy/commit/7313931dc3c0d1377b010f07faef2063dd359a36",
    "cve_id": "CVE-2016-10006",
    "cwe_id": "CWE-79",
    "filename": "src/main/java/org/owasp/validator/html/scan/MagicSAXFilter.java",
    "is_vulnerable": 0,
    "class_name": "MagicSAXFilter",
    "subclass_name": null,
    "function_name": "doctypeDecl(String root, String publicId, String systemId, Augmentations augs) throws XNIException",
    "function_body": "{\n\t\t\n\t}"
  },
  {
    "id": 57,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 4,
    "human_patch": "https://github.com/nahsra/antisamy/commit/7313931dc3c0d1377b010f07faef2063dd359a36",
    "cve_id": "CVE-2016-10006",
    "cwe_id": "CWE-79",
    "filename": "src/main/java/org/owasp/validator/html/scan/MagicSAXFilter.java",
    "is_vulnerable": 0,
    "class_name": "MagicSAXFilter",
    "subclass_name": null,
    "function_name": "emptyElement(QName element, XMLAttributes attributes, Augmentations augs) throws XNIException",
    "function_body": "{\n\t\tthis.startElement(element, attributes, augs);\n\t\tthis.endElement(element, augs);\n\t}"
  },
  {
    "id": 57,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 5,
    "human_patch": "https://github.com/nahsra/antisamy/commit/7313931dc3c0d1377b010f07faef2063dd359a36",
    "cve_id": "CVE-2016-10006",
    "cwe_id": "CWE-79",
    "filename": "src/main/java/org/owasp/validator/html/scan/MagicSAXFilter.java",
    "is_vulnerable": 0,
    "class_name": "MagicSAXFilter",
    "subclass_name": null,
    "function_name": "peekTop()",
    "function_body": "{\n         return operations.empty() ? null : operations.peek();\n    }"
  },
  {
    "id": 57,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 6,
    "human_patch": "https://github.com/nahsra/antisamy/commit/7313931dc3c0d1377b010f07faef2063dd359a36",
    "cve_id": "CVE-2016-10006",
    "cwe_id": "CWE-79",
    "filename": "src/main/java/org/owasp/validator/html/scan/MagicSAXFilter.java",
    "is_vulnerable": 0,
    "class_name": "MagicSAXFilter",
    "subclass_name": null,
    "function_name": "endElement(QName element, Augmentations augs) throws XNIException",
    "function_body": "{\n        Ops topOp = peekTop();\n        if (Ops.REMOVE == topOp) {\n\t\t\t\n\t\t\toperations.pop();\n\t\t} else if (Ops.FILTER == topOp) {\n\t\t\t\n\t\t\toperations.pop();\n\t\t} else if (Ops.CSS == topOp) {\n\t\t\toperations.pop();\n\t\t\t\n\t\t\tCssScanner cssScanner = makeCssScanner();\n\t\t\ttry {\n\t\t\t\tCleanResults results = cssScanner.scanStyleSheet(cssContent.toString(), maxInputSize);\n\t\t\t\t\n\t\t\t\terrorMessages.addAll(results.getErrorMessages());\n\t\t\t\t\n                \n                if (results.getCleanHTML() == null || results.getCleanHTML().equals(\"\")) {\n\t\t\t\t\t\n\t\t\t\t} else {\n\t\t\t\t\t\n\t\t\t\t\t\n\t\t\t\t\t\n\t\t\t\t\t\n\n\t\t\t\t\tsuper.startElement(element, cssAttributes, new AugmentationsImpl());\n\t\t\t\t\t\n\t\t\t\t\tsuper.characters(new XMLStringBuffer(results.getCleanHTML()), new AugmentationsImpl());\n\t\t\t\t\t\n\t\t\t\t\tsuper.endElement(element, augs);\n\t\t\t\t}\n\t\t\t} catch (ScanException e) {\n\t\t\t\t\n\t\t\t\t\n\t\t\t\taddError(ErrorMessageUtil.ERROR_CSS_TAG_MALFORMED, new Object[] {\n\t\t\t\t\tHTMLEntityEncoder.htmlEntityEncode(cssContent.toString())\n\t\t\t\t});\n\t\t\t} finally {\n\t\t\t\t\n\t\t\t\t\n\t\t\t\tcssContent = null;\n\t\t\t\tcssAttributes = null;\n\t\t\t}\n\t\t} else {\n\t\t\t\n\t\t\toperations.pop();\n\t\t\tsuper.endElement(element, augs);\n\t\t}\n\t}"
  },
  {
    "id": 57,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 7,
    "human_patch": "https://github.com/nahsra/antisamy/commit/7313931dc3c0d1377b010f07faef2063dd359a36",
    "cve_id": "CVE-2016-10006",
    "cwe_id": "CWE-79",
    "filename": "src/main/java/org/owasp/validator/html/scan/MagicSAXFilter.java",
    "is_vulnerable": 0,
    "class_name": "MagicSAXFilter",
    "subclass_name": null,
    "function_name": "makeCssScanner()",
    "function_body": "{\n\t\tif (cssScanner == null) {\n            cssScanner = externalCssScanner ? new ExternalCssScanner(policy, messages) : new CssScanner(policy, messages);\n\t\t}\n\t\treturn cssScanner;\n\t}"
  },
  {
    "id": 57,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 8,
    "human_patch": "https://github.com/nahsra/antisamy/commit/7313931dc3c0d1377b010f07faef2063dd359a36",
    "cve_id": "CVE-2016-10006",
    "cwe_id": "CWE-79",
    "filename": "src/main/java/org/owasp/validator/html/scan/MagicSAXFilter.java",
    "is_vulnerable": 0,
    "class_name": "MagicSAXFilter",
    "subclass_name": null,
    "function_name": "processingInstruction(String target, XMLString data, Augmentations augs) throws XNIException",
    "function_body": "{\n\t\t\n\t}"
  },
  {
    "id": 57,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 9,
    "human_patch": "https://github.com/nahsra/antisamy/commit/7313931dc3c0d1377b010f07faef2063dd359a36",
    "cve_id": "CVE-2016-10006",
    "cwe_id": "CWE-79",
    "filename": "src/main/java/org/owasp/validator/html/scan/MagicSAXFilter.java",
    "is_vulnerable": 0,
    "class_name": "MagicSAXFilter",
    "subclass_name": null,
    "function_name": "startCDATA(Augmentations augs) throws XNIException",
    "function_body": "{\n\t\tinCdata = true;\n\t\tsuper.startCDATA(augs);\n\t}"
  },
  {
    "id": 57,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 10,
    "human_patch": "https://github.com/nahsra/antisamy/commit/7313931dc3c0d1377b010f07faef2063dd359a36",
    "cve_id": "CVE-2016-10006",
    "cwe_id": "CWE-79",
    "filename": "src/main/java/org/owasp/validator/html/scan/MagicSAXFilter.java",
    "is_vulnerable": 0,
    "class_name": "MagicSAXFilter",
    "subclass_name": null,
    "function_name": "endCDATA(Augmentations augs) throws XNIException",
    "function_body": "{\n\t\tinCdata = false;\n\t\tsuper.endCDATA(augs);\n\t}"
  },
  {
    "id": 57,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 11,
    "human_patch": "https://github.com/nahsra/antisamy/commit/7313931dc3c0d1377b010f07faef2063dd359a36",
    "cve_id": "CVE-2016-10006",
    "cwe_id": "CWE-79",
    "filename": "src/main/java/org/owasp/validator/html/scan/MagicSAXFilter.java",
    "is_vulnerable": 1,
    "class_name": "MagicSAXFilter",
    "subclass_name": null,
    "function_name": "startElement(QName element, XMLAttributes attributes, Augmentations augs) throws XNIException",
    "function_body": "{\n\t\t\n        String tagNameLowerCase = element.localpart.toLowerCase();\n        Tag tag = policy.getTagByLowercaseName(tagNameLowerCase);\n\n\t\t\n\t\tboolean masqueradingParam = false;\n\t\tString embedName = null;\n\t\tString embedValue = null;\n\t\tif (tag == null && isValidateParamAsEmbed && \"param\".equals(tagNameLowerCase)) {\n\t\t\tTag embedPolicy = policy.getEmbedTag();\n\t\t\tif (embedPolicy != null && embedPolicy.isAction( Policy.ACTION_VALIDATE)) {\n\t\t\t\ttag = embedPolicy;\n\t\t\t\tmasqueradingParam = true;\n\t\t\t\t\n\t\t\t\t\n\t\t\t\tembedName = attributes.getValue(\"name\");\n\t\t\t\tembedValue = attributes.getValue(\"value\");\n\t\t\t\tXMLAttributes masqueradingAttrs = new XMLAttributesImpl();\n\t\t\t\tmasqueradingAttrs.addAttribute(makeSimpleQname(embedName), \"CDATA\", embedValue);\n\t\t\t\tattributes = masqueradingAttrs;\n\t\t\t}\n\t\t}\n\n\t\tXMLAttributes validattributes = new XMLAttributesImpl();\n        Ops topOp = peekTop();\n        if (Ops.REMOVE == topOp || Ops.CSS == topOp) {\n\t\t\t\n\t\t\t\n\t\t\tthis.operations.push( Ops.REMOVE);\n\t\t} else if ((tag == null && policy.isEncodeUnknownTag()) || (tag != null && tag.isAction( \"encode\" ))) {\n\t\t\tString name = \"<\" + element.localpart + \">\";\n\t\t\tsuper.characters( new XMLString( name.toCharArray(), 0, name.length() ), augs );\n\t\t\tthis.operations.push(Ops.FILTER);\n\t\t} else if (tag == null) {\n\t\t\taddError( ErrorMessageUtil.ERROR_TAG_NOT_IN_POLICY,\n                      new Object[]{ HTMLEntityEncoder.htmlEntityEncode( element.localpart ) } );\n\t\t\tthis.operations.push(Ops.FILTER);\n\t\t} else if (tag.isAction( \"filter\")) {\n\t\t\taddError(ErrorMessageUtil.ERROR_TAG_FILTERED, new Object[] {\n\t\t\t\tHTMLEntityEncoder.htmlEntityEncode(element.localpart)\n\t\t\t});\n\t\t\tthis.operations.push(Ops.FILTER);\n\t\t} else if (tag.isAction( \"validate\")) {\n\n\t\t\tboolean isStyle = \"style\".endsWith(element.localpart);\n\n\t\t\tif (isStyle) {\n\t\t\t\tthis.operations.push(Ops.CSS);\n\t\t\t\tcssContent = new StringBuffer();\n\t\t\t\tcssAttributes = attributes;\n\t\t\t} else {\n\t\t\t\t\n\t\t\t\t\n\t\t\t\tboolean removeTag = false;\n\t\t\t\tboolean filterTag = false;\n\t\t\t\tfor (int i = 0; i < attributes.getLength(); i++) {\n\t\t\t\t\tString name = attributes.getQName(i);\n\t\t\t\t\tString value = attributes.getValue(i);\n\t\t\t\t\tString nameLower = name.toLowerCase();\n\t\t\t\t\tAttribute attribute = tag.getAttributeByName(nameLower);\n\t\t\t\t\tif (attribute == null) {\n\t\t\t\t\t\t\n\t\t\t\t\t\tattribute = policy.getGlobalAttributeByName(nameLower);\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\tif (\"style\".equalsIgnoreCase(name)) {\n\t\t\t\t\t\tCssScanner styleScanner = makeCssScanner();\n\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\tCleanResults cr = styleScanner.scanInlineStyle(value, element.localpart, maxInputSize);\n\t\t\t\t\t\t\tattributes.setValue(i, cr.getCleanHTML());\n\t\t\t\t\t\t\tvalidattributes.addAttribute(makeSimpleQname(name), \"CDATA\", cr.getCleanHTML());\n\t\t\t\t\t\t\terrorMessages.addAll(cr.getErrorMessages());\n\t\t\t\t\t\t} catch (ScanException e) {\n\t\t\t\t\t\t\taddError(ErrorMessageUtil.ERROR_CSS_ATTRIBUTE_MALFORMED, new Object[] {\n\t\t\t\t\t\t\t\t\telement.localpart, HTMLEntityEncoder.htmlEntityEncode(value)\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t} else if (attribute != null) {\n\t\t\t\t\t\t\n\t\t\t\t\t\tboolean isValid = false;\n                        if (attribute.containsAllowedValue(value.toLowerCase())) {\n                            validattributes.addAttribute(makeSimpleQname(name), \"CDATA\", value);\n                            isValid = true;\n                        }\n\n\n                        if (!isValid) {\n                            isValid = attribute.matchesAllowedExpression(value);\n                            if (isValid) {\n                                validattributes.addAttribute(makeSimpleQname(name), \"CDATA\", value);\n                            }\n                        }\n\n\n                        \n\t\t\t\t\t\t\n\t\t\t\t\t\tif (!isValid && \"removeTag\".equals(attribute.getOnInvalid())) {\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\taddError(ErrorMessageUtil.ERROR_ATTRIBUTE_INVALID_REMOVED,\n\t\t\t\t\t\t\t\tnew Object[] { tag.getName(), HTMLEntityEncoder.htmlEntityEncode(name), HTMLEntityEncoder.htmlEntityEncode(value) });\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\tremoveTag = true;\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t} else if (!isValid && (\"filterTag\".equals(attribute.getOnInvalid()) || masqueradingParam)) {\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\taddError(ErrorMessageUtil.ERROR_ATTRIBUTE_CAUSE_FILTER, \n\t\t\t\t\t\t\t\tnew Object[] { tag.getName(), HTMLEntityEncoder.htmlEntityEncode(name), HTMLEntityEncoder.htmlEntityEncode(value) });\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\tfilterTag = true;\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t} else if (!isValid) {\n\t\t\t\t\t\t\taddError(ErrorMessageUtil.ERROR_ATTRIBUTE_INVALID, new Object[] { tag.getName(), HTMLEntityEncoder.htmlEntityEncode(name), HTMLEntityEncoder.htmlEntityEncode(value) });\n\t\t\t\t\t\t}\n\t\t\t\t\t\t\n\t\t\t\t\t} else { \n\t\t\t\t\t\taddError(ErrorMessageUtil.ERROR_ATTRIBUTE_NOT_IN_POLICY, new Object[] {\n\t\t\t\t\t\t\t\telement.localpart, HTMLEntityEncoder.htmlEntityEncode(name), HTMLEntityEncoder.htmlEntityEncode(value)\n\t\t\t\t\t\t});\n\t\t\t\t\t\t\n\t\t\t\t\t\tif (masqueradingParam) {\n\t\t\t\t\t\t\tfilterTag = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif (removeTag) {\n\t\t\t\t\tthis.operations.push(Ops.REMOVE);\n\t\t\t\t} else if (filterTag) {\n\t\t\t\t\tthis.operations.push(Ops.FILTER);\n\t\t\t\t} else {\n\n\t\t\t\t\tif (isNofollowAnchors && \"a\".equals(element.localpart)) {\n\t\t\t\t\t\tvalidattributes.addAttribute(makeSimpleQname(\"rel\"), \"CDATA\", \"nofollow\");\n\t\t\t\t\t}\n\n\t\t\t\t\tif (masqueradingParam) {\n\t\t\t\t\t\tvalidattributes = new XMLAttributesImpl();\n\t\t\t\t\t\tvalidattributes.addAttribute(makeSimpleQname(\"name\"), \"CDATA\", embedName);\n\t\t\t\t\t\tvalidattributes.addAttribute(makeSimpleQname(\"value\"), \"CDATA\", embedValue);\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.operations.push(Ops.KEEP);\n\t\t\t\t}\n\t\t\t}\n\t\t} else if (tag.isAction( \"truncate\")) {\n\t\t\tthis.operations.push(Ops.TRUNCATE);\n\t\t} else {\n\t\t\t\n\t\t\taddError(ErrorMessageUtil.ERROR_TAG_DISALLOWED, new Object[] {\n\t\t\t\tHTMLEntityEncoder.htmlEntityEncode(element.localpart)\n\t\t\t});\n\t\t\tthis.operations.push(Ops.REMOVE);\n\t\t}\n\t\t\n\t\tif ( Ops.TRUNCATE.equals( operations.peek() )) {\n\t\t\t\n\t\t\tsuper.startElement(element, new XMLAttributesImpl(), augs);\n\t\t} else if ( Ops.KEEP.equals(operations.peek())) {\n\t\t\t\n\t\t\tsuper.startElement(element, validattributes, augs);\n\t\t}\n\t}"
  },
  {
    "id": 57,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 12,
    "human_patch": "https://github.com/nahsra/antisamy/commit/7313931dc3c0d1377b010f07faef2063dd359a36",
    "cve_id": "CVE-2016-10006",
    "cwe_id": "CWE-79",
    "filename": "src/main/java/org/owasp/validator/html/scan/MagicSAXFilter.java",
    "is_vulnerable": 0,
    "class_name": "MagicSAXFilter",
    "subclass_name": null,
    "function_name": "makeSimpleQname(String name)",
    "function_body": "{\n\t\treturn new QName(\"\", name, name, \"\");\n\t}"
  },
  {
    "id": 57,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 13,
    "human_patch": "https://github.com/nahsra/antisamy/commit/7313931dc3c0d1377b010f07faef2063dd359a36",
    "cve_id": "CVE-2016-10006",
    "cwe_id": "CWE-79",
    "filename": "src/main/java/org/owasp/validator/html/scan/MagicSAXFilter.java",
    "is_vulnerable": 0,
    "class_name": "MagicSAXFilter",
    "subclass_name": null,
    "function_name": "addError(String errorKey, Object[] objs)",
    "function_body": "{\n\t\terrorMessages.add(ErrorMessageUtil.getMessage(messages, errorKey, objs));\n\t}"
  },
  {
    "id": 57,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 14,
    "human_patch": "https://github.com/nahsra/antisamy/commit/7313931dc3c0d1377b010f07faef2063dd359a36",
    "cve_id": "CVE-2016-10006",
    "cwe_id": "CWE-79",
    "filename": "src/main/java/org/owasp/validator/html/scan/MagicSAXFilter.java",
    "is_vulnerable": 0,
    "class_name": "MagicSAXFilter",
    "subclass_name": null,
    "function_name": "getErrorMessages()",
    "function_body": "{\n\t\treturn errorMessages;\n\t}"
  },
  {
    "id": 58,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 0,
    "human_patch": "https://github.com/neo4j-contrib/neo4j-apoc-procedures/commit/45bc09c8bd7f17283e2a7e85ce3f02cb4be4fd1a",
    "cve_id": "CVE-2018-1000820",
    "cwe_id": "CWE-611",
    "filename": "src/main/java/apoc/load/Xml.java",
    "is_vulnerable": 0,
    "class_name": "Xml",
    "subclass_name": null,
    "function_name": "xml(@Name(\"url\") String url, @Name(value = \"path\", defaultValue = \"/\") String path, @Name(value = \"config\",defaultValue = \"{}\") Map<String, Object> config, @Name(value = \"simple\", defaultValue = \"false\") boolean simpleMode) throws Exception",
    "function_body": "{\n        return xmlXpathToMapResult(url, simpleMode, path ,config);\n    }"
  },
  {
    "id": 58,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 1,
    "human_patch": "https://github.com/neo4j-contrib/neo4j-apoc-procedures/commit/45bc09c8bd7f17283e2a7e85ce3f02cb4be4fd1a",
    "cve_id": "CVE-2018-1000820",
    "cwe_id": "CWE-611",
    "filename": "src/main/java/apoc/load/Xml.java",
    "is_vulnerable": 0,
    "class_name": "Xml",
    "subclass_name": null,
    "function_name": "xmlSimple(@Name(\"url\") String url) throws Exception",
    "function_body": "{\n        return xmlToMapResult(url, true);\n    }"
  },
  {
    "id": 58,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 2,
    "human_patch": "https://github.com/neo4j-contrib/neo4j-apoc-procedures/commit/45bc09c8bd7f17283e2a7e85ce3f02cb4be4fd1a",
    "cve_id": "CVE-2018-1000820",
    "cwe_id": "CWE-611",
    "filename": "src/main/java/apoc/load/Xml.java",
    "is_vulnerable": 1,
    "class_name": "Xml",
    "subclass_name": null,
    "function_name": "xmlXpathToMapResult(@Name(\"url\") String url, boolean simpleMode, String path, Map<String, Object> config) throws Exception",
    "function_body": "{\n        if (config == null) config = Collections.emptyMap();\n        boolean failOnError = (boolean) config.getOrDefault(\"failOnError\", true);\n        List<MapResult> result = new ArrayList<>();\n        try {\n            DocumentBuilderFactory documentBuilderFactory = DocumentBuilderFactory.newInstance();\n            documentBuilderFactory.setNamespaceAware(true);\n            documentBuilderFactory.setIgnoringElementContentWhitespace(true);\n            DocumentBuilder documentBuilder = documentBuilderFactory.newDocumentBuilder();\n\n            FileUtils.checkReadAllowed(url);\n\n            Map<String, Object> headers = (Map) config.getOrDefault( \"headers\", Collections.emptyMap() );\n\n            Document doc = documentBuilder.parse(Util.openInputStream(url, headers, null));\n            XPathFactory xPathFactory = XPathFactory.newInstance();\n\n            XPath xPath = xPathFactory.newXPath();\n\n            path = StringUtils.isEmpty(path) ? \"/\" : path;\n            XPathExpression xPathExpression = xPath.compile(path);\n            NodeList nodeList = (NodeList) xPathExpression.evaluate(doc, XPathConstants.NODESET);\n\n            for (int i = 0; i < nodeList.getLength(); i++) {\n                final Deque<Map<String, Object>> stack = new LinkedList<>();\n\n                handleNode(stack, nodeList.item(i), simpleMode);\n                for (int index = 0; index < stack.size(); index++) {\n                    result.add(new MapResult(stack.pollFirst()));\n                }\n            }\n        }\n        catch (FileNotFoundException e){\n            if(!failOnError)\n                return Stream.of(new MapResult(Collections.emptyMap()));\n            else\n                throw new FileNotFoundException(e.getMessage());\n        }\n        catch (Exception e){\n            if(!failOnError)\n                return Stream.of(new MapResult(Collections.emptyMap()));\n            else\n                throw new Exception(e);\n        }\n        return result.stream();\n    }"
  },
  {
    "id": 58,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 3,
    "human_patch": "https://github.com/neo4j-contrib/neo4j-apoc-procedures/commit/45bc09c8bd7f17283e2a7e85ce3f02cb4be4fd1a",
    "cve_id": "CVE-2018-1000820",
    "cwe_id": "CWE-611",
    "filename": "src/main/java/apoc/load/Xml.java",
    "is_vulnerable": 0,
    "class_name": "Xml",
    "subclass_name": null,
    "function_name": "xmlToMapResult(@Name(\"url\") String url, boolean simpleMode)",
    "function_body": "{\n        try {\n            XMLStreamReader reader = getXMLStreamReaderFromUrl(url);\n            final Deque<Map<String, Object>> stack = new LinkedList<>();\n            do {\n                handleXmlEvent(stack, reader, simpleMode);\n            } while (proceedReader(reader));\n\n            return Stream.of(new MapResult(stack.getFirst()));\n        } catch (IOException | XMLStreamException e) {\n            throw new RuntimeException(\"Can't read url \" + cleanUrl(url) + \" as XML\", e);\n        }\n    }"
  },
  {
    "id": 58,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 4,
    "human_patch": "https://github.com/neo4j-contrib/neo4j-apoc-procedures/commit/45bc09c8bd7f17283e2a7e85ce3f02cb4be4fd1a",
    "cve_id": "CVE-2018-1000820",
    "cwe_id": "CWE-611",
    "filename": "src/main/java/apoc/load/Xml.java",
    "is_vulnerable": 0,
    "class_name": "Xml",
    "subclass_name": null,
    "function_name": "getXMLStreamReaderFromUrl(String url) throws IOException, XMLStreamException",
    "function_body": "{\n        FileUtils.checkReadAllowed(url);\n        URLConnection urlConnection = new URL(url).openConnection();\n        FACTORY.setProperty(XMLInputFactory.IS_COALESCING, true);\n        return FACTORY.createXMLStreamReader(urlConnection.getInputStream());\n    }"
  },
  {
    "id": 58,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 5,
    "human_patch": "https://github.com/neo4j-contrib/neo4j-apoc-procedures/commit/45bc09c8bd7f17283e2a7e85ce3f02cb4be4fd1a",
    "cve_id": "CVE-2018-1000820",
    "cwe_id": "CWE-611",
    "filename": "src/main/java/apoc/load/Xml.java",
    "is_vulnerable": 0,
    "class_name": "Xml",
    "subclass_name": null,
    "function_name": "proceedReader(XMLStreamReader reader) throws XMLStreamException",
    "function_body": "{\n        if (reader.hasNext()) {\n            do {\n                reader.next();\n            } while (reader.isWhiteSpace());\n            return true;\n        } else {\n            return false;\n        }\n    }"
  },
  {
    "id": 58,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 6,
    "human_patch": "https://github.com/neo4j-contrib/neo4j-apoc-procedures/commit/45bc09c8bd7f17283e2a7e85ce3f02cb4be4fd1a",
    "cve_id": "CVE-2018-1000820",
    "cwe_id": "CWE-611",
    "filename": "src/main/java/apoc/load/Xml.java",
    "is_vulnerable": 0,
    "class_name": "Xml",
    "subclass_name": null,
    "function_name": "handleXmlEvent(Deque<Map<String, Object>> stack, XMLStreamReader reader, boolean simpleMode) throws XMLStreamException",
    "function_body": "{\n\n        Map<String, Object> elementMap;\n        switch (reader.getEventType()) {\n            case START_DOCUMENT:\n            case END_DOCUMENT:\n                \n                break;\n            case START_ELEMENT:\n                int attributes = reader.getAttributeCount();\n                elementMap = new LinkedHashMap<>(attributes + 3);\n                elementMap.put(\"_type\", reader.getLocalName());\n                for (int a = 0; a < attributes; a++) {\n                    elementMap.put(reader.getAttributeLocalName(a), reader.getAttributeValue(a));\n                }\n                if (!stack.isEmpty()) {\n                    final Map<String, Object> last = stack.getLast();\n                    String key = simpleMode ? \"_\" + reader.getLocalName() : \"_children\";\n                    amendToList(last, key, elementMap);\n                }\n                stack.addLast(elementMap);\n                break;\n\n            case END_ELEMENT:\n                elementMap = stack.size() > 1 ? stack.removeLast() : stack.getLast();\n\n                \n                \n                Object children = elementMap.get(\"_children\");\n                if (children != null) {\n                    if ((children instanceof String) || collectionIsAllStrings(children)) {\n                        elementMap.put(\"_text\", children);\n                        elementMap.remove(\"_children\");\n                    }\n                }\n                break;\n\n            case CHARACTERS:\n                final String text = reader.getText().trim();\n                if (!text.isEmpty()) {\n                    Map<String, Object> map = stack.getLast();\n                    amendToList(map, \"_children\", text);\n                }\n                break;\n            default:\n                throw new RuntimeException(\"dunno know how to handle xml event type \" + reader.getEventType());\n        }\n    }"
  },
  {
    "id": 58,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 7,
    "human_patch": "https://github.com/neo4j-contrib/neo4j-apoc-procedures/commit/45bc09c8bd7f17283e2a7e85ce3f02cb4be4fd1a",
    "cve_id": "CVE-2018-1000820",
    "cwe_id": "CWE-611",
    "filename": "src/main/java/apoc/load/Xml.java",
    "is_vulnerable": 0,
    "class_name": "Xml",
    "subclass_name": null,
    "function_name": "handleNode(Deque<Map<String, Object>> stack, Node node, boolean simpleMode)",
    "function_body": "{\n\n        \n        if (node.getNodeType() == Node.DOCUMENT_NODE) {\n            NodeList children = node.getChildNodes();\n            for (int i = 0; i < children.getLength(); i++) {\n                if (children.item(i).getLocalName() != null) {\n                    handleNode(stack, children.item(i), simpleMode);\n                    return;\n                }\n            }\n        }\n\n        Map<String, Object> elementMap = new LinkedHashMap<>();\n        handleTypeAndAttributes(node, elementMap);\n\n        \n        NodeList children = node.getChildNodes();\n        int count = 0;\n        for (int i = 0; i < children.getLength(); i++) {\n            Node child = children.item(i);\n\n            \n            if (child.getNodeType() != Node.TEXT_NODE && child.getNodeType() != Node.CDATA_SECTION_NODE) {\n                handleNode(stack, child, simpleMode);\n                count++;\n            } else {\n                \n                handleTextNode(child, elementMap);\n            }\n        }\n\n        if (children.getLength() > 1) {\n            if (!stack.isEmpty()) {\n                List<Object> nodeChildren = new ArrayList<>();\n                for (int i = 0; i < count; i++) {\n                    nodeChildren.add(stack.pollLast());\n                }\n                String key = simpleMode ? \"_\" + node.getLocalName() : \"_children\";\n                Collections.reverse(nodeChildren);\n                if (nodeChildren.size() > 0) {\n                    \n                    Object text = elementMap.get(\"_text\");\n                    if (text instanceof List) {\n                        for (Object element : (List) text) {\n                            nodeChildren.add(element);\n                        }\n                        elementMap.remove(\"_text\");\n                    }\n\n                    elementMap.put(key, nodeChildren);\n                }\n            }\n        }\n\n        if (!elementMap.isEmpty()) {\n            stack.addLast(elementMap);\n        }\n    }"
  },
  {
    "id": 58,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 8,
    "human_patch": "https://github.com/neo4j-contrib/neo4j-apoc-procedures/commit/45bc09c8bd7f17283e2a7e85ce3f02cb4be4fd1a",
    "cve_id": "CVE-2018-1000820",
    "cwe_id": "CWE-611",
    "filename": "src/main/java/apoc/load/Xml.java",
    "is_vulnerable": 0,
    "class_name": "Xml",
    "subclass_name": null,
    "function_name": "handleTypeAndAttributes(Node node, Map<String, Object> elementMap)",
    "function_body": "{\n        \n        if (node.getLocalName() != null) {\n            elementMap.put(\"_type\", node.getLocalName());\n        }\n\n        \n        if (node.getAttributes() != null) {\n            NamedNodeMap attributeMap = node.getAttributes();\n            for (int i = 0; i < attributeMap.getLength(); i++) {\n                Node attribute = attributeMap.item(i);\n                elementMap.put(attribute.getNodeName(), attribute.getNodeValue());\n            }\n        }\n    }"
  },
  {
    "id": 58,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 9,
    "human_patch": "https://github.com/neo4j-contrib/neo4j-apoc-procedures/commit/45bc09c8bd7f17283e2a7e85ce3f02cb4be4fd1a",
    "cve_id": "CVE-2018-1000820",
    "cwe_id": "CWE-611",
    "filename": "src/main/java/apoc/load/Xml.java",
    "is_vulnerable": 0,
    "class_name": "Xml",
    "subclass_name": null,
    "function_name": "handleTextNode(Node node, Map<String, Object> elementMap)",
    "function_body": "{\n        Object text = \"\";\n        int nodeType = node.getNodeType();\n        switch (nodeType) {\n            case Node.TEXT_NODE:\n                text = normalizeText(node.getNodeValue());\n                break;\n            case Node.CDATA_SECTION_NODE:\n                text = normalizeText(((CharacterData) node).getData());\n                break;\n            default:\n                break;\n        }\n\n        \n        if (!StringUtils.isEmpty(text.toString())) {\n            \n            Object previousText = elementMap.get(\"_text\");\n            if (previousText != null) {\n                \n                text = Arrays.asList(previousText.toString(), text);\n            }\n            elementMap.put(\"_text\", text);\n        }\n    }"
  },
  {
    "id": 58,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 10,
    "human_patch": "https://github.com/neo4j-contrib/neo4j-apoc-procedures/commit/45bc09c8bd7f17283e2a7e85ce3f02cb4be4fd1a",
    "cve_id": "CVE-2018-1000820",
    "cwe_id": "CWE-611",
    "filename": "src/main/java/apoc/load/Xml.java",
    "is_vulnerable": 0,
    "class_name": "Xml",
    "subclass_name": null,
    "function_name": "normalizeText(String text)",
    "function_body": "{\n        String[] tokens = StringUtils.split(text, \"\\n\");\n        for (int i = 0; i < tokens.length; i++) {\n            tokens[i] = tokens[i].trim();\n        }\n\n        return StringUtils.join(tokens, \" \").trim();\n    }"
  },
  {
    "id": 58,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 11,
    "human_patch": "https://github.com/neo4j-contrib/neo4j-apoc-procedures/commit/45bc09c8bd7f17283e2a7e85ce3f02cb4be4fd1a",
    "cve_id": "CVE-2018-1000820",
    "cwe_id": "CWE-611",
    "filename": "src/main/java/apoc/load/Xml.java",
    "is_vulnerable": 0,
    "class_name": "Xml",
    "subclass_name": null,
    "function_name": "collectionIsAllStrings(Object collection)",
    "function_body": "{\n        if (collection instanceof Collection) {\n            return ((Collection<Object>) collection).stream().allMatch(o -> o instanceof String);\n        } else {\n            return false;\n        }\n    }"
  },
  {
    "id": 58,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 12,
    "human_patch": "https://github.com/neo4j-contrib/neo4j-apoc-procedures/commit/45bc09c8bd7f17283e2a7e85ce3f02cb4be4fd1a",
    "cve_id": "CVE-2018-1000820",
    "cwe_id": "CWE-611",
    "filename": "src/main/java/apoc/load/Xml.java",
    "is_vulnerable": 0,
    "class_name": "Xml",
    "subclass_name": null,
    "function_name": "amendToList(Map<String, Object> map, String key, Object value)",
    "function_body": "{\n        final Object element = map.get(key);\n        if (element == null) {\n            map.put(key, value);\n        } else {\n            if (element instanceof List) {\n                ((List) element).add(value);\n            } else {\n                List<Object> list = new LinkedList<>();\n                list.add(element);\n                list.add(value);\n                map.put(key, list);\n            }\n        }\n    }"
  },
  {
    "id": 58,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 13,
    "human_patch": "https://github.com/neo4j-contrib/neo4j-apoc-procedures/commit/45bc09c8bd7f17283e2a7e85ce3f02cb4be4fd1a",
    "cve_id": "CVE-2018-1000820",
    "cwe_id": "CWE-611",
    "filename": "src/main/java/apoc/load/Xml.java",
    "is_vulnerable": 0,
    "class_name": "Xml",
    "subclass_name": "ParentAndChildPair",
    "function_name": "getParent()",
    "function_body": "{\n            return parent;\n        }"
  },
  {
    "id": 58,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 14,
    "human_patch": "https://github.com/neo4j-contrib/neo4j-apoc-procedures/commit/45bc09c8bd7f17283e2a7e85ce3f02cb4be4fd1a",
    "cve_id": "CVE-2018-1000820",
    "cwe_id": "CWE-611",
    "filename": "src/main/java/apoc/load/Xml.java",
    "is_vulnerable": 0,
    "class_name": "Xml",
    "subclass_name": "ParentAndChildPair",
    "function_name": "setParent(org.neo4j.graphdb.Node parent)",
    "function_body": "{\n            this.parent = parent;\n        }"
  },
  {
    "id": 58,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 15,
    "human_patch": "https://github.com/neo4j-contrib/neo4j-apoc-procedures/commit/45bc09c8bd7f17283e2a7e85ce3f02cb4be4fd1a",
    "cve_id": "CVE-2018-1000820",
    "cwe_id": "CWE-611",
    "filename": "src/main/java/apoc/load/Xml.java",
    "is_vulnerable": 0,
    "class_name": "Xml",
    "subclass_name": "ParentAndChildPair",
    "function_name": "getPreviousChild()",
    "function_body": "{\n            return previousChild;\n        }"
  },
  {
    "id": 58,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 16,
    "human_patch": "https://github.com/neo4j-contrib/neo4j-apoc-procedures/commit/45bc09c8bd7f17283e2a7e85ce3f02cb4be4fd1a",
    "cve_id": "CVE-2018-1000820",
    "cwe_id": "CWE-611",
    "filename": "src/main/java/apoc/load/Xml.java",
    "is_vulnerable": 0,
    "class_name": "Xml",
    "subclass_name": "ParentAndChildPair",
    "function_name": "setPreviousChild(org.neo4j.graphdb.Node previousChild)",
    "function_body": "{\n            this.previousChild = previousChild;\n        }"
  },
  {
    "id": 58,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 17,
    "human_patch": "https://github.com/neo4j-contrib/neo4j-apoc-procedures/commit/45bc09c8bd7f17283e2a7e85ce3f02cb4be4fd1a",
    "cve_id": "CVE-2018-1000820",
    "cwe_id": "CWE-611",
    "filename": "src/main/java/apoc/load/Xml.java",
    "is_vulnerable": 0,
    "class_name": "Xml",
    "subclass_name": "ParentAndChildPair",
    "function_name": "equals(Object o)",
    "function_body": "{\n            if (this == o) return true;\n            if (o == null || getClass() != o.getClass()) return false;\n            ParentAndChildPair that = (ParentAndChildPair) o;\n            return parent.equals(that.parent);\n        }"
  },
  {
    "id": 58,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 18,
    "human_patch": "https://github.com/neo4j-contrib/neo4j-apoc-procedures/commit/45bc09c8bd7f17283e2a7e85ce3f02cb4be4fd1a",
    "cve_id": "CVE-2018-1000820",
    "cwe_id": "CWE-611",
    "filename": "src/main/java/apoc/load/Xml.java",
    "is_vulnerable": 0,
    "class_name": "Xml",
    "subclass_name": "ParentAndChildPair",
    "function_name": "hashCode()",
    "function_body": "{\n            return parent.hashCode();\n        }"
  },
  {
    "id": 58,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 19,
    "human_patch": "https://github.com/neo4j-contrib/neo4j-apoc-procedures/commit/45bc09c8bd7f17283e2a7e85ce3f02cb4be4fd1a",
    "cve_id": "CVE-2018-1000820",
    "cwe_id": "CWE-611",
    "filename": "src/main/java/apoc/load/Xml.java",
    "is_vulnerable": 0,
    "class_name": "Xml",
    "subclass_name": "XmlImportConfig",
    "function_name": "isCreateNextWordRelationship()",
    "function_body": "{\n            return createNextWordRelationship;\n        }"
  },
  {
    "id": 58,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 20,
    "human_patch": "https://github.com/neo4j-contrib/neo4j-apoc-procedures/commit/45bc09c8bd7f17283e2a7e85ce3f02cb4be4fd1a",
    "cve_id": "CVE-2018-1000820",
    "cwe_id": "CWE-611",
    "filename": "src/main/java/apoc/load/Xml.java",
    "is_vulnerable": 0,
    "class_name": "Xml",
    "subclass_name": null,
    "function_name": "importToGraph(@Name(\"url\") String url, @Name(value=\"config\", defaultValue = \"{}\") Map<String, Object> config) throws IOException, XMLStreamException",
    "function_body": "{\n        final XMLStreamReader xml = getXMLStreamReaderFromUrl(url);\n\n        XmlImportConfig importConfig = new XmlImportConfig(config);\n        \n\n        \n        Deque<ParentAndChildPair> parents = new ArrayDeque<>();\n        org.neo4j.graphdb.Node root = db.createNode(Label.label(\"XmlDocument\"));\n        setPropertyIfNotNull(root, \"_xmlVersion\", xml.getVersion());\n        setPropertyIfNotNull(root, \"_xmlEncoding\", xml.getEncoding());\n        root.setProperty(\"url\", url);\n        parents.push(new ParentAndChildPair(root));\n        org.neo4j.graphdb.Node last = root;\n        org.neo4j.graphdb.Node lastWord = root;\n\n        while (xml.hasNext()) {\n            xml.next();\n\n            switch (xml.getEventType()) {\n                case XMLStreamConstants.START_DOCUMENT:\n                    \n                    break;\n\n                case XMLStreamConstants.PROCESSING_INSTRUCTION:\n                    org.neo4j.graphdb.Node pi = db.createNode(Label.label(\"XmlProcessingInstruction\"));\n                    pi.setProperty(\"_piData\", xml.getPIData());\n                    pi.setProperty(\"_piTarget\", xml.getPITarget());\n                    last = connectWithParent(pi, parents.peek(), last);\n                    break;\n\n                case XMLStreamConstants.START_ELEMENT:\n                    final QName qName = xml.getName();\n                    final org.neo4j.graphdb.Node tag = db.createNode(Label.label(\"XmlTag\"));\n                    tag.setProperty(\"_name\", qName.getLocalPart());\n                    for (int i=0; i<xml.getAttributeCount(); i++) {\n                        tag.setProperty(xml.getAttributeLocalName(i), xml.getAttributeValue(i));\n                    }\n\n                    last = connectWithParent(tag, parents.peek(), last);\n                    parents.push(new ParentAndChildPair(tag));\n                    break;\n\n                case XMLStreamConstants.CHARACTERS:\n                    String text = xml.getText().trim();\n                    String[] words = text.split(\"\\\\s\");\n                    for (int i = 0; i < words.length; i++) {\n                        final String currentWord = words[i];\n                        if (!currentWord.isEmpty()) {\n                            org.neo4j.graphdb.Node word = db.createNode(Label.label(\"XmlWord\"));\n                            word.setProperty(\"text\", currentWord);\n                            last = connectWithParent(word, parents.peek(), last);\n                            if (importConfig.isCreateNextWordRelationship()) {\n                                lastWord.createRelationshipTo(word, RelationshipType.withName(\"NEXT_WORD\"));\n                                lastWord = word;\n                            }\n                        }\n                    }\n                    break;\n\n                case XMLStreamConstants.END_ELEMENT:\n                    ParentAndChildPair parent = parents.pop();\n                    if (parent.getPreviousChild()!=null) {\n                        parent.getPreviousChild().createRelationshipTo(parent.getParent(), RelationshipType.withName(\"LAST_CHILD_OF\"));\n                    }\n                    break;\n\n                case XMLStreamConstants.END_DOCUMENT:\n                    parents.pop();\n                    break;\n\n                case XMLStreamConstants.COMMENT:\n                case XMLStreamConstants.SPACE:\n                    \n                    break;\n                default:\n                    log.warn(\"xml file contains a {} type structure - ignoring this.\", xml.getEventType());\n            }\n\n        }\n        if (!parents.isEmpty()) {\n            throw new IllegalStateException(\"non empty parents\");\n        }\n        return Stream.of(new NodeResult(root));\n    }"
  },
  {
    "id": 58,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 21,
    "human_patch": "https://github.com/neo4j-contrib/neo4j-apoc-procedures/commit/45bc09c8bd7f17283e2a7e85ce3f02cb4be4fd1a",
    "cve_id": "CVE-2018-1000820",
    "cwe_id": "CWE-611",
    "filename": "src/main/java/apoc/load/Xml.java",
    "is_vulnerable": 0,
    "class_name": "Xml",
    "subclass_name": null,
    "function_name": "setPropertyIfNotNull(org.neo4j.graphdb.Node root, String propertyKey, Object value)",
    "function_body": "{\n        if (value!=null) {\n            root.setProperty(propertyKey, value);\n        }\n    }"
  },
  {
    "id": 58,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 22,
    "human_patch": "https://github.com/neo4j-contrib/neo4j-apoc-procedures/commit/45bc09c8bd7f17283e2a7e85ce3f02cb4be4fd1a",
    "cve_id": "CVE-2018-1000820",
    "cwe_id": "CWE-611",
    "filename": "src/main/java/apoc/load/Xml.java",
    "is_vulnerable": 0,
    "class_name": "Xml",
    "subclass_name": null,
    "function_name": "connectWithParent(org.neo4j.graphdb.Node thisNode, ParentAndChildPair parentAndChildPair, org.neo4j.graphdb.Node last)",
    "function_body": "{\n        final org.neo4j.graphdb.Node parent = parentAndChildPair.getParent();\n        final org.neo4j.graphdb.Node previousChild = parentAndChildPair.getPreviousChild();\n\n        last.createRelationshipTo(thisNode, RelationshipType.withName(\"NEXT\"));\n        thisNode.createRelationshipTo(parent, RelationshipType.withName(\"IS_CHILD_OF\"));\n        if (previousChild ==null) {\n            thisNode.createRelationshipTo(parent, RelationshipType.withName(\"FIRST_CHILD_OF\"));\n        } else {\n            previousChild.createRelationshipTo(thisNode, RelationshipType.withName(\"NEXT_SIBLING\"));\n        }\n        parentAndChildPair.setPreviousChild(thisNode);\n        last = thisNode;\n        return last;\n    }"
  },
  {
    "id": 58,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 0,
    "human_patch": "https://github.com/neo4j-contrib/neo4j-apoc-procedures/commit/45bc09c8bd7f17283e2a7e85ce3f02cb4be4fd1a",
    "cve_id": "CVE-2018-1000820",
    "cwe_id": "CWE-611",
    "filename": "src/test/java/apoc/load/XmlTest.java",
    "is_vulnerable": 0,
    "class_name": "XmlTest",
    "subclass_name": null,
    "function_name": "setUp() throws Exception",
    "function_body": "{\n        db = new TestGraphDatabaseFactory().newImpermanentDatabaseBuilder().setConfig(\"apoc.import.file.enabled\", \"true\").newGraphDatabase();\n        TestUtil.registerProcedure(db, Xml.class);\n    }"
  },
  {
    "id": 58,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 1,
    "human_patch": "https://github.com/neo4j-contrib/neo4j-apoc-procedures/commit/45bc09c8bd7f17283e2a7e85ce3f02cb4be4fd1a",
    "cve_id": "CVE-2018-1000820",
    "cwe_id": "CWE-611",
    "filename": "src/test/java/apoc/load/XmlTest.java",
    "is_vulnerable": 0,
    "class_name": "XmlTest",
    "subclass_name": null,
    "function_name": "tearDown()",
    "function_body": "{\n        db.shutdown();\n    }"
  },
  {
    "id": 58,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 2,
    "human_patch": "https://github.com/neo4j-contrib/neo4j-apoc-procedures/commit/45bc09c8bd7f17283e2a7e85ce3f02cb4be4fd1a",
    "cve_id": "CVE-2018-1000820",
    "cwe_id": "CWE-611",
    "filename": "src/test/java/apoc/load/XmlTest.java",
    "is_vulnerable": 0,
    "class_name": "XmlTest",
    "subclass_name": null,
    "function_name": "testLoadXml() throws Exception",
    "function_body": "{\n        testCall(db, \"CALL apoc.load.xml('file:databases.xml')\", \n                (row) -> {\n                    Object value = row.get(\"value\");\n                    assertEquals(XML_AS_NESTED_MAP, value.toString());\n                });\n    }"
  },
  {
    "id": 58,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 3,
    "human_patch": "https://github.com/neo4j-contrib/neo4j-apoc-procedures/commit/45bc09c8bd7f17283e2a7e85ce3f02cb4be4fd1a",
    "cve_id": "CVE-2018-1000820",
    "cwe_id": "CWE-611",
    "filename": "src/test/java/apoc/load/XmlTest.java",
    "is_vulnerable": 0,
    "class_name": "XmlTest",
    "subclass_name": null,
    "function_name": "testLoadXmlSimple() throws Exception",
    "function_body": "{\n        testCall(db, \"CALL apoc.load.xmlSimple('file:databases.xml')\", \n                (row) -> {\n                    Object value = row.get(\"value\");\n                    assertEquals(XML_AS_NESTED_SIMPLE_MAP, value.toString());\n                });\n    }"
  },
  {
    "id": 58,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 4,
    "human_patch": "https://github.com/neo4j-contrib/neo4j-apoc-procedures/commit/45bc09c8bd7f17283e2a7e85ce3f02cb4be4fd1a",
    "cve_id": "CVE-2018-1000820",
    "cwe_id": "CWE-611",
    "filename": "src/test/java/apoc/load/XmlTest.java",
    "is_vulnerable": 0,
    "class_name": "XmlTest",
    "subclass_name": null,
    "function_name": "testMixedContent()",
    "function_body": "{\n        testCall(db, \"CALL apoc.load.xml('file:src/test/resources/xml/mixedcontent.xml')\", \n                (row) -> {\n                    Object value = row.get(\"value\");\n                    \n                    assertEquals(\"{_type=root, _children=[{_type=text, _children=[{_type=mixed}, text0, text1]}, {_type=text, _text=text as cdata}]}\", value.toString());\n\n                });\n    }"
  },
  {
    "id": 58,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 5,
    "human_patch": "https://github.com/neo4j-contrib/neo4j-apoc-procedures/commit/45bc09c8bd7f17283e2a7e85ce3f02cb4be4fd1a",
    "cve_id": "CVE-2018-1000820",
    "cwe_id": "CWE-611",
    "filename": "src/test/java/apoc/load/XmlTest.java",
    "is_vulnerable": 0,
    "class_name": "XmlTest",
    "subclass_name": null,
    "function_name": "testBookIds()",
    "function_body": "{\n        testResult(db, \"call apoc.load.xml('file:src/test/resources/xml/books.xml') yield value as catalog\\n\" +\n                \"UNWIND catalog._children as book\\n\" +\n                \"RETURN book.id as id\\n\", result -> {\n            List<Object> ids = Iterators.asList(result.columnAs(\"id\"));\n            assertTrue(IntStream.rangeClosed(1,12).allMatch(value -> ids.contains(String.format(\"bk1%02d\",value))));\n        });\n    }"
  },
  {
    "id": 58,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 6,
    "human_patch": "https://github.com/neo4j-contrib/neo4j-apoc-procedures/commit/45bc09c8bd7f17283e2a7e85ce3f02cb4be4fd1a",
    "cve_id": "CVE-2018-1000820",
    "cwe_id": "CWE-611",
    "filename": "src/test/java/apoc/load/XmlTest.java",
    "is_vulnerable": 0,
    "class_name": "XmlTest",
    "subclass_name": null,
    "function_name": "testFilterIntoCollection()",
    "function_body": "{\n        testResult(db, \"call apoc.load.xml('file:src/test/resources/xml/books.xml') yield value as catalog\\n\" +\n                        \"    UNWIND catalog._children as book\\n\" +\n                        \"    RETURN book.id, [attr IN book._children WHERE attr._type IN ['author','title'] | [attr._type, attr._text]] as pairs\"\n                , result -> {\n                    assertEquals(\"+----------------------------------------------------------------------------------------------------------------+\\n\" +\n                            \"| book.id | pairs                                                                                                |\\n\" +\n                            \"+----------------------------------------------------------------------------------------------------------------+\\n\" +\n                            \"| \\\"bk101\\\" | [[\\\"author\\\",\\\"Gambardella, Matthew\\\"],[\\\"author\\\",\\\"Arciniegas, Fabio\\\"],[\\\"title\\\",\\\"XML Developer's Guide\\\"]] |\\n\" +\n                            \"| \\\"bk102\\\" | [[\\\"author\\\",\\\"Ralls, Kim\\\"],[\\\"title\\\",\\\"Midnight Rain\\\"]]                                                  |\\n\" +\n                            \"| \\\"bk103\\\" | [[\\\"author\\\",\\\"Corets, Eva\\\"],[\\\"title\\\",\\\"Maeve Ascendant\\\"]]                                               |\\n\" +\n                            \"| \\\"bk104\\\" | [[\\\"author\\\",\\\"Corets, Eva\\\"],[\\\"title\\\",\\\"Oberon's Legacy\\\"]]                                               |\\n\" +\n                            \"| \\\"bk105\\\" | [[\\\"author\\\",\\\"Corets, Eva\\\"],[\\\"title\\\",\\\"The Sundered Grail\\\"]]                                            |\\n\" +\n                            \"| \\\"bk106\\\" | [[\\\"author\\\",\\\"Randall, Cynthia\\\"],[\\\"title\\\",\\\"Lover Birds\\\"]]                                              |\\n\" +\n                            \"| \\\"bk107\\\" | [[\\\"author\\\",\\\"Thurman, Paula\\\"],[\\\"title\\\",\\\"Splish Splash\\\"]]                                              |\\n\" +\n                            \"| \\\"bk108\\\" | [[\\\"author\\\",\\\"Knorr, Stefan\\\"],[\\\"title\\\",\\\"Creepy Crawlies\\\"]]                                             |\\n\" +\n                            \"| \\\"bk109\\\" | [[\\\"author\\\",\\\"Kress, Peter\\\"],[\\\"title\\\",\\\"Paradox Lost\\\"]]                                                 |\\n\" +\n                            \"| \\\"bk110\\\" | [[\\\"author\\\",\\\"O'Brien, Tim\\\"],[\\\"title\\\",\\\"Microsoft .NET: The Programming Bible\\\"]]                        |\\n\" +\n                            \"| \\\"bk111\\\" | [[\\\"author\\\",\\\"O'Brien, Tim\\\"],[\\\"title\\\",\\\"MSXML3: A Comprehensive Guide\\\"]]                                |\\n\" +\n                            \"| \\\"bk112\\\" | [[\\\"author\\\",\\\"Galos, Mike\\\"],[\\\"title\\\",\\\"Visual Studio 7: A Comprehensive Guide\\\"]]                        |\\n\" +\n                            \"+----------------------------------------------------------------------------------------------------------------+\\n\" +\n                            \"12 rows\\n\", result.resultAsString());\n                });\n    }"
  },
  {
    "id": 58,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 7,
    "human_patch": "https://github.com/neo4j-contrib/neo4j-apoc-procedures/commit/45bc09c8bd7f17283e2a7e85ce3f02cb4be4fd1a",
    "cve_id": "CVE-2018-1000820",
    "cwe_id": "CWE-611",
    "filename": "src/test/java/apoc/load/XmlTest.java",
    "is_vulnerable": 0,
    "class_name": "XmlTest",
    "subclass_name": null,
    "function_name": "testReturnCollectionElements()",
    "function_body": "{\n        testResult(db, \"call apoc.load.xml('file:src/test/resources/xml/books.xml') yield value as catalog\\n\"+\n                        \"UNWIND catalog._children as book\\n\" +\n                        \"WITH book.id as id, [attr IN book._children WHERE attr._type IN ['author','title'] | attr._text] as pairs\\n\" +\n                        \"RETURN id, pairs[0] as author, pairs[1] as title\"\n                , result -> {\n                    assertEquals(\"+-----------------------------------------------------------------------------+\\n\" +\n                            \"| id      | author                 | title                                    |\\n\" +\n                            \"+-----------------------------------------------------------------------------+\\n\" +\n                            \"| \\\"bk101\\\" | \\\"Gambardella, Matthew\\\" | \\\"Arciniegas, Fabio\\\"                      |\\n\" +\n                            \"| \\\"bk102\\\" | \\\"Ralls, Kim\\\"           | \\\"Midnight Rain\\\"                          |\\n\" +\n                            \"| \\\"bk103\\\" | \\\"Corets, Eva\\\"          | \\\"Maeve Ascendant\\\"                        |\\n\" +\n                            \"| \\\"bk104\\\" | \\\"Corets, Eva\\\"          | \\\"Oberon's Legacy\\\"                        |\\n\" +\n                            \"| \\\"bk105\\\" | \\\"Corets, Eva\\\"          | \\\"The Sundered Grail\\\"                     |\\n\" +\n                            \"| \\\"bk106\\\" | \\\"Randall, Cynthia\\\"     | \\\"Lover Birds\\\"                            |\\n\" +\n                            \"| \\\"bk107\\\" | \\\"Thurman, Paula\\\"       | \\\"Splish Splash\\\"                          |\\n\" +\n                            \"| \\\"bk108\\\" | \\\"Knorr, Stefan\\\"        | \\\"Creepy Crawlies\\\"                        |\\n\" +\n                            \"| \\\"bk109\\\" | \\\"Kress, Peter\\\"         | \\\"Paradox Lost\\\"                           |\\n\" +\n                            \"| \\\"bk110\\\" | \\\"O'Brien, Tim\\\"         | \\\"Microsoft .NET: The Programming Bible\\\"  |\\n\" +\n                            \"| \\\"bk111\\\" | \\\"O'Brien, Tim\\\"         | \\\"MSXML3: A Comprehensive Guide\\\"          |\\n\" +\n                            \"| \\\"bk112\\\" | \\\"Galos, Mike\\\"          | \\\"Visual Studio 7: A Comprehensive Guide\\\" |\\n\" +\n                            \"+-----------------------------------------------------------------------------+\\n\" +\n                            \"12 rows\\n\", result.resultAsString());\n                });\n    }"
  },
  {
    "id": 58,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 8,
    "human_patch": "https://github.com/neo4j-contrib/neo4j-apoc-procedures/commit/45bc09c8bd7f17283e2a7e85ce3f02cb4be4fd1a",
    "cve_id": "CVE-2018-1000820",
    "cwe_id": "CWE-611",
    "filename": "src/test/java/apoc/load/XmlTest.java",
    "is_vulnerable": 0,
    "class_name": "XmlTest",
    "subclass_name": null,
    "function_name": "testLoadXmlXpathAuthorFromBookId()",
    "function_body": "{\n        testCall(db, \"CALL apoc.load.xml('file:src/test/resources/xml/books.xml', '/catalog/book[@id=\\\"bk102\\\"]/author') yield value as result\",\n                (r) -> {\n                    assertEquals(\"author\", ((Map) r.get(\"result\")).get(\"_type\"));\n                    assertEquals(\"Ralls, Kim\", ((Map) r.get(\"result\")).get(\"_text\"));\n                });\n    }"
  },
  {
    "id": 58,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 9,
    "human_patch": "https://github.com/neo4j-contrib/neo4j-apoc-procedures/commit/45bc09c8bd7f17283e2a7e85ce3f02cb4be4fd1a",
    "cve_id": "CVE-2018-1000820",
    "cwe_id": "CWE-611",
    "filename": "src/test/java/apoc/load/XmlTest.java",
    "is_vulnerable": 0,
    "class_name": "XmlTest",
    "subclass_name": null,
    "function_name": "testLoadXmlXpathGenreFromBookTitle()",
    "function_body": "{\n        testCall(db, \"CALL apoc.load.xml('file:src/test/resources/xml/books.xml', '/catalog/book[title=\\\"Maeve Ascendant\\\"]/genre') yield value as result\",\n                (r) -> {\n                    assertEquals(\"genre\", ((Map) r.get(\"result\")).get(\"_type\"));\n                    assertEquals(\"Fantasy\", ((Map) r.get(\"result\")).get(\"_text\"));\n                });\n    }"
  },
  {
    "id": 58,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 10,
    "human_patch": "https://github.com/neo4j-contrib/neo4j-apoc-procedures/commit/45bc09c8bd7f17283e2a7e85ce3f02cb4be4fd1a",
    "cve_id": "CVE-2018-1000820",
    "cwe_id": "CWE-611",
    "filename": "src/test/java/apoc/load/XmlTest.java",
    "is_vulnerable": 0,
    "class_name": "XmlTest",
    "subclass_name": null,
    "function_name": "testLoadXmlXpathReturnBookFromBookTitle()",
    "function_body": "{\n        testCall(db, \"CALL apoc.load.xml('file:src/test/resources/xml/books.xml', '/catalog/book[title=\\\"Maeve Ascendant\\\"]/.') yield value as result\",\n                (r) -> {\n                    Object value = r.values();\n                    assertEquals(XML_XPATH_AS_NESTED_MAP, value.toString());\n                });\n    }"
  },
  {
    "id": 58,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 11,
    "human_patch": "https://github.com/neo4j-contrib/neo4j-apoc-procedures/commit/45bc09c8bd7f17283e2a7e85ce3f02cb4be4fd1a",
    "cve_id": "CVE-2018-1000820",
    "cwe_id": "CWE-611",
    "filename": "src/test/java/apoc/load/XmlTest.java",
    "is_vulnerable": 0,
    "class_name": "XmlTest",
    "subclass_name": null,
    "function_name": "testLoadXmlXpathBooKsFromGenre()",
    "function_body": "{\n            testResult(db, \"CALL apoc.load.xml('file:src/test/resources/xml/books.xml', '/catalog/book[genre=\\\"Computer\\\"]') yield value as result\",\n                (r) -> {\n                    Map<String, Object> next = r.next();\n                    Object result = next.get(\"result\");\n                    Map resultMap = (Map) next.get(\"result\");\n                    Object children = resultMap.get(\"_children\");\n\n                    List<Object>  childrenList = (List<Object>) children;\n                    assertEquals(\"bk101\", ((Map) result).get(\"id\"));\n                    assertEquals(\"author\", ((Map) childrenList.get(0)).get(\"_type\"));\n                    assertEquals(\"Gambardella, Matthew\", ((Map) childrenList.get(0)).get(\"_text\"));\n                    assertEquals(\"author\", ((Map) childrenList.get(1)).get(\"_type\"));\n                    assertEquals(\"Arciniegas, Fabio\", ((Map) childrenList.get(1)).get(\"_text\"));\n                    next = r.next();\n                    result = next.get(\"result\");\n                    resultMap = (Map) next.get(\"result\");\n                    children = resultMap.get(\"_children\");\n                    childrenList = (List<Object>) children;\n                    assertEquals(\"bk110\", ((Map) result).get(\"id\"));\n                    assertEquals(\"author\", ((Map) childrenList.get(0)).get(\"_type\"));\n                    assertEquals(\"O'Brien, Tim\", ((Map) childrenList.get(0)).get(\"_text\"));\n                    assertEquals(\"title\", ((Map) childrenList.get(1)).get(\"_type\"));\n                    assertEquals(\"Microsoft .NET: The Programming Bible\", ((Map) childrenList.get(1)).get(\"_text\"));\n                    next = r.next();\n                    result = next.get(\"result\");\n                    resultMap = (Map) next.get(\"result\");\n                    children = resultMap.get(\"_children\");\n                    childrenList = (List<Object>) children;\n                    assertEquals(\"bk111\", ((Map) result).get(\"id\"));\n                    assertEquals(\"author\", ((Map) childrenList.get(0)).get(\"_type\"));\n                    assertEquals(\"O'Brien, Tim\", ((Map) childrenList.get(0)).get(\"_text\"));\n                    assertEquals(\"title\", ((Map) childrenList.get(1)).get(\"_type\"));\n                    assertEquals(\"MSXML3: A Comprehensive Guide\", ((Map) childrenList.get(1)).get(\"_text\"));\n                    next = r.next();\n                    result = next.get(\"result\");\n                    resultMap = (Map) next.get(\"result\");\n                    children = resultMap.get(\"_children\");\n                    childrenList = (List<Object>) children;\n                    assertEquals(\"bk112\", ((Map) result).get(\"id\"));\n                    assertEquals(\"author\", ((Map) childrenList.get(0)).get(\"_type\"));\n                    assertEquals(\"Galos, Mike\", ((Map) childrenList.get(0)).get(\"_text\"));\n                    assertEquals(\"title\", ((Map) childrenList.get(1)).get(\"_type\"));\n                    assertEquals(\"Visual Studio 7: A Comprehensive Guide\", ((Map) childrenList.get(1)).get(\"_text\"));\n                    assertEquals(false, r.hasNext());\n                });\n    }"
  },
  {
    "id": 58,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 12,
    "human_patch": "https://github.com/neo4j-contrib/neo4j-apoc-procedures/commit/45bc09c8bd7f17283e2a7e85ce3f02cb4be4fd1a",
    "cve_id": "CVE-2018-1000820",
    "cwe_id": "CWE-611",
    "filename": "src/test/java/apoc/load/XmlTest.java",
    "is_vulnerable": 0,
    "class_name": "XmlTest",
    "subclass_name": null,
    "function_name": "testLoadXmlNoFailOnError()",
    "function_body": "{\n        testCall(db, \"CALL apoc.load.xml('file:src/test/resources/books.xm', '', {failOnError:false}) yield value as result\",\n                (r) -> {\n                    Map resultMap = (Map) r.get(\"result\");\n                    assertEquals(Collections.emptyMap(), resultMap);\n                });\n    }"
  },
  {
    "id": 58,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 13,
    "human_patch": "https://github.com/neo4j-contrib/neo4j-apoc-procedures/commit/45bc09c8bd7f17283e2a7e85ce3f02cb4be4fd1a",
    "cve_id": "CVE-2018-1000820",
    "cwe_id": "CWE-611",
    "filename": "src/test/java/apoc/load/XmlTest.java",
    "is_vulnerable": 0,
    "class_name": "XmlTest",
    "subclass_name": null,
    "function_name": "testLoadXmlWithImport()",
    "function_body": "{\n        testCall(db, \"call apoc.xml.import('file:src/test/resources/xml/humboldt_soemmering01_1791.TEI-P5.xml', {createNextWordRelationships: true}) yield node\",\n                row -> {\n                   assertNotNull(row.get(\"node\"));\n                });\n        testResult(db, \"match (n) return labels(n)[0] as label, count(*) as count\", result -> {\n            final Map<String, Long> resultMap = result.stream().collect(Collectors.toMap(o -> (String)o.get(\"label\"), o -> (Long)o.get(\"count\")));\n            assertEquals(2l, (long)resultMap.get(\"XmlProcessingInstruction\"));\n            assertEquals(1l, (long)resultMap.get(\"XmlDocument\"));\n            assertEquals(1737l, (long)resultMap.get(\"XmlWord\"));\n            assertEquals(454l, (long)resultMap.get(\"XmlTag\"));\n        });\n\n        \n        testCallEmpty(db, \"match (n) where size( (n)-[:NEXT]->() ) > 1 return n\", null);\n        testCallEmpty(db, \"match (n) where size( (n)-[:NEXT_SIBLING]->() ) > 1 return n\", null);\n\n        \n        testCallEmpty(db, \"match (n) where size( (n)<-[:FIRST_CHILD_OF]-() ) > 1 return n\", null);\n        testCallEmpty(db, \"match (n) where size( (n)<-[:LAST_CHILD_OF]-() ) > 1 return n\", null);\n\n        \n        testResult(db, \"match p=(:XmlDocument)-[:NEXT_WORD*]->(e:XmlWord) where not (e)-[:NEXT_WORD]->() return length(p) as len\",\n                result -> {\n                    Map<String, Object> r = Iterators.single(result);\n                    assertEquals(1737l, r.get(\"len\"));\n                });\n\n    }"
  },
  {
    "id": 58,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 14,
    "human_patch": "https://github.com/neo4j-contrib/neo4j-apoc-procedures/commit/45bc09c8bd7f17283e2a7e85ce3f02cb4be4fd1a",
    "cve_id": "CVE-2018-1000820",
    "cwe_id": "CWE-611",
    "filename": "src/test/java/apoc/load/XmlTest.java",
    "is_vulnerable": 0,
    "class_name": "XmlTest",
    "subclass_name": null,
    "function_name": "testLoadXmlFromZip()",
    "function_body": "{\n        testResult(db, \"call apoc.load.xml('file:src/test/resources/testload.zip!xml/books.xml') yield value as catalog\\n\" +\n                \"UNWIND catalog._children as book\\n\" +\n                \"RETURN book.id as id\\n\", result -> {\n            List<Object> ids = Iterators.asList(result.columnAs(\"id\"));\n            assertTrue(IntStream.rangeClosed(1,12).allMatch(value -> ids.contains(String.format(\"bk1%02d\",value))));\n        });\n    }"
  },
  {
    "id": 58,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 15,
    "human_patch": "https://github.com/neo4j-contrib/neo4j-apoc-procedures/commit/45bc09c8bd7f17283e2a7e85ce3f02cb4be4fd1a",
    "cve_id": "CVE-2018-1000820",
    "cwe_id": "CWE-611",
    "filename": "src/test/java/apoc/load/XmlTest.java",
    "is_vulnerable": 0,
    "class_name": "XmlTest",
    "subclass_name": null,
    "function_name": "testLoadXmlFromTar()",
    "function_body": "{\n        testResult(db, \"call apoc.load.xml('file:src/test/resources/testload.tar!xml/books.xml') yield value as catalog\\n\" +\n                \"UNWIND catalog._children as book\\n\" +\n                \"RETURN book.id as id\\n\", result -> {\n            List<Object> ids = Iterators.asList(result.columnAs(\"id\"));\n            assertTrue(IntStream.rangeClosed(1,12).allMatch(value -> ids.contains(String.format(\"bk1%02d\",value))));\n        });\n    }"
  },
  {
    "id": 58,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 16,
    "human_patch": "https://github.com/neo4j-contrib/neo4j-apoc-procedures/commit/45bc09c8bd7f17283e2a7e85ce3f02cb4be4fd1a",
    "cve_id": "CVE-2018-1000820",
    "cwe_id": "CWE-611",
    "filename": "src/test/java/apoc/load/XmlTest.java",
    "is_vulnerable": 0,
    "class_name": "XmlTest",
    "subclass_name": null,
    "function_name": "testLoadXmlFromTarGz()",
    "function_body": "{\n        testResult(db, \"call apoc.load.xml('file:src/test/resources/testload.tar.gz!xml/books.xml') yield value as catalog\\n\" +\n                \"UNWIND catalog._children as book\\n\" +\n                \"RETURN book.id as id\\n\", result -> {\n            List<Object> ids = Iterators.asList(result.columnAs(\"id\"));\n            assertTrue(IntStream.rangeClosed(1,12).allMatch(value -> ids.contains(String.format(\"bk1%02d\",value))));\n        });\n    }"
  },
  {
    "id": 58,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 17,
    "human_patch": "https://github.com/neo4j-contrib/neo4j-apoc-procedures/commit/45bc09c8bd7f17283e2a7e85ce3f02cb4be4fd1a",
    "cve_id": "CVE-2018-1000820",
    "cwe_id": "CWE-611",
    "filename": "src/test/java/apoc/load/XmlTest.java",
    "is_vulnerable": 0,
    "class_name": "XmlTest",
    "subclass_name": null,
    "function_name": "testLoadXmlFromTgz()",
    "function_body": "{\n        testResult(db, \"call apoc.load.xml('file:src/test/resources/testload.tgz!xml/books.xml') yield value as catalog\\n\" +\n                \"UNWIND catalog._children as book\\n\" +\n                \"RETURN book.id as id\\n\", result -> {\n            List<Object> ids = Iterators.asList(result.columnAs(\"id\"));\n            assertTrue(IntStream.rangeClosed(1,12).allMatch(value -> ids.contains(String.format(\"bk1%02d\",value))));\n        });\n    }"
  },
  {
    "id": 58,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 18,
    "human_patch": "https://github.com/neo4j-contrib/neo4j-apoc-procedures/commit/45bc09c8bd7f17283e2a7e85ce3f02cb4be4fd1a",
    "cve_id": "CVE-2018-1000820",
    "cwe_id": "CWE-611",
    "filename": "src/test/java/apoc/load/XmlTest.java",
    "is_vulnerable": 0,
    "class_name": "XmlTest",
    "subclass_name": null,
    "function_name": "testLoadXmlFromZipByUrl()",
    "function_body": "{\n        testResult(db, \"call apoc.load.xml('https://github.com/neo4j-contrib/neo4j-apoc-procedures/blob/3.4/src/test/resources/testload.zip?raw=true!xml/books.xml') yield value as catalog\\n\" +\n                \"UNWIND catalog._children as book\\n\" +\n                \"RETURN book.id as id\\n\", result -> {\n            List<Object> ids = Iterators.asList(result.columnAs(\"id\"));\n            assertTrue(IntStream.rangeClosed(1,12).allMatch(value -> ids.contains(String.format(\"bk1%02d\",value))));\n        });\n    }"
  },
  {
    "id": 58,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 19,
    "human_patch": "https://github.com/neo4j-contrib/neo4j-apoc-procedures/commit/45bc09c8bd7f17283e2a7e85ce3f02cb4be4fd1a",
    "cve_id": "CVE-2018-1000820",
    "cwe_id": "CWE-611",
    "filename": "src/test/java/apoc/load/XmlTest.java",
    "is_vulnerable": 0,
    "class_name": "XmlTest",
    "subclass_name": null,
    "function_name": "testLoadXmlFromTarByUrl()",
    "function_body": "{\n        testResult(db, \"call apoc.load.xml('https://github.com/neo4j-contrib/neo4j-apoc-procedures/blob/3.4/src/test/resources/testload.tar?raw=true!xml/books.xml') yield value as catalog\\n\" +\n                \"UNWIND catalog._children as book\\n\" +\n                \"RETURN book.id as id\\n\", result -> {\n            List<Object> ids = Iterators.asList(result.columnAs(\"id\"));\n            assertTrue(IntStream.rangeClosed(1,12).allMatch(value -> ids.contains(String.format(\"bk1%02d\",value))));\n        });\n    }"
  },
  {
    "id": 58,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 20,
    "human_patch": "https://github.com/neo4j-contrib/neo4j-apoc-procedures/commit/45bc09c8bd7f17283e2a7e85ce3f02cb4be4fd1a",
    "cve_id": "CVE-2018-1000820",
    "cwe_id": "CWE-611",
    "filename": "src/test/java/apoc/load/XmlTest.java",
    "is_vulnerable": 0,
    "class_name": "XmlTest",
    "subclass_name": null,
    "function_name": "testLoadXmlFromTarGzByUrl()",
    "function_body": "{\n        testResult(db, \"call apoc.load.xml('https://github.com/neo4j-contrib/neo4j-apoc-procedures/blob/3.4/src/test/resources/testload.tar.gz?raw=true!xml/books.xml') yield value as catalog\\n\" +\n                \"UNWIND catalog._children as book\\n\" +\n                \"RETURN book.id as id\\n\", result -> {\n            List<Object> ids = Iterators.asList(result.columnAs(\"id\"));\n            assertTrue(IntStream.rangeClosed(1,12).allMatch(value -> ids.contains(String.format(\"bk1%02d\",value))));\n        });\n    }"
  },
  {
    "id": 58,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 21,
    "human_patch": "https://github.com/neo4j-contrib/neo4j-apoc-procedures/commit/45bc09c8bd7f17283e2a7e85ce3f02cb4be4fd1a",
    "cve_id": "CVE-2018-1000820",
    "cwe_id": "CWE-611",
    "filename": "src/test/java/apoc/load/XmlTest.java",
    "is_vulnerable": 0,
    "class_name": "XmlTest",
    "subclass_name": null,
    "function_name": "testLoadXmlFromTgzByUrl()",
    "function_body": "{\n        testResult(db, \"call apoc.load.xml('https://github.com/neo4j-contrib/neo4j-apoc-procedures/blob/3.4/src/test/resources/testload.tgz?raw=true!xml/books.xml') yield value as catalog\\n\" +\n                \"UNWIND catalog._children as book\\n\" +\n                \"RETURN book.id as id\\n\", result -> {\n            List<Object> ids = Iterators.asList(result.columnAs(\"id\"));\n            assertTrue(IntStream.rangeClosed(1,12).allMatch(value -> ids.contains(String.format(\"bk1%02d\",value))));\n        });\n    }"
  },
  {
    "id": 59,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 0,
    "human_patch": "https://github.com/neo4j/neo4j/commit/46de5d01ae2741ffe04c36270fc62c6d490f65c9",
    "cve_id": "CVE-2018-18389",
    "cwe_id": "CWE-287",
    "filename": "enterprise/security/src/main/java/org/neo4j/server/security/enterprise/auth/LdapRealm.java",
    "is_vulnerable": 0,
    "class_name": "LdapRealm",
    "subclass_name": null,
    "function_name": "withRealm( String template, Object... args )",
    "function_body": "{\n        return \"{LdapRealm}: \" + format( template, args );\n    }"
  },
  {
    "id": 59,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 1,
    "human_patch": "https://github.com/neo4j/neo4j/commit/46de5d01ae2741ffe04c36270fc62c6d490f65c9",
    "cve_id": "CVE-2018-18389",
    "cwe_id": "CWE-287",
    "filename": "enterprise/security/src/main/java/org/neo4j/server/security/enterprise/auth/LdapRealm.java",
    "is_vulnerable": 0,
    "class_name": "LdapRealm",
    "subclass_name": null,
    "function_name": "server( JndiLdapContextFactory jndiLdapContextFactory )",
    "function_body": "{\n        return \"'\" + jndiLdapContextFactory.getUrl() + \"'\" +\n                ( useStartTls ? \" using StartTLS\" : \"\" );\n    }"
  },
  {
    "id": 59,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 2,
    "human_patch": "https://github.com/neo4j/neo4j/commit/46de5d01ae2741ffe04c36270fc62c6d490f65c9",
    "cve_id": "CVE-2018-18389",
    "cwe_id": "CWE-287",
    "filename": "enterprise/security/src/main/java/org/neo4j/server/security/enterprise/auth/LdapRealm.java",
    "is_vulnerable": 0,
    "class_name": "LdapRealm",
    "subclass_name": null,
    "function_name": "queryForAuthenticationInfo( AuthenticationToken token,\n            LdapContextFactory ldapContextFactory ) throws NamingException",
    "function_body": "{\n        if ( authenticationEnabled )\n        {\n            if ( useSAMAccountName )\n            {\n                return queryForAuthenticationInfoSAM( token, ldapContextFactory );\n            }\n            else\n            {\n                String serverString = server( (JndiLdapContextFactory) ldapContextFactory );\n                try\n                {\n                    AuthenticationInfo info =\n                            useStartTls ? queryForAuthenticationInfoUsingStartTls( token, ldapContextFactory )\n                                        : super.queryForAuthenticationInfo( token, ldapContextFactory );\n                    securityLog.debug( withRealm( \"Authenticated user '%s' against %s\", token.getPrincipal(),\n                            serverString ) );\n                    return info;\n                }\n                catch ( Exception e )\n                {\n                    if ( isExceptionAnLdapConnectionTimeout( e ) )\n                    {\n                        throw new AuthProviderTimeoutException( LDAP_CONNECTION_TIMEOUT_CLIENT_MESSAGE, e );\n                    }\n                    else if ( isExceptionAnLdapReadTimeout( e ) )\n                    {\n                        throw new AuthProviderTimeoutException( LDAP_READ_TIMEOUT_CLIENT_MESSAGE, e );\n                    }\n                    else if ( isExceptionConnectionRefused( e ) )\n                    {\n                        throw new AuthProviderFailedException( LDAP_CONNECTION_REFUSED_CLIENT_MESSAGE, e );\n                    }\n                    \n                    throw e;\n                }\n            }\n        }\n        else\n        {\n            return null;\n        }\n    }"
  },
  {
    "id": 59,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 3,
    "human_patch": "https://github.com/neo4j/neo4j/commit/46de5d01ae2741ffe04c36270fc62c6d490f65c9",
    "cve_id": "CVE-2018-18389",
    "cwe_id": "CWE-287",
    "filename": "enterprise/security/src/main/java/org/neo4j/server/security/enterprise/auth/LdapRealm.java",
    "is_vulnerable": 0,
    "class_name": "LdapRealm",
    "subclass_name": null,
    "function_name": "queryForAuthenticationInfoUsingStartTls( AuthenticationToken token,\n            LdapContextFactory ldapContextFactory ) throws NamingException",
    "function_body": "{\n        Object principal = getLdapPrincipal(token);\n        Object credentials = token.getCredentials();\n\n        LdapContext ctx = null;\n\n        try\n        {\n            ctx = getLdapContextUsingStartTls( ldapContextFactory, principal, credentials );\n            return createAuthenticationInfo( token, principal, credentials, ctx );\n        }\n        finally\n        {\n            LdapUtils.closeContext( ctx );\n        }\n    }"
  },
  {
    "id": 59,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 4,
    "human_patch": "https://github.com/neo4j/neo4j/commit/46de5d01ae2741ffe04c36270fc62c6d490f65c9",
    "cve_id": "CVE-2018-18389",
    "cwe_id": "CWE-287",
    "filename": "enterprise/security/src/main/java/org/neo4j/server/security/enterprise/auth/LdapRealm.java",
    "is_vulnerable": 1,
    "class_name": "LdapRealm",
    "subclass_name": null,
    "function_name": "getLdapContextUsingStartTls( LdapContextFactory ldapContextFactory,\n            Object principal, Object credentials ) throws NamingException",
    "function_body": "{\n        JndiLdapContextFactory jndiLdapContextFactory = (JndiLdapContextFactory) ldapContextFactory;\n        Hashtable<String, Object> env = new Hashtable<>();\n        env.put( Context.INITIAL_CONTEXT_FACTORY, jndiLdapContextFactory.getContextFactoryClassName() );\n        env.put( Context.PROVIDER_URL, jndiLdapContextFactory.getUrl() );\n\n        LdapContext ctx = null;\n\n        try\n        {\n            ctx = new InitialLdapContext( env, null );\n\n            StartTlsRequest startTlsRequest = new StartTlsRequest();\n            StartTlsResponse tls = (StartTlsResponse) ctx.extendedOperation( startTlsRequest );\n\n            tls.negotiate();\n\n            ctx.addToEnvironment( Context.SECURITY_AUTHENTICATION,\n                    jndiLdapContextFactory.getAuthenticationMechanism() );\n            ctx.addToEnvironment( Context.SECURITY_PRINCIPAL, principal );\n            ctx.addToEnvironment( Context.SECURITY_CREDENTIALS, credentials );\n\n            return ctx;\n        }\n        catch ( IOException e )\n        {\n            LdapUtils.closeContext( ctx );\n            securityLog.error( withRealm( \"Failed to negotiate TLS connection with '%s': \",\n                    server( jndiLdapContextFactory ), e ) );\n            throw new CommunicationException( e.getMessage() );\n        }\n        catch ( Throwable t )\n        {\n            LdapUtils.closeContext( ctx );\n            securityLog.error( withRealm( \"Unexpected failure to negotiate TLS connection with '%s': \",\n                    server( jndiLdapContextFactory ), t ) );\n            throw t;\n        }\n    }"
  },
  {
    "id": 59,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 5,
    "human_patch": "https://github.com/neo4j/neo4j/commit/46de5d01ae2741ffe04c36270fc62c6d490f65c9",
    "cve_id": "CVE-2018-18389",
    "cwe_id": "CWE-287",
    "filename": "enterprise/security/src/main/java/org/neo4j/server/security/enterprise/auth/LdapRealm.java",
    "is_vulnerable": 0,
    "class_name": "LdapRealm",
    "subclass_name": null,
    "function_name": "queryForAuthorizationInfo( PrincipalCollection principals,\n            LdapContextFactory ldapContextFactory ) throws NamingException",
    "function_body": "{\n        if ( authorizationEnabled )\n        {\n            String username = getUsername( principals );\n            if ( username == null )\n            {\n                return null;\n            }\n\n            if ( useSystemAccountForAuthorization )\n            {\n                \n                LdapContext ldapContext = useStartTls ? getSystemLdapContextUsingStartTls( ldapContextFactory ) :\n                                          ldapContextFactory.getSystemLdapContext();\n\n                Set<String> roleNames;\n                try\n                {\n                    roleNames = findRoleNamesForUser( username, ldapContext );\n                }\n                finally\n                {\n                    LdapUtils.closeContext( ldapContext );\n                }\n\n                return new SimpleAuthorizationInfo( roleNames );\n            }\n            else\n            {\n                \n                Cache<Object,AuthorizationInfo> authorizationCache = getAuthorizationCache();\n                AuthorizationInfo authorizationInfo = authorizationCache.get( username );\n                if ( authorizationInfo == null )\n                {\n                    \n                    \n                    \n                    \n                    throw new AuthorizationExpiredException( \"LDAP authorization info expired.\" );\n                }\n                return authorizationInfo;\n            }\n        }\n        return null;\n    }"
  },
  {
    "id": 59,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 6,
    "human_patch": "https://github.com/neo4j/neo4j/commit/46de5d01ae2741ffe04c36270fc62c6d490f65c9",
    "cve_id": "CVE-2018-18389",
    "cwe_id": "CWE-287",
    "filename": "enterprise/security/src/main/java/org/neo4j/server/security/enterprise/auth/LdapRealm.java",
    "is_vulnerable": 0,
    "class_name": "LdapRealm",
    "subclass_name": null,
    "function_name": "getUsername( PrincipalCollection principals )",
    "function_body": "{\n        String username = null;\n        Collection ldapPrincipals = principals.fromRealm( getName() );\n        if ( !ldapPrincipals.isEmpty() )\n        {\n            username = (String) ldapPrincipals.iterator().next();\n        }\n        else if ( useSystemAccountForAuthorization )\n        {\n            username = (String) principals.getPrimaryPrincipal();\n        }\n        return username;\n    }"
  },
  {
    "id": 59,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 7,
    "human_patch": "https://github.com/neo4j/neo4j/commit/46de5d01ae2741ffe04c36270fc62c6d490f65c9",
    "cve_id": "CVE-2018-18389",
    "cwe_id": "CWE-287",
    "filename": "enterprise/security/src/main/java/org/neo4j/server/security/enterprise/auth/LdapRealm.java",
    "is_vulnerable": 0,
    "class_name": "LdapRealm",
    "subclass_name": null,
    "function_name": "getSystemLdapContextUsingStartTls( LdapContextFactory ldapContextFactory ) throws NamingException",
    "function_body": "{\n        JndiLdapContextFactory jndiLdapContextFactory = (JndiLdapContextFactory) ldapContextFactory;\n        return getLdapContextUsingStartTls( ldapContextFactory, jndiLdapContextFactory.getSystemUsername(),\n                jndiLdapContextFactory.getSystemPassword() );\n    }"
  },
  {
    "id": 59,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 8,
    "human_patch": "https://github.com/neo4j/neo4j/commit/46de5d01ae2741ffe04c36270fc62c6d490f65c9",
    "cve_id": "CVE-2018-18389",
    "cwe_id": "CWE-287",
    "filename": "enterprise/security/src/main/java/org/neo4j/server/security/enterprise/auth/LdapRealm.java",
    "is_vulnerable": 0,
    "class_name": "LdapRealm",
    "subclass_name": null,
    "function_name": "createAuthenticationInfo( AuthenticationToken token, Object ldapPrincipal,\n            Object ldapCredentials, LdapContext ldapContext ) throws NamingException",
    "function_body": "{\n        \n        \n        if ( authorizationEnabled && !useSystemAccountForAuthorization )\n        {\n            String username = (String) token.getPrincipal();\n            Set<String> roleNames = findRoleNamesForUser( username, ldapContext );\n            cacheAuthorizationInfo( username, roleNames );\n        }\n\n        if ( isAuthenticationCachingEnabled() )\n        {\n            SimpleHash hashedCredentials = secureHasher.hash( ((String) token.getCredentials()).getBytes() );\n            return new ShiroAuthenticationInfo( token.getPrincipal(), hashedCredentials.getBytes(),\n                    hashedCredentials.getSalt(), getName(), AuthenticationResult.SUCCESS );\n        }\n        else\n        {\n            return new ShiroAuthenticationInfo( token.getPrincipal(), getName(), AuthenticationResult.SUCCESS );\n        }\n    }"
  },
  {
    "id": 59,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 9,
    "human_patch": "https://github.com/neo4j/neo4j/commit/46de5d01ae2741ffe04c36270fc62c6d490f65c9",
    "cve_id": "CVE-2018-18389",
    "cwe_id": "CWE-287",
    "filename": "enterprise/security/src/main/java/org/neo4j/server/security/enterprise/auth/LdapRealm.java",
    "is_vulnerable": 0,
    "class_name": "LdapRealm",
    "subclass_name": null,
    "function_name": "supports( AuthenticationToken token )",
    "function_body": "{\n        return supportsSchemeAndRealm( token );\n    }"
  },
  {
    "id": 59,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 10,
    "human_patch": "https://github.com/neo4j/neo4j/commit/46de5d01ae2741ffe04c36270fc62c6d490f65c9",
    "cve_id": "CVE-2018-18389",
    "cwe_id": "CWE-287",
    "filename": "enterprise/security/src/main/java/org/neo4j/server/security/enterprise/auth/LdapRealm.java",
    "is_vulnerable": 0,
    "class_name": "LdapRealm",
    "subclass_name": null,
    "function_name": "supportsSchemeAndRealm( AuthenticationToken token )",
    "function_body": "{\n        try\n        {\n            if ( token instanceof ShiroAuthToken )\n            {\n                ShiroAuthToken shiroAuthToken = (ShiroAuthToken) token;\n                return shiroAuthToken.getScheme().equals( AuthToken.BASIC_SCHEME ) &&\n                       (shiroAuthToken.supportsRealm( LDAP_REALM ));\n            }\n            return false;\n        }\n        catch ( InvalidAuthTokenException e )\n        {\n            return false;\n        }\n    }"
  },
  {
    "id": 59,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 11,
    "human_patch": "https://github.com/neo4j/neo4j/commit/46de5d01ae2741ffe04c36270fc62c6d490f65c9",
    "cve_id": "CVE-2018-18389",
    "cwe_id": "CWE-287",
    "filename": "enterprise/security/src/main/java/org/neo4j/server/security/enterprise/auth/LdapRealm.java",
    "is_vulnerable": 0,
    "class_name": "LdapRealm",
    "subclass_name": null,
    "function_name": "doGetAuthorizationInfo( PrincipalCollection principals )",
    "function_body": "{\n        try\n        {\n            AuthorizationInfo info = super.doGetAuthorizationInfo( principals );\n            securityLog.debug( withRealm( \"Queried for authorization info for user '%s'\",\n                    principals.getPrimaryPrincipal() ) );\n            return info;\n        }\n        catch ( AuthorizationException e )\n        {\n            securityLog.warn( withRealm( \"Failed to get authorization info: '%s' caused by '%s'\",\n                    e.getMessage(), e.getCause().getMessage() ) );\n            return null;\n        }\n    }"
  },
  {
    "id": 59,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 12,
    "human_patch": "https://github.com/neo4j/neo4j/commit/46de5d01ae2741ffe04c36270fc62c6d490f65c9",
    "cve_id": "CVE-2018-18389",
    "cwe_id": "CWE-287",
    "filename": "enterprise/security/src/main/java/org/neo4j/server/security/enterprise/auth/LdapRealm.java",
    "is_vulnerable": 0,
    "class_name": "LdapRealm",
    "subclass_name": null,
    "function_name": "isExceptionAnLdapReadTimeout( Exception e )",
    "function_body": "{\n        return e instanceof NamingException &&\n               e.getMessage().contains( JNDI_LDAP_READ_TIMEOUT_MESSAGE_PART );\n    }"
  },
  {
    "id": 59,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 13,
    "human_patch": "https://github.com/neo4j/neo4j/commit/46de5d01ae2741ffe04c36270fc62c6d490f65c9",
    "cve_id": "CVE-2018-18389",
    "cwe_id": "CWE-287",
    "filename": "enterprise/security/src/main/java/org/neo4j/server/security/enterprise/auth/LdapRealm.java",
    "is_vulnerable": 0,
    "class_name": "LdapRealm",
    "subclass_name": null,
    "function_name": "isExceptionAnLdapConnectionTimeout( Exception e )",
    "function_body": "{\n        return e instanceof CommunicationException &&\n               (((CommunicationException) e).getRootCause() instanceof SocketTimeoutException ||\n                ((CommunicationException) e).getRootCause().getMessage().contains(\n                        JNDI_LDAP_CONNECTION_TIMEOUT_MESSAGE_PART ) );\n    }"
  },
  {
    "id": 59,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 14,
    "human_patch": "https://github.com/neo4j/neo4j/commit/46de5d01ae2741ffe04c36270fc62c6d490f65c9",
    "cve_id": "CVE-2018-18389",
    "cwe_id": "CWE-287",
    "filename": "enterprise/security/src/main/java/org/neo4j/server/security/enterprise/auth/LdapRealm.java",
    "is_vulnerable": 0,
    "class_name": "LdapRealm",
    "subclass_name": null,
    "function_name": "isExceptionConnectionRefused( Exception e )",
    "function_body": "{\n        return e instanceof CommunicationException &&\n                ((CommunicationException) e).getRootCause() instanceof ConnectException;\n    }"
  },
  {
    "id": 59,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 15,
    "human_patch": "https://github.com/neo4j/neo4j/commit/46de5d01ae2741ffe04c36270fc62c6d490f65c9",
    "cve_id": "CVE-2018-18389",
    "cwe_id": "CWE-287",
    "filename": "enterprise/security/src/main/java/org/neo4j/server/security/enterprise/auth/LdapRealm.java",
    "is_vulnerable": 0,
    "class_name": "LdapRealm",
    "subclass_name": null,
    "function_name": "isAuthorizationExceptionAnLdapReadTimeout( AuthorizationException e )",
    "function_body": "{\n        \n        return e.getCause() != null && e.getCause() instanceof NamingException &&\n               e.getCause().getMessage().contains( JNDI_LDAP_READ_TIMEOUT_MESSAGE_PART );\n    }"
  },
  {
    "id": 59,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 16,
    "human_patch": "https://github.com/neo4j/neo4j/commit/46de5d01ae2741ffe04c36270fc62c6d490f65c9",
    "cve_id": "CVE-2018-18389",
    "cwe_id": "CWE-287",
    "filename": "enterprise/security/src/main/java/org/neo4j/server/security/enterprise/auth/LdapRealm.java",
    "is_vulnerable": 0,
    "class_name": "LdapRealm",
    "subclass_name": null,
    "function_name": "cacheAuthorizationInfo( String username, Set<String> roleNames )",
    "function_body": "{\n        \n        Cache<Object, AuthorizationInfo> authorizationCache = getAuthorizationCache();\n        authorizationCache.put( username, new SimpleAuthorizationInfo( roleNames ) );\n    }"
  },
  {
    "id": 59,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 17,
    "human_patch": "https://github.com/neo4j/neo4j/commit/46de5d01ae2741ffe04c36270fc62c6d490f65c9",
    "cve_id": "CVE-2018-18389",
    "cwe_id": "CWE-287",
    "filename": "enterprise/security/src/main/java/org/neo4j/server/security/enterprise/auth/LdapRealm.java",
    "is_vulnerable": 0,
    "class_name": "LdapRealm",
    "subclass_name": null,
    "function_name": "configureRealm( Config config )",
    "function_body": "{\n        JndiLdapContextFactory contextFactory = new JndiLdapContextFactory();\n        Map<String,Object> environment = contextFactory.getEnvironment();\n        Long connectionTimeoutMillis = config.get( SecuritySettings.ldap_connection_timeout ).toMillis();\n        Long readTimeoutMillis = config.get( SecuritySettings.ldap_read_timeout ).toMillis();\n        environment.put( JNDI_LDAP_CONNECT_TIMEOUT, connectionTimeoutMillis.toString() );\n        environment.put( JNDI_LDAP_READ_TIMEOUT, readTimeoutMillis.toString() );\n        contextFactory.setEnvironment( environment );\n        contextFactory.setUrl( parseLdapServerUrl( config.get( SecuritySettings.ldap_server ) ) );\n        contextFactory.setAuthenticationMechanism( config.get( SecuritySettings.ldap_authentication_mechanism ) );\n        contextFactory.setReferral( config.get( SecuritySettings.ldap_referral ) );\n        contextFactory.setSystemUsername( config.get( SecuritySettings.ldap_authorization_system_username ) );\n        contextFactory.setSystemPassword( config.get( SecuritySettings.ldap_authorization_system_password ) );\n        contextFactory.setPoolingEnabled( config.get( SecuritySettings.ldap_authorization_connection_pooling ) );\n\n        setContextFactory( contextFactory );\n\n        String userDnTemplate = config.get( SecuritySettings.ldap_authentication_user_dn_template );\n        if ( userDnTemplate != null )\n        {\n            setUserDnTemplate( userDnTemplate );\n        }\n\n        authenticationEnabled = config.get( SecuritySettings.ldap_authentication_enabled );\n        authorizationEnabled = config.get( SecuritySettings.ldap_authorization_enabled );\n        useStartTls = config.get( SecuritySettings.ldap_use_starttls );\n\n        userSearchBase = config.get( SecuritySettings.ldap_authorization_user_search_base );\n        userSearchFilter = config.get( SecuritySettings.ldap_authorization_user_search_filter );\n        useSAMAccountName = config.get( SecuritySettings.ldap_authentication_use_samaccountname );\n        membershipAttributeNames = config.get( SecuritySettings.ldap_authorization_group_membership_attribute_names );\n        useSystemAccountForAuthorization = config.get( SecuritySettings.ldap_authorization_use_system_account );\n        groupToRoleMapping =\n                parseGroupToRoleMapping( config.get( SecuritySettings.ldap_authorization_group_to_role_mapping ) );\n\n        setAuthenticationCachingEnabled( config.get( SecuritySettings.ldap_authentication_cache_enabled ) );\n        setAuthorizationCachingEnabled( true );\n    }"
  },
  {
    "id": 59,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 18,
    "human_patch": "https://github.com/neo4j/neo4j/commit/46de5d01ae2741ffe04c36270fc62c6d490f65c9",
    "cve_id": "CVE-2018-18389",
    "cwe_id": "CWE-287",
    "filename": "enterprise/security/src/main/java/org/neo4j/server/security/enterprise/auth/LdapRealm.java",
    "is_vulnerable": 0,
    "class_name": "LdapRealm",
    "subclass_name": null,
    "function_name": "parseLdapServerUrl( String rawLdapServer )",
    "function_body": "{\n        return (rawLdapServer == null) ? null :\n               rawLdapServer.contains( \"://\" ) ? rawLdapServer : \"ldap://\" + rawLdapServer;\n    }"
  },
  {
    "id": 59,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 19,
    "human_patch": "https://github.com/neo4j/neo4j/commit/46de5d01ae2741ffe04c36270fc62c6d490f65c9",
    "cve_id": "CVE-2018-18389",
    "cwe_id": "CWE-287",
    "filename": "enterprise/security/src/main/java/org/neo4j/server/security/enterprise/auth/LdapRealm.java",
    "is_vulnerable": 0,
    "class_name": "LdapRealm",
    "subclass_name": null,
    "function_name": "parseGroupToRoleMapping( String groupToRoleMappingString )",
    "function_body": "{\n        Map<String,Collection<String>> map = new HashMap<>();\n\n        if ( groupToRoleMappingString != null )\n        {\n            for ( String groupAndRoles : groupToRoleMappingString.split( GROUP_DELIMITER ) )\n            {\n                if ( !groupAndRoles.isEmpty() )\n                {\n                    Matcher matcher = keyValuePattern.matcher( groupAndRoles );\n                    if ( !(matcher.find() && matcher.groupCount() == 6) )\n                    {\n                        String errorMessage = format( \"Failed to parse setting %s: wrong number of fields\",\n                                SecuritySettings.ldap_authorization_group_to_role_mapping.name() );\n                        throw new IllegalArgumentException( errorMessage );\n                    }\n\n                    String group = matcher.group(2) != null ? matcher.group(2) :\n                                   matcher.group(3) != null ? matcher.group(3) :\n                                   matcher.group(4) != null ? matcher.group(4) :\n                                   matcher.group(5) != null ? matcher.group(5) : \"\";\n\n                    if ( group.isEmpty() )\n                    {\n                        String errorMessage = format( \"Failed to parse setting %s: empty group name\",\n                                SecuritySettings.ldap_authorization_group_to_role_mapping.name() );\n                        throw new IllegalArgumentException( errorMessage );\n                    }\n                    Collection<String> roleList = new ArrayList<>();\n                    for ( String role : matcher.group(6).trim().split( ROLE_DELIMITER ) )\n                    {\n                        if ( !role.isEmpty() )\n                        {\n                            roleList.add( role );\n                        }\n                    }\n                    \n                    map.put( group.toLowerCase(), roleList );\n                }\n            }\n        }\n\n        return map;\n    }"
  },
  {
    "id": 59,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 20,
    "human_patch": "https://github.com/neo4j/neo4j/commit/46de5d01ae2741ffe04c36270fc62c6d490f65c9",
    "cve_id": "CVE-2018-18389",
    "cwe_id": "CWE-287",
    "filename": "enterprise/security/src/main/java/org/neo4j/server/security/enterprise/auth/LdapRealm.java",
    "is_vulnerable": 0,
    "class_name": "LdapRealm",
    "subclass_name": null,
    "function_name": "queryForAuthenticationInfoSAM(\n            AuthenticationToken token, LdapContextFactory ldapContextFactory ) throws NamingException",
    "function_body": "{\n        Object principal = token.getPrincipal();\n        Object credentials = token.getCredentials();\n\n        LdapContext ctx = null;\n        try\n        {\n            ctx = useStartTls ? getSystemLdapContextUsingStartTls( ldapContextFactory ) :\n                                      ldapContextFactory.getSystemLdapContext();\n            String[] attrs = {\"cn\"};\n            SearchControls searchCtls = new SearchControls( SearchControls.SUBTREE_SCOPE, 1, 0, attrs, false, false );\n            Object[] searchArguments = new Object[]{principal};\n            String filter = \"sAMAccountName={0}\";\n            NamingEnumeration<SearchResult> search = ctx.search( userSearchBase, filter, searchArguments, searchCtls );\n            if ( search.hasMore() )\n            {\n                final SearchResult next = search.next();\n                String loginUser = next.getNameInNamespace();\n                if ( search.hasMore() )\n                {\n                    securityLog.error( \"More than one user matching: \" + principal );\n                    throw new AuthenticationException( \"More than one user matching: \" + principal );\n                }\n                else\n                {\n                    LdapContext ctx2 = ldapContextFactory.getLdapContext( loginUser, credentials );\n                    LdapUtils.closeContext( ctx2 );\n                }\n            }\n            else\n            {\n                throw new AuthenticationException( \"No user matching: \" + principal );\n            }\n            return createAuthenticationInfo( token, principal, credentials, ctx );\n        }\n        finally\n        {\n            LdapUtils.closeContext( ctx );\n        }\n    }"
  },
  {
    "id": 59,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 21,
    "human_patch": "https://github.com/neo4j/neo4j/commit/46de5d01ae2741ffe04c36270fc62c6d490f65c9",
    "cve_id": "CVE-2018-18389",
    "cwe_id": "CWE-287",
    "filename": "enterprise/security/src/main/java/org/neo4j/server/security/enterprise/auth/LdapRealm.java",
    "is_vulnerable": 0,
    "class_name": "LdapRealm",
    "subclass_name": null,
    "function_name": "findRoleNamesForUser( String username, LdapContext ldapContext ) throws NamingException",
    "function_body": "{\n        Set<String> roleNames = new LinkedHashSet<>();\n\n        SearchControls searchCtls = new SearchControls();\n        searchCtls.setSearchScope( SearchControls.SUBTREE_SCOPE );\n        searchCtls.setReturningAttributes( membershipAttributeNames.toArray( new String[1] ) );\n\n        \n        Object[] searchArguments = new Object[]{username};\n\n        NamingEnumeration result = ldapContext.search( userSearchBase, userSearchFilter, searchArguments, searchCtls );\n\n        if ( result.hasMoreElements() )\n        {\n            SearchResult searchResult = (SearchResult) result.next();\n\n            if ( result.hasMoreElements() )\n            {\n                securityLog.warn(\n                        securityLog.isDebugEnabled() ?\n                        withRealm(\n                            \"LDAP user search for user principal '%s' is ambiguous. The first match that will \" +\n                                            \"be checked for group membership is '%s' but the search also matches '%s'. \" +\n                                            \"Please check your LDAP realm configuration.\",\n                            username, searchResult.toString(), result.next().toString() )\n                        :\n                        withRealm(\n                            \"LDAP user search for user principal '%s' is ambiguous. The search matches more \" +\n                                            \"than one entry. Please check your LDAP realm configuration.\",\n                            username )\n                    );\n            }\n\n            Attributes attributes = searchResult.getAttributes();\n            if ( attributes != null )\n            {\n                NamingEnumeration attributeEnumeration = attributes.getAll();\n                while ( attributeEnumeration.hasMore() )\n                {\n                    Attribute attribute = (Attribute) attributeEnumeration.next();\n                    String attributeId = attribute.getID();\n                    if ( membershipAttributeNames.stream().anyMatch( attributeId::equalsIgnoreCase ) )\n                    {\n                        Collection<String> groupNames = LdapUtils.getAllAttributeValues( attribute );\n                        Collection<String> rolesForGroups = getRoleNamesForGroups( groupNames );\n                        roleNames.addAll( rolesForGroups );\n                    }\n                }\n            }\n        }\n        return roleNames;\n    }"
  },
  {
    "id": 59,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 22,
    "human_patch": "https://github.com/neo4j/neo4j/commit/46de5d01ae2741ffe04c36270fc62c6d490f65c9",
    "cve_id": "CVE-2018-18389",
    "cwe_id": "CWE-287",
    "filename": "enterprise/security/src/main/java/org/neo4j/server/security/enterprise/auth/LdapRealm.java",
    "is_vulnerable": 0,
    "class_name": "LdapRealm",
    "subclass_name": null,
    "function_name": "assertValidUserSearchSettings()",
    "function_body": "{\n        boolean proceedWithSearch = true;\n\n        if ( userSearchBase == null || userSearchBase.isEmpty() )\n        {\n            securityLog.error( \"LDAP user search base is empty.\" );\n            proceedWithSearch = false;\n        }\n        if ( userSearchFilter == null || !userSearchFilter.contains( \"{0}\" ) )\n        {\n            securityLog.warn( \"LDAP user search filter does not contain the argument placeholder {0}, \" +\n                    \"so the search result will be independent of the user principal.\" );\n        }\n        if ( membershipAttributeNames == null || membershipAttributeNames.isEmpty() )\n        {\n            \n            securityLog.error( \"LDAP group membership attribute names are empty. Authorization will not be possible.\" );\n            proceedWithSearch = false;\n        }\n\n        if ( !proceedWithSearch )\n        {\n            throw new IllegalArgumentException( \"Illegal LDAP user search settings, see security log for details.\" );\n        }\n    }"
  },
  {
    "id": 59,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 23,
    "human_patch": "https://github.com/neo4j/neo4j/commit/46de5d01ae2741ffe04c36270fc62c6d490f65c9",
    "cve_id": "CVE-2018-18389",
    "cwe_id": "CWE-287",
    "filename": "enterprise/security/src/main/java/org/neo4j/server/security/enterprise/auth/LdapRealm.java",
    "is_vulnerable": 0,
    "class_name": "LdapRealm",
    "subclass_name": null,
    "function_name": "getRoleNamesForGroups( Collection<String> groupNames )",
    "function_body": "{\n        Collection<String> roles = new ArrayList<>();\n        for ( String group : groupNames )\n        {\n            Collection<String> rolesForGroup = groupToRoleMapping.get( group.toLowerCase() );\n            if ( rolesForGroup != null )\n            {\n                roles.addAll( rolesForGroup );\n            }\n        }\n        return roles;\n    }"
  },
  {
    "id": 59,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 24,
    "human_patch": "https://github.com/neo4j/neo4j/commit/46de5d01ae2741ffe04c36270fc62c6d490f65c9",
    "cve_id": "CVE-2018-18389",
    "cwe_id": "CWE-287",
    "filename": "enterprise/security/src/main/java/org/neo4j/server/security/enterprise/auth/LdapRealm.java",
    "is_vulnerable": 0,
    "class_name": "LdapRealm",
    "subclass_name": null,
    "function_name": "getGroupToRoleMapping()",
    "function_body": "{\n        return groupToRoleMapping;\n    }"
  },
  {
    "id": 59,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 25,
    "human_patch": "https://github.com/neo4j/neo4j/commit/46de5d01ae2741ffe04c36270fc62c6d490f65c9",
    "cve_id": "CVE-2018-18389",
    "cwe_id": "CWE-287",
    "filename": "enterprise/security/src/main/java/org/neo4j/server/security/enterprise/auth/LdapRealm.java",
    "is_vulnerable": 0,
    "class_name": "LdapRealm",
    "subclass_name": null,
    "function_name": "initialize()",
    "function_body": "{\n        if ( authorizationEnabled )\n        {\n            \n            assertValidUserSearchSettings();\n        }\n    }"
  },
  {
    "id": 59,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 26,
    "human_patch": "https://github.com/neo4j/neo4j/commit/46de5d01ae2741ffe04c36270fc62c6d490f65c9",
    "cve_id": "CVE-2018-18389",
    "cwe_id": "CWE-287",
    "filename": "enterprise/security/src/main/java/org/neo4j/server/security/enterprise/auth/LdapRealm.java",
    "is_vulnerable": 0,
    "class_name": "LdapRealm",
    "subclass_name": null,
    "function_name": "start()",
    "function_body": "{\n    }"
  },
  {
    "id": 59,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 27,
    "human_patch": "https://github.com/neo4j/neo4j/commit/46de5d01ae2741ffe04c36270fc62c6d490f65c9",
    "cve_id": "CVE-2018-18389",
    "cwe_id": "CWE-287",
    "filename": "enterprise/security/src/main/java/org/neo4j/server/security/enterprise/auth/LdapRealm.java",
    "is_vulnerable": 0,
    "class_name": "LdapRealm",
    "subclass_name": null,
    "function_name": "stop()",
    "function_body": "{\n    }"
  },
  {
    "id": 59,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 28,
    "human_patch": "https://github.com/neo4j/neo4j/commit/46de5d01ae2741ffe04c36270fc62c6d490f65c9",
    "cve_id": "CVE-2018-18389",
    "cwe_id": "CWE-287",
    "filename": "enterprise/security/src/main/java/org/neo4j/server/security/enterprise/auth/LdapRealm.java",
    "is_vulnerable": 0,
    "class_name": "LdapRealm",
    "subclass_name": null,
    "function_name": "shutdown()",
    "function_body": "{\n    }"
  },
  {
    "id": 59,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 29,
    "human_patch": "https://github.com/neo4j/neo4j/commit/46de5d01ae2741ffe04c36270fc62c6d490f65c9",
    "cve_id": "CVE-2018-18389",
    "cwe_id": "CWE-287",
    "filename": "enterprise/security/src/main/java/org/neo4j/server/security/enterprise/auth/LdapRealm.java",
    "is_vulnerable": 0,
    "class_name": "LdapRealm",
    "subclass_name": null,
    "function_name": "getAuthorizationInfoSnapshot( PrincipalCollection principalCollection )",
    "function_body": "{\n        return getAuthorizationInfo( principalCollection );\n    }"
  },
  {
    "id": 59,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 0,
    "human_patch": "https://github.com/neo4j/neo4j/commit/46de5d01ae2741ffe04c36270fc62c6d490f65c9",
    "cve_id": "CVE-2018-18389",
    "cwe_id": "CWE-287",
    "filename": "enterprise/security/src/test/java/org/neo4j/server/security/enterprise/auth/integration/bolt/LdapAuthIT.java",
    "is_vulnerable": 0,
    "class_name": "LdapAuthIT",
    "subclass_name": null,
    "function_name": "setup()",
    "function_body": "{\n        super.setup();\n        getLdapServer().setConfidentialityRequired( false );\n    }"
  },
  {
    "id": 59,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 1,
    "human_patch": "https://github.com/neo4j/neo4j/commit/46de5d01ae2741ffe04c36270fc62c6d490f65c9",
    "cve_id": "CVE-2018-18389",
    "cwe_id": "CWE-287",
    "filename": "enterprise/security/src/test/java/org/neo4j/server/security/enterprise/auth/integration/bolt/LdapAuthIT.java",
    "is_vulnerable": 0,
    "class_name": "LdapAuthIT",
    "subclass_name": null,
    "function_name": "restartNeo4jServerWithSaslDigestMd5()",
    "function_body": "{\n        server.shutdownDatabase();\n        server.ensureDatabase( asSettings( ldapOnlyAuthSettings.andThen(\n                settings ->\n                {\n                    settings.put( SecuritySettings.ldap_authentication_mechanism, \"DIGEST-MD5\" );\n                    settings.put( SecuritySettings.ldap_authentication_user_dn_template, \"{0}\" );\n                }\n        ) ) );\n        lookupConnectorAddress();\n    }"
  },
  {
    "id": 59,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 2,
    "human_patch": "https://github.com/neo4j/neo4j/commit/46de5d01ae2741ffe04c36270fc62c6d490f65c9",
    "cve_id": "CVE-2018-18389",
    "cwe_id": "CWE-287",
    "filename": "enterprise/security/src/test/java/org/neo4j/server/security/enterprise/auth/integration/bolt/LdapAuthIT.java",
    "is_vulnerable": 0,
    "class_name": "LdapAuthIT",
    "subclass_name": null,
    "function_name": "restartNeo4jServerWithSaslCramMd5()",
    "function_body": "{\n        server.shutdownDatabase();\n        server.ensureDatabase( asSettings( ldapOnlyAuthSettings.andThen(\n                settings ->\n                {\n                    settings.put( SecuritySettings.ldap_authentication_mechanism, \"CRAM-MD5\" );\n                    settings.put( SecuritySettings.ldap_authentication_user_dn_template, \"{0}\" );\n                }\n        ) ) );\n        lookupConnectorAddress();\n    }"
  },
  {
    "id": 59,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 3,
    "human_patch": "https://github.com/neo4j/neo4j/commit/46de5d01ae2741ffe04c36270fc62c6d490f65c9",
    "cve_id": "CVE-2018-18389",
    "cwe_id": "CWE-287",
    "filename": "enterprise/security/src/test/java/org/neo4j/server/security/enterprise/auth/integration/bolt/LdapAuthIT.java",
    "is_vulnerable": 0,
    "class_name": "LdapAuthIT",
    "subclass_name": null,
    "function_name": "getSettingsFunction()",
    "function_body": "{\n        return super.getSettingsFunction().andThen( ldapOnlyAuthSettings ).andThen( settings ->\n        {\n            settings.put( SecuritySettings.ldap_server, \"0.0.0.0:10389\" );\n            settings.put( SecuritySettings.ldap_authentication_user_dn_template, \"cn={0},ou=users,dc=example,dc=com\" );\n            settings.put( SecuritySettings.ldap_authentication_cache_enabled, \"true\" );\n            settings.put( SecuritySettings.ldap_authorization_system_username, \"uid=admin,ou=system\" );\n            settings.put( SecuritySettings.ldap_authorization_system_password, \"secret\" );\n            settings.put( SecuritySettings.ldap_authorization_use_system_account, \"true\" );\n            settings.put( SecuritySettings.ldap_authorization_user_search_base, \"dc=example,dc=com\" );\n            settings.put( SecuritySettings.ldap_authorization_user_search_filter, \"(&(objectClass=*)(uid={0}))\" );\n            settings.put( SecuritySettings.ldap_authorization_group_membership_attribute_names, \"gidnumber\" );\n            settings.put( SecuritySettings.ldap_authorization_group_to_role_mapping,\n                    \"500=reader;501=publisher;502=architect;503=admin\" );\n            settings.put( SecuritySettings.procedure_roles, \"test.allowedReadProcedure:role1\" );\n            settings.put( SecuritySettings.ldap_read_timeout, \"1s\" );\n        } );\n    }"
  },
  {
    "id": 59,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 4,
    "human_patch": "https://github.com/neo4j/neo4j/commit/46de5d01ae2741ffe04c36270fc62c6d490f65c9",
    "cve_id": "CVE-2018-18389",
    "cwe_id": "CWE-287",
    "filename": "enterprise/security/src/test/java/org/neo4j/server/security/enterprise/auth/integration/bolt/LdapAuthIT.java",
    "is_vulnerable": 0,
    "class_name": "LdapAuthIT",
    "subclass_name": null,
    "function_name": "shouldLoginWithLdap() throws Throwable",
    "function_body": "{\n        assertAuth( \"neo4j\", \"abc123\" );\n        reconnect();\n        assertAuth( \"neo4j\", \"abc123\" );\n    }"
  },
  {
    "id": 59,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 5,
    "human_patch": "https://github.com/neo4j/neo4j/commit/46de5d01ae2741ffe04c36270fc62c6d490f65c9",
    "cve_id": "CVE-2018-18389",
    "cwe_id": "CWE-287",
    "filename": "enterprise/security/src/test/java/org/neo4j/server/security/enterprise/auth/integration/bolt/LdapAuthIT.java",
    "is_vulnerable": 0,
    "class_name": "LdapAuthIT",
    "subclass_name": null,
    "function_name": "shouldLoginWithLdapWithAuthenticationCacheDisabled() throws Throwable",
    "function_body": "{\n        restartNeo4jServerWithOverriddenSettings( ldapOnlyAuthSettings\n                .andThen( settings -> settings.put( SecuritySettings.ldap_authentication_cache_enabled, \"false\" ) ) );\n\n        assertAuth( \"neo4j\", \"abc123\" );\n        reconnect();\n        assertAuth( \"neo4j\", \"abc123\" );\n    }"
  },
  {
    "id": 59,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 6,
    "human_patch": "https://github.com/neo4j/neo4j/commit/46de5d01ae2741ffe04c36270fc62c6d490f65c9",
    "cve_id": "CVE-2018-18389",
    "cwe_id": "CWE-287",
    "filename": "enterprise/security/src/test/java/org/neo4j/server/security/enterprise/auth/integration/bolt/LdapAuthIT.java",
    "is_vulnerable": 0,
    "class_name": "LdapAuthIT",
    "subclass_name": null,
    "function_name": "shouldFailToLoginWithLdapIfInvalidCredentials() throws Throwable",
    "function_body": "{\n        assertAuthFail( \"neo4j\", \"CANT_REMEMBER_MY_PASSWORDS_ANYMORE!\" );\n    }"
  },
  {
    "id": 59,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 7,
    "human_patch": "https://github.com/neo4j/neo4j/commit/46de5d01ae2741ffe04c36270fc62c6d490f65c9",
    "cve_id": "CVE-2018-18389",
    "cwe_id": "CWE-287",
    "filename": "enterprise/security/src/test/java/org/neo4j/server/security/enterprise/auth/integration/bolt/LdapAuthIT.java",
    "is_vulnerable": 0,
    "class_name": "LdapAuthIT",
    "subclass_name": null,
    "function_name": "shoulFailToLoginWithLdapIfInvalidCredentialsFollowingSuccessfulLogin() throws Throwable",
    "function_body": "{\n        assertAuth( \"neo4j\", \"abc123\" );\n        reconnect();\n        assertAuthFail( \"neo4j\", \"\" );\n    }"
  },
  {
    "id": 59,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 8,
    "human_patch": "https://github.com/neo4j/neo4j/commit/46de5d01ae2741ffe04c36270fc62c6d490f65c9",
    "cve_id": "CVE-2018-18389",
    "cwe_id": "CWE-287",
    "filename": "enterprise/security/src/test/java/org/neo4j/server/security/enterprise/auth/integration/bolt/LdapAuthIT.java",
    "is_vulnerable": 0,
    "class_name": "LdapAuthIT",
    "subclass_name": null,
    "function_name": "shouldLoginWithLdapUsingSaslDigestMd5() throws Throwable",
    "function_body": "{\n        \n        restartNeo4jServerWithSaslDigestMd5();\n\n        \n        assertAuth( \"neo4j\", MD5_HASHED_abc123 );\n    }"
  },
  {
    "id": 59,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 9,
    "human_patch": "https://github.com/neo4j/neo4j/commit/46de5d01ae2741ffe04c36270fc62c6d490f65c9",
    "cve_id": "CVE-2018-18389",
    "cwe_id": "CWE-287",
    "filename": "enterprise/security/src/test/java/org/neo4j/server/security/enterprise/auth/integration/bolt/LdapAuthIT.java",
    "is_vulnerable": 0,
    "class_name": "LdapAuthIT",
    "subclass_name": null,
    "function_name": "shouldFailToLoginWithLdapDigestMd5IfInvalidCredentials() throws Throwable",
    "function_body": "{\n        \n        restartNeo4jServerWithSaslDigestMd5();\n\n        \n        assertAuthFail( \"neo4j\", MD5_HASHED_abc123.toUpperCase() );\n    }"
  },
  {
    "id": 59,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 10,
    "human_patch": "https://github.com/neo4j/neo4j/commit/46de5d01ae2741ffe04c36270fc62c6d490f65c9",
    "cve_id": "CVE-2018-18389",
    "cwe_id": "CWE-287",
    "filename": "enterprise/security/src/test/java/org/neo4j/server/security/enterprise/auth/integration/bolt/LdapAuthIT.java",
    "is_vulnerable": 0,
    "class_name": "LdapAuthIT",
    "subclass_name": null,
    "function_name": "shouldLoginWithLdapUsingSaslCramMd5() throws Throwable",
    "function_body": "{\n        \n        restartNeo4jServerWithSaslCramMd5();\n\n        \n        assertAuth( \"neo4j\", MD5_HASHED_abc123 );\n    }"
  },
  {
    "id": 59,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 11,
    "human_patch": "https://github.com/neo4j/neo4j/commit/46de5d01ae2741ffe04c36270fc62c6d490f65c9",
    "cve_id": "CVE-2018-18389",
    "cwe_id": "CWE-287",
    "filename": "enterprise/security/src/test/java/org/neo4j/server/security/enterprise/auth/integration/bolt/LdapAuthIT.java",
    "is_vulnerable": 0,
    "class_name": "LdapAuthIT",
    "subclass_name": null,
    "function_name": "shouldFailToLoginWithLdapCramMd5IfInvalidCredentials() throws Throwable",
    "function_body": "{\n        \n        restartNeo4jServerWithSaslCramMd5();\n\n        \n        assertAuthFail( \"neo4j\", MD5_HASHED_abc123.toUpperCase() );\n    }"
  },
  {
    "id": 59,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 12,
    "human_patch": "https://github.com/neo4j/neo4j/commit/46de5d01ae2741ffe04c36270fc62c6d490f65c9",
    "cve_id": "CVE-2018-18389",
    "cwe_id": "CWE-287",
    "filename": "enterprise/security/src/test/java/org/neo4j/server/security/enterprise/auth/integration/bolt/LdapAuthIT.java",
    "is_vulnerable": 0,
    "class_name": "LdapAuthIT",
    "subclass_name": null,
    "function_name": "shouldBeAbleToLoginAndAuthorizeReaderWithLdapOnly() throws Throwable",
    "function_body": "{\n        testAuthWithReaderUser();\n    }"
  },
  {
    "id": 59,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 13,
    "human_patch": "https://github.com/neo4j/neo4j/commit/46de5d01ae2741ffe04c36270fc62c6d490f65c9",
    "cve_id": "CVE-2018-18389",
    "cwe_id": "CWE-287",
    "filename": "enterprise/security/src/test/java/org/neo4j/server/security/enterprise/auth/integration/bolt/LdapAuthIT.java",
    "is_vulnerable": 0,
    "class_name": "LdapAuthIT",
    "subclass_name": null,
    "function_name": "shouldBeAbleToLoginAndAuthorizePublisherWithLdapOnly() throws Throwable",
    "function_body": "{\n        testAuthWithPublisherUser();\n    }"
  },
  {
    "id": 59,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 14,
    "human_patch": "https://github.com/neo4j/neo4j/commit/46de5d01ae2741ffe04c36270fc62c6d490f65c9",
    "cve_id": "CVE-2018-18389",
    "cwe_id": "CWE-287",
    "filename": "enterprise/security/src/test/java/org/neo4j/server/security/enterprise/auth/integration/bolt/LdapAuthIT.java",
    "is_vulnerable": 0,
    "class_name": "LdapAuthIT",
    "subclass_name": null,
    "function_name": "shouldBeAbleToLoginAndAuthorizeNoPermissionUserWithLdapOnly() throws Throwable",
    "function_body": "{\n        testAuthWithNoPermissionUser( \"smith\", \"abc123\" );\n    }"
  },
  {
    "id": 59,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 15,
    "human_patch": "https://github.com/neo4j/neo4j/commit/46de5d01ae2741ffe04c36270fc62c6d490f65c9",
    "cve_id": "CVE-2018-18389",
    "cwe_id": "CWE-287",
    "filename": "enterprise/security/src/test/java/org/neo4j/server/security/enterprise/auth/integration/bolt/LdapAuthIT.java",
    "is_vulnerable": 0,
    "class_name": "LdapAuthIT",
    "subclass_name": null,
    "function_name": "shouldShowCurrentUser() throws Throwable",
    "function_body": "{\n        \n        assertAuth( \"smith\", \"abc123\" );\n        client.send( util.chunk(\n                run( \"CALL dbms.showCurrentUser()\" ),\n                pullAll() ) );\n\n        \n        \n        assertThat( client, util.eventuallyReceives(\n                msgSuccess(),\n                msgRecord(\n                        eqRecord( equalTo( stringValue( \"smith\" ) ), equalTo( EMPTY_LIST ), equalTo( EMPTY_LIST ) ) )\n        ) );\n    }"
  },
  {
    "id": 59,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 16,
    "human_patch": "https://github.com/neo4j/neo4j/commit/46de5d01ae2741ffe04c36270fc62c6d490f65c9",
    "cve_id": "CVE-2018-18389",
    "cwe_id": "CWE-287",
    "filename": "enterprise/security/src/test/java/org/neo4j/server/security/enterprise/auth/integration/bolt/LdapAuthIT.java",
    "is_vulnerable": 0,
    "class_name": "LdapAuthIT",
    "subclass_name": null,
    "function_name": "shouldBeAbleToLoginAndAuthorizeNoPermissionUserWithLdapOnlyAndNoGroupToRoleMapping() throws Throwable",
    "function_body": "{\n        \n        restartNeo4jServerWithOverriddenSettings( ldapOnlyAuthSettings\n                .andThen(\n                        settings -> settings.put( SecuritySettings.ldap_authorization_group_to_role_mapping, null ) ) );\n\n        \n        \n        \n        testAuthWithNoPermissionUser( \"neo\", \"abc123\" );\n    }"
  },
  {
    "id": 59,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 17,
    "human_patch": "https://github.com/neo4j/neo4j/commit/46de5d01ae2741ffe04c36270fc62c6d490f65c9",
    "cve_id": "CVE-2018-18389",
    "cwe_id": "CWE-287",
    "filename": "enterprise/security/src/test/java/org/neo4j/server/security/enterprise/auth/integration/bolt/LdapAuthIT.java",
    "is_vulnerable": 0,
    "class_name": "LdapAuthIT",
    "subclass_name": null,
    "function_name": "shouldBeAbleToLoginAndAuthorizeWithLdapOnlyAndQuotedGroupToRoleMapping() throws Throwable",
    "function_body": "{\n        \n        restartNeo4jServerWithOverriddenSettings( ldapOnlyAuthSettings\n                .andThen( settings -> settings.put( SecuritySettings.ldap_authorization_group_to_role_mapping,\n                        \" '500'  =\\t reader  ; \\\"501\\\"\\t=publisher\\n;502 =architect  ;  \\\"503\\\"=  \\nadmin\" ) ) );\n\n        \n        testAuthWithReaderUser();\n        reconnect();\n        testAuthWithPublisherUser();\n        reconnect();\n        testAuthWithNoPermissionUser( \"smith\", \"abc123\" );\n    }"
  },
  {
    "id": 59,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 18,
    "human_patch": "https://github.com/neo4j/neo4j/commit/46de5d01ae2741ffe04c36270fc62c6d490f65c9",
    "cve_id": "CVE-2018-18389",
    "cwe_id": "CWE-287",
    "filename": "enterprise/security/src/test/java/org/neo4j/server/security/enterprise/auth/integration/bolt/LdapAuthIT.java",
    "is_vulnerable": 0,
    "class_name": "LdapAuthIT",
    "subclass_name": null,
    "function_name": "shouldBeAbleToLoginAndAuthorizeReaderWithUserLdapContext() throws Throwable",
    "function_body": "{\n        restartServerWithoutSystemAccount();\n\n        \n        testAuthWithReaderUser();\n    }"
  },
  {
    "id": 59,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 19,
    "human_patch": "https://github.com/neo4j/neo4j/commit/46de5d01ae2741ffe04c36270fc62c6d490f65c9",
    "cve_id": "CVE-2018-18389",
    "cwe_id": "CWE-287",
    "filename": "enterprise/security/src/test/java/org/neo4j/server/security/enterprise/auth/integration/bolt/LdapAuthIT.java",
    "is_vulnerable": 0,
    "class_name": "LdapAuthIT",
    "subclass_name": null,
    "function_name": "shouldBeAbleToLoginAndAuthorizePublisherWithUserLdapContext() throws Throwable",
    "function_body": "{\n        restartServerWithoutSystemAccount();\n\n        \n        testAuthWithPublisherUser();\n    }"
  },
  {
    "id": 59,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 20,
    "human_patch": "https://github.com/neo4j/neo4j/commit/46de5d01ae2741ffe04c36270fc62c6d490f65c9",
    "cve_id": "CVE-2018-18389",
    "cwe_id": "CWE-287",
    "filename": "enterprise/security/src/test/java/org/neo4j/server/security/enterprise/auth/integration/bolt/LdapAuthIT.java",
    "is_vulnerable": 0,
    "class_name": "LdapAuthIT",
    "subclass_name": null,
    "function_name": "shouldFailIfAuthorizationExpiredWithUserLdapContext() throws Throwable",
    "function_body": "{\n        restartServerWithoutSystemAccount();\n\n        \n        assertAuth( \"neo4j\", \"abc123\" );\n        assertReadSucceeds();\n\n        \n        client.send( util.chunk(\n                run( \"CALL dbms.security.clearAuthCache()\" ), pullAll() ) );\n        assertThat( client, util.eventuallyReceives( msgSuccess(), msgSuccess() ) );\n\n        \n        client.send( util.chunk(\n                run( \"MATCH (n) RETURN n\" ), pullAll() ) );\n        assertThat( client, util.eventuallyReceives(\n                msgFailure( Status.Security.AuthorizationExpired, \"LDAP authorization info expired.\" ) ) );\n\n        assertThat( client, eventuallyDisconnects() );\n    }"
  },
  {
    "id": 59,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 21,
    "human_patch": "https://github.com/neo4j/neo4j/commit/46de5d01ae2741ffe04c36270fc62c6d490f65c9",
    "cve_id": "CVE-2018-18389",
    "cwe_id": "CWE-287",
    "filename": "enterprise/security/src/test/java/org/neo4j/server/security/enterprise/auth/integration/bolt/LdapAuthIT.java",
    "is_vulnerable": 0,
    "class_name": "LdapAuthIT",
    "subclass_name": null,
    "function_name": "shouldSucceedIfAuthorizationExpiredWithinTransactionWithUserLdapContext() throws Throwable",
    "function_body": "{\n        restartServerWithoutSystemAccount();\n\n        \n        assertAuth( \"neo4j\", \"abc123\" );\n\n        client.send( util.chunk(\n                run( \"CALL dbms.security.clearAuthCache() MATCH (n) RETURN n\" ), pullAll() ) );\n\n        \n        assertThat( client, util.eventuallyReceives( msgSuccess(), msgSuccess() ) );\n    }"
  },
  {
    "id": 59,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 22,
    "human_patch": "https://github.com/neo4j/neo4j/commit/46de5d01ae2741ffe04c36270fc62c6d490f65c9",
    "cve_id": "CVE-2018-18389",
    "cwe_id": "CWE-287",
    "filename": "enterprise/security/src/test/java/org/neo4j/server/security/enterprise/auth/integration/bolt/LdapAuthIT.java",
    "is_vulnerable": 0,
    "class_name": "LdapAuthIT",
    "subclass_name": null,
    "function_name": "shouldBeAbleToLoginAndAuthorizeNoPermissionUserWithUserLdapContext() throws Throwable",
    "function_body": "{\n        restartServerWithoutSystemAccount();\n\n        \n        testAuthWithNoPermissionUser( \"smith\", \"abc123\" );\n    }"
  },
  {
    "id": 59,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 23,
    "human_patch": "https://github.com/neo4j/neo4j/commit/46de5d01ae2741ffe04c36270fc62c6d490f65c9",
    "cve_id": "CVE-2018-18389",
    "cwe_id": "CWE-287",
    "filename": "enterprise/security/src/test/java/org/neo4j/server/security/enterprise/auth/integration/bolt/LdapAuthIT.java",
    "is_vulnerable": 0,
    "class_name": "LdapAuthIT",
    "subclass_name": null,
    "function_name": "shouldBeAbleToLoginAndAuthorizeNoPermissionUserWithUserLdapContextAndNoGroupToRoleMapping() throws Throwable",
    "function_body": "{\n        restartNeo4jServerWithOverriddenSettings( settings ->\n        {\n            settings.put( SecuritySettings.ldap_authorization_use_system_account, \"false\" );\n            settings.put( SecuritySettings.ldap_authorization_group_to_role_mapping, null );\n        } );\n\n        \n        \n        \n        testAuthWithNoPermissionUser( \"neo\", \"abc123\" );\n    }"
  },
  {
    "id": 59,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 24,
    "human_patch": "https://github.com/neo4j/neo4j/commit/46de5d01ae2741ffe04c36270fc62c6d490f65c9",
    "cve_id": "CVE-2018-18389",
    "cwe_id": "CWE-287",
    "filename": "enterprise/security/src/test/java/org/neo4j/server/security/enterprise/auth/integration/bolt/LdapAuthIT.java",
    "is_vulnerable": 0,
    "class_name": "LdapAuthIT",
    "subclass_name": null,
    "function_name": "shouldBeAbleToLoginWithLdapAndAuthorizeInternally() throws Throwable",
    "function_body": "{\n        \n        restartNeo4jServerWithOverriddenSettings( settings ->\n        {\n            settings.put( SecuritySettings.auth_providers,\n                    SecuritySettings.NATIVE_REALM_NAME + \",\" + SecuritySettings.LDAP_REALM_NAME );\n            settings.put( SecuritySettings.native_authentication_enabled, \"false\" );\n            settings.put( SecuritySettings.native_authorization_enabled, \"true\" );\n            settings.put( SecuritySettings.ldap_authentication_enabled, \"true\" );\n            settings.put( SecuritySettings.ldap_authorization_enabled, \"false\" );\n        } );\n\n        \n        \n        testCreateReaderUser();\n\n        \n        reconnect();\n\n        testAuthWithReaderUser();\n    }"
  },
  {
    "id": 59,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 25,
    "human_patch": "https://github.com/neo4j/neo4j/commit/46de5d01ae2741ffe04c36270fc62c6d490f65c9",
    "cve_id": "CVE-2018-18389",
    "cwe_id": "CWE-287",
    "filename": "enterprise/security/src/test/java/org/neo4j/server/security/enterprise/auth/integration/bolt/LdapAuthIT.java",
    "is_vulnerable": 0,
    "class_name": "LdapAuthIT",
    "subclass_name": null,
    "function_name": "shouldBeAbleToLoginNativelyAndAuthorizeWithLdap() throws Throwable",
    "function_body": "{\n        \n        restartNeo4jServerWithOverriddenSettings( settings ->\n        {\n            settings.put( SecuritySettings.auth_providers,\n                    SecuritySettings.NATIVE_REALM_NAME + \",\" + SecuritySettings.LDAP_REALM_NAME );\n            settings.put( SecuritySettings.native_authentication_enabled, \"true\" );\n            settings.put( SecuritySettings.native_authorization_enabled, \"false\" );\n            settings.put( SecuritySettings.ldap_authentication_enabled, \"false\" );\n            settings.put( SecuritySettings.ldap_authorization_enabled, \"true\" );\n        } );\n\n        \n        String ldapReaderUser = \"neo\";\n        String nativePassword = \"nativePassword\";\n\n        createNativeUser( ldapReaderUser, nativePassword );\n\n        \n        \n        testAuthWithReaderUser( ldapReaderUser, nativePassword, null );\n    }"
  },
  {
    "id": 59,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 26,
    "human_patch": "https://github.com/neo4j/neo4j/commit/46de5d01ae2741ffe04c36270fc62c6d490f65c9",
    "cve_id": "CVE-2018-18389",
    "cwe_id": "CWE-287",
    "filename": "enterprise/security/src/test/java/org/neo4j/server/security/enterprise/auth/integration/bolt/LdapAuthIT.java",
    "is_vulnerable": 0,
    "class_name": "LdapAuthIT",
    "subclass_name": null,
    "function_name": "shouldKeepAuthorizationForLifetimeOfTransaction() throws Throwable",
    "function_body": "{\n        restartServerWithoutSystemAccount();\n\n        DoubleLatch latch = new DoubleLatch( 2 );\n        final Throwable[] threadFail = {null};\n\n        Thread readerThread = new Thread( () ->\n        {\n            try\n            {\n                assertAuth( \"neo\", \"abc123\" );\n                assertBeginTransactionSucceeds();\n                assertReadSucceeds();\n\n                latch.startAndWaitForAllToStart();\n                latch.finishAndWaitForAllToFinish();\n\n                assertReadSucceeds();\n            }\n            catch ( Throwable t )\n            {\n                threadFail[0] = t;\n                \n                latch.start();\n                latch.finish();\n            }\n        } );\n\n        readerThread.start();\n        latch.startAndWaitForAllToStart();\n\n        clearAuthCacheFromDifferentConnection();\n\n        latch.finishAndWaitForAllToFinish();\n\n        readerThread.join();\n        if ( threadFail[0] != null )\n        {\n            throw threadFail[0];\n        }\n    }"
  },
  {
    "id": 59,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 27,
    "human_patch": "https://github.com/neo4j/neo4j/commit/46de5d01ae2741ffe04c36270fc62c6d490f65c9",
    "cve_id": "CVE-2018-18389",
    "cwe_id": "CWE-287",
    "filename": "enterprise/security/src/test/java/org/neo4j/server/security/enterprise/auth/integration/bolt/LdapAuthIT.java",
    "is_vulnerable": 0,
    "class_name": "LdapAuthIT",
    "subclass_name": null,
    "function_name": "shouldKeepAuthorizationForLifetimeOfTransactionWithProcedureAllowed() throws Throwable",
    "function_body": "{\n        restartNeo4jServerWithOverriddenSettings( settings ->\n        {\n            settings.put( SecuritySettings.ldap_authorization_use_system_account, \"false\" );\n            settings.put( SecuritySettings.ldap_authorization_group_to_role_mapping, \"503=admin;504=role1\" );\n        } );\n\n        GraphDatabaseAPI graphDatabaseAPI = (GraphDatabaseAPI) server.graphDatabaseService();\n        graphDatabaseAPI.getDependencyResolver().resolveDependency( Procedures.class )\n                .registerProcedure( ProcedureInteractionTestBase.ClassWithProcedures.class );\n\n        DoubleLatch latch = new DoubleLatch( 2 );\n        final Throwable[] threadFail = {null};\n\n        Thread readerThread = new Thread( () ->\n        {\n            try\n            {\n                assertAuth( \"smith\", \"abc123\" );\n                assertBeginTransactionSucceeds();\n                assertAllowedReadProcedure();\n\n                latch.startAndWaitForAllToStart();\n                latch.finishAndWaitForAllToFinish();\n\n                assertAllowedReadProcedure();\n            }\n            catch ( Throwable t )\n            {\n                threadFail[0] = t;\n                \n                latch.start();\n                latch.finish();\n            }\n        } );\n\n        readerThread.start();\n        latch.startAndWaitForAllToStart();\n\n        clearAuthCacheFromDifferentConnection();\n\n        latch.finishAndWaitForAllToFinish();\n\n        readerThread.join();\n        if ( threadFail[0] != null )\n        {\n            throw threadFail[0];\n        }\n    }"
  },
  {
    "id": 59,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 28,
    "human_patch": "https://github.com/neo4j/neo4j/commit/46de5d01ae2741ffe04c36270fc62c6d490f65c9",
    "cve_id": "CVE-2018-18389",
    "cwe_id": "CWE-287",
    "filename": "enterprise/security/src/test/java/org/neo4j/server/security/enterprise/auth/integration/bolt/LdapAuthIT.java",
    "is_vulnerable": 0,
    "class_name": "LdapAuthIT",
    "subclass_name": null,
    "function_name": "shouldBeAbleToUseProcedureAllowedAnnotationWithLdapGroupToRoleMapping() throws Throwable",
    "function_body": "{\n        \n        restartNeo4jServerWithOverriddenSettings( ldapOnlyAuthSettings\n                .andThen( settings -> settings\n                        .put( SecuritySettings.ldap_authorization_group_to_role_mapping, \"500=role1\" ) ) );\n\n        GraphDatabaseAPI graphDatabaseAPI = (GraphDatabaseAPI) server.graphDatabaseService();\n        graphDatabaseAPI.getDependencyResolver().resolveDependency( Procedures.class )\n                .registerProcedure( ProcedureInteractionTestBase.ClassWithProcedures.class );\n\n        assertAuth( \"neo\", \"abc123\" );\n        assertAllowedReadProcedure();\n    }"
  },
  {
    "id": 59,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 29,
    "human_patch": "https://github.com/neo4j/neo4j/commit/46de5d01ae2741ffe04c36270fc62c6d490f65c9",
    "cve_id": "CVE-2018-18389",
    "cwe_id": "CWE-287",
    "filename": "enterprise/security/src/test/java/org/neo4j/server/security/enterprise/auth/integration/bolt/LdapAuthIT.java",
    "is_vulnerable": 0,
    "class_name": "LdapAuthIT",
    "subclass_name": null,
    "function_name": "shouldFailIfInvalidLdapServer() throws Throwable",
    "function_body": "{\n        \n        restartNeo4jServerWithOverriddenSettings( ldapOnlyAuthSettings.andThen(\n                settings -> settings.put( SecuritySettings.ldap_server, \"ldap://127.0.0.1\" ) ) );\n\n        assertConnectionRefused( authToken( \"neo\", \"abc123\", null ),\n                LDAP_CONNECTION_REFUSED_CLIENT_MESSAGE );\n\n        assertThat( client, eventuallyDisconnects() );\n    }"
  },
  {
    "id": 59,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 30,
    "human_patch": "https://github.com/neo4j/neo4j/commit/46de5d01ae2741ffe04c36270fc62c6d490f65c9",
    "cve_id": "CVE-2018-18389",
    "cwe_id": "CWE-287",
    "filename": "enterprise/security/src/test/java/org/neo4j/server/security/enterprise/auth/integration/bolt/LdapAuthIT.java",
    "is_vulnerable": 0,
    "class_name": "LdapAuthIT",
    "subclass_name": null,
    "function_name": "shouldTimeoutIfLdapServerDoesNotRespond() throws Throwable",
    "function_body": "{\n        try ( DirectoryServiceWaitOnSearch ignore = new DirectoryServiceWaitOnSearch( 5000 ) )\n        {\n            restartNeo4jServerWithOverriddenSettings( ldapOnlyAuthSettings\n                    .andThen( settings -> settings.put( SecuritySettings.ldap_read_timeout, \"1s\" ) ) );\n\n            assertAuth( \"neo\", \"abc123\" );\n            assertReadFails( \"neo\", \"\" );\n        }\n    }"
  },
  {
    "id": 59,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 31,
    "human_patch": "https://github.com/neo4j/neo4j/commit/46de5d01ae2741ffe04c36270fc62c6d490f65c9",
    "cve_id": "CVE-2018-18389",
    "cwe_id": "CWE-287",
    "filename": "enterprise/security/src/test/java/org/neo4j/server/security/enterprise/auth/integration/bolt/LdapAuthIT.java",
    "is_vulnerable": 0,
    "class_name": "LdapAuthIT",
    "subclass_name": null,
    "function_name": "shouldTimeoutIfLdapServerDoesNotRespondWithoutConnectionPooling() throws Throwable",
    "function_body": "{\n        try ( DirectoryServiceWaitOnSearch ignore = new DirectoryServiceWaitOnSearch( 5000 ) )\n        {\n            restartNeo4jServerWithOverriddenSettings( ldapOnlyAuthSettings.andThen( settings ->\n            {\n                \n                settings.put( SecuritySettings.ldap_read_timeout, \"1s\" );\n                settings.put( SecuritySettings.ldap_authorization_connection_pooling, \"false\" );\n            } ) );\n\n            assertAuth( \"neo\", \"abc123\" );\n            assertReadFails( \"neo\", \"\" );\n        }\n    }"
  },
  {
    "id": 59,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 32,
    "human_patch": "https://github.com/neo4j/neo4j/commit/46de5d01ae2741ffe04c36270fc62c6d490f65c9",
    "cve_id": "CVE-2018-18389",
    "cwe_id": "CWE-287",
    "filename": "enterprise/security/src/test/java/org/neo4j/server/security/enterprise/auth/integration/bolt/LdapAuthIT.java",
    "is_vulnerable": 0,
    "class_name": "LdapAuthIT",
    "subclass_name": null,
    "function_name": "shouldFailIfLdapSearchFails() throws Throwable",
    "function_body": "{\n        try ( DirectoryServiceFailOnSearch ignore = new DirectoryServiceFailOnSearch() )\n        {\n            restartNeo4jServerWithOverriddenSettings( ldapOnlyAuthSettings\n                    .andThen( settings -> settings.put( SecuritySettings.ldap_read_timeout, \"1s\" ) ) );\n\n            assertAuth( \"neo\", \"abc123\" );\n            assertReadFails( \"neo\", \"\" );\n        }\n    }"
  },
  {
    "id": 59,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 33,
    "human_patch": "https://github.com/neo4j/neo4j/commit/46de5d01ae2741ffe04c36270fc62c6d490f65c9",
    "cve_id": "CVE-2018-18389",
    "cwe_id": "CWE-287",
    "filename": "enterprise/security/src/test/java/org/neo4j/server/security/enterprise/auth/integration/bolt/LdapAuthIT.java",
    "is_vulnerable": 0,
    "class_name": "LdapAuthIT",
    "subclass_name": null,
    "function_name": "shouldTimeoutIfLdapServerDoesNotRespondWithLdapUserContext() throws Throwable",
    "function_body": "{\n        try ( DirectoryServiceWaitOnSearch ignore = new DirectoryServiceWaitOnSearch( 5000 ) )\n        {\n            \n            restartNeo4jServerWithOverriddenSettings( ldapOnlyAuthSettings.andThen( settings ->\n            {\n                settings.put( SecuritySettings.ldap_authorization_use_system_account, \"false\" );\n                settings.put( SecuritySettings.ldap_read_timeout, \"1s\" );\n            } ) );\n\n            assertConnectionTimeout( authToken( \"neo\", \"abc123\", null ),\n                    LDAP_READ_TIMEOUT_CLIENT_MESSAGE );\n        }\n    }"
  },
  {
    "id": 59,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 34,
    "human_patch": "https://github.com/neo4j/neo4j/commit/46de5d01ae2741ffe04c36270fc62c6d490f65c9",
    "cve_id": "CVE-2018-18389",
    "cwe_id": "CWE-287",
    "filename": "enterprise/security/src/test/java/org/neo4j/server/security/enterprise/auth/integration/bolt/LdapAuthIT.java",
    "is_vulnerable": 0,
    "class_name": "LdapAuthIT",
    "subclass_name": null,
    "function_name": "assertAllowedReadProcedure() throws IOException",
    "function_body": "{\n        client.send( util.chunk( run( \"CALL test.allowedReadProcedure()\" ), pullAll() ) );\n\n        \n        assertThat( client, util.eventuallyReceives(\n                msgSuccess(),\n                msgRecord( eqRecord( equalTo( stringValue( \"foo\" ) ) ) ),\n                msgSuccess() ) );\n    }"
  },
  {
    "id": 59,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 35,
    "human_patch": "https://github.com/neo4j/neo4j/commit/46de5d01ae2741ffe04c36270fc62c6d490f65c9",
    "cve_id": "CVE-2018-18389",
    "cwe_id": "CWE-287",
    "filename": "enterprise/security/src/test/java/org/neo4j/server/security/enterprise/auth/integration/bolt/LdapAuthIT.java",
    "is_vulnerable": 0,
    "class_name": "LdapAuthIT",
    "subclass_name": null,
    "function_name": "shouldBeAbleToLoginAndAuthorizeReaderWithLdapOnlyUsingLDAPS() throws Throwable",
    "function_body": "{\n        getLdapServer().setConfidentialityRequired( true );\n\n        try ( EmbeddedTestCertificates ignore = new EmbeddedTestCertificates() )\n        {\n            \n            restartNeo4jServerWithOverriddenSettings( ldapOnlyAuthSettings\n                    .andThen( settings -> settings.put( SecuritySettings.ldap_server, \"ldaps://localhost:10636\" ) ) );\n\n            \n            testAuthWithReaderUser();\n        }\n    }"
  },
  {
    "id": 59,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 36,
    "human_patch": "https://github.com/neo4j/neo4j/commit/46de5d01ae2741ffe04c36270fc62c6d490f65c9",
    "cve_id": "CVE-2018-18389",
    "cwe_id": "CWE-287",
    "filename": "enterprise/security/src/test/java/org/neo4j/server/security/enterprise/auth/integration/bolt/LdapAuthIT.java",
    "is_vulnerable": 0,
    "class_name": "LdapAuthIT",
    "subclass_name": null,
    "function_name": "shouldBeAbleToLoginAndAuthorizeReaderWithUserLdapContextUsingLDAPS() throws Throwable",
    "function_body": "{\n        getLdapServer().setConfidentialityRequired( true );\n\n        try ( EmbeddedTestCertificates ignore = new EmbeddedTestCertificates() )\n        {\n            \n            restartNeo4jServerWithOverriddenSettings( ldapOnlyAuthSettings.andThen( settings ->\n            {\n                settings.put( SecuritySettings.ldap_authorization_use_system_account, \"false\" );\n                settings.put( SecuritySettings.ldap_server, \"ldaps://localhost:10636\" );\n            } ) );\n\n            \n            testAuthWithReaderUser();\n        }\n    }"
  },
  {
    "id": 59,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 37,
    "human_patch": "https://github.com/neo4j/neo4j/commit/46de5d01ae2741ffe04c36270fc62c6d490f65c9",
    "cve_id": "CVE-2018-18389",
    "cwe_id": "CWE-287",
    "filename": "enterprise/security/src/test/java/org/neo4j/server/security/enterprise/auth/integration/bolt/LdapAuthIT.java",
    "is_vulnerable": 0,
    "class_name": "LdapAuthIT",
    "subclass_name": null,
    "function_name": "shouldBeAbleToLoginAndAuthorizeReaderWithLdapOnlyUsingStartTls() throws Throwable",
    "function_body": "{\n        getLdapServer().setConfidentialityRequired( true );\n\n        try ( EmbeddedTestCertificates ignore = new EmbeddedTestCertificates() )\n        {\n            \n            restartNeo4jServerWithOverriddenSettings( ldapOnlyAuthSettings.andThen( settings ->\n            {\n                settings.put( SecuritySettings.ldap_server, \"localhost:10389\" );\n                settings.put( SecuritySettings.ldap_use_starttls, \"true\" );\n            } ) );\n\n            \n            testAuthWithReaderUser();\n        }\n    }"
  },
  {
    "id": 59,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 38,
    "human_patch": "https://github.com/neo4j/neo4j/commit/46de5d01ae2741ffe04c36270fc62c6d490f65c9",
    "cve_id": "CVE-2018-18389",
    "cwe_id": "CWE-287",
    "filename": "enterprise/security/src/test/java/org/neo4j/server/security/enterprise/auth/integration/bolt/LdapAuthIT.java",
    "is_vulnerable": 0,
    "class_name": "LdapAuthIT",
    "subclass_name": null,
    "function_name": "shouldBeAbleToLoginAndAuthorizeReaderWithLdapUserContextUsingStartTls() throws Throwable",
    "function_body": "{\n        getLdapServer().setConfidentialityRequired( true );\n\n        try ( EmbeddedTestCertificates ignore = new EmbeddedTestCertificates() )\n        {\n            \n            restartNeo4jServerWithOverriddenSettings( ldapOnlyAuthSettings.andThen( settings ->\n            {\n                settings.put( SecuritySettings.ldap_authorization_use_system_account, \"false\" );\n                settings.put( SecuritySettings.ldap_server, \"localhost:10389\" );\n                settings.put( SecuritySettings.ldap_use_starttls, \"true\" );\n            } ) );\n\n            \n            testAuthWithReaderUser();\n        }\n    }"
  },
  {
    "id": 59,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 39,
    "human_patch": "https://github.com/neo4j/neo4j/commit/46de5d01ae2741ffe04c36270fc62c6d490f65c9",
    "cve_id": "CVE-2018-18389",
    "cwe_id": "CWE-287",
    "filename": "enterprise/security/src/test/java/org/neo4j/server/security/enterprise/auth/integration/bolt/LdapAuthIT.java",
    "is_vulnerable": 0,
    "class_name": "LdapAuthIT",
    "subclass_name": null,
    "function_name": "shouldNotBeAbleToLoginUnknownUserOnEC2() throws Throwable",
    "function_body": "{\n        restartNeo4jServerWithOverriddenSettings( activeDirectoryOnEc2NotUsingSystemAccountSettings );\n\n        assertAuthFail( \"unknown\", \"abc123ABC123\" );\n    }"
  },
  {
    "id": 59,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 40,
    "human_patch": "https://github.com/neo4j/neo4j/commit/46de5d01ae2741ffe04c36270fc62c6d490f65c9",
    "cve_id": "CVE-2018-18389",
    "cwe_id": "CWE-287",
    "filename": "enterprise/security/src/test/java/org/neo4j/server/security/enterprise/auth/integration/bolt/LdapAuthIT.java",
    "is_vulnerable": 0,
    "class_name": "LdapAuthIT",
    "subclass_name": null,
    "function_name": "shouldBeAbleToLoginAndAuthorizeReaderWithUserLdapContextOnEC2() throws Throwable",
    "function_body": "{\n        restartNeo4jServerWithOverriddenSettings( activeDirectoryOnEc2NotUsingSystemAccountSettings );\n\n        assertAuth( \"neo\", \"abc123ABC123\" );\n        assertReadSucceeds();\n        assertWriteFails( \"neo\", \"\" );\n    }"
  },
  {
    "id": 59,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 41,
    "human_patch": "https://github.com/neo4j/neo4j/commit/46de5d01ae2741ffe04c36270fc62c6d490f65c9",
    "cve_id": "CVE-2018-18389",
    "cwe_id": "CWE-287",
    "filename": "enterprise/security/src/test/java/org/neo4j/server/security/enterprise/auth/integration/bolt/LdapAuthIT.java",
    "is_vulnerable": 0,
    "class_name": "LdapAuthIT",
    "subclass_name": null,
    "function_name": "shouldBeAbleToLoginAndAuthorizeReaderOnEC2() throws Throwable",
    "function_body": "{\n        restartNeo4jServerWithOverriddenSettings( activeDirectoryOnEc2UsingSystemAccountSettings );\n\n        assertAuth( \"neo\", \"abc123ABC123\" );\n        assertReadSucceeds();\n        assertWriteFails( \"neo\", \"\" );\n    }"
  },
  {
    "id": 59,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 42,
    "human_patch": "https://github.com/neo4j/neo4j/commit/46de5d01ae2741ffe04c36270fc62c6d490f65c9",
    "cve_id": "CVE-2018-18389",
    "cwe_id": "CWE-287",
    "filename": "enterprise/security/src/test/java/org/neo4j/server/security/enterprise/auth/integration/bolt/LdapAuthIT.java",
    "is_vulnerable": 0,
    "class_name": "LdapAuthIT",
    "subclass_name": null,
    "function_name": "shouldBeAbleToLoginAndAuthorizePublisherWithUserLdapContextOnEC2() throws Throwable",
    "function_body": "{\n        restartNeo4jServerWithOverriddenSettings( activeDirectoryOnEc2NotUsingSystemAccountSettings );\n\n        assertAuth( \"tank\", \"abc123ABC123\" );\n        assertWriteSucceeds();\n    }"
  },
  {
    "id": 59,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 43,
    "human_patch": "https://github.com/neo4j/neo4j/commit/46de5d01ae2741ffe04c36270fc62c6d490f65c9",
    "cve_id": "CVE-2018-18389",
    "cwe_id": "CWE-287",
    "filename": "enterprise/security/src/test/java/org/neo4j/server/security/enterprise/auth/integration/bolt/LdapAuthIT.java",
    "is_vulnerable": 0,
    "class_name": "LdapAuthIT",
    "subclass_name": null,
    "function_name": "shouldBeAbleToLoginAndAuthorizePublisherOnEC2() throws Throwable",
    "function_body": "{\n        restartNeo4jServerWithOverriddenSettings( activeDirectoryOnEc2UsingSystemAccountSettings );\n\n        assertAuth( \"tank\", \"abc123ABC123\" );\n        assertWriteSucceeds();\n    }"
  },
  {
    "id": 59,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 44,
    "human_patch": "https://github.com/neo4j/neo4j/commit/46de5d01ae2741ffe04c36270fc62c6d490f65c9",
    "cve_id": "CVE-2018-18389",
    "cwe_id": "CWE-287",
    "filename": "enterprise/security/src/test/java/org/neo4j/server/security/enterprise/auth/integration/bolt/LdapAuthIT.java",
    "is_vulnerable": 0,
    "class_name": "LdapAuthIT",
    "subclass_name": null,
    "function_name": "shouldBeAbleToLoginAndAuthorizeNoPermissionUserWithUserLdapContextOnEC2() throws Throwable",
    "function_body": "{\n        restartNeo4jServerWithOverriddenSettings( activeDirectoryOnEc2NotUsingSystemAccountSettings );\n\n        assertAuth( \"smith\", \"abc123ABC123\" );\n        assertReadFails( \"smith\", \"\" );\n    }"
  },
  {
    "id": 59,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 45,
    "human_patch": "https://github.com/neo4j/neo4j/commit/46de5d01ae2741ffe04c36270fc62c6d490f65c9",
    "cve_id": "CVE-2018-18389",
    "cwe_id": "CWE-287",
    "filename": "enterprise/security/src/test/java/org/neo4j/server/security/enterprise/auth/integration/bolt/LdapAuthIT.java",
    "is_vulnerable": 0,
    "class_name": "LdapAuthIT",
    "subclass_name": null,
    "function_name": "shouldBeAbleToLoginAndAuthorizeNoPermissionUserOnEC2() throws Throwable",
    "function_body": "{\n        restartNeo4jServerWithOverriddenSettings( activeDirectoryOnEc2UsingSystemAccountSettings );\n\n        assertAuth( \"smith\", \"abc123ABC123\" );\n        assertReadFails( \"smith\", \"\" );\n    }"
  },
  {
    "id": 59,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 46,
    "human_patch": "https://github.com/neo4j/neo4j/commit/46de5d01ae2741ffe04c36270fc62c6d490f65c9",
    "cve_id": "CVE-2018-18389",
    "cwe_id": "CWE-287",
    "filename": "enterprise/security/src/test/java/org/neo4j/server/security/enterprise/auth/integration/bolt/LdapAuthIT.java",
    "is_vulnerable": 0,
    "class_name": "LdapAuthIT",
    "subclass_name": null,
    "function_name": "shouldBeAbleToLoginAndAuthorizeReaderUsingLdapsOnEC2() throws Throwable",
    "function_body": "{\n        restartNeo4jServerWithOverriddenSettings( activeDirectoryOnEc2UsingSystemAccountSettings\n                .andThen( settings -> settings.put( SecuritySettings.ldap_server, \"ldaps://henrik.neohq.net:636\" ) ) );\n\n        assertAuth( \"neo\", \"abc123ABC123\" );\n        assertReadSucceeds();\n        assertWriteFails( \"neo\", \"\" );\n    }"
  },
  {
    "id": 59,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 47,
    "human_patch": "https://github.com/neo4j/neo4j/commit/46de5d01ae2741ffe04c36270fc62c6d490f65c9",
    "cve_id": "CVE-2018-18389",
    "cwe_id": "CWE-287",
    "filename": "enterprise/security/src/test/java/org/neo4j/server/security/enterprise/auth/integration/bolt/LdapAuthIT.java",
    "is_vulnerable": 0,
    "class_name": "LdapAuthIT",
    "subclass_name": null,
    "function_name": "shouldBeAbleToLoginAndAuthorizeReaderWithUserLdapContextUsingLDAPSOnEC2() throws Throwable",
    "function_body": "{\n        restartNeo4jServerWithOverriddenSettings( activeDirectoryOnEc2NotUsingSystemAccountSettings\n                .andThen( settings -> settings.put( SecuritySettings.ldap_server, \"ldaps://henrik.neohq.net:636\" ) ) );\n\n        assertAuth( \"neo\", \"abc123ABC123\" );\n        assertReadSucceeds();\n        assertWriteFails( \"neo\", \"\" );\n    }"
  },
  {
    "id": 59,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 48,
    "human_patch": "https://github.com/neo4j/neo4j/commit/46de5d01ae2741ffe04c36270fc62c6d490f65c9",
    "cve_id": "CVE-2018-18389",
    "cwe_id": "CWE-287",
    "filename": "enterprise/security/src/test/java/org/neo4j/server/security/enterprise/auth/integration/bolt/LdapAuthIT.java",
    "is_vulnerable": 0,
    "class_name": "LdapAuthIT",
    "subclass_name": null,
    "function_name": "shouldBeAbleToLoginAndAuthorizeReaderUsingStartTlsOnEC2() throws Throwable",
    "function_body": "{\n        restartNeo4jServerWithOverriddenSettings( activeDirectoryOnEc2UsingSystemAccountSettings\n                .andThen( settings -> settings.put( SecuritySettings.ldap_use_starttls, \"true\" ) ) );\n\n        assertAuth( \"neo\", \"abc123ABC123\" );\n        assertReadSucceeds();\n        assertWriteFails( \"neo\", \"\" );\n    }"
  },
  {
    "id": 59,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 49,
    "human_patch": "https://github.com/neo4j/neo4j/commit/46de5d01ae2741ffe04c36270fc62c6d490f65c9",
    "cve_id": "CVE-2018-18389",
    "cwe_id": "CWE-287",
    "filename": "enterprise/security/src/test/java/org/neo4j/server/security/enterprise/auth/integration/bolt/LdapAuthIT.java",
    "is_vulnerable": 0,
    "class_name": "LdapAuthIT",
    "subclass_name": null,
    "function_name": "shouldBeAbleToLoginAndAuthorizeReaderWithUserLdapContextUsingStartTlsOnEC2() throws Throwable",
    "function_body": "{\n        restartNeo4jServerWithOverriddenSettings( activeDirectoryOnEc2NotUsingSystemAccountSettings\n                .andThen( settings -> settings.put( SecuritySettings.ldap_use_starttls, \"true\" ) ) );\n\n        assertAuth( \"neo\", \"abc123ABC123\" );\n        assertReadSucceeds();\n        assertWriteFails( \"neo\", \"\" );\n    }"
  },
  {
    "id": 59,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 50,
    "human_patch": "https://github.com/neo4j/neo4j/commit/46de5d01ae2741ffe04c36270fc62c6d490f65c9",
    "cve_id": "CVE-2018-18389",
    "cwe_id": "CWE-287",
    "filename": "enterprise/security/src/test/java/org/neo4j/server/security/enterprise/auth/integration/bolt/LdapAuthIT.java",
    "is_vulnerable": 0,
    "class_name": "LdapAuthIT",
    "subclass_name": null,
    "function_name": "shouldBeAbleToLoginWithLdapWhenSelectingRealmFromClient() throws Throwable",
    "function_body": "{\n        restartNeo4jServerWithOverriddenSettings( settings ->\n        {\n            settings.put( SecuritySettings.auth_providers,\n                    SecuritySettings.NATIVE_REALM_NAME + \",\" + SecuritySettings.LDAP_REALM_NAME );\n            settings.put( SecuritySettings.native_authentication_enabled, \"true\" );\n            settings.put( SecuritySettings.native_authorization_enabled, \"true\" );\n            settings.put( SecuritySettings.ldap_authentication_enabled, \"true\" );\n            settings.put( SecuritySettings.ldap_authorization_enabled, \"true\" );\n            settings.put( SecuritySettings.ldap_authorization_use_system_account, \"true\" );\n        } );\n\n        \n        \n        testCreateReaderUser( \"tank\" );\n\n        \n        \n        \n        reconnect();\n        assertAuth( \"tank\", createdUserPassword, \"native\" );\n        assertRoles( PredefinedRoles.READER, PredefinedRoles.PUBLISHER );\n\n        \n        reconnect();\n        assertAuth( \"tank\", \"abc123\", \"ldap\" );\n        assertRoles( PredefinedRoles.READER, PredefinedRoles.PUBLISHER );\n    }"
  },
  {
    "id": 59,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 51,
    "human_patch": "https://github.com/neo4j/neo4j/commit/46de5d01ae2741ffe04c36270fc62c6d490f65c9",
    "cve_id": "CVE-2018-18389",
    "cwe_id": "CWE-287",
    "filename": "enterprise/security/src/test/java/org/neo4j/server/security/enterprise/auth/integration/bolt/LdapAuthIT.java",
    "is_vulnerable": 0,
    "class_name": "LdapAuthIT",
    "subclass_name": null,
    "function_name": "shouldBeAbleToAuthorizeUsingNativeWithLdapEnabled() throws Throwable",
    "function_body": "{\n        restartNeo4jServerWithOverriddenSettings( settings ->\n        {\n            settings.put( SecuritySettings.auth_providers,\n                    SecuritySettings.LDAP_REALM_NAME + \",\" + SecuritySettings.NATIVE_REALM_NAME );\n            settings.put( SecuritySettings.native_authentication_enabled, \"true\" );\n            settings.put( SecuritySettings.native_authorization_enabled, \"true\" );\n            settings.put( SecuritySettings.ldap_authentication_enabled, \"true\" );\n            settings.put( SecuritySettings.ldap_authorization_enabled, \"true\" );\n            settings.put( SecuritySettings.ldap_authorization_use_system_account, \"false\" );\n        } );\n\n        \n        \n        testCreateReaderUser( \"simon\" );\n\n        \n        reconnect();\n        assertAuth( \"simon\", createdUserPassword, \"native\" );\n\n        \n        assertReadSucceeds();\n    }"
  },
  {
    "id": 59,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 52,
    "human_patch": "https://github.com/neo4j/neo4j/commit/46de5d01ae2741ffe04c36270fc62c6d490f65c9",
    "cve_id": "CVE-2018-18389",
    "cwe_id": "CWE-287",
    "filename": "enterprise/security/src/test/java/org/neo4j/server/security/enterprise/auth/integration/bolt/LdapAuthIT.java",
    "is_vulnerable": 0,
    "class_name": "LdapAuthIT",
    "subclass_name": null,
    "function_name": "shouldBeAbleToAuthorizeUsingNativeWhenLdapFails() throws Throwable",
    "function_body": "{\n        restartNeo4jServerWithOverriddenSettings( settings ->\n        {\n            settings.put( SecuritySettings.auth_providers,\n                    SecuritySettings.LDAP_REALM_NAME + \",\" + SecuritySettings.NATIVE_REALM_NAME );\n            settings.put( SecuritySettings.ldap_server, \"ldap://\" + REFUSED_IP );\n            settings.put( SecuritySettings.native_authentication_enabled, \"true\" );\n            settings.put( SecuritySettings.native_authorization_enabled, \"true\" );\n            settings.put( SecuritySettings.ldap_authentication_enabled, \"true\" );\n            settings.put( SecuritySettings.ldap_authorization_enabled, \"true\" );\n            settings.put( SecuritySettings.ldap_authorization_use_system_account, \"true\" );\n        } );\n\n        \n        \n        createNativeUser( \"simon\", createdUserPassword, PredefinedRoles.READER );\n\n        \n        assertAuth( \"simon\", createdUserPassword );\n\n        \n        assertReadSucceeds();\n    }"
  },
  {
    "id": 59,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 53,
    "human_patch": "https://github.com/neo4j/neo4j/commit/46de5d01ae2741ffe04c36270fc62c6d490f65c9",
    "cve_id": "CVE-2018-18389",
    "cwe_id": "CWE-287",
    "filename": "enterprise/security/src/test/java/org/neo4j/server/security/enterprise/auth/integration/bolt/LdapAuthIT.java",
    "is_vulnerable": 0,
    "class_name": "LdapAuthIT",
    "subclass_name": null,
    "function_name": "shouldNotLogErrorsFromLdapRealmWhenLoginSuccessfulInNativeRealmAndNativeFirst() throws Throwable",
    "function_body": "{\n        restartNeo4jServerWithOverriddenSettings( settings ->\n        {\n            settings.put( SecuritySettings.auth_providers,\n                    SecuritySettings.NATIVE_REALM_NAME + \",\" + SecuritySettings.LDAP_REALM_NAME );\n            settings.put( SecuritySettings.native_authentication_enabled, \"true\" );\n            settings.put( SecuritySettings.native_authorization_enabled, \"true\" );\n            settings.put( SecuritySettings.ldap_authentication_enabled, \"true\" );\n            settings.put( SecuritySettings.ldap_authorization_enabled, \"true\" );\n            settings.put( SecuritySettings.ldap_authorization_use_system_account, \"true\" );\n        } );\n\n        \n        \n        testCreateReaderUser( \"foo\" );\n\n        \n        \n        reconnect();\n        assertAuth( \"foo\", createdUserPassword );\n\n        \n        assertSecurityLogDoesNotContain( \"ERROR\" );\n    }"
  },
  {
    "id": 59,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 54,
    "human_patch": "https://github.com/neo4j/neo4j/commit/46de5d01ae2741ffe04c36270fc62c6d490f65c9",
    "cve_id": "CVE-2018-18389",
    "cwe_id": "CWE-287",
    "filename": "enterprise/security/src/test/java/org/neo4j/server/security/enterprise/auth/integration/bolt/LdapAuthIT.java",
    "is_vulnerable": 0,
    "class_name": "LdapAuthIT",
    "subclass_name": null,
    "function_name": "shouldNotLogErrorsFromLdapRealmWhenLoginSuccessfulInNativeRealmAndLdapFirst() throws Throwable",
    "function_body": "{\n        restartNeo4jServerWithOverriddenSettings( settings ->\n        {\n            settings.put( SecuritySettings.auth_providers,\n                    SecuritySettings.LDAP_REALM_NAME + \",\" + SecuritySettings.NATIVE_REALM_NAME );\n            settings.put( SecuritySettings.native_authentication_enabled, \"true\" );\n            settings.put( SecuritySettings.native_authorization_enabled, \"true\" );\n            settings.put( SecuritySettings.ldap_authentication_enabled, \"true\" );\n            settings.put( SecuritySettings.ldap_authorization_enabled, \"true\" );\n            settings.put( SecuritySettings.ldap_authorization_use_system_account, \"true\" );\n        } );\n\n        \n        \n        testCreateReaderUser( \"foo\" );\n\n        \n        \n        reconnect();\n        assertAuth( \"foo\", createdUserPassword );\n\n        \n        assertSecurityLogDoesNotContain( \"ERROR\" );\n    }"
  },
  {
    "id": 59,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 55,
    "human_patch": "https://github.com/neo4j/neo4j/commit/46de5d01ae2741ffe04c36270fc62c6d490f65c9",
    "cve_id": "CVE-2018-18389",
    "cwe_id": "CWE-287",
    "filename": "enterprise/security/src/test/java/org/neo4j/server/security/enterprise/auth/integration/bolt/LdapAuthIT.java",
    "is_vulnerable": 0,
    "class_name": "LdapAuthIT",
    "subclass_name": null,
    "function_name": "shouldLogInvalidCredentialErrorFromLdapRealm() throws Throwable",
    "function_body": "{\n        \n        assertAuthFail( \"neo\", \"wrong-password\" );\n\n        \n        assertSecurityLogContains( LDAP_ERROR_MESSAGE_INVALID_CREDENTIALS );\n    }"
  },
  {
    "id": 59,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 56,
    "human_patch": "https://github.com/neo4j/neo4j/commit/46de5d01ae2741ffe04c36270fc62c6d490f65c9",
    "cve_id": "CVE-2018-18389",
    "cwe_id": "CWE-287",
    "filename": "enterprise/security/src/test/java/org/neo4j/server/security/enterprise/auth/integration/bolt/LdapAuthIT.java",
    "is_vulnerable": 0,
    "class_name": "LdapAuthIT",
    "subclass_name": null,
    "function_name": "shouldLogInvalidCredentialErrorFromLdapRealmWithMultipleRealmsFailingAndNativeFirst() throws Throwable",
    "function_body": "{\n        restartNeo4jServerWithOverriddenSettings( settings ->\n        {\n            settings.put( SecuritySettings.auth_providers,\n                    SecuritySettings.NATIVE_REALM_NAME + \", \" + SecuritySettings.LDAP_REALM_NAME );\n            settings.put( SecuritySettings.native_authentication_enabled, \"true\" );\n            settings.put( SecuritySettings.native_authorization_enabled, \"true\" );\n            settings.put( SecuritySettings.ldap_authentication_enabled, \"true\" );\n            settings.put( SecuritySettings.ldap_authorization_enabled, \"true\" );\n            settings.put( SecuritySettings.ldap_authorization_use_system_account, \"true\" );\n        } );\n\n        \n        \n        testCreateReaderUser( \"foo\" );\n\n        \n        \n        reconnect();\n        assertAuthFail( \"foo\", \"wrong-password\" );\n\n        \n        assertSecurityLogContains( LDAP_ERROR_MESSAGE_INVALID_CREDENTIALS );\n    }"
  },
  {
    "id": 59,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 57,
    "human_patch": "https://github.com/neo4j/neo4j/commit/46de5d01ae2741ffe04c36270fc62c6d490f65c9",
    "cve_id": "CVE-2018-18389",
    "cwe_id": "CWE-287",
    "filename": "enterprise/security/src/test/java/org/neo4j/server/security/enterprise/auth/integration/bolt/LdapAuthIT.java",
    "is_vulnerable": 0,
    "class_name": "LdapAuthIT",
    "subclass_name": null,
    "function_name": "shouldLogInvalidCredentialErrorFromLdapRealmWithMultipleRealmsFailingAndLdapFirst() throws Throwable",
    "function_body": "{\n        restartNeo4jServerWithOverriddenSettings( settings ->\n        {\n            settings.put( SecuritySettings.auth_providers,\n                    SecuritySettings.LDAP_REALM_NAME + \", \" + SecuritySettings.NATIVE_REALM_NAME );\n            settings.put( SecuritySettings.native_authentication_enabled, \"true\" );\n            settings.put( SecuritySettings.native_authorization_enabled, \"true\" );\n            settings.put( SecuritySettings.ldap_authentication_enabled, \"true\" );\n            settings.put( SecuritySettings.ldap_authorization_enabled, \"true\" );\n            settings.put( SecuritySettings.ldap_authorization_use_system_account, \"true\" );\n        } );\n\n        \n        \n        testCreateReaderUser( \"foo\" );\n\n        \n        \n        reconnect();\n        assertAuthFail( \"foo\", \"wrong-password\" );\n\n        \n        assertSecurityLogContains( LDAP_ERROR_MESSAGE_INVALID_CREDENTIALS );\n    }"
  },
  {
    "id": 59,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 58,
    "human_patch": "https://github.com/neo4j/neo4j/commit/46de5d01ae2741ffe04c36270fc62c6d490f65c9",
    "cve_id": "CVE-2018-18389",
    "cwe_id": "CWE-287",
    "filename": "enterprise/security/src/test/java/org/neo4j/server/security/enterprise/auth/integration/bolt/LdapAuthIT.java",
    "is_vulnerable": 0,
    "class_name": "LdapAuthIT",
    "subclass_name": null,
    "function_name": "shouldLogConnectionTimeoutFromLdapRealm() throws Throwable",
    "function_body": "{\n        \n        restartNeo4jServerWithOverriddenSettings( ldapOnlyAuthSettings.andThen(\n                settings ->\n                {\n                    settings.put( SecuritySettings.ldap_server, \"ldap://\" + NON_ROUTABLE_IP );\n                    settings.put( SecuritySettings.ldap_connection_timeout, \"1s\" );\n                } ) );\n\n        assertConnectionTimeout( authToken( \"neo\", \"abc123\", null ),\n                LDAP_CONNECTION_TIMEOUT_CLIENT_MESSAGE );\n\n        assertSecurityLogContains( \"ERROR\" );\n        assertSecurityLogContains( NON_ROUTABLE_IP );\n    }"
  },
  {
    "id": 59,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 59,
    "human_patch": "https://github.com/neo4j/neo4j/commit/46de5d01ae2741ffe04c36270fc62c6d490f65c9",
    "cve_id": "CVE-2018-18389",
    "cwe_id": "CWE-287",
    "filename": "enterprise/security/src/test/java/org/neo4j/server/security/enterprise/auth/integration/bolt/LdapAuthIT.java",
    "is_vulnerable": 0,
    "class_name": "LdapAuthIT",
    "subclass_name": null,
    "function_name": "shouldLogConnectionTimeoutFromLdapRealmWithMultipleRealms() throws Throwable",
    "function_body": "{\n        restartNeo4jServerWithOverriddenSettings( settings ->\n        {\n            settings.put( SecuritySettings.auth_providers,\n                    SecuritySettings.NATIVE_REALM_NAME + \", \" + SecuritySettings.LDAP_REALM_NAME );\n            settings.put( SecuritySettings.native_authentication_enabled, \"true\" );\n            settings.put( SecuritySettings.native_authorization_enabled, \"true\" );\n            settings.put( SecuritySettings.ldap_authentication_enabled, \"true\" );\n            settings.put( SecuritySettings.ldap_authorization_enabled, \"true\" );\n            settings.put( SecuritySettings.ldap_authorization_use_system_account, \"true\" );\n            settings.put( SecuritySettings.ldap_server, \"ldap://\" + NON_ROUTABLE_IP );\n            settings.put( SecuritySettings.ldap_connection_timeout, \"1s\" );\n        } );\n\n        assertAuthFail( \"neo\", \"abc123\" );\n\n        assertSecurityLogContains( \"ERROR\" );\n        assertSecurityLogContains( \"LDAP connection timed out\" );\n        assertSecurityLogContains( NON_ROUTABLE_IP );\n    }"
  },
  {
    "id": 59,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 60,
    "human_patch": "https://github.com/neo4j/neo4j/commit/46de5d01ae2741ffe04c36270fc62c6d490f65c9",
    "cve_id": "CVE-2018-18389",
    "cwe_id": "CWE-287",
    "filename": "enterprise/security/src/test/java/org/neo4j/server/security/enterprise/auth/integration/bolt/LdapAuthIT.java",
    "is_vulnerable": 0,
    "class_name": "LdapAuthIT",
    "subclass_name": null,
    "function_name": "shouldLogConnectionRefusedFromLdapRealm() throws Throwable",
    "function_body": "{\n        \n        restartNeo4jServerWithOverriddenSettings( ldapOnlyAuthSettings.andThen(\n                settings -> settings.put( SecuritySettings.ldap_server, \"ldap://\" + REFUSED_IP ) ) );\n\n        assertConnectionRefused( authToken( \"neo\", \"abc123\", null ),\n                LDAP_CONNECTION_REFUSED_CLIENT_MESSAGE );\n\n        assertSecurityLogContains( \"ERROR\" );\n        assertSecurityLogContains( \"auth server connection refused\" );\n        assertSecurityLogContains( REFUSED_IP );\n    }"
  },
  {
    "id": 59,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 61,
    "human_patch": "https://github.com/neo4j/neo4j/commit/46de5d01ae2741ffe04c36270fc62c6d490f65c9",
    "cve_id": "CVE-2018-18389",
    "cwe_id": "CWE-287",
    "filename": "enterprise/security/src/test/java/org/neo4j/server/security/enterprise/auth/integration/bolt/LdapAuthIT.java",
    "is_vulnerable": 0,
    "class_name": "LdapAuthIT",
    "subclass_name": null,
    "function_name": "shouldLogConnectionRefusedFromLdapRealmWithMultipleRealms() throws Throwable",
    "function_body": "{\n        restartNeo4jServerWithOverriddenSettings( settings ->\n        {\n            settings.put( SecuritySettings.auth_providers,\n                    SecuritySettings.NATIVE_REALM_NAME + \", \" + SecuritySettings.LDAP_REALM_NAME );\n            settings.put( SecuritySettings.native_authentication_enabled, \"true\" );\n            settings.put( SecuritySettings.native_authorization_enabled, \"true\" );\n            settings.put( SecuritySettings.ldap_authentication_enabled, \"true\" );\n            settings.put( SecuritySettings.ldap_authorization_enabled, \"true\" );\n            settings.put( SecuritySettings.ldap_authorization_use_system_account, \"true\" );\n            settings.put( SecuritySettings.ldap_server, \"ldap://\" + REFUSED_IP );\n        } );\n\n        assertAuthFail( \"neo\", \"abc123\" );\n\n        assertSecurityLogContains( \"ERROR\" );\n        assertSecurityLogContains( \"LDAP connection refused\" );\n        assertSecurityLogContains( REFUSED_IP );\n    }"
  },
  {
    "id": 59,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 62,
    "human_patch": "https://github.com/neo4j/neo4j/commit/46de5d01ae2741ffe04c36270fc62c6d490f65c9",
    "cve_id": "CVE-2018-18389",
    "cwe_id": "CWE-287",
    "filename": "enterprise/security/src/test/java/org/neo4j/server/security/enterprise/auth/integration/bolt/LdapAuthIT.java",
    "is_vulnerable": 0,
    "class_name": "LdapAuthIT",
    "subclass_name": null,
    "function_name": "shouldClearAuthenticationCache() throws Throwable",
    "function_body": "{\n        getLdapServer().setConfidentialityRequired( true );\n\n        try ( EmbeddedTestCertificates ignore = new EmbeddedTestCertificates() )\n        {\n            \n            restartNeo4jServerWithOverriddenSettings( ldapOnlyAuthSettings\n                    .andThen( settings -> settings.put( SecuritySettings.ldap_server, \"ldaps://localhost:10636\" ) ) );\n\n            \n            assertAuth( \"tank\", \"abc123\", \"ldap\" );\n            changeLDAPPassword( \"tank\", \"abc123\", \"123abc\" );\n\n            \n            reconnect();\n\n            \n            assertAuthFail( \"tank\", \"123abc\" );\n            reconnect();\n            assertAuth( \"tank\", \"abc123\", \"ldap\" );\n\n            \n            reconnect();\n            testClearAuthCache();\n            reconnect();\n\n            \n            assertAuthFail( \"tank\", \"abc123\" );\n            reconnect();\n            assertAuth( \"tank\", \"123abc\", \"ldap\" );\n        }\n    }"
  },
  {
    "id": 59,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 63,
    "human_patch": "https://github.com/neo4j/neo4j/commit/46de5d01ae2741ffe04c36270fc62c6d490f65c9",
    "cve_id": "CVE-2018-18389",
    "cwe_id": "CWE-287",
    "filename": "enterprise/security/src/test/java/org/neo4j/server/security/enterprise/auth/integration/bolt/LdapAuthIT.java",
    "is_vulnerable": 0,
    "class_name": "LdapAuthIT",
    "subclass_name": null,
    "function_name": "shouldClearAuthorizationCache() throws Throwable",
    "function_body": "{\n        getLdapServer().setConfidentialityRequired( true );\n\n        try ( EmbeddedTestCertificates ignore = new EmbeddedTestCertificates() )\n        {\n            \n            restartNeo4jServerWithOverriddenSettings( ldapOnlyAuthSettings\n                    .andThen( settings -> settings.put( SecuritySettings.ldap_server, \"ldaps://localhost:10636\" ) ) );\n\n            \n            assertAuth( \"tank\", \"abc123\", \"ldap\" );\n            assertReadSucceeds();\n            assertWriteSucceeds();\n\n            \n            changeLDAPGroup( \"tank\", \"abc123\", \"reader\" );\n\n            \n            reconnect();\n            assertAuth( \"tank\", \"abc123\", \"ldap\" );\n\n            \n            assertReadSucceeds();\n            assertWriteSucceeds();\n\n            \n            reconnect();\n            testClearAuthCache();\n            reconnect();\n\n            \n            assertAuth( \"tank\", \"abc123\", \"ldap\" );\n            assertReadSucceeds();\n            assertWriteFails( \"tank\", \"reader\" );\n        }\n    }"
  },
  {
    "id": 59,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 64,
    "human_patch": "https://github.com/neo4j/neo4j/commit/46de5d01ae2741ffe04c36270fc62c6d490f65c9",
    "cve_id": "CVE-2018-18389",
    "cwe_id": "CWE-287",
    "filename": "enterprise/security/src/test/java/org/neo4j/server/security/enterprise/auth/integration/bolt/LdapAuthIT.java",
    "is_vulnerable": 0,
    "class_name": "LdapAuthIT",
    "subclass_name": null,
    "function_name": "clearAuthCacheFromDifferentConnection() throws Exception",
    "function_body": "{\n        TransportConnection adminClient = cf.newInstance();\n\n        \n        Map<String,Object> authToken = authToken( \"neo4j\", \"abc123\", null );\n        adminClient.connect( address )\n                .send( util.acceptedVersions( 1, 0, 0, 0 ) )\n                .send( util.chunk(\n                        init( \"TestClient/1.1\", authToken ) ) );\n        assertThat( adminClient, eventuallyReceives( new byte[]{0, 0, 0, 1} ) );\n        assertThat( adminClient, util.eventuallyReceives( msgSuccess() ) );\n\n        \n        adminClient.send( util.chunk( run( \"CALL dbms.security.clearAuthCache()\" ), pullAll() ) );\n        assertThat( adminClient, util.eventuallyReceives( msgSuccess(), msgSuccess() ) );\n    }"
  },
  {
    "id": 59,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 65,
    "human_patch": "https://github.com/neo4j/neo4j/commit/46de5d01ae2741ffe04c36270fc62c6d490f65c9",
    "cve_id": "CVE-2018-18389",
    "cwe_id": "CWE-287",
    "filename": "enterprise/security/src/test/java/org/neo4j/server/security/enterprise/auth/integration/bolt/LdapAuthIT.java",
    "is_vulnerable": 0,
    "class_name": "LdapAuthIT",
    "subclass_name": null,
    "function_name": "assertLdapAuthorizationTimeout() throws IOException",
    "function_body": "{\n        \n        client.send( util.chunk( run( \"MATCH (n) RETURN n\" ), pullAll() ) );\n\n        \n        assertThat( client, util.eventuallyReceives(\n                msgFailure( Status.Security.AuthProviderTimeout, LDAP_READ_TIMEOUT_CLIENT_MESSAGE ) ) );\n\n        assertThat( client, eventuallyDisconnects() );\n    }"
  },
  {
    "id": 59,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 66,
    "human_patch": "https://github.com/neo4j/neo4j/commit/46de5d01ae2741ffe04c36270fc62c6d490f65c9",
    "cve_id": "CVE-2018-18389",
    "cwe_id": "CWE-287",
    "filename": "enterprise/security/src/test/java/org/neo4j/server/security/enterprise/auth/integration/bolt/LdapAuthIT.java",
    "is_vulnerable": 0,
    "class_name": "LdapAuthIT",
    "subclass_name": null,
    "function_name": "assertLdapAuthorizationFailed() throws IOException",
    "function_body": "{\n        \n        client.send( util.chunk( run( \"MATCH (n) RETURN n\" ), pullAll() ) );\n\n        \n        assertThat( client, util.eventuallyReceives(\n                msgFailure( Status.Security.AuthProviderFailed, LDAP_AUTHORIZATION_FAILURE_CLIENT_MESSAGE ) ) );\n\n        assertThat( client, eventuallyDisconnects() );\n    }"
  },
  {
    "id": 59,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 67,
    "human_patch": "https://github.com/neo4j/neo4j/commit/46de5d01ae2741ffe04c36270fc62c6d490f65c9",
    "cve_id": "CVE-2018-18389",
    "cwe_id": "CWE-287",
    "filename": "enterprise/security/src/test/java/org/neo4j/server/security/enterprise/auth/integration/bolt/LdapAuthIT.java",
    "is_vulnerable": 0,
    "class_name": "LdapAuthIT",
    "subclass_name": null,
    "function_name": "assertConnectionTimeout( Map<String,Object> authToken, String message ) throws Exception",
    "function_body": "{\n        client.connect( address )\n                .send( util.acceptedVersions( 1, 0, 0, 0 ) )\n                .send( util.chunk(\n                        init( \"TestClient/1.1\", authToken ) ) );\n\n        assertThat( client, eventuallyReceives( new byte[]{0, 0, 0, 1} ) );\n        assertThat( client, util.eventuallyReceives( msgFailure( Status.Security.AuthProviderTimeout, message ) ) );\n\n        assertThat( client, eventuallyDisconnects() );\n    }"
  },
  {
    "id": 59,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 68,
    "human_patch": "https://github.com/neo4j/neo4j/commit/46de5d01ae2741ffe04c36270fc62c6d490f65c9",
    "cve_id": "CVE-2018-18389",
    "cwe_id": "CWE-287",
    "filename": "enterprise/security/src/test/java/org/neo4j/server/security/enterprise/auth/integration/bolt/LdapAuthIT.java",
    "is_vulnerable": 0,
    "class_name": "LdapAuthIT",
    "subclass_name": null,
    "function_name": "assertConnectionRefused( Map<String,Object> authToken, String message ) throws Exception",
    "function_body": "{\n        client.connect( address )\n                .send( util.acceptedVersions( 1, 0, 0, 0 ) )\n                .send( util.chunk(\n                        init( \"TestClient/1.1\", authToken ) ) );\n\n        assertThat( client, eventuallyReceives( new byte[]{0, 0, 0, 1} ) );\n        assertThat( client, util.eventuallyReceives( msgFailure( Status.Security.AuthProviderFailed, message ) ) );\n\n        assertThat( client, eventuallyDisconnects() );\n    }"
  },
  {
    "id": 59,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 69,
    "human_patch": "https://github.com/neo4j/neo4j/commit/46de5d01ae2741ffe04c36270fc62c6d490f65c9",
    "cve_id": "CVE-2018-18389",
    "cwe_id": "CWE-287",
    "filename": "enterprise/security/src/test/java/org/neo4j/server/security/enterprise/auth/integration/bolt/LdapAuthIT.java",
    "is_vulnerable": 0,
    "class_name": "LdapAuthIT",
    "subclass_name": null,
    "function_name": "testClearAuthCache() throws Exception",
    "function_body": "{\n        assertAuth( \"neo4j\", \"abc123\" );\n\n        client.send( util.chunk( run( \"CALL dbms.security.clearAuthCache()\" ), pullAll() ) );\n\n        assertThat( client, util.eventuallyReceives( msgSuccess(), msgSuccess() ) );\n    }"
  },
  {
    "id": 59,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 70,
    "human_patch": "https://github.com/neo4j/neo4j/commit/46de5d01ae2741ffe04c36270fc62c6d490f65c9",
    "cve_id": "CVE-2018-18389",
    "cwe_id": "CWE-287",
    "filename": "enterprise/security/src/test/java/org/neo4j/server/security/enterprise/auth/integration/bolt/LdapAuthIT.java",
    "is_vulnerable": 0,
    "class_name": "LdapAuthIT",
    "subclass_name": null,
    "function_name": "restartServerWithoutSystemAccount()",
    "function_body": "{\n        restartNeo4jServerWithOverriddenSettings(\n                settings -> settings.put( SecuritySettings.ldap_authorization_use_system_account, \"false\" ) );\n    }"
  },
  {
    "id": 59,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 71,
    "human_patch": "https://github.com/neo4j/neo4j/commit/46de5d01ae2741ffe04c36270fc62c6d490f65c9",
    "cve_id": "CVE-2018-18389",
    "cwe_id": "CWE-287",
    "filename": "enterprise/security/src/test/java/org/neo4j/server/security/enterprise/auth/integration/bolt/LdapAuthIT.java",
    "is_vulnerable": 0,
    "class_name": "LdapAuthIT",
    "subclass_name": null,
    "function_name": "assertSecurityLogContains( String message ) throws IOException",
    "function_body": "{\n        FileSystemAbstraction fileSystem = server.getFileSystem();\n        File workingDirectory = server.getWorkingDirectory();\n        File logFile = new File( workingDirectory, \"storeDir/logs/security.log\" );\n\n        Reader reader = fileSystem.openAsReader( logFile, Charset.forName( \"UTF-8\" ) );\n        BufferedReader bufferedReader = new BufferedReader( reader );\n        String line;\n        boolean foundError = false;\n\n        while ( (line = bufferedReader.readLine()) != null )\n        {\n            if ( line.contains( message ) )\n            {\n                foundError = true;\n            }\n        }\n        bufferedReader.close();\n        reader.close();\n\n        assertThat( \"Security log should contain message '\" + message + \"'\", foundError );\n    }"
  },
  {
    "id": 59,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 72,
    "human_patch": "https://github.com/neo4j/neo4j/commit/46de5d01ae2741ffe04c36270fc62c6d490f65c9",
    "cve_id": "CVE-2018-18389",
    "cwe_id": "CWE-287",
    "filename": "enterprise/security/src/test/java/org/neo4j/server/security/enterprise/auth/integration/bolt/LdapAuthIT.java",
    "is_vulnerable": 0,
    "class_name": "LdapAuthIT",
    "subclass_name": null,
    "function_name": "assertSecurityLogDoesNotContain( String message ) throws IOException",
    "function_body": "{\n        FileSystemAbstraction fileSystem = server.getFileSystem();\n        File workingDirectory = server.getWorkingDirectory();\n        File logFile = new File( workingDirectory, \"storeDir/logs/security.log\" );\n\n        Reader reader = fileSystem.openAsReader( logFile, Charset.forName( \"UTF-8\" ) );\n        BufferedReader bufferedReader = new BufferedReader( reader );\n        String line;\n\n        while ( (line = bufferedReader.readLine()) != null )\n        {\n            assertThat( \"Security log should not contain message '\" + message + \"'\",\n                    !line.contains( message ) );\n        }\n        bufferedReader.close();\n        reader.close();\n    }"
  },
  {
    "id": 59,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 73,
    "human_patch": "https://github.com/neo4j/neo4j/commit/46de5d01ae2741ffe04c36270fc62c6d490f65c9",
    "cve_id": "CVE-2018-18389",
    "cwe_id": "CWE-287",
    "filename": "enterprise/security/src/test/java/org/neo4j/server/security/enterprise/auth/integration/bolt/LdapAuthIT.java",
    "is_vulnerable": 0,
    "class_name": "LdapAuthIT",
    "subclass_name": null,
    "function_name": "modifyLDAPAttribute( String username, Object credentials, String attribute, Object value ) throws Throwable",
    "function_body": "{\n        String principal = String.format( \"cn=%s,ou=users,dc=example,dc=com\", username );\n        String principal1 = String.format( \"cn=%s,ou=users,dc=example,dc=com\", username );\n        JndiLdapContextFactory contextFactory = new JndiLdapContextFactory();\n        contextFactory.setUrl( \"ldaps://localhost:10636\" );\n        LdapContext ctx = contextFactory.getLdapContext( principal1, credentials );\n\n        ModificationItem[] mods = new ModificationItem[1];\n        mods[0] = new ModificationItem( DirContext.REPLACE_ATTRIBUTE, new BasicAttribute( attribute, value ) );\n\n        \n        ctx.modifyAttributes( principal, mods );\n        ctx.close();\n    }"
  },
  {
    "id": 59,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 74,
    "human_patch": "https://github.com/neo4j/neo4j/commit/46de5d01ae2741ffe04c36270fc62c6d490f65c9",
    "cve_id": "CVE-2018-18389",
    "cwe_id": "CWE-287",
    "filename": "enterprise/security/src/test/java/org/neo4j/server/security/enterprise/auth/integration/bolt/LdapAuthIT.java",
    "is_vulnerable": 0,
    "class_name": "LdapAuthIT",
    "subclass_name": null,
    "function_name": "changeLDAPPassword( String username, Object credentials, Object newCredentials ) throws Throwable",
    "function_body": "{\n        modifyLDAPAttribute( username, credentials, \"userpassword\", newCredentials );\n    }"
  },
  {
    "id": 59,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 75,
    "human_patch": "https://github.com/neo4j/neo4j/commit/46de5d01ae2741ffe04c36270fc62c6d490f65c9",
    "cve_id": "CVE-2018-18389",
    "cwe_id": "CWE-287",
    "filename": "enterprise/security/src/test/java/org/neo4j/server/security/enterprise/auth/integration/bolt/LdapAuthIT.java",
    "is_vulnerable": 0,
    "class_name": "LdapAuthIT",
    "subclass_name": null,
    "function_name": "changeLDAPGroup( String username, Object credentials, String group ) throws Throwable",
    "function_body": "{\n        String gid;\n        switch ( group )\n        {\n        case \"reader\":\n            gid = \"500\";\n            break;\n        case \"publisher\":\n            gid = \"501\";\n            break;\n        case \"architect\":\n            gid = \"502\";\n            break;\n        case \"admin\":\n            gid = \"503\";\n            break;\n        case \"none\":\n            gid = \"504\";\n            break;\n        default:\n            throw new IllegalArgumentException( \"Invalid group name '\" + group +\n                                                \"', expected one of none, reader, publisher, architect, or admin\" );\n        }\n        modifyLDAPAttribute( username, credentials, \"gidnumber\", gid );\n    }"
  },
  {
    "id": 59,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 76,
    "human_patch": "https://github.com/neo4j/neo4j/commit/46de5d01ae2741ffe04c36270fc62c6d490f65c9",
    "cve_id": "CVE-2018-18389",
    "cwe_id": "CWE-287",
    "filename": "enterprise/security/src/test/java/org/neo4j/server/security/enterprise/auth/integration/bolt/LdapAuthIT.java",
    "is_vulnerable": 0,
    "class_name": "LdapAuthIT",
    "subclass_name": null,
    "function_name": "createNativeUser( String username, String password, String... roles ) throws IOException, InvalidArgumentsException",
    "function_body": "{\n        GraphDatabaseFacade gds = (GraphDatabaseFacade) server.graphDatabaseService();\n        EnterpriseAuthAndUserManager authManager =\n                gds.getDependencyResolver().resolveDependency( EnterpriseAuthAndUserManager.class );\n\n        authManager.getUserManager( AuthSubject.AUTH_DISABLED, true )\n                .newUser( username, password, false );\n\n        for ( String role : roles )\n        {\n            authManager.getUserManager( AuthSubject.AUTH_DISABLED, true )\n                    .addRoleToUser( role, username );\n        }\n    }"
  },
  {
    "id": 59,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 77,
    "human_patch": "https://github.com/neo4j/neo4j/commit/46de5d01ae2741ffe04c36270fc62c6d490f65c9",
    "cve_id": "CVE-2018-18389",
    "cwe_id": "CWE-287",
    "filename": "enterprise/security/src/test/java/org/neo4j/server/security/enterprise/auth/integration/bolt/LdapAuthIT.java",
    "is_vulnerable": 0,
    "class_name": "LdapAuthIT",
    "subclass_name": "DirectoryServiceWaitOnSearch",
    "function_name": "getName()",
    "function_body": "{\n                    return getClass().getName();\n                }"
  },
  {
    "id": 59,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 78,
    "human_patch": "https://github.com/neo4j/neo4j/commit/46de5d01ae2741ffe04c36270fc62c6d490f65c9",
    "cve_id": "CVE-2018-18389",
    "cwe_id": "CWE-287",
    "filename": "enterprise/security/src/test/java/org/neo4j/server/security/enterprise/auth/integration/bolt/LdapAuthIT.java",
    "is_vulnerable": 0,
    "class_name": "LdapAuthIT",
    "subclass_name": "DirectoryServiceWaitOnSearch",
    "function_name": "search( SearchOperationContext searchContext ) throws LdapException",
    "function_body": "{\n                    try\n                    {\n                        Thread.sleep( waitingTimeMillis );\n                    }\n                    catch ( InterruptedException e )\n                    {\n                        Thread.interrupted();\n                    }\n                    return super.search( searchContext );\n                }"
  },
  {
    "id": 59,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 79,
    "human_patch": "https://github.com/neo4j/neo4j/commit/46de5d01ae2741ffe04c36270fc62c6d490f65c9",
    "cve_id": "CVE-2018-18389",
    "cwe_id": "CWE-287",
    "filename": "enterprise/security/src/test/java/org/neo4j/server/security/enterprise/auth/integration/bolt/LdapAuthIT.java",
    "is_vulnerable": 0,
    "class_name": "LdapAuthIT",
    "subclass_name": "DirectoryServiceWaitOnSearch",
    "function_name": "close()",
    "function_body": "{\n            getService().remove( waitOnSearchInterceptor.getName() );\n        }"
  },
  {
    "id": 59,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 80,
    "human_patch": "https://github.com/neo4j/neo4j/commit/46de5d01ae2741ffe04c36270fc62c6d490f65c9",
    "cve_id": "CVE-2018-18389",
    "cwe_id": "CWE-287",
    "filename": "enterprise/security/src/test/java/org/neo4j/server/security/enterprise/auth/integration/bolt/LdapAuthIT.java",
    "is_vulnerable": 0,
    "class_name": "LdapAuthIT",
    "subclass_name": "DirectoryServiceFailOnSearch",
    "function_name": "getName()",
    "function_body": "{\n                    return getClass().getName();\n                }"
  },
  {
    "id": 59,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 81,
    "human_patch": "https://github.com/neo4j/neo4j/commit/46de5d01ae2741ffe04c36270fc62c6d490f65c9",
    "cve_id": "CVE-2018-18389",
    "cwe_id": "CWE-287",
    "filename": "enterprise/security/src/test/java/org/neo4j/server/security/enterprise/auth/integration/bolt/LdapAuthIT.java",
    "is_vulnerable": 0,
    "class_name": "LdapAuthIT",
    "subclass_name": "DirectoryServiceFailOnSearch",
    "function_name": "search( SearchOperationContext searchContext ) throws LdapException",
    "function_body": "{\n                    throw new LdapOperationErrorException();\n                }"
  },
  {
    "id": 59,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 82,
    "human_patch": "https://github.com/neo4j/neo4j/commit/46de5d01ae2741ffe04c36270fc62c6d490f65c9",
    "cve_id": "CVE-2018-18389",
    "cwe_id": "CWE-287",
    "filename": "enterprise/security/src/test/java/org/neo4j/server/security/enterprise/auth/integration/bolt/LdapAuthIT.java",
    "is_vulnerable": 0,
    "class_name": "LdapAuthIT",
    "subclass_name": "DirectoryServiceFailOnSearch",
    "function_name": "close()",
    "function_body": "{\n            getService().remove( failOnSearchInterceptor.getName() );\n        }"
  },
  {
    "id": 59,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 83,
    "human_patch": "https://github.com/neo4j/neo4j/commit/46de5d01ae2741ffe04c36270fc62c6d490f65c9",
    "cve_id": "CVE-2018-18389",
    "cwe_id": "CWE-287",
    "filename": "enterprise/security/src/test/java/org/neo4j/server/security/enterprise/auth/integration/bolt/LdapAuthIT.java",
    "is_vulnerable": 0,
    "class_name": "LdapAuthIT",
    "subclass_name": "EmbeddedTestCertificates",
    "function_name": "close()",
    "function_body": "{\n            resetProperty( KEY_STORE, keyStore );\n            resetProperty( KEY_STORE_PASSWORD, keyStorePassword );\n            resetProperty( TRUST_STORE, trustStore );\n            resetProperty( TRUST_STORE_PASSWORD, trustStorePassword );\n        }"
  },
  {
    "id": 59,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 84,
    "human_patch": "https://github.com/neo4j/neo4j/commit/46de5d01ae2741ffe04c36270fc62c6d490f65c9",
    "cve_id": "CVE-2018-18389",
    "cwe_id": "CWE-287",
    "filename": "enterprise/security/src/test/java/org/neo4j/server/security/enterprise/auth/integration/bolt/LdapAuthIT.java",
    "is_vulnerable": 0,
    "class_name": "LdapAuthIT",
    "subclass_name": "EmbeddedTestCertificates",
    "function_name": "fileFromResources( String path )",
    "function_body": "{\n            URL url = getClass().getResource( path );\n            return new File( url.getFile() );\n        }"
  },
  {
    "id": 59,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 85,
    "human_patch": "https://github.com/neo4j/neo4j/commit/46de5d01ae2741ffe04c36270fc62c6d490f65c9",
    "cve_id": "CVE-2018-18389",
    "cwe_id": "CWE-287",
    "filename": "enterprise/security/src/test/java/org/neo4j/server/security/enterprise/auth/integration/bolt/LdapAuthIT.java",
    "is_vulnerable": 0,
    "class_name": "LdapAuthIT",
    "subclass_name": "EmbeddedTestCertificates",
    "function_name": "resetProperty( String property, String value )",
    "function_body": "{\n            if ( value == null )\n            {\n                System.clearProperty( property );\n            }\n            else\n            {\n                System.setProperty( property, value );\n            }\n        }"
  },
  {
    "id": 60,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 0,
    "human_patch": "https://github.com/opennetworkinglab/onos/commit/1a783729a1d7e0cd59d59a8dd3a73cdd6ac0f30d",
    "cve_id": "CVE-2018-1000615",
    "cwe_id": "Not Mapping",
    "filename": "protocols/ovsdb/rfc/src/main/java/org/onosproject/ovsdb/rfc/utils/VersionUtil.java",
    "is_vulnerable": 0,
    "class_name": "VersionUtil",
    "subclass_name": null,
    "function_name": "versionMatch(String version)",
    "function_body": "{\n        if (!version.matches(FORMAT)) {\n            throw new IllegalArgumentException(\"<\" + version\n                    + \"> does not match format \" + FORMAT);\n        }\n    }"
  },
  {
    "id": 60,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 1,
    "human_patch": "https://github.com/opennetworkinglab/onos/commit/1a783729a1d7e0cd59d59a8dd3a73cdd6ac0f30d",
    "cve_id": "CVE-2018-1000615",
    "cwe_id": "Not Mapping",
    "filename": "protocols/ovsdb/rfc/src/main/java/org/onosproject/ovsdb/rfc/utils/VersionUtil.java",
    "is_vulnerable": 1,
    "class_name": "VersionUtil",
    "subclass_name": null,
    "function_name": "versionCompare(String fromVersion, String toVersion)",
    "function_body": "{\n        String[] fromArr = fromVersion.split(\"\\\\.\");\n        String[] toArr = toVersion.split(\"\\\\.\");\n        int fromFirst = Integer.parseInt(fromArr[0]);\n        int fromMiddle = Integer.parseInt(fromArr[1]);\n        int fromEnd = Integer.parseInt(fromArr[2]);\n        int toFirst = Integer.parseInt(toArr[0]);\n        int toMiddle = Integer.parseInt(toArr[1]);\n        int toEnd = Integer.parseInt(toArr[2]);\n        if (fromFirst - toFirst != 0) {\n            return fromFirst - toFirst;\n        } else if (fromMiddle - toMiddle != 0) {\n            return fromMiddle - toMiddle;\n        } else {\n            return fromEnd - toEnd;\n        }\n    }"
  },
  {
    "id": 61,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 0,
    "human_patch": "https://github.com/OpenRefine/OpenRefine/commit/6a0d7d56e4ffb420316ce7849fde881344fbf881",
    "cve_id": "CVE-2018-20157",
    "cwe_id": "CWE-611",
    "filename": "main/src/com/google/refine/importers/XmlImporter.java",
    "is_vulnerable": 0,
    "class_name": "XmlImporter",
    "subclass_name": null,
    "function_name": "createParserUIInitializationData(\n            ImportingJob job, List<ObjectNode> fileRecords, String format)",
    "function_body": "{\n        ObjectNode options = super.createParserUIInitializationData(job, fileRecords, format);\n        try {\n            if (fileRecords.size() > 0) {\n                ObjectNode firstFileRecord = fileRecords.get(0);\n                File file = ImportingUtilities.getFile(job, firstFileRecord);\n                InputStream is = new FileInputStream(file);\n                \n                try {\n                    XMLStreamReader parser = createXMLStreamReader(is);\n                    PreviewParsingState state = new PreviewParsingState();\n\n                    while (parser.hasNext() && state.tokenCount < PREVIEW_PARSING_LIMIT) {\n                        int tokenType = parser.next();\n                        state.tokenCount++;\n                        if (tokenType == XMLStreamConstants.START_ELEMENT) {\n                            ObjectNode rootElement = descendElement(parser, state);\n                            if (rootElement != null) {\n                                JSONUtilities.safePut(options, \"dom\", rootElement);\n                                break;\n                            }\n                        } else {\n                            \n                        }\n                    }\n                } catch (XMLStreamException e) {\n                    logger.warn(\"Error generating parser UI initialization data for XML file\", e);\n                } finally {\n                    is.close();\n                }\n            }\n        } catch (IOException e) {\n            logger.error(\"Error generating parser UI initialization data for XML file\", e);\n        }\n\n        return options;\n    }"
  },
  {
    "id": 61,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 1,
    "human_patch": "https://github.com/OpenRefine/OpenRefine/commit/6a0d7d56e4ffb420316ce7849fde881344fbf881",
    "cve_id": "CVE-2018-20157",
    "cwe_id": "CWE-611",
    "filename": "main/src/com/google/refine/importers/XmlImporter.java",
    "is_vulnerable": 0,
    "class_name": "XmlImporter",
    "subclass_name": null,
    "function_name": "descendElement(XMLStreamReader parser, PreviewParsingState state)",
    "function_body": "{\n        ObjectNode result = ParsingUtilities.mapper.createObjectNode();\n        {\n            String name = parser.getLocalName();\n            JSONUtilities.safePut(result, \"n\", name);\n            \n            String prefix = parser.getPrefix();\n            if (prefix != null) {\n                JSONUtilities.safePut(result, \"p\", prefix);\n            }\n            String nsUri = parser.getNamespaceURI();\n            if (nsUri != null) {\n                JSONUtilities.safePut(result, \"uri\", nsUri);\n            }\n        }\n        \n        int namespaceCount = parser.getNamespaceCount();\n        if (namespaceCount > 0) {\n            ArrayNode namespaces = result.putArray(\"ns\");\n            \n            for (int i = 0; i < namespaceCount; i++) {\n                ObjectNode namespace = ParsingUtilities.mapper.createObjectNode();\n                namespaces.add(namespace);\n                JSONUtilities.safePut(namespace, \"p\", parser.getNamespacePrefix(i));\n                JSONUtilities.safePut(namespace, \"uri\", parser.getNamespaceURI(i));\n            }\n        }\n        \n        int attributeCount = parser.getAttributeCount();\n        if (attributeCount > 0) {\n            ArrayNode attributes = result.putArray(\"a\");\n            \n            for (int i = 0; i < attributeCount; i++) {\n                ObjectNode attribute = ParsingUtilities.mapper.createObjectNode();\n                attributes.add(attribute);\n                JSONUtilities.safePut(attribute, \"n\", parser.getAttributeLocalName(i));\n                JSONUtilities.safePut(attribute, \"v\", parser.getAttributeValue(i));\n                String prefix = parser.getAttributePrefix(i);\n                if (prefix != null) {\n                    JSONUtilities.safePut(attribute, \"p\", prefix);\n                }\n            }\n        }\n        \n        ArrayNode children = ParsingUtilities.mapper.createArrayNode();\n        try {\n            while (parser.hasNext() && state.tokenCount < PREVIEW_PARSING_LIMIT) {\n                int tokenType = parser.next();\n                state.tokenCount++;\n                if (tokenType == XMLStreamConstants.END_ELEMENT) {\n                    break;\n                } else if (tokenType == XMLStreamConstants.START_ELEMENT) {\n                    ObjectNode childElement = descendElement(parser, state);\n                    if (childElement != null) {\n                        children.add(childElement);\n                    }\n                } else if (tokenType == XMLStreamConstants.CHARACTERS ||\n                           tokenType == XMLStreamConstants.CDATA ||\n                           tokenType == XMLStreamConstants.SPACE) {\n                    ObjectNode childElement = ParsingUtilities.mapper.createObjectNode();\n                    JSONUtilities.safePut(childElement, \"t\", parser.getText());\n                    children.add(childElement);\n                } else {\n                    \n                }\n            }\n        } catch (XMLStreamException e) {\n            logger.error(\"Error generating parser UI initialization data for XML file\", e);\n        }\n        \n        if (children.size() > 0) {\n        \tresult.put(\"c\", children);\n        }\n        return result;\n    }"
  },
  {
    "id": 61,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 2,
    "human_patch": "https://github.com/OpenRefine/OpenRefine/commit/6a0d7d56e4ffb420316ce7849fde881344fbf881",
    "cve_id": "CVE-2018-20157",
    "cwe_id": "CWE-611",
    "filename": "main/src/com/google/refine/importers/XmlImporter.java",
    "is_vulnerable": 0,
    "class_name": "XmlImporter",
    "subclass_name": null,
    "function_name": "parseOneFile(Project project, ProjectMetadata metadata,\n            ImportingJob job, String fileSource, InputStream inputStream,\n            ImportColumnGroup rootColumnGroup, int limit, ObjectNode options,\n            List<Exception> exceptions)",
    "function_body": "{\n        \n        try {\n            parseOneFile(project, metadata, job, fileSource,\n                new XmlParser(inputStream), rootColumnGroup, limit, options, exceptions);\n            \n            super.parseOneFile(project, metadata, job, fileSource, inputStream, rootColumnGroup, limit, options, exceptions);\n        } catch (XMLStreamException e) {\n            exceptions.add(e);\n        } catch (IOException e) {\n            exceptions.add(e);\n        }\n    }"
  },
  {
    "id": 61,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 3,
    "human_patch": "https://github.com/OpenRefine/OpenRefine/commit/6a0d7d56e4ffb420316ce7849fde881344fbf881",
    "cve_id": "CVE-2018-20157",
    "cwe_id": "CWE-611",
    "filename": "main/src/com/google/refine/importers/XmlImporter.java",
    "is_vulnerable": 0,
    "class_name": "XmlImporter",
    "subclass_name": "XmlParser",
    "function_name": "next() throws TreeReaderException",
    "function_body": "{\n            try {\n                if (!parser.hasNext()) {\n                    throw new TreeReaderException(\"End of XML stream\");\n                }\n            } catch (XMLStreamException e) {\n                throw new TreeReaderException(e);\n            }\n            \n            int currentToken = -1;\n            try {\n                currentToken = parser.next();\n            } catch (XMLStreamException e) {\n                throw new TreeReaderException(e);\n            }\n            \n            return mapToToken(currentToken);\n        }"
  },
  {
    "id": 61,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 4,
    "human_patch": "https://github.com/OpenRefine/OpenRefine/commit/6a0d7d56e4ffb420316ce7849fde881344fbf881",
    "cve_id": "CVE-2018-20157",
    "cwe_id": "CWE-611",
    "filename": "main/src/com/google/refine/importers/XmlImporter.java",
    "is_vulnerable": 0,
    "class_name": "XmlImporter",
    "subclass_name": "XmlParser",
    "function_name": "mapToToken(int token)",
    "function_body": "{\n            switch(token){\n                case XMLStreamConstants.START_ELEMENT: return Token.StartEntity;\n                case XMLStreamConstants.END_ELEMENT: return Token.EndEntity;\n                case XMLStreamConstants.CHARACTERS: return Token.Value;\n                case XMLStreamConstants.START_DOCUMENT: return Token.Ignorable;\n                case XMLStreamConstants.END_DOCUMENT: return Token.Ignorable;\n                case XMLStreamConstants.SPACE: return Token.Value;\n                case XMLStreamConstants.PROCESSING_INSTRUCTION: return Token.Ignorable;\n                case XMLStreamConstants.NOTATION_DECLARATION: return Token.Ignorable;\n                case XMLStreamConstants.NAMESPACE: return Token.Ignorable;\n                case XMLStreamConstants.ENTITY_REFERENCE: return Token.Ignorable;\n                case XMLStreamConstants.DTD: return Token.Ignorable;\n                case XMLStreamConstants.COMMENT: return Token.Ignorable;\n                case XMLStreamConstants.CDATA: return Token.Ignorable;\n                case XMLStreamConstants.ATTRIBUTE: return Token.Ignorable;\n                default:\n                    return Token.Ignorable;\n            }\n        }"
  },
  {
    "id": 61,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 5,
    "human_patch": "https://github.com/OpenRefine/OpenRefine/commit/6a0d7d56e4ffb420316ce7849fde881344fbf881",
    "cve_id": "CVE-2018-20157",
    "cwe_id": "CWE-611",
    "filename": "main/src/com/google/refine/importers/XmlImporter.java",
    "is_vulnerable": 0,
    "class_name": "XmlImporter",
    "subclass_name": "XmlParser",
    "function_name": "current() throws TreeReaderException",
    "function_body": "{\n            return this.mapToToken(parser.getEventType());\n        }"
  },
  {
    "id": 61,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 6,
    "human_patch": "https://github.com/OpenRefine/OpenRefine/commit/6a0d7d56e4ffb420316ce7849fde881344fbf881",
    "cve_id": "CVE-2018-20157",
    "cwe_id": "CWE-611",
    "filename": "main/src/com/google/refine/importers/XmlImporter.java",
    "is_vulnerable": 0,
    "class_name": "XmlImporter",
    "subclass_name": "XmlParser",
    "function_name": "hasNext() throws TreeReaderException",
    "function_body": "{\n            try {\n                return parser.hasNext();\n            } catch (XMLStreamException e) {\n                throw new TreeReaderException(e);\n            }\n        }"
  },
  {
    "id": 61,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 7,
    "human_patch": "https://github.com/OpenRefine/OpenRefine/commit/6a0d7d56e4ffb420316ce7849fde881344fbf881",
    "cve_id": "CVE-2018-20157",
    "cwe_id": "CWE-611",
    "filename": "main/src/com/google/refine/importers/XmlImporter.java",
    "is_vulnerable": 0,
    "class_name": "XmlImporter",
    "subclass_name": "XmlParser",
    "function_name": "getFieldName() throws TreeReaderException",
    "function_body": "{\n            try {\n                return parser.getLocalName();\n            } catch (IllegalStateException e) {\n                return null;\n            }\n        }"
  },
  {
    "id": 61,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 8,
    "human_patch": "https://github.com/OpenRefine/OpenRefine/commit/6a0d7d56e4ffb420316ce7849fde881344fbf881",
    "cve_id": "CVE-2018-20157",
    "cwe_id": "CWE-611",
    "filename": "main/src/com/google/refine/importers/XmlImporter.java",
    "is_vulnerable": 0,
    "class_name": "XmlImporter",
    "subclass_name": "XmlParser",
    "function_name": "getPrefix()",
    "function_body": "{\n            return parser.getPrefix();\n        }"
  },
  {
    "id": 61,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 9,
    "human_patch": "https://github.com/OpenRefine/OpenRefine/commit/6a0d7d56e4ffb420316ce7849fde881344fbf881",
    "cve_id": "CVE-2018-20157",
    "cwe_id": "CWE-611",
    "filename": "main/src/com/google/refine/importers/XmlImporter.java",
    "is_vulnerable": 0,
    "class_name": "XmlImporter",
    "subclass_name": "XmlParser",
    "function_name": "getFieldValue()",
    "function_body": "{\n            return parser.getText();\n        }"
  },
  {
    "id": 61,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 10,
    "human_patch": "https://github.com/OpenRefine/OpenRefine/commit/6a0d7d56e4ffb420316ce7849fde881344fbf881",
    "cve_id": "CVE-2018-20157",
    "cwe_id": "CWE-611",
    "filename": "main/src/com/google/refine/importers/XmlImporter.java",
    "is_vulnerable": 0,
    "class_name": "XmlImporter",
    "subclass_name": "XmlParser",
    "function_name": "getValue()",
    "function_body": "{\n            \n            return getFieldValue();\n        }"
  },
  {
    "id": 61,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 11,
    "human_patch": "https://github.com/OpenRefine/OpenRefine/commit/6a0d7d56e4ffb420316ce7849fde881344fbf881",
    "cve_id": "CVE-2018-20157",
    "cwe_id": "CWE-611",
    "filename": "main/src/com/google/refine/importers/XmlImporter.java",
    "is_vulnerable": 0,
    "class_name": "XmlImporter",
    "subclass_name": "XmlParser",
    "function_name": "getAttributeCount()",
    "function_body": "{\n            return parser.getAttributeCount();\n        }"
  },
  {
    "id": 61,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 12,
    "human_patch": "https://github.com/OpenRefine/OpenRefine/commit/6a0d7d56e4ffb420316ce7849fde881344fbf881",
    "cve_id": "CVE-2018-20157",
    "cwe_id": "CWE-611",
    "filename": "main/src/com/google/refine/importers/XmlImporter.java",
    "is_vulnerable": 0,
    "class_name": "XmlImporter",
    "subclass_name": "XmlParser",
    "function_name": "getAttributeValue(int index)",
    "function_body": "{\n            return parser.getAttributeValue(index);\n        }"
  },
  {
    "id": 61,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 13,
    "human_patch": "https://github.com/OpenRefine/OpenRefine/commit/6a0d7d56e4ffb420316ce7849fde881344fbf881",
    "cve_id": "CVE-2018-20157",
    "cwe_id": "CWE-611",
    "filename": "main/src/com/google/refine/importers/XmlImporter.java",
    "is_vulnerable": 0,
    "class_name": "XmlImporter",
    "subclass_name": "XmlParser",
    "function_name": "getAttributePrefix(int index)",
    "function_body": "{\n            return parser.getAttributePrefix(index);\n        }"
  },
  {
    "id": 61,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 14,
    "human_patch": "https://github.com/OpenRefine/OpenRefine/commit/6a0d7d56e4ffb420316ce7849fde881344fbf881",
    "cve_id": "CVE-2018-20157",
    "cwe_id": "CWE-611",
    "filename": "main/src/com/google/refine/importers/XmlImporter.java",
    "is_vulnerable": 0,
    "class_name": "XmlImporter",
    "subclass_name": "XmlParser",
    "function_name": "getAttributeLocalName(int index)",
    "function_body": "{\n            return parser.getAttributeLocalName(index);\n        }"
  },
  {
    "id": 61,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 15,
    "human_patch": "https://github.com/OpenRefine/OpenRefine/commit/6a0d7d56e4ffb420316ce7849fde881344fbf881",
    "cve_id": "CVE-2018-20157",
    "cwe_id": "CWE-611",
    "filename": "main/src/com/google/refine/importers/XmlImporter.java",
    "is_vulnerable": 1,
    "class_name": "XmlImporter",
    "subclass_name": null,
    "function_name": "createXMLStreamReader(InputStream inputStream) throws XMLStreamException, IOException",
    "function_body": "{\n        XMLInputFactory factory = XMLInputFactory.newInstance();\n        factory.setProperty(XMLInputFactory.IS_COALESCING, true);\n        factory.setProperty(XMLInputFactory.IS_REPLACING_ENTITY_REFERENCES, true);\n        \n        return factory.createXMLStreamReader(wrapPrefixRemovingInputStream(inputStream));\n    }"
  },
  {
    "id": 61,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 16,
    "human_patch": "https://github.com/OpenRefine/OpenRefine/commit/6a0d7d56e4ffb420316ce7849fde881344fbf881",
    "cve_id": "CVE-2018-20157",
    "cwe_id": "CWE-611",
    "filename": "main/src/com/google/refine/importers/XmlImporter.java",
    "is_vulnerable": 0,
    "class_name": "XmlImporter",
    "subclass_name": null,
    "function_name": "wrapPrefixRemovingInputStream(InputStream inputStream) throws XMLStreamException, IOException",
    "function_body": "{\n        PushbackInputStream pis = new PushbackInputStream(inputStream);\n        int b;\n        int count = 0;\n        while (count < 100 && (b = pis.read()) >= 0) {\n            if (++count > 100) {\n                throw new XMLStreamException(\n                    \"File starts with too much non-XML content to skip over\");\n            } else if (b == '<') {\n                pis.unread(b);\n                break;\n            }\n        }\n        return pis;\n    }"
  },
  {
    "id": 61,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 0,
    "human_patch": "https://github.com/OpenRefine/OpenRefine/commit/6a0d7d56e4ffb420316ce7849fde881344fbf881",
    "cve_id": "CVE-2018-20157",
    "cwe_id": "CWE-611",
    "filename": "main/tests/server/src/com/google/refine/tests/importers/XmlImporterTests.java",
    "is_vulnerable": 0,
    "class_name": "XmlImporterTests",
    "subclass_name": null,
    "function_name": "init()",
    "function_body": "{\n        logger = LoggerFactory.getLogger(this.getClass());\n    }"
  },
  {
    "id": 61,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 1,
    "human_patch": "https://github.com/OpenRefine/OpenRefine/commit/6a0d7d56e4ffb420316ce7849fde881344fbf881",
    "cve_id": "CVE-2018-20157",
    "cwe_id": "CWE-611",
    "filename": "main/tests/server/src/com/google/refine/tests/importers/XmlImporterTests.java",
    "is_vulnerable": 0,
    "class_name": "XmlImporterTests",
    "subclass_name": null,
    "function_name": "setUp()",
    "function_body": "{\n        super.setUp();\n        SUT = new XmlImporter();\n    }"
  },
  {
    "id": 61,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 2,
    "human_patch": "https://github.com/OpenRefine/OpenRefine/commit/6a0d7d56e4ffb420316ce7849fde881344fbf881",
    "cve_id": "CVE-2018-20157",
    "cwe_id": "CWE-611",
    "filename": "main/tests/server/src/com/google/refine/tests/importers/XmlImporterTests.java",
    "is_vulnerable": 0,
    "class_name": "XmlImporterTests",
    "subclass_name": null,
    "function_name": "tearDown()",
    "function_body": "{\n        SUT = null;\n        if (inputStream != null) {\n            try {\n                inputStream.close();\n            } catch (IOException e) {\n                \n            }\n            inputStream = null;\n        }\n        super.tearDown();\n    }"
  },
  {
    "id": 61,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 3,
    "human_patch": "https://github.com/OpenRefine/OpenRefine/commit/6a0d7d56e4ffb420316ce7849fde881344fbf881",
    "cve_id": "CVE-2018-20157",
    "cwe_id": "CWE-611",
    "filename": "main/tests/server/src/com/google/refine/tests/importers/XmlImporterTests.java",
    "is_vulnerable": 0,
    "class_name": "XmlImporterTests",
    "subclass_name": null,
    "function_name": "canParseSample()",
    "function_body": "{\n        RunTest(getSample());\n\n        log(project);\n        assertProjectCreated(project, 4, 6);\n\n        Row row = project.rows.get(0);\n        Assert.assertNotNull(row);\n        Assert.assertNotNull(row.getCell(1));\n        Assert.assertEquals(row.getCell(1).value, \"Author 1, The\");\n    }"
  },
  {
    "id": 61,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 4,
    "human_patch": "https://github.com/OpenRefine/OpenRefine/commit/6a0d7d56e4ffb420316ce7849fde881344fbf881",
    "cve_id": "CVE-2018-20157",
    "cwe_id": "CWE-611",
    "filename": "main/tests/server/src/com/google/refine/tests/importers/XmlImporterTests.java",
    "is_vulnerable": 0,
    "class_name": "XmlImporterTests",
    "subclass_name": null,
    "function_name": "canParseDeeplyNestedSample()",
    "function_body": "{\n        RunTest(getDeeplyNestedSample(), getNestedOptions(job, SUT));\n\n        log(project);\n        assertProjectCreated(project, 4, 6);\n\n        Row row = project.rows.get(0);\n        Assert.assertNotNull(row);\n        Assert.assertNotNull(row.getCell(1));\n        Assert.assertEquals(row.getCell(1).value, \"Author 1, The\");\n    }"
  },
  {
    "id": 61,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 5,
    "human_patch": "https://github.com/OpenRefine/OpenRefine/commit/6a0d7d56e4ffb420316ce7849fde881344fbf881",
    "cve_id": "CVE-2018-20157",
    "cwe_id": "CWE-611",
    "filename": "main/tests/server/src/com/google/refine/tests/importers/XmlImporterTests.java",
    "is_vulnerable": 0,
    "class_name": "XmlImporterTests",
    "subclass_name": null,
    "function_name": "canParseSampleWithMixedElement()",
    "function_body": "{\n        RunTest(getMixedElementSample(), getNestedOptions(job, SUT));\n\n        log(project);\n        assertProjectCreated(project, 4, 6);\n        \n        Row row = project.rows.get(0);\n        Assert.assertNotNull(row);\n        Assert.assertNotNull(row.getCell(1));\n        Assert.assertEquals(row.getCell(1).value, \"Author 1, The\");\n    }"
  },
  {
    "id": 61,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 6,
    "human_patch": "https://github.com/OpenRefine/OpenRefine/commit/6a0d7d56e4ffb420316ce7849fde881344fbf881",
    "cve_id": "CVE-2018-20157",
    "cwe_id": "CWE-611",
    "filename": "main/tests/server/src/com/google/refine/tests/importers/XmlImporterTests.java",
    "is_vulnerable": 0,
    "class_name": "XmlImporterTests",
    "subclass_name": null,
    "function_name": "canParseSampleWithDuplicateNestedElements()",
    "function_body": "{\n        RunTest(getSampleWithDuplicateNestedElements());\n\n        log(project);\n        assertProjectCreated(project, 4, 12);\n\n        Row row = project.rows.get(0);\n        Assert.assertNotNull(row);\n        Assert.assertEquals(row.cells.size(), 4);\n        Assert.assertNotNull(row.getCell(1));\n        Assert.assertEquals(row.getCell(1).value, \"Author 1, The\");\n        Assert.assertEquals(project.rows.get(1).getCell(1).value, \"Author 1, Another\");\n    }"
  },
  {
    "id": 61,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 7,
    "human_patch": "https://github.com/OpenRefine/OpenRefine/commit/6a0d7d56e4ffb420316ce7849fde881344fbf881",
    "cve_id": "CVE-2018-20157",
    "cwe_id": "CWE-611",
    "filename": "main/tests/server/src/com/google/refine/tests/importers/XmlImporterTests.java",
    "is_vulnerable": 0,
    "class_name": "XmlImporterTests",
    "subclass_name": null,
    "function_name": "testCanParseLineBreak()",
    "function_body": "{\n\n        RunTest(getSampleWithLineBreak());\n\n        log(project);\n        assertProjectCreated(project, 4, 6);\n\n        Row row = project.rows.get(3);\n        Assert.assertNotNull(row);\n        Assert.assertEquals(row.cells.size(), 4);\n        Assert.assertNotNull(row.getCell(1));\n        Assert.assertEquals(row.getCell(1).value, \"With line\\n break\");\n    }"
  },
  {
    "id": 61,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 8,
    "human_patch": "https://github.com/OpenRefine/OpenRefine/commit/6a0d7d56e4ffb420316ce7849fde881344fbf881",
    "cve_id": "CVE-2018-20157",
    "cwe_id": "CWE-611",
    "filename": "main/tests/server/src/com/google/refine/tests/importers/XmlImporterTests.java",
    "is_vulnerable": 0,
    "class_name": "XmlImporterTests",
    "subclass_name": null,
    "function_name": "testElementsWithVaryingStructure()",
    "function_body": "{\n        RunTest(getSampleWithVaryingStructure());\n\n        log(project);\n        assertProjectCreated(project, 5, 6);\n\n        Assert.assertEquals(project.columnModel.getColumnByCellIndex(4).getName(), \"book - genre\");\n\n        Row row0 = project.rows.get(0);\n        Assert.assertNotNull(row0);\n        Assert.assertEquals(row0.cells.size(),4);\n\n        Row row5  = project.rows.get(5);\n        Assert.assertNotNull(row5);\n        Assert.assertEquals(row5.cells.size(),5);\n    }"
  },
  {
    "id": 61,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 9,
    "human_patch": "https://github.com/OpenRefine/OpenRefine/commit/6a0d7d56e4ffb420316ce7849fde881344fbf881",
    "cve_id": "CVE-2018-20157",
    "cwe_id": "CWE-611",
    "filename": "main/tests/server/src/com/google/refine/tests/importers/XmlImporterTests.java",
    "is_vulnerable": 0,
    "class_name": "XmlImporterTests",
    "subclass_name": null,
    "function_name": "testElementWithNestedTree()",
    "function_body": "{\n        RunTest(getSampleWithTreeStructure());\n        log(project);\n        assertProjectCreated(project, 5, 6);\n\n        Assert.assertEquals(project.columnModel.columnGroups.size(),1);\n        Assert.assertEquals(project.columnModel.columnGroups.get(0).keyColumnIndex, 2);\n        Assert.assertEquals(project.columnModel.columnGroups.get(0).startColumnIndex, 2);\n        Assert.assertNull(project.columnModel.columnGroups.get(0).parentGroup);\n        Assert.assertEquals(project.columnModel.columnGroups.get(0).subgroups.size(),0);\n        Assert.assertEquals(project.columnModel.columnGroups.get(0).columnSpan,2);\n    }"
  },
  {
    "id": 61,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 10,
    "human_patch": "https://github.com/OpenRefine/OpenRefine/commit/6a0d7d56e4ffb420316ce7849fde881344fbf881",
    "cve_id": "CVE-2018-20157",
    "cwe_id": "CWE-611",
    "filename": "main/tests/server/src/com/google/refine/tests/importers/XmlImporterTests.java",
    "is_vulnerable": 0,
    "class_name": "XmlImporterTests",
    "subclass_name": null,
    "function_name": "getTypicalElement(int id)",
    "function_body": "{\n        return \"<book id=\\\"\" + id + \"\\\">\" +\n        \"<author>Author \" + id + \", The</author>\" +\n        \"<title>Book title \" + id + \"</title>\" +\n        \"<publish_date>2010-05-26</publish_date>\" +\n        \"</book>\";\n    }"
  },
  {
    "id": 61,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 11,
    "human_patch": "https://github.com/OpenRefine/OpenRefine/commit/6a0d7d56e4ffb420316ce7849fde881344fbf881",
    "cve_id": "CVE-2018-20157",
    "cwe_id": "CWE-611",
    "filename": "main/tests/server/src/com/google/refine/tests/importers/XmlImporterTests.java",
    "is_vulnerable": 0,
    "class_name": "XmlImporterTests",
    "subclass_name": null,
    "function_name": "getElementWithDuplicateSubElement(int id)",
    "function_body": "{\n        return \"<book id=\\\"\" + id + \"\\\">\" +\n        \"<authors>\" +\n        \"<author>Author \" + id + \", The</author>\" +\n        \"<author>Author \" + id + \", Another</author>\" +\n        \"</authors>\" +\n        \"<title>Book title \" + id + \"</title>\" +\n        \"<publish_date>2010-05-26</publish_date>\" +\n        \"</book>\";\n    }"
  },
  {
    "id": 61,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 12,
    "human_patch": "https://github.com/OpenRefine/OpenRefine/commit/6a0d7d56e4ffb420316ce7849fde881344fbf881",
    "cve_id": "CVE-2018-20157",
    "cwe_id": "CWE-611",
    "filename": "main/tests/server/src/com/google/refine/tests/importers/XmlImporterTests.java",
    "is_vulnerable": 0,
    "class_name": "XmlImporterTests",
    "subclass_name": null,
    "function_name": "getSample()",
    "function_body": "{\n        StringBuilder sb = new StringBuilder();\n        sb.append(\"<?xml version=\\\"1.0\\\"?><library>\");\n        for(int i = 1; i < 7; i++){\n            sb.append(getTypicalElement(i));\n        }\n        sb.append(\"</library>\");\n        return sb.toString();\n    }"
  },
  {
    "id": 61,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 13,
    "human_patch": "https://github.com/OpenRefine/OpenRefine/commit/6a0d7d56e4ffb420316ce7849fde881344fbf881",
    "cve_id": "CVE-2018-20157",
    "cwe_id": "CWE-611",
    "filename": "main/tests/server/src/com/google/refine/tests/importers/XmlImporterTests.java",
    "is_vulnerable": 0,
    "class_name": "XmlImporterTests",
    "subclass_name": null,
    "function_name": "getOptions(ImportingJob job, TreeImportingParserBase parser)",
    "function_body": "{\n        ObjectNode options = parser.createParserUIInitializationData(\n                job, new LinkedList<>(), \"text/json\");\n        \n        ArrayNode path = ParsingUtilities.mapper.createArrayNode();\n        JSONUtilities.append(path, \"library\");\n        JSONUtilities.append(path, \"book\");\n        \n        JSONUtilities.safePut(options, \"recordPath\", path);\n        return options;\n    }"
  },
  {
    "id": 61,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 14,
    "human_patch": "https://github.com/OpenRefine/OpenRefine/commit/6a0d7d56e4ffb420316ce7849fde881344fbf881",
    "cve_id": "CVE-2018-20157",
    "cwe_id": "CWE-611",
    "filename": "main/tests/server/src/com/google/refine/tests/importers/XmlImporterTests.java",
    "is_vulnerable": 0,
    "class_name": "XmlImporterTests",
    "subclass_name": null,
    "function_name": "getNestedOptions(ImportingJob job, TreeImportingParserBase parser)",
    "function_body": "{\n        ObjectNode options = parser.createParserUIInitializationData(\n                job, new LinkedList<>(), \"text/json\");\n        \n        ArrayNode path = ParsingUtilities.mapper.createArrayNode();\n        JSONUtilities.append(path, \"nest\");\n        JSONUtilities.append(path, \"nest2\");\n        JSONUtilities.append(path, \"library\");\n        JSONUtilities.append(path, \"book\");\n        \n        JSONUtilities.safePut(options, \"recordPath\", path);\n        return options;\n    }"
  },
  {
    "id": 61,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 15,
    "human_patch": "https://github.com/OpenRefine/OpenRefine/commit/6a0d7d56e4ffb420316ce7849fde881344fbf881",
    "cve_id": "CVE-2018-20157",
    "cwe_id": "CWE-611",
    "filename": "main/tests/server/src/com/google/refine/tests/importers/XmlImporterTests.java",
    "is_vulnerable": 0,
    "class_name": "XmlImporterTests",
    "subclass_name": null,
    "function_name": "getDeeplyNestedSample()",
    "function_body": "{\n        StringBuilder sb = new StringBuilder();\n        sb.append(\"<?xml version=\\\"1.0\\\"?><nest><nest2><library>\");\n        for(int i = 1; i < 7; i++){\n            sb.append(getTypicalElement(i));\n        }\n        sb.append(\"</library></nest2>\");\n        sb.append(\"<anElement>asdf</anElement></nest>\");\n        return sb.toString();\n    }"
  },
  {
    "id": 61,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 16,
    "human_patch": "https://github.com/OpenRefine/OpenRefine/commit/6a0d7d56e4ffb420316ce7849fde881344fbf881",
    "cve_id": "CVE-2018-20157",
    "cwe_id": "CWE-611",
    "filename": "main/tests/server/src/com/google/refine/tests/importers/XmlImporterTests.java",
    "is_vulnerable": 0,
    "class_name": "XmlImporterTests",
    "subclass_name": null,
    "function_name": "getMixedElementSample()",
    "function_body": "{\n        StringBuilder sb = new StringBuilder();\n        sb.append(\"<?xml version=\\\"1.0\\\"?><nest>\");\n        sb.append(\"somemixeduptext\");\n        sb.append(\"<nest2><library>\");\n        for(int i = 1; i < 7; i++){\n            sb.append(getTypicalElement(i));\n        }\n        sb.append(\"</library></nest2>\");\n        sb.append(\"<anElement>asdf</anElement></nest>\");\n        return sb.toString();\n    }"
  },
  {
    "id": 61,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 17,
    "human_patch": "https://github.com/OpenRefine/OpenRefine/commit/6a0d7d56e4ffb420316ce7849fde881344fbf881",
    "cve_id": "CVE-2018-20157",
    "cwe_id": "CWE-611",
    "filename": "main/tests/server/src/com/google/refine/tests/importers/XmlImporterTests.java",
    "is_vulnerable": 0,
    "class_name": "XmlImporterTests",
    "subclass_name": null,
    "function_name": "getSampleWithDuplicateNestedElements()",
    "function_body": "{\n        StringBuilder sb = new StringBuilder();\n        sb.append(\"<?xml version=\\\"1.0\\\"?><library>\");\n        for(int i = 1; i < 7; i++){\n            sb.append(getElementWithDuplicateSubElement(i));\n        }\n        sb.append(\"</library>\");\n        return sb.toString();\n\n    }"
  },
  {
    "id": 61,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 18,
    "human_patch": "https://github.com/OpenRefine/OpenRefine/commit/6a0d7d56e4ffb420316ce7849fde881344fbf881",
    "cve_id": "CVE-2018-20157",
    "cwe_id": "CWE-611",
    "filename": "main/tests/server/src/com/google/refine/tests/importers/XmlImporterTests.java",
    "is_vulnerable": 0,
    "class_name": "XmlImporterTests",
    "subclass_name": null,
    "function_name": "getSampleWithLineBreak()",
    "function_body": "{\n        StringBuilder sb = new StringBuilder();\n        sb.append(\"<?xml version=\\\"1.0\\\"?><library>\");\n        for(int i = 1; i < 4; i++){\n            sb.append(getTypicalElement(i));\n        }\n        sb.append(\"<book id=\\\"4\\\">\" +\n                \"<author>With line\\n break</author>\" +\n                \"<title>Book title 4</title>\" +\n                \"<publish_date>2010-05-26</publish_date>\" +\n                \"</book>\");\n        sb.append(getTypicalElement(5));\n        sb.append(getTypicalElement(6));\n        sb.append(\"</library>\");\n        return sb.toString();\n    }"
  },
  {
    "id": 61,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 19,
    "human_patch": "https://github.com/OpenRefine/OpenRefine/commit/6a0d7d56e4ffb420316ce7849fde881344fbf881",
    "cve_id": "CVE-2018-20157",
    "cwe_id": "CWE-611",
    "filename": "main/tests/server/src/com/google/refine/tests/importers/XmlImporterTests.java",
    "is_vulnerable": 0,
    "class_name": "XmlImporterTests",
    "subclass_name": null,
    "function_name": "getSampleWithVaryingStructure()",
    "function_body": "{\n        StringBuilder sb = new StringBuilder();\n        sb.append(\"<?xml version=\\\"1.0\\\"?><library>\");\n        for(int i = 1; i < 6; i++){\n            sb.append(getTypicalElement(i));\n        }\n        sb.append(\"<book id=\\\"6\\\">\" +\n                \"<author>Author 6, The</author>\" +\n                \"<title>Book title 6</title>\" +\n                \"<genre>New element not seen in other records</genre>\" +\n                \"<publish_date>2010-05-26</publish_date>\" +\n                \"</book>\");\n        sb.append(\"</library>\");\n        return sb.toString();\n    }"
  },
  {
    "id": 61,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 20,
    "human_patch": "https://github.com/OpenRefine/OpenRefine/commit/6a0d7d56e4ffb420316ce7849fde881344fbf881",
    "cve_id": "CVE-2018-20157",
    "cwe_id": "CWE-611",
    "filename": "main/tests/server/src/com/google/refine/tests/importers/XmlImporterTests.java",
    "is_vulnerable": 0,
    "class_name": "XmlImporterTests",
    "subclass_name": null,
    "function_name": "getSampleWithTreeStructure()",
    "function_body": "{\n        StringBuilder sb = new StringBuilder();\n        sb.append(\"<?xml version=\\\"1.0\\\"?><library>\");\n        for(int i = 1; i < 7; i++){\n            sb.append(\"<book id=\\\"\" + i + \"\\\">\" +\n                    \"<author><author-name>Author \" + i + \", The</author-name>\" +\n                    \"<author-dob>1950-0\" + i + \"-15</author-dob></author>\" +\n                    \"<title>Book title \" + i + \"</title>\" +\n                    \"<publish_date>2010-05-26</publish_date>\" +\n                    \"</book>\");\n        }\n        sb.append(\"</library>\");\n        return sb.toString();\n    }"
  },
  {
    "id": 61,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 21,
    "human_patch": "https://github.com/OpenRefine/OpenRefine/commit/6a0d7d56e4ffb420316ce7849fde881344fbf881",
    "cve_id": "CVE-2018-20157",
    "cwe_id": "CWE-611",
    "filename": "main/tests/server/src/com/google/refine/tests/importers/XmlImporterTests.java",
    "is_vulnerable": 0,
    "class_name": "XmlImporterTests",
    "subclass_name": null,
    "function_name": "RunTest(String testString)",
    "function_body": "{\n        RunTest(testString, getOptions(job, SUT));\n    }"
  },
  {
    "id": 61,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 22,
    "human_patch": "https://github.com/OpenRefine/OpenRefine/commit/6a0d7d56e4ffb420316ce7849fde881344fbf881",
    "cve_id": "CVE-2018-20157",
    "cwe_id": "CWE-611",
    "filename": "main/tests/server/src/com/google/refine/tests/importers/XmlImporterTests.java",
    "is_vulnerable": 0,
    "class_name": "XmlImporterTests",
    "subclass_name": null,
    "function_name": "RunTest(String testString, ObjectNode objectNode)",
    "function_body": "{\n        try {\n            inputStream = new ByteArrayInputStream(testString.getBytes( \"UTF-8\" ));\n        } catch (UnsupportedEncodingException e1) {\n            Assert.fail();\n        }\n\n        try {\n            parseOneFile(SUT, inputStream, objectNode);\n        } catch (Exception e) {\n            e.printStackTrace();\n            Assert.fail();\n        }\n    }"
  },
  {
    "id": 61,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 23,
    "human_patch": "https://github.com/OpenRefine/OpenRefine/commit/6a0d7d56e4ffb420316ce7849fde881344fbf881",
    "cve_id": "CVE-2018-20157",
    "cwe_id": "CWE-611",
    "filename": "main/tests/server/src/com/google/refine/tests/importers/XmlImporterTests.java",
    "is_vulnerable": 0,
    "class_name": "XmlImporterTests",
    "subclass_name": null,
    "function_name": "parseOneFile(TreeImportingParserBase parser, InputStream inputStream, ObjectNode options)",
    "function_body": "{\n        parseOneInputStream(parser, inputStream, options);\n    }"
  },
  {
    "id": 62,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 0,
    "human_patch": "https://github.com/OpenRefine/OpenRefine/commit/e243e73e4064de87a913946bd320fbbe246da656",
    "cve_id": "CVE-2018-19859",
    "cwe_id": "CWE-22",
    "filename": "main/src/com/google/refine/importing/ImportingUtilities.java",
    "is_vulnerable": 0,
    "class_name": "ImportingUtilities",
    "subclass_name": "Progress",
    "function_name": "setProgress(String message, int percent)",
    "function_body": null
  },
  {
    "id": 62,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 1,
    "human_patch": "https://github.com/OpenRefine/OpenRefine/commit/e243e73e4064de87a913946bd320fbbe246da656",
    "cve_id": "CVE-2018-19859",
    "cwe_id": "CWE-22",
    "filename": "main/src/com/google/refine/importing/ImportingUtilities.java",
    "is_vulnerable": 0,
    "class_name": "ImportingUtilities",
    "subclass_name": "Progress",
    "function_name": "isCanceled()",
    "function_body": null
  },
  {
    "id": 62,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 2,
    "human_patch": "https://github.com/OpenRefine/OpenRefine/commit/e243e73e4064de87a913946bd320fbbe246da656",
    "cve_id": "CVE-2018-19859",
    "cwe_id": "CWE-22",
    "filename": "main/src/com/google/refine/importing/ImportingUtilities.java",
    "is_vulnerable": 0,
    "class_name": "ImportingUtilities",
    "subclass_name": null,
    "function_name": "loadDataAndPrepareJob(\n        HttpServletRequest request,\n        HttpServletResponse response,\n        Properties parameters,\n        final ImportingJob job,\n        ObjectNode config) throws IOException, ServletException",
    "function_body": "{\n        \n        ObjectNode retrievalRecord = ParsingUtilities.mapper.createObjectNode();\n        JSONUtilities.safePut(config, \"retrievalRecord\", retrievalRecord);\n        JSONUtilities.safePut(config, \"state\", \"loading-raw-data\");\n        \n        final ObjectNode progress = ParsingUtilities.mapper.createObjectNode();\n        JSONUtilities.safePut(config, \"progress\", progress);\n        try {\n            ImportingUtilities.retrieveContentFromPostRequest(\n                request,\n                parameters,\n                job.getRawDataDir(),\n                retrievalRecord,\n                new Progress() {\n                    @Override\n                    public void setProgress(String message, int percent) {\n                        if (message != null) {\n                            JSONUtilities.safePut(progress, \"message\", message);\n                        }\n                        JSONUtilities.safePut(progress, \"percent\", percent);\n                    }\n                    @Override\n                    public boolean isCanceled() {\n                        return job.canceled;\n                    }\n                }\n            );\n        } catch (Exception e) {\n            JSONUtilities.safePut(config, \"state\", \"error\");\n            JSONUtilities.safePut(config, \"error\", \"Error uploading data\");\n            JSONUtilities.safePut(config, \"errorDetails\", e.getLocalizedMessage());\n            return;\n        }\n        \n        ArrayNode fileSelectionIndexes = ParsingUtilities.mapper.createArrayNode();\n        JSONUtilities.safePut(config, \"fileSelection\", fileSelectionIndexes);\n        \n        String bestFormat = ImportingUtilities.autoSelectFiles(job, retrievalRecord, fileSelectionIndexes);\n        bestFormat = ImportingUtilities.guessBetterFormat(job, bestFormat);\n        \n        ArrayNode rankedFormats = ParsingUtilities.mapper.createArrayNode();\n        ImportingUtilities.rankFormats(job, bestFormat, rankedFormats);\n        JSONUtilities.safePut(config, \"rankedFormats\", rankedFormats);\n        \n        JSONUtilities.safePut(config, \"state\", \"ready\");\n        JSONUtilities.safePut(config, \"hasData\", true);\n        config.remove(\"progress\");\n    }"
  },
  {
    "id": 62,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 3,
    "human_patch": "https://github.com/OpenRefine/OpenRefine/commit/e243e73e4064de87a913946bd320fbbe246da656",
    "cve_id": "CVE-2018-19859",
    "cwe_id": "CWE-22",
    "filename": "main/src/com/google/refine/importing/ImportingUtilities.java",
    "is_vulnerable": 0,
    "class_name": "ImportingUtilities",
    "subclass_name": null,
    "function_name": "setProgress(String message, int percent)",
    "function_body": "{\n                        if (message != null) {\n                            JSONUtilities.safePut(progress, \"message\", message);\n                        }\n                        JSONUtilities.safePut(progress, \"percent\", percent);\n                    }"
  },
  {
    "id": 62,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 4,
    "human_patch": "https://github.com/OpenRefine/OpenRefine/commit/e243e73e4064de87a913946bd320fbbe246da656",
    "cve_id": "CVE-2018-19859",
    "cwe_id": "CWE-22",
    "filename": "main/src/com/google/refine/importing/ImportingUtilities.java",
    "is_vulnerable": 0,
    "class_name": "ImportingUtilities",
    "subclass_name": null,
    "function_name": "isCanceled()",
    "function_body": "{\n                        return job.canceled;\n                    }"
  },
  {
    "id": 62,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 5,
    "human_patch": "https://github.com/OpenRefine/OpenRefine/commit/e243e73e4064de87a913946bd320fbbe246da656",
    "cve_id": "CVE-2018-19859",
    "cwe_id": "CWE-22",
    "filename": "main/src/com/google/refine/importing/ImportingUtilities.java",
    "is_vulnerable": 0,
    "class_name": "ImportingUtilities",
    "subclass_name": null,
    "function_name": "updateJobWithNewFileSelection(ImportingJob job, ArrayNode fileSelectionArray)",
    "function_body": "{\n        job.setFileSelection(fileSelectionArray);\n        \n        String bestFormat = ImportingUtilities.getCommonFormatForSelectedFiles(job, fileSelectionArray);\n        bestFormat = ImportingUtilities.guessBetterFormat(job, bestFormat);\n        \n        ArrayNode rankedFormats = ParsingUtilities.mapper.createArrayNode();\n        ImportingUtilities.rankFormats(job, bestFormat, rankedFormats);\n        job.setRankedFormats(rankedFormats);\n    }"
  },
  {
    "id": 62,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 6,
    "human_patch": "https://github.com/OpenRefine/OpenRefine/commit/e243e73e4064de87a913946bd320fbbe246da656",
    "cve_id": "CVE-2018-19859",
    "cwe_id": "CWE-22",
    "filename": "main/src/com/google/refine/importing/ImportingUtilities.java",
    "is_vulnerable": 0,
    "class_name": "ImportingUtilities",
    "subclass_name": null,
    "function_name": "retrieveContentFromPostRequest(\n        HttpServletRequest request,\n        Properties parameters,\n        File rawDataDir,\n        ObjectNode retrievalRecord,\n        final Progress progress\n    ) throws Exception",
    "function_body": "{\n        ArrayNode fileRecords = ParsingUtilities.mapper.createArrayNode();\n        JSONUtilities.safePut(retrievalRecord, \"files\", fileRecords);\n        \n        int clipboardCount = 0;\n        int uploadCount = 0;\n        int downloadCount = 0;\n        int archiveCount = 0;\n        \n        \n        \n        final SavingUpdate update = new SavingUpdate() {\n            @Override\n            public void savedMore() {\n                progress.setProgress(null, calculateProgressPercent(totalExpectedSize, totalRetrievedSize));\n            }\n            @Override\n            public boolean isCanceled() {\n                return progress.isCanceled();\n            }\n        };\n        \n        DiskFileItemFactory fileItemFactory = new DiskFileItemFactory();\n        \n        ServletFileUpload upload = new ServletFileUpload(fileItemFactory);\n        upload.setProgressListener(new ProgressListener() {\n            boolean setContentLength = false;\n            long lastBytesRead = 0;\n            \n            @Override\n            public void update(long bytesRead, long contentLength, int itemCount) {\n                if (!setContentLength) {\n                    \n                    if (contentLength >= 0) {\n                        update.totalExpectedSize += contentLength;\n                        setContentLength = true;\n                    }\n                }\n                if (setContentLength) {\n                    update.totalRetrievedSize += (bytesRead - lastBytesRead);\n                    lastBytesRead = bytesRead;\n                    \n                    update.savedMore();\n                }\n            }\n        });\n\n        @SuppressWarnings(\"unchecked\")\n        List<FileItem> tempFiles = (List<FileItem>)upload.parseRequest(request);\n        \n        progress.setProgress(\"Uploading data ...\", -1);\n        parts: for (FileItem fileItem : tempFiles) {\n            if (progress.isCanceled()) {\n                break;\n            }\n            \n            InputStream stream = fileItem.getInputStream();\n            \n            String name = fileItem.getFieldName().toLowerCase();\n            if (fileItem.isFormField()) {\n                if (name.equals(\"clipboard\")) {\n                    String encoding = request.getCharacterEncoding();\n                    if (encoding == null) {\n                        encoding = \"UTF-8\";\n                    }\n                    \n                    File file = allocateFile(rawDataDir, \"clipboard.txt\");\n                    \n                    ObjectNode fileRecord = ParsingUtilities.mapper.createObjectNode();\n                    JSONUtilities.safePut(fileRecord, \"origin\", \"clipboard\");\n                    JSONUtilities.safePut(fileRecord, \"declaredEncoding\", encoding);\n                    JSONUtilities.safePut(fileRecord, \"declaredMimeType\", (String) null);\n                    JSONUtilities.safePut(fileRecord, \"format\", \"text\");\n                    JSONUtilities.safePut(fileRecord, \"fileName\", \"(clipboard)\");\n                    JSONUtilities.safePut(fileRecord, \"location\", getRelativePath(file, rawDataDir));\n                    \n                    progress.setProgress(\"Uploading pasted clipboard text\",\n                        calculateProgressPercent(update.totalExpectedSize, update.totalRetrievedSize));\n                    \n                    JSONUtilities.safePut(fileRecord, \"size\", saveStreamToFile(stream, file, null));\n                    JSONUtilities.append(fileRecords, fileRecord);\n                    \n                    clipboardCount++;\n                    \n                } else if (name.equals(\"download\")) {\n                    String urlString = Streams.asString(stream);\n                    URL url = new URL(urlString);\n                    \n                    ObjectNode fileRecord = ParsingUtilities.mapper.createObjectNode();\n                    JSONUtilities.safePut(fileRecord, \"origin\", \"download\");\n                    JSONUtilities.safePut(fileRecord, \"url\", urlString);\n                    \n                    for (UrlRewriter rewriter : ImportingManager.urlRewriters) {\n                        Result result = rewriter.rewrite(urlString);\n                        if (result != null) {\n                            urlString = result.rewrittenUrl;\n                            url = new URL(urlString);\n                            \n                            JSONUtilities.safePut(fileRecord, \"url\", urlString);\n                            JSONUtilities.safePut(fileRecord, \"format\", result.format);\n                            if (!result.download) {\n                                downloadCount++;\n                                JSONUtilities.append(fileRecords, fileRecord);\n                                continue parts;\n                            }\n                        }\n                    }\n\n                    if (\"http\".equals(url.getProtocol()) || \"https\".equals(url.getProtocol())) {\n                        DefaultHttpClient client = new DefaultHttpClient();\n                        DecompressingHttpClient httpclient = \n                                new DecompressingHttpClient(client);\n                        HttpGet httpGet = new HttpGet(url.toURI());\n                        httpGet.setHeader(\"User-Agent\", RefineServlet.getUserAgent());\n                        if (\"https\".equals(url.getProtocol())) {\n                            \n                            String userinfo = url.getUserInfo();\n                            if (userinfo != null) {\n                                int s = userinfo.indexOf(':');\n                                if (s > 0) {\n                                    String user = userinfo.substring(0, s);\n                                    String pw = userinfo.substring(s + 1, userinfo.length());\n                                    client.getCredentialsProvider().setCredentials(\n                                            new AuthScope(url.getHost(), 443),\n                                            new UsernamePasswordCredentials(user, pw));\n                                }\n                            }\n                        }\n \n                        HttpResponse response = httpclient.execute(httpGet);\n                        \n                        try {\n                            response.getStatusLine();\n                            HttpEntity entity = response.getEntity();\n                            if (entity == null) {\n                                throw new Exception(\"No content found in \" + url.toString());\n                            }\n                            InputStream stream2 = entity.getContent();\n                            String encoding = null;\n                            if (entity.getContentEncoding() != null) {\n                                encoding = entity.getContentEncoding().getValue();\n                            }\n                            JSONUtilities.safePut(fileRecord, \"declaredEncoding\", encoding);\n                            String contentType = null;\n                            if (entity.getContentType() != null) {\n                                contentType = entity.getContentType().getValue();\n                            }\n                            JSONUtilities.safePut(fileRecord, \"declaredMimeType\", contentType);\n                            if (saveStream(stream2, url, rawDataDir, progress, update, \n                                    fileRecord, fileRecords,\n                                    entity.getContentLength())) {\n                                archiveCount++;\n                            }\n                            downloadCount++;\n                            EntityUtils.consume(entity);\n                        } finally {\n                            httpGet.releaseConnection();\n                        }\n                    } else {\n                        \n                        URLConnection urlConnection = url.openConnection();\n                        urlConnection.setConnectTimeout(5000);\n                        urlConnection.connect();\n                        InputStream stream2 = urlConnection.getInputStream();\n                        JSONUtilities.safePut(fileRecord, \"declaredEncoding\", \n                                urlConnection.getContentEncoding());\n                        JSONUtilities.safePut(fileRecord, \"declaredMimeType\", \n                                urlConnection.getContentType());\n                        try {\n                            if (saveStream(stream2, url, rawDataDir, progress, \n                                    update, fileRecord, fileRecords,\n                                    urlConnection.getContentLength())) {\n                                archiveCount++;\n                            }\n                            downloadCount++;\n                        } finally {\n                            stream2.close();\n                        }\n                    }\n                } else {\n                    String value = Streams.asString(stream);\n                    parameters.put(name, value);\n                    \n\n                    \n                }\n\n            } else { \n                String fileName = fileItem.getName();\n                if (fileName.length() > 0) {\n                    long fileSize = fileItem.getSize();\n                    \n                    File file = allocateFile(rawDataDir, fileName);\n                    \n                    ObjectNode fileRecord = ParsingUtilities.mapper.createObjectNode();\n                    JSONUtilities.safePut(fileRecord, \"origin\", \"upload\");\n                    JSONUtilities.safePut(fileRecord, \"declaredEncoding\", request.getCharacterEncoding());\n                    JSONUtilities.safePut(fileRecord, \"declaredMimeType\", fileItem.getContentType());\n                    JSONUtilities.safePut(fileRecord, \"fileName\", fileName);\n                    JSONUtilities.safePut(fileRecord, \"location\", getRelativePath(file, rawDataDir));\n\n                    progress.setProgress(\n                        \"Saving file \" + fileName + \" locally (\" + formatBytes(fileSize) + \" bytes)\",\n                        calculateProgressPercent(update.totalExpectedSize, update.totalRetrievedSize));\n                    \n                    JSONUtilities.safePut(fileRecord, \"size\", saveStreamToFile(stream, file, null));\n                    if (postProcessRetrievedFile(rawDataDir, file, fileRecord, fileRecords, progress)) {\n                        archiveCount++;\n                    }\n                    \n                    uploadCount++;\n                }\n            }\n            \n            stream.close();\n        }\n        \n        \n        for (FileItem fileItem : tempFiles) {\n            fileItem.delete();\n        }\n        \n        JSONUtilities.safePut(retrievalRecord, \"uploadCount\", uploadCount);\n        JSONUtilities.safePut(retrievalRecord, \"downloadCount\", downloadCount);\n        JSONUtilities.safePut(retrievalRecord, \"clipboardCount\", clipboardCount);\n        JSONUtilities.safePut(retrievalRecord, \"archiveCount\", archiveCount);\n    }"
  },
  {
    "id": 62,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 7,
    "human_patch": "https://github.com/OpenRefine/OpenRefine/commit/e243e73e4064de87a913946bd320fbbe246da656",
    "cve_id": "CVE-2018-19859",
    "cwe_id": "CWE-22",
    "filename": "main/src/com/google/refine/importing/ImportingUtilities.java",
    "is_vulnerable": 0,
    "class_name": "ImportingUtilities",
    "subclass_name": null,
    "function_name": "savedMore()",
    "function_body": "{\n                progress.setProgress(null, calculateProgressPercent(totalExpectedSize, totalRetrievedSize));\n            }"
  },
  {
    "id": 62,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 8,
    "human_patch": "https://github.com/OpenRefine/OpenRefine/commit/e243e73e4064de87a913946bd320fbbe246da656",
    "cve_id": "CVE-2018-19859",
    "cwe_id": "CWE-22",
    "filename": "main/src/com/google/refine/importing/ImportingUtilities.java",
    "is_vulnerable": 1,
    "class_name": "ImportingUtilities",
    "subclass_name": null,
    "function_name": "isCanceled()",
    "function_body": "{\n                return progress.isCanceled();\n            }"
  },
  {
    "id": 62,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 9,
    "human_patch": "https://github.com/OpenRefine/OpenRefine/commit/e243e73e4064de87a913946bd320fbbe246da656",
    "cve_id": "CVE-2018-19859",
    "cwe_id": "CWE-22",
    "filename": "main/src/com/google/refine/importing/ImportingUtilities.java",
    "is_vulnerable": 0,
    "class_name": "ImportingUtilities",
    "subclass_name": null,
    "function_name": "update(long bytesRead, long contentLength, int itemCount)",
    "function_body": "{\n                if (!setContentLength) {\n                    \n                    if (contentLength >= 0) {\n                        update.totalExpectedSize += contentLength;\n                        setContentLength = true;\n                    }\n                }\n                if (setContentLength) {\n                    update.totalRetrievedSize += (bytesRead - lastBytesRead);\n                    lastBytesRead = bytesRead;\n                    \n                    update.savedMore();\n                }\n            }"
  },
  {
    "id": 62,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 10,
    "human_patch": "https://github.com/OpenRefine/OpenRefine/commit/e243e73e4064de87a913946bd320fbbe246da656",
    "cve_id": "CVE-2018-19859",
    "cwe_id": "CWE-22",
    "filename": "main/src/com/google/refine/importing/ImportingUtilities.java",
    "is_vulnerable": 0,
    "class_name": "ImportingUtilities",
    "subclass_name": null,
    "function_name": "saveStream(InputStream stream, URL url, File rawDataDir, final Progress progress,\n            final SavingUpdate update, ObjectNode fileRecord, ArrayNode fileRecords, long length) throws IOException, Exception",
    "function_body": "{\n        String localname = url.getPath();\n        if (localname.isEmpty() || localname.endsWith(\"/\")) {\n            localname = localname + \"temp\";\n        }\n        File file = allocateFile(rawDataDir, localname);\n\n        JSONUtilities.safePut(fileRecord, \"fileName\", file.getName());\n        JSONUtilities.safePut(fileRecord, \"location\", getRelativePath(file, rawDataDir));\n\n        update.totalExpectedSize += length;\n\n        progress.setProgress(\"Downloading \" + url.toString(),\n            calculateProgressPercent(update.totalExpectedSize, update.totalRetrievedSize));\n        \n        long actualLength = saveStreamToFile(stream, file, update);\n        JSONUtilities.safePut(fileRecord, \"size\", actualLength);\n        if (actualLength == 0) {\n            throw new Exception(\"No content found in \" + url.toString());\n        } else if (length >= 0) {\n            update.totalExpectedSize += (actualLength - length);\n        } else {\n            update.totalExpectedSize += actualLength;\n        }\n        progress.setProgress(\"Saving \" + url.toString() + \" locally\",\n            calculateProgressPercent(update.totalExpectedSize, update.totalRetrievedSize));\n        return postProcessRetrievedFile(rawDataDir, file, fileRecord, fileRecords, progress);\n    }"
  },
  {
    "id": 62,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 11,
    "human_patch": "https://github.com/OpenRefine/OpenRefine/commit/e243e73e4064de87a913946bd320fbbe246da656",
    "cve_id": "CVE-2018-19859",
    "cwe_id": "CWE-22",
    "filename": "main/src/com/google/refine/importing/ImportingUtilities.java",
    "is_vulnerable": 0,
    "class_name": "ImportingUtilities",
    "subclass_name": null,
    "function_name": "getRelativePath(File file, File dir)",
    "function_body": "{\n        String location = file.getAbsolutePath().substring(dir.getAbsolutePath().length());\n        return (location.startsWith(File.separator)) ? location.substring(1) : location;\n    }"
  },
  {
    "id": 62,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 12,
    "human_patch": "https://github.com/OpenRefine/OpenRefine/commit/e243e73e4064de87a913946bd320fbbe246da656",
    "cve_id": "CVE-2018-19859",
    "cwe_id": "CWE-22",
    "filename": "main/src/com/google/refine/importing/ImportingUtilities.java",
    "is_vulnerable": 1,
    "class_name": "ImportingUtilities",
    "subclass_name": null,
    "function_name": "allocateFile(File dir, String name)",
    "function_body": "{\n        int q = name.indexOf('?');\n        if (q > 0) {\n            name = name.substring(0, q);\n        }\n        \n        File file = new File(dir, name);\n        \n        int dot = name.indexOf('.');\n        String prefix = dot < 0 ? name : name.substring(0, dot);\n        String suffix = dot < 0 ? \"\" : name.substring(dot);\n        int index = 2;\n        while (file.exists()) {\n            file = new File(dir, prefix + \"-\" + index++ + suffix);\n        }\n        \n        file.getParentFile().mkdirs();\n        \n        return file;\n    }"
  },
  {
    "id": 62,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 13,
    "human_patch": "https://github.com/OpenRefine/OpenRefine/commit/e243e73e4064de87a913946bd320fbbe246da656",
    "cve_id": "CVE-2018-19859",
    "cwe_id": "CWE-22",
    "filename": "main/src/com/google/refine/importing/ImportingUtilities.java",
    "is_vulnerable": 0,
    "class_name": "ImportingUtilities",
    "subclass_name": null,
    "function_name": "getFileReader(ImportingJob job, ObjectNode fileRecord, String commonEncoding) throws FileNotFoundException",
    "function_body": "{\n        \n        return getFileReader(getFile(job, JSONUtilities.getString(fileRecord, \"location\", \"\")), fileRecord, commonEncoding);\n    }"
  },
  {
    "id": 62,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 14,
    "human_patch": "https://github.com/OpenRefine/OpenRefine/commit/e243e73e4064de87a913946bd320fbbe246da656",
    "cve_id": "CVE-2018-19859",
    "cwe_id": "CWE-22",
    "filename": "main/src/com/google/refine/importing/ImportingUtilities.java",
    "is_vulnerable": 0,
    "class_name": "ImportingUtilities",
    "subclass_name": null,
    "function_name": "getFileReader(File file, ObjectNode fileRecord, String commonEncoding) throws FileNotFoundException",
    "function_body": "{\n        return getReaderFromStream(new FileInputStream(file), fileRecord, commonEncoding);\n    }"
  },
  {
    "id": 62,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 15,
    "human_patch": "https://github.com/OpenRefine/OpenRefine/commit/e243e73e4064de87a913946bd320fbbe246da656",
    "cve_id": "CVE-2018-19859",
    "cwe_id": "CWE-22",
    "filename": "main/src/com/google/refine/importing/ImportingUtilities.java",
    "is_vulnerable": 0,
    "class_name": "ImportingUtilities",
    "subclass_name": null,
    "function_name": "getReaderFromStream(InputStream inputStream, ObjectNode fileRecord, String commonEncoding)",
    "function_body": "{\n        String encoding = getEncoding(fileRecord);\n        if (encoding == null) {\n            encoding = commonEncoding;\n        }\n        if (encoding != null) {\n            try {\n                return new InputStreamReader(inputStream, encoding);\n            } catch (UnsupportedEncodingException e) {\n                \n            }\n        }\n        return new InputStreamReader(inputStream);\n    }"
  },
  {
    "id": 62,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 16,
    "human_patch": "https://github.com/OpenRefine/OpenRefine/commit/e243e73e4064de87a913946bd320fbbe246da656",
    "cve_id": "CVE-2018-19859",
    "cwe_id": "CWE-22",
    "filename": "main/src/com/google/refine/importing/ImportingUtilities.java",
    "is_vulnerable": 0,
    "class_name": "ImportingUtilities",
    "subclass_name": null,
    "function_name": "getFile(ImportingJob job, ObjectNode fileRecord)",
    "function_body": "{\n        return getFile(job, JSONUtilities.getString(fileRecord, \"location\", \"\"));\n    }"
  },
  {
    "id": 62,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 17,
    "human_patch": "https://github.com/OpenRefine/OpenRefine/commit/e243e73e4064de87a913946bd320fbbe246da656",
    "cve_id": "CVE-2018-19859",
    "cwe_id": "CWE-22",
    "filename": "main/src/com/google/refine/importing/ImportingUtilities.java",
    "is_vulnerable": 0,
    "class_name": "ImportingUtilities",
    "subclass_name": null,
    "function_name": "getFile(ImportingJob job, String location)",
    "function_body": "{\n        return new File(job.getRawDataDir(), location);\n    }"
  },
  {
    "id": 62,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 18,
    "human_patch": "https://github.com/OpenRefine/OpenRefine/commit/e243e73e4064de87a913946bd320fbbe246da656",
    "cve_id": "CVE-2018-19859",
    "cwe_id": "CWE-22",
    "filename": "main/src/com/google/refine/importing/ImportingUtilities.java",
    "is_vulnerable": 0,
    "class_name": "ImportingUtilities",
    "subclass_name": null,
    "function_name": "getFileSource(ObjectNode fileRecord)",
    "function_body": "{\n        return JSONUtilities.getString(\n            fileRecord,\n            \"url\",\n            JSONUtilities.getString(fileRecord, \"fileName\", \"unknown\")\n        );\n    }"
  },
  {
    "id": 62,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 19,
    "human_patch": "https://github.com/OpenRefine/OpenRefine/commit/e243e73e4064de87a913946bd320fbbe246da656",
    "cve_id": "CVE-2018-19859",
    "cwe_id": "CWE-22",
    "filename": "main/src/com/google/refine/importing/ImportingUtilities.java",
    "is_vulnerable": 0,
    "class_name": "ImportingUtilities",
    "subclass_name": "SavingUpdate",
    "function_name": "savedMore()",
    "function_body": null
  },
  {
    "id": 62,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 20,
    "human_patch": "https://github.com/OpenRefine/OpenRefine/commit/e243e73e4064de87a913946bd320fbbe246da656",
    "cve_id": "CVE-2018-19859",
    "cwe_id": "CWE-22",
    "filename": "main/src/com/google/refine/importing/ImportingUtilities.java",
    "is_vulnerable": 0,
    "class_name": "ImportingUtilities",
    "subclass_name": "SavingUpdate",
    "function_name": "isCanceled()",
    "function_body": null
  },
  {
    "id": 62,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 21,
    "human_patch": "https://github.com/OpenRefine/OpenRefine/commit/e243e73e4064de87a913946bd320fbbe246da656",
    "cve_id": "CVE-2018-19859",
    "cwe_id": "CWE-22",
    "filename": "main/src/com/google/refine/importing/ImportingUtilities.java",
    "is_vulnerable": 0,
    "class_name": "ImportingUtilities",
    "subclass_name": null,
    "function_name": "saveStreamToFile(InputStream stream, File file, SavingUpdate update) throws IOException",
    "function_body": "{\n        long length = 0;\n        FileOutputStream fos = new FileOutputStream(file);\n        try {\n            byte[] bytes = new byte[16*1024];\n            int c;\n            while ((update == null || !update.isCanceled()) && (c = stream.read(bytes)) > 0) {\n                fos.write(bytes, 0, c);\n                length += c;\n\n                if (update != null) {\n                    update.totalRetrievedSize += c;\n                    update.savedMore();\n                }\n            }\n            return length;\n        } finally {\n            fos.close();\n        }\n    }"
  },
  {
    "id": 62,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 22,
    "human_patch": "https://github.com/OpenRefine/OpenRefine/commit/e243e73e4064de87a913946bd320fbbe246da656",
    "cve_id": "CVE-2018-19859",
    "cwe_id": "CWE-22",
    "filename": "main/src/com/google/refine/importing/ImportingUtilities.java",
    "is_vulnerable": 0,
    "class_name": "ImportingUtilities",
    "subclass_name": null,
    "function_name": "postProcessRetrievedFile(\n            File rawDataDir, File file, ObjectNode fileRecord, ArrayNode fileRecords, final Progress progress)",
    "function_body": "{\n        \n        String mimeType = JSONUtilities.getString(fileRecord, \"declaredMimeType\", null);\n        String contentEncoding = JSONUtilities.getString(fileRecord, \"declaredEncoding\", null);\n        \n        InputStream archiveIS = tryOpenAsArchive(file, mimeType, contentEncoding);\n        if (archiveIS != null) {\n            try {\n                if (explodeArchive(rawDataDir, archiveIS, fileRecord, fileRecords, progress)) {\n                    file.delete();\n                    return true;\n                }\n            } finally {\n                try {\n                    archiveIS.close();\n                } catch (IOException e) {\n                    \n                }\n            }\n        }\n        \n        InputStream uncompressedIS = tryOpenAsCompressedFile(file, mimeType, contentEncoding);\n        if (uncompressedIS != null) {\n            try {\n                File file2 = uncompressFile(rawDataDir, uncompressedIS, fileRecord, progress);\n                \n                file.delete();\n                file = file2;\n            } catch (IOException e) {\n                \n                e.printStackTrace();\n            } finally {\n                try {\n                    uncompressedIS.close();\n                } catch (IOException e) {\n                    \n                }\n            }\n        }\n        \n        postProcessSingleRetrievedFile(file, fileRecord);\n        JSONUtilities.append(fileRecords, fileRecord);\n        \n        return false;\n    }"
  },
  {
    "id": 62,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 23,
    "human_patch": "https://github.com/OpenRefine/OpenRefine/commit/e243e73e4064de87a913946bd320fbbe246da656",
    "cve_id": "CVE-2018-19859",
    "cwe_id": "CWE-22",
    "filename": "main/src/com/google/refine/importing/ImportingUtilities.java",
    "is_vulnerable": 0,
    "class_name": "ImportingUtilities",
    "subclass_name": null,
    "function_name": "postProcessSingleRetrievedFile(File file, ObjectNode fileRecord)",
    "function_body": "{\n        if (!fileRecord.has(\"format\")) {\n            JSONUtilities.safePut(fileRecord, \"format\",\n                ImportingManager.getFormat(\n                    file.getName(),\n                    JSONUtilities.getString(fileRecord, \"declaredMimeType\", null)));\n        }\n    }"
  },
  {
    "id": 62,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 24,
    "human_patch": "https://github.com/OpenRefine/OpenRefine/commit/e243e73e4064de87a913946bd320fbbe246da656",
    "cve_id": "CVE-2018-19859",
    "cwe_id": "CWE-22",
    "filename": "main/src/com/google/refine/importing/ImportingUtilities.java",
    "is_vulnerable": 0,
    "class_name": "ImportingUtilities",
    "subclass_name": null,
    "function_name": "tryOpenAsArchive(File file, String mimeType)",
    "function_body": "{\n        return tryOpenAsArchive(file, mimeType, null);\n    }"
  },
  {
    "id": 62,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 25,
    "human_patch": "https://github.com/OpenRefine/OpenRefine/commit/e243e73e4064de87a913946bd320fbbe246da656",
    "cve_id": "CVE-2018-19859",
    "cwe_id": "CWE-22",
    "filename": "main/src/com/google/refine/importing/ImportingUtilities.java",
    "is_vulnerable": 0,
    "class_name": "ImportingUtilities",
    "subclass_name": null,
    "function_name": "tryOpenAsArchive(File file, String mimeType, String contentType)",
    "function_body": "{\n        String fileName = file.getName();\n        try {\n            if (fileName.endsWith(\".tar.gz\") || fileName.endsWith(\".tgz\")) {\n                return new TarInputStream(new GZIPInputStream(new FileInputStream(file)));\n            } else if (fileName.endsWith(\".tar.bz2\")) {\n                return new TarInputStream(new CBZip2InputStream(new FileInputStream(file)));\n            } else if (fileName.endsWith(\".tar\") || \"application/x-tar\".equals(contentType)) {\n                return new TarInputStream(new FileInputStream(file));\n            } else if (fileName.endsWith(\".zip\") \n                    || \"application/x-zip-compressed\".equals(contentType)\n                    || \"application/zip\".equals(contentType) \n                    || \"application/x-compressed\".equals(contentType)\n                    || \"multipar/x-zip\".equals(contentType)) {\n                return new ZipInputStream(new FileInputStream(file));\n            } else if (fileName.endsWith(\".kmz\")) {\n                return new ZipInputStream(new FileInputStream(file));\n            }\n        } catch (IOException e) {\n        }\n        return null;\n    }"
  },
  {
    "id": 62,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 26,
    "human_patch": "https://github.com/OpenRefine/OpenRefine/commit/e243e73e4064de87a913946bd320fbbe246da656",
    "cve_id": "CVE-2018-19859",
    "cwe_id": "CWE-22",
    "filename": "main/src/com/google/refine/importing/ImportingUtilities.java",
    "is_vulnerable": 0,
    "class_name": "ImportingUtilities",
    "subclass_name": null,
    "function_name": "explodeArchive(\n        File rawDataDir,\n        InputStream archiveIS,\n        ObjectNode archiveFileRecord,\n        ArrayNode fileRecords,\n        final Progress progress\n    )",
    "function_body": "{\n        if (archiveIS instanceof TarInputStream) {\n            TarInputStream tis = (TarInputStream) archiveIS;\n            try {\n                TarEntry te;\n                while (!progress.isCanceled() && (te = tis.getNextEntry()) != null) {\n                    if (!te.isDirectory()) {\n                        String fileName2 = te.getName();\n                        File file2 = allocateFile(rawDataDir, fileName2);\n                        \n                        progress.setProgress(\"Extracting \" + fileName2, -1);\n                        \n                        ObjectNode fileRecord2 = ParsingUtilities.mapper.createObjectNode();\n                        JSONUtilities.safePut(fileRecord2, \"origin\", JSONUtilities.getString(archiveFileRecord, \"origin\", null));\n                        JSONUtilities.safePut(fileRecord2, \"declaredEncoding\", (String) null);\n                        JSONUtilities.safePut(fileRecord2, \"declaredMimeType\", (String) null);\n                        JSONUtilities.safePut(fileRecord2, \"fileName\", fileName2);\n                        JSONUtilities.safePut(fileRecord2, \"archiveFileName\", JSONUtilities.getString(archiveFileRecord, \"fileName\", null));\n                        JSONUtilities.safePut(fileRecord2, \"location\", getRelativePath(file2, rawDataDir));\n\n                        JSONUtilities.safePut(fileRecord2, \"size\", saveStreamToFile(tis, file2, null));\n                        postProcessSingleRetrievedFile(file2, fileRecord2);\n                        \n                        JSONUtilities.append(fileRecords, fileRecord2);\n                    }\n                }\n            } catch (IOException e) {\n                \n                e.printStackTrace();\n            }\n            return true;\n        } else if (archiveIS instanceof ZipInputStream) {\n            ZipInputStream zis = (ZipInputStream) archiveIS;\n            try {\n                ZipEntry ze;\n                while (!progress.isCanceled() && (ze = zis.getNextEntry()) != null) {\n                    if (!ze.isDirectory()) {\n                        String fileName2 = ze.getName();\n                        File file2 = allocateFile(rawDataDir, fileName2);\n                        \n                        progress.setProgress(\"Extracting \" + fileName2, -1);\n                        \n                        ObjectNode fileRecord2 = ParsingUtilities.mapper.createObjectNode();\n                        JSONUtilities.safePut(fileRecord2, \"origin\", JSONUtilities.getString(archiveFileRecord, \"origin\", null));\n                        JSONUtilities.safePut(fileRecord2, \"declaredEncoding\", (String) null);\n                        JSONUtilities.safePut(fileRecord2, \"declaredMimeType\", (String) null);\n                        JSONUtilities.safePut(fileRecord2, \"fileName\", fileName2);\n                        JSONUtilities.safePut(fileRecord2, \"archiveFileName\", JSONUtilities.getString(archiveFileRecord, \"fileName\", null));\n                        JSONUtilities.safePut(fileRecord2, \"location\", getRelativePath(file2, rawDataDir));\n\n                        JSONUtilities.safePut(fileRecord2, \"size\", saveStreamToFile(zis, file2, null));\n                        postProcessSingleRetrievedFile(file2, fileRecord2);\n                        \n                        JSONUtilities.append(fileRecords, fileRecord2);\n                    }\n                }\n            } catch (IOException e) {\n                \n                e.printStackTrace();\n            }\n            return true;\n        }\n        return false;\n    }"
  },
  {
    "id": 62,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 27,
    "human_patch": "https://github.com/OpenRefine/OpenRefine/commit/e243e73e4064de87a913946bd320fbbe246da656",
    "cve_id": "CVE-2018-19859",
    "cwe_id": "CWE-22",
    "filename": "main/src/com/google/refine/importing/ImportingUtilities.java",
    "is_vulnerable": 0,
    "class_name": "ImportingUtilities",
    "subclass_name": null,
    "function_name": "tryOpenAsCompressedFile(File file, String mimeType)",
    "function_body": "{\n        return tryOpenAsCompressedFile(file, mimeType, null);\n    }"
  },
  {
    "id": 62,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 28,
    "human_patch": "https://github.com/OpenRefine/OpenRefine/commit/e243e73e4064de87a913946bd320fbbe246da656",
    "cve_id": "CVE-2018-19859",
    "cwe_id": "CWE-22",
    "filename": "main/src/com/google/refine/importing/ImportingUtilities.java",
    "is_vulnerable": 0,
    "class_name": "ImportingUtilities",
    "subclass_name": null,
    "function_name": "tryOpenAsCompressedFile(File file, String mimeType, String contentEncoding)",
    "function_body": "{\n        String fileName = file.getName();\n        try {\n            if (fileName.endsWith(\".gz\") \n                    || \"gzip\".equals(contentEncoding) \n                    || \"x-gzip\".equals(contentEncoding)\n                    || \"application/x-gzip\".equals(mimeType)) {                \n                return new GZIPInputStream(new FileInputStream(file));\n            } else if (fileName.endsWith(\".bz2\")\n                    ||\"application/x-bzip2\".equals(mimeType)) {\n                InputStream is = new FileInputStream(file);\n                is.mark(4);\n                if (!(is.read() == 'B' && is.read() == 'Z')) {\n                    \n                    is.reset();\n                }\n                return new CBZip2InputStream(is);\n            }\n        } catch (IOException e) {\n            logger.warn(\"Something that looked like a compressed file gave an error on open: \"+file,e);\n        }\n        return null;\n    }"
  },
  {
    "id": 62,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 29,
    "human_patch": "https://github.com/OpenRefine/OpenRefine/commit/e243e73e4064de87a913946bd320fbbe246da656",
    "cve_id": "CVE-2018-19859",
    "cwe_id": "CWE-22",
    "filename": "main/src/com/google/refine/importing/ImportingUtilities.java",
    "is_vulnerable": 0,
    "class_name": "ImportingUtilities",
    "subclass_name": null,
    "function_name": "uncompressFile(\n        File rawDataDir,\n        InputStream uncompressedIS,\n        ObjectNode fileRecord,\n        final Progress progress\n    ) throws IOException",
    "function_body": "{\n        String fileName = JSONUtilities.getString(fileRecord, \"location\", \"unknown\");\n        for (String ext : new String[] {\".gz\",\".bz2\"}) {\n            if (fileName.endsWith(ext)) {\n                fileName = fileName.substring(0, fileName.length()-ext.length());\n                break;\n            }\n        }\n        File file2 = allocateFile(rawDataDir, fileName);\n        \n        progress.setProgress(\"Uncompressing \" + fileName, -1);\n        \n        saveStreamToFile(uncompressedIS, file2, null);\n        \n        JSONUtilities.safePut(fileRecord, \"declaredEncoding\", (String) null);\n        JSONUtilities.safePut(fileRecord, \"declaredMimeType\", (String) null);\n        JSONUtilities.safePut(fileRecord, \"location\", getRelativePath(file2, rawDataDir));\n        \n        return file2;\n    }"
  },
  {
    "id": 62,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 30,
    "human_patch": "https://github.com/OpenRefine/OpenRefine/commit/e243e73e4064de87a913946bd320fbbe246da656",
    "cve_id": "CVE-2018-19859",
    "cwe_id": "CWE-22",
    "filename": "main/src/com/google/refine/importing/ImportingUtilities.java",
    "is_vulnerable": 0,
    "class_name": "ImportingUtilities",
    "subclass_name": null,
    "function_name": "calculateProgressPercent(long totalExpectedSize, long totalRetrievedSize)",
    "function_body": "{\n        return totalExpectedSize == 0 ? -1 : (int) (totalRetrievedSize * 100 / totalExpectedSize);\n    }"
  },
  {
    "id": 62,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 31,
    "human_patch": "https://github.com/OpenRefine/OpenRefine/commit/e243e73e4064de87a913946bd320fbbe246da656",
    "cve_id": "CVE-2018-19859",
    "cwe_id": "CWE-22",
    "filename": "main/src/com/google/refine/importing/ImportingUtilities.java",
    "is_vulnerable": 0,
    "class_name": "ImportingUtilities",
    "subclass_name": null,
    "function_name": "formatBytes(long bytes)",
    "function_body": "{\n        return NumberFormat.getIntegerInstance().format(bytes);\n    }"
  },
  {
    "id": 62,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 32,
    "human_patch": "https://github.com/OpenRefine/OpenRefine/commit/e243e73e4064de87a913946bd320fbbe246da656",
    "cve_id": "CVE-2018-19859",
    "cwe_id": "CWE-22",
    "filename": "main/src/com/google/refine/importing/ImportingUtilities.java",
    "is_vulnerable": 0,
    "class_name": "ImportingUtilities",
    "subclass_name": null,
    "function_name": "getEncoding(ObjectNode firstFileRecord)",
    "function_body": "{\n        String encoding = JSONUtilities.getString(firstFileRecord, \"encoding\", null);\n        if (encoding == null || encoding.isEmpty()) {\n            encoding = JSONUtilities.getString(firstFileRecord, \"declaredEncoding\", null);\n        }\n        return encoding;\n    }"
  },
  {
    "id": 62,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 33,
    "human_patch": "https://github.com/OpenRefine/OpenRefine/commit/e243e73e4064de87a913946bd320fbbe246da656",
    "cve_id": "CVE-2018-19859",
    "cwe_id": "CWE-22",
    "filename": "main/src/com/google/refine/importing/ImportingUtilities.java",
    "is_vulnerable": 0,
    "class_name": "ImportingUtilities",
    "subclass_name": null,
    "function_name": "autoSelectFiles(ImportingJob job, ObjectNode retrievalRecord, ArrayNode fileSelectionIndexes)",
    "function_body": "{\n        final Map<String, Integer> formatToCount = new HashMap<String, Integer>();\n        List<String> formats = new ArrayList<String>();\n        \n        ArrayNode fileRecords = JSONUtilities.getArray(retrievalRecord, \"files\");\n        int count = fileRecords.size();\n        for (int i = 0; i < count; i++) {\n            ObjectNode fileRecord = JSONUtilities.getObjectElement(fileRecords, i);\n            String format = JSONUtilities.getString(fileRecord, \"format\", null);\n            if (format != null) {\n                if (formatToCount.containsKey(format)) {\n                    formatToCount.put(format, formatToCount.get(format) + 1);\n                } else {\n                    formatToCount.put(format, 1);\n                    formats.add(format);\n                }\n            }\n        }\n        Collections.sort(formats, new Comparator<String>() {\n            @Override\n            public int compare(String o1, String o2) {\n                return formatToCount.get(o2) - formatToCount.get(o1);\n            }\n        });\n        \n        \n        String bestFormat = formats.size() > 0 ? formats.get(0) : \"text/line-based\";\n        if (JSONUtilities.getInt(retrievalRecord, \"archiveCount\", 0) == 0) {\n            \n            for (int i = 0; i < count; i++) {\n                JSONUtilities.append(fileSelectionIndexes, i);\n            }\n        } else {\n            \n            for (int i = 0; i < count; i++) {\n                ObjectNode fileRecord = JSONUtilities.getObjectElement(fileRecords, i);\n                String format = JSONUtilities.getString(fileRecord, \"format\", null);\n                if (format != null && format.equals(bestFormat)) {\n                    JSONUtilities.append(fileSelectionIndexes, i);\n                }\n            }\n            \n            \n            \n            if (fileSelectionIndexes.size() == 0 && count > 0) {\n                for (int i = 0; i < count; i++) {\n                    JSONUtilities.append(fileSelectionIndexes, i);\n                }\n            }\n        }\n        return bestFormat;\n    }"
  },
  {
    "id": 62,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 34,
    "human_patch": "https://github.com/OpenRefine/OpenRefine/commit/e243e73e4064de87a913946bd320fbbe246da656",
    "cve_id": "CVE-2018-19859",
    "cwe_id": "CWE-22",
    "filename": "main/src/com/google/refine/importing/ImportingUtilities.java",
    "is_vulnerable": 0,
    "class_name": "ImportingUtilities",
    "subclass_name": null,
    "function_name": "compare(String o1, String o2)",
    "function_body": "{\n                return formatToCount.get(o2) - formatToCount.get(o1);\n            }"
  },
  {
    "id": 62,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 35,
    "human_patch": "https://github.com/OpenRefine/OpenRefine/commit/e243e73e4064de87a913946bd320fbbe246da656",
    "cve_id": "CVE-2018-19859",
    "cwe_id": "CWE-22",
    "filename": "main/src/com/google/refine/importing/ImportingUtilities.java",
    "is_vulnerable": 0,
    "class_name": "ImportingUtilities",
    "subclass_name": null,
    "function_name": "getCommonFormatForSelectedFiles(ImportingJob job, ArrayNode fileSelectionIndexes)",
    "function_body": "{\n        ObjectNode retrievalRecord = job.getRetrievalRecord();\n        \n        final Map<String, Integer> formatToCount = new HashMap<String, Integer>();\n        List<String> formats = new ArrayList<String>();\n        \n        ArrayNode fileRecords = JSONUtilities.getArray(retrievalRecord, \"files\");\n        int count = fileSelectionIndexes.size();\n        for (int i = 0; i < count; i++) {\n            int index = JSONUtilities.getIntElement(fileSelectionIndexes, i, -1);\n            if (index >= 0 && index < fileRecords.size()) {\n                ObjectNode fileRecord = JSONUtilities.getObjectElement(fileRecords, index);\n                String format = JSONUtilities.getString(fileRecord, \"format\", null);\n                if (format != null) {\n                    if (formatToCount.containsKey(format)) {\n                        formatToCount.put(format, formatToCount.get(format) + 1);\n                    } else {\n                        formatToCount.put(format, 1);\n                        formats.add(format);\n                    }\n                }\n            }\n        }\n        Collections.sort(formats, new Comparator<String>() {\n            @Override\n            public int compare(String o1, String o2) {\n                return formatToCount.get(o2) - formatToCount.get(o1);\n            }\n        });\n        \n        return formats.size() > 0 ? formats.get(0) : null;\n    }"
  },
  {
    "id": 62,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 36,
    "human_patch": "https://github.com/OpenRefine/OpenRefine/commit/e243e73e4064de87a913946bd320fbbe246da656",
    "cve_id": "CVE-2018-19859",
    "cwe_id": "CWE-22",
    "filename": "main/src/com/google/refine/importing/ImportingUtilities.java",
    "is_vulnerable": 0,
    "class_name": "ImportingUtilities",
    "subclass_name": null,
    "function_name": "compare(String o1, String o2)",
    "function_body": "{\n                return formatToCount.get(o2) - formatToCount.get(o1);\n            }"
  },
  {
    "id": 62,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 37,
    "human_patch": "https://github.com/OpenRefine/OpenRefine/commit/e243e73e4064de87a913946bd320fbbe246da656",
    "cve_id": "CVE-2018-19859",
    "cwe_id": "CWE-22",
    "filename": "main/src/com/google/refine/importing/ImportingUtilities.java",
    "is_vulnerable": 0,
    "class_name": "ImportingUtilities",
    "subclass_name": null,
    "function_name": "guessBetterFormat(ImportingJob job, String bestFormat)",
    "function_body": "{\n        ObjectNode retrievalRecord = job.getRetrievalRecord();\n        return retrievalRecord != null ? guessBetterFormat(job, retrievalRecord, bestFormat) : bestFormat;\n    }"
  },
  {
    "id": 62,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 38,
    "human_patch": "https://github.com/OpenRefine/OpenRefine/commit/e243e73e4064de87a913946bd320fbbe246da656",
    "cve_id": "CVE-2018-19859",
    "cwe_id": "CWE-22",
    "filename": "main/src/com/google/refine/importing/ImportingUtilities.java",
    "is_vulnerable": 0,
    "class_name": "ImportingUtilities",
    "subclass_name": null,
    "function_name": "guessBetterFormat(ImportingJob job, ObjectNode retrievalRecord, String bestFormat)",
    "function_body": "{\n        ArrayNode fileRecords = JSONUtilities.getArray(retrievalRecord, \"files\");\n        return fileRecords != null ? guessBetterFormat(job, fileRecords, bestFormat) : bestFormat;\n    }"
  },
  {
    "id": 62,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 39,
    "human_patch": "https://github.com/OpenRefine/OpenRefine/commit/e243e73e4064de87a913946bd320fbbe246da656",
    "cve_id": "CVE-2018-19859",
    "cwe_id": "CWE-22",
    "filename": "main/src/com/google/refine/importing/ImportingUtilities.java",
    "is_vulnerable": 0,
    "class_name": "ImportingUtilities",
    "subclass_name": null,
    "function_name": "guessBetterFormat(ImportingJob job, ArrayNode fileRecords, String bestFormat)",
    "function_body": "{\n        if (bestFormat != null && fileRecords != null && fileRecords.size() > 0) {\n            ObjectNode firstFileRecord = JSONUtilities.getObjectElement(fileRecords, 0);\n            String encoding = getEncoding(firstFileRecord);\n            String location = JSONUtilities.getString(firstFileRecord, \"location\", null);\n            \n            if (location != null) {\n                File file = new File(job.getRawDataDir(), location);\n                \n                while (true) {\n                    String betterFormat = null;\n                    \n                    List<FormatGuesser> guessers = ImportingManager.formatToGuessers.get(bestFormat);\n                    if (guessers != null) {\n                        for (FormatGuesser guesser : guessers) {\n                            betterFormat = guesser.guess(file, encoding, bestFormat);\n                            if (betterFormat != null) {\n                                break;\n                            }\n                        }\n                    }\n                    \n                    if (betterFormat != null && !betterFormat.equals(bestFormat)) {\n                        bestFormat = betterFormat;\n                    } else {\n                        break;\n                    }\n                }\n            }\n        }\n        return bestFormat;\n    }"
  },
  {
    "id": 62,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 40,
    "human_patch": "https://github.com/OpenRefine/OpenRefine/commit/e243e73e4064de87a913946bd320fbbe246da656",
    "cve_id": "CVE-2018-19859",
    "cwe_id": "CWE-22",
    "filename": "main/src/com/google/refine/importing/ImportingUtilities.java",
    "is_vulnerable": 0,
    "class_name": "ImportingUtilities",
    "subclass_name": null,
    "function_name": "rankFormats(ImportingJob job, final String bestFormat, ArrayNode rankedFormats)",
    "function_body": "{\n        final Map<String, String[]> formatToSegments = new HashMap<String, String[]>();\n        \n        boolean download = bestFormat == null ? true :\n            ImportingManager.formatToRecord.get(bestFormat).download;\n        \n        List<String> formats = new ArrayList<String>(ImportingManager.formatToRecord.keySet().size());\n        for (String format : ImportingManager.formatToRecord.keySet()) {\n            Format record = ImportingManager.formatToRecord.get(format);\n            if (record.uiClass != null && record.parser != null && record.download == download) {\n                formats.add(format);\n                formatToSegments.put(format, format.split(\"/\"));\n            }\n        }\n        \n        if (bestFormat == null) {\n            Collections.sort(formats);\n        } else {\n            Collections.sort(formats, new Comparator<String>() {\n                @Override\n                public int compare(String format1, String format2) {\n                    if (format1.equals(bestFormat)) {\n                        return -1;\n                    } else if (format2.equals(bestFormat)) {\n                        return 1;\n                    } else {\n                        return compareBySegments(format1, format2);\n                    }\n                }\n                \n                int compareBySegments(String format1, String format2) {\n                    int c = commonSegments(format2) - commonSegments(format1);\n                    return c != 0 ? c : format1.compareTo(format2);\n                }\n                \n                int commonSegments(String format) {\n                    String[] bestSegments = formatToSegments.get(bestFormat);\n                    String[] segments = formatToSegments.get(format);\n                    if (bestSegments == null || segments == null) {\n                        return 0;\n                    } else {\n                        int i;\n                        for (i = 0; i < bestSegments.length && i < segments.length; i++) {\n                            if (!bestSegments[i].equals(segments[i])) {\n                                break;\n                            }\n                        }\n                        return i;\n                    }\n                }\n            });\n        }\n        \n        for (String format : formats) {\n            rankedFormats.add(format);\n        }\n    }"
  },
  {
    "id": 62,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 41,
    "human_patch": "https://github.com/OpenRefine/OpenRefine/commit/e243e73e4064de87a913946bd320fbbe246da656",
    "cve_id": "CVE-2018-19859",
    "cwe_id": "CWE-22",
    "filename": "main/src/com/google/refine/importing/ImportingUtilities.java",
    "is_vulnerable": 0,
    "class_name": "ImportingUtilities",
    "subclass_name": null,
    "function_name": "compare(String format1, String format2)",
    "function_body": "{\n                    if (format1.equals(bestFormat)) {\n                        return -1;\n                    } else if (format2.equals(bestFormat)) {\n                        return 1;\n                    } else {\n                        return compareBySegments(format1, format2);\n                    }\n                }"
  },
  {
    "id": 62,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 42,
    "human_patch": "https://github.com/OpenRefine/OpenRefine/commit/e243e73e4064de87a913946bd320fbbe246da656",
    "cve_id": "CVE-2018-19859",
    "cwe_id": "CWE-22",
    "filename": "main/src/com/google/refine/importing/ImportingUtilities.java",
    "is_vulnerable": 0,
    "class_name": "ImportingUtilities",
    "subclass_name": null,
    "function_name": "compareBySegments(String format1, String format2)",
    "function_body": "{\n                    int c = commonSegments(format2) - commonSegments(format1);\n                    return c != 0 ? c : format1.compareTo(format2);\n                }"
  },
  {
    "id": 62,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 43,
    "human_patch": "https://github.com/OpenRefine/OpenRefine/commit/e243e73e4064de87a913946bd320fbbe246da656",
    "cve_id": "CVE-2018-19859",
    "cwe_id": "CWE-22",
    "filename": "main/src/com/google/refine/importing/ImportingUtilities.java",
    "is_vulnerable": 0,
    "class_name": "ImportingUtilities",
    "subclass_name": null,
    "function_name": "commonSegments(String format)",
    "function_body": "{\n                    String[] bestSegments = formatToSegments.get(bestFormat);\n                    String[] segments = formatToSegments.get(format);\n                    if (bestSegments == null || segments == null) {\n                        return 0;\n                    } else {\n                        int i;\n                        for (i = 0; i < bestSegments.length && i < segments.length; i++) {\n                            if (!bestSegments[i].equals(segments[i])) {\n                                break;\n                            }\n                        }\n                        return i;\n                    }\n                }"
  },
  {
    "id": 62,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 44,
    "human_patch": "https://github.com/OpenRefine/OpenRefine/commit/e243e73e4064de87a913946bd320fbbe246da656",
    "cve_id": "CVE-2018-19859",
    "cwe_id": "CWE-22",
    "filename": "main/src/com/google/refine/importing/ImportingUtilities.java",
    "is_vulnerable": 0,
    "class_name": "ImportingUtilities",
    "subclass_name": null,
    "function_name": "previewParse(ImportingJob job, String format, ObjectNode optionObj, List<Exception> exceptions)",
    "function_body": "{\n        Format record = ImportingManager.formatToRecord.get(format);\n        if (record == null || record.parser == null) {\n            \n            return;\n        }\n        \n        job.prepareNewProject();\n        \n        record.parser.parse(\n            job.project,\n            job.metadata,\n            job,\n            job.getSelectedFileRecords(),\n            format,\n            100,\n            optionObj,\n            exceptions\n        );\n        \n        job.project.update(); \n    }"
  },
  {
    "id": 62,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 45,
    "human_patch": "https://github.com/OpenRefine/OpenRefine/commit/e243e73e4064de87a913946bd320fbbe246da656",
    "cve_id": "CVE-2018-19859",
    "cwe_id": "CWE-22",
    "filename": "main/src/com/google/refine/importing/ImportingUtilities.java",
    "is_vulnerable": 0,
    "class_name": "ImportingUtilities",
    "subclass_name": null,
    "function_name": "createProject(\n            final ImportingJob job,\n            final String format,\n            final ObjectNode optionObj,\n            final List<Exception> exceptions,\n            boolean synchronous)",
    "function_body": "{\n        final Format record = ImportingManager.formatToRecord.get(format);\n        if (record == null || record.parser == null) {\n            \n            return -1;\n        }\n        \n        job.setState(\"creating-project\");\n        \n        final Project project = new Project();\n        if (synchronous) {\n            createProjectSynchronously(\n                job, format, optionObj, exceptions, record, project);\n        } else {\n            new Thread() {\n                @Override\n                public void run() {\n                    createProjectSynchronously(\n                        job, format, optionObj, exceptions, record, project);\n                }\n            }.start();\n        }\n        return project.id;\n    }"
  },
  {
    "id": 62,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 46,
    "human_patch": "https://github.com/OpenRefine/OpenRefine/commit/e243e73e4064de87a913946bd320fbbe246da656",
    "cve_id": "CVE-2018-19859",
    "cwe_id": "CWE-22",
    "filename": "main/src/com/google/refine/importing/ImportingUtilities.java",
    "is_vulnerable": 0,
    "class_name": "ImportingUtilities",
    "subclass_name": null,
    "function_name": "run()",
    "function_body": "{\n                    createProjectSynchronously(\n                        job, format, optionObj, exceptions, record, project);\n                }"
  },
  {
    "id": 62,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 47,
    "human_patch": "https://github.com/OpenRefine/OpenRefine/commit/e243e73e4064de87a913946bd320fbbe246da656",
    "cve_id": "CVE-2018-19859",
    "cwe_id": "CWE-22",
    "filename": "main/src/com/google/refine/importing/ImportingUtilities.java",
    "is_vulnerable": 0,
    "class_name": "ImportingUtilities",
    "subclass_name": null,
    "function_name": "createProjectSynchronously(\n        final ImportingJob job,\n        final String format,\n        final ObjectNode optionObj,\n        final List<Exception> exceptions,\n        final Format record,\n        final Project project\n    )",
    "function_body": "{\n        ProjectMetadata pm = createProjectMetadata(optionObj);\n        record.parser.parse(\n            project,\n            pm,\n            job,\n            job.getSelectedFileRecords(),\n            format,\n            -1,\n            optionObj,\n            exceptions\n        );\n        \n        if (!job.canceled) {\n            if (exceptions.size() == 0) {\n                project.update(); \n                \n                ProjectManager.singleton.registerProject(project, pm);\n                \n                job.setProjectID(project.id);\n                job.setState(\"created-project\");\n            } else {\n                job.setError(exceptions);\n            }\n            job.touch();\n            job.updating = false;\n        }\n    }"
  },
  {
    "id": 62,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 48,
    "human_patch": "https://github.com/OpenRefine/OpenRefine/commit/e243e73e4064de87a913946bd320fbbe246da656",
    "cve_id": "CVE-2018-19859",
    "cwe_id": "CWE-22",
    "filename": "main/src/com/google/refine/importing/ImportingUtilities.java",
    "is_vulnerable": 0,
    "class_name": "ImportingUtilities",
    "subclass_name": null,
    "function_name": "createProjectMetadata(ObjectNode optionObj)",
    "function_body": "{\n        ProjectMetadata pm = new ProjectMetadata();\n        pm.setName(JSONUtilities.getString(optionObj, \"projectName\", \"Untitled\"));\n        pm.setTags(JSONUtilities.getStringArray(optionObj, \"projectTags\"));\n\n        String encoding = JSONUtilities.getString(optionObj, \"encoding\", \"UTF-8\");\n        if (\"\".equals(encoding)) {\n            \n            encoding = \"UTF-8\";\n        }\n        pm.setEncoding(encoding);\n        return pm;\n    }"
  },
  {
    "id": 62,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 0,
    "human_patch": "https://github.com/OpenRefine/OpenRefine/commit/e243e73e4064de87a913946bd320fbbe246da656",
    "cve_id": "CVE-2018-19859",
    "cwe_id": "CWE-22",
    "filename": "main/tests/server/src/com/google/refine/tests/importing/ImportingUtilitiesTests.java",
    "is_vulnerable": 0,
    "class_name": "ImportingUtilitiesTests",
    "subclass_name": null,
    "function_name": "setUp()",
    "function_body": "{\n        super.setUp();\n    }"
  },
  {
    "id": 62,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 1,
    "human_patch": "https://github.com/OpenRefine/OpenRefine/commit/e243e73e4064de87a913946bd320fbbe246da656",
    "cve_id": "CVE-2018-19859",
    "cwe_id": "CWE-22",
    "filename": "main/tests/server/src/com/google/refine/tests/importing/ImportingUtilitiesTests.java",
    "is_vulnerable": 0,
    "class_name": "ImportingUtilitiesTests",
    "subclass_name": null,
    "function_name": "createProjectMetadataTest() throws Exception",
    "function_body": "{\n        ObjectNode optionObj = ParsingUtilities.evaluateJsonStringToObjectNode(\n                \"{\\\"projectName\\\":\\\"acme\\\",\\\"projectTags\\\":[],\\\"created\\\":\\\"2017-12-18T13:28:40.659\\\",\\\"modified\\\":\\\"2017-12-20T09:28:06.654\\\",\\\"creator\\\":\\\"\\\",\\\"contributors\\\":\\\"\\\",\\\"subject\\\":\\\"\\\",\\\"description\\\":\\\"\\\",\\\"rowCount\\\":50,\\\"customMetadata\\\":{}}\");\n        ProjectMetadata pm = ImportingUtilities.createProjectMetadata(optionObj);\n        Assert.assertEquals(pm.getName(), \"acme\");\n        Assert.assertEquals(pm.getEncoding(), \"UTF-8\");\n        Assert.assertTrue(pm.getTags().length == 0);\n    }"
  },
  {
    "id": 62,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 2,
    "human_patch": "https://github.com/OpenRefine/OpenRefine/commit/e243e73e4064de87a913946bd320fbbe246da656",
    "cve_id": "CVE-2018-19859",
    "cwe_id": "CWE-22",
    "filename": "main/tests/server/src/com/google/refine/tests/importing/ImportingUtilitiesTests.java",
    "is_vulnerable": 0,
    "class_name": "ImportingUtilitiesTests",
    "subclass_name": null,
    "function_name": "getNestedOptions(ImportingJob job, TreeImportingParserBase parser)",
    "function_body": "{\n        ObjectNode options = parser.createParserUIInitializationData(\n                job, new LinkedList<>(), \"text/json\");\n        \n        ArrayNode path = ParsingUtilities.mapper.createArrayNode();\n        path.add(\"results\");\n        path.add(\"result\");\n        \n        JSONUtilities.safePut(options, \"recordPath\", path);\n        return options;\n    }"
  },
  {
    "id": 63,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 0,
    "human_patch": "https://github.com/resteasy/Resteasy/commit/acf15f2a8067f7e4cf5838342cecfa0b78a174fb",
    "cve_id": "CVE-2020-1695",
    "cwe_id": "CWE-20",
    "filename": "resteasy-core/src/main/java/org/jboss/resteasy/plugins/delegates/MediaTypeHeaderDelegate.java",
    "is_vulnerable": 0,
    "class_name": "MediaTypeHeaderDelegate",
    "subclass_name": null,
    "function_name": "fromString(String type) throws IllegalArgumentException",
    "function_body": "{\n      if (type == null) throw new IllegalArgumentException(Messages.MESSAGES.mediaTypeValueNull());\n      return parse(type);\n   }"
  },
  {
    "id": 63,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 1,
    "human_patch": "https://github.com/resteasy/Resteasy/commit/acf15f2a8067f7e4cf5838342cecfa0b78a174fb",
    "cve_id": "CVE-2020-1695",
    "cwe_id": "CWE-20",
    "filename": "resteasy-core/src/main/java/org/jboss/resteasy/plugins/delegates/MediaTypeHeaderDelegate.java",
    "is_vulnerable": 1,
    "class_name": "MediaTypeHeaderDelegate",
    "subclass_name": null,
    "function_name": "isValid(String str)",
    "function_body": "{\n      if (str == null || str.length() == 0) return false;\n      for (int i = 0; i < str.length(); i++) {\n         switch (str.charAt(i))\n         {\n            case '/':\n            case '\\\\':\n            case '?':\n            case ':':\n            case '<':\n            case '>':\n            case ';':\n            case '(':\n            case ')':\n            case '@':\n            case ',':\n            case '[':\n            case ']':\n            case '=':\n               return false;\n            default:\n               break;\n         }\n      }\n      return true;\n   }"
  },
  {
    "id": 63,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 2,
    "human_patch": "https://github.com/resteasy/Resteasy/commit/acf15f2a8067f7e4cf5838342cecfa0b78a174fb",
    "cve_id": "CVE-2020-1695",
    "cwe_id": "CWE-20",
    "filename": "resteasy-core/src/main/java/org/jboss/resteasy/plugins/delegates/MediaTypeHeaderDelegate.java",
    "is_vulnerable": 0,
    "class_name": "MediaTypeHeaderDelegate",
    "subclass_name": null,
    "function_name": "parse(String type)",
    "function_body": "{\n      MediaType result = map.get(type);\n      if (result == null) {\n          result = internalParse(type);\n          final int size = map.size();\n          if (size >= MAX_MT_CACHE_SIZE) {\n              map.clear();\n              reverseMap.clear();\n          }\n          map.put(type, result);\n          reverseMap.put(result, type);\n      }\n      return result;\n   }"
  },
  {
    "id": 63,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 3,
    "human_patch": "https://github.com/resteasy/Resteasy/commit/acf15f2a8067f7e4cf5838342cecfa0b78a174fb",
    "cve_id": "CVE-2020-1695",
    "cwe_id": "CWE-20",
    "filename": "resteasy-core/src/main/java/org/jboss/resteasy/plugins/delegates/MediaTypeHeaderDelegate.java",
    "is_vulnerable": 0,
    "class_name": "MediaTypeHeaderDelegate",
    "subclass_name": null,
    "function_name": "internalParse(String type)",
    "function_body": "{\n      int typeIndex = type.indexOf('/');\n      int paramIndex = type.indexOf(';');\n      String major = null;\n      String subtype = null;\n      if (typeIndex < 0) \n      {\n         major = type;\n         if (paramIndex > -1)\n         {\n            major = major.substring(0, paramIndex);\n         }\n         if (!MediaType.MEDIA_TYPE_WILDCARD.equals(major))\n         {\n            throw new IllegalArgumentException(Messages.MESSAGES.failureParsingMediaType(type));\n         }\n         subtype = MediaType.MEDIA_TYPE_WILDCARD;\n      }\n      else\n      {\n         major = type.substring(0, typeIndex);\n         if (paramIndex > -1)\n         {\n            subtype = type.substring(typeIndex + 1, paramIndex);\n         }\n         else\n         {\n            subtype = type.substring(typeIndex + 1);\n         }\n      }\n      if (major.length() < 1 || subtype.length() < 1)\n      {\n         throw new IllegalArgumentException(Messages.MESSAGES.failureParsingMediaType(type));\n      }\n      if (!isValid(major) || !isValid(subtype))\n      {\n         throw new IllegalArgumentException(Messages.MESSAGES.failureParsingMediaType(type));\n      }\n      String params = null;\n      if (paramIndex > -1) params = type.substring(paramIndex + 1);\n      if (params != null && !params.equals(\"\"))\n      {\n         HashMap<String, String> typeParams = new HashMap<String, String>();\n\n         int start = 0;\n\n         while (start < params.length())\n         {\n            start = HeaderParameterParser.setParam(typeParams, params, start);\n         }\n         return new MediaType(major, subtype, typeParams);\n      }\n      else\n      {\n         return new MediaType(major, subtype);\n      }\n   }"
  },
  {
    "id": 63,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 4,
    "human_patch": "https://github.com/resteasy/Resteasy/commit/acf15f2a8067f7e4cf5838342cecfa0b78a174fb",
    "cve_id": "CVE-2020-1695",
    "cwe_id": "CWE-20",
    "filename": "resteasy-core/src/main/java/org/jboss/resteasy/plugins/delegates/MediaTypeHeaderDelegate.java",
    "is_vulnerable": 0,
    "class_name": "MediaTypeHeaderDelegate",
    "subclass_name": null,
    "function_name": "quoted(String str)",
    "function_body": "{\n      for (int i = 0; i < str.length(); i++)\n      {\n         char c = str.charAt(i);\n         for (char q : quotedChars) {\n            if (c == q) return true;\n         }\n      }\n      return false;\n   }"
  },
  {
    "id": 63,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 5,
    "human_patch": "https://github.com/resteasy/Resteasy/commit/acf15f2a8067f7e4cf5838342cecfa0b78a174fb",
    "cve_id": "CVE-2020-1695",
    "cwe_id": "CWE-20",
    "filename": "resteasy-core/src/main/java/org/jboss/resteasy/plugins/delegates/MediaTypeHeaderDelegate.java",
    "is_vulnerable": 0,
    "class_name": "MediaTypeHeaderDelegate",
    "subclass_name": null,
    "function_name": "toString(Object o)",
    "function_body": "{\n      if (o == null) throw new IllegalArgumentException(Messages.MESSAGES.paramNull());\n      MediaType type = (MediaType) o;\n      String result = reverseMap.get(type);\n      if (result == null) {\n          result = internalToString(type);\n          final int size = reverseMap.size();\n          if (size >= MAX_MT_CACHE_SIZE) {\n             reverseMap.clear();\n             map.clear();\n          }\n          reverseMap.put(type, result);\n          map.put(result, type);\n      }\n      return result;\n   }"
  },
  {
    "id": 63,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 6,
    "human_patch": "https://github.com/resteasy/Resteasy/commit/acf15f2a8067f7e4cf5838342cecfa0b78a174fb",
    "cve_id": "CVE-2020-1695",
    "cwe_id": "CWE-20",
    "filename": "resteasy-core/src/main/java/org/jboss/resteasy/plugins/delegates/MediaTypeHeaderDelegate.java",
    "is_vulnerable": 0,
    "class_name": "MediaTypeHeaderDelegate",
    "subclass_name": null,
    "function_name": "internalToString(MediaType type)",
    "function_body": "{\n      StringBuilder buf = new StringBuilder();\n\n      buf.append(type.getType().toLowerCase()).append(\"/\").append(type.getSubtype().toLowerCase());\n      if (type.getParameters() == null || type.getParameters().size() == 0) return buf.toString();\n      for (String name : type.getParameters().keySet())\n      {\n         buf.append(';').append(name).append('=');\n         String val = type.getParameters().get(name);\n         if (quoted(val)) buf.append('\"').append(val).append('\"');\n         else buf.append(val);\n      }\n      return buf.toString();\n   }"
  },
  {
    "id": 64,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 0,
    "human_patch": "https://github.com/spring-projects/spring-data-commons/commit/371f6590c509c72f8e600f3d05e110941607fba",
    "cve_id": "CVE-2018-1274",
    "cwe_id": "CWE-770",
    "filename": "src/main/java/org/springframework/data/mapping/PropertyPath.java",
    "is_vulnerable": 0,
    "class_name": "PropertyPath",
    "subclass_name": null,
    "function_name": "getOwningType()",
    "function_body": "{\n\t\treturn owningType;\n\t}"
  },
  {
    "id": 64,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 1,
    "human_patch": "https://github.com/spring-projects/spring-data-commons/commit/371f6590c509c72f8e600f3d05e110941607fba",
    "cve_id": "CVE-2018-1274",
    "cwe_id": "CWE-770",
    "filename": "src/main/java/org/springframework/data/mapping/PropertyPath.java",
    "is_vulnerable": 0,
    "class_name": "PropertyPath",
    "subclass_name": null,
    "function_name": "getSegment()",
    "function_body": "{\n\t\treturn name;\n\t}"
  },
  {
    "id": 64,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 2,
    "human_patch": "https://github.com/spring-projects/spring-data-commons/commit/371f6590c509c72f8e600f3d05e110941607fba",
    "cve_id": "CVE-2018-1274",
    "cwe_id": "CWE-770",
    "filename": "src/main/java/org/springframework/data/mapping/PropertyPath.java",
    "is_vulnerable": 0,
    "class_name": "PropertyPath",
    "subclass_name": null,
    "function_name": "getLeafProperty()",
    "function_body": "{\n\n\t\tPropertyPath result = this;\n\n\t\twhile (result.hasNext()) {\n\t\t\tresult = result.next();\n\t\t}\n\n\t\treturn result;\n\t}"
  },
  {
    "id": 64,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 3,
    "human_patch": "https://github.com/spring-projects/spring-data-commons/commit/371f6590c509c72f8e600f3d05e110941607fba",
    "cve_id": "CVE-2018-1274",
    "cwe_id": "CWE-770",
    "filename": "src/main/java/org/springframework/data/mapping/PropertyPath.java",
    "is_vulnerable": 0,
    "class_name": "PropertyPath",
    "subclass_name": null,
    "function_name": "getType()",
    "function_body": "{\n\t\treturn this.type.getType();\n\t}"
  },
  {
    "id": 64,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 4,
    "human_patch": "https://github.com/spring-projects/spring-data-commons/commit/371f6590c509c72f8e600f3d05e110941607fba",
    "cve_id": "CVE-2018-1274",
    "cwe_id": "CWE-770",
    "filename": "src/main/java/org/springframework/data/mapping/PropertyPath.java",
    "is_vulnerable": 0,
    "class_name": "PropertyPath",
    "subclass_name": null,
    "function_name": "next()",
    "function_body": "{\n\t\treturn next;\n\t}"
  },
  {
    "id": 64,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 5,
    "human_patch": "https://github.com/spring-projects/spring-data-commons/commit/371f6590c509c72f8e600f3d05e110941607fba",
    "cve_id": "CVE-2018-1274",
    "cwe_id": "CWE-770",
    "filename": "src/main/java/org/springframework/data/mapping/PropertyPath.java",
    "is_vulnerable": 0,
    "class_name": "PropertyPath",
    "subclass_name": null,
    "function_name": "hasNext()",
    "function_body": "{\n\t\treturn next != null;\n\t}"
  },
  {
    "id": 64,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 6,
    "human_patch": "https://github.com/spring-projects/spring-data-commons/commit/371f6590c509c72f8e600f3d05e110941607fba",
    "cve_id": "CVE-2018-1274",
    "cwe_id": "CWE-770",
    "filename": "src/main/java/org/springframework/data/mapping/PropertyPath.java",
    "is_vulnerable": 0,
    "class_name": "PropertyPath",
    "subclass_name": null,
    "function_name": "toDotPath()",
    "function_body": "{\n\n\t\tif (hasNext()) {\n\t\t\treturn getSegment() + \".\" + next().toDotPath();\n\t\t}\n\n\t\treturn getSegment();\n\t}"
  },
  {
    "id": 64,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 7,
    "human_patch": "https://github.com/spring-projects/spring-data-commons/commit/371f6590c509c72f8e600f3d05e110941607fba",
    "cve_id": "CVE-2018-1274",
    "cwe_id": "CWE-770",
    "filename": "src/main/java/org/springframework/data/mapping/PropertyPath.java",
    "is_vulnerable": 0,
    "class_name": "PropertyPath",
    "subclass_name": null,
    "function_name": "isCollection()",
    "function_body": "{\n\t\treturn isCollection;\n\t}"
  },
  {
    "id": 64,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 8,
    "human_patch": "https://github.com/spring-projects/spring-data-commons/commit/371f6590c509c72f8e600f3d05e110941607fba",
    "cve_id": "CVE-2018-1274",
    "cwe_id": "CWE-770",
    "filename": "src/main/java/org/springframework/data/mapping/PropertyPath.java",
    "is_vulnerable": 0,
    "class_name": "PropertyPath",
    "subclass_name": null,
    "function_name": "equals(Object obj)",
    "function_body": "{\n\n\t\tif (this == obj) {\n\t\t\treturn true;\n\t\t}\n\n\t\tif (obj == null || !getClass().equals(obj.getClass())) {\n\t\t\treturn false;\n\t\t}\n\n\t\tPropertyPath that = (PropertyPath) obj;\n\n\t\treturn this.name.equals(that.name) && this.type.equals(that.type)\n\t\t\t\t&& ObjectUtils.nullSafeEquals(this.next, that.next);\n\t}"
  },
  {
    "id": 64,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 9,
    "human_patch": "https://github.com/spring-projects/spring-data-commons/commit/371f6590c509c72f8e600f3d05e110941607fba",
    "cve_id": "CVE-2018-1274",
    "cwe_id": "CWE-770",
    "filename": "src/main/java/org/springframework/data/mapping/PropertyPath.java",
    "is_vulnerable": 0,
    "class_name": "PropertyPath",
    "subclass_name": null,
    "function_name": "hashCode()",
    "function_body": "{\n\n\t\tint result = 17;\n\n\t\tresult += 31 * name.hashCode();\n\t\tresult += 31 * type.hashCode();\n\t\tresult += 31 * (next == null ? 0 : next.hashCode());\n\n\t\treturn result;\n\t}"
  },
  {
    "id": 64,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 10,
    "human_patch": "https://github.com/spring-projects/spring-data-commons/commit/371f6590c509c72f8e600f3d05e110941607fba",
    "cve_id": "CVE-2018-1274",
    "cwe_id": "CWE-770",
    "filename": "src/main/java/org/springframework/data/mapping/PropertyPath.java",
    "is_vulnerable": 0,
    "class_name": "PropertyPath",
    "subclass_name": null,
    "function_name": "iterator()",
    "function_body": "{\n\t\treturn new Iterator<PropertyPath>() {\n\n\t\t\tprivate PropertyPath current = PropertyPath.this;\n\n\t\t\tpublic boolean hasNext() {\n\t\t\t\treturn current != null;\n\t\t\t}\n\n\t\t\tpublic PropertyPath next() {\n\t\t\t\tPropertyPath result = current;\n\t\t\t\tthis.current = current.next();\n\t\t\t\treturn result;\n\t\t\t}\n\n\t\t\tpublic void remove() {\n\t\t\t\tthrow new UnsupportedOperationException();\n\t\t\t}\n\t\t};\n\t}"
  },
  {
    "id": 64,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 11,
    "human_patch": "https://github.com/spring-projects/spring-data-commons/commit/371f6590c509c72f8e600f3d05e110941607fba",
    "cve_id": "CVE-2018-1274",
    "cwe_id": "CWE-770",
    "filename": "src/main/java/org/springframework/data/mapping/PropertyPath.java",
    "is_vulnerable": 1,
    "class_name": "PropertyPath",
    "subclass_name": null,
    "function_name": "hasNext()",
    "function_body": "{\n\t\t\t\treturn current != null;\n\t\t\t}"
  },
  {
    "id": 64,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 12,
    "human_patch": "https://github.com/spring-projects/spring-data-commons/commit/371f6590c509c72f8e600f3d05e110941607fba",
    "cve_id": "CVE-2018-1274",
    "cwe_id": "CWE-770",
    "filename": "src/main/java/org/springframework/data/mapping/PropertyPath.java",
    "is_vulnerable": 1,
    "class_name": "PropertyPath",
    "subclass_name": null,
    "function_name": "next()",
    "function_body": "{\n\t\t\t\tPropertyPath result = current;\n\t\t\t\tthis.current = current.next();\n\t\t\t\treturn result;\n\t\t\t}"
  },
  {
    "id": 64,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 13,
    "human_patch": "https://github.com/spring-projects/spring-data-commons/commit/371f6590c509c72f8e600f3d05e110941607fba",
    "cve_id": "CVE-2018-1274",
    "cwe_id": "CWE-770",
    "filename": "src/main/java/org/springframework/data/mapping/PropertyPath.java",
    "is_vulnerable": 0,
    "class_name": "PropertyPath",
    "subclass_name": null,
    "function_name": "remove()",
    "function_body": "{\n\t\t\t\tthrow new UnsupportedOperationException();\n\t\t\t}"
  },
  {
    "id": 64,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 14,
    "human_patch": "https://github.com/spring-projects/spring-data-commons/commit/371f6590c509c72f8e600f3d05e110941607fba",
    "cve_id": "CVE-2018-1274",
    "cwe_id": "CWE-770",
    "filename": "src/main/java/org/springframework/data/mapping/PropertyPath.java",
    "is_vulnerable": 0,
    "class_name": "PropertyPath",
    "subclass_name": null,
    "function_name": "from(String source, Class<?> type)",
    "function_body": "{\n\t\treturn from(source, ClassTypeInformation.from(type));\n\t}"
  },
  {
    "id": 64,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 15,
    "human_patch": "https://github.com/spring-projects/spring-data-commons/commit/371f6590c509c72f8e600f3d05e110941607fba",
    "cve_id": "CVE-2018-1274",
    "cwe_id": "CWE-770",
    "filename": "src/main/java/org/springframework/data/mapping/PropertyPath.java",
    "is_vulnerable": 0,
    "class_name": "PropertyPath",
    "subclass_name": null,
    "function_name": "from(String source, TypeInformation<?> type)",
    "function_body": "{\n\n\t\tAssert.hasText(source, \"Source must not be null or empty!\");\n\t\tAssert.notNull(type, \"TypeInformation must not be null or empty!\");\n\n\t\tList<String> iteratorSource = new ArrayList<String>();\n\t\tMatcher matcher = SPLITTER.matcher(\"_\" + source);\n\n\t\twhile (matcher.find()) {\n\t\t\titeratorSource.add(matcher.group(1));\n\t\t}\n\n\t\tIterator<String> parts = iteratorSource.iterator();\n\n\t\tPropertyPath result = null;\n\t\tStack<PropertyPath> current = new Stack<PropertyPath>();\n\n\t\twhile (parts.hasNext()) {\n\t\t\tif (result == null) {\n\t\t\t\tresult = create(parts.next(), type, current);\n\t\t\t\tcurrent.push(result);\n\t\t\t} else {\n\t\t\t\tcurrent.push(create(parts.next(), current));\n\t\t\t}\n\t\t}\n\n\t\treturn result;\n\t}"
  },
  {
    "id": 64,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 16,
    "human_patch": "https://github.com/spring-projects/spring-data-commons/commit/371f6590c509c72f8e600f3d05e110941607fba",
    "cve_id": "CVE-2018-1274",
    "cwe_id": "CWE-770",
    "filename": "src/main/java/org/springframework/data/mapping/PropertyPath.java",
    "is_vulnerable": 0,
    "class_name": "PropertyPath",
    "subclass_name": null,
    "function_name": "create(String source, Stack<PropertyPath> base)",
    "function_body": "{\n\n\t\tPropertyPath previous = base.peek();\n\n\t\tPropertyPath propertyPath = create(source, previous.type, base);\n\t\tprevious.next = propertyPath;\n\t\treturn propertyPath;\n\t}"
  },
  {
    "id": 64,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 17,
    "human_patch": "https://github.com/spring-projects/spring-data-commons/commit/371f6590c509c72f8e600f3d05e110941607fba",
    "cve_id": "CVE-2018-1274",
    "cwe_id": "CWE-770",
    "filename": "src/main/java/org/springframework/data/mapping/PropertyPath.java",
    "is_vulnerable": 0,
    "class_name": "PropertyPath",
    "subclass_name": null,
    "function_name": "create(String source, TypeInformation<?> type, List<PropertyPath> base)",
    "function_body": "{\n\t\treturn create(source, type, \"\", base);\n\t}"
  },
  {
    "id": 64,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 18,
    "human_patch": "https://github.com/spring-projects/spring-data-commons/commit/371f6590c509c72f8e600f3d05e110941607fba",
    "cve_id": "CVE-2018-1274",
    "cwe_id": "CWE-770",
    "filename": "src/main/java/org/springframework/data/mapping/PropertyPath.java",
    "is_vulnerable": 1,
    "class_name": "PropertyPath",
    "subclass_name": null,
    "function_name": "create(String source, TypeInformation<?> type, String addTail, List<PropertyPath> base)",
    "function_body": "{\n\n\t\tPropertyReferenceException exception = null;\n\t\tPropertyPath current = null;\n\n\t\ttry {\n\n\t\t\tcurrent = new PropertyPath(source, type, base);\n\n\t\t\tif (!base.isEmpty()) {\n\t\t\t\tbase.get(base.size() - 1).next = current;\n\t\t\t}\n\n\t\t\tList<PropertyPath> newBase = new ArrayList<PropertyPath>(base);\n\t\t\tnewBase.add(current);\n\n\t\t\tif (StringUtils.hasText(addTail)) {\n\t\t\t\tcurrent.next = create(addTail, current.type, newBase);\n\t\t\t}\n\n\t\t\treturn current;\n\n\t\t} catch (PropertyReferenceException e) {\n\n\t\t\tif (current != null) {\n\t\t\t\tthrow e;\n\t\t\t}\n\n\t\t\texception = e;\n\t\t}\n\n\t\tPattern pattern = Pattern.compile(\"\\\\p{Lu}+\\\\p{Ll}*$\");\n\t\tMatcher matcher = pattern.matcher(source);\n\n\t\tif (matcher.find() && matcher.start() != 0) {\n\n\t\t\tint position = matcher.start();\n\t\t\tString head = source.substring(0, position);\n\t\t\tString tail = source.substring(position);\n\n\t\t\ttry {\n\t\t\t\treturn create(head, type, tail + addTail, base);\n\t\t\t} catch (PropertyReferenceException e) {\n\t\t\t\tthrow e.hasDeeperResolutionDepthThan(exception) ? e : exception;\n\t\t\t}\n\t\t}\n\n\t\tthrow exception;\n\t}"
  },
  {
    "id": 64,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 19,
    "human_patch": "https://github.com/spring-projects/spring-data-commons/commit/371f6590c509c72f8e600f3d05e110941607fba",
    "cve_id": "CVE-2018-1274",
    "cwe_id": "CWE-770",
    "filename": "src/main/java/org/springframework/data/mapping/PropertyPath.java",
    "is_vulnerable": 0,
    "class_name": "PropertyPath",
    "subclass_name": null,
    "function_name": "toString()",
    "function_body": "{\n\t\treturn String.format(\"%s.%s\", owningType.getType().getSimpleName(), toDotPath());\n\t}"
  },
  {
    "id": 64,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 0,
    "human_patch": "https://github.com/spring-projects/spring-data-commons/commit/371f6590c509c72f8e600f3d05e110941607fba",
    "cve_id": "CVE-2018-1274",
    "cwe_id": "CWE-770",
    "filename": "src/test/java/org/springframework/data/mapping/PropertyPathUnitTests.java",
    "is_vulnerable": 0,
    "class_name": "PropertyPathUnitTests",
    "subclass_name": null,
    "function_name": "parsesSimplePropertyCorrectly() throws Exception",
    "function_body": "{\n\n\t\tPropertyPath reference = PropertyPath.from(\"userName\", Foo.class);\n\t\tassertThat(reference.hasNext(), is(false));\n\t\tassertThat(reference.toDotPath(), is(\"userName\"));\n\t\tassertThat(reference.getOwningType(), is((TypeInformation) ClassTypeInformation.from(Foo.class)));\n\t}"
  },
  {
    "id": 64,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 1,
    "human_patch": "https://github.com/spring-projects/spring-data-commons/commit/371f6590c509c72f8e600f3d05e110941607fba",
    "cve_id": "CVE-2018-1274",
    "cwe_id": "CWE-770",
    "filename": "src/test/java/org/springframework/data/mapping/PropertyPathUnitTests.java",
    "is_vulnerable": 0,
    "class_name": "PropertyPathUnitTests",
    "subclass_name": null,
    "function_name": "parsesPathPropertyCorrectly() throws Exception",
    "function_body": "{\n\n\t\tPropertyPath reference = PropertyPath.from(\"userName\", Bar.class);\n\t\tassertThat(reference.hasNext(), is(true));\n\t\tassertThat(reference.next(), is(new PropertyPath(\"name\", FooBar.class)));\n\t\tassertThat(reference.toDotPath(), is(\"user.name\"));\n\t}"
  },
  {
    "id": 64,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 2,
    "human_patch": "https://github.com/spring-projects/spring-data-commons/commit/371f6590c509c72f8e600f3d05e110941607fba",
    "cve_id": "CVE-2018-1274",
    "cwe_id": "CWE-770",
    "filename": "src/test/java/org/springframework/data/mapping/PropertyPathUnitTests.java",
    "is_vulnerable": 0,
    "class_name": "PropertyPathUnitTests",
    "subclass_name": null,
    "function_name": "prefersLongerMatches() throws Exception",
    "function_body": "{\n\n\t\tPropertyPath reference = PropertyPath.from(\"userName\", Sample.class);\n\t\tassertThat(reference.hasNext(), is(false));\n\t\tassertThat(reference.toDotPath(), is(\"userName\"));\n\t}"
  },
  {
    "id": 64,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 3,
    "human_patch": "https://github.com/spring-projects/spring-data-commons/commit/371f6590c509c72f8e600f3d05e110941607fba",
    "cve_id": "CVE-2018-1274",
    "cwe_id": "CWE-770",
    "filename": "src/test/java/org/springframework/data/mapping/PropertyPathUnitTests.java",
    "is_vulnerable": 0,
    "class_name": "PropertyPathUnitTests",
    "subclass_name": null,
    "function_name": "testname() throws Exception",
    "function_body": "{\n\n\t\tPropertyPath reference = PropertyPath.from(\"userName\", Sample2.class);\n\t\tassertThat(reference.getSegment(), is(\"user\"));\n\t\tassertThat(reference.hasNext(), is(true));\n\t\tassertThat(reference.next(), is(new PropertyPath(\"name\", FooBar.class)));\n\t}"
  },
  {
    "id": 64,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 4,
    "human_patch": "https://github.com/spring-projects/spring-data-commons/commit/371f6590c509c72f8e600f3d05e110941607fba",
    "cve_id": "CVE-2018-1274",
    "cwe_id": "CWE-770",
    "filename": "src/test/java/org/springframework/data/mapping/PropertyPathUnitTests.java",
    "is_vulnerable": 0,
    "class_name": "PropertyPathUnitTests",
    "subclass_name": null,
    "function_name": "prefersExplicitPaths() throws Exception",
    "function_body": "{\n\n\t\tPropertyPath reference = PropertyPath.from(\"user_name\", Sample.class);\n\t\tassertThat(reference.getSegment(), is(\"user\"));\n\t\tassertThat(reference.hasNext(), is(true));\n\t\tassertThat(reference.next(), is(new PropertyPath(\"name\", FooBar.class)));\n\t}"
  },
  {
    "id": 64,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 5,
    "human_patch": "https://github.com/spring-projects/spring-data-commons/commit/371f6590c509c72f8e600f3d05e110941607fba",
    "cve_id": "CVE-2018-1274",
    "cwe_id": "CWE-770",
    "filename": "src/test/java/org/springframework/data/mapping/PropertyPathUnitTests.java",
    "is_vulnerable": 0,
    "class_name": "PropertyPathUnitTests",
    "subclass_name": null,
    "function_name": "handlesGenericsCorrectly() throws Exception",
    "function_body": "{\n\n\t\tPropertyPath reference = PropertyPath.from(\"usersName\", Bar.class);\n\t\tassertThat(reference.getSegment(), is(\"users\"));\n\t\tassertThat(reference.isCollection(), is(true));\n\t\tassertThat(reference.hasNext(), is(true));\n\t\tassertThat(reference.next(), is(new PropertyPath(\"name\", FooBar.class)));\n\t}"
  },
  {
    "id": 64,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 6,
    "human_patch": "https://github.com/spring-projects/spring-data-commons/commit/371f6590c509c72f8e600f3d05e110941607fba",
    "cve_id": "CVE-2018-1274",
    "cwe_id": "CWE-770",
    "filename": "src/test/java/org/springframework/data/mapping/PropertyPathUnitTests.java",
    "is_vulnerable": 0,
    "class_name": "PropertyPathUnitTests",
    "subclass_name": null,
    "function_name": "handlesMapCorrectly() throws Exception",
    "function_body": "{\n\n\t\tPropertyPath reference = PropertyPath.from(\"userMapName\", Bar.class);\n\t\tassertThat(reference.getSegment(), is(\"userMap\"));\n\t\tassertThat(reference.isCollection(), is(false));\n\t\tassertThat(reference.hasNext(), is(true));\n\t\tassertThat(reference.next(), is(new PropertyPath(\"name\", FooBar.class)));\n\t}"
  },
  {
    "id": 64,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 7,
    "human_patch": "https://github.com/spring-projects/spring-data-commons/commit/371f6590c509c72f8e600f3d05e110941607fba",
    "cve_id": "CVE-2018-1274",
    "cwe_id": "CWE-770",
    "filename": "src/test/java/org/springframework/data/mapping/PropertyPathUnitTests.java",
    "is_vulnerable": 0,
    "class_name": "PropertyPathUnitTests",
    "subclass_name": null,
    "function_name": "handlesArrayCorrectly() throws Exception",
    "function_body": "{\n\n\t\tPropertyPath reference = PropertyPath.from(\"userArrayName\", Bar.class);\n\t\tassertThat(reference.getSegment(), is(\"userArray\"));\n\t\tassertThat(reference.isCollection(), is(true));\n\t\tassertThat(reference.hasNext(), is(true));\n\t\tassertThat(reference.next(), is(new PropertyPath(\"name\", FooBar.class)));\n\t}"
  },
  {
    "id": 64,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 8,
    "human_patch": "https://github.com/spring-projects/spring-data-commons/commit/371f6590c509c72f8e600f3d05e110941607fba",
    "cve_id": "CVE-2018-1274",
    "cwe_id": "CWE-770",
    "filename": "src/test/java/org/springframework/data/mapping/PropertyPathUnitTests.java",
    "is_vulnerable": 0,
    "class_name": "PropertyPathUnitTests",
    "subclass_name": null,
    "function_name": "handlesInvalidCollectionCompountTypeProperl()",
    "function_body": "{\n\n\t\ttry {\n\t\t\tPropertyPath.from(\"usersMame\", Bar.class);\n\t\t\tfail(\"Expected PropertyReferenceException!\");\n\t\t} catch (PropertyReferenceException e) {\n\t\t\tassertThat(e.getPropertyName(), is(\"mame\"));\n\t\t\tassertThat(e.getBaseProperty(), is(PropertyPath.from(\"users\", Bar.class)));\n\t\t}\n\t}"
  },
  {
    "id": 64,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 9,
    "human_patch": "https://github.com/spring-projects/spring-data-commons/commit/371f6590c509c72f8e600f3d05e110941607fba",
    "cve_id": "CVE-2018-1274",
    "cwe_id": "CWE-770",
    "filename": "src/test/java/org/springframework/data/mapping/PropertyPathUnitTests.java",
    "is_vulnerable": 0,
    "class_name": "PropertyPathUnitTests",
    "subclass_name": null,
    "function_name": "handlesInvalidMapValueTypeProperly()",
    "function_body": "{\n\n\t\ttry {\n\t\t\tPropertyPath.from(\"userMapMame\", Bar.class);\n\t\t\tfail();\n\t\t} catch (PropertyReferenceException e) {\n\t\t\tassertThat(e.getPropertyName(), is(\"mame\"));\n\t\t\tassertThat(e.getBaseProperty(), is(PropertyPath.from(\"userMap\", Bar.class)));\n\t\t}\n\t}"
  },
  {
    "id": 64,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 10,
    "human_patch": "https://github.com/spring-projects/spring-data-commons/commit/371f6590c509c72f8e600f3d05e110941607fba",
    "cve_id": "CVE-2018-1274",
    "cwe_id": "CWE-770",
    "filename": "src/test/java/org/springframework/data/mapping/PropertyPathUnitTests.java",
    "is_vulnerable": 0,
    "class_name": "PropertyPathUnitTests",
    "subclass_name": null,
    "function_name": "findsNested()",
    "function_body": "{\n\n\t\tPropertyPath from = PropertyPath.from(\"barUserName\", Sample.class);\n\n\t\tassertThat(from, is(notNullValue()));\n\t\tassertThat(from.getLeafProperty(), is(PropertyPath.from(\"name\", FooBar.class)));\n\t}"
  },
  {
    "id": 64,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 11,
    "human_patch": "https://github.com/spring-projects/spring-data-commons/commit/371f6590c509c72f8e600f3d05e110941607fba",
    "cve_id": "CVE-2018-1274",
    "cwe_id": "CWE-770",
    "filename": "src/test/java/org/springframework/data/mapping/PropertyPathUnitTests.java",
    "is_vulnerable": 0,
    "class_name": "PropertyPathUnitTests",
    "subclass_name": null,
    "function_name": "handlesEmptyUnderscoresCorrectly()",
    "function_body": "{\n\n\t\tPropertyPath propertyPath = PropertyPath.from(\"_foo\", Sample2.class);\n\t\tassertThat(propertyPath.getSegment(), is(\"_foo\"));\n\t\tassertThat(propertyPath.getType(), is(typeCompatibleWith(Foo.class)));\n\n\t\tpropertyPath = PropertyPath.from(\"_foo__email\", Sample2.class);\n\t\tassertThat(propertyPath.toDotPath(), is(\"_foo._email\"));\n\t}"
  },
  {
    "id": 64,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 12,
    "human_patch": "https://github.com/spring-projects/spring-data-commons/commit/371f6590c509c72f8e600f3d05e110941607fba",
    "cve_id": "CVE-2018-1274",
    "cwe_id": "CWE-770",
    "filename": "src/test/java/org/springframework/data/mapping/PropertyPathUnitTests.java",
    "is_vulnerable": 0,
    "class_name": "PropertyPathUnitTests",
    "subclass_name": null,
    "function_name": "supportsDotNotationAsWell()",
    "function_body": "{\n\n\t\tPropertyPath propertyPath = PropertyPath.from(\"bar.userMap.name\", Sample.class);\n\n\t\tassertThat(propertyPath, is(notNullValue()));\n\t\tassertThat(propertyPath.getSegment(), is(\"bar\"));\n\t\tassertThat(propertyPath.getLeafProperty(), is(PropertyPath.from(\"name\", FooBar.class)));\n\t}"
  },
  {
    "id": 64,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 13,
    "human_patch": "https://github.com/spring-projects/spring-data-commons/commit/371f6590c509c72f8e600f3d05e110941607fba",
    "cve_id": "CVE-2018-1274",
    "cwe_id": "CWE-770",
    "filename": "src/test/java/org/springframework/data/mapping/PropertyPathUnitTests.java",
    "is_vulnerable": 0,
    "class_name": "PropertyPathUnitTests",
    "subclass_name": null,
    "function_name": "returnsCorrectIteratorForSingleElement()",
    "function_body": "{\n\n\t\tPropertyPath propertyPath = PropertyPath.from(\"userName\", Foo.class);\n\n\t\tIterator<PropertyPath> iterator = propertyPath.iterator();\n\t\tassertThat(iterator.hasNext(), is(true));\n\t\tassertThat(iterator.next(), is(propertyPath));\n\t\tassertThat(iterator.hasNext(), is(false));\n\t}"
  },
  {
    "id": 64,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 14,
    "human_patch": "https://github.com/spring-projects/spring-data-commons/commit/371f6590c509c72f8e600f3d05e110941607fba",
    "cve_id": "CVE-2018-1274",
    "cwe_id": "CWE-770",
    "filename": "src/test/java/org/springframework/data/mapping/PropertyPathUnitTests.java",
    "is_vulnerable": 0,
    "class_name": "PropertyPathUnitTests",
    "subclass_name": null,
    "function_name": "returnsCorrectIteratorForMultipleElement()",
    "function_body": "{\n\n\t\tPropertyPath propertyPath = PropertyPath.from(\"user.name\", Bar.class);\n\n\t\tIterator<PropertyPath> iterator = propertyPath.iterator();\n\t\tassertThat(iterator.hasNext(), is(true));\n\t\tassertThat(iterator.next(), is(propertyPath));\n\t\tassertThat(iterator.hasNext(), is(true));\n\t\tassertThat(iterator.next(), is(propertyPath.next()));\n\t\tassertThat(iterator.hasNext(), is(false));\n\t}"
  },
  {
    "id": 64,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 15,
    "human_patch": "https://github.com/spring-projects/spring-data-commons/commit/371f6590c509c72f8e600f3d05e110941607fba",
    "cve_id": "CVE-2018-1274",
    "cwe_id": "CWE-770",
    "filename": "src/test/java/org/springframework/data/mapping/PropertyPathUnitTests.java",
    "is_vulnerable": 0,
    "class_name": "PropertyPathUnitTests",
    "subclass_name": null,
    "function_name": "rejectsInvalidPropertyWithLeadingUnderscore()",
    "function_body": "{\n\t\ttry {\n\t\t\tPropertyPath.from(\"_id\", Foo.class);\n\t\t\tfail();\n\t\t} catch (PropertyReferenceException e) {\n\t\t\tassertThat(e.getMessage(), containsString(\"property _id\"));\n\t\t}\n\t}"
  },
  {
    "id": 64,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 16,
    "human_patch": "https://github.com/spring-projects/spring-data-commons/commit/371f6590c509c72f8e600f3d05e110941607fba",
    "cve_id": "CVE-2018-1274",
    "cwe_id": "CWE-770",
    "filename": "src/test/java/org/springframework/data/mapping/PropertyPathUnitTests.java",
    "is_vulnerable": 0,
    "class_name": "PropertyPathUnitTests",
    "subclass_name": null,
    "function_name": "rejectsNestedInvalidPropertyWithLeadingUnderscore()",
    "function_body": "{\n\t\ttry {\n\t\t\tPropertyPath.from(\"_foo_id\", Sample2.class);\n\t\t\tfail();\n\t\t} catch (PropertyReferenceException e) {\n\t\t\tassertThat(e.getMessage(), containsString(\"property id\"));\n\t\t}\n\t}"
  },
  {
    "id": 64,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 17,
    "human_patch": "https://github.com/spring-projects/spring-data-commons/commit/371f6590c509c72f8e600f3d05e110941607fba",
    "cve_id": "CVE-2018-1274",
    "cwe_id": "CWE-770",
    "filename": "src/test/java/org/springframework/data/mapping/PropertyPathUnitTests.java",
    "is_vulnerable": 0,
    "class_name": "PropertyPathUnitTests",
    "subclass_name": null,
    "function_name": "rejectsNestedInvalidPropertyExplictlySplitWithLeadingUnderscore()",
    "function_body": "{\n\t\ttry {\n\t\t\tPropertyPath.from(\"_foo__id\", Sample2.class);\n\t\t\tfail();\n\t\t} catch (PropertyReferenceException e) {\n\t\t\tassertThat(e.getMessage(), containsString(\"property _id\"));\n\t\t}\n\t}"
  },
  {
    "id": 64,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 18,
    "human_patch": "https://github.com/spring-projects/spring-data-commons/commit/371f6590c509c72f8e600f3d05e110941607fba",
    "cve_id": "CVE-2018-1274",
    "cwe_id": "CWE-770",
    "filename": "src/test/java/org/springframework/data/mapping/PropertyPathUnitTests.java",
    "is_vulnerable": 0,
    "class_name": "PropertyPathUnitTests",
    "subclass_name": null,
    "function_name": "rejectsInvalidPathsContainingDigits()",
    "function_body": "{\n\t\tPropertyPath.from(\"PropertyThatWillFail4Sure\", Foo.class);\n\t}"
  },
  {
    "id": 64,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 19,
    "human_patch": "https://github.com/spring-projects/spring-data-commons/commit/371f6590c509c72f8e600f3d05e110941607fba",
    "cve_id": "CVE-2018-1274",
    "cwe_id": "CWE-770",
    "filename": "src/test/java/org/springframework/data/mapping/PropertyPathUnitTests.java",
    "is_vulnerable": 0,
    "class_name": "PropertyPathUnitTests",
    "subclass_name": null,
    "function_name": "rejectsInvalidProperty()",
    "function_body": "{\n\n\t\ttry {\n\t\t\tPropertyPath.from(\"bar\", Foo.class);\n\t\t\tfail();\n\t\t} catch (PropertyReferenceException e) {\n\t\t\tassertThat(e.getBaseProperty(), is(nullValue()));\n\t\t}\n\t}"
  },
  {
    "id": 64,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 20,
    "human_patch": "https://github.com/spring-projects/spring-data-commons/commit/371f6590c509c72f8e600f3d05e110941607fba",
    "cve_id": "CVE-2018-1274",
    "cwe_id": "CWE-770",
    "filename": "src/test/java/org/springframework/data/mapping/PropertyPathUnitTests.java",
    "is_vulnerable": 0,
    "class_name": "PropertyPathUnitTests",
    "subclass_name": null,
    "function_name": "samePathsEqual()",
    "function_body": "{\n\n\t\tPropertyPath left = PropertyPath.from(\"user.name\", Bar.class);\n\t\tPropertyPath right = PropertyPath.from(\"user.name\", Bar.class);\n\n\t\tPropertyPath shortPath = PropertyPath.from(\"user\", Bar.class);\n\n\t\tassertThat(left, is(right));\n\t\tassertThat(right, is(left));\n\t\tassertThat(left, is(not(shortPath)));\n\t\tassertThat(shortPath, is(not(left)));\n\n\t\tassertThat(left, is(not(new Object())));\n\t}"
  },
  {
    "id": 64,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 21,
    "human_patch": "https://github.com/spring-projects/spring-data-commons/commit/371f6590c509c72f8e600f3d05e110941607fba",
    "cve_id": "CVE-2018-1274",
    "cwe_id": "CWE-770",
    "filename": "src/test/java/org/springframework/data/mapping/PropertyPathUnitTests.java",
    "is_vulnerable": 0,
    "class_name": "PropertyPathUnitTests",
    "subclass_name": null,
    "function_name": "hashCodeTests()",
    "function_body": "{\n\n\t\tPropertyPath left = PropertyPath.from(\"user.name\", Bar.class);\n\t\tPropertyPath right = PropertyPath.from(\"user.name\", Bar.class);\n\n\t\tPropertyPath shortPath = PropertyPath.from(\"user\", Bar.class);\n\n\t\tassertThat(left.hashCode(), is(right.hashCode()));\n\t\tassertThat(left.hashCode(), is(not(shortPath.hashCode())));\n\t}"
  },
  {
    "id": 64,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 22,
    "human_patch": "https://github.com/spring-projects/spring-data-commons/commit/371f6590c509c72f8e600f3d05e110941607fba",
    "cve_id": "CVE-2018-1274",
    "cwe_id": "CWE-770",
    "filename": "src/test/java/org/springframework/data/mapping/PropertyPathUnitTests.java",
    "is_vulnerable": 0,
    "class_name": "PropertyPathUnitTests",
    "subclass_name": null,
    "function_name": "findsAllUppercaseProperty()",
    "function_body": "{\n\n\t\tPropertyPath path = PropertyPath.from(\"UUID\", Foo.class);\n\n\t\tassertThat(path, is(notNullValue()));\n\t\tassertThat(path.getSegment(), is(\"UUID\"));\n\t}"
  },
  {
    "id": 64,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 23,
    "human_patch": "https://github.com/spring-projects/spring-data-commons/commit/371f6590c509c72f8e600f3d05e110941607fba",
    "cve_id": "CVE-2018-1274",
    "cwe_id": "CWE-770",
    "filename": "src/test/java/org/springframework/data/mapping/PropertyPathUnitTests.java",
    "is_vulnerable": 0,
    "class_name": "PropertyPathUnitTests",
    "subclass_name": null,
    "function_name": "findsNestedAllUppercaseProperty()",
    "function_body": "{\n\n\t\tPropertyPath path = PropertyPath.from(\"_fooUUID\", Sample2.class);\n\n\t\tassertThat(path, is(notNullValue()));\n\t\tassertThat(path.getSegment(), is(\"_foo\"));\n\t\tassertThat(path.hasNext(), is(true));\n\t\tassertThat(path.next().getSegment(), is(\"UUID\"));\n\t}"
  },
  {
    "id": 64,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 24,
    "human_patch": "https://github.com/spring-projects/spring-data-commons/commit/371f6590c509c72f8e600f3d05e110941607fba",
    "cve_id": "CVE-2018-1274",
    "cwe_id": "CWE-770",
    "filename": "src/test/java/org/springframework/data/mapping/PropertyPathUnitTests.java",
    "is_vulnerable": 0,
    "class_name": "PropertyPathUnitTests",
    "subclass_name": null,
    "function_name": "exposesPreviouslyReferencedPathInExceptionMessage()",
    "function_body": "{\n\n\t\texception.expect(PropertyReferenceException.class);\n\t\texception.expectMessage(\"bar\"); \n\t\texception.expectMessage(\"String\"); \n\t\texception.expectMessage(\"Bar.user.name\"); \n\n\t\tPropertyPath.from(\"userNameBar\", Bar.class);\n\t}"
  },
  {
    "id": 64,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 25,
    "human_patch": "https://github.com/spring-projects/spring-data-commons/commit/371f6590c509c72f8e600f3d05e110941607fba",
    "cve_id": "CVE-2018-1274",
    "cwe_id": "CWE-770",
    "filename": "src/test/java/org/springframework/data/mapping/PropertyPathUnitTests.java",
    "is_vulnerable": 0,
    "class_name": "PropertyPathUnitTests",
    "subclass_name": null,
    "function_name": "rejectsNullSource()",
    "function_body": "{\n\t\tfrom(null, Foo.class);\n\t}"
  },
  {
    "id": 64,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 26,
    "human_patch": "https://github.com/spring-projects/spring-data-commons/commit/371f6590c509c72f8e600f3d05e110941607fba",
    "cve_id": "CVE-2018-1274",
    "cwe_id": "CWE-770",
    "filename": "src/test/java/org/springframework/data/mapping/PropertyPathUnitTests.java",
    "is_vulnerable": 0,
    "class_name": "PropertyPathUnitTests",
    "subclass_name": null,
    "function_name": "rejectsEmptySource()",
    "function_body": "{\n\t\tfrom(\"\", Foo.class);\n\t}"
  },
  {
    "id": 64,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 27,
    "human_patch": "https://github.com/spring-projects/spring-data-commons/commit/371f6590c509c72f8e600f3d05e110941607fba",
    "cve_id": "CVE-2018-1274",
    "cwe_id": "CWE-770",
    "filename": "src/test/java/org/springframework/data/mapping/PropertyPathUnitTests.java",
    "is_vulnerable": 0,
    "class_name": "PropertyPathUnitTests",
    "subclass_name": null,
    "function_name": "rejectsNullClass()",
    "function_body": "{\n\t\tfrom(\"foo\", (Class<?>) null);\n\t}"
  },
  {
    "id": 64,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 28,
    "human_patch": "https://github.com/spring-projects/spring-data-commons/commit/371f6590c509c72f8e600f3d05e110941607fba",
    "cve_id": "CVE-2018-1274",
    "cwe_id": "CWE-770",
    "filename": "src/test/java/org/springframework/data/mapping/PropertyPathUnitTests.java",
    "is_vulnerable": 0,
    "class_name": "PropertyPathUnitTests",
    "subclass_name": null,
    "function_name": "rejectsNullTypeInformation()",
    "function_body": "{\n\t\tfrom(\"foo\", (TypeInformation<?>) null);\n\t}"
  },
  {
    "id": 64,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 29,
    "human_patch": "https://github.com/spring-projects/spring-data-commons/commit/371f6590c509c72f8e600f3d05e110941607fba",
    "cve_id": "CVE-2018-1274",
    "cwe_id": "CWE-770",
    "filename": "src/test/java/org/springframework/data/mapping/PropertyPathUnitTests.java",
    "is_vulnerable": 0,
    "class_name": "PropertyPathUnitTests",
    "subclass_name": null,
    "function_name": "returnsCompletePathIfResolutionFailedCompletely()",
    "function_body": "{\n\n\t\texception.expect(PropertyReferenceException.class);\n\t\texception.expectMessage(\"somethingDifferent\");\n\n\t\tfrom(\"somethingDifferent\", Foo.class);\n\t}"
  },
  {
    "id": 64,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 30,
    "human_patch": "https://github.com/spring-projects/spring-data-commons/commit/371f6590c509c72f8e600f3d05e110941607fba",
    "cve_id": "CVE-2018-1274",
    "cwe_id": "CWE-770",
    "filename": "src/test/java/org/springframework/data/mapping/PropertyPathUnitTests.java",
    "is_vulnerable": 0,
    "class_name": "PropertyPathUnitTests",
    "subclass_name": null,
    "function_name": "includesResolvedPathInExceptionMessage()",
    "function_body": "{\n\n\t\texception.expect(PropertyReferenceException.class);\n\t\texception.expectMessage(\"fooName\");\n\t\texception.expectMessage(FooBar.class.getSimpleName());\n\t\texception.expectMessage(\"Bar.user\");\n\n\t\tfrom(\"userFooName\", Bar.class);\n\t}"
  },
  {
    "id": 64,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 31,
    "human_patch": "https://github.com/spring-projects/spring-data-commons/commit/371f6590c509c72f8e600f3d05e110941607fba",
    "cve_id": "CVE-2018-1274",
    "cwe_id": "CWE-770",
    "filename": "src/test/java/org/springframework/data/mapping/PropertyPathUnitTests.java",
    "is_vulnerable": 0,
    "class_name": "PropertyPathUnitTests",
    "subclass_name": null,
    "function_name": "includesPropertyHintsOnTypos()",
    "function_body": "{\n\n\t\texception.expect(PropertyReferenceException.class);\n\t\texception.expectMessage(\"userName\");\n\n\t\tfrom(\"userAme\", Foo.class);\n\t}"
  },
  {
    "id": 65,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 0,
    "human_patch": "https://github.com/spring-projects/spring-data-rest/commit/8f269e28fe8038a6c60f31a1c36cfda04795ab45",
    "cve_id": "CVE-2017-8046",
    "cwe_id": "CWE-20",
    "filename": "spring-data-rest-webmvc/src/main/java/org/springframework/data/rest/webmvc/json/patch/AddOperation.java",
    "is_vulnerable": 0,
    "class_name": "AddOperation",
    "subclass_name": null,
    "function_name": "perform(Object targetObject, Class<T> type)",
    "function_body": "{\n\t\taddValue(targetObject, evaluateValueFromTarget(targetObject, type));\n\t}"
  },
  {
    "id": 65,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 1,
    "human_patch": "https://github.com/spring-projects/spring-data-rest/commit/8f269e28fe8038a6c60f31a1c36cfda04795ab45",
    "cve_id": "CVE-2017-8046",
    "cwe_id": "CWE-20",
    "filename": "spring-data-rest-webmvc/src/main/java/org/springframework/data/rest/webmvc/json/patch/AddOperation.java",
    "is_vulnerable": 1,
    "class_name": "AddOperation",
    "subclass_name": null,
    "function_name": "evaluateValueFromTarget(Object targetObject, Class<T> entityType)",
    "function_body": "{\n\n\t\tif (!path.endsWith(\"-\")) {\n\t\t\treturn super.evaluateValueFromTarget(targetObject, entityType);\n\t\t}\n\n\t\tString pathSource = Arrays.stream(path.split(\"/\"))\n\t\t\t\t.filter(it -> !it.matches(\"\\\\d\")) \n\t\t\t\t.filter(it -> !it.equals(\"-\")) \n\t\t\t\t.filter(it -> !it.isEmpty()) \n\t\t\t\t.collect(Collectors.joining(\".\"));\n\n\t\tPropertyPath propertyPath = PropertyPath.from(pathSource, entityType);\n\n\t\treturn value instanceof LateObjectEvaluator ? ((LateObjectEvaluator) value).evaluate(propertyPath.getType())\n\t\t\t\t: value;\n\t}"
  },
  {
    "id": 65,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 0,
    "human_patch": "https://github.com/spring-projects/spring-data-rest/commit/8f269e28fe8038a6c60f31a1c36cfda04795ab45",
    "cve_id": "CVE-2017-8046",
    "cwe_id": "CWE-20",
    "filename": "spring-data-rest-webmvc/src/main/java/org/springframework/data/rest/webmvc/json/patch/PatchOperation.java",
    "is_vulnerable": 0,
    "class_name": "PatchOperation",
    "subclass_name": null,
    "function_name": "getOp()",
    "function_body": "{\n\t\treturn op;\n\t}"
  },
  {
    "id": 65,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 1,
    "human_patch": "https://github.com/spring-projects/spring-data-rest/commit/8f269e28fe8038a6c60f31a1c36cfda04795ab45",
    "cve_id": "CVE-2017-8046",
    "cwe_id": "CWE-20",
    "filename": "spring-data-rest-webmvc/src/main/java/org/springframework/data/rest/webmvc/json/patch/PatchOperation.java",
    "is_vulnerable": 0,
    "class_name": "PatchOperation",
    "subclass_name": null,
    "function_name": "getPath()",
    "function_body": "{\n\t\treturn path;\n\t}"
  },
  {
    "id": 65,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 2,
    "human_patch": "https://github.com/spring-projects/spring-data-rest/commit/8f269e28fe8038a6c60f31a1c36cfda04795ab45",
    "cve_id": "CVE-2017-8046",
    "cwe_id": "CWE-20",
    "filename": "spring-data-rest-webmvc/src/main/java/org/springframework/data/rest/webmvc/json/patch/PatchOperation.java",
    "is_vulnerable": 0,
    "class_name": "PatchOperation",
    "subclass_name": null,
    "function_name": "getValue()",
    "function_body": "{\n\t\treturn value;\n\t}"
  },
  {
    "id": 65,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 3,
    "human_patch": "https://github.com/spring-projects/spring-data-rest/commit/8f269e28fe8038a6c60f31a1c36cfda04795ab45",
    "cve_id": "CVE-2017-8046",
    "cwe_id": "CWE-20",
    "filename": "spring-data-rest-webmvc/src/main/java/org/springframework/data/rest/webmvc/json/patch/PatchOperation.java",
    "is_vulnerable": 0,
    "class_name": "PatchOperation",
    "subclass_name": null,
    "function_name": "popValueAtPath(Object target, String removePath)",
    "function_body": "{\n\n\t\tInteger listIndex = targetListIndex(removePath);\n\t\tExpression expression = pathToExpression(removePath);\n\t\tObject value = expression.getValue(target);\n\n\t\tif (listIndex == null) {\n\n\t\t\ttry {\n\t\t\t\texpression.setValue(target, null);\n\t\t\t\treturn value;\n\t\t\t} catch (SpelEvaluationException o_O) {\n\t\t\t\tthrow new PatchException(\"Path '\" + removePath + \"' is not nullable.\", o_O);\n\t\t\t}\n\n\t\t} else {\n\n\t\t\tExpression parentExpression = pathToParentExpression(removePath);\n\t\t\tList<?> list = (List<?>) parentExpression.getValue(target);\n\t\t\tlist.remove(listIndex >= 0 ? listIndex.intValue() : list.size() - 1);\n\t\t\treturn value;\n\t\t}\n\t}"
  },
  {
    "id": 65,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 4,
    "human_patch": "https://github.com/spring-projects/spring-data-rest/commit/8f269e28fe8038a6c60f31a1c36cfda04795ab45",
    "cve_id": "CVE-2017-8046",
    "cwe_id": "CWE-20",
    "filename": "spring-data-rest-webmvc/src/main/java/org/springframework/data/rest/webmvc/json/patch/PatchOperation.java",
    "is_vulnerable": 0,
    "class_name": "PatchOperation",
    "subclass_name": null,
    "function_name": "addValue(Object target, Object value)",
    "function_body": "{\n\n\t\tExpression parentExpression = pathToParentExpression(path);\n\t\tObject parent = parentExpression != null ? parentExpression.getValue(target) : null;\n\t\tInteger listIndex = targetListIndex(path);\n\n\t\tif (parent == null || !(parent instanceof List) || listIndex == null) {\n\n\t\t\tTypeDescriptor descriptor = parentExpression.getValueTypeDescriptor(target);\n\n\t\t\t\n\t\t\tif (descriptor.isCollection() && !Collection.class.isInstance(value)) {\n\n\t\t\t\tCollection<Object> collection = CollectionFactory.createCollection(descriptor.getType(), 1);\n\t\t\t\tcollection.add(value);\n\n\t\t\t\tparentExpression.setValue(target, collection);\n\n\t\t\t} else {\n\t\t\t\tspelExpression.setValue(target, value);\n\t\t\t}\n\n\t\t} else {\n\n\t\t\tList<Object> list = (List<Object>) parentExpression.getValue(target);\n\t\t\tlist.add(listIndex >= 0 ? listIndex.intValue() : list.size(), value);\n\t\t}\n\t}"
  },
  {
    "id": 65,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 5,
    "human_patch": "https://github.com/spring-projects/spring-data-rest/commit/8f269e28fe8038a6c60f31a1c36cfda04795ab45",
    "cve_id": "CVE-2017-8046",
    "cwe_id": "CWE-20",
    "filename": "spring-data-rest-webmvc/src/main/java/org/springframework/data/rest/webmvc/json/patch/PatchOperation.java",
    "is_vulnerable": 0,
    "class_name": "PatchOperation",
    "subclass_name": null,
    "function_name": "setValueOnTarget(Object target, Object value)",
    "function_body": "{\n\t\tspelExpression.setValue(target, value);\n\t}"
  },
  {
    "id": 65,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 6,
    "human_patch": "https://github.com/spring-projects/spring-data-rest/commit/8f269e28fe8038a6c60f31a1c36cfda04795ab45",
    "cve_id": "CVE-2017-8046",
    "cwe_id": "CWE-20",
    "filename": "spring-data-rest-webmvc/src/main/java/org/springframework/data/rest/webmvc/json/patch/PatchOperation.java",
    "is_vulnerable": 0,
    "class_name": "PatchOperation",
    "subclass_name": null,
    "function_name": "getValueFromTarget(Object target)",
    "function_body": "{\n\n\t\ttry {\n\t\t\treturn spelExpression.getValue(target);\n\t\t} catch (ExpressionException e) {\n\t\t\tthrow new PatchException(\"Unable to get value from target\", e);\n\t\t}\n\t}"
  },
  {
    "id": 65,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 7,
    "human_patch": "https://github.com/spring-projects/spring-data-rest/commit/8f269e28fe8038a6c60f31a1c36cfda04795ab45",
    "cve_id": "CVE-2017-8046",
    "cwe_id": "CWE-20",
    "filename": "spring-data-rest-webmvc/src/main/java/org/springframework/data/rest/webmvc/json/patch/PatchOperation.java",
    "is_vulnerable": 1,
    "class_name": "PatchOperation",
    "subclass_name": null,
    "function_name": "evaluateValueFromTarget(Object targetObject, Class<T> entityType)",
    "function_body": "{\n\n\t\treturn value instanceof LateObjectEvaluator\n\t\t\t\t? ((LateObjectEvaluator) value).evaluate(spelExpression.getValueType(targetObject)) : value;\n\t}"
  },
  {
    "id": 65,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 8,
    "human_patch": "https://github.com/spring-projects/spring-data-rest/commit/8f269e28fe8038a6c60f31a1c36cfda04795ab45",
    "cve_id": "CVE-2017-8046",
    "cwe_id": "CWE-20",
    "filename": "spring-data-rest-webmvc/src/main/java/org/springframework/data/rest/webmvc/json/patch/PatchOperation.java",
    "is_vulnerable": 0,
    "class_name": "PatchOperation",
    "subclass_name": null,
    "function_name": "perform(Object target, Class<T> type)",
    "function_body": null
  },
  {
    "id": 65,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 9,
    "human_patch": "https://github.com/spring-projects/spring-data-rest/commit/8f269e28fe8038a6c60f31a1c36cfda04795ab45",
    "cve_id": "CVE-2017-8046",
    "cwe_id": "CWE-20",
    "filename": "spring-data-rest-webmvc/src/main/java/org/springframework/data/rest/webmvc/json/patch/PatchOperation.java",
    "is_vulnerable": 0,
    "class_name": "PatchOperation",
    "subclass_name": null,
    "function_name": "targetListIndex(String path)",
    "function_body": "{\n\n\t\tString[] pathNodes = path.split(\"\\\\/\");\n\t\tString lastNode = pathNodes[pathNodes.length - 1];\n\n\t\tif (APPEND_CHARACTERS.contains(lastNode)) {\n\t\t\treturn -1;\n\t\t}\n\n\t\ttry {\n\t\t\treturn Integer.parseInt(lastNode);\n\t\t} catch (NumberFormatException e) {\n\t\t\treturn null;\n\t\t}\n\t}"
  },
  {
    "id": 65,
    "sub_id": 2,
    "code_id": 0,
    "function_id": 0,
    "human_patch": "https://github.com/spring-projects/spring-data-rest/commit/8f269e28fe8038a6c60f31a1c36cfda04795ab45",
    "cve_id": "CVE-2017-8046",
    "cwe_id": "CWE-20",
    "filename": "spring-data-rest-webmvc/src/test/java/org/springframework/data/rest/webmvc/json/patch/JsonPatchTests.java",
    "is_vulnerable": 0,
    "class_name": "JsonPatchTests",
    "subclass_name": null,
    "function_name": "manySuccessfulOperations() throws Exception",
    "function_body": "{\n\n\t\tList<Todo> todos = new ArrayList<Todo>();\n\t\ttodos.add(new Todo(1L, \"A\", true));\n\t\ttodos.add(new Todo(2L, \"B\", false));\n\t\ttodos.add(new Todo(3L, \"C\", false));\n\t\ttodos.add(new Todo(4L, \"D\", false));\n\t\ttodos.add(new Todo(5L, \"E\", false));\n\t\ttodos.add(new Todo(6L, \"F\", false));\n\n\t\tPatch patch = readJsonPatch(\"patch-many-successful-operations.json\");\n\t\tassertEquals(6, patch.size());\n\n\t\tList<Todo> patchedTodos = patch.apply(todos, Todo.class);\n\n\t\tassertEquals(6, todos.size());\n\t\tassertTrue(patchedTodos.get(1).isComplete());\n\t\tassertEquals(\"C\", patchedTodos.get(3).getDescription());\n\t\tassertEquals(\"A\", patchedTodos.get(4).getDescription());\n\t}"
  },
  {
    "id": 65,
    "sub_id": 2,
    "code_id": 0,
    "function_id": 1,
    "human_patch": "https://github.com/spring-projects/spring-data-rest/commit/8f269e28fe8038a6c60f31a1c36cfda04795ab45",
    "cve_id": "CVE-2017-8046",
    "cwe_id": "CWE-20",
    "filename": "spring-data-rest-webmvc/src/test/java/org/springframework/data/rest/webmvc/json/patch/JsonPatchTests.java",
    "is_vulnerable": 0,
    "class_name": "JsonPatchTests",
    "subclass_name": null,
    "function_name": "failureAtBeginning() throws Exception",
    "function_body": "{\n\n\t\tList<Todo> todos = new ArrayList<Todo>();\n\t\ttodos.add(new Todo(1L, \"A\", true));\n\t\ttodos.add(new Todo(2L, \"B\", false));\n\t\ttodos.add(new Todo(3L, \"C\", false));\n\t\ttodos.add(new Todo(4L, \"D\", false));\n\t\ttodos.add(new Todo(5L, \"E\", false));\n\t\ttodos.add(new Todo(6L, \"F\", false));\n\n\t\tPatch patch = readJsonPatch(\"patch-failing-operation-first.json\");\n\n\t\ttry {\n\t\t\tpatch.apply(todos, Todo.class);\n\t\t\tfail();\n\t\t} catch (PatchException e) {\n\t\t\tassertEquals(\"Test against path '/5/description' failed.\", e.getMessage());\n\t\t}\n\n\t\tassertEquals(6, todos.size());\n\t\tassertFalse(todos.get(1).isComplete());\n\t\tassertEquals(\"D\", todos.get(3).getDescription());\n\t\tassertEquals(\"E\", todos.get(4).getDescription());\n\t\tassertEquals(\"F\", todos.get(5).getDescription());\n\t}"
  },
  {
    "id": 65,
    "sub_id": 2,
    "code_id": 0,
    "function_id": 2,
    "human_patch": "https://github.com/spring-projects/spring-data-rest/commit/8f269e28fe8038a6c60f31a1c36cfda04795ab45",
    "cve_id": "CVE-2017-8046",
    "cwe_id": "CWE-20",
    "filename": "spring-data-rest-webmvc/src/test/java/org/springframework/data/rest/webmvc/json/patch/JsonPatchTests.java",
    "is_vulnerable": 0,
    "class_name": "JsonPatchTests",
    "subclass_name": null,
    "function_name": "failureInMiddle() throws Exception",
    "function_body": "{\n\n\t\tList<Todo> todos = new ArrayList<Todo>();\n\t\ttodos.add(new Todo(1L, \"A\", true));\n\t\ttodos.add(new Todo(2L, \"B\", false));\n\t\ttodos.add(new Todo(3L, \"C\", false));\n\t\ttodos.add(new Todo(4L, \"D\", false));\n\t\ttodos.add(new Todo(5L, \"E\", false));\n\t\ttodos.add(new Todo(6L, \"F\", false));\n\n\t\tPatch patch = readJsonPatch(\"patch-failing-operation-in-middle.json\");\n\n\t\ttry {\n\t\t\tpatch.apply(todos, Todo.class);\n\t\t\tfail();\n\t\t} catch (PatchException e) {\n\t\t\tassertEquals(\"Test against path '/5/description' failed.\", e.getMessage());\n\t\t}\n\n\t\tassertEquals(6, todos.size());\n\t\tassertFalse(todos.get(1).isComplete());\n\t\tassertEquals(\"D\", todos.get(3).getDescription());\n\t\tassertEquals(\"E\", todos.get(4).getDescription());\n\t\tassertEquals(\"F\", todos.get(5).getDescription());\n\t}"
  },
  {
    "id": 65,
    "sub_id": 2,
    "code_id": 0,
    "function_id": 3,
    "human_patch": "https://github.com/spring-projects/spring-data-rest/commit/8f269e28fe8038a6c60f31a1c36cfda04795ab45",
    "cve_id": "CVE-2017-8046",
    "cwe_id": "CWE-20",
    "filename": "spring-data-rest-webmvc/src/test/java/org/springframework/data/rest/webmvc/json/patch/JsonPatchTests.java",
    "is_vulnerable": 0,
    "class_name": "JsonPatchTests",
    "subclass_name": null,
    "function_name": "patchArray() throws Exception",
    "function_body": "{\n\n\t\tTodo todo = new Todo(1L, \"F\", false);\n\n\t\tPatch patch = readJsonPatch(\"patch-array.json\");\n\t\tassertEquals(1, patch.size());\n\n\t\tTodo patchedTodo = patch.apply(todo, Todo.class);\n\t\tassertEquals(Arrays.asList(\"one\", \"two\", \"three\"), patchedTodo.getItems());\n\t}"
  },
  {
    "id": 65,
    "sub_id": 2,
    "code_id": 0,
    "function_id": 4,
    "human_patch": "https://github.com/spring-projects/spring-data-rest/commit/8f269e28fe8038a6c60f31a1c36cfda04795ab45",
    "cve_id": "CVE-2017-8046",
    "cwe_id": "CWE-20",
    "filename": "spring-data-rest-webmvc/src/test/java/org/springframework/data/rest/webmvc/json/patch/JsonPatchTests.java",
    "is_vulnerable": 0,
    "class_name": "JsonPatchTests",
    "subclass_name": null,
    "function_name": "patchUnknownType() throws Exception",
    "function_body": "{\n\n\t\tTodo todo = new Todo();\n\t\ttodo.setAmount(BigInteger.ONE);\n\n\t\texception.expect(PatchException.class);\n\t\texception.expectMessage(\"/amount\");\n\t\texception.expectMessage(\"18446744073709551616\");\n\n\t\treadJsonPatch(\"patch-biginteger.json\");\n\t}"
  },
  {
    "id": 65,
    "sub_id": 2,
    "code_id": 0,
    "function_id": 5,
    "human_patch": "https://github.com/spring-projects/spring-data-rest/commit/8f269e28fe8038a6c60f31a1c36cfda04795ab45",
    "cve_id": "CVE-2017-8046",
    "cwe_id": "CWE-20",
    "filename": "spring-data-rest-webmvc/src/test/java/org/springframework/data/rest/webmvc/json/patch/JsonPatchTests.java",
    "is_vulnerable": 0,
    "class_name": "JsonPatchTests",
    "subclass_name": null,
    "function_name": "failureWithInvalidPatchContent() throws Exception",
    "function_body": "{\n\n\t\tTodo todo = new Todo();\n\t\ttodo.setDescription(\"Description\");\n\n\t\tPatch patch = readJsonPatch(\"patch-failing-with-invalid-content.json\");\n\n\t\texception.expect(PatchException.class);\n\t\texception.expectMessage(\"content\");\n\t\texception.expectMessage(\"blabla\");\n\t\texception.expectMessage(String.class.toString());\n\n\t\tpatch.apply(todo, Todo.class);\n\t}"
  },
  {
    "id": 65,
    "sub_id": 2,
    "code_id": 0,
    "function_id": 6,
    "human_patch": "https://github.com/spring-projects/spring-data-rest/commit/8f269e28fe8038a6c60f31a1c36cfda04795ab45",
    "cve_id": "CVE-2017-8046",
    "cwe_id": "CWE-20",
    "filename": "spring-data-rest-webmvc/src/test/java/org/springframework/data/rest/webmvc/json/patch/JsonPatchTests.java",
    "is_vulnerable": 0,
    "class_name": "JsonPatchTests",
    "subclass_name": null,
    "function_name": "readJsonPatch(String jsonPatchFile) throws IOException, JsonParseException, JsonMappingException",
    "function_body": "{\n\n\t\tClassPathResource resource = new ClassPathResource(jsonPatchFile, getClass());\n\t\tJsonNode node = new ObjectMapper().readValue(resource.getInputStream(), JsonNode.class);\n\t\tPatch patch = new JsonPatchPatchConverter(new ObjectMapper()).convert(node);\n\n\t\treturn patch;\n\t}"
  },
  {
    "id": 66,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 0,
    "human_patch": "https://github.com/spring-projects/spring-framework/commit/e2d6e709c3c65a4951eb096843ee75d5200cfcad",
    "cve_id": "CVE-2016-9878",
    "cwe_id": "CWE-22",
    "filename": "spring-webmvc/src/main/java/org/springframework/web/servlet/ResourceServlet.java",
    "is_vulnerable": 0,
    "class_name": "ResourceServlet",
    "subclass_name": null,
    "function_name": "setDefaultUrl(String defaultUrl)",
    "function_body": "{\n\t\tthis.defaultUrl = defaultUrl;\n\t}"
  },
  {
    "id": 66,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 1,
    "human_patch": "https://github.com/spring-projects/spring-framework/commit/e2d6e709c3c65a4951eb096843ee75d5200cfcad",
    "cve_id": "CVE-2016-9878",
    "cwe_id": "CWE-22",
    "filename": "spring-webmvc/src/main/java/org/springframework/web/servlet/ResourceServlet.java",
    "is_vulnerable": 0,
    "class_name": "ResourceServlet",
    "subclass_name": null,
    "function_name": "setAllowedResources(String allowedResources)",
    "function_body": "{\n\t\tthis.allowedResources = allowedResources;\n\t}"
  },
  {
    "id": 66,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 2,
    "human_patch": "https://github.com/spring-projects/spring-framework/commit/e2d6e709c3c65a4951eb096843ee75d5200cfcad",
    "cve_id": "CVE-2016-9878",
    "cwe_id": "CWE-22",
    "filename": "spring-webmvc/src/main/java/org/springframework/web/servlet/ResourceServlet.java",
    "is_vulnerable": 0,
    "class_name": "ResourceServlet",
    "subclass_name": null,
    "function_name": "setContentType(String contentType)",
    "function_body": "{\n\t\tthis.contentType = contentType;\n\t}"
  },
  {
    "id": 66,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 3,
    "human_patch": "https://github.com/spring-projects/spring-framework/commit/e2d6e709c3c65a4951eb096843ee75d5200cfcad",
    "cve_id": "CVE-2016-9878",
    "cwe_id": "CWE-22",
    "filename": "spring-webmvc/src/main/java/org/springframework/web/servlet/ResourceServlet.java",
    "is_vulnerable": 0,
    "class_name": "ResourceServlet",
    "subclass_name": null,
    "function_name": "setApplyLastModified(boolean applyLastModified)",
    "function_body": "{\n\t\tthis.applyLastModified = applyLastModified;\n\t}"
  },
  {
    "id": 66,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 4,
    "human_patch": "https://github.com/spring-projects/spring-framework/commit/e2d6e709c3c65a4951eb096843ee75d5200cfcad",
    "cve_id": "CVE-2016-9878",
    "cwe_id": "CWE-22",
    "filename": "spring-webmvc/src/main/java/org/springframework/web/servlet/ResourceServlet.java",
    "is_vulnerable": 0,
    "class_name": "ResourceServlet",
    "subclass_name": null,
    "function_name": "initServletBean()",
    "function_body": "{\n\t\tthis.pathMatcher = getPathMatcher();\n\t\tthis.startupTime = System.currentTimeMillis();\n\t}"
  },
  {
    "id": 66,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 5,
    "human_patch": "https://github.com/spring-projects/spring-framework/commit/e2d6e709c3c65a4951eb096843ee75d5200cfcad",
    "cve_id": "CVE-2016-9878",
    "cwe_id": "CWE-22",
    "filename": "spring-webmvc/src/main/java/org/springframework/web/servlet/ResourceServlet.java",
    "is_vulnerable": 0,
    "class_name": "ResourceServlet",
    "subclass_name": null,
    "function_name": "getPathMatcher()",
    "function_body": "{\n\t\treturn new AntPathMatcher();\n\t}"
  },
  {
    "id": 66,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 6,
    "human_patch": "https://github.com/spring-projects/spring-framework/commit/e2d6e709c3c65a4951eb096843ee75d5200cfcad",
    "cve_id": "CVE-2016-9878",
    "cwe_id": "CWE-22",
    "filename": "spring-webmvc/src/main/java/org/springframework/web/servlet/ResourceServlet.java",
    "is_vulnerable": 0,
    "class_name": "ResourceServlet",
    "subclass_name": null,
    "function_name": "doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException",
    "function_body": "{\n\n\t\t\n\t\tString resourceUrl = determineResourceUrl(request);\n\n\t\tif (resourceUrl != null) {\n\t\t\ttry {\n\t\t\t\tdoInclude(request, response, resourceUrl);\n\t\t\t}\n\t\t\tcatch (ServletException ex) {\n\t\t\t\tif (logger.isWarnEnabled()) {\n\t\t\t\t\tlogger.warn(\"Failed to include content of resource [\" + resourceUrl + \"]\", ex);\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tif (!includeDefaultUrl(request, response)) {\n\t\t\t\t\tthrow ex;\n\t\t\t\t}\n\t\t\t}\n\t\t\tcatch (IOException ex) {\n\t\t\t\tif (logger.isWarnEnabled()) {\n\t\t\t\t\tlogger.warn(\"Failed to include content of resource [\" + resourceUrl + \"]\", ex);\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tif (!includeDefaultUrl(request, response)) {\n\t\t\t\t\tthrow ex;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t\n\t\telse if (!includeDefaultUrl(request, response)) {\n\t\t\tthrow new ServletException(\"No target resource URL found for request\");\n\t\t}\n\t}"
  },
  {
    "id": 66,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 7,
    "human_patch": "https://github.com/spring-projects/spring-framework/commit/e2d6e709c3c65a4951eb096843ee75d5200cfcad",
    "cve_id": "CVE-2016-9878",
    "cwe_id": "CWE-22",
    "filename": "spring-webmvc/src/main/java/org/springframework/web/servlet/ResourceServlet.java",
    "is_vulnerable": 0,
    "class_name": "ResourceServlet",
    "subclass_name": null,
    "function_name": "determineResourceUrl(HttpServletRequest request)",
    "function_body": "{\n\t\treturn request.getParameter(RESOURCE_PARAM_NAME);\n\t}"
  },
  {
    "id": 66,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 8,
    "human_patch": "https://github.com/spring-projects/spring-framework/commit/e2d6e709c3c65a4951eb096843ee75d5200cfcad",
    "cve_id": "CVE-2016-9878",
    "cwe_id": "CWE-22",
    "filename": "spring-webmvc/src/main/java/org/springframework/web/servlet/ResourceServlet.java",
    "is_vulnerable": 0,
    "class_name": "ResourceServlet",
    "subclass_name": null,
    "function_name": "includeDefaultUrl(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException",
    "function_body": "{\n\n\t\tif (this.defaultUrl == null) {\n\t\t\treturn false;\n\t\t}\n\t\tdoInclude(request, response, this.defaultUrl);\n\t\treturn true;\n\t}"
  },
  {
    "id": 66,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 9,
    "human_patch": "https://github.com/spring-projects/spring-framework/commit/e2d6e709c3c65a4951eb096843ee75d5200cfcad",
    "cve_id": "CVE-2016-9878",
    "cwe_id": "CWE-22",
    "filename": "spring-webmvc/src/main/java/org/springframework/web/servlet/ResourceServlet.java",
    "is_vulnerable": 1,
    "class_name": "ResourceServlet",
    "subclass_name": null,
    "function_name": "doInclude(HttpServletRequest request, HttpServletResponse response, String resourceUrl) throws ServletException, IOException",
    "function_body": "{\n\n\t\tif (this.contentType != null) {\n\t\t\tresponse.setContentType(this.contentType);\n\t\t}\n\n\t\tString[] resourceUrls = StringUtils.tokenizeToStringArray(resourceUrl, RESOURCE_URL_DELIMITERS);\n\t\tfor (String url : resourceUrls) {\n\t\t\t\n\t\t\tif (this.allowedResources != null && !this.pathMatcher.match(this.allowedResources, url)) {\n\t\t\t\tthrow new ServletException(\"Resource [\" + url +\n\t\t\t\t\t\t\"] does not match allowed pattern [\" + this.allowedResources + \"]\");\n\t\t\t}\n\t\t\tif (logger.isDebugEnabled()) {\n\t\t\t\tlogger.debug(\"Including resource [\" + url + \"]\");\n\t\t\t}\n\t\t\tRequestDispatcher rd = request.getRequestDispatcher(url);\n\t\t\trd.include(request, response);\n\t\t}\n\t}"
  },
  {
    "id": 66,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 10,
    "human_patch": "https://github.com/spring-projects/spring-framework/commit/e2d6e709c3c65a4951eb096843ee75d5200cfcad",
    "cve_id": "CVE-2016-9878",
    "cwe_id": "CWE-22",
    "filename": "spring-webmvc/src/main/java/org/springframework/web/servlet/ResourceServlet.java",
    "is_vulnerable": 0,
    "class_name": "ResourceServlet",
    "subclass_name": null,
    "function_name": "getLastModified(HttpServletRequest request)",
    "function_body": "{\n\t\tif (this.applyLastModified) {\n\t\t\tString resourceUrl = determineResourceUrl(request);\n\t\t\tif (resourceUrl == null) {\n\t\t\t\tresourceUrl = this.defaultUrl;\n\t\t\t}\n\t\t\tif (resourceUrl != null) {\n\t\t\t\tString[] resourceUrls = StringUtils.tokenizeToStringArray(resourceUrl, RESOURCE_URL_DELIMITERS);\n\t\t\t\tlong latestTimestamp = -1;\n\t\t\t\tfor (String url : resourceUrls) {\n\t\t\t\t\tlong timestamp = getFileTimestamp(url);\n\t\t\t\t\tif (timestamp > latestTimestamp) {\n\t\t\t\t\t\tlatestTimestamp = timestamp;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn (latestTimestamp > this.startupTime ? latestTimestamp : this.startupTime);\n\t\t\t}\n\t\t}\n\t\treturn -1;\n\t}"
  },
  {
    "id": 66,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 11,
    "human_patch": "https://github.com/spring-projects/spring-framework/commit/e2d6e709c3c65a4951eb096843ee75d5200cfcad",
    "cve_id": "CVE-2016-9878",
    "cwe_id": "CWE-22",
    "filename": "spring-webmvc/src/main/java/org/springframework/web/servlet/ResourceServlet.java",
    "is_vulnerable": 0,
    "class_name": "ResourceServlet",
    "subclass_name": null,
    "function_name": "getFileTimestamp(String resourceUrl)",
    "function_body": "{\n\t\tServletContextResource resource = new ServletContextResource(getServletContext(), resourceUrl);\n\t\ttry {\n\t\t\tlong lastModifiedTime = resource.lastModified();\n\t\t\tif (logger.isDebugEnabled()) {\n\t\t\t\tlogger.debug(\"Last-modified timestamp of \" + resource + \" is \" + lastModifiedTime);\n\t\t\t}\n\t\t\treturn lastModifiedTime;\n\t\t}\n\t\tcatch (IOException ex) {\n\t\t\tif (logger.isWarnEnabled()) {\n\t\t\t\tlogger.warn(\"Couldn't retrieve last-modified timestamp of \" + resource +\n\t\t\t\t\t\t\" - using ResourceServlet startup time\");\n\t\t\t}\n\t\t\treturn -1;\n\t\t}\n\t}"
  },
  {
    "id": 67,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 0,
    "human_patch": "https://github.com/spring-projects/spring-framework/commit/423aa28ed584b4ff6e5bad218c09beef5e91951",
    "cve_id": "CVE-2018-15756",
    "cwe_id": "Not Mapping",
    "filename": "spring-web/src/main/java/org/springframework/http/HttpRange.java",
    "is_vulnerable": 1,
    "class_name": "HttpRange",
    "subclass_name": null,
    "function_name": "toResourceRegion(Resource resource)",
    "function_body": "{\n\t\t\n\t\t\n\t\tAssert.isTrue(resource.getClass() != InputStreamResource.class,\n\t\t\t\t\"Cannot convert an InputStreamResource to a ResourceRegion\");\n\t\ttry {\n\t\t\tlong contentLength = resource.contentLength();\n\t\t\tAssert.isTrue(contentLength > 0, \"Resource content length should be > 0\");\n\t\t\tlong start = getRangeStart(contentLength);\n\t\t\tlong end = getRangeEnd(contentLength);\n\t\t\treturn new ResourceRegion(resource, start, end - start + 1);\n\t\t}\n\t\tcatch (IOException ex) {\n\t\t\tthrow new IllegalArgumentException(\"Failed to convert Resource to ResourceRegion\", ex);\n\t\t}\n\t}"
  },
  {
    "id": 67,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 1,
    "human_patch": "https://github.com/spring-projects/spring-framework/commit/423aa28ed584b4ff6e5bad218c09beef5e91951",
    "cve_id": "CVE-2018-15756",
    "cwe_id": "Not Mapping",
    "filename": "spring-web/src/main/java/org/springframework/http/HttpRange.java",
    "is_vulnerable": 0,
    "class_name": "HttpRange",
    "subclass_name": null,
    "function_name": "getRangeStart(long length)",
    "function_body": null
  },
  {
    "id": 67,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 2,
    "human_patch": "https://github.com/spring-projects/spring-framework/commit/423aa28ed584b4ff6e5bad218c09beef5e91951",
    "cve_id": "CVE-2018-15756",
    "cwe_id": "Not Mapping",
    "filename": "spring-web/src/main/java/org/springframework/http/HttpRange.java",
    "is_vulnerable": 0,
    "class_name": "HttpRange",
    "subclass_name": null,
    "function_name": "getRangeEnd(long length)",
    "function_body": null
  },
  {
    "id": 67,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 3,
    "human_patch": "https://github.com/spring-projects/spring-framework/commit/423aa28ed584b4ff6e5bad218c09beef5e91951",
    "cve_id": "CVE-2018-15756",
    "cwe_id": "Not Mapping",
    "filename": "spring-web/src/main/java/org/springframework/http/HttpRange.java",
    "is_vulnerable": 0,
    "class_name": "HttpRange",
    "subclass_name": null,
    "function_name": "createByteRange(long firstBytePos)",
    "function_body": "{\n\t\treturn new ByteRange(firstBytePos, null);\n\t}"
  },
  {
    "id": 67,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 4,
    "human_patch": "https://github.com/spring-projects/spring-framework/commit/423aa28ed584b4ff6e5bad218c09beef5e91951",
    "cve_id": "CVE-2018-15756",
    "cwe_id": "Not Mapping",
    "filename": "spring-web/src/main/java/org/springframework/http/HttpRange.java",
    "is_vulnerable": 0,
    "class_name": "HttpRange",
    "subclass_name": null,
    "function_name": "createByteRange(long firstBytePos, long lastBytePos)",
    "function_body": "{\n\t\treturn new ByteRange(firstBytePos, lastBytePos);\n\t}"
  },
  {
    "id": 67,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 5,
    "human_patch": "https://github.com/spring-projects/spring-framework/commit/423aa28ed584b4ff6e5bad218c09beef5e91951",
    "cve_id": "CVE-2018-15756",
    "cwe_id": "Not Mapping",
    "filename": "spring-web/src/main/java/org/springframework/http/HttpRange.java",
    "is_vulnerable": 0,
    "class_name": "HttpRange",
    "subclass_name": null,
    "function_name": "createSuffixRange(long suffixLength)",
    "function_body": "{\n\t\treturn new SuffixByteRange(suffixLength);\n\t}"
  },
  {
    "id": 67,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 6,
    "human_patch": "https://github.com/spring-projects/spring-framework/commit/423aa28ed584b4ff6e5bad218c09beef5e91951",
    "cve_id": "CVE-2018-15756",
    "cwe_id": "Not Mapping",
    "filename": "spring-web/src/main/java/org/springframework/http/HttpRange.java",
    "is_vulnerable": 1,
    "class_name": "HttpRange",
    "subclass_name": null,
    "function_name": "parseRanges(@Nullable String ranges)",
    "function_body": "{\n\t\tif (!StringUtils.hasLength(ranges)) {\n\t\t\treturn Collections.emptyList();\n\t\t}\n\t\tif (!ranges.startsWith(BYTE_RANGE_PREFIX)) {\n\t\t\tthrow new IllegalArgumentException(\"Range '\" + ranges + \"' does not start with 'bytes='\");\n\t\t}\n\t\tranges = ranges.substring(BYTE_RANGE_PREFIX.length());\n\n\t\tString[] tokens = StringUtils.tokenizeToStringArray(ranges, \",\");\n\t\tList<HttpRange> result = new ArrayList<>(tokens.length);\n\t\tfor (String token : tokens) {\n\t\t\tresult.add(parseRange(token));\n\t\t}\n\t\treturn result;\n\t}"
  },
  {
    "id": 67,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 7,
    "human_patch": "https://github.com/spring-projects/spring-framework/commit/423aa28ed584b4ff6e5bad218c09beef5e91951",
    "cve_id": "CVE-2018-15756",
    "cwe_id": "Not Mapping",
    "filename": "spring-web/src/main/java/org/springframework/http/HttpRange.java",
    "is_vulnerable": 0,
    "class_name": "HttpRange",
    "subclass_name": null,
    "function_name": "parseRange(String range)",
    "function_body": "{\n\t\tAssert.hasLength(range, \"Range String must not be empty\");\n\t\tint dashIdx = range.indexOf('-');\n\t\tif (dashIdx > 0) {\n\t\t\tlong firstPos = Long.parseLong(range.substring(0, dashIdx));\n\t\t\tif (dashIdx < range.length() - 1) {\n\t\t\t\tLong lastPos = Long.parseLong(range.substring(dashIdx + 1, range.length()));\n\t\t\t\treturn new ByteRange(firstPos, lastPos);\n\t\t\t}\n\t\t\telse {\n\t\t\t\treturn new ByteRange(firstPos, null);\n\t\t\t}\n\t\t}\n\t\telse if (dashIdx == 0) {\n\t\t\tlong suffixLength = Long.parseLong(range.substring(1));\n\t\t\treturn new SuffixByteRange(suffixLength);\n\t\t}\n\t\telse {\n\t\t\tthrow new IllegalArgumentException(\"Range '\" + range + \"' does not contain \\\"-\\\"\");\n\t\t}\n\t}"
  },
  {
    "id": 67,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 8,
    "human_patch": "https://github.com/spring-projects/spring-framework/commit/423aa28ed584b4ff6e5bad218c09beef5e91951",
    "cve_id": "CVE-2018-15756",
    "cwe_id": "Not Mapping",
    "filename": "spring-web/src/main/java/org/springframework/http/HttpRange.java",
    "is_vulnerable": 1,
    "class_name": "HttpRange",
    "subclass_name": null,
    "function_name": "toResourceRegions(List<HttpRange> ranges, Resource resource)",
    "function_body": "{\n\t\tif (CollectionUtils.isEmpty(ranges)) {\n\t\t\treturn Collections.emptyList();\n\t\t}\n\t\tList<ResourceRegion> regions = new ArrayList<>(ranges.size());\n\t\tfor (HttpRange range : ranges) {\n\t\t\tregions.add(range.toResourceRegion(resource));\n\t\t}\n\t\treturn regions;\n\t}"
  },
  {
    "id": 67,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 9,
    "human_patch": "https://github.com/spring-projects/spring-framework/commit/423aa28ed584b4ff6e5bad218c09beef5e91951",
    "cve_id": "CVE-2018-15756",
    "cwe_id": "Not Mapping",
    "filename": "spring-web/src/main/java/org/springframework/http/HttpRange.java",
    "is_vulnerable": 0,
    "class_name": "HttpRange",
    "subclass_name": null,
    "function_name": "toString(Collection<HttpRange> ranges)",
    "function_body": "{\n\t\tAssert.notEmpty(ranges, \"Ranges Collection must not be empty\");\n\t\tStringBuilder builder = new StringBuilder(BYTE_RANGE_PREFIX);\n\t\tfor (Iterator<HttpRange> iterator = ranges.iterator(); iterator.hasNext(); ) {\n\t\t\tHttpRange range = iterator.next();\n\t\t\tbuilder.append(range);\n\t\t\tif (iterator.hasNext()) {\n\t\t\t\tbuilder.append(\", \");\n\t\t\t}\n\t\t}\n\t\treturn builder.toString();\n\t}"
  },
  {
    "id": 67,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 10,
    "human_patch": "https://github.com/spring-projects/spring-framework/commit/423aa28ed584b4ff6e5bad218c09beef5e91951",
    "cve_id": "CVE-2018-15756",
    "cwe_id": "Not Mapping",
    "filename": "spring-web/src/main/java/org/springframework/http/HttpRange.java",
    "is_vulnerable": 0,
    "class_name": "HttpRange",
    "subclass_name": "ByteRange",
    "function_name": "assertPositions(long firstBytePos, @Nullable Long lastBytePos)",
    "function_body": "{\n\t\t\tif (firstBytePos < 0) {\n\t\t\t\tthrow new IllegalArgumentException(\"Invalid first byte position: \" + firstBytePos);\n\t\t\t}\n\t\t\tif (lastBytePos != null && lastBytePos < firstBytePos) {\n\t\t\t\tthrow new IllegalArgumentException(\"firstBytePosition=\" + firstBytePos +\n\t\t\t\t\t\t\" should be less then or equal to lastBytePosition=\" + lastBytePos);\n\t\t\t}\n\t\t}"
  },
  {
    "id": 67,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 11,
    "human_patch": "https://github.com/spring-projects/spring-framework/commit/423aa28ed584b4ff6e5bad218c09beef5e91951",
    "cve_id": "CVE-2018-15756",
    "cwe_id": "Not Mapping",
    "filename": "spring-web/src/main/java/org/springframework/http/HttpRange.java",
    "is_vulnerable": 0,
    "class_name": "HttpRange",
    "subclass_name": "ByteRange",
    "function_name": "getRangeStart(long length)",
    "function_body": "{\n\t\t\treturn this.firstPos;\n\t\t}"
  },
  {
    "id": 67,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 12,
    "human_patch": "https://github.com/spring-projects/spring-framework/commit/423aa28ed584b4ff6e5bad218c09beef5e91951",
    "cve_id": "CVE-2018-15756",
    "cwe_id": "Not Mapping",
    "filename": "spring-web/src/main/java/org/springframework/http/HttpRange.java",
    "is_vulnerable": 0,
    "class_name": "HttpRange",
    "subclass_name": "ByteRange",
    "function_name": "getRangeEnd(long length)",
    "function_body": "{\n\t\t\tif (this.lastPos != null && this.lastPos < length) {\n\t\t\t\treturn this.lastPos;\n\t\t\t}\n\t\t\telse {\n\t\t\t\treturn length - 1;\n\t\t\t}\n\t\t}"
  },
  {
    "id": 67,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 13,
    "human_patch": "https://github.com/spring-projects/spring-framework/commit/423aa28ed584b4ff6e5bad218c09beef5e91951",
    "cve_id": "CVE-2018-15756",
    "cwe_id": "Not Mapping",
    "filename": "spring-web/src/main/java/org/springframework/http/HttpRange.java",
    "is_vulnerable": 0,
    "class_name": "HttpRange",
    "subclass_name": "ByteRange",
    "function_name": "equals(Object other)",
    "function_body": "{\n\t\t\tif (this == other) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\tif (!(other instanceof ByteRange)) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tByteRange otherRange = (ByteRange) other;\n\t\t\treturn (this.firstPos == otherRange.firstPos &&\n\t\t\t\t\tObjectUtils.nullSafeEquals(this.lastPos, otherRange.lastPos));\n\t\t}"
  },
  {
    "id": 67,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 14,
    "human_patch": "https://github.com/spring-projects/spring-framework/commit/423aa28ed584b4ff6e5bad218c09beef5e91951",
    "cve_id": "CVE-2018-15756",
    "cwe_id": "Not Mapping",
    "filename": "spring-web/src/main/java/org/springframework/http/HttpRange.java",
    "is_vulnerable": 0,
    "class_name": "HttpRange",
    "subclass_name": "ByteRange",
    "function_name": "hashCode()",
    "function_body": "{\n\t\t\treturn (ObjectUtils.nullSafeHashCode(this.firstPos) * 31 +\n\t\t\t\t\tObjectUtils.nullSafeHashCode(this.lastPos));\n\t\t}"
  },
  {
    "id": 67,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 15,
    "human_patch": "https://github.com/spring-projects/spring-framework/commit/423aa28ed584b4ff6e5bad218c09beef5e91951",
    "cve_id": "CVE-2018-15756",
    "cwe_id": "Not Mapping",
    "filename": "spring-web/src/main/java/org/springframework/http/HttpRange.java",
    "is_vulnerable": 0,
    "class_name": "HttpRange",
    "subclass_name": "ByteRange",
    "function_name": "toString()",
    "function_body": "{\n\t\t\tStringBuilder builder = new StringBuilder();\n\t\t\tbuilder.append(this.firstPos);\n\t\t\tbuilder.append('-');\n\t\t\tif (this.lastPos != null) {\n\t\t\t\tbuilder.append(this.lastPos);\n\t\t\t}\n\t\t\treturn builder.toString();\n\t\t}"
  },
  {
    "id": 67,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 16,
    "human_patch": "https://github.com/spring-projects/spring-framework/commit/423aa28ed584b4ff6e5bad218c09beef5e91951",
    "cve_id": "CVE-2018-15756",
    "cwe_id": "Not Mapping",
    "filename": "spring-web/src/main/java/org/springframework/http/HttpRange.java",
    "is_vulnerable": 0,
    "class_name": "HttpRange",
    "subclass_name": "SuffixByteRange",
    "function_name": "getRangeStart(long length)",
    "function_body": "{\n\t\t\tif (this.suffixLength < length) {\n\t\t\t\treturn length - this.suffixLength;\n\t\t\t}\n\t\t\telse {\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t}"
  },
  {
    "id": 67,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 17,
    "human_patch": "https://github.com/spring-projects/spring-framework/commit/423aa28ed584b4ff6e5bad218c09beef5e91951",
    "cve_id": "CVE-2018-15756",
    "cwe_id": "Not Mapping",
    "filename": "spring-web/src/main/java/org/springframework/http/HttpRange.java",
    "is_vulnerable": 0,
    "class_name": "HttpRange",
    "subclass_name": "SuffixByteRange",
    "function_name": "getRangeEnd(long length)",
    "function_body": "{\n\t\t\treturn length - 1;\n\t\t}"
  },
  {
    "id": 67,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 18,
    "human_patch": "https://github.com/spring-projects/spring-framework/commit/423aa28ed584b4ff6e5bad218c09beef5e91951",
    "cve_id": "CVE-2018-15756",
    "cwe_id": "Not Mapping",
    "filename": "spring-web/src/main/java/org/springframework/http/HttpRange.java",
    "is_vulnerable": 0,
    "class_name": "HttpRange",
    "subclass_name": "SuffixByteRange",
    "function_name": "equals(Object other)",
    "function_body": "{\n\t\t\tif (this == other) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\tif (!(other instanceof SuffixByteRange)) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tSuffixByteRange otherRange = (SuffixByteRange) other;\n\t\t\treturn (this.suffixLength == otherRange.suffixLength);\n\t\t}"
  },
  {
    "id": 67,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 19,
    "human_patch": "https://github.com/spring-projects/spring-framework/commit/423aa28ed584b4ff6e5bad218c09beef5e91951",
    "cve_id": "CVE-2018-15756",
    "cwe_id": "Not Mapping",
    "filename": "spring-web/src/main/java/org/springframework/http/HttpRange.java",
    "is_vulnerable": 0,
    "class_name": "HttpRange",
    "subclass_name": "SuffixByteRange",
    "function_name": "hashCode()",
    "function_body": "{\n\t\t\treturn Long.hashCode(this.suffixLength);\n\t\t}"
  },
  {
    "id": 67,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 20,
    "human_patch": "https://github.com/spring-projects/spring-framework/commit/423aa28ed584b4ff6e5bad218c09beef5e91951",
    "cve_id": "CVE-2018-15756",
    "cwe_id": "Not Mapping",
    "filename": "spring-web/src/main/java/org/springframework/http/HttpRange.java",
    "is_vulnerable": 0,
    "class_name": "HttpRange",
    "subclass_name": "SuffixByteRange",
    "function_name": "toString()",
    "function_body": "{\n\t\t\treturn \"-\" + this.suffixLength;\n\t\t}"
  },
  {
    "id": 67,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 0,
    "human_patch": "https://github.com/spring-projects/spring-framework/commit/423aa28ed584b4ff6e5bad218c09beef5e91951",
    "cve_id": "CVE-2018-15756",
    "cwe_id": "Not Mapping",
    "filename": "spring-web/src/test/java/org/springframework/http/HttpRangeTests.java",
    "is_vulnerable": 0,
    "class_name": "HttpRangeTests",
    "subclass_name": null,
    "function_name": "invalidFirstPosition()",
    "function_body": "{\n\t\tHttpRange.createByteRange(-1);\n\t}"
  },
  {
    "id": 67,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 1,
    "human_patch": "https://github.com/spring-projects/spring-framework/commit/423aa28ed584b4ff6e5bad218c09beef5e91951",
    "cve_id": "CVE-2018-15756",
    "cwe_id": "Not Mapping",
    "filename": "spring-web/src/test/java/org/springframework/http/HttpRangeTests.java",
    "is_vulnerable": 0,
    "class_name": "HttpRangeTests",
    "subclass_name": null,
    "function_name": "invalidLastLessThanFirst()",
    "function_body": "{\n\t\tHttpRange.createByteRange(10, 9);\n\t}"
  },
  {
    "id": 67,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 2,
    "human_patch": "https://github.com/spring-projects/spring-framework/commit/423aa28ed584b4ff6e5bad218c09beef5e91951",
    "cve_id": "CVE-2018-15756",
    "cwe_id": "Not Mapping",
    "filename": "spring-web/src/test/java/org/springframework/http/HttpRangeTests.java",
    "is_vulnerable": 0,
    "class_name": "HttpRangeTests",
    "subclass_name": null,
    "function_name": "invalidSuffixLength()",
    "function_body": "{\n\t\tHttpRange.createSuffixRange(-1);\n\t}"
  },
  {
    "id": 67,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 3,
    "human_patch": "https://github.com/spring-projects/spring-framework/commit/423aa28ed584b4ff6e5bad218c09beef5e91951",
    "cve_id": "CVE-2018-15756",
    "cwe_id": "Not Mapping",
    "filename": "spring-web/src/test/java/org/springframework/http/HttpRangeTests.java",
    "is_vulnerable": 0,
    "class_name": "HttpRangeTests",
    "subclass_name": null,
    "function_name": "byteRange()",
    "function_body": "{\n\t\tHttpRange range = HttpRange.createByteRange(0, 499);\n\t\tassertEquals(0, range.getRangeStart(1000));\n\t\tassertEquals(499, range.getRangeEnd(1000));\n\t}"
  },
  {
    "id": 67,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 4,
    "human_patch": "https://github.com/spring-projects/spring-framework/commit/423aa28ed584b4ff6e5bad218c09beef5e91951",
    "cve_id": "CVE-2018-15756",
    "cwe_id": "Not Mapping",
    "filename": "spring-web/src/test/java/org/springframework/http/HttpRangeTests.java",
    "is_vulnerable": 0,
    "class_name": "HttpRangeTests",
    "subclass_name": null,
    "function_name": "byteRangeWithoutLastPosition()",
    "function_body": "{\n\t\tHttpRange range = HttpRange.createByteRange(9500);\n\t\tassertEquals(9500, range.getRangeStart(10000));\n\t\tassertEquals(9999, range.getRangeEnd(10000));\n\t}"
  },
  {
    "id": 67,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 5,
    "human_patch": "https://github.com/spring-projects/spring-framework/commit/423aa28ed584b4ff6e5bad218c09beef5e91951",
    "cve_id": "CVE-2018-15756",
    "cwe_id": "Not Mapping",
    "filename": "spring-web/src/test/java/org/springframework/http/HttpRangeTests.java",
    "is_vulnerable": 0,
    "class_name": "HttpRangeTests",
    "subclass_name": null,
    "function_name": "byteRangeOfZeroLength()",
    "function_body": "{\n\t\tHttpRange range = HttpRange.createByteRange(9500, 9500);\n\t\tassertEquals(9500, range.getRangeStart(10000));\n\t\tassertEquals(9500, range.getRangeEnd(10000));\n\t}"
  },
  {
    "id": 67,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 6,
    "human_patch": "https://github.com/spring-projects/spring-framework/commit/423aa28ed584b4ff6e5bad218c09beef5e91951",
    "cve_id": "CVE-2018-15756",
    "cwe_id": "Not Mapping",
    "filename": "spring-web/src/test/java/org/springframework/http/HttpRangeTests.java",
    "is_vulnerable": 0,
    "class_name": "HttpRangeTests",
    "subclass_name": null,
    "function_name": "suffixRange()",
    "function_body": "{\n\t\tHttpRange range = HttpRange.createSuffixRange(500);\n\t\tassertEquals(500, range.getRangeStart(1000));\n\t\tassertEquals(999, range.getRangeEnd(1000));\n\t}"
  },
  {
    "id": 67,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 7,
    "human_patch": "https://github.com/spring-projects/spring-framework/commit/423aa28ed584b4ff6e5bad218c09beef5e91951",
    "cve_id": "CVE-2018-15756",
    "cwe_id": "Not Mapping",
    "filename": "spring-web/src/test/java/org/springframework/http/HttpRangeTests.java",
    "is_vulnerable": 0,
    "class_name": "HttpRangeTests",
    "subclass_name": null,
    "function_name": "suffixRangeShorterThanRepresentation()",
    "function_body": "{\n\t\tHttpRange range = HttpRange.createSuffixRange(500);\n\t\tassertEquals(0, range.getRangeStart(350));\n\t\tassertEquals(349, range.getRangeEnd(350));\n\t}"
  },
  {
    "id": 67,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 8,
    "human_patch": "https://github.com/spring-projects/spring-framework/commit/423aa28ed584b4ff6e5bad218c09beef5e91951",
    "cve_id": "CVE-2018-15756",
    "cwe_id": "Not Mapping",
    "filename": "spring-web/src/test/java/org/springframework/http/HttpRangeTests.java",
    "is_vulnerable": 0,
    "class_name": "HttpRangeTests",
    "subclass_name": null,
    "function_name": "parseRanges()",
    "function_body": "{\n\t\tList<HttpRange> ranges = HttpRange.parseRanges(\"bytes=0-0,500-,-1\");\n\t\tassertEquals(3, ranges.size());\n\t\tassertEquals(0, ranges.get(0).getRangeStart(1000));\n\t\tassertEquals(0, ranges.get(0).getRangeEnd(1000));\n\t\tassertEquals(500, ranges.get(1).getRangeStart(1000));\n\t\tassertEquals(999, ranges.get(1).getRangeEnd(1000));\n\t\tassertEquals(999, ranges.get(2).getRangeStart(1000));\n\t\tassertEquals(999, ranges.get(2).getRangeEnd(1000));\n\t}"
  },
  {
    "id": 67,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 9,
    "human_patch": "https://github.com/spring-projects/spring-framework/commit/423aa28ed584b4ff6e5bad218c09beef5e91951",
    "cve_id": "CVE-2018-15756",
    "cwe_id": "Not Mapping",
    "filename": "spring-web/src/test/java/org/springframework/http/HttpRangeTests.java",
    "is_vulnerable": 0,
    "class_name": "HttpRangeTests",
    "subclass_name": null,
    "function_name": "rangeToString()",
    "function_body": "{\n\t\tList<HttpRange> ranges = new ArrayList<>();\n\t\tranges.add(HttpRange.createByteRange(0, 499));\n\t\tranges.add(HttpRange.createByteRange(9500));\n\t\tranges.add(HttpRange.createSuffixRange(500));\n\t\tassertEquals(\"Invalid Range header\", \"bytes=0-499, 9500-, -500\", HttpRange.toString(ranges));\n\t}"
  },
  {
    "id": 67,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 10,
    "human_patch": "https://github.com/spring-projects/spring-framework/commit/423aa28ed584b4ff6e5bad218c09beef5e91951",
    "cve_id": "CVE-2018-15756",
    "cwe_id": "Not Mapping",
    "filename": "spring-web/src/test/java/org/springframework/http/HttpRangeTests.java",
    "is_vulnerable": 0,
    "class_name": "HttpRangeTests",
    "subclass_name": null,
    "function_name": "toResourceRegion()",
    "function_body": "{\n\t\tbyte[] bytes = \"Spring Framework\".getBytes(StandardCharsets.UTF_8);\n\t\tByteArrayResource resource = new ByteArrayResource(bytes);\n\t\tHttpRange range = HttpRange.createByteRange(0, 5);\n\t\tResourceRegion region = range.toResourceRegion(resource);\n\t\tassertEquals(resource, region.getResource());\n\t\tassertEquals(0L, region.getPosition());\n\t\tassertEquals(6L, region.getCount());\n\t}"
  },
  {
    "id": 67,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 11,
    "human_patch": "https://github.com/spring-projects/spring-framework/commit/423aa28ed584b4ff6e5bad218c09beef5e91951",
    "cve_id": "CVE-2018-15756",
    "cwe_id": "Not Mapping",
    "filename": "spring-web/src/test/java/org/springframework/http/HttpRangeTests.java",
    "is_vulnerable": 0,
    "class_name": "HttpRangeTests",
    "subclass_name": null,
    "function_name": "toResourceRegionInputStreamResource()",
    "function_body": "{\n\t\tInputStreamResource resource = mock(InputStreamResource.class);\n\t\tHttpRange range = HttpRange.createByteRange(0, 9);\n\t\trange.toResourceRegion(resource);\n\t}"
  },
  {
    "id": 67,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 12,
    "human_patch": "https://github.com/spring-projects/spring-framework/commit/423aa28ed584b4ff6e5bad218c09beef5e91951",
    "cve_id": "CVE-2018-15756",
    "cwe_id": "Not Mapping",
    "filename": "spring-web/src/test/java/org/springframework/http/HttpRangeTests.java",
    "is_vulnerable": 0,
    "class_name": "HttpRangeTests",
    "subclass_name": null,
    "function_name": "toResourceRegionIllegalLength()",
    "function_body": "{\n\t\tByteArrayResource resource = mock(ByteArrayResource.class);\n\t\tgiven(resource.contentLength()).willReturn(-1L);\n\t\tHttpRange range = HttpRange.createByteRange(0, 9);\n\t\trange.toResourceRegion(resource);\n\t}"
  },
  {
    "id": 67,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 13,
    "human_patch": "https://github.com/spring-projects/spring-framework/commit/423aa28ed584b4ff6e5bad218c09beef5e91951",
    "cve_id": "CVE-2018-15756",
    "cwe_id": "Not Mapping",
    "filename": "spring-web/src/test/java/org/springframework/http/HttpRangeTests.java",
    "is_vulnerable": 0,
    "class_name": "HttpRangeTests",
    "subclass_name": null,
    "function_name": "toResourceRegionExceptionLength() throws IOException",
    "function_body": "{\n\t\tInputStreamResource resource = mock(InputStreamResource.class);\n\t\tgiven(resource.contentLength()).willThrow(IOException.class);\n\t\tHttpRange range = HttpRange.createByteRange(0, 9);\n\t\trange.toResourceRegion(resource);\n\t}"
  },
  {
    "id": 68,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 0,
    "human_patch": "https://github.com/spring-projects/spring-framework/commit/e02ff3a0da50744b0980d5d665fd242eedea767",
    "cve_id": "CVE-2018-1272",
    "cwe_id": "Not Mapping",
    "filename": "spring-core/src/main/java/org/springframework/util/MimeTypeUtils.java",
    "is_vulnerable": 0,
    "class_name": "MimeTypeUtils",
    "subclass_name": null,
    "function_name": "parseMimeType(String mimeType)",
    "function_body": "{\n\t\tif (!StringUtils.hasLength(mimeType)) {\n\t\t\tthrow new InvalidMimeTypeException(mimeType, \"'mimeType' must not be empty\");\n\t\t}\n\n\t\tint index = mimeType.indexOf(';');\n\t\tString fullType = (index >= 0 ? mimeType.substring(0, index) : mimeType).trim();\n\t\tif (fullType.isEmpty()) {\n\t\t\tthrow new InvalidMimeTypeException(mimeType, \"'mimeType' must not be empty\");\n\t\t}\n\n\t\t\n\t\tif (MimeType.WILDCARD_TYPE.equals(fullType)) {\n\t\t\tfullType = \"*/*\";\n\t\t}\n\t\tint subIndex = fullType.indexOf('/');\n\t\tif (subIndex == -1) {\n\t\t\tthrow new InvalidMimeTypeException(mimeType, \"does not contain '/'\");\n\t\t}\n\t\tif (subIndex == fullType.length() - 1) {\n\t\t\tthrow new InvalidMimeTypeException(mimeType, \"does not contain subtype after '/'\");\n\t\t}\n\t\tString type = fullType.substring(0, subIndex);\n\t\tString subtype = fullType.substring(subIndex + 1, fullType.length());\n\t\tif (MimeType.WILDCARD_TYPE.equals(type) && !MimeType.WILDCARD_TYPE.equals(subtype)) {\n\t\t\tthrow new InvalidMimeTypeException(mimeType, \"wildcard type is legal only in '*/*' (all mime types)\");\n\t\t}\n\n\t\tMap<String, String> parameters = null;\n\t\tdo {\n\t\t\tint nextIndex = index + 1;\n\t\t\tboolean quoted = false;\n\t\t\twhile (nextIndex < mimeType.length()) {\n\t\t\t\tchar ch = mimeType.charAt(nextIndex);\n\t\t\t\tif (ch == ';') {\n\t\t\t\t\tif (!quoted) {\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse if (ch == '\"') {\n\t\t\t\t\tquoted = !quoted;\n\t\t\t\t}\n\t\t\t\tnextIndex++;\n\t\t\t}\n\t\t\tString parameter = mimeType.substring(index + 1, nextIndex).trim();\n\t\t\tif (parameter.length() > 0) {\n\t\t\t\tif (parameters == null) {\n\t\t\t\t\tparameters = new LinkedHashMap<String, String>(4);\n\t\t\t\t}\n\t\t\t\tint eqIndex = parameter.indexOf('=');\n\t\t\t\tif (eqIndex >= 0) {\n\t\t\t\t\tString attribute = parameter.substring(0, eqIndex);\n\t\t\t\t\tString value = parameter.substring(eqIndex + 1, parameter.length());\n\t\t\t\t\tparameters.put(attribute, value);\n\t\t\t\t}\n\t\t\t}\n\t\t\tindex = nextIndex;\n\t\t}\n\t\twhile (index < mimeType.length());\n\n\t\ttry {\n\t\t\treturn new MimeType(type, subtype, parameters);\n\t\t}\n\t\tcatch (UnsupportedCharsetException ex) {\n\t\t\tthrow new InvalidMimeTypeException(mimeType, \"unsupported charset '\" + ex.getCharsetName() + \"'\");\n\t\t}\n\t\tcatch (IllegalArgumentException ex) {\n\t\t\tthrow new InvalidMimeTypeException(mimeType, ex.getMessage());\n\t\t}\n\t}"
  },
  {
    "id": 68,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 1,
    "human_patch": "https://github.com/spring-projects/spring-framework/commit/e02ff3a0da50744b0980d5d665fd242eedea767",
    "cve_id": "CVE-2018-1272",
    "cwe_id": "Not Mapping",
    "filename": "spring-core/src/main/java/org/springframework/util/MimeTypeUtils.java",
    "is_vulnerable": 0,
    "class_name": "MimeTypeUtils",
    "subclass_name": null,
    "function_name": "parseMimeTypes(String mimeTypes)",
    "function_body": "{\n\t\tif (!StringUtils.hasLength(mimeTypes)) {\n\t\t\treturn Collections.emptyList();\n\t\t}\n\t\tString[] tokens = StringUtils.tokenizeToStringArray(mimeTypes, \",\");\n\t\tList<MimeType> result = new ArrayList<MimeType>(tokens.length);\n\t\tfor (String token : tokens) {\n\t\t\tresult.add(parseMimeType(token));\n\t\t}\n\t\treturn result;\n\t}"
  },
  {
    "id": 68,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 2,
    "human_patch": "https://github.com/spring-projects/spring-framework/commit/e02ff3a0da50744b0980d5d665fd242eedea767",
    "cve_id": "CVE-2018-1272",
    "cwe_id": "Not Mapping",
    "filename": "spring-core/src/main/java/org/springframework/util/MimeTypeUtils.java",
    "is_vulnerable": 0,
    "class_name": "MimeTypeUtils",
    "subclass_name": null,
    "function_name": "toString(Collection<? extends MimeType> mimeTypes)",
    "function_body": "{\n\t\tStringBuilder builder = new StringBuilder();\n\t\tfor (Iterator<? extends MimeType> iterator = mimeTypes.iterator(); iterator.hasNext();) {\n\t\t\tMimeType mimeType = iterator.next();\n\t\t\tmimeType.appendTo(builder);\n\t\t\tif (iterator.hasNext()) {\n\t\t\t\tbuilder.append(\", \");\n\t\t\t}\n\t\t}\n\t\treturn builder.toString();\n\t}"
  },
  {
    "id": 68,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 3,
    "human_patch": "https://github.com/spring-projects/spring-framework/commit/e02ff3a0da50744b0980d5d665fd242eedea767",
    "cve_id": "CVE-2018-1272",
    "cwe_id": "Not Mapping",
    "filename": "spring-core/src/main/java/org/springframework/util/MimeTypeUtils.java",
    "is_vulnerable": 0,
    "class_name": "MimeTypeUtils",
    "subclass_name": null,
    "function_name": "sortBySpecificity(List<MimeType> mimeTypes)",
    "function_body": "{\n\t\tAssert.notNull(mimeTypes, \"'mimeTypes' must not be null\");\n\t\tif (mimeTypes.size() > 1) {\n\t\t\tCollections.sort(mimeTypes, SPECIFICITY_COMPARATOR);\n\t\t}\n\t}"
  },
  {
    "id": 68,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 4,
    "human_patch": "https://github.com/spring-projects/spring-framework/commit/e02ff3a0da50744b0980d5d665fd242eedea767",
    "cve_id": "CVE-2018-1272",
    "cwe_id": "Not Mapping",
    "filename": "spring-core/src/main/java/org/springframework/util/MimeTypeUtils.java",
    "is_vulnerable": 0,
    "class_name": "MimeTypeUtils",
    "subclass_name": null,
    "function_name": "generateMultipartBoundary()",
    "function_body": "{\n\t\tbyte[] boundary = new byte[RND.nextInt(11) + 30];\n\t\tfor (int i = 0; i < boundary.length; i++) {\n\t\t\tboundary[i] = BOUNDARY_CHARS[RND.nextInt(BOUNDARY_CHARS.length)];\n\t\t}\n\t\treturn boundary;\n\t}"
  },
  {
    "id": 68,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 5,
    "human_patch": "https://github.com/spring-projects/spring-framework/commit/e02ff3a0da50744b0980d5d665fd242eedea767",
    "cve_id": "CVE-2018-1272",
    "cwe_id": "Not Mapping",
    "filename": "spring-core/src/main/java/org/springframework/util/MimeTypeUtils.java",
    "is_vulnerable": 0,
    "class_name": "MimeTypeUtils",
    "subclass_name": null,
    "function_name": "generateMultipartBoundaryString()",
    "function_body": "{\n\t\treturn new String(generateMultipartBoundary(), US_ASCII);\n\t}"
  },
  {
    "id": 69,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 0,
    "human_patch": "https://github.com/spring-projects/spring-security/commit/c70b65c5df0e170a2d34d812b83db0b7bc71ea25",
    "cve_id": "CVE-2018-15801",
    "cwe_id": "CWE-345",
    "filename": "oauth2/oauth2-jose/src/main/java/org/springframework/security/oauth2/jwt/JwtIssuerValidator.java",
    "is_vulnerable": 1,
    "class_name": "JwtIssuerValidator",
    "subclass_name": null,
    "function_name": "validate(Jwt token)",
    "function_body": "{\n\t\tAssert.notNull(token, \"token cannot be null\");\n\n\t\tif (this.issuer.equals(token.getIssuer())) {\n\t\t\treturn OAuth2TokenValidatorResult.success();\n\t\t} else {\n\t\t\treturn OAuth2TokenValidatorResult.failure(INVALID_ISSUER);\n\t\t}\n\t}"
  },
  {
    "id": 69,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 0,
    "human_patch": "https://github.com/spring-projects/spring-security/commit/c70b65c5df0e170a2d34d812b83db0b7bc71ea25",
    "cve_id": "CVE-2018-15801",
    "cwe_id": "CWE-345",
    "filename": "oauth2/oauth2-jose/src/test/java/org/springframework/security/oauth2/jwt/JwtIssuerValidatorTests.java",
    "is_vulnerable": 0,
    "class_name": "JwtIssuerValidatorTests",
    "subclass_name": null,
    "function_name": "validateWhenIssuerMatchesThenReturnsSuccess()",
    "function_body": "{\n\t\tJwt jwt = new Jwt(\n\t\t\t\tMOCK_TOKEN,\n\t\t\t\tMOCK_ISSUED_AT,\n\t\t\t\tMOCK_EXPIRES_AT,\n\t\t\t\tMOCK_HEADERS,\n\t\t\t\tCollections.singletonMap(\"iss\", ISSUER));\n\n\t\tassertThat(this.validator.validate(jwt))\n\t\t\t\t.isEqualTo(OAuth2TokenValidatorResult.success());\n\t}"
  },
  {
    "id": 69,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 1,
    "human_patch": "https://github.com/spring-projects/spring-security/commit/c70b65c5df0e170a2d34d812b83db0b7bc71ea25",
    "cve_id": "CVE-2018-15801",
    "cwe_id": "CWE-345",
    "filename": "oauth2/oauth2-jose/src/test/java/org/springframework/security/oauth2/jwt/JwtIssuerValidatorTests.java",
    "is_vulnerable": 0,
    "class_name": "JwtIssuerValidatorTests",
    "subclass_name": null,
    "function_name": "validateWhenIssuerMismatchesThenReturnsError()",
    "function_body": "{\n\t\tJwt jwt = new Jwt(\n\t\t\t\tMOCK_TOKEN,\n\t\t\t\tMOCK_ISSUED_AT,\n\t\t\t\tMOCK_EXPIRES_AT,\n\t\t\t\tMOCK_HEADERS,\n\t\t\t\tCollections.singletonMap(JwtClaimNames.ISS, \"https://other\"));\n\n\t\tOAuth2TokenValidatorResult result = this.validator.validate(jwt);\n\n\t\tassertThat(result.getErrors()).isNotEmpty();\n\t}"
  },
  {
    "id": 69,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 2,
    "human_patch": "https://github.com/spring-projects/spring-security/commit/c70b65c5df0e170a2d34d812b83db0b7bc71ea25",
    "cve_id": "CVE-2018-15801",
    "cwe_id": "CWE-345",
    "filename": "oauth2/oauth2-jose/src/test/java/org/springframework/security/oauth2/jwt/JwtIssuerValidatorTests.java",
    "is_vulnerable": 0,
    "class_name": "JwtIssuerValidatorTests",
    "subclass_name": null,
    "function_name": "validateWhenJwtIsNullThenThrowsIllegalArgumentException()",
    "function_body": "{\n\t\tassertThatCode(() -> this.validator.validate(null))\n\t\t\t\t.isInstanceOf(IllegalArgumentException.class);\n\t}"
  },
  {
    "id": 69,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 3,
    "human_patch": "https://github.com/spring-projects/spring-security/commit/c70b65c5df0e170a2d34d812b83db0b7bc71ea25",
    "cve_id": "CVE-2018-15801",
    "cwe_id": "CWE-345",
    "filename": "oauth2/oauth2-jose/src/test/java/org/springframework/security/oauth2/jwt/JwtIssuerValidatorTests.java",
    "is_vulnerable": 0,
    "class_name": "JwtIssuerValidatorTests",
    "subclass_name": null,
    "function_name": "constructorWhenMalformedIssuerIsGivenThenThrowsIllegalArgumentException()",
    "function_body": "{\n\t\tassertThatCode(() -> new JwtIssuerValidator(\"issuer\"))\n\t\t\t\t.isInstanceOf(IllegalArgumentException.class);\n\t}"
  },
  {
    "id": 69,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 4,
    "human_patch": "https://github.com/spring-projects/spring-security/commit/c70b65c5df0e170a2d34d812b83db0b7bc71ea25",
    "cve_id": "CVE-2018-15801",
    "cwe_id": "CWE-345",
    "filename": "oauth2/oauth2-jose/src/test/java/org/springframework/security/oauth2/jwt/JwtIssuerValidatorTests.java",
    "is_vulnerable": 0,
    "class_name": "JwtIssuerValidatorTests",
    "subclass_name": null,
    "function_name": "constructorWhenNullIssuerIsGivenThenThrowsIllegalArgumentException()",
    "function_body": "{\n\t\tassertThatCode(() -> new JwtIssuerValidator(null))\n\t\t\t\t.isInstanceOf(IllegalArgumentException.class);\n\t}"
  },
  {
    "id": 70,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 0,
    "human_patch": "https://github.com/spring-projects/spring-security/commit/b2d4fec3617c497c5a8eb9c7e5270e0c7db293ee",
    "cve_id": "CVE-2019-11272",
    "cwe_id": "CWE-522",
    "filename": "core/src/main/java/org/springframework/security/authentication/encoding/PlaintextPasswordEncoder.java",
    "is_vulnerable": 0,
    "class_name": "PlaintextPasswordEncoder",
    "subclass_name": null,
    "function_name": "encodePassword(String rawPass, Object salt)",
    "function_body": "{\n\t\treturn mergePasswordAndSalt(rawPass, salt, true);\n\t}"
  },
  {
    "id": 70,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 1,
    "human_patch": "https://github.com/spring-projects/spring-security/commit/b2d4fec3617c497c5a8eb9c7e5270e0c7db293ee",
    "cve_id": "CVE-2019-11272",
    "cwe_id": "CWE-522",
    "filename": "core/src/main/java/org/springframework/security/authentication/encoding/PlaintextPasswordEncoder.java",
    "is_vulnerable": 0,
    "class_name": "PlaintextPasswordEncoder",
    "subclass_name": null,
    "function_name": "isIgnorePasswordCase()",
    "function_body": "{\n\t\treturn ignorePasswordCase;\n\t}"
  },
  {
    "id": 70,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 2,
    "human_patch": "https://github.com/spring-projects/spring-security/commit/b2d4fec3617c497c5a8eb9c7e5270e0c7db293ee",
    "cve_id": "CVE-2019-11272",
    "cwe_id": "CWE-522",
    "filename": "core/src/main/java/org/springframework/security/authentication/encoding/PlaintextPasswordEncoder.java",
    "is_vulnerable": 1,
    "class_name": "PlaintextPasswordEncoder",
    "subclass_name": null,
    "function_name": "isPasswordValid(String encPass, String rawPass, Object salt)",
    "function_body": "{\n\t\tString pass1 = encPass + \"\";\n\n\t\t\n\t\t\n\t\t\n\t\tString pass2 = mergePasswordAndSalt(rawPass, salt, false);\n\n\t\tif (ignorePasswordCase) {\n\t\t\t\n\t\t\t\n\t\t\tpass1 = pass1.toLowerCase(Locale.ENGLISH);\n\t\t\tpass2 = pass2.toLowerCase(Locale.ENGLISH);\n\t\t}\n\t\treturn PasswordEncoderUtils.equals(pass1, pass2);\n\t}"
  },
  {
    "id": 70,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 3,
    "human_patch": "https://github.com/spring-projects/spring-security/commit/b2d4fec3617c497c5a8eb9c7e5270e0c7db293ee",
    "cve_id": "CVE-2019-11272",
    "cwe_id": "CWE-522",
    "filename": "core/src/main/java/org/springframework/security/authentication/encoding/PlaintextPasswordEncoder.java",
    "is_vulnerable": 0,
    "class_name": "PlaintextPasswordEncoder",
    "subclass_name": null,
    "function_name": "obtainPasswordAndSalt(String password)",
    "function_body": "{\n\t\treturn demergePasswordAndSalt(password);\n\t}"
  },
  {
    "id": 70,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 4,
    "human_patch": "https://github.com/spring-projects/spring-security/commit/b2d4fec3617c497c5a8eb9c7e5270e0c7db293ee",
    "cve_id": "CVE-2019-11272",
    "cwe_id": "CWE-522",
    "filename": "core/src/main/java/org/springframework/security/authentication/encoding/PlaintextPasswordEncoder.java",
    "is_vulnerable": 0,
    "class_name": "PlaintextPasswordEncoder",
    "subclass_name": null,
    "function_name": "setIgnorePasswordCase(boolean ignorePasswordCase)",
    "function_body": "{\n\t\tthis.ignorePasswordCase = ignorePasswordCase;\n\t}"
  },
  {
    "id": 70,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 0,
    "human_patch": "https://github.com/spring-projects/spring-security/commit/b2d4fec3617c497c5a8eb9c7e5270e0c7db293ee",
    "cve_id": "CVE-2019-11272",
    "cwe_id": "CWE-522",
    "filename": "core/src/test/java/org/springframework/security/authentication/encoding/PlaintextPasswordEncoderTests.java",
    "is_vulnerable": 0,
    "class_name": "PlaintextPasswordEncoderTests",
    "subclass_name": null,
    "function_name": "testBasicFunctionality()",
    "function_body": "{\n\t\tPlaintextPasswordEncoder pe = new PlaintextPasswordEncoder();\n\n\t\tString raw = \"abc123\";\n\t\tString rawDiffCase = \"AbC123\";\n\t\tString badRaw = \"abc321\";\n\t\tString salt = \"THIS_IS_A_SALT\";\n\n\t\tString encoded = pe.encodePassword(raw, salt);\n\t\tassertThat(encoded).isEqualTo(\"abc123{THIS_IS_A_SALT}\");\n\t\tassertThat(pe.isPasswordValid(encoded, raw, salt)).isTrue();\n\t\tassertThat(pe.isPasswordValid(encoded, badRaw, salt)).isFalse();\n\n\t\t\n\t\tassertThat(pe.isIgnorePasswordCase()).isFalse();\n\t\tencoded = pe.encodePassword(rawDiffCase, salt);\n\t\tassertThat(pe.isPasswordValid(encoded, raw, salt)).isFalse();\n\n\t\t\n\t\tpe = new PlaintextPasswordEncoder();\n\t\tpe.setIgnorePasswordCase(true);\n\n\t\t\n\t\tencoded = pe.encodePassword(rawDiffCase, salt);\n\t\tassertThat(pe.isPasswordValid(encoded, raw, salt)).isTrue();\n\t\tassertThat(pe.isPasswordValid(encoded, badRaw, salt)).isFalse();\n\t}"
  },
  {
    "id": 70,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 1,
    "human_patch": "https://github.com/spring-projects/spring-security/commit/b2d4fec3617c497c5a8eb9c7e5270e0c7db293ee",
    "cve_id": "CVE-2019-11272",
    "cwe_id": "CWE-522",
    "filename": "core/src/test/java/org/springframework/security/authentication/encoding/PlaintextPasswordEncoderTests.java",
    "is_vulnerable": 0,
    "class_name": "PlaintextPasswordEncoderTests",
    "subclass_name": null,
    "function_name": "testMergeDemerge()",
    "function_body": "{\n\t\tPlaintextPasswordEncoder pwd = new PlaintextPasswordEncoder();\n\n\t\tString merged = pwd.encodePassword(\"password\", \"foo\");\n\t\tString[] demerged = pwd.obtainPasswordAndSalt(merged);\n\t\tassertThat(demerged[0]).isEqualTo(\"password\");\n\t\tassertThat(demerged[1]).isEqualTo(\"foo\");\n\t}"
  },
  {
    "id": 71,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 0,
    "human_patch": "https://github.com/spring-projects/spring-security/commit/1304c958bf9c38940082f3ad1558d413ed82f2b",
    "cve_id": "CVE-2019-3795",
    "cwe_id": "CWE-332",
    "filename": "core/src/main/java/org/springframework/security/core/token/SecureRandomFactoryBean.java",
    "is_vulnerable": 1,
    "class_name": "SecureRandomFactoryBean",
    "subclass_name": null,
    "function_name": "getObject() throws Exception",
    "function_body": "{\n\t\tSecureRandom rnd = SecureRandom.getInstance(algorithm);\n\n\t\tif (seed != null) {\n\t\t\t\n\t\t\tbyte[] seedBytes = FileCopyUtils.copyToByteArray(seed.getInputStream());\n\t\t\trnd.setSeed(seedBytes);\n\t\t}\n\t\telse {\n\t\t\t\n\t\t\t\n\t\t\trnd.nextBytes(new byte[1]);\n\t\t}\n\n\t\treturn rnd;\n\t}"
  },
  {
    "id": 71,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 1,
    "human_patch": "https://github.com/spring-projects/spring-security/commit/1304c958bf9c38940082f3ad1558d413ed82f2b",
    "cve_id": "CVE-2019-3795",
    "cwe_id": "CWE-332",
    "filename": "core/src/main/java/org/springframework/security/core/token/SecureRandomFactoryBean.java",
    "is_vulnerable": 0,
    "class_name": "SecureRandomFactoryBean",
    "subclass_name": null,
    "function_name": "getObjectType()",
    "function_body": "{\n\t\treturn SecureRandom.class;\n\t}"
  },
  {
    "id": 71,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 2,
    "human_patch": "https://github.com/spring-projects/spring-security/commit/1304c958bf9c38940082f3ad1558d413ed82f2b",
    "cve_id": "CVE-2019-3795",
    "cwe_id": "CWE-332",
    "filename": "core/src/main/java/org/springframework/security/core/token/SecureRandomFactoryBean.java",
    "is_vulnerable": 0,
    "class_name": "SecureRandomFactoryBean",
    "subclass_name": null,
    "function_name": "isSingleton()",
    "function_body": "{\n\t\treturn false;\n\t}"
  },
  {
    "id": 71,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 3,
    "human_patch": "https://github.com/spring-projects/spring-security/commit/1304c958bf9c38940082f3ad1558d413ed82f2b",
    "cve_id": "CVE-2019-3795",
    "cwe_id": "CWE-332",
    "filename": "core/src/main/java/org/springframework/security/core/token/SecureRandomFactoryBean.java",
    "is_vulnerable": 0,
    "class_name": "SecureRandomFactoryBean",
    "subclass_name": null,
    "function_name": "setAlgorithm(String algorithm)",
    "function_body": "{\n\t\tAssert.hasText(algorithm, \"Algorithm required\");\n\t\tthis.algorithm = algorithm;\n\t}"
  },
  {
    "id": 71,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 4,
    "human_patch": "https://github.com/spring-projects/spring-security/commit/1304c958bf9c38940082f3ad1558d413ed82f2b",
    "cve_id": "CVE-2019-3795",
    "cwe_id": "CWE-332",
    "filename": "core/src/main/java/org/springframework/security/core/token/SecureRandomFactoryBean.java",
    "is_vulnerable": 0,
    "class_name": "SecureRandomFactoryBean",
    "subclass_name": null,
    "function_name": "setSeed(Resource seed)",
    "function_body": "{\n\t\tthis.seed = seed;\n\t}"
  },
  {
    "id": 71,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 0,
    "human_patch": "https://github.com/spring-projects/spring-security/commit/1304c958bf9c38940082f3ad1558d413ed82f2b",
    "cve_id": "CVE-2019-3795",
    "cwe_id": "CWE-332",
    "filename": "core/src/test/java/org/springframework/security/core/token/SecureRandomFactoryBeanTests.java",
    "is_vulnerable": 0,
    "class_name": "SecureRandomFactoryBeanTests",
    "subclass_name": null,
    "function_name": "testObjectType()",
    "function_body": "{\n\t\tSecureRandomFactoryBean factory = new SecureRandomFactoryBean();\n\t\tassertThat(factory.getObjectType()).isEqualTo(SecureRandom.class);\n\t}"
  },
  {
    "id": 71,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 1,
    "human_patch": "https://github.com/spring-projects/spring-security/commit/1304c958bf9c38940082f3ad1558d413ed82f2b",
    "cve_id": "CVE-2019-3795",
    "cwe_id": "CWE-332",
    "filename": "core/src/test/java/org/springframework/security/core/token/SecureRandomFactoryBeanTests.java",
    "is_vulnerable": 0,
    "class_name": "SecureRandomFactoryBeanTests",
    "subclass_name": null,
    "function_name": "testIsSingleton()",
    "function_body": "{\n\t\tSecureRandomFactoryBean factory = new SecureRandomFactoryBean();\n\t\tassertThat(factory.isSingleton()).isFalse();\n\t}"
  },
  {
    "id": 71,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 2,
    "human_patch": "https://github.com/spring-projects/spring-security/commit/1304c958bf9c38940082f3ad1558d413ed82f2b",
    "cve_id": "CVE-2019-3795",
    "cwe_id": "CWE-332",
    "filename": "core/src/test/java/org/springframework/security/core/token/SecureRandomFactoryBeanTests.java",
    "is_vulnerable": 0,
    "class_name": "SecureRandomFactoryBeanTests",
    "subclass_name": null,
    "function_name": "testCreatesUsingDefaults() throws Exception",
    "function_body": "{\n\t\tSecureRandomFactoryBean factory = new SecureRandomFactoryBean();\n\t\tObject result = factory.getObject();\n\t\tassertThat(result).isInstanceOf(SecureRandom.class);\n\t\tint rnd = ((SecureRandom) result).nextInt();\n\t\tassertThat(rnd).isNotEqualTo(0);\n\t}"
  },
  {
    "id": 71,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 3,
    "human_patch": "https://github.com/spring-projects/spring-security/commit/1304c958bf9c38940082f3ad1558d413ed82f2b",
    "cve_id": "CVE-2019-3795",
    "cwe_id": "CWE-332",
    "filename": "core/src/test/java/org/springframework/security/core/token/SecureRandomFactoryBeanTests.java",
    "is_vulnerable": 1,
    "class_name": "SecureRandomFactoryBeanTests",
    "subclass_name": null,
    "function_name": "testCreatesUsingSeed() throws Exception",
    "function_body": "{\n\t\tSecureRandomFactoryBean factory = new SecureRandomFactoryBean();\n\t\tResource resource = new ClassPathResource(\n\t\t\t\t\"org/springframework/security/core/token/SecureRandomFactoryBeanTests.class\");\n\t\tassertThat(resource).isNotNull();\n\t\tfactory.setSeed(resource);\n\t\tObject result = factory.getObject();\n\t\tassertThat(result).isInstanceOf(SecureRandom.class);\n\t\tint rnd = ((SecureRandom) result).nextInt();\n\t\tassertThat(rnd).isNotEqualTo(0);\n\t}"
  },
  {
    "id": 72,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 0,
    "human_patch": "https://github.com/spring-projects/spring-security-oauth/commit/fff77d3fea477b566bcacfbfc95f85821a2bdc2d",
    "cve_id": "CVE-2016-4977",
    "cwe_id": "CWE-19",
    "filename": "spring-security-oauth2/src/main/java/org/springframework/security/oauth2/provider/endpoint/SpelView.java",
    "is_vulnerable": 0,
    "class_name": "SpelView",
    "subclass_name": null,
    "function_name": "resolvePlaceholder(String name)",
    "function_body": "{\n\t\t\t\tExpression expression = parser.parseExpression(name);\n\t\t\t\tObject value = expression.getValue(context);\n\t\t\t\treturn value == null ? null : value.toString();\n\t\t\t}"
  },
  {
    "id": 72,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 1,
    "human_patch": "https://github.com/spring-projects/spring-security-oauth/commit/fff77d3fea477b566bcacfbfc95f85821a2bdc2d",
    "cve_id": "CVE-2016-4977",
    "cwe_id": "CWE-19",
    "filename": "spring-security-oauth2/src/main/java/org/springframework/security/oauth2/provider/endpoint/SpelView.java",
    "is_vulnerable": 0,
    "class_name": "SpelView",
    "subclass_name": null,
    "function_name": "getContentType()",
    "function_body": "{\n\t\treturn \"text/html\";\n\t}"
  },
  {
    "id": 72,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 2,
    "human_patch": "https://github.com/spring-projects/spring-security-oauth/commit/fff77d3fea477b566bcacfbfc95f85821a2bdc2d",
    "cve_id": "CVE-2016-4977",
    "cwe_id": "CWE-19",
    "filename": "spring-security-oauth2/src/main/java/org/springframework/security/oauth2/provider/endpoint/SpelView.java",
    "is_vulnerable": 1,
    "class_name": "SpelView",
    "subclass_name": null,
    "function_name": "render(Map<String, ?> model, HttpServletRequest request, HttpServletResponse response) throws Exception",
    "function_body": "{\n\t\tMap<String, Object> map = new HashMap<String, Object>(model);\n\t\tString path = ServletUriComponentsBuilder.fromContextPath(request).build()\n\t\t\t\t.getPath();\n\t\tmap.put(\"path\", (Object) path==null ? \"\" : path);\n\t\tcontext.setRootObject(map);\n\t\tString result = helper.replacePlaceholders(template, resolver);\n\t\tresponse.setContentType(getContentType());\n\t\tresponse.getWriter().append(result);\n\t}"
  },
  {
    "id": 73,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 0,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/main/java/retrofit2/RequestBuilder.java",
    "is_vulnerable": 0,
    "class_name": "RequestBuilder",
    "subclass_name": null,
    "function_name": "setRelativeUrl(Object relativeUrl)",
    "function_body": "{\n    this.relativeUrl = relativeUrl.toString();\n  }"
  },
  {
    "id": 73,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 1,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/main/java/retrofit2/RequestBuilder.java",
    "is_vulnerable": 0,
    "class_name": "RequestBuilder",
    "subclass_name": null,
    "function_name": "addHeader(String name, String value)",
    "function_body": "{\n    if (\"Content-Type\".equalsIgnoreCase(name)) {\n      try {\n        contentType = MediaType.get(value);\n      } catch (IllegalArgumentException e) {\n        throw new IllegalArgumentException(\"Malformed content type: \" + value, e);\n      }\n    } else {\n      requestBuilder.addHeader(name, value);\n    }\n  }"
  },
  {
    "id": 73,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 2,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/main/java/retrofit2/RequestBuilder.java",
    "is_vulnerable": 1,
    "class_name": "RequestBuilder",
    "subclass_name": null,
    "function_name": "addPathParam(String name, String value, boolean encoded)",
    "function_body": "{\n    if (relativeUrl == null) {\n      \n      throw new AssertionError();\n    }\n    relativeUrl = relativeUrl.replace(\"{\" + name + \"}\", canonicalizeForPath(value, encoded));\n  }"
  },
  {
    "id": 73,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 3,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/main/java/retrofit2/RequestBuilder.java",
    "is_vulnerable": 0,
    "class_name": "RequestBuilder",
    "subclass_name": null,
    "function_name": "canonicalizeForPath(String input, boolean alreadyEncoded)",
    "function_body": "{\n    int codePoint;\n    for (int i = 0, limit = input.length(); i < limit; i += Character.charCount(codePoint)) {\n      codePoint = input.codePointAt(i);\n      if (codePoint < 0x20 || codePoint >= 0x7f\n          || PATH_SEGMENT_ALWAYS_ENCODE_SET.indexOf(codePoint) != -1\n          || (!alreadyEncoded && (codePoint == '/' || codePoint == '%'))) {\n        \n        Buffer out = new Buffer();\n        out.writeUtf8(input, 0, i);\n        canonicalizeForPath(out, input, i, limit, alreadyEncoded);\n        return out.readUtf8();\n      }\n    }\n\n    \n    return input;\n  }"
  },
  {
    "id": 73,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 4,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/main/java/retrofit2/RequestBuilder.java",
    "is_vulnerable": 0,
    "class_name": "RequestBuilder",
    "subclass_name": null,
    "function_name": "canonicalizeForPath(Buffer out, String input, int pos, int limit,\n      boolean alreadyEncoded)",
    "function_body": "{\n    Buffer utf8Buffer = null; \n    int codePoint;\n    for (int i = pos; i < limit; i += Character.charCount(codePoint)) {\n      codePoint = input.codePointAt(i);\n      if (alreadyEncoded\n          && (codePoint == '\\t' || codePoint == '\\n' || codePoint == '\\f' || codePoint == '\\r')) {\n        \n      } else if (codePoint < 0x20 || codePoint >= 0x7f\n          || PATH_SEGMENT_ALWAYS_ENCODE_SET.indexOf(codePoint) != -1\n          || (!alreadyEncoded && (codePoint == '/' || codePoint == '%'))) {\n        \n        if (utf8Buffer == null) {\n          utf8Buffer = new Buffer();\n        }\n        utf8Buffer.writeUtf8CodePoint(codePoint);\n        while (!utf8Buffer.exhausted()) {\n          int b = utf8Buffer.readByte() & 0xff;\n          out.writeByte('%');\n          out.writeByte(HEX_DIGITS[(b >> 4) & 0xf]);\n          out.writeByte(HEX_DIGITS[b & 0xf]);\n        }\n      } else {\n        \n        out.writeUtf8CodePoint(codePoint);\n      }\n    }\n  }"
  },
  {
    "id": 73,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 5,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/main/java/retrofit2/RequestBuilder.java",
    "is_vulnerable": 0,
    "class_name": "RequestBuilder",
    "subclass_name": null,
    "function_name": "addQueryParam(String name, @Nullable String value, boolean encoded)",
    "function_body": "{\n    if (relativeUrl != null) {\n      \n      urlBuilder = baseUrl.newBuilder(relativeUrl);\n      if (urlBuilder == null) {\n        throw new IllegalArgumentException(\n            \"Malformed URL. Base: \" + baseUrl + \", Relative: \" + relativeUrl);\n      }\n      relativeUrl = null;\n    }\n\n    if (encoded) {\n      \n      urlBuilder.addEncodedQueryParameter(name, value);\n    } else {\n      \n      urlBuilder.addQueryParameter(name, value);\n    }\n  }"
  },
  {
    "id": 73,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 6,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/main/java/retrofit2/RequestBuilder.java",
    "is_vulnerable": 0,
    "class_name": "RequestBuilder",
    "subclass_name": null,
    "function_name": "addFormField(String name, String value, boolean encoded)",
    "function_body": "{\n    if (encoded) {\n      formBuilder.addEncoded(name, value);\n    } else {\n      formBuilder.add(name, value);\n    }\n  }"
  },
  {
    "id": 73,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 7,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/main/java/retrofit2/RequestBuilder.java",
    "is_vulnerable": 0,
    "class_name": "RequestBuilder",
    "subclass_name": null,
    "function_name": "addPart(Headers headers, RequestBody body)",
    "function_body": "{\n    multipartBuilder.addPart(headers, body);\n  }"
  },
  {
    "id": 73,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 8,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/main/java/retrofit2/RequestBuilder.java",
    "is_vulnerable": 0,
    "class_name": "RequestBuilder",
    "subclass_name": null,
    "function_name": "addPart(MultipartBody.Part part)",
    "function_body": "{\n    multipartBuilder.addPart(part);\n  }"
  },
  {
    "id": 73,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 9,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/main/java/retrofit2/RequestBuilder.java",
    "is_vulnerable": 0,
    "class_name": "RequestBuilder",
    "subclass_name": null,
    "function_name": "setBody(RequestBody body)",
    "function_body": "{\n    this.body = body;\n  }"
  },
  {
    "id": 73,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 10,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/main/java/retrofit2/RequestBuilder.java",
    "is_vulnerable": 0,
    "class_name": "RequestBuilder",
    "subclass_name": null,
    "function_name": "get()",
    "function_body": "{\n    HttpUrl url;\n    HttpUrl.Builder urlBuilder = this.urlBuilder;\n    if (urlBuilder != null) {\n      url = urlBuilder.build();\n    } else {\n      \n      \n      url = baseUrl.resolve(relativeUrl);\n      if (url == null) {\n        throw new IllegalArgumentException(\n            \"Malformed URL. Base: \" + baseUrl + \", Relative: \" + relativeUrl);\n      }\n    }\n\n    RequestBody body = this.body;\n    if (body == null) {\n      \n      if (formBuilder != null) {\n        body = formBuilder.build();\n      } else if (multipartBuilder != null) {\n        body = multipartBuilder.build();\n      } else if (hasBody) {\n        \n        body = RequestBody.create(null, new byte[0]);\n      }\n    }\n\n    MediaType contentType = this.contentType;\n    if (contentType != null) {\n      if (body != null) {\n        body = new ContentTypeOverridingRequestBody(body, contentType);\n      } else {\n        requestBuilder.addHeader(\"Content-Type\", contentType.toString());\n      }\n    }\n\n    return requestBuilder\n        .url(url)\n        .method(method, body);\n  }"
  },
  {
    "id": 73,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 11,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/main/java/retrofit2/RequestBuilder.java",
    "is_vulnerable": 0,
    "class_name": "RequestBuilder",
    "subclass_name": "ContentTypeOverridingRequestBody",
    "function_name": "contentType()",
    "function_body": "{\n      return contentType;\n    }"
  },
  {
    "id": 73,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 12,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/main/java/retrofit2/RequestBuilder.java",
    "is_vulnerable": 0,
    "class_name": "RequestBuilder",
    "subclass_name": "ContentTypeOverridingRequestBody",
    "function_name": "contentLength() throws IOException",
    "function_body": "{\n      return delegate.contentLength();\n    }"
  },
  {
    "id": 73,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 13,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/main/java/retrofit2/RequestBuilder.java",
    "is_vulnerable": 0,
    "class_name": "RequestBuilder",
    "subclass_name": "ContentTypeOverridingRequestBody",
    "function_name": "writeTo(BufferedSink sink) throws IOException",
    "function_body": "{\n      delegate.writeTo(sink);\n    }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 0,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": null,
    "function_name": "customMethodNoBody()",
    "function_body": "{\n    class Example {\n      @HTTP(method = \"CUSTOM1\", path = \"/foo\")\n      Call<ResponseBody> method() {\n        return null;\n      }\n    }\n\n    Request request = buildRequest(Example.class);\n    assertThat(request.method()).isEqualTo(\"CUSTOM1\");\n    assertThat(request.url().toString()).isEqualTo(\"http://example.com/foo\");\n    assertThat(request.body()).isNull();\n  }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 1,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": "Example",
    "function_name": "method()",
    "function_body": "{\n        return null;\n      }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 2,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": null,
    "function_name": "customMethodWithBody()",
    "function_body": "{\n    class Example {\n      @HTTP(method = \"CUSTOM2\", path = \"/foo\", hasBody = true)\n      Call<ResponseBody> method(@Body RequestBody body) {\n        return null;\n      }\n    }\n\n    RequestBody body = RequestBody.create(TEXT_PLAIN, \"hi\");\n    Request request = buildRequest(Example.class, body);\n    assertThat(request.method()).isEqualTo(\"CUSTOM2\");\n    assertThat(request.url().toString()).isEqualTo(\"http://example.com/foo\");\n    assertBody(request.body(), \"hi\");\n  }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 3,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": "Example",
    "function_name": "method(@Body RequestBody body)",
    "function_body": "{\n        return null;\n      }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 4,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": null,
    "function_name": "onlyOneEncodingIsAllowedMultipartFirst()",
    "function_body": "{\n    class Example {\n      @Multipart \n      @FormUrlEncoded \n      @POST(\"/\") \n      Call<ResponseBody> method() {\n        return null;\n      }\n    }\n    try {\n      buildRequest(Example.class);\n      fail();\n    } catch (IllegalArgumentException e) {\n      assertThat(e).hasMessage(\n          \"Only one encoding annotation is allowed.\\n    for method Example.method\");\n    }\n  }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 5,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": "Example",
    "function_name": "method()",
    "function_body": "{\n        return null;\n      }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 6,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": null,
    "function_name": "onlyOneEncodingIsAllowedFormEncodingFirst()",
    "function_body": "{\n    class Example {\n      @FormUrlEncoded \n      @Multipart \n      @POST(\"/\") \n      Call<ResponseBody> method() {\n        return null;\n      }\n    }\n    try {\n      buildRequest(Example.class);\n      fail();\n    } catch (IllegalArgumentException e) {\n      assertThat(e).hasMessage(\n          \"Only one encoding annotation is allowed.\\n    for method Example.method\");\n    }\n  }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 7,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": "Example",
    "function_name": "method()",
    "function_body": "{\n        return null;\n      }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 8,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": null,
    "function_name": "invalidPathParam() throws Exception",
    "function_body": "{\n    class Example {\n      @GET(\"/\") \n      Call<ResponseBody> method(@Path(\"hey!\") String thing) {\n        return null;\n      }\n    }\n\n    try {\n      buildRequest(Example.class);\n      fail();\n    } catch (IllegalArgumentException e) {\n      assertThat(e).hasMessage(\n          \"@Path parameter name must match \\\\{([a-zA-Z][a-zA-Z0-9_-]*)\\\\}.\"\n              + \" Found: hey! (parameter #1)\\n    for method Example.method\");\n    }\n  }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 9,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": "Example",
    "function_name": "method(@Path(\"hey!\") String thing)",
    "function_body": "{\n        return null;\n      }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 10,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": null,
    "function_name": "pathParamNotAllowedInQuery() throws Exception",
    "function_body": "{\n    class Example {\n      @GET(\"/foo?bar={bar}\") \n      Call<ResponseBody> method(@Path(\"bar\") String thing) {\n        return null;\n      }\n    }\n    try {\n      buildRequest(Example.class);\n      fail();\n    } catch (IllegalArgumentException e) {\n      assertThat(e).hasMessage(\n          \"URL query string \\\"bar={bar}\\\" must not have replace block.\"\n              + \" For dynamic query parameters use @Query.\\n    for method Example.method\");\n    }\n  }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 11,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": "Example",
    "function_name": "method(@Path(\"bar\") String thing)",
    "function_body": "{\n        return null;\n      }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 12,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": null,
    "function_name": "multipleParameterAnnotationsNotAllowed() throws Exception",
    "function_body": "{\n    class Example {\n      @GET(\"/\") \n      Call<ResponseBody> method(@Body @Query(\"nope\") String o) {\n        return null;\n      }\n    }\n    try {\n      buildRequest(Example.class);\n      fail();\n    } catch (IllegalArgumentException e) {\n      assertThat(e).hasMessage(\n          \"Multiple Retrofit annotations found, only one allowed. (parameter #1)\\n    for method Example.method\");\n    }\n  }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 13,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": "Example",
    "function_name": "method(@Body @Query(\"nope\") String o)",
    "function_body": "{\n        return null;\n      }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 14,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": null,
    "function_name": "multipleParameterAnnotationsOnlyOneRetrofitAllowed() throws Exception",
    "function_body": "{\n    class Example {\n      @GET(\"/\") \n      Call<ResponseBody> method(@Query(\"maybe\") @NonNull Object o) {\n        return null;\n      }\n    }\n    Request request = buildRequest(Example.class, \"yep\");\n    assertThat(request.url().toString()).isEqualTo(\"http://example.com/?maybe=yep\");\n  }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 15,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": "Example",
    "function_name": "method(@Query(\"maybe\") @NonNull Object o)",
    "function_body": "{\n        return null;\n      }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 16,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": null,
    "function_name": "twoMethodsFail()",
    "function_body": "{\n    class Example {\n      @PATCH(\"/foo\") \n      @POST(\"/foo\") \n      Call<ResponseBody> method() {\n        return null;\n      }\n    }\n\n    try {\n      buildRequest(Example.class);\n      fail();\n    } catch (IllegalArgumentException e) {\n        assertThat(e.getMessage())\n            .isIn(\"Only one HTTP method is allowed. Found: PATCH and POST.\\n    for method Example.method\",\n                  \"Only one HTTP method is allowed. Found: POST and PATCH.\\n    for method Example.method\");\n    }\n  }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 17,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": "Example",
    "function_name": "method()",
    "function_body": "{\n        return null;\n      }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 18,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": null,
    "function_name": "lackingMethod()",
    "function_body": "{\n    class Example {\n      Call<ResponseBody> method() {\n        return null;\n      }\n    }\n    try {\n      buildRequest(Example.class);\n      fail();\n    } catch (IllegalArgumentException e) {\n      assertThat(e).hasMessage(\n          \"HTTP method annotation is required (e.g., @GET, @POST, etc.).\\n    for method Example.method\");\n    }\n  }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 19,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": "Example",
    "function_name": "method()",
    "function_body": "{\n        return null;\n      }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 20,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": null,
    "function_name": "implicitMultipartForbidden()",
    "function_body": "{\n    class Example {\n      @POST(\"/\") \n      Call<ResponseBody> method(@Part(\"a\") int a) {\n        return null;\n      }\n    }\n    try {\n      buildRequest(Example.class);\n      fail();\n    } catch (IllegalArgumentException e) {\n      assertThat(e).hasMessage(\n          \"@Part parameters can only be used with multipart encoding. (parameter #1)\\n    for method Example.method\");\n    }\n  }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 21,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": "Example",
    "function_name": "method(@Part(\"a\") int a)",
    "function_body": "{\n        return null;\n      }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 22,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": null,
    "function_name": "implicitMultipartWithPartMapForbidden()",
    "function_body": "{\n    class Example {\n      @POST(\"/\") \n      Call<ResponseBody> method(@PartMap Map<String, String> params) {\n        return null;\n      }\n    }\n    try {\n      buildRequest(Example.class);\n      fail();\n    } catch (IllegalArgumentException e) {\n      assertThat(e).hasMessage(\n          \"@PartMap parameters can only be used with multipart encoding. (parameter #1)\\n    for method Example.method\");\n    }\n  }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 23,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": "Example",
    "function_name": "method(@PartMap Map<String, String> params)",
    "function_body": "{\n        return null;\n      }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 24,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": null,
    "function_name": "multipartFailsOnNonBodyMethod()",
    "function_body": "{\n    class Example {\n      @Multipart \n      @GET(\"/\") \n      Call<ResponseBody> method() {\n        return null;\n      }\n    }\n    try {\n      buildRequest(Example.class);\n      fail();\n    } catch (IllegalArgumentException e) {\n      assertThat(e).hasMessage(\n          \"Multipart can only be specified on HTTP methods with request body (e.g., @POST).\\n    for method Example.method\");\n    }\n  }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 25,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": "Example",
    "function_name": "method()",
    "function_body": "{\n        return null;\n      }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 26,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": null,
    "function_name": "multipartFailsWithNoParts()",
    "function_body": "{\n    class Example {\n      @Multipart \n      @POST(\"/\") \n      Call<ResponseBody> method() {\n        return null;\n      }\n    }\n    try {\n      buildRequest(Example.class);\n      fail();\n    } catch (IllegalArgumentException e) {\n      assertThat(e).hasMessage(\n          \"Multipart method must contain at least one @Part.\\n    for method Example.method\");\n    }\n  }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 27,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": "Example",
    "function_name": "method()",
    "function_body": "{\n        return null;\n      }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 28,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": null,
    "function_name": "implicitFormEncodingByFieldForbidden()",
    "function_body": "{\n    class Example {\n      @POST(\"/\") \n      Call<ResponseBody> method(@Field(\"a\") int a) {\n        return null;\n      }\n    }\n    try {\n      buildRequest(Example.class);\n      fail();\n    } catch (IllegalArgumentException e) {\n      assertThat(e).hasMessage(\n          \"@Field parameters can only be used with form encoding. (parameter #1)\\n    for method Example.method\");\n    }\n  }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 29,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": "Example",
    "function_name": "method(@Field(\"a\") int a)",
    "function_body": "{\n        return null;\n      }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 30,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": null,
    "function_name": "implicitFormEncodingByFieldMapForbidden()",
    "function_body": "{\n    class Example {\n      @POST(\"/\") \n      Call<ResponseBody> method(@FieldMap Map<String, String> a) {\n        return null;\n      }\n    }\n    try {\n      buildRequest(Example.class);\n      fail();\n    } catch (IllegalArgumentException e) {\n      assertThat(e).hasMessage(\n          \"@FieldMap parameters can only be used with form encoding. (parameter #1)\\n    for method Example.method\");\n    }\n  }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 31,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": "Example",
    "function_name": "method(@FieldMap Map<String, String> a)",
    "function_body": "{\n        return null;\n      }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 32,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": null,
    "function_name": "formEncodingFailsOnNonBodyMethod()",
    "function_body": "{\n    class Example {\n      @FormUrlEncoded \n      @GET(\"/\") \n      Call<ResponseBody> method() {\n        return null;\n      }\n    }\n    try {\n      buildRequest(Example.class);\n      fail();\n    } catch (IllegalArgumentException e) {\n      assertThat(e).hasMessage(\n          \"FormUrlEncoded can only be specified on HTTP methods with request body (e.g., @POST).\\n    for method Example.method\");\n    }\n  }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 33,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": "Example",
    "function_name": "method()",
    "function_body": "{\n        return null;\n      }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 34,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": null,
    "function_name": "formEncodingFailsWithNoParts()",
    "function_body": "{\n    class Example {\n      @FormUrlEncoded \n      @POST(\"/\") \n      Call<ResponseBody> method() {\n        return null;\n      }\n    }\n    try {\n      buildRequest(Example.class);\n      fail();\n    } catch (IllegalArgumentException e) {\n      assertThat(e).hasMessage(\"Form-encoded method must contain at least one @Field.\\n    for method Example.method\");\n    }\n  }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 35,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": "Example",
    "function_name": "method()",
    "function_body": "{\n        return null;\n      }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 36,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": null,
    "function_name": "headersFailWhenEmptyOnMethod()",
    "function_body": "{\n    class Example {\n      @GET(\"/\") \n      @Headers({}) \n      Call<ResponseBody> method() {\n        return null;\n      }\n    }\n    try {\n      buildRequest(Example.class);\n      fail();\n    } catch (IllegalArgumentException e) {\n      assertThat(e).hasMessage(\"@Headers annotation is empty.\\n    for method Example.method\");\n    }\n  }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 37,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": "Example",
    "function_name": "method()",
    "function_body": "{\n        return null;\n      }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 38,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": null,
    "function_name": "headersFailWhenMalformed()",
    "function_body": "{\n    class Example {\n      @GET(\"/\") \n      @Headers(\"Malformed\") \n      Call<ResponseBody> method() {\n        return null;\n      }\n    }\n    try {\n      buildRequest(Example.class);\n      fail();\n    } catch (IllegalArgumentException e) {\n      assertThat(e).hasMessage(\n          \"@Headers value must be in the form \\\"Name: Value\\\". Found: \\\"Malformed\\\"\\n    for method Example.method\");\n    }\n  }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 39,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": "Example",
    "function_name": "method()",
    "function_body": "{\n        return null;\n      }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 40,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": null,
    "function_name": "pathParamNonPathParamAndTypedBytes()",
    "function_body": "{\n    class Example {\n      @PUT(\"/{a}\") \n      Call<ResponseBody> method(@Path(\"a\") int a, @Path(\"b\") int b, @Body int c) {\n        return null;\n      }\n    }\n    try {\n      buildRequest(Example.class);\n      fail();\n    } catch (IllegalArgumentException e) {\n      assertThat(e).hasMessage(\n          \"URL \\\"/{a}\\\" does not contain \\\"{b}\\\". (parameter #2)\\n    for method Example.method\");\n    }\n  }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 41,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": "Example",
    "function_name": "method(@Path(\"a\") int a, @Path(\"b\") int b, @Body int c)",
    "function_body": "{\n        return null;\n      }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 42,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": null,
    "function_name": "parameterWithoutAnnotation()",
    "function_body": "{\n    class Example {\n      @GET(\"/\") \n      Call<ResponseBody> method(String a) {\n        return null;\n      }\n    }\n    try {\n      buildRequest(Example.class);\n      fail();\n    } catch (IllegalArgumentException e) {\n      assertThat(e).hasMessage(\n          \"No Retrofit annotation found. (parameter #1)\\n    for method Example.method\");\n    }\n  }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 43,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": "Example",
    "function_name": "method(String a)",
    "function_body": "{\n        return null;\n      }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 44,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": null,
    "function_name": "nonBodyHttpMethodWithSingleEntity()",
    "function_body": "{\n    class Example {\n      @GET(\"/\") \n      Call<ResponseBody> method(@Body String o) {\n        return null;\n      }\n    }\n    try {\n      buildRequest(Example.class);\n      fail();\n    } catch (IllegalArgumentException e) {\n      assertThat(e).hasMessage(\n          \"Non-body HTTP method cannot contain @Body.\\n    for method Example.method\");\n    }\n  }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 45,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": "Example",
    "function_name": "method(@Body String o)",
    "function_body": "{\n        return null;\n      }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 46,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": null,
    "function_name": "queryMapMustBeAMap()",
    "function_body": "{\n    class Example {\n      @GET(\"/\") \n      Call<ResponseBody> method(@QueryMap List<String> a) {\n        return null;\n      }\n    }\n    try {\n      buildRequest(Example.class);\n      fail();\n    } catch (IllegalArgumentException e) {\n      assertThat(e).hasMessage(\n          \"@QueryMap parameter type must be Map. (parameter #1)\\n    for method Example.method\");\n    }\n  }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 47,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": "Example",
    "function_name": "method(@QueryMap List<String> a)",
    "function_body": "{\n        return null;\n      }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 48,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": null,
    "function_name": "queryMapSupportsSubclasses()",
    "function_body": "{\n    class Foo extends HashMap<String, String> {\n    }\n\n    class Example {\n      @GET(\"/\") \n      Call<ResponseBody> method(@QueryMap Foo a) {\n        return null;\n      }\n    }\n\n    Foo foo = new Foo();\n    foo.put(\"hello\", \"world\");\n\n    Request request = buildRequest(Example.class, foo);\n    assertThat(request.url().toString()).isEqualTo(\"http://example.com/?hello=world\");\n  }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 49,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": "Example",
    "function_name": "method(@QueryMap Foo a)",
    "function_body": "{\n        return null;\n      }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 50,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": null,
    "function_name": "queryMapRejectsNull()",
    "function_body": "{\n    class Example {\n      @GET(\"/\") \n      Call<ResponseBody> method(@QueryMap Map<String, String> a) {\n        return null;\n      }\n    }\n\n    try {\n      buildRequest(Example.class, new Object[] { null });\n      fail();\n    } catch (IllegalArgumentException e) {\n      assertThat(e).hasMessage(\"Query map was null.\");\n    }\n  }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 51,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": "Example",
    "function_name": "method(@QueryMap Map<String, String> a)",
    "function_body": "{\n        return null;\n      }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 52,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": null,
    "function_name": "queryMapRejectsNullKeys()",
    "function_body": "{\n    class Example {\n      @GET(\"/\") \n      Call<ResponseBody> method(@QueryMap Map<String, String> a) {\n        return null;\n      }\n    }\n\n    Map<String, String> queryParams = new LinkedHashMap<>();\n    queryParams.put(\"ping\", \"pong\");\n    queryParams.put(null, \"kat\");\n\n    try {\n      buildRequest(Example.class, queryParams);\n      fail();\n    } catch (IllegalArgumentException e) {\n      assertThat(e).hasMessage(\"Query map contained null key.\");\n    }\n  }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 53,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": "Example",
    "function_name": "method(@QueryMap Map<String, String> a)",
    "function_body": "{\n        return null;\n      }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 54,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": null,
    "function_name": "queryMapRejectsNullValues()",
    "function_body": "{\n    class Example {\n      @GET(\"/\") \n      Call<ResponseBody> method(@QueryMap Map<String, String> a) {\n        return null;\n      }\n    }\n\n    Map<String, String> queryParams = new LinkedHashMap<>();\n    queryParams.put(\"ping\", \"pong\");\n    queryParams.put(\"kit\", null);\n\n    try {\n      buildRequest(Example.class, queryParams);\n      fail();\n    } catch (IllegalArgumentException e) {\n      assertThat(e).hasMessage(\"Query map contained null value for key 'kit'.\");\n    }\n  }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 55,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": "Example",
    "function_name": "method(@QueryMap Map<String, String> a)",
    "function_body": "{\n        return null;\n      }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 56,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": null,
    "function_name": "getWithHeaderMap()",
    "function_body": "{\n    class Example {\n      @GET(\"/search\")\n      Call<ResponseBody> method(@HeaderMap Map<String, Object> headers) {\n        return null;\n      }\n    }\n\n    Map<String, Object> headers = new LinkedHashMap<>();\n    headers.put(\"Accept\", \"text/plain\");\n    headers.put(\"Accept-Charset\", \"utf-8\");\n\n    Request request = buildRequest(Example.class, headers);\n    assertThat(request.method()).isEqualTo(\"GET\");\n    assertThat(request.url().toString()).isEqualTo(\"http://example.com/search\");\n    assertThat(request.body()).isNull();\n    assertThat(request.headers().size()).isEqualTo(2);\n    assertThat(request.header(\"Accept\")).isEqualTo(\"text/plain\");\n    assertThat(request.header(\"Accept-Charset\")).isEqualTo(\"utf-8\");\n  }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 57,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": "Example",
    "function_name": "method(@HeaderMap Map<String, Object> headers)",
    "function_body": "{\n        return null;\n      }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 58,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": null,
    "function_name": "headerMapMustBeAMap()",
    "function_body": "{\n    class Example {\n      @GET(\"/\")\n      Call<ResponseBody> method(@HeaderMap List<String> headers) {\n        return null;\n      }\n    }\n    try {\n      buildRequest(Example.class);\n      fail();\n    } catch (IllegalArgumentException e) {\n      assertThat(e).hasMessage(\n          \"@HeaderMap parameter type must be Map. (parameter #1)\\n    for method Example.method\");\n    }\n  }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 59,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": "Example",
    "function_name": "method(@HeaderMap List<String> headers)",
    "function_body": "{\n        return null;\n      }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 60,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": null,
    "function_name": "headerMapSupportsSubclasses()",
    "function_body": "{\n    class Foo extends HashMap<String, String> {\n    }\n\n    class Example {\n      @GET(\"/search\")\n      Call<ResponseBody> method(@HeaderMap Foo headers) {\n        return null;\n      }\n    }\n\n    Foo headers = new Foo();\n    headers.put(\"Accept\", \"text/plain\");\n\n    Request request = buildRequest(Example.class, headers);\n    assertThat(request.url().toString()).isEqualTo(\"http://example.com/search\");\n    assertThat(request.headers().size()).isEqualTo(1);\n    assertThat(request.header(\"Accept\")).isEqualTo(\"text/plain\");\n  }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 61,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": "Example",
    "function_name": "method(@HeaderMap Foo headers)",
    "function_body": "{\n        return null;\n      }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 62,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": null,
    "function_name": "headerMapRejectsNull()",
    "function_body": "{\n    class Example {\n      @GET(\"/\")\n      Call<ResponseBody> method(@HeaderMap Map<String, String> headers) {\n        return null;\n      }\n    }\n\n    try {\n      buildRequest(Example.class, (Map<String, String>) null);\n      fail();\n    } catch (IllegalArgumentException e) {\n      assertThat(e).hasMessage(\"Header map was null.\");\n    }\n  }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 63,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": "Example",
    "function_name": "method(@HeaderMap Map<String, String> headers)",
    "function_body": "{\n        return null;\n      }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 64,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": null,
    "function_name": "headerMapRejectsNullKeys()",
    "function_body": "{\n    class Example {\n      @GET(\"/\")\n      Call<ResponseBody> method(@HeaderMap Map<String, String> headers) {\n        return null;\n      }\n    }\n\n    Map<String, String> headers = new LinkedHashMap<>();\n    headers.put(\"Accept\", \"text/plain\");\n    headers.put(null, \"utf-8\");\n\n    try {\n      buildRequest(Example.class, headers);\n      fail();\n    } catch (IllegalArgumentException e) {\n      assertThat(e).hasMessage(\"Header map contained null key.\");\n    }\n  }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 65,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": "Example",
    "function_name": "method(@HeaderMap Map<String, String> headers)",
    "function_body": "{\n        return null;\n      }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 66,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": null,
    "function_name": "headerMapRejectsNullValues()",
    "function_body": "{\n    class Example {\n      @GET(\"/\")\n      Call<ResponseBody> method(@HeaderMap Map<String, String> headers) {\n        return null;\n      }\n    }\n\n    Map<String, String> headers = new LinkedHashMap<>();\n    headers.put(\"Accept\", \"text/plain\");\n    headers.put(\"Accept-Charset\", null);\n\n    try {\n      buildRequest(Example.class, headers);\n      fail();\n    } catch (IllegalArgumentException e) {\n      assertThat(e).hasMessage(\"Header map contained null value for key 'Accept-Charset'.\");\n    }\n  }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 67,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": "Example",
    "function_name": "method(@HeaderMap Map<String, String> headers)",
    "function_body": "{\n        return null;\n      }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 68,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": null,
    "function_name": "twoBodies()",
    "function_body": "{\n    class Example {\n      @PUT(\"/\") \n      Call<ResponseBody> method(@Body String o1, @Body String o2) {\n        return null;\n      }\n    }\n    try {\n      buildRequest(Example.class);\n      fail();\n    } catch (IllegalArgumentException e) {\n      assertThat(e).hasMessage(\n          \"Multiple @Body method annotations found. (parameter #2)\\n    for method Example.method\");\n    }\n  }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 69,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": "Example",
    "function_name": "method(@Body String o1, @Body String o2)",
    "function_body": "{\n        return null;\n      }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 70,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": null,
    "function_name": "bodyInNonBodyRequest()",
    "function_body": "{\n    class Example {\n      @Multipart \n      @PUT(\"/\") \n      Call<ResponseBody> method(@Part(\"one\") String o1, @Body String o2) {\n        return null;\n      }\n    }\n    try {\n      buildRequest(Example.class);\n      fail();\n    } catch (IllegalArgumentException e) {\n      assertThat(e).hasMessage(\n          \"@Body parameters cannot be used with form or multi-part encoding. (parameter #2)\\n    for method Example.method\");\n    }\n  }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 71,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": "Example",
    "function_name": "method(@Part(\"one\") String o1, @Body String o2)",
    "function_body": "{\n        return null;\n      }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 72,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": null,
    "function_name": "get()",
    "function_body": "{\n    class Example {\n      @GET(\"/foo/bar/\") \n      Call<ResponseBody> method() {\n        return null;\n      }\n    }\n    Request request = buildRequest(Example.class);\n    assertThat(request.method()).isEqualTo(\"GET\");\n    assertThat(request.headers().size()).isZero();\n    assertThat(request.url().toString()).isEqualTo(\"http://example.com/foo/bar/\");\n    assertThat(request.body()).isNull();\n  }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 73,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": "Example",
    "function_name": "method()",
    "function_body": "{\n        return null;\n      }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 74,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": null,
    "function_name": "delete()",
    "function_body": "{\n    class Example {\n      @DELETE(\"/foo/bar/\") \n      Call<ResponseBody> method() {\n        return null;\n      }\n    }\n    Request request = buildRequest(Example.class);\n    assertThat(request.method()).isEqualTo(\"DELETE\");\n    assertThat(request.headers().size()).isZero();\n    assertThat(request.url().toString()).isEqualTo(\"http://example.com/foo/bar/\");\n    assertNull(request.body());\n  }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 75,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": "Example",
    "function_name": "method()",
    "function_body": "{\n        return null;\n      }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 76,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": null,
    "function_name": "head()",
    "function_body": "{\n    class Example {\n      @HEAD(\"/foo/bar/\") \n      Call<Void> method() {\n        return null;\n      }\n    }\n    Request request = buildRequest(Example.class);\n    assertThat(request.method()).isEqualTo(\"HEAD\");\n    assertThat(request.headers().size()).isZero();\n    assertThat(request.url().toString()).isEqualTo(\"http://example.com/foo/bar/\");\n    assertThat(request.body()).isNull();\n  }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 77,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": "Example",
    "function_name": "method()",
    "function_body": "{\n        return null;\n      }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 78,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": null,
    "function_name": "headWithoutVoidThrows()",
    "function_body": "{\n    class Example {\n      @HEAD(\"/foo/bar/\") \n      Call<ResponseBody> method() {\n        return null;\n      }\n    }\n    try {\n      buildRequest(Example.class);\n    } catch (IllegalArgumentException e) {\n      assertThat(e).hasMessage(\n          \"HEAD method must use Void as response type.\\n    for method Example.method\");\n    }\n  }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 79,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": "Example",
    "function_name": "method()",
    "function_body": "{\n        return null;\n      }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 80,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": null,
    "function_name": "post()",
    "function_body": "{\n    class Example {\n      @POST(\"/foo/bar/\") \n      Call<ResponseBody> method(@Body RequestBody body) {\n        return null;\n      }\n    }\n    RequestBody body = RequestBody.create(TEXT_PLAIN, \"hi\");\n    Request request = buildRequest(Example.class, body);\n    assertThat(request.method()).isEqualTo(\"POST\");\n    assertThat(request.headers().size()).isZero();\n    assertThat(request.url().toString()).isEqualTo(\"http://example.com/foo/bar/\");\n    assertBody(request.body(), \"hi\");\n  }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 81,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": "Example",
    "function_name": "method(@Body RequestBody body)",
    "function_body": "{\n        return null;\n      }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 82,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": null,
    "function_name": "put()",
    "function_body": "{\n    class Example {\n      @PUT(\"/foo/bar/\") \n      Call<ResponseBody> method(@Body RequestBody body) {\n        return null;\n      }\n    }\n    RequestBody body = RequestBody.create(TEXT_PLAIN, \"hi\");\n    Request request = buildRequest(Example.class, body);\n    assertThat(request.method()).isEqualTo(\"PUT\");\n    assertThat(request.headers().size()).isZero();\n    assertThat(request.url().toString()).isEqualTo(\"http://example.com/foo/bar/\");\n    assertBody(request.body(), \"hi\");\n  }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 83,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": "Example",
    "function_name": "method(@Body RequestBody body)",
    "function_body": "{\n        return null;\n      }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 84,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": null,
    "function_name": "patch()",
    "function_body": "{\n    class Example {\n      @PATCH(\"/foo/bar/\") \n      Call<ResponseBody> method(@Body RequestBody body) {\n        return null;\n      }\n    }\n    RequestBody body = RequestBody.create(TEXT_PLAIN, \"hi\");\n    Request request = buildRequest(Example.class, body);\n    assertThat(request.method()).isEqualTo(\"PATCH\");\n    assertThat(request.headers().size()).isZero();\n    assertThat(request.url().toString()).isEqualTo(\"http://example.com/foo/bar/\");\n    assertBody(request.body(), \"hi\");\n  }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 85,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": "Example",
    "function_name": "method(@Body RequestBody body)",
    "function_body": "{\n        return null;\n      }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 86,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": null,
    "function_name": "options()",
    "function_body": "{\n    class Example {\n      @OPTIONS(\"/foo/bar/\") \n      Call<ResponseBody> method() {\n        return null;\n      }\n    }\n    Request request = buildRequest(Example.class);\n    assertThat(request.method()).isEqualTo(\"OPTIONS\");\n    assertThat(request.headers().size()).isZero();\n    assertThat(request.url().toString()).isEqualTo(\"http://example.com/foo/bar/\");\n    assertThat(request.body()).isNull();\n  }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 87,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": "Example",
    "function_name": "method()",
    "function_body": "{\n        return null;\n      }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 88,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": null,
    "function_name": "getWithPathParam()",
    "function_body": "{\n    class Example {\n      @GET(\"/foo/bar/{ping}/\") \n      Call<ResponseBody> method(@Path(\"ping\") String ping) {\n        return null;\n      }\n    }\n    Request request = buildRequest(Example.class, \"po ng\");\n    assertThat(request.method()).isEqualTo(\"GET\");\n    assertThat(request.headers().size()).isZero();\n    assertThat(request.url().toString()).isEqualTo(\"http://example.com/foo/bar/po%20ng/\");\n    assertThat(request.body()).isNull();\n  }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 89,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": "Example",
    "function_name": "method(@Path(\"ping\") String ping)",
    "function_body": "{\n        return null;\n      }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 90,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": null,
    "function_name": "getWithUnusedAndInvalidNamedPathParam()",
    "function_body": "{\n    class Example {\n      @GET(\"/foo/bar/{ping}/{kit,kat}/\") \n      Call<ResponseBody> method(@Path(\"ping\") String ping) {\n        return null;\n      }\n    }\n    Request request = buildRequest(Example.class, \"pong\");\n    assertThat(request.method()).isEqualTo(\"GET\");\n    assertThat(request.headers().size()).isZero();\n    assertThat(request.url().toString()).isEqualTo(\"http://example.com/foo/bar/pong/%7Bkit,kat%7D/\");\n    assertThat(request.body()).isNull();\n  }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 91,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": "Example",
    "function_name": "method(@Path(\"ping\") String ping)",
    "function_body": "{\n        return null;\n      }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 92,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": null,
    "function_name": "getWithEncodedPathParam()",
    "function_body": "{\n    class Example {\n      @GET(\"/foo/bar/{ping}/\") \n      Call<ResponseBody> method(@Path(value = \"ping\", encoded = true) String ping) {\n        return null;\n      }\n    }\n    Request request = buildRequest(Example.class, \"po%20ng\");\n    assertThat(request.method()).isEqualTo(\"GET\");\n    assertThat(request.headers().size()).isZero();\n    assertThat(request.url().toString()).isEqualTo(\"http://example.com/foo/bar/po%20ng/\");\n    assertThat(request.body()).isNull();\n  }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 93,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": "Example",
    "function_name": "method(@Path(value = \"ping\", encoded = true) String ping)",
    "function_body": "{\n        return null;\n      }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 94,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": null,
    "function_name": "getWithEncodedPathSegments()",
    "function_body": "{\n    class Example {\n      @GET(\"/foo/bar/{ping}/\") \n      Call<ResponseBody> method(@Path(value = \"ping\", encoded = true) String ping) {\n        return null;\n      }\n    }\n    Request request = buildRequest(Example.class, \"baz/pong/more\");\n    assertThat(request.method()).isEqualTo(\"GET\");\n    assertThat(request.headers().size()).isZero();\n    assertThat(request.url().toString()).isEqualTo(\"http://example.com/foo/bar/baz/pong/more/\");\n    assertThat(request.body()).isNull();\n  }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 95,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": "Example",
    "function_name": "method(@Path(value = \"ping\", encoded = true) String ping)",
    "function_body": "{\n        return null;\n      }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 96,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": null,
    "function_name": "getWithUnencodedPathSegmentsPreventsRequestSplitting()",
    "function_body": "{\n    class Example {\n      @GET(\"/foo/bar/{ping}/\") \n      Call<ResponseBody> method(@Path(value = \"ping\", encoded = false) String ping) {\n        return null;\n      }\n    }\n    Request request = buildRequest(Example.class, \"baz/\\r\\nheader: blue\");\n    assertThat(request.method()).isEqualTo(\"GET\");\n    assertThat(request.headers().size()).isZero();\n    assertThat(request.url().toString()).isEqualTo(\"http://example.com/foo/bar/baz%2F%0D%0Aheader:%20blue/\");\n    assertThat(request.body()).isNull();\n  }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 97,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": "Example",
    "function_name": "method(@Path(value = \"ping\", encoded = false) String ping)",
    "function_body": "{\n        return null;\n      }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 98,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": null,
    "function_name": "getWithEncodedPathStillPreventsRequestSplitting()",
    "function_body": "{\n    class Example {\n      @GET(\"/foo/bar/{ping}/\") \n      Call<ResponseBody> method(@Path(value = \"ping\", encoded = true) String ping) {\n        return null;\n      }\n    }\n    Request request = buildRequest(Example.class, \"baz/\\r\\npong\");\n    assertThat(request.method()).isEqualTo(\"GET\");\n    assertThat(request.headers().size()).isZero();\n    assertThat(request.url().toString()).isEqualTo(\"http://example.com/foo/bar/baz/pong/\");\n    assertThat(request.body()).isNull();\n  }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 99,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": "Example",
    "function_name": "method(@Path(value = \"ping\", encoded = true) String ping)",
    "function_body": "{\n        return null;\n      }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 100,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": null,
    "function_name": "pathParamRequired()",
    "function_body": "{\n    class Example {\n      @GET(\"/foo/bar/{ping}/\") \n      Call<ResponseBody> method(@Path(\"ping\") String ping) {\n        return null;\n      }\n    }\n    try {\n      buildRequest(Example.class, new Object[] { null });\n      fail();\n    } catch (IllegalArgumentException e) {\n      assertThat(e.getMessage()).isEqualTo(\"Path parameter \\\"ping\\\" value must not be null.\");\n    }\n  }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 101,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": "Example",
    "function_name": "method(@Path(\"ping\") String ping)",
    "function_body": "{\n        return null;\n      }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 102,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": null,
    "function_name": "getWithQueryParam()",
    "function_body": "{\n    class Example {\n      @GET(\"/foo/bar/\") \n      Call<ResponseBody> method(@Query(\"ping\") String ping) {\n        return null;\n      }\n    }\n    Request request = buildRequest(Example.class, \"pong\");\n    assertThat(request.method()).isEqualTo(\"GET\");\n    assertThat(request.headers().size()).isZero();\n    assertThat(request.url().toString()).isEqualTo(\"http://example.com/foo/bar/?ping=pong\");\n    assertThat(request.body()).isNull();\n  }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 103,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": "Example",
    "function_name": "method(@Query(\"ping\") String ping)",
    "function_body": "{\n        return null;\n      }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 104,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": null,
    "function_name": "getWithEncodedQueryParam()",
    "function_body": "{\n    class Example {\n      @GET(\"/foo/bar/\") \n      Call<ResponseBody> method(@Query(value = \"pi%20ng\", encoded = true) String ping) {\n        return null;\n      }\n    }\n    Request request = buildRequest(Example.class, \"p%20o%20n%20g\");\n    assertThat(request.method()).isEqualTo(\"GET\");\n    assertThat(request.headers().size()).isZero();\n    assertThat(request.url().toString()).isEqualTo(\"http://example.com/foo/bar/?pi%20ng=p%20o%20n%20g\");\n    assertThat(request.body()).isNull();\n  }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 105,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": "Example",
    "function_name": "method(@Query(value = \"pi%20ng\", encoded = true) String ping)",
    "function_body": "{\n        return null;\n      }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 106,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": null,
    "function_name": "queryParamOptionalOmitsQuery()",
    "function_body": "{\n    class Example {\n      @GET(\"/foo/bar/\") \n      Call<ResponseBody> method(@Query(\"ping\") String ping) {\n        return null;\n      }\n    }\n    Request request = buildRequest(Example.class, new Object[] { null });\n    assertThat(request.url().toString()).isEqualTo(\"http://example.com/foo/bar/\");\n  }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 107,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": "Example",
    "function_name": "method(@Query(\"ping\") String ping)",
    "function_body": "{\n        return null;\n      }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 108,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": null,
    "function_name": "queryParamOptional()",
    "function_body": "{\n    class Example {\n      @GET(\"/foo/bar/\") \n      Call<ResponseBody> method(@Query(\"foo\") String foo, @Query(\"ping\") String ping,\n          @Query(\"kit\") String kit) {\n        return null;\n      }\n    }\n    Request request = buildRequest(Example.class, \"bar\", null, \"kat\");\n    assertThat(request.url().toString()).isEqualTo(\"http://example.com/foo/bar/?foo=bar&kit=kat\");\n  }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 109,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": "Example",
    "function_name": "method(@Query(\"foo\") String foo, @Query(\"ping\") String ping,\n          @Query(\"kit\") String kit)",
    "function_body": "{\n        return null;\n      }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 110,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": null,
    "function_name": "getWithQueryUrlAndParam()",
    "function_body": "{\n    class Example {\n      @GET(\"/foo/bar/?hi=mom\") \n      Call<ResponseBody> method(@Query(\"ping\") String ping) {\n        return null;\n      }\n    }\n    Request request = buildRequest(Example.class, \"pong\");\n    assertThat(request.method()).isEqualTo(\"GET\");\n    assertThat(request.headers().size()).isZero();\n    assertThat(request.url().toString()).isEqualTo(\"http://example.com/foo/bar/?hi=mom&ping=pong\");\n    assertThat(request.body()).isNull();\n  }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 111,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": "Example",
    "function_name": "method(@Query(\"ping\") String ping)",
    "function_body": "{\n        return null;\n      }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 112,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": null,
    "function_name": "getWithQuery()",
    "function_body": "{\n    class Example {\n      @GET(\"/foo/bar/?hi=mom\") \n      Call<ResponseBody> method() {\n        return null;\n      }\n    }\n    Request request = buildRequest(Example.class);\n    assertThat(request.method()).isEqualTo(\"GET\");\n    assertThat(request.headers().size()).isZero();\n    assertThat(request.url().toString()).isEqualTo(\"http://example.com/foo/bar/?hi=mom\");\n    assertThat(request.body()).isNull();\n  }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 113,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": "Example",
    "function_name": "method()",
    "function_body": "{\n        return null;\n      }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 114,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": null,
    "function_name": "getWithPathAndQueryParam()",
    "function_body": "{\n    class Example {\n      @GET(\"/foo/bar/{ping}/\") \n      Call<ResponseBody> method(@Path(\"ping\") String ping, @Query(\"kit\") String kit,\n          @Query(\"riff\") String riff) {\n        return null;\n      }\n    }\n\n    Request request = buildRequest(Example.class, \"pong\", \"kat\", \"raff\");\n    assertThat(request.method()).isEqualTo(\"GET\");\n    assertThat(request.headers().size()).isZero();\n    assertThat(request.url().toString()).isEqualTo(\"http://example.com/foo/bar/pong/?kit=kat&riff=raff\");\n    assertThat(request.body()).isNull();\n  }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 115,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": "Example",
    "function_name": "method(@Path(\"ping\") String ping, @Query(\"kit\") String kit,\n          @Query(\"riff\") String riff)",
    "function_body": "{\n        return null;\n      }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 116,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": null,
    "function_name": "getWithQueryThenPathThrows()",
    "function_body": "{\n    class Example {\n      @GET(\"/foo/bar/{ping}/\") \n      Call<ResponseBody> method(@Query(\"kit\") String kit, @Path(\"ping\") String ping) {\n        return null;\n      }\n    }\n\n    try {\n      buildRequest(Example.class, \"kat\", \"pong\");\n      fail();\n    } catch (IllegalArgumentException e) {\n      assertThat(e).hasMessage(\"A @Path parameter must not come after a @Query. (parameter #2)\\n\"\n          + \"    for method Example.method\");\n    }\n  }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 117,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": "Example",
    "function_name": "method(@Query(\"kit\") String kit, @Path(\"ping\") String ping)",
    "function_body": "{\n        return null;\n      }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 118,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": null,
    "function_name": "getWithQueryNameThenPathThrows()",
    "function_body": "{\n    class Example {\n      @GET(\"/foo/bar/{ping}/\") \n      Call<ResponseBody> method(@QueryName String kit, @Path(\"ping\") String ping) {\n        throw new AssertionError();\n      }\n    }\n\n    try {\n      buildRequest(Example.class, \"kat\", \"pong\");\n      fail();\n    } catch (IllegalArgumentException e) {\n      assertThat(e).hasMessage(\"A @Path parameter must not come after a @QueryName. (parameter #2)\\n\"\n          + \"    for method Example.method\");\n    }\n  }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 119,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": "Example",
    "function_name": "method(@QueryName String kit, @Path(\"ping\") String ping)",
    "function_body": "{\n        throw new AssertionError();\n      }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 120,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": null,
    "function_name": "getWithQueryMapThenPathThrows()",
    "function_body": "{\n    class Example {\n      @GET(\"/foo/bar/{ping}/\") \n      Call<ResponseBody> method(@QueryMap Map<String, String> queries, @Path(\"ping\") String ping) {\n        throw new AssertionError();\n      }\n    }\n\n    try {\n      buildRequest(Example.class, Collections.singletonMap(\"kit\", \"kat\"), \"pong\");\n      fail();\n    } catch (IllegalArgumentException e) {\n      assertThat(e).hasMessage(\"A @Path parameter must not come after a @QueryMap. (parameter #2)\\n\"\n          + \"    for method Example.method\");\n    }\n  }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 121,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": "Example",
    "function_name": "method(@QueryMap Map<String, String> queries, @Path(\"ping\") String ping)",
    "function_body": "{\n        throw new AssertionError();\n      }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 122,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": null,
    "function_name": "getWithPathAndQueryQuestionMarkParam()",
    "function_body": "{\n    class Example {\n      @GET(\"/foo/bar/{ping}/\") \n      Call<ResponseBody> method(@Path(\"ping\") String ping, @Query(\"kit\") String kit) {\n        return null;\n      }\n    }\n\n    Request request = buildRequest(Example.class, \"pong?\", \"kat?\");\n    assertThat(request.method()).isEqualTo(\"GET\");\n    assertThat(request.headers().size()).isZero();\n    assertThat(request.url().toString())\n        .isEqualTo(\"http://example.com/foo/bar/pong%3F/?kit=kat%3F\");\n    assertThat(request.body()).isNull();\n  }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 123,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": "Example",
    "function_name": "method(@Path(\"ping\") String ping, @Query(\"kit\") String kit)",
    "function_body": "{\n        return null;\n      }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 124,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": null,
    "function_name": "getWithPathAndQueryAmpersandParam()",
    "function_body": "{\n    class Example {\n      @GET(\"/foo/bar/{ping}/\") \n      Call<ResponseBody> method(@Path(\"ping\") String ping, @Query(\"kit\") String kit) {\n        return null;\n      }\n    }\n\n    Request request = buildRequest(Example.class, \"pong&\", \"kat&\");\n    assertThat(request.method()).isEqualTo(\"GET\");\n    assertThat(request.headers().size()).isZero();\n    assertThat(request.url().toString()).isEqualTo(\"http://example.com/foo/bar/pong&/?kit=kat%26\");\n    assertThat(request.body()).isNull();\n  }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 125,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": "Example",
    "function_name": "method(@Path(\"ping\") String ping, @Query(\"kit\") String kit)",
    "function_body": "{\n        return null;\n      }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 126,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": null,
    "function_name": "getWithPathAndQueryHashParam()",
    "function_body": "{\n    class Example {\n      @GET(\"/foo/bar/{ping}/\") \n      Call<ResponseBody> method(@Path(\"ping\") String ping, @Query(\"kit\") String kit) {\n        return null;\n      }\n    }\n\n    Request request = buildRequest(Example.class, \"pong#\", \"kat#\");\n    assertThat(request.method()).isEqualTo(\"GET\");\n    assertThat(request.headers().size()).isZero();\n    assertThat(request.url().toString()).isEqualTo(\"http://example.com/foo/bar/pong%23/?kit=kat%23\");\n    assertThat(request.body()).isNull();\n  }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 127,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": "Example",
    "function_name": "method(@Path(\"ping\") String ping, @Query(\"kit\") String kit)",
    "function_body": "{\n        return null;\n      }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 128,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": null,
    "function_name": "getWithQueryParamList()",
    "function_body": "{\n    class Example {\n      @GET(\"/foo/bar/\") \n      Call<ResponseBody> method(@Query(\"key\") List<Object> keys) {\n        return null;\n      }\n    }\n\n    List<Object> values = Arrays.<Object>asList(1, 2, null, \"three\", \"1\");\n    Request request = buildRequest(Example.class, values);\n    assertThat(request.method()).isEqualTo(\"GET\");\n    assertThat(request.headers().size()).isZero();\n    assertThat(request.url().toString()).isEqualTo(\"http://example.com/foo/bar/?key=1&key=2&key=three&key=1\");\n    assertThat(request.body()).isNull();\n  }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 129,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": "Example",
    "function_name": "method(@Query(\"key\") List<Object> keys)",
    "function_body": "{\n        return null;\n      }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 130,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": null,
    "function_name": "getWithQueryParamArray()",
    "function_body": "{\n    class Example {\n      @GET(\"/foo/bar/\") \n      Call<ResponseBody> method(@Query(\"key\") Object[] keys) {\n        return null;\n      }\n    }\n\n    Object[] values = { 1, 2, null, \"three\", \"1\" };\n    Request request = buildRequest(Example.class, new Object[] { values });\n    assertThat(request.method()).isEqualTo(\"GET\");\n    assertThat(request.headers().size()).isZero();\n    assertThat(request.url().toString()).isEqualTo(\"http://example.com/foo/bar/?key=1&key=2&key=three&key=1\");\n    assertThat(request.body()).isNull();\n  }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 131,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": "Example",
    "function_name": "method(@Query(\"key\") Object[] keys)",
    "function_body": "{\n        return null;\n      }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 132,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": null,
    "function_name": "getWithQueryParamPrimitiveArray()",
    "function_body": "{\n    class Example {\n      @GET(\"/foo/bar/\") \n      Call<ResponseBody> method(@Query(\"key\") int[] keys) {\n        return null;\n      }\n    }\n\n    int[] values = { 1, 2, 3, 1 };\n    Request request = buildRequest(Example.class, new Object[] { values });\n    assertThat(request.method()).isEqualTo(\"GET\");\n    assertThat(request.headers().size()).isZero();\n    assertThat(request.url().toString()).isEqualTo(\"http://example.com/foo/bar/?key=1&key=2&key=3&key=1\");\n    assertThat(request.body()).isNull();\n  }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 133,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": "Example",
    "function_name": "method(@Query(\"key\") int[] keys)",
    "function_body": "{\n        return null;\n      }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 134,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": null,
    "function_name": "getWithQueryNameParam()",
    "function_body": "{\n    class Example {\n      @GET(\"/foo/bar/\") \n      Call<ResponseBody> method(@QueryName String ping) {\n        return null;\n      }\n    }\n    Request request = buildRequest(Example.class, \"pong\");\n    assertThat(request.method()).isEqualTo(\"GET\");\n    assertThat(request.headers().size()).isZero();\n    assertThat(request.url().toString()).isEqualTo(\"http://example.com/foo/bar/?pong\");\n    assertThat(request.body()).isNull();\n  }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 135,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": "Example",
    "function_name": "method(@QueryName String ping)",
    "function_body": "{\n        return null;\n      }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 136,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": null,
    "function_name": "getWithEncodedQueryNameParam()",
    "function_body": "{\n    class Example {\n      @GET(\"/foo/bar/\") \n      Call<ResponseBody> method(@QueryName(encoded = true) String ping) {\n        return null;\n      }\n    }\n    Request request = buildRequest(Example.class, \"p%20o%20n%20g\");\n    assertThat(request.method()).isEqualTo(\"GET\");\n    assertThat(request.headers().size()).isZero();\n    assertThat(request.url().toString()).isEqualTo(\"http://example.com/foo/bar/?p%20o%20n%20g\");\n    assertThat(request.body()).isNull();\n  }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 137,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": "Example",
    "function_name": "method(@QueryName(encoded = true) String ping)",
    "function_body": "{\n        return null;\n      }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 138,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": null,
    "function_name": "queryNameParamOptionalOmitsQuery()",
    "function_body": "{\n    class Example {\n      @GET(\"/foo/bar/\") \n      Call<ResponseBody> method(@QueryName String ping) {\n        return null;\n      }\n    }\n    Request request = buildRequest(Example.class, new Object[] { null });\n    assertThat(request.url().toString()).isEqualTo(\"http://example.com/foo/bar/\");\n  }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 139,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": "Example",
    "function_name": "method(@QueryName String ping)",
    "function_body": "{\n        return null;\n      }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 140,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": null,
    "function_name": "getWithQueryNameParamList()",
    "function_body": "{\n    class Example {\n      @GET(\"/foo/bar/\") \n      Call<ResponseBody> method(@QueryName List<Object> keys) {\n        return null;\n      }\n    }\n\n    List<Object> values = Arrays.<Object>asList(1, 2, null, \"three\", \"1\");\n    Request request = buildRequest(Example.class, values);\n    assertThat(request.method()).isEqualTo(\"GET\");\n    assertThat(request.headers().size()).isZero();\n    assertThat(request.url().toString()).isEqualTo(\"http://example.com/foo/bar/?1&2&three&1\");\n    assertThat(request.body()).isNull();\n  }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 141,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": "Example",
    "function_name": "method(@QueryName List<Object> keys)",
    "function_body": "{\n        return null;\n      }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 142,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": null,
    "function_name": "getWithQueryNameParamArray()",
    "function_body": "{\n    class Example {\n      @GET(\"/foo/bar/\") \n      Call<ResponseBody> method(@QueryName Object[] keys) {\n        return null;\n      }\n    }\n\n    Object[] values = { 1, 2, null, \"three\", \"1\" };\n    Request request = buildRequest(Example.class, new Object[] { values });\n    assertThat(request.method()).isEqualTo(\"GET\");\n    assertThat(request.headers().size()).isZero();\n    assertThat(request.url().toString()).isEqualTo(\"http://example.com/foo/bar/?1&2&three&1\");\n    assertThat(request.body()).isNull();\n  }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 143,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": "Example",
    "function_name": "method(@QueryName Object[] keys)",
    "function_body": "{\n        return null;\n      }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 144,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": null,
    "function_name": "getWithQueryNameParamPrimitiveArray()",
    "function_body": "{\n    class Example {\n      @GET(\"/foo/bar/\") \n      Call<ResponseBody> method(@QueryName int[] keys) {\n        return null;\n      }\n    }\n\n    int[] values = { 1, 2, 3, 1 };\n    Request request = buildRequest(Example.class, new Object[] { values });\n    assertThat(request.method()).isEqualTo(\"GET\");\n    assertThat(request.headers().size()).isZero();\n    assertThat(request.url().toString()).isEqualTo(\"http://example.com/foo/bar/?1&2&3&1\");\n    assertThat(request.body()).isNull();\n  }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 145,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": "Example",
    "function_name": "method(@QueryName int[] keys)",
    "function_body": "{\n        return null;\n      }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 146,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": null,
    "function_name": "getWithQueryParamMap()",
    "function_body": "{\n    class Example {\n      @GET(\"/foo/bar/\") \n      Call<ResponseBody> method(@QueryMap Map<String, Object> query) {\n        return null;\n      }\n    }\n\n    Map<String, Object> params = new LinkedHashMap<>();\n    params.put(\"kit\", \"kat\");\n    params.put(\"ping\", \"pong\");\n\n    Request request = buildRequest(Example.class, params);\n    assertThat(request.method()).isEqualTo(\"GET\");\n    assertThat(request.headers().size()).isZero();\n    assertThat(request.url().toString()).isEqualTo(\"http://example.com/foo/bar/?kit=kat&ping=pong\");\n    assertThat(request.body()).isNull();\n  }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 147,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": "Example",
    "function_name": "method(@QueryMap Map<String, Object> query)",
    "function_body": "{\n        return null;\n      }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 148,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": null,
    "function_name": "getWithEncodedQueryParamMap()",
    "function_body": "{\n    class Example {\n      @GET(\"/foo/bar/\") \n      Call<ResponseBody> method(@QueryMap(encoded = true) Map<String, Object> query) {\n        return null;\n      }\n    }\n\n    Map<String, Object> params = new LinkedHashMap<>();\n    params.put(\"kit\", \"k%20t\");\n    params.put(\"pi%20ng\", \"p%20g\");\n\n    Request request = buildRequest(Example.class, params);\n    assertThat(request.method()).isEqualTo(\"GET\");\n    assertThat(request.headers().size()).isZero();\n    assertThat(request.url().toString()).isEqualTo(\"http://example.com/foo/bar/?kit=k%20t&pi%20ng=p%20g\");\n    assertThat(request.body()).isNull();\n  }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 149,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": "Example",
    "function_name": "method(@QueryMap(encoded = true) Map<String, Object> query)",
    "function_body": "{\n        return null;\n      }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 150,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": null,
    "function_name": "getAbsoluteUrl()",
    "function_body": "{\n    class Example {\n      @GET(\"http://example2.com/foo/bar/\")\n      Call<ResponseBody> method() {\n        return null;\n      }\n    }\n\n    Request request = buildRequest(Example.class);\n    assertThat(request.method()).isEqualTo(\"GET\");\n    assertThat(request.headers().size()).isZero();\n    assertThat(request.url().toString()).isEqualTo(\"http://example2.com/foo/bar/\");\n    assertThat(request.body()).isNull();\n  }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 151,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": "Example",
    "function_name": "method()",
    "function_body": "{\n        return null;\n      }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 152,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": null,
    "function_name": "getWithStringUrl()",
    "function_body": "{\n    class Example {\n      @GET\n      Call<ResponseBody> method(@Url String url) {\n        return null;\n      }\n    }\n\n    Request request = buildRequest(Example.class, \"foo/bar/\");\n    assertThat(request.method()).isEqualTo(\"GET\");\n    assertThat(request.headers().size()).isZero();\n    assertThat(request.url().toString()).isEqualTo(\"http://example.com/foo/bar/\");\n    assertThat(request.body()).isNull();\n  }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 153,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": "Example",
    "function_name": "method(@Url String url)",
    "function_body": "{\n        return null;\n      }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 154,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": null,
    "function_name": "getWithJavaUriUrl()",
    "function_body": "{\n    class Example {\n      @GET\n      Call<ResponseBody> method(@Url URI url) {\n        return null;\n      }\n    }\n\n    Request request = buildRequest(Example.class, URI.create(\"foo/bar/\"));\n    assertThat(request.method()).isEqualTo(\"GET\");\n    assertThat(request.headers().size()).isZero();\n    assertThat(request.url().toString()).isEqualTo(\"http://example.com/foo/bar/\");\n    assertThat(request.body()).isNull();\n  }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 155,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": "Example",
    "function_name": "method(@Url URI url)",
    "function_body": "{\n        return null;\n      }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 156,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": null,
    "function_name": "getWithStringUrlAbsolute()",
    "function_body": "{\n    class Example {\n      @GET\n      Call<ResponseBody> method(@Url String url) {\n        return null;\n      }\n    }\n\n    Request request = buildRequest(Example.class, \"https://example2.com/foo/bar/\");\n    assertThat(request.method()).isEqualTo(\"GET\");\n    assertThat(request.headers().size()).isZero();\n    assertThat(request.url().toString()).isEqualTo(\"https://example2.com/foo/bar/\");\n    assertThat(request.body()).isNull();\n  }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 157,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": "Example",
    "function_name": "method(@Url String url)",
    "function_body": "{\n        return null;\n      }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 158,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": null,
    "function_name": "getWithJavaUriUrlAbsolute()",
    "function_body": "{\n    class Example {\n      @GET\n      Call<ResponseBody> method(@Url URI url) {\n        return null;\n      }\n    }\n\n    Request request = buildRequest(Example.class, URI.create(\"https://example2.com/foo/bar/\"));\n    assertThat(request.method()).isEqualTo(\"GET\");\n    assertThat(request.headers().size()).isZero();\n    assertThat(request.url().toString()).isEqualTo(\"https://example2.com/foo/bar/\");\n    assertThat(request.body()).isNull();\n  }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 159,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": "Example",
    "function_name": "method(@Url URI url)",
    "function_body": "{\n        return null;\n      }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 160,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": null,
    "function_name": "getWithUrlAbsoluteSameHost()",
    "function_body": "{\n    class Example {\n      @GET\n      Call<ResponseBody> method(@Url String url) {\n        return null;\n      }\n    }\n\n    Request request = buildRequest(Example.class, \"http://example.com/foo/bar/\");\n    assertThat(request.method()).isEqualTo(\"GET\");\n    assertThat(request.headers().size()).isZero();\n    assertThat(request.url().toString()).isEqualTo(\"http://example.com/foo/bar/\");\n    assertThat(request.body()).isNull();\n  }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 161,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": "Example",
    "function_name": "method(@Url String url)",
    "function_body": "{\n        return null;\n      }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 162,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": null,
    "function_name": "getWithHttpUrl()",
    "function_body": "{\n    class Example {\n      @GET\n      Call<ResponseBody> method(@Url HttpUrl url) {\n        return null;\n      }\n    }\n\n    Request request = buildRequest(Example.class, HttpUrl.get(\"http://example.com/foo/bar/\"));\n    assertThat(request.method()).isEqualTo(\"GET\");\n    assertThat(request.headers().size()).isZero();\n    assertThat(request.url()).isEqualTo(HttpUrl.get(\"http://example.com/foo/bar/\"));\n    assertThat(request.body()).isNull();\n  }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 163,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": "Example",
    "function_name": "method(@Url HttpUrl url)",
    "function_body": "{\n        return null;\n      }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 164,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": null,
    "function_name": "getWithNullUrl()",
    "function_body": "{\n    class Example {\n      @GET\n      Call<ResponseBody> method(@Url HttpUrl url) {\n        return null;\n      }\n    }\n\n    try {\n      buildRequest(Example.class, (HttpUrl) null);\n      fail();\n    } catch (NullPointerException expected) {\n      assertThat(expected).hasMessage(\"@Url parameter is null.\");\n    }\n  }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 165,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": "Example",
    "function_name": "method(@Url HttpUrl url)",
    "function_body": "{\n        return null;\n      }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 166,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": null,
    "function_name": "getWithNonStringUrlThrows()",
    "function_body": "{\n    class Example {\n      @GET\n      Call<ResponseBody> method(@Url Object url) {\n        return null;\n      }\n    }\n\n    try {\n      buildRequest(Example.class, \"foo/bar\");\n      fail();\n    } catch (IllegalArgumentException e) {\n      assertThat(e).hasMessage(\n          \"@Url must be okhttp3.HttpUrl, String, java.net.URI, or android.net.Uri type.\"\n              + \" (parameter #1)\\n\"\n              + \"    for method Example.method\");\n    }\n  }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 167,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": "Example",
    "function_name": "method(@Url Object url)",
    "function_body": "{\n        return null;\n      }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 168,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": null,
    "function_name": "getUrlAndUrlParamThrows()",
    "function_body": "{\n    class Example {\n      @GET(\"foo/bar\")\n      Call<ResponseBody> method(@Url Object url) {\n        return null;\n      }\n    }\n\n    try {\n      buildRequest(Example.class, \"foo/bar\");\n      fail();\n    } catch (IllegalArgumentException e) {\n      assertThat(e).hasMessage(\"@Url cannot be used with @GET URL (parameter #1)\\n\"\n          + \"    for method Example.method\");\n    }\n  }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 169,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": "Example",
    "function_name": "method(@Url Object url)",
    "function_body": "{\n        return null;\n      }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 170,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": null,
    "function_name": "getWithoutUrlThrows()",
    "function_body": "{\n    class Example {\n      @GET\n      Call<ResponseBody> method() {\n        return null;\n      }\n    }\n\n    try {\n      buildRequest(Example.class);\n      fail();\n    } catch (IllegalArgumentException e) {\n      assertThat(e).hasMessage(\"Missing either @GET URL or @Url parameter.\\n\"\n          + \"    for method Example.method\");\n    }\n  }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 171,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": "Example",
    "function_name": "method()",
    "function_body": "{\n        return null;\n      }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 172,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": null,
    "function_name": "getWithUrlThenPathThrows()",
    "function_body": "{\n    class Example {\n      @GET\n      Call<ResponseBody> method(@Url String url, @Path(\"hey\") String hey) {\n        return null;\n      }\n    }\n\n    try {\n      buildRequest(Example.class, \"foo/bar\");\n      fail();\n    } catch (IllegalArgumentException e) {\n      assertThat(e).hasMessage(\"@Path parameters may not be used with @Url. (parameter #2)\\n\"\n          + \"    for method Example.method\");\n    }\n  }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 173,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": "Example",
    "function_name": "method(@Url String url, @Path(\"hey\") String hey)",
    "function_body": "{\n        return null;\n      }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 174,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": null,
    "function_name": "getWithPathThenUrlThrows()",
    "function_body": "{\n    class Example {\n      @GET\n      Call<ResponseBody> method(@Path(\"hey\") String hey, @Url Object url) {\n        return null;\n      }\n    }\n\n    try {\n      buildRequest(Example.class, \"foo/bar\");\n      fail();\n    } catch (IllegalArgumentException e) {\n      assertThat(e).hasMessage(\"@Path can only be used with relative url on @GET (parameter #1)\\n\"\n          + \"    for method Example.method\");\n    }\n  }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 175,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": "Example",
    "function_name": "method(@Path(\"hey\") String hey, @Url Object url)",
    "function_body": "{\n        return null;\n      }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 176,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": null,
    "function_name": "getWithQueryThenUrlThrows()",
    "function_body": "{\n    class Example {\n      @GET(\"foo/bar\")\n      Call<ResponseBody> method(@Query(\"hey\") String hey, @Url Object url) {\n        return null;\n      }\n    }\n\n    try {\n      buildRequest(Example.class, \"hey\", \"foo/bar/\");\n      fail();\n    } catch (IllegalArgumentException e) {\n      assertThat(e).hasMessage(\"A @Url parameter must not come after a @Query. (parameter #2)\\n\"\n          + \"    for method Example.method\");\n    }\n  }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 177,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": "Example",
    "function_name": "method(@Query(\"hey\") String hey, @Url Object url)",
    "function_body": "{\n        return null;\n      }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 178,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": null,
    "function_name": "getWithQueryNameThenUrlThrows()",
    "function_body": "{\n    class Example {\n      @GET\n      Call<ResponseBody> method(@QueryName String name, @Url String url) {\n        throw new AssertionError();\n      }\n    }\n\n    try {\n      buildRequest(Example.class, Collections.singletonMap(\"kit\", \"kat\"), \"foo/bar/\");\n      fail();\n    } catch (IllegalArgumentException e) {\n      assertThat(e).hasMessage(\"A @Url parameter must not come after a @QueryName. (parameter #2)\\n\"\n          + \"    for method Example.method\");\n    }\n  }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 179,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": "Example",
    "function_name": "method(@QueryName String name, @Url String url)",
    "function_body": "{\n        throw new AssertionError();\n      }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 180,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": null,
    "function_name": "getWithQueryMapThenUrlThrows()",
    "function_body": "{\n    class Example {\n      @GET\n      Call<ResponseBody> method(@QueryMap Map<String, String> queries, @Url String url) {\n        throw new AssertionError();\n      }\n    }\n\n    try {\n      buildRequest(Example.class, Collections.singletonMap(\"kit\", \"kat\"), \"foo/bar/\");\n      fail();\n    } catch (IllegalArgumentException e) {\n      assertThat(e).hasMessage(\"A @Url parameter must not come after a @QueryMap. (parameter #2)\\n\"\n          + \"    for method Example.method\");\n    }\n  }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 181,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": "Example",
    "function_name": "method(@QueryMap Map<String, String> queries, @Url String url)",
    "function_body": "{\n        throw new AssertionError();\n      }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 182,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": null,
    "function_name": "getWithUrlThenQuery()",
    "function_body": "{\n    class Example {\n      @GET\n      Call<ResponseBody> method(@Url String url, @Query(\"hey\") String hey) {\n        return null;\n      }\n    }\n\n    Request request = buildRequest(Example.class, \"foo/bar/\", \"hey!\");\n    assertThat(request.method()).isEqualTo(\"GET\");\n    assertThat(request.headers().size()).isZero();\n    assertThat(request.url().toString()).isEqualTo(\"http://example.com/foo/bar/?hey=hey%21\");\n  }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 183,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": "Example",
    "function_name": "method(@Url String url, @Query(\"hey\") String hey)",
    "function_body": "{\n        return null;\n      }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 184,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": null,
    "function_name": "postWithUrl()",
    "function_body": "{\n    class Example {\n      @POST\n      Call<ResponseBody> method(@Url String url, @Body RequestBody body) {\n        return null;\n      }\n    }\n    RequestBody body = RequestBody.create(TEXT_PLAIN, \"hi\");\n    Request request = buildRequest(Example.class, \"http://example.com/foo/bar\", body);\n    assertThat(request.method()).isEqualTo(\"POST\");\n    assertThat(request.headers().size()).isZero();\n    assertThat(request.url().toString()).isEqualTo(\"http://example.com/foo/bar\");\n    assertBody(request.body(), \"hi\");\n  }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 185,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": "Example",
    "function_name": "method(@Url String url, @Body RequestBody body)",
    "function_body": "{\n        return null;\n      }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 186,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": null,
    "function_name": "normalPostWithPathParam()",
    "function_body": "{\n    class Example {\n      @POST(\"/foo/bar/{ping}/\") \n      Call<ResponseBody> method(@Path(\"ping\") String ping, @Body RequestBody body) {\n        return null;\n      }\n    }\n    RequestBody body = RequestBody.create(TEXT_PLAIN, \"Hi!\");\n    Request request = buildRequest(Example.class, \"pong\", body);\n    assertThat(request.method()).isEqualTo(\"POST\");\n    assertThat(request.headers().size()).isZero();\n    assertThat(request.url().toString()).isEqualTo(\"http://example.com/foo/bar/pong/\");\n    assertBody(request.body(), \"Hi!\");\n  }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 187,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": "Example",
    "function_name": "method(@Path(\"ping\") String ping, @Body RequestBody body)",
    "function_body": "{\n        return null;\n      }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 188,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": null,
    "function_name": "emptyBody()",
    "function_body": "{\n    class Example {\n      @POST(\"/foo/bar/\") \n      Call<ResponseBody> method() {\n        return null;\n      }\n    }\n    Request request = buildRequest(Example.class);\n    assertThat(request.method()).isEqualTo(\"POST\");\n    assertThat(request.headers().size()).isZero();\n    assertThat(request.url().toString()).isEqualTo(\"http://example.com/foo/bar/\");\n    assertBody(request.body(), \"\");\n  }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 189,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": "Example",
    "function_name": "method()",
    "function_body": "{\n        return null;\n      }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 190,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": null,
    "function_name": "customMethodEmptyBody()",
    "function_body": "{\n    class Example {\n      @HTTP(method = \"CUSTOM\", path = \"/foo/bar/\", hasBody = true) \n      Call<ResponseBody> method() {\n        return null;\n      }\n    }\n    Request request = buildRequest(Example.class);\n    assertThat(request.method()).isEqualTo(\"CUSTOM\");\n    assertThat(request.headers().size()).isZero();\n    assertThat(request.url().toString()).isEqualTo(\"http://example.com/foo/bar/\");\n    assertBody(request.body(), \"\");\n  }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 191,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": "Example",
    "function_name": "method()",
    "function_body": "{\n        return null;\n      }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 192,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": null,
    "function_name": "bodyRequired()",
    "function_body": "{\n    class Example {\n      @POST(\"/foo/bar/\") \n      Call<ResponseBody> method(@Body RequestBody body) {\n        return null;\n      }\n    }\n    try {\n      buildRequest(Example.class, new Object[] { null });\n      fail();\n    } catch (IllegalArgumentException e) {\n      assertThat(e.getMessage()).isEqualTo(\"Body parameter value must not be null.\");\n    }\n  }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 193,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": "Example",
    "function_name": "method(@Body RequestBody body)",
    "function_body": "{\n        return null;\n      }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 194,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": null,
    "function_name": "bodyWithPathParams()",
    "function_body": "{\n    class Example {\n      @POST(\"/foo/bar/{ping}/{kit}/\") \n      Call<ResponseBody> method(@Path(\"ping\") String ping, @Body RequestBody body, @Path(\"kit\") String kit) {\n        return null;\n      }\n    }\n    RequestBody body = RequestBody.create(TEXT_PLAIN, \"Hi!\");\n    Request request = buildRequest(Example.class, \"pong\", body, \"kat\");\n    assertThat(request.method()).isEqualTo(\"POST\");\n    assertThat(request.headers().size()).isZero();\n    assertThat(request.url().toString()).isEqualTo(\"http://example.com/foo/bar/pong/kat/\");\n    assertBody(request.body(), \"Hi!\");\n  }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 195,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": "Example",
    "function_name": "method(@Path(\"ping\") String ping, @Body RequestBody body, @Path(\"kit\") String kit)",
    "function_body": "{\n        return null;\n      }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 196,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": null,
    "function_name": "simpleMultipart() throws IOException",
    "function_body": "{\n    class Example {\n      @Multipart \n      @POST(\"/foo/bar/\") \n      Call<ResponseBody> method(@Part(\"ping\") String ping, @Part(\"kit\") RequestBody kit) {\n        return null;\n      }\n    }\n\n    Request request = buildRequest(Example.class, \"pong\", RequestBody.create(\n        TEXT_PLAIN, \"kat\"));\n    assertThat(request.method()).isEqualTo(\"POST\");\n    assertThat(request.headers().size()).isZero();\n    assertThat(request.url().toString()).isEqualTo(\"http://example.com/foo/bar/\");\n\n    RequestBody body = request.body();\n    Buffer buffer = new Buffer();\n    body.writeTo(buffer);\n    String bodyString = buffer.readUtf8();\n\n    assertThat(bodyString)\n        .contains(\"Content-Disposition: form-data;\")\n        .contains(\"name=\\\"ping\\\"\\r\\n\")\n        .contains(\"\\r\\npong\\r\\n--\");\n\n    assertThat(bodyString)\n        .contains(\"Content-Disposition: form-data;\")\n        .contains(\"name=\\\"kit\\\"\")\n        .contains(\"\\r\\nkat\\r\\n--\");\n  }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 197,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": "Example",
    "function_name": "method(@Part(\"ping\") String ping, @Part(\"kit\") RequestBody kit)",
    "function_body": "{\n        return null;\n      }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 198,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": null,
    "function_name": "multipartArray() throws IOException",
    "function_body": "{\n    class Example {\n      @Multipart \n      @POST(\"/foo/bar/\") \n      Call<ResponseBody> method(@Part(\"ping\") String[] ping) {\n        return null;\n      }\n    }\n\n    Request request =\n        buildRequest(Example.class, new Object[] { new String[] { \"pong1\", \"pong2\" } });\n    assertThat(request.method()).isEqualTo(\"POST\");\n    assertThat(request.headers().size()).isZero();\n    assertThat(request.url().toString()).isEqualTo(\"http://example.com/foo/bar/\");\n\n    RequestBody body = request.body();\n    Buffer buffer = new Buffer();\n    body.writeTo(buffer);\n    String bodyString = buffer.readUtf8();\n\n    assertThat(bodyString)\n        .contains(\"Content-Disposition: form-data;\")\n        .contains(\"name=\\\"ping\\\"\\r\\n\")\n        .contains(\"\\r\\npong1\\r\\n--\");\n\n    assertThat(bodyString)\n        .contains(\"Content-Disposition: form-data;\")\n        .contains(\"name=\\\"ping\\\"\")\n        .contains(\"\\r\\npong2\\r\\n--\");\n  }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 199,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": "Example",
    "function_name": "method(@Part(\"ping\") String[] ping)",
    "function_body": "{\n        return null;\n      }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 200,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": null,
    "function_name": "multipartRequiresName()",
    "function_body": "{\n    class Example {\n      @Multipart \n      @POST(\"/foo/bar/\") \n      Call<ResponseBody> method(@Part RequestBody part) {\n        return null;\n      }\n    }\n\n    try {\n      buildRequest(Example.class, new Object[] { null });\n      fail();\n    } catch (IllegalArgumentException e) {\n      assertThat(e).hasMessage(\n          \"@Part annotation must supply a name or use MultipartBody.Part parameter type. (parameter #1)\\n\"\n              + \"    for method Example.method\");\n    }\n  }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 201,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": "Example",
    "function_name": "method(@Part RequestBody part)",
    "function_body": "{\n        return null;\n      }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 202,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": null,
    "function_name": "multipartIterableRequiresName()",
    "function_body": "{\n    class Example {\n      @Multipart \n      @POST(\"/foo/bar/\") \n      Call<ResponseBody> method(@Part List<RequestBody> part) {\n        return null;\n      }\n    }\n\n    try {\n      buildRequest(Example.class, new Object[] { null });\n      fail();\n    } catch (IllegalArgumentException e) {\n      assertThat(e).hasMessage(\n          \"@Part annotation must supply a name or use MultipartBody.Part parameter type. (parameter #1)\\n\"\n              + \"    for method Example.method\");\n    }\n  }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 203,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": "Example",
    "function_name": "method(@Part List<RequestBody> part)",
    "function_body": "{\n        return null;\n      }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 204,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": null,
    "function_name": "multipartArrayRequiresName()",
    "function_body": "{\n    class Example {\n      @Multipart \n      @POST(\"/foo/bar/\") \n      Call<ResponseBody> method(@Part RequestBody[] part) {\n        return null;\n      }\n    }\n\n    try {\n      buildRequest(Example.class, new Object[] { null });\n      fail();\n    } catch (IllegalArgumentException e) {\n      assertThat(e).hasMessage(\n          \"@Part annotation must supply a name or use MultipartBody.Part parameter type. (parameter #1)\\n\"\n              + \"    for method Example.method\");\n    }\n  }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 205,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": "Example",
    "function_name": "method(@Part RequestBody[] part)",
    "function_body": "{\n        return null;\n      }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 206,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": null,
    "function_name": "multipartOkHttpPartForbidsName()",
    "function_body": "{\n    class Example {\n      @Multipart \n      @POST(\"/foo/bar/\") \n      Call<ResponseBody> method(@Part(\"name\") MultipartBody.Part part) {\n        return null;\n      }\n    }\n\n    try {\n      buildRequest(Example.class, new Object[] { null });\n      fail();\n    } catch (IllegalArgumentException e) {\n      assertThat(e).hasMessage(\n          \"@Part parameters using the MultipartBody.Part must not include a part name in the annotation. (parameter #1)\\n\"\n              + \"    for method Example.method\");\n    }\n  }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 207,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": "Example",
    "function_name": "method(@Part(\"name\") MultipartBody.Part part)",
    "function_body": "{\n        return null;\n      }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 208,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": null,
    "function_name": "multipartOkHttpPart() throws IOException",
    "function_body": "{\n    class Example {\n      @Multipart \n      @POST(\"/foo/bar/\") \n      Call<ResponseBody> method(@Part MultipartBody.Part part) {\n        return null;\n      }\n    }\n\n    MultipartBody.Part part = MultipartBody.Part.createFormData(\"kit\", \"kat\");\n    Request request = buildRequest(Example.class, part);\n    assertThat(request.method()).isEqualTo(\"POST\");\n    assertThat(request.headers().size()).isZero();\n    assertThat(request.url().toString()).isEqualTo(\"http://example.com/foo/bar/\");\n\n    RequestBody body = request.body();\n    Buffer buffer = new Buffer();\n    body.writeTo(buffer);\n    String bodyString = buffer.readUtf8();\n\n    assertThat(bodyString)\n        .contains(\"Content-Disposition: form-data;\")\n        .contains(\"name=\\\"kit\\\"\\r\\n\")\n        .contains(\"\\r\\nkat\\r\\n--\");\n  }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 209,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": "Example",
    "function_name": "method(@Part MultipartBody.Part part)",
    "function_body": "{\n        return null;\n      }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 210,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": null,
    "function_name": "multipartOkHttpIterablePart() throws IOException",
    "function_body": "{\n    class Example {\n      @Multipart \n      @POST(\"/foo/bar/\") \n      Call<ResponseBody> method(@Part List<MultipartBody.Part> part) {\n        return null;\n      }\n    }\n\n    MultipartBody.Part part1 = MultipartBody.Part.createFormData(\"foo\", \"bar\");\n    MultipartBody.Part part2 = MultipartBody.Part.createFormData(\"kit\", \"kat\");\n    Request request = buildRequest(Example.class, Arrays.asList(part1, part2));\n    assertThat(request.method()).isEqualTo(\"POST\");\n    assertThat(request.headers().size()).isZero();\n    assertThat(request.url().toString()).isEqualTo(\"http://example.com/foo/bar/\");\n\n    RequestBody body = request.body();\n    Buffer buffer = new Buffer();\n    body.writeTo(buffer);\n    String bodyString = buffer.readUtf8();\n\n    assertThat(bodyString)\n        .contains(\"Content-Disposition: form-data;\")\n        .contains(\"name=\\\"foo\\\"\\r\\n\")\n        .contains(\"\\r\\nbar\\r\\n--\");\n\n    assertThat(bodyString)\n        .contains(\"Content-Disposition: form-data;\")\n        .contains(\"name=\\\"kit\\\"\\r\\n\")\n        .contains(\"\\r\\nkat\\r\\n--\");\n  }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 211,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": "Example",
    "function_name": "method(@Part List<MultipartBody.Part> part)",
    "function_body": "{\n        return null;\n      }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 212,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": null,
    "function_name": "multipartOkHttpArrayPart() throws IOException",
    "function_body": "{\n    class Example {\n      @Multipart \n      @POST(\"/foo/bar/\") \n      Call<ResponseBody> method(@Part MultipartBody.Part[] part) {\n        return null;\n      }\n    }\n\n    MultipartBody.Part part1 = MultipartBody.Part.createFormData(\"foo\", \"bar\");\n    MultipartBody.Part part2 = MultipartBody.Part.createFormData(\"kit\", \"kat\");\n    Request request =\n        buildRequest(Example.class, new Object[] { new MultipartBody.Part[] { part1, part2 } });\n    assertThat(request.method()).isEqualTo(\"POST\");\n    assertThat(request.headers().size()).isZero();\n    assertThat(request.url().toString()).isEqualTo(\"http://example.com/foo/bar/\");\n\n    RequestBody body = request.body();\n    Buffer buffer = new Buffer();\n    body.writeTo(buffer);\n    String bodyString = buffer.readUtf8();\n\n    assertThat(bodyString)\n        .contains(\"Content-Disposition: form-data;\")\n        .contains(\"name=\\\"foo\\\"\\r\\n\")\n        .contains(\"\\r\\nbar\\r\\n--\");\n\n    assertThat(bodyString)\n        .contains(\"Content-Disposition: form-data;\")\n        .contains(\"name=\\\"kit\\\"\\r\\n\")\n        .contains(\"\\r\\nkat\\r\\n--\");\n  }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 213,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": "Example",
    "function_name": "method(@Part MultipartBody.Part[] part)",
    "function_body": "{\n        return null;\n      }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 214,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": null,
    "function_name": "multipartOkHttpPartWithFilename() throws IOException",
    "function_body": "{\n    class Example {\n      @Multipart \n      @POST(\"/foo/bar/\") \n      Call<ResponseBody> method(@Part MultipartBody.Part part) {\n        return null;\n      }\n    }\n\n    MultipartBody.Part part =\n        MultipartBody.Part.createFormData(\"kit\", \"kit.txt\", RequestBody.create(null, \"kat\"));\n    Request request = buildRequest(Example.class, part);\n    assertThat(request.method()).isEqualTo(\"POST\");\n    assertThat(request.headers().size()).isZero();\n    assertThat(request.url().toString()).isEqualTo(\"http://example.com/foo/bar/\");\n\n    RequestBody body = request.body();\n    Buffer buffer = new Buffer();\n    body.writeTo(buffer);\n    String bodyString = buffer.readUtf8();\n\n    assertThat(bodyString)\n        .contains(\"Content-Disposition: form-data;\")\n        .contains(\"name=\\\"kit\\\"; filename=\\\"kit.txt\\\"\\r\\n\")\n        .contains(\"\\r\\nkat\\r\\n--\");\n  }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 215,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": "Example",
    "function_name": "method(@Part MultipartBody.Part part)",
    "function_body": "{\n        return null;\n      }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 216,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": null,
    "function_name": "multipartIterable() throws IOException",
    "function_body": "{\n    class Example {\n      @Multipart \n      @POST(\"/foo/bar/\") \n      Call<ResponseBody> method(@Part(\"ping\") List<String> ping) {\n        return null;\n      }\n    }\n\n    Request request = buildRequest(Example.class, Arrays.asList(\"pong1\", \"pong2\"));\n    assertThat(request.method()).isEqualTo(\"POST\");\n    assertThat(request.headers().size()).isZero();\n    assertThat(request.url().toString()).isEqualTo(\"http://example.com/foo/bar/\");\n\n    RequestBody body = request.body();\n    Buffer buffer = new Buffer();\n    body.writeTo(buffer);\n    String bodyString = buffer.readUtf8();\n\n    assertThat(bodyString)\n        .contains(\"Content-Disposition: form-data;\")\n        .contains(\"name=\\\"ping\\\"\\r\\n\")\n        .contains(\"\\r\\npong1\\r\\n--\");\n\n    assertThat(bodyString)\n        .contains(\"Content-Disposition: form-data;\")\n        .contains(\"name=\\\"ping\\\"\")\n        .contains(\"\\r\\npong2\\r\\n--\");\n  }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 217,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": "Example",
    "function_name": "method(@Part(\"ping\") List<String> ping)",
    "function_body": "{\n        return null;\n      }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 218,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": null,
    "function_name": "multipartIterableOkHttpPart()",
    "function_body": "{\n    class Example {\n      @Multipart \n      @POST(\"/foo/bar/\") \n      Call<ResponseBody> method(@Part(\"ping\") List<MultipartBody.Part> part) {\n        return null;\n      }\n    }\n\n    try {\n      buildRequest(Example.class, new Object[] { null });\n      fail();\n    } catch (IllegalArgumentException e) {\n      assertThat(e).hasMessage(\n          \"@Part parameters using the MultipartBody.Part must not include a part name in the annotation. (parameter #1)\\n\"\n              + \"    for method Example.method\");\n    }\n  }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 219,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": "Example",
    "function_name": "method(@Part(\"ping\") List<MultipartBody.Part> part)",
    "function_body": "{\n        return null;\n      }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 220,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": null,
    "function_name": "multipartArrayOkHttpPart()",
    "function_body": "{\n    class Example {\n      @Multipart \n      @POST(\"/foo/bar/\") \n      Call<ResponseBody> method(@Part(\"ping\") MultipartBody.Part[] part) {\n        return null;\n      }\n    }\n\n    try {\n      buildRequest(Example.class, new Object[] { null });\n      fail();\n    } catch (IllegalArgumentException e) {\n      assertThat(e).hasMessage(\n          \"@Part parameters using the MultipartBody.Part must not include a part name in the annotation. (parameter #1)\\n\"\n              + \"    for method Example.method\");\n    }\n  }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 221,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": "Example",
    "function_name": "method(@Part(\"ping\") MultipartBody.Part[] part)",
    "function_body": "{\n        return null;\n      }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 222,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": null,
    "function_name": "multipartWithEncoding() throws IOException",
    "function_body": "{\n    class Example {\n      @Multipart \n      @POST(\"/foo/bar/\") \n      Call<ResponseBody> method(@Part(value = \"ping\", encoding = \"8-bit\") String ping,\n          @Part(value = \"kit\", encoding = \"7-bit\") RequestBody kit) {\n        return null;\n      }\n    }\n\n    Request request = buildRequest(Example.class, \"pong\", RequestBody.create(\n        TEXT_PLAIN, \"kat\"));\n    assertThat(request.method()).isEqualTo(\"POST\");\n    assertThat(request.headers().size()).isZero();\n    assertThat(request.url().toString()).isEqualTo(\"http://example.com/foo/bar/\");\n\n    RequestBody body = request.body();\n    Buffer buffer = new Buffer();\n    body.writeTo(buffer);\n    String bodyString = buffer.readUtf8();\n\n    assertThat(bodyString)\n        .contains(\"Content-Disposition: form-data;\")\n        .contains(\"name=\\\"ping\\\"\\r\\n\")\n        .contains(\"Content-Transfer-Encoding: 8-bit\")\n        .contains(\"\\r\\npong\\r\\n--\");\n\n    assertThat(bodyString)\n        .contains(\"Content-Disposition: form-data;\")\n        .contains(\"name=\\\"kit\\\"\")\n        .contains(\"Content-Transfer-Encoding: 7-bit\")\n        .contains(\"\\r\\nkat\\r\\n--\");\n  }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 223,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": "Example",
    "function_name": "method(@Part(value = \"ping\", encoding = \"8-bit\") String ping,\n          @Part(value = \"kit\", encoding = \"7-bit\") RequestBody kit)",
    "function_body": "{\n        return null;\n      }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 224,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": null,
    "function_name": "multipartPartMap() throws IOException",
    "function_body": "{\n    class Example {\n      @Multipart \n      @POST(\"/foo/bar/\") \n      Call<ResponseBody> method(@PartMap Map<String, RequestBody> parts) {\n        return null;\n      }\n    }\n\n    Map<String, RequestBody> params = new LinkedHashMap<>();\n    params.put(\"ping\", RequestBody.create(null, \"pong\"));\n    params.put(\"kit\", RequestBody.create(null, \"kat\"));\n\n    Request request = buildRequest(Example.class, params);\n    assertThat(request.method()).isEqualTo(\"POST\");\n    assertThat(request.headers().size()).isZero();\n    assertThat(request.url().toString()).isEqualTo(\"http://example.com/foo/bar/\");\n\n    RequestBody body = request.body();\n    Buffer buffer = new Buffer();\n    body.writeTo(buffer);\n    String bodyString = buffer.readUtf8();\n\n    assertThat(bodyString)\n        .contains(\"Content-Disposition: form-data;\")\n        .contains(\"name=\\\"ping\\\"\\r\\n\")\n        .contains(\"\\r\\npong\\r\\n--\");\n\n    assertThat(bodyString)\n        .contains(\"Content-Disposition: form-data;\")\n        .contains(\"name=\\\"kit\\\"\")\n        .contains(\"\\r\\nkat\\r\\n--\");\n  }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 225,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": "Example",
    "function_name": "method(@PartMap Map<String, RequestBody> parts)",
    "function_body": "{\n        return null;\n      }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 226,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": null,
    "function_name": "multipartPartMapWithEncoding() throws IOException",
    "function_body": "{\n    class Example {\n      @Multipart \n      @POST(\"/foo/bar/\") \n      Call<ResponseBody> method(@PartMap(encoding = \"8-bit\") Map<String, RequestBody> parts) {\n        return null;\n      }\n    }\n\n    Map<String, RequestBody> params = new LinkedHashMap<>();\n    params.put(\"ping\", RequestBody.create(null, \"pong\"));\n    params.put(\"kit\", RequestBody.create(null, \"kat\"));\n\n    Request request = buildRequest(Example.class, params);\n    assertThat(request.method()).isEqualTo(\"POST\");\n    assertThat(request.headers().size()).isZero();\n    assertThat(request.url().toString()).isEqualTo(\"http://example.com/foo/bar/\");\n\n    RequestBody body = request.body();\n    Buffer buffer = new Buffer();\n    body.writeTo(buffer);\n    String bodyString = buffer.readUtf8();\n\n    assertThat(bodyString)\n        .contains(\"Content-Disposition: form-data;\")\n        .contains(\"name=\\\"ping\\\"\\r\\n\")\n        .contains(\"Content-Transfer-Encoding: 8-bit\")\n        .contains(\"\\r\\npong\\r\\n--\");\n\n    assertThat(bodyString)\n        .contains(\"Content-Disposition: form-data;\")\n        .contains(\"name=\\\"kit\\\"\")\n        .contains(\"Content-Transfer-Encoding: 8-bit\")\n        .contains(\"\\r\\nkat\\r\\n--\");\n  }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 227,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": "Example",
    "function_name": "method(@PartMap(encoding = \"8-bit\") Map<String, RequestBody> parts)",
    "function_body": "{\n        return null;\n      }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 228,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": null,
    "function_name": "multipartPartMapRejectsNonStringKeys()",
    "function_body": "{\n    class Example {\n      @Multipart \n      @POST(\"/foo/bar/\") \n      Call<ResponseBody> method(@PartMap Map<Object, RequestBody> parts) {\n        return null;\n      }\n    }\n\n    try {\n      buildRequest(Example.class, new Object[] { null });\n      fail();\n    } catch (IllegalArgumentException e) {\n      assertThat(e).hasMessage(\n          \"@PartMap keys must be of type String: class java.lang.Object (parameter #1)\\n\"\n              + \"    for method Example.method\");\n    }\n  }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 229,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": "Example",
    "function_name": "method(@PartMap Map<Object, RequestBody> parts)",
    "function_body": "{\n        return null;\n      }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 230,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": null,
    "function_name": "multipartPartMapRejectsOkHttpPartValues()",
    "function_body": "{\n    class Example {\n      @Multipart \n      @POST(\"/foo/bar/\") \n      Call<ResponseBody> method(@PartMap Map<String, MultipartBody.Part> parts) {\n        return null;\n      }\n    }\n\n    try {\n      buildRequest(Example.class, new Object[] { null });\n      fail();\n    } catch (IllegalArgumentException e) {\n      assertThat(e).hasMessage(\n          \"@PartMap values cannot be MultipartBody.Part. Use @Part List<Part> or a different value type instead. (parameter #1)\\n\"\n              + \"    for method Example.method\");\n    }\n  }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 231,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": "Example",
    "function_name": "method(@PartMap Map<String, MultipartBody.Part> parts)",
    "function_body": "{\n        return null;\n      }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 232,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": null,
    "function_name": "multipartPartMapRejectsNull()",
    "function_body": "{\n    class Example {\n      @Multipart \n      @POST(\"/foo/bar/\") \n      Call<ResponseBody> method(@PartMap Map<String, RequestBody> parts) {\n        return null;\n      }\n    }\n\n    try {\n      buildRequest(Example.class, new Object[] { null });\n      fail();\n    } catch (IllegalArgumentException e) {\n      assertThat(e).hasMessage(\"Part map was null.\");\n    }\n  }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 233,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": "Example",
    "function_name": "method(@PartMap Map<String, RequestBody> parts)",
    "function_body": "{\n        return null;\n      }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 234,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": null,
    "function_name": "multipartPartMapRejectsNullKeys()",
    "function_body": "{\n    class Example {\n      @Multipart \n      @POST(\"/foo/bar/\") \n      Call<ResponseBody> method(@PartMap Map<String, RequestBody> parts) {\n        return null;\n      }\n    }\n\n    Map<String, RequestBody> params = new LinkedHashMap<>();\n    params.put(\"ping\", RequestBody.create(null, \"pong\"));\n    params.put(null, RequestBody.create(null, \"kat\"));\n\n    try {\n      buildRequest(Example.class, params);\n      fail();\n    } catch (IllegalArgumentException e) {\n      assertThat(e).hasMessage(\"Part map contained null key.\");\n    }\n  }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 235,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": "Example",
    "function_name": "method(@PartMap Map<String, RequestBody> parts)",
    "function_body": "{\n        return null;\n      }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 236,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": null,
    "function_name": "multipartPartMapRejectsNullValues()",
    "function_body": "{\n    class Example {\n      @Multipart \n      @POST(\"/foo/bar/\") \n      Call<ResponseBody> method(@PartMap Map<String, RequestBody> parts) {\n        return null;\n      }\n    }\n\n    Map<String, RequestBody> params = new LinkedHashMap<>();\n    params.put(\"ping\", RequestBody.create(null, \"pong\"));\n    params.put(\"kit\", null);\n\n    try {\n      buildRequest(Example.class, params);\n      fail();\n    } catch (IllegalArgumentException e) {\n      assertThat(e).hasMessage(\"Part map contained null value for key 'kit'.\");\n    }\n  }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 237,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": "Example",
    "function_name": "method(@PartMap Map<String, RequestBody> parts)",
    "function_body": "{\n        return null;\n      }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 238,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": null,
    "function_name": "multipartPartMapMustBeMap()",
    "function_body": "{\n    class Example {\n      @Multipart \n      @POST(\"/foo/bar/\") \n      Call<ResponseBody> method(@PartMap List<Object> parts) {\n        return null;\n      }\n    }\n\n    try {\n      buildRequest(Example.class, Collections.emptyList());\n      fail();\n    } catch (IllegalArgumentException e) {\n      assertThat(e).hasMessage(\n          \"@PartMap parameter type must be Map. (parameter #1)\\n    for method Example.method\");\n    }\n  }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 239,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": "Example",
    "function_name": "method(@PartMap List<Object> parts)",
    "function_body": "{\n        return null;\n      }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 240,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": null,
    "function_name": "multipartPartMapSupportsSubclasses() throws IOException",
    "function_body": "{\n    class Foo extends HashMap<String, String> {\n    }\n\n    class Example {\n      @Multipart \n      @POST(\"/foo/bar/\") \n      Call<ResponseBody> method(@PartMap Foo parts) {\n        return null;\n      }\n    }\n\n    Foo foo = new Foo();\n    foo.put(\"hello\", \"world\");\n\n    Request request = buildRequest(Example.class, foo);\n    Buffer buffer = new Buffer();\n    request.body().writeTo(buffer);\n    assertThat(buffer.readUtf8())\n        .contains(\"name=\\\"hello\\\"\")\n        .contains(\"\\r\\n\\r\\nworld\\r\\n--\");\n  }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 241,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": "Example",
    "function_name": "method(@PartMap Foo parts)",
    "function_body": "{\n        return null;\n      }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 242,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": null,
    "function_name": "multipartNullRemovesPart() throws IOException",
    "function_body": "{\n    class Example {\n      @Multipart \n      @POST(\"/foo/bar/\") \n      Call<ResponseBody> method(@Part(\"ping\") String ping, @Part(\"fizz\") String fizz) {\n        return null;\n      }\n    }\n    Request request = buildRequest(Example.class, \"pong\", null);\n    assertThat(request.method()).isEqualTo(\"POST\");\n    assertThat(request.headers().size()).isZero();\n    assertThat(request.url().toString()).isEqualTo(\"http://example.com/foo/bar/\");\n\n    RequestBody body = request.body();\n    Buffer buffer = new Buffer();\n    body.writeTo(buffer);\n    String bodyString = buffer.readUtf8();\n\n    assertThat(bodyString)\n        .contains(\"Content-Disposition: form-data;\")\n        .contains(\"name=\\\"ping\\\"\")\n        .contains(\"\\r\\npong\\r\\n--\");\n  }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 243,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": "Example",
    "function_name": "method(@Part(\"ping\") String ping, @Part(\"fizz\") String fizz)",
    "function_body": "{\n        return null;\n      }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 244,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": null,
    "function_name": "multipartPartOptional()",
    "function_body": "{\n    class Example {\n      @Multipart \n      @POST(\"/foo/bar/\") \n      Call<ResponseBody> method(@Part(\"ping\") RequestBody ping) {\n        return null;\n      }\n    }\n    try {\n      buildRequest(Example.class, new Object[] { null });\n      fail();\n    } catch (IllegalStateException e) {\n      assertThat(e.getMessage()).isEqualTo(\"Multipart body must have at least one part.\");\n    }\n  }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 245,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": "Example",
    "function_name": "method(@Part(\"ping\") RequestBody ping)",
    "function_body": "{\n        return null;\n      }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 246,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": null,
    "function_name": "simpleFormEncoded()",
    "function_body": "{\n    class Example {\n      @FormUrlEncoded \n      @POST(\"/foo\") \n      Call<ResponseBody> method(@Field(\"foo\") String foo, @Field(\"ping\") String ping) {\n        return null;\n      }\n    }\n    Request request = buildRequest(Example.class, \"bar\", \"pong\");\n    assertBody(request.body(), \"foo=bar&ping=pong\");\n  }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 247,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": "Example",
    "function_name": "method(@Field(\"foo\") String foo, @Field(\"ping\") String ping)",
    "function_body": "{\n        return null;\n      }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 248,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": null,
    "function_name": "formEncodedWithEncodedNameFieldParam()",
    "function_body": "{\n    class Example {\n      @FormUrlEncoded \n      @POST(\"/foo\") \n      Call<ResponseBody> method(@Field(value = \"na%20me\", encoded = true) String foo) {\n        return null;\n      }\n    }\n    Request request = buildRequest(Example.class, \"ba%20r\");\n    assertBody(request.body(), \"na%20me=ba%20r\");\n  }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 249,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": "Example",
    "function_name": "method(@Field(value = \"na%20me\", encoded = true) String foo)",
    "function_body": "{\n        return null;\n      }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 250,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": null,
    "function_name": "formEncodedFieldOptional()",
    "function_body": "{\n    class Example {\n      @FormUrlEncoded \n      @POST(\"/foo\") \n      Call<ResponseBody> method(@Field(\"foo\") String foo, @Field(\"ping\") String ping,\n          @Field(\"kit\") String kit) {\n        return null;\n      }\n    }\n    Request request = buildRequest(Example.class, \"bar\", null, \"kat\");\n    assertBody(request.body(), \"foo=bar&kit=kat\");\n  }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 251,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": "Example",
    "function_name": "method(@Field(\"foo\") String foo, @Field(\"ping\") String ping,\n          @Field(\"kit\") String kit)",
    "function_body": "{\n        return null;\n      }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 252,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": null,
    "function_name": "formEncodedFieldList()",
    "function_body": "{\n    class Example {\n      @FormUrlEncoded \n      @POST(\"/foo\") \n      Call<ResponseBody> method(@Field(\"foo\") List<Object> fields, @Field(\"kit\") String kit) {\n        return null;\n      }\n    }\n\n    List<Object> values = Arrays.<Object>asList(\"foo\", \"bar\", null, 3);\n    Request request = buildRequest(Example.class, values, \"kat\");\n    assertBody(request.body(), \"foo=foo&foo=bar&foo=3&kit=kat\");\n  }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 253,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": "Example",
    "function_name": "method(@Field(\"foo\") List<Object> fields, @Field(\"kit\") String kit)",
    "function_body": "{\n        return null;\n      }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 254,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": null,
    "function_name": "formEncodedFieldArray()",
    "function_body": "{\n    class Example {\n      @FormUrlEncoded \n      @POST(\"/foo\") \n      Call<ResponseBody> method(@Field(\"foo\") Object[] fields, @Field(\"kit\") String kit) {\n        return null;\n      }\n    }\n\n    Object[] values = { 1, 2, null, \"three\" };\n    Request request = buildRequest(Example.class, values, \"kat\");\n    assertBody(request.body(), \"foo=1&foo=2&foo=three&kit=kat\");\n  }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 255,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": "Example",
    "function_name": "method(@Field(\"foo\") Object[] fields, @Field(\"kit\") String kit)",
    "function_body": "{\n        return null;\n      }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 256,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": null,
    "function_name": "formEncodedFieldPrimitiveArray()",
    "function_body": "{\n    class Example {\n      @FormUrlEncoded \n      @POST(\"/foo\") \n      Call<ResponseBody> method(@Field(\"foo\") int[] fields, @Field(\"kit\") String kit) {\n        return null;\n      }\n    }\n\n    int[] values = { 1, 2, 3 };\n    Request request = buildRequest(Example.class, values, \"kat\");\n    assertBody(request.body(), \"foo=1&foo=2&foo=3&kit=kat\");\n  }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 257,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": "Example",
    "function_name": "method(@Field(\"foo\") int[] fields, @Field(\"kit\") String kit)",
    "function_body": "{\n        return null;\n      }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 258,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": null,
    "function_name": "formEncodedWithEncodedNameFieldParamMap()",
    "function_body": "{\n    class Example {\n      @FormUrlEncoded \n      @POST(\"/foo\") \n      Call<ResponseBody> method(@FieldMap(encoded = true) Map<String, Object> fieldMap) {\n        return null;\n      }\n    }\n\n    Map<String, Object> fieldMap = new LinkedHashMap<>();\n    fieldMap.put(\"k%20it\", \"k%20at\");\n    fieldMap.put(\"pin%20g\", \"po%20ng\");\n\n    Request request = buildRequest(Example.class, fieldMap);\n    assertBody(request.body(), \"k%20it=k%20at&pin%20g=po%20ng\");\n  }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 259,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": "Example",
    "function_name": "method(@FieldMap(encoded = true) Map<String, Object> fieldMap)",
    "function_body": "{\n        return null;\n      }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 260,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": null,
    "function_name": "formEncodedFieldMap()",
    "function_body": "{\n    class Example {\n      @FormUrlEncoded \n      @POST(\"/foo\") \n      Call<ResponseBody> method(@FieldMap Map<String, Object> fieldMap) {\n        return null;\n      }\n    }\n\n    Map<String, Object> fieldMap = new LinkedHashMap<>();\n    fieldMap.put(\"kit\", \"kat\");\n    fieldMap.put(\"ping\", \"pong\");\n\n    Request request = buildRequest(Example.class, fieldMap);\n    assertBody(request.body(), \"kit=kat&ping=pong\");\n  }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 261,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": "Example",
    "function_name": "method(@FieldMap Map<String, Object> fieldMap)",
    "function_body": "{\n        return null;\n      }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 262,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": null,
    "function_name": "fieldMapRejectsNull()",
    "function_body": "{\n    class Example {\n      @FormUrlEncoded \n      @POST(\"/\") \n      Call<ResponseBody> method(@FieldMap Map<String, Object> a) {\n        return null;\n      }\n    }\n\n    try {\n      buildRequest(Example.class, new Object[] { null });\n      fail();\n    } catch (IllegalArgumentException e) {\n      assertThat(e).hasMessage(\"Field map was null.\");\n    }\n  }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 263,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": "Example",
    "function_name": "method(@FieldMap Map<String, Object> a)",
    "function_body": "{\n        return null;\n      }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 264,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": null,
    "function_name": "fieldMapRejectsNullKeys()",
    "function_body": "{\n    class Example {\n      @FormUrlEncoded \n      @POST(\"/\") \n      Call<ResponseBody> method(@FieldMap Map<String, Object> a) {\n        return null;\n      }\n    }\n\n    Map<String, Object> fieldMap = new LinkedHashMap<>();\n    fieldMap.put(\"kit\", \"kat\");\n    fieldMap.put(null, \"pong\");\n\n    try {\n      buildRequest(Example.class, fieldMap);\n      fail();\n    } catch (IllegalArgumentException e) {\n      assertThat(e).hasMessage(\"Field map contained null key.\");\n    }\n  }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 265,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": "Example",
    "function_name": "method(@FieldMap Map<String, Object> a)",
    "function_body": "{\n        return null;\n      }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 266,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": null,
    "function_name": "fieldMapRejectsNullValues()",
    "function_body": "{\n    class Example {\n      @FormUrlEncoded \n      @POST(\"/\") \n      Call<ResponseBody> method(@FieldMap Map<String, Object> a) {\n        return null;\n      }\n    }\n\n    Map<String, Object> fieldMap = new LinkedHashMap<>();\n    fieldMap.put(\"kit\", \"kat\");\n    fieldMap.put(\"foo\", null);\n\n    try {\n      buildRequest(Example.class, fieldMap);\n      fail();\n    } catch (IllegalArgumentException e) {\n      assertThat(e).hasMessage(\"Field map contained null value for key 'foo'.\");\n    }\n  }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 267,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": "Example",
    "function_name": "method(@FieldMap Map<String, Object> a)",
    "function_body": "{\n        return null;\n      }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 268,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": null,
    "function_name": "fieldMapMustBeAMap()",
    "function_body": "{\n    class Example {\n      @FormUrlEncoded \n      @POST(\"/\") \n      Call<ResponseBody> method(@FieldMap List<String> a) {\n        return null;\n      }\n    }\n    try {\n      buildRequest(Example.class);\n      fail();\n    } catch (IllegalArgumentException e) {\n      assertThat(e).hasMessage(\n          \"@FieldMap parameter type must be Map. (parameter #1)\\n    for method Example.method\");\n    }\n  }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 269,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": "Example",
    "function_name": "method(@FieldMap List<String> a)",
    "function_body": "{\n        return null;\n      }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 270,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": null,
    "function_name": "fieldMapSupportsSubclasses() throws IOException",
    "function_body": "{\n    class Foo extends HashMap<String, String> {\n    }\n\n    class Example {\n      @FormUrlEncoded \n      @POST(\"/\") \n      Call<ResponseBody> method(@FieldMap Foo a) {\n        return null;\n      }\n    }\n\n    Foo foo = new Foo();\n    foo.put(\"hello\", \"world\");\n\n    Request request = buildRequest(Example.class, foo);\n    Buffer buffer = new Buffer();\n    request.body().writeTo(buffer);\n    assertThat(buffer.readUtf8()).isEqualTo(\"hello=world\");\n  }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 271,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": "Example",
    "function_name": "method(@FieldMap Foo a)",
    "function_body": "{\n        return null;\n      }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 272,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": null,
    "function_name": "simpleHeaders()",
    "function_body": "{\n    class Example {\n      @GET(\"/foo/bar/\")\n      @Headers({\n          \"ping: pong\",\n          \"kit: kat\"\n      })\n      Call<ResponseBody> method() {\n        return null;\n      }\n    }\n    Request request = buildRequest(Example.class);\n    assertThat(request.method()).isEqualTo(\"GET\");\n    okhttp3.Headers headers = request.headers();\n    assertThat(headers.size()).isEqualTo(2);\n    assertThat(headers.get(\"ping\")).isEqualTo(\"pong\");\n    assertThat(headers.get(\"kit\")).isEqualTo(\"kat\");\n    assertThat(request.url().toString()).isEqualTo(\"http://example.com/foo/bar/\");\n    assertThat(request.body()).isNull();\n  }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 273,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": "Example",
    "function_name": "method()",
    "function_body": "{\n        return null;\n      }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 274,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": null,
    "function_name": "headersDoNotOverwriteEachOther()",
    "function_body": "{\n    class Example {\n      @GET(\"/foo/bar/\")\n      @Headers({\n          \"ping: pong\",\n          \"kit: kat\",\n          \"kit: -kat\",\n      })\n      Call<ResponseBody> method() {\n        return null;\n      }\n    }\n    Request request = buildRequest(Example.class);\n    assertThat(request.method()).isEqualTo(\"GET\");\n    okhttp3.Headers headers = request.headers();\n    assertThat(headers.size()).isEqualTo(3);\n    assertThat(headers.get(\"ping\")).isEqualTo(\"pong\");\n    assertThat(headers.values(\"kit\")).containsOnly(\"kat\", \"-kat\");\n    assertThat(request.url().toString()).isEqualTo(\"http://example.com/foo/bar/\");\n    assertThat(request.body()).isNull();\n  }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 275,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": "Example",
    "function_name": "method()",
    "function_body": "{\n        return null;\n      }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 276,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": null,
    "function_name": "headerParamToString()",
    "function_body": "{\n    class Example {\n      @GET(\"/foo/bar/\") \n      Call<ResponseBody> method(@Header(\"kit\") BigInteger kit) {\n        return null;\n      }\n    }\n    Request request = buildRequest(Example.class, new BigInteger(\"1234\"));\n    assertThat(request.method()).isEqualTo(\"GET\");\n    okhttp3.Headers headers = request.headers();\n    assertThat(headers.size()).isEqualTo(1);\n    assertThat(headers.get(\"kit\")).isEqualTo(\"1234\");\n    assertThat(request.url().toString()).isEqualTo(\"http://example.com/foo/bar/\");\n    assertThat(request.body()).isNull();\n  }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 277,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": "Example",
    "function_name": "method(@Header(\"kit\") BigInteger kit)",
    "function_body": "{\n        return null;\n      }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 278,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": null,
    "function_name": "headerParam()",
    "function_body": "{\n    class Example {\n      @GET(\"/foo/bar/\") \n      @Headers(\"ping: pong\") \n      Call<ResponseBody> method(@Header(\"kit\") String kit) {\n        return null;\n      }\n    }\n    Request request = buildRequest(Example.class, \"kat\");\n    assertThat(request.method()).isEqualTo(\"GET\");\n    okhttp3.Headers headers = request.headers();\n    assertThat(headers.size()).isEqualTo(2);\n    assertThat(headers.get(\"ping\")).isEqualTo(\"pong\");\n    assertThat(headers.get(\"kit\")).isEqualTo(\"kat\");\n    assertThat(request.url().toString()).isEqualTo(\"http://example.com/foo/bar/\");\n    assertThat(request.body()).isNull();\n  }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 279,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": "Example",
    "function_name": "method(@Header(\"kit\") String kit)",
    "function_body": "{\n        return null;\n      }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 280,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": null,
    "function_name": "headerParamList()",
    "function_body": "{\n    class Example {\n      @GET(\"/foo/bar/\") \n      Call<ResponseBody> method(@Header(\"foo\") List<String> kit) {\n        return null;\n      }\n    }\n    Request request = buildRequest(Example.class, Arrays.asList(\"bar\", null, \"baz\"));\n    assertThat(request.method()).isEqualTo(\"GET\");\n    okhttp3.Headers headers = request.headers();\n    assertThat(headers.size()).isEqualTo(2);\n    assertThat(headers.values(\"foo\")).containsExactly(\"bar\", \"baz\");\n    assertThat(request.url().toString()).isEqualTo(\"http://example.com/foo/bar/\");\n    assertThat(request.body()).isNull();\n  }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 281,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": "Example",
    "function_name": "method(@Header(\"foo\") List<String> kit)",
    "function_body": "{\n        return null;\n      }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 282,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": null,
    "function_name": "headerParamArray()",
    "function_body": "{\n    class Example {\n      @GET(\"/foo/bar/\") \n      Call<ResponseBody> method(@Header(\"foo\") String[] kit) {\n        return null;\n      }\n    }\n    Request request = buildRequest(Example.class, (Object) new String[] { \"bar\", null, \"baz\" });\n    assertThat(request.method()).isEqualTo(\"GET\");\n    okhttp3.Headers headers = request.headers();\n    assertThat(headers.size()).isEqualTo(2);\n    assertThat(headers.values(\"foo\")).containsExactly(\"bar\", \"baz\");\n    assertThat(request.url().toString()).isEqualTo(\"http://example.com/foo/bar/\");\n    assertThat(request.body()).isNull();\n  }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 283,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": "Example",
    "function_name": "method(@Header(\"foo\") String[] kit)",
    "function_body": "{\n        return null;\n      }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 284,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": null,
    "function_name": "contentTypeAnnotationHeaderOverrides()",
    "function_body": "{\n    class Example {\n      @POST(\"/\") \n      @Headers(\"Content-Type: text/not-plain\") \n      Call<ResponseBody> method(@Body RequestBody body) {\n        return null;\n      }\n    }\n    RequestBody body = RequestBody.create(TEXT_PLAIN, \"hi\");\n    Request request = buildRequest(Example.class, body);\n    assertThat(request.body().contentType().toString()).isEqualTo(\"text/not-plain\");\n  }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 285,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": "Example",
    "function_name": "method(@Body RequestBody body)",
    "function_body": "{\n        return null;\n      }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 286,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": null,
    "function_name": "malformedContentTypeHeaderThrows()",
    "function_body": "{\n    class Example {\n      @POST(\"/\") \n      @Headers(\"Content-Type: hello, world!\") \n      Call<ResponseBody> method(@Body RequestBody body) {\n        return null;\n      }\n    }\n    RequestBody body = RequestBody.create(TEXT_PLAIN, \"hi\");\n    try {\n      buildRequest(Example.class, body);\n      fail();\n    } catch (IllegalArgumentException e) {\n      assertThat(e).hasMessage(\"Malformed content type: hello, world!\\n\"\n          + \"    for method Example.method\");\n      assertThat(e.getCause()).isInstanceOf(IllegalArgumentException.class); \n    }\n  }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 287,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": "Example",
    "function_name": "method(@Body RequestBody body)",
    "function_body": "{\n        return null;\n      }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 288,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": null,
    "function_name": "contentTypeAnnotationHeaderAddsHeaderWithNoBody()",
    "function_body": "{\n    class Example {\n      @DELETE(\"/\") \n      @Headers(\"Content-Type: text/not-plain\") \n      Call<ResponseBody> method() {\n        return null;\n      }\n    }\n    Request request = buildRequest(Example.class);\n    assertThat(request.headers().get(\"Content-Type\")).isEqualTo(\"text/not-plain\");\n  }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 289,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": "Example",
    "function_name": "method()",
    "function_body": "{\n        return null;\n      }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 290,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": null,
    "function_name": "contentTypeParameterHeaderOverrides()",
    "function_body": "{\n    class Example {\n      @POST(\"/\") \n      Call<ResponseBody> method(@Header(\"Content-Type\") String contentType, @Body RequestBody body) {\n        return null;\n      }\n    }\n    RequestBody body = RequestBody.create(TEXT_PLAIN, \"Plain\");\n    Request request = buildRequest(Example.class, \"text/not-plain\", body);\n    assertThat(request.body().contentType().toString()).isEqualTo(\"text/not-plain\");\n  }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 291,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": "Example",
    "function_name": "method(@Header(\"Content-Type\") String contentType, @Body RequestBody body)",
    "function_body": "{\n        return null;\n      }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 292,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": null,
    "function_name": "malformedContentTypeParameterThrows()",
    "function_body": "{\n    class Example {\n      @POST(\"/\") \n      Call<ResponseBody> method(@Header(\"Content-Type\") String contentType, @Body RequestBody body) {\n        return null;\n      }\n    }\n    RequestBody body = RequestBody.create(TEXT_PLAIN, \"hi\");\n    try {\n      buildRequest(Example.class, \"hello, world!\", body);\n      fail();\n    } catch (IllegalArgumentException e) {\n      assertThat(e).hasMessage(\"Malformed content type: hello, world!\");\n      assertThat(e.getCause()).isInstanceOf(IllegalArgumentException.class); \n    }\n  }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 293,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": "Example",
    "function_name": "method(@Header(\"Content-Type\") String contentType, @Body RequestBody body)",
    "function_body": "{\n        return null;\n      }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 294,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": null,
    "function_name": "malformedAnnotationRelativeUrlThrows()",
    "function_body": "{\n    class Example {\n      @GET(\"ftp://example.org\")\n      Call<ResponseBody> get() {\n        return null;\n      }\n    }\n    try {\n      buildRequest(Example.class);\n      fail();\n    } catch (IllegalArgumentException e) {\n      assertThat(e).hasMessage(\n          \"Malformed URL. Base: http://example.com/, Relative: ftp://example.org\");\n    }\n  }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 295,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": "Example",
    "function_name": "get()",
    "function_body": "{\n        return null;\n      }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 296,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": null,
    "function_name": "malformedParameterRelativeUrlThrows()",
    "function_body": "{\n    class Example {\n      @GET\n      Call<ResponseBody> get(@Url String relativeUrl) {\n        return null;\n      }\n    }\n    try {\n      buildRequest(Example.class, \"ftp://example.org\");\n      fail();\n    } catch (IllegalArgumentException e) {\n      assertThat(e).hasMessage(\n          \"Malformed URL. Base: http://example.com/, Relative: ftp://example.org\");\n    }\n  }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 297,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": "Example",
    "function_name": "get(@Url String relativeUrl)",
    "function_body": "{\n        return null;\n      }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 298,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": null,
    "function_name": "multipartPartsShouldBeInOrder() throws IOException",
    "function_body": "{\n    class Example {\n      @Multipart\n      @POST(\"/foo\")\n      Call<ResponseBody> get(@Part(\"first\") String data, @Part(\"second\") String dataTwo, @Part(\"third\") String dataThree) {\n        return null;\n      }\n    }\n    Request request = buildRequest(Example.class, \"firstParam\", \"secondParam\", \"thirdParam\");\n    MultipartBody body = (MultipartBody) request.body();\n\n    Buffer buffer = new Buffer();\n    body.writeTo(buffer);\n    String readBody = buffer.readUtf8();\n\n    assertThat(readBody.indexOf(\"firstParam\")).isLessThan(readBody.indexOf(\"secondParam\"));\n    assertThat(readBody.indexOf(\"secondParam\")).isLessThan(readBody.indexOf(\"thirdParam\"));\n  }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 299,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": "Example",
    "function_name": "get(@Part(\"first\") String data, @Part(\"second\") String dataTwo, @Part(\"third\") String dataThree)",
    "function_body": "{\n        return null;\n      }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 300,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": null,
    "function_name": "queryParamsSkippedIfConvertedToNull() throws Exception",
    "function_body": "{\n    class Example {\n      @GET(\"/query\") Call<ResponseBody> queryPath(@Query(\"a\") Object a) {\n        return null;\n      }\n    }\n\n    Retrofit.Builder retrofitBuilder = new Retrofit.Builder()\n        .baseUrl(\"http://example.com\")\n        .addConverterFactory(new NullObjectConverterFactory());\n\n    Request request = buildRequest(Example.class, retrofitBuilder, \"Ignored\");\n\n    assertThat(request.url().toString()).doesNotContain(\"Ignored\");\n  }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 301,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": "Example",
    "function_name": "queryPath(@Query(\"a\") Object a)",
    "function_body": "{\n        return null;\n      }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 302,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": null,
    "function_name": "queryParamMapsConvertedToNullShouldError() throws Exception",
    "function_body": "{\n    class Example {\n      @GET(\"/query\") Call<ResponseBody> queryPath(@QueryMap Map<String, String> a) {\n        return null;\n      }\n    }\n\n    Retrofit.Builder retrofitBuilder = new Retrofit.Builder()\n        .baseUrl(\"http://example.com\")\n        .addConverterFactory(new NullObjectConverterFactory());\n\n    Map<String, String> queryMap = Collections.singletonMap(\"kit\", \"kat\");\n\n    try {\n      buildRequest(Example.class, retrofitBuilder, queryMap);\n      fail();\n    } catch (IllegalArgumentException e) {\n      assertThat(e).hasMessageContaining(\n          \"Query map value 'kat' converted to null by retrofit2.helpers.NullObjectConverterFactory$1 for key 'kit'.\");\n    }\n  }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 303,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": "Example",
    "function_name": "queryPath(@QueryMap Map<String, String> a)",
    "function_body": "{\n        return null;\n      }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 304,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": null,
    "function_name": "fieldParamsSkippedIfConvertedToNull() throws Exception",
    "function_body": "{\n    class Example {\n      @FormUrlEncoded\n      @POST(\"/query\") Call<ResponseBody> queryPath(@Field(\"a\") Object a) {\n        return null;\n      }\n    }\n\n    Retrofit.Builder retrofitBuilder = new Retrofit.Builder()\n        .baseUrl(\"http://example.com\")\n        .addConverterFactory(new NullObjectConverterFactory());\n\n    Request request = buildRequest(Example.class, retrofitBuilder, \"Ignored\");\n\n    assertThat(request.url().toString()).doesNotContain(\"Ignored\");\n  }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 305,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": "Example",
    "function_name": "queryPath(@Field(\"a\") Object a)",
    "function_body": "{\n        return null;\n      }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 306,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": null,
    "function_name": "fieldParamMapsConvertedToNullShouldError() throws Exception",
    "function_body": "{\n    class Example {\n      @FormUrlEncoded\n      @POST(\"/query\") Call<ResponseBody> queryPath(@FieldMap Map<String, String> a) {\n        return null;\n      }\n    }\n\n    Retrofit.Builder retrofitBuilder = new Retrofit.Builder()\n        .baseUrl(\"http://example.com\")\n        .addConverterFactory(new NullObjectConverterFactory());\n\n    Map<String, String> queryMap = Collections.singletonMap(\"kit\", \"kat\");\n\n    try {\n      buildRequest(Example.class, retrofitBuilder, queryMap);\n      fail();\n    } catch (IllegalArgumentException e) {\n      assertThat(e).hasMessageContaining(\n          \"Field map value 'kat' converted to null by retrofit2.helpers.NullObjectConverterFactory$1 for key 'kit'.\");\n    }\n  }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 307,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": "Example",
    "function_name": "queryPath(@FieldMap Map<String, String> a)",
    "function_body": "{\n        return null;\n      }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 308,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": null,
    "function_name": "assertBody(RequestBody body, String expected)",
    "function_body": "{\n    assertThat(body).isNotNull();\n    Buffer buffer = new Buffer();\n    try {\n      body.writeTo(buffer);\n      assertThat(buffer.readUtf8()).isEqualTo(expected);\n    } catch (IOException e) {\n      throw new RuntimeException(e);\n    }\n  }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 309,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": null,
    "function_name": "buildRequest(Class<T> cls, Retrofit.Builder builder, Object... args)",
    "function_body": "{\n    okhttp3.Call.Factory callFactory = new okhttp3.Call.Factory() {\n      @Override public okhttp3.Call newCall(Request request) {\n        throw new UnsupportedOperationException(\"Not implemented\");\n      }\n    };\n\n    Retrofit retrofit = builder.callFactory(callFactory).build();\n\n    Method method = TestingUtils.onlyMethod(cls);\n    try {\n      return RequestFactory.parseAnnotations(retrofit, method).create(args);\n    } catch (RuntimeException e) {\n      throw e;\n    } catch (Exception e) {\n      throw new AssertionError(e);\n    }\n  }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 310,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": null,
    "function_name": "newCall(Request request)",
    "function_body": "{\n        throw new UnsupportedOperationException(\"Not implemented\");\n      }"
  },
  {
    "id": 73,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 311,
    "human_patch": "https://github.com/square/retrofit/commit/b9a7f6ad72073ddd40254c0058710e87a073047d",
    "cve_id": "CVE-2018-1000850",
    "cwe_id": "CWE-22",
    "filename": "retrofit/src/test/java/retrofit2/RequestFactoryTest.java",
    "is_vulnerable": 0,
    "class_name": "RequestFactoryTest",
    "subclass_name": null,
    "function_name": "buildRequest(Class<T> cls, Object... args)",
    "function_body": "{\n    Retrofit.Builder retrofitBuilder = new Retrofit.Builder()\n        .baseUrl(\"http://example.com/\")\n        .addConverterFactory(new ToStringConverterFactory());\n\n    return buildRequest(cls, retrofitBuilder, args);\n  }"
  },
  {
    "id": 74,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 0,
    "human_patch": "https://github.com/swagger-api/swagger-parser/commit/4c6584306b40de9b2dfa9065c3a438cd918534af",
    "cve_id": "CVE-2017-1000207",
    "cwe_id": "CWE-502",
    "filename": "modules/swagger-parser/src/main/java/io/swagger/parser/util/DeserializationUtils.java",
    "is_vulnerable": 0,
    "class_name": "DeserializationUtils",
    "subclass_name": null,
    "function_name": "deserializeIntoTree(String contents, String fileOrHost)",
    "function_body": "{\n        JsonNode result;\n\n        try {\n            if (isJson(contents)) {\n                result = Json.mapper().readTree(contents);\n            } else {\n                result = readYamlTree(contents);\n            }\n        } catch (IOException e) {\n            throw new RuntimeException(\"An exception was thrown while trying to deserialize the contents of \" + fileOrHost + \" into a JsonNode tree\", e);\n        }\n\n        return result;\n    }"
  },
  {
    "id": 74,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 1,
    "human_patch": "https://github.com/swagger-api/swagger-parser/commit/4c6584306b40de9b2dfa9065c3a438cd918534af",
    "cve_id": "CVE-2017-1000207",
    "cwe_id": "CWE-502",
    "filename": "modules/swagger-parser/src/main/java/io/swagger/parser/util/DeserializationUtils.java",
    "is_vulnerable": 0,
    "class_name": "DeserializationUtils",
    "subclass_name": null,
    "function_name": "deserialize(Object contents, String fileOrHost, Class<T> expectedType)",
    "function_body": "{\n        T result;\n\n        boolean isJson = false;\n\n        if(contents instanceof String && isJson((String)contents)) {\n            isJson = true;\n        }\n\n        try {\n            if (contents instanceof String) {\n                if (isJson) {\n                    result = Json.mapper().readValue((String) contents, expectedType);\n                } else {\n                    result = Yaml.mapper().readValue((String) contents, expectedType);\n                }\n            } else {\n                result = Json.mapper().convertValue(contents, expectedType);\n            }\n        } catch (Exception e) {\n            throw new RuntimeException(\"An exception was thrown while trying to deserialize the contents of \" + fileOrHost + \" into type \" + expectedType, e);\n        }\n\n        return result;\n    }"
  },
  {
    "id": 74,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 2,
    "human_patch": "https://github.com/swagger-api/swagger-parser/commit/4c6584306b40de9b2dfa9065c3a438cd918534af",
    "cve_id": "CVE-2017-1000207",
    "cwe_id": "CWE-502",
    "filename": "modules/swagger-parser/src/main/java/io/swagger/parser/util/DeserializationUtils.java",
    "is_vulnerable": 0,
    "class_name": "DeserializationUtils",
    "subclass_name": null,
    "function_name": "isJson(String contents)",
    "function_body": "{\n        return contents.toString().trim().startsWith(\"{\");\n    }"
  },
  {
    "id": 74,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 3,
    "human_patch": "https://github.com/swagger-api/swagger-parser/commit/4c6584306b40de9b2dfa9065c3a438cd918534af",
    "cve_id": "CVE-2017-1000207",
    "cwe_id": "CWE-502",
    "filename": "modules/swagger-parser/src/main/java/io/swagger/parser/util/DeserializationUtils.java",
    "is_vulnerable": 1,
    "class_name": "DeserializationUtils",
    "subclass_name": null,
    "function_name": "readYamlTree(String contents)",
    "function_body": "{\n        org.yaml.snakeyaml.Yaml yaml = new org.yaml.snakeyaml.Yaml();\n        return Json.mapper().convertValue(yaml.load(contents), JsonNode.class);\n    }"
  },
  {
    "id": 74,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 4,
    "human_patch": "https://github.com/swagger-api/swagger-parser/commit/4c6584306b40de9b2dfa9065c3a438cd918534af",
    "cve_id": "CVE-2017-1000207",
    "cwe_id": "CWE-502",
    "filename": "modules/swagger-parser/src/main/java/io/swagger/parser/util/DeserializationUtils.java",
    "is_vulnerable": 1,
    "class_name": "DeserializationUtils",
    "subclass_name": null,
    "function_name": "readYamlValue(String contents, Class<T> expectedType)",
    "function_body": "{\n        org.yaml.snakeyaml.Yaml yaml = new org.yaml.snakeyaml.Yaml();\n        return Json.mapper().convertValue(yaml.load(contents), expectedType);\n    }"
  },
  {
    "id": 75,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 0,
    "human_patch": "https://github.com/x-stream/xstream/commit/f38a1da3ae9491930c2067c12cd2506738b21dab",
    "cve_id": "CVE-2019-10173",
    "cwe_id": "CWE-502",
    "filename": "xstream/src/java/com/thoughtworks/xstream/XStream.java",
    "is_vulnerable": 0,
    "class_name": "XStream",
    "subclass_name": null,
    "function_name": "lookupConverterForType(Class type)",
    "function_body": "{\n                return defaultConverterLookup.lookupConverterForType(type);\n            }"
  },
  {
    "id": 75,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 1,
    "human_patch": "https://github.com/x-stream/xstream/commit/f38a1da3ae9491930c2067c12cd2506738b21dab",
    "cve_id": "CVE-2019-10173",
    "cwe_id": "CWE-502",
    "filename": "xstream/src/java/com/thoughtworks/xstream/XStream.java",
    "is_vulnerable": 0,
    "class_name": "XStream",
    "subclass_name": null,
    "function_name": "registerConverter(Converter converter, int priority)",
    "function_body": "{\n                defaultConverterLookup.registerConverter(converter, priority);\n            }"
  },
  {
    "id": 75,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 2,
    "human_patch": "https://github.com/x-stream/xstream/commit/f38a1da3ae9491930c2067c12cd2506738b21dab",
    "cve_id": "CVE-2019-10173",
    "cwe_id": "CWE-502",
    "filename": "xstream/src/java/com/thoughtworks/xstream/XStream.java",
    "is_vulnerable": 0,
    "class_name": "XStream",
    "subclass_name": null,
    "function_name": "buildMapper()",
    "function_body": "{\n        Mapper mapper = new DefaultMapper(classLoaderReference);\n        if (useXStream11XmlFriendlyMapper()) {\n            mapper = new XStream11XmlFriendlyMapper(mapper);\n        }\n        mapper = new DynamicProxyMapper(mapper);\n        mapper = new PackageAliasingMapper(mapper);\n        mapper = new ClassAliasingMapper(mapper);\n        mapper = new ElementIgnoringMapper(mapper);\n        mapper = new FieldAliasingMapper(mapper);\n        mapper = new AttributeAliasingMapper(mapper);\n        mapper = new SystemAttributeAliasingMapper(mapper);\n        mapper = new ImplicitCollectionMapper(mapper, reflectionProvider);\n        mapper = new OuterClassMapper(mapper);\n        mapper = new ArrayMapper(mapper);\n        mapper = new DefaultImplementationsMapper(mapper);\n        mapper = new AttributeMapper(mapper, converterLookup, reflectionProvider);\n        if (JVM.isVersion(5)) {\n            mapper = buildMapperDynamically(\n                \"com.thoughtworks.xstream.mapper.EnumMapper\", new Class[]{Mapper.class},\n                new Object[]{mapper});\n        }\n        mapper = new LocalConversionMapper(mapper);\n        mapper = new ImmutableTypesMapper(mapper);\n        if (JVM.isVersion(8)) {\n            mapper = buildMapperDynamically(\"com.thoughtworks.xstream.mapper.LambdaMapper\", new Class[]{Mapper.class},\n                new Object[]{mapper});\n        }\n        mapper = new SecurityMapper(mapper);\n        if (JVM.isVersion(5)) {\n            mapper = buildMapperDynamically(ANNOTATION_MAPPER_TYPE, new Class[]{\n                Mapper.class, ConverterRegistry.class, ConverterLookup.class,\n                ClassLoaderReference.class, ReflectionProvider.class}, new Object[]{\n                mapper, converterRegistry, converterLookup, classLoaderReference,\n                reflectionProvider});\n        }\n        mapper = wrapMapper((MapperWrapper)mapper);\n        mapper = new CachingMapper(mapper);\n        return mapper;\n    }"
  },
  {
    "id": 75,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 3,
    "human_patch": "https://github.com/x-stream/xstream/commit/f38a1da3ae9491930c2067c12cd2506738b21dab",
    "cve_id": "CVE-2019-10173",
    "cwe_id": "CWE-502",
    "filename": "xstream/src/java/com/thoughtworks/xstream/XStream.java",
    "is_vulnerable": 0,
    "class_name": "XStream",
    "subclass_name": null,
    "function_name": "buildMapperDynamically(String className, Class[] constructorParamTypes,\n        Object[] constructorParamValues)",
    "function_body": "{\n        try {\n            Class type = Class.forName(className, false, classLoaderReference.getReference());\n            Constructor constructor = type.getConstructor(constructorParamTypes);\n            return (Mapper)constructor.newInstance(constructorParamValues);\n        } catch (Exception e) {\n            throw new com.thoughtworks.xstream.InitializationException(\n                \"Could not instantiate mapper : \" + className, e);\n        } catch (LinkageError e) {\n            throw new com.thoughtworks.xstream.InitializationException(\n                \"Could not instantiate mapper : \" + className, e);\n        }\n    }"
  },
  {
    "id": 75,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 4,
    "human_patch": "https://github.com/x-stream/xstream/commit/f38a1da3ae9491930c2067c12cd2506738b21dab",
    "cve_id": "CVE-2019-10173",
    "cwe_id": "CWE-502",
    "filename": "xstream/src/java/com/thoughtworks/xstream/XStream.java",
    "is_vulnerable": 0,
    "class_name": "XStream",
    "subclass_name": null,
    "function_name": "wrapMapper(MapperWrapper next)",
    "function_body": "{\n        return next;\n    }"
  },
  {
    "id": 75,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 5,
    "human_patch": "https://github.com/x-stream/xstream/commit/f38a1da3ae9491930c2067c12cd2506738b21dab",
    "cve_id": "CVE-2019-10173",
    "cwe_id": "CWE-502",
    "filename": "xstream/src/java/com/thoughtworks/xstream/XStream.java",
    "is_vulnerable": 0,
    "class_name": "XStream",
    "subclass_name": null,
    "function_name": "useXStream11XmlFriendlyMapper()",
    "function_body": "{\n        return false;\n    }"
  },
  {
    "id": 75,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 6,
    "human_patch": "https://github.com/x-stream/xstream/commit/f38a1da3ae9491930c2067c12cd2506738b21dab",
    "cve_id": "CVE-2019-10173",
    "cwe_id": "CWE-502",
    "filename": "xstream/src/java/com/thoughtworks/xstream/XStream.java",
    "is_vulnerable": 0,
    "class_name": "XStream",
    "subclass_name": null,
    "function_name": "setupMappers()",
    "function_body": "{\n        packageAliasingMapper = (PackageAliasingMapper)this.mapper\n            .lookupMapperOfType(PackageAliasingMapper.class);\n        classAliasingMapper = (ClassAliasingMapper)this.mapper\n            .lookupMapperOfType(ClassAliasingMapper.class);\n        elementIgnoringMapper = (ElementIgnoringMapper)this.mapper\n            .lookupMapperOfType(ElementIgnoringMapper.class);\n        fieldAliasingMapper = (FieldAliasingMapper)this.mapper\n            .lookupMapperOfType(FieldAliasingMapper.class);\n        attributeMapper = (AttributeMapper)this.mapper\n            .lookupMapperOfType(AttributeMapper.class);\n        attributeAliasingMapper = (AttributeAliasingMapper)this.mapper\n            .lookupMapperOfType(AttributeAliasingMapper.class);\n        systemAttributeAliasingMapper = (SystemAttributeAliasingMapper)this.mapper\n            .lookupMapperOfType(SystemAttributeAliasingMapper.class);\n        implicitCollectionMapper = (ImplicitCollectionMapper)this.mapper\n            .lookupMapperOfType(ImplicitCollectionMapper.class);\n        defaultImplementationsMapper = (DefaultImplementationsMapper)this.mapper\n            .lookupMapperOfType(DefaultImplementationsMapper.class);\n        immutableTypesMapper = (ImmutableTypesMapper)this.mapper\n            .lookupMapperOfType(ImmutableTypesMapper.class);\n        localConversionMapper = (LocalConversionMapper)this.mapper\n            .lookupMapperOfType(LocalConversionMapper.class);\n        securityMapper = (SecurityMapper)this.mapper\n            .lookupMapperOfType(SecurityMapper.class);\n        annotationConfiguration = (AnnotationConfiguration)this.mapper\n            .lookupMapperOfType(AnnotationConfiguration.class);\n    }"
  },
  {
    "id": 75,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 7,
    "human_patch": "https://github.com/x-stream/xstream/commit/f38a1da3ae9491930c2067c12cd2506738b21dab",
    "cve_id": "CVE-2019-10173",
    "cwe_id": "CWE-502",
    "filename": "xstream/src/java/com/thoughtworks/xstream/XStream.java",
    "is_vulnerable": 1,
    "class_name": "XStream",
    "subclass_name": null,
    "function_name": "setupSecurity()",
    "function_body": "{\n        if (securityMapper == null) {\n            return;\n        }\n        \n        addPermission(AnyTypePermission.ANY);\n        insecureWarning = true;\n    }"
  },
  {
    "id": 75,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 8,
    "human_patch": "https://github.com/x-stream/xstream/commit/f38a1da3ae9491930c2067c12cd2506738b21dab",
    "cve_id": "CVE-2019-10173",
    "cwe_id": "CWE-502",
    "filename": "xstream/src/java/com/thoughtworks/xstream/XStream.java",
    "is_vulnerable": 1,
    "class_name": "XStream",
    "subclass_name": null,
    "function_name": "setupDefaultSecurity(final XStream xstream)",
    "function_body": "{\n        if (xstream.insecureWarning) {\n            xstream.addPermission(NoTypePermission.NONE);\n            xstream.addPermission(NullPermission.NULL);\n            xstream.addPermission(PrimitiveTypePermission.PRIMITIVES);\n            xstream.addPermission(ArrayTypePermission.ARRAYS);\n            xstream.addPermission(InterfaceTypePermission.INTERFACES);\n            xstream.allowTypeHierarchy(Calendar.class);\n            xstream.allowTypeHierarchy(Collection.class);\n            xstream.allowTypeHierarchy(Map.class);\n            xstream.allowTypeHierarchy(Map.Entry.class);\n            xstream.allowTypeHierarchy(Member.class);\n            xstream.allowTypeHierarchy(Number.class);\n            xstream.allowTypeHierarchy(Throwable.class);\n            xstream.allowTypeHierarchy(TimeZone.class);\n\n            Class type = JVM.loadClassForName(\"java.lang.Enum\");\n            if (type != null) {\n                xstream.allowTypeHierarchy(type);\n            }\n            type = JVM.loadClassForName(\"java.nio.file.Path\");\n            if (type != null) {\n                xstream.allowTypeHierarchy(type);\n            }\n\n            final Set types = new HashSet();\n            types.add(BitSet.class);\n            types.add(Charset.class);\n            types.add(Class.class);\n            types.add(Currency.class);\n            types.add(Date.class);\n            types.add(DecimalFormatSymbols.class);\n            types.add(File.class);\n            types.add(Locale.class);\n            types.add(Object.class);\n            types.add(Pattern.class);\n            types.add(StackTraceElement.class);\n            types.add(String.class);\n            types.add(StringBuffer.class);\n            types.add(JVM.loadClassForName(\"java.lang.StringBuilder\"));\n            types.add(URL.class);\n            types.add(URI.class);\n            types.add(JVM.loadClassForName(\"java.util.UUID\"));\n            if (JVM.isSQLAvailable()) {\n                types.add(JVM.loadClassForName(\"java.sql.Timestamp\"));\n                types.add(JVM.loadClassForName(\"java.sql.Time\"));\n                types.add(JVM.loadClassForName(\"java.sql.Date\"));\n            }\n            if (JVM.isVersion(8)) {\n                xstream.allowTypeHierarchy(JVM.loadClassForName(\"java.time.Clock\"));\n                types.add(JVM.loadClassForName(\"java.time.Duration\"));\n                types.add(JVM.loadClassForName(\"java.time.Instant\"));\n                types.add(JVM.loadClassForName(\"java.time.LocalDate\"));\n                types.add(JVM.loadClassForName(\"java.time.LocalDateTime\"));\n                types.add(JVM.loadClassForName(\"java.time.LocalTime\"));\n                types.add(JVM.loadClassForName(\"java.time.MonthDay\"));\n                types.add(JVM.loadClassForName(\"java.time.OffsetDateTime\"));\n                types.add(JVM.loadClassForName(\"java.time.OffsetTime\"));\n                types.add(JVM.loadClassForName(\"java.time.Period\"));\n                types.add(JVM.loadClassForName(\"java.time.Ser\"));\n                types.add(JVM.loadClassForName(\"java.time.Year\"));\n                types.add(JVM.loadClassForName(\"java.time.YearMonth\"));\n                types.add(JVM.loadClassForName(\"java.time.ZonedDateTime\"));\n                xstream.allowTypeHierarchy(JVM.loadClassForName(\"java.time.ZoneId\"));\n                types.add(JVM.loadClassForName(\"java.time.chrono.HijrahDate\"));\n                types.add(JVM.loadClassForName(\"java.time.chrono.JapaneseDate\"));\n                types.add(JVM.loadClassForName(\"java.time.chrono.JapaneseEra\"));\n                types.add(JVM.loadClassForName(\"java.time.chrono.MinguoDate\"));\n                types.add(JVM.loadClassForName(\"java.time.chrono.ThaiBuddhistDate\"));\n                types.add(JVM.loadClassForName(\"java.time.chrono.Ser\"));\n                xstream.allowTypeHierarchy(JVM.loadClassForName(\"java.time.chrono.Chronology\"));\n                types.add(JVM.loadClassForName(\"java.time.temporal.ValueRange\"));\n                types.add(JVM.loadClassForName(\"java.time.temporal.WeekFields\"));\n            }\n            types.remove(null);\n\n            final Iterator iter = types.iterator();\n            final Class[] classes = new Class[types.size()];\n            for (int i = 0; i < classes.length; ++i) {\n                classes[i] = (Class)iter.next();\n            }\n            xstream.allowTypes(classes);\n        } else {\n            throw new IllegalArgumentException(\"Security framework of XStream instance already initialized\");\n        }\n    }"
  },
  {
    "id": 75,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 9,
    "human_patch": "https://github.com/x-stream/xstream/commit/f38a1da3ae9491930c2067c12cd2506738b21dab",
    "cve_id": "CVE-2019-10173",
    "cwe_id": "CWE-502",
    "filename": "xstream/src/java/com/thoughtworks/xstream/XStream.java",
    "is_vulnerable": 0,
    "class_name": "XStream",
    "subclass_name": null,
    "function_name": "setupAliases()",
    "function_body": "{\n        if (classAliasingMapper == null) {\n            return;\n        }\n\n        alias(\"null\", Mapper.Null.class);\n        alias(\"int\", Integer.class);\n        alias(\"float\", Float.class);\n        alias(\"double\", Double.class);\n        alias(\"long\", Long.class);\n        alias(\"short\", Short.class);\n        alias(\"char\", Character.class);\n        alias(\"byte\", Byte.class);\n        alias(\"boolean\", Boolean.class);\n        alias(\"number\", Number.class);\n        alias(\"object\", Object.class);\n        alias(\"big-int\", BigInteger.class);\n        alias(\"big-decimal\", BigDecimal.class);\n\n        alias(\"string-buffer\", StringBuffer.class);\n        alias(\"string\", String.class);\n        alias(\"java-class\", Class.class);\n        alias(\"method\", Method.class);\n        alias(\"constructor\", Constructor.class);\n        alias(\"field\", Field.class);\n        alias(\"date\", Date.class);\n        alias(\"uri\", URI.class);\n        alias(\"url\", URL.class);\n        alias(\"bit-set\", BitSet.class);\n\n        alias(\"map\", Map.class);\n        alias(\"entry\", Map.Entry.class);\n        alias(\"properties\", Properties.class);\n        alias(\"list\", List.class);\n        alias(\"set\", Set.class);\n        alias(\"sorted-set\", SortedSet.class);\n\n        alias(\"linked-list\", LinkedList.class);\n        alias(\"vector\", Vector.class);\n        alias(\"tree-map\", TreeMap.class);\n        alias(\"tree-set\", TreeSet.class);\n        alias(\"hashtable\", Hashtable.class);\n        \n        alias(\"empty-list\", Collections.EMPTY_LIST.getClass());\n        alias(\"empty-map\", Collections.EMPTY_MAP.getClass());\n        alias(\"empty-set\", Collections.EMPTY_SET.getClass());\n        alias(\"singleton-list\", Collections.singletonList(this).getClass());\n        alias(\"singleton-map\", Collections.singletonMap(this, null).getClass());\n        alias(\"singleton-set\", Collections.singleton(this).getClass());\n\n        if (JVM.isAWTAvailable()) {\n            \n            \n            \n            alias(\"awt-color\", JVM.loadClassForName(\"java.awt.Color\", false));\n            alias(\"awt-font\", JVM.loadClassForName(\"java.awt.Font\", false));\n            alias(\"awt-text-attribute\", JVM.loadClassForName(\"java.awt.font.TextAttribute\"));\n        }\n\n        Class type = JVM.loadClassForName(\"javax.activation.ActivationDataFlavor\");\n        if (type != null) {\n            alias(\"activation-data-flavor\", type);\n        }\n\n        if (JVM.isSQLAvailable()) {\n            alias(\"sql-timestamp\", JVM.loadClassForName(\"java.sql.Timestamp\"));\n            alias(\"sql-time\", JVM.loadClassForName(\"java.sql.Time\"));\n            alias(\"sql-date\", JVM.loadClassForName(\"java.sql.Date\"));\n        }\n\n        alias(\"file\", File.class);\n        alias(\"locale\", Locale.class);\n        alias(\"gregorian-calendar\", Calendar.class);\n\n        if (JVM.isVersion(4)) {\n            aliasDynamically(\"auth-subject\", \"javax.security.auth.Subject\");\n            alias(\"linked-hash-map\", JVM.loadClassForName(\"java.util.LinkedHashMap\"));\n            alias(\"linked-hash-set\", JVM.loadClassForName(\"java.util.LinkedHashSet\"));\n            alias(\"trace\", JVM.loadClassForName(\"java.lang.StackTraceElement\"));\n            alias(\"currency\", JVM.loadClassForName(\"java.util.Currency\"));\n            aliasType(\"charset\", JVM.loadClassForName(\"java.nio.charset.Charset\"));\n        }\n\n        if (JVM.isVersion(5)) {\n            aliasDynamically(\"xml-duration\", \"javax.xml.datatype.Duration\");\n            alias(\"concurrent-hash-map\", JVM.loadClassForName(\"java.util.concurrent.ConcurrentHashMap\"));\n            alias(\"enum-set\", JVM.loadClassForName(\"java.util.EnumSet\"));\n            alias(\"enum-map\", JVM.loadClassForName(\"java.util.EnumMap\"));\n            alias(\"string-builder\", JVM.loadClassForName(\"java.lang.StringBuilder\"));\n            alias(\"uuid\", JVM.loadClassForName(\"java.util.UUID\"));\n        }\n        \n        if (JVM.isVersion(7)) {\n            aliasType(\"path\", JVM.loadClassForName(\"java.nio.file.Path\"));\n        }\n\n        if (JVM.isVersion(8)) {\n            alias(\"fixed-clock\", JVM.loadClassForName(\"java.time.Clock$FixedClock\"));\n            alias(\"offset-clock\", JVM.loadClassForName(\"java.time.Clock$OffsetClock\"));\n            alias(\"system-clock\", JVM.loadClassForName(\"java.time.Clock$SystemClock\"));\n            alias(\"tick-clock\", JVM.loadClassForName(\"java.time.Clock$TickClock\"));\n            alias(\"day-of-week\", JVM.loadClassForName(\"java.time.DayOfWeek\"));\n            alias(\"duration\", JVM.loadClassForName(\"java.time.Duration\"));\n            alias(\"instant\", JVM.loadClassForName(\"java.time.Instant\"));\n            alias(\"local-date\", JVM.loadClassForName(\"java.time.LocalDate\"));\n            alias(\"local-date-time\", JVM.loadClassForName(\"java.time.LocalDateTime\"));\n            alias(\"local-time\", JVM.loadClassForName(\"java.time.LocalTime\"));\n            alias(\"month\", JVM.loadClassForName(\"java.time.Month\"));\n            alias(\"month-day\", JVM.loadClassForName(\"java.time.MonthDay\"));\n            alias(\"offset-date-time\", JVM.loadClassForName(\"java.time.OffsetDateTime\"));\n            alias(\"offset-time\", JVM.loadClassForName(\"java.time.OffsetTime\"));\n            alias(\"period\", JVM.loadClassForName(\"java.time.Period\"));\n            alias(\"year\", JVM.loadClassForName(\"java.time.Year\"));\n            alias(\"year-month\", JVM.loadClassForName(\"java.time.YearMonth\"));\n            alias(\"zoned-date-time\", JVM.loadClassForName(\"java.time.ZonedDateTime\"));\n            aliasType(\"zone-id\", JVM.loadClassForName(\"java.time.ZoneId\"));\n            aliasType(\"chronology\", JVM.loadClassForName(\"java.time.chrono.Chronology\"));\n            alias(\"hijrah-date\", JVM.loadClassForName(\"java.time.chrono.HijrahDate\"));\n            alias(\"hijrah-era\", JVM.loadClassForName(\"java.time.chrono.HijrahEra\"));\n            alias(\"japanese-date\", JVM.loadClassForName(\"java.time.chrono.JapaneseDate\"));\n            alias(\"japanese-era\", JVM.loadClassForName(\"java.time.chrono.JapaneseEra\"));\n            alias(\"minguo-date\", JVM.loadClassForName(\"java.time.chrono.MinguoDate\"));\n            alias(\"minguo-era\", JVM.loadClassForName(\"java.time.chrono.MinguoEra\"));\n            alias(\"thai-buddhist-date\", JVM.loadClassForName(\"java.time.chrono.ThaiBuddhistDate\"));\n            alias(\"thai-buddhist-era\", JVM.loadClassForName(\"java.time.chrono.ThaiBuddhistEra\"));\n            alias(\"chrono-field\", JVM.loadClassForName(\"java.time.temporal.ChronoField\"));\n            alias(\"chrono-unit\", JVM.loadClassForName(\"java.time.temporal.ChronoUnit\"));\n            alias(\"iso-field\", JVM.loadClassForName(\"java.time.temporal.IsoFields$Field\"));\n            alias(\"iso-unit\", JVM.loadClassForName(\"java.time.temporal.IsoFields$Unit\"));\n            alias(\"julian-field\", JVM.loadClassForName(\"java.time.temporal.JulianFields$Field\"));\n            alias(\"temporal-value-range\", JVM.loadClassForName(\"java.time.temporal.ValueRange\"));\n            alias(\"week-fields\", JVM.loadClassForName(\"java.time.temporal.WeekFields\"));\n        }\n\n        if (JVM.loadClassForName(\"java.lang.invoke.SerializedLambda\") != null) {\n            aliasDynamically(\"serialized-lambda\", \"java.lang.invoke.SerializedLambda\");\n        }\n    }"
  },
  {
    "id": 75,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 10,
    "human_patch": "https://github.com/x-stream/xstream/commit/f38a1da3ae9491930c2067c12cd2506738b21dab",
    "cve_id": "CVE-2019-10173",
    "cwe_id": "CWE-502",
    "filename": "xstream/src/java/com/thoughtworks/xstream/XStream.java",
    "is_vulnerable": 0,
    "class_name": "XStream",
    "subclass_name": null,
    "function_name": "aliasDynamically(String alias, String className)",
    "function_body": "{\n        Class type = JVM.loadClassForName(className);\n        if (type != null) {\n            alias(alias, type);\n        }\n    }"
  },
  {
    "id": 75,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 11,
    "human_patch": "https://github.com/x-stream/xstream/commit/f38a1da3ae9491930c2067c12cd2506738b21dab",
    "cve_id": "CVE-2019-10173",
    "cwe_id": "CWE-502",
    "filename": "xstream/src/java/com/thoughtworks/xstream/XStream.java",
    "is_vulnerable": 0,
    "class_name": "XStream",
    "subclass_name": null,
    "function_name": "setupDefaultImplementations()",
    "function_body": "{\n        if (defaultImplementationsMapper == null) {\n            return;\n        }\n        addDefaultImplementation(HashMap.class, Map.class);\n        addDefaultImplementation(ArrayList.class, List.class);\n        addDefaultImplementation(HashSet.class, Set.class);\n        addDefaultImplementation(TreeSet.class, SortedSet.class);\n        addDefaultImplementation(GregorianCalendar.class, Calendar.class);\n    }"
  },
  {
    "id": 75,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 12,
    "human_patch": "https://github.com/x-stream/xstream/commit/f38a1da3ae9491930c2067c12cd2506738b21dab",
    "cve_id": "CVE-2019-10173",
    "cwe_id": "CWE-502",
    "filename": "xstream/src/java/com/thoughtworks/xstream/XStream.java",
    "is_vulnerable": 0,
    "class_name": "XStream",
    "subclass_name": null,
    "function_name": "setupConverters()",
    "function_body": "{\n        registerConverter(\n            new ReflectionConverter(mapper, reflectionProvider), PRIORITY_VERY_LOW);\n\n        registerConverter(\n            new SerializableConverter(mapper, reflectionProvider, classLoaderReference), PRIORITY_LOW);\n        registerConverter(new ExternalizableConverter(mapper, classLoaderReference), PRIORITY_LOW);\n        registerConverter(new InternalBlackList(), PRIORITY_LOW);\n\n        registerConverter(new NullConverter(), PRIORITY_VERY_HIGH);\n        registerConverter(new IntConverter(), PRIORITY_NORMAL);\n        registerConverter(new FloatConverter(), PRIORITY_NORMAL);\n        registerConverter(new DoubleConverter(), PRIORITY_NORMAL);\n        registerConverter(new LongConverter(), PRIORITY_NORMAL);\n        registerConverter(new ShortConverter(), PRIORITY_NORMAL);\n        registerConverter((Converter)new CharConverter(), PRIORITY_NORMAL);\n        registerConverter(new BooleanConverter(), PRIORITY_NORMAL);\n        registerConverter(new ByteConverter(), PRIORITY_NORMAL);\n\n        registerConverter(new StringConverter(), PRIORITY_NORMAL);\n        registerConverter(new StringBufferConverter(), PRIORITY_NORMAL);\n        registerConverter(new DateConverter(), PRIORITY_NORMAL);\n        registerConverter(new BitSetConverter(), PRIORITY_NORMAL);\n        registerConverter(new URIConverter(), PRIORITY_NORMAL);\n        registerConverter(new URLConverter(), PRIORITY_NORMAL);\n        registerConverter(new BigIntegerConverter(), PRIORITY_NORMAL);\n        registerConverter(new BigDecimalConverter(), PRIORITY_NORMAL);\n\n        registerConverter(new ArrayConverter(mapper), PRIORITY_NORMAL);\n        registerConverter(new CharArrayConverter(), PRIORITY_NORMAL);\n        registerConverter(new CollectionConverter(mapper), PRIORITY_NORMAL);\n        registerConverter(new MapConverter(mapper), PRIORITY_NORMAL);\n        registerConverter(new TreeMapConverter(mapper), PRIORITY_NORMAL);\n        registerConverter(new TreeSetConverter(mapper), PRIORITY_NORMAL);\n        registerConverter(new SingletonCollectionConverter(mapper), PRIORITY_NORMAL);\n        registerConverter(new SingletonMapConverter(mapper), PRIORITY_NORMAL);\n        registerConverter(new PropertiesConverter(), PRIORITY_NORMAL);\n        registerConverter((Converter)new EncodedByteArrayConverter(), PRIORITY_NORMAL);\n\n        registerConverter(new FileConverter(), PRIORITY_NORMAL);\n        if (JVM.isSQLAvailable()) {\n            registerConverter(new SqlTimestampConverter(), PRIORITY_NORMAL);\n            registerConverter(new SqlTimeConverter(), PRIORITY_NORMAL);\n            registerConverter(new SqlDateConverter(), PRIORITY_NORMAL);\n        }\n        registerConverter(new DynamicProxyConverter(mapper, classLoaderReference), PRIORITY_NORMAL);\n        registerConverter(new JavaClassConverter(classLoaderReference), PRIORITY_NORMAL);\n        registerConverter(new JavaMethodConverter(classLoaderReference), PRIORITY_NORMAL);\n        registerConverter(new JavaFieldConverter(classLoaderReference), PRIORITY_NORMAL);\n\n        if (JVM.isAWTAvailable()) {\n            registerConverter(new FontConverter(mapper), PRIORITY_NORMAL);\n            registerConverter(new ColorConverter(), PRIORITY_NORMAL);\n            registerConverter(new TextAttributeConverter(), PRIORITY_NORMAL);\n        }\n        if (JVM.isSwingAvailable()) {\n            registerConverter(\n                new LookAndFeelConverter(mapper, reflectionProvider), PRIORITY_NORMAL);\n        }\n        registerConverter(new LocaleConverter(), PRIORITY_NORMAL);\n        registerConverter(new GregorianCalendarConverter(), PRIORITY_NORMAL);\n\n        if (JVM.isVersion(4)) {\n            \n            registerConverterDynamically(\n                \"com.thoughtworks.xstream.converters.extended.SubjectConverter\",\n                PRIORITY_NORMAL, new Class[]{Mapper.class}, new Object[]{mapper});\n            registerConverterDynamically(\n                \"com.thoughtworks.xstream.converters.extended.ThrowableConverter\",\n                PRIORITY_NORMAL, new Class[]{ConverterLookup.class},\n                new Object[]{converterLookup});\n            registerConverterDynamically(\n                \"com.thoughtworks.xstream.converters.extended.StackTraceElementConverter\",\n                PRIORITY_NORMAL, null, null);\n            registerConverterDynamically(\n                \"com.thoughtworks.xstream.converters.extended.CurrencyConverter\",\n                PRIORITY_NORMAL, null, null);\n            registerConverterDynamically(\n                \"com.thoughtworks.xstream.converters.extended.RegexPatternConverter\",\n                PRIORITY_NORMAL, null, null);\n            registerConverterDynamically(\n                \"com.thoughtworks.xstream.converters.extended.CharsetConverter\",\n                PRIORITY_NORMAL, null, null);\n        }\n\n        if (JVM.isVersion(5)) {\n            \n            if (JVM.loadClassForName(\"javax.xml.datatype.Duration\") != null) {\n                registerConverterDynamically(\n                    \"com.thoughtworks.xstream.converters.extended.DurationConverter\",\n                    PRIORITY_NORMAL, null, null);\n            }\n            registerConverterDynamically(\n                \"com.thoughtworks.xstream.converters.enums.EnumConverter\", PRIORITY_NORMAL,\n                null, null);\n            registerConverterDynamically(\n                \"com.thoughtworks.xstream.converters.enums.EnumSetConverter\", PRIORITY_NORMAL,\n                new Class[]{Mapper.class}, new Object[]{mapper});\n            registerConverterDynamically(\n                \"com.thoughtworks.xstream.converters.enums.EnumMapConverter\", PRIORITY_NORMAL,\n                new Class[]{Mapper.class}, new Object[]{mapper});\n            registerConverterDynamically(\n                \"com.thoughtworks.xstream.converters.basic.StringBuilderConverter\",\n                PRIORITY_NORMAL, null, null);\n            registerConverterDynamically(\n                \"com.thoughtworks.xstream.converters.basic.UUIDConverter\", PRIORITY_NORMAL,\n                null, null);\n        }\n        if (JVM.loadClassForName(\"javax.activation.ActivationDataFlavor\") != null) {\n            registerConverterDynamically(\"com.thoughtworks.xstream.converters.extended.ActivationDataFlavorConverter\",\n                PRIORITY_NORMAL, null, null);\n        }\n        if (JVM.isVersion(7)) {\n            registerConverterDynamically(\"com.thoughtworks.xstream.converters.extended.PathConverter\",\n                    PRIORITY_NORMAL, null, null);\n        }\n        if (JVM.isVersion(8)) {\n            registerConverterDynamically(\"com.thoughtworks.xstream.converters.time.ChronologyConverter\",\n                PRIORITY_NORMAL, null, null);\n            registerConverterDynamically(\"com.thoughtworks.xstream.converters.time.DurationConverter\", PRIORITY_NORMAL,\n                null, null);\n            registerConverterDynamically(\"com.thoughtworks.xstream.converters.time.HijrahDateConverter\",\n                PRIORITY_NORMAL, null, null);\n            registerConverterDynamically(\"com.thoughtworks.xstream.converters.time.JapaneseDateConverter\",\n                PRIORITY_NORMAL, null, null);\n            registerConverterDynamically(\"com.thoughtworks.xstream.converters.time.JapaneseEraConverter\",\n                PRIORITY_NORMAL, null, null);\n            registerConverterDynamically(\"com.thoughtworks.xstream.converters.time.InstantConverter\", PRIORITY_NORMAL,\n                null, null);\n            registerConverterDynamically(\"com.thoughtworks.xstream.converters.time.LocalDateConverter\", PRIORITY_NORMAL,\n                null, null);\n            registerConverterDynamically(\"com.thoughtworks.xstream.converters.time.LocalDateTimeConverter\",\n                PRIORITY_NORMAL, null, null);\n            registerConverterDynamically(\"com.thoughtworks.xstream.converters.time.LocalTimeConverter\", PRIORITY_NORMAL,\n                null, null);\n            registerConverterDynamically(\"com.thoughtworks.xstream.converters.time.MinguoDateConverter\",\n                PRIORITY_NORMAL, null, null);\n            registerConverterDynamically(\"com.thoughtworks.xstream.converters.time.MonthDayConverter\", PRIORITY_NORMAL,\n                null, null);\n            registerConverterDynamically(\"com.thoughtworks.xstream.converters.time.OffsetDateTimeConverter\",\n                PRIORITY_NORMAL, null, null);\n            registerConverterDynamically(\"com.thoughtworks.xstream.converters.time.OffsetTimeConverter\",\n                PRIORITY_NORMAL, null, null);\n            registerConverterDynamically(\"com.thoughtworks.xstream.converters.time.PeriodConverter\", PRIORITY_NORMAL,\n                null, null);\n            registerConverterDynamically(\"com.thoughtworks.xstream.converters.time.SystemClockConverter\",\n                PRIORITY_NORMAL, new Class[]{Mapper.class}, new Object[]{mapper});\n            registerConverterDynamically(\"com.thoughtworks.xstream.converters.time.ThaiBuddhistDateConverter\",\n                PRIORITY_NORMAL, null, null);\n            registerConverterDynamically(\"com.thoughtworks.xstream.converters.time.ValueRangeConverter\",\n                PRIORITY_NORMAL, new Class[]{Mapper.class}, new Object[]{mapper});\n            registerConverterDynamically(\"com.thoughtworks.xstream.converters.time.WeekFieldsConverter\",\n                PRIORITY_NORMAL, new Class[]{Mapper.class}, new Object[]{mapper});\n            registerConverterDynamically(\"com.thoughtworks.xstream.converters.time.YearConverter\", PRIORITY_NORMAL,\n                null, null);\n            registerConverterDynamically(\"com.thoughtworks.xstream.converters.time.YearMonthConverter\", PRIORITY_NORMAL,\n                null, null);\n            registerConverterDynamically(\"com.thoughtworks.xstream.converters.time.ZonedDateTimeConverter\",\n                PRIORITY_NORMAL, null, null);\n            registerConverterDynamically(\"com.thoughtworks.xstream.converters.time.ZoneIdConverter\", PRIORITY_NORMAL,\n                null, null);\n            registerConverterDynamically(\"com.thoughtworks.xstream.converters.reflection.LambdaConverter\",\n                PRIORITY_NORMAL, new Class[]{Mapper.class, ReflectionProvider.class, ClassLoaderReference.class},\n                new Object[]{mapper, reflectionProvider, classLoaderReference});\n        }\n\n        registerConverter(\n            new SelfStreamingInstanceChecker(converterLookup, this), PRIORITY_NORMAL);\n    }"
  },
  {
    "id": 75,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 13,
    "human_patch": "https://github.com/x-stream/xstream/commit/f38a1da3ae9491930c2067c12cd2506738b21dab",
    "cve_id": "CVE-2019-10173",
    "cwe_id": "CWE-502",
    "filename": "xstream/src/java/com/thoughtworks/xstream/XStream.java",
    "is_vulnerable": 0,
    "class_name": "XStream",
    "subclass_name": null,
    "function_name": "registerConverterDynamically(String className, int priority,\n        Class[] constructorParamTypes, Object[] constructorParamValues)",
    "function_body": "{\n        try {\n            Class type = Class.forName(className, false, classLoaderReference.getReference());\n            Constructor constructor = type.getConstructor(constructorParamTypes);\n            Object instance = constructor.newInstance(constructorParamValues);\n            if (instance instanceof Converter) {\n                registerConverter((Converter)instance, priority);\n            } else if (instance instanceof SingleValueConverter) {\n                registerConverter((SingleValueConverter)instance, priority);\n            }\n        } catch (Exception e) {\n            throw new com.thoughtworks.xstream.InitializationException(\n                \"Could not instantiate converter : \" + className, e);\n        } catch (LinkageError e) {\n            throw new com.thoughtworks.xstream.InitializationException(\n                \"Could not instantiate converter : \" + className, e);\n        }\n    }"
  },
  {
    "id": 75,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 14,
    "human_patch": "https://github.com/x-stream/xstream/commit/f38a1da3ae9491930c2067c12cd2506738b21dab",
    "cve_id": "CVE-2019-10173",
    "cwe_id": "CWE-502",
    "filename": "xstream/src/java/com/thoughtworks/xstream/XStream.java",
    "is_vulnerable": 0,
    "class_name": "XStream",
    "subclass_name": null,
    "function_name": "setupImmutableTypes()",
    "function_body": "{\n        if (immutableTypesMapper == null) {\n            return;\n        }\n\n        \n        addImmutableType(boolean.class, false);\n        addImmutableType(Boolean.class, false);\n        addImmutableType(byte.class, false);\n        addImmutableType(Byte.class, false);\n        addImmutableType(char.class, false);\n        addImmutableType(Character.class, false);\n        addImmutableType(double.class, false);\n        addImmutableType(Double.class, false);\n        addImmutableType(float.class, false);\n        addImmutableType(Float.class, false);\n        addImmutableType(int.class, false);\n        addImmutableType(Integer.class, false);\n        addImmutableType(long.class, false);\n        addImmutableType(Long.class, false);\n        addImmutableType(short.class, false);\n        addImmutableType(Short.class, false);\n\n        \n        addImmutableType(Mapper.Null.class, false);\n        addImmutableType(BigDecimal.class, false);\n        addImmutableType(BigInteger.class, false);\n        addImmutableType(String.class, false);\n        addImmutableType(URL.class, false);\n        addImmutableType(File.class, false);\n        addImmutableType(Class.class, false);\n\n        if (JVM.isVersion(7)) {\n            Class type = JVM.loadClassForName(\"java.nio.file.Paths\");\n            if (type != null) {\n                Method methodGet;\n                try {\n                    methodGet = type.getDeclaredMethod(\"get\", new Class[] {String.class, String[].class});\n                    if (methodGet != null) {\n                        Object path = methodGet.invoke(null, new Object[]{\".\", new String[0]});\n                        if (path != null) {\n                            addImmutableType(path.getClass(), false);\n                        }\n                    }\n                } catch (NoSuchMethodException e) {\n                } catch (SecurityException e) {\n                } catch (IllegalAccessException e) {\n                } catch (InvocationTargetException e) {\n                }\n            }\n        }\n\n        if (JVM.isAWTAvailable()) {\n            addImmutableTypeDynamically(\"java.awt.font.TextAttribute\", false);\n        }\n\n        if (JVM.isVersion(4)) {\n            \n            addImmutableTypeDynamically(\"java.nio.charset.Charset\", true);\n            addImmutableTypeDynamically(\"java.util.Currency\", true);\n        }\n        \n        if (JVM.isVersion(5)) {\n            addImmutableTypeDynamically(\"java.util.UUID\", true);\n        }\n\n        addImmutableType(URI.class, true);\n        addImmutableType(Collections.EMPTY_LIST.getClass(), true);\n        addImmutableType(Collections.EMPTY_SET.getClass(), true);\n        addImmutableType(Collections.EMPTY_MAP.getClass(), true);\n\n        if (JVM.isVersion(8)) {\n            addImmutableTypeDynamically(\"java.time.Duration\", false);\n            addImmutableTypeDynamically(\"java.time.Instant\", false);\n            addImmutableTypeDynamically(\"java.time.LocalDate\", false);\n            addImmutableTypeDynamically(\"java.time.LocalDateTime\", false);\n            addImmutableTypeDynamically(\"java.time.LocalTime\", false);\n            addImmutableTypeDynamically(\"java.time.MonthDay\", false);\n            addImmutableTypeDynamically(\"java.time.OffsetDateTime\", false);\n            addImmutableTypeDynamically(\"java.time.OffsetTime\", false);\n            addImmutableTypeDynamically(\"java.time.Period\", false);\n            addImmutableTypeDynamically(\"java.time.Year\", false);\n            addImmutableTypeDynamically(\"java.time.YearMonth\", false);\n            addImmutableTypeDynamically(\"java.time.ZonedDateTime\", false);\n            addImmutableTypeDynamically(\"java.time.ZoneId\", false);\n            addImmutableTypeDynamically(\"java.time.ZoneOffset\", false);\n            addImmutableTypeDynamically(\"java.time.ZoneRegion\", false);\n            addImmutableTypeDynamically(\"java.time.chrono.HijrahChronology\", false);\n            addImmutableTypeDynamically(\"java.time.chrono.HijrahDate\", false);\n            addImmutableTypeDynamically(\"java.time.chrono.IsoChronology\", false);\n            addImmutableTypeDynamically(\"java.time.chrono.JapaneseChronology\", false);\n            addImmutableTypeDynamically(\"java.time.chrono.JapaneseDate\", false);\n            addImmutableTypeDynamically(\"java.time.chrono.JapaneseEra\", false);\n            addImmutableTypeDynamically(\"java.time.chrono.MinguoChronology\", false);\n            addImmutableTypeDynamically(\"java.time.chrono.MinguoDate\", false);\n            addImmutableTypeDynamically(\"java.time.chrono.ThaiBuddhistChronology\", false);\n            addImmutableTypeDynamically(\"java.time.chrono.ThaiBuddhistDate\", false);\n            addImmutableTypeDynamically(\"java.time.temporal.IsoFields$Field\", false);\n            addImmutableTypeDynamically(\"java.time.temporal.IsoFields$Unit\", false);\n            addImmutableTypeDynamically(\"java.time.temporal.JulianFields$Field\", false);\n        }\n    }"
  },
  {
    "id": 75,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 15,
    "human_patch": "https://github.com/x-stream/xstream/commit/f38a1da3ae9491930c2067c12cd2506738b21dab",
    "cve_id": "CVE-2019-10173",
    "cwe_id": "CWE-502",
    "filename": "xstream/src/java/com/thoughtworks/xstream/XStream.java",
    "is_vulnerable": 0,
    "class_name": "XStream",
    "subclass_name": null,
    "function_name": "addImmutableTypeDynamically(String className, boolean isReferenceable)",
    "function_body": "{\n        Class type = JVM.loadClassForName(className);\n        if (type != null) {\n            addImmutableType(type, isReferenceable);\n        }\n    }"
  },
  {
    "id": 75,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 16,
    "human_patch": "https://github.com/x-stream/xstream/commit/f38a1da3ae9491930c2067c12cd2506738b21dab",
    "cve_id": "CVE-2019-10173",
    "cwe_id": "CWE-502",
    "filename": "xstream/src/java/com/thoughtworks/xstream/XStream.java",
    "is_vulnerable": 0,
    "class_name": "XStream",
    "subclass_name": null,
    "function_name": "setMarshallingStrategy(MarshallingStrategy marshallingStrategy)",
    "function_body": "{\n        this.marshallingStrategy = marshallingStrategy;\n    }"
  },
  {
    "id": 75,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 17,
    "human_patch": "https://github.com/x-stream/xstream/commit/f38a1da3ae9491930c2067c12cd2506738b21dab",
    "cve_id": "CVE-2019-10173",
    "cwe_id": "CWE-502",
    "filename": "xstream/src/java/com/thoughtworks/xstream/XStream.java",
    "is_vulnerable": 0,
    "class_name": "XStream",
    "subclass_name": null,
    "function_name": "toXML(Object obj)",
    "function_body": "{\n        Writer writer = new StringWriter();\n        toXML(obj, writer);\n        return writer.toString();\n    }"
  },
  {
    "id": 75,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 18,
    "human_patch": "https://github.com/x-stream/xstream/commit/f38a1da3ae9491930c2067c12cd2506738b21dab",
    "cve_id": "CVE-2019-10173",
    "cwe_id": "CWE-502",
    "filename": "xstream/src/java/com/thoughtworks/xstream/XStream.java",
    "is_vulnerable": 0,
    "class_name": "XStream",
    "subclass_name": null,
    "function_name": "toXML(Object obj, Writer out)",
    "function_body": "{\n        HierarchicalStreamWriter writer = hierarchicalStreamDriver.createWriter(out);\n        try {\n            marshal(obj, writer);\n        } finally {\n            writer.flush();\n        }\n    }"
  },
  {
    "id": 75,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 19,
    "human_patch": "https://github.com/x-stream/xstream/commit/f38a1da3ae9491930c2067c12cd2506738b21dab",
    "cve_id": "CVE-2019-10173",
    "cwe_id": "CWE-502",
    "filename": "xstream/src/java/com/thoughtworks/xstream/XStream.java",
    "is_vulnerable": 0,
    "class_name": "XStream",
    "subclass_name": null,
    "function_name": "toXML(Object obj, OutputStream out)",
    "function_body": "{\n        HierarchicalStreamWriter writer = hierarchicalStreamDriver.createWriter(out);\n        try {\n            marshal(obj, writer);\n        } finally {\n            writer.flush();\n        }\n    }"
  },
  {
    "id": 75,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 20,
    "human_patch": "https://github.com/x-stream/xstream/commit/f38a1da3ae9491930c2067c12cd2506738b21dab",
    "cve_id": "CVE-2019-10173",
    "cwe_id": "CWE-502",
    "filename": "xstream/src/java/com/thoughtworks/xstream/XStream.java",
    "is_vulnerable": 0,
    "class_name": "XStream",
    "subclass_name": null,
    "function_name": "marshal(Object obj, HierarchicalStreamWriter writer)",
    "function_body": "{\n        marshal(obj, writer, null);\n    }"
  },
  {
    "id": 75,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 21,
    "human_patch": "https://github.com/x-stream/xstream/commit/f38a1da3ae9491930c2067c12cd2506738b21dab",
    "cve_id": "CVE-2019-10173",
    "cwe_id": "CWE-502",
    "filename": "xstream/src/java/com/thoughtworks/xstream/XStream.java",
    "is_vulnerable": 0,
    "class_name": "XStream",
    "subclass_name": null,
    "function_name": "marshal(Object obj, HierarchicalStreamWriter writer, DataHolder dataHolder)",
    "function_body": "{\n        marshallingStrategy.marshal(writer, obj, converterLookup, mapper, dataHolder);\n    }"
  },
  {
    "id": 75,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 22,
    "human_patch": "https://github.com/x-stream/xstream/commit/f38a1da3ae9491930c2067c12cd2506738b21dab",
    "cve_id": "CVE-2019-10173",
    "cwe_id": "CWE-502",
    "filename": "xstream/src/java/com/thoughtworks/xstream/XStream.java",
    "is_vulnerable": 0,
    "class_name": "XStream",
    "subclass_name": null,
    "function_name": "fromXML(String xml)",
    "function_body": "{\n        return fromXML(new StringReader(xml));\n    }"
  },
  {
    "id": 75,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 23,
    "human_patch": "https://github.com/x-stream/xstream/commit/f38a1da3ae9491930c2067c12cd2506738b21dab",
    "cve_id": "CVE-2019-10173",
    "cwe_id": "CWE-502",
    "filename": "xstream/src/java/com/thoughtworks/xstream/XStream.java",
    "is_vulnerable": 0,
    "class_name": "XStream",
    "subclass_name": null,
    "function_name": "fromXML(Reader reader)",
    "function_body": "{\n        return unmarshal(hierarchicalStreamDriver.createReader(reader), null);\n    }"
  },
  {
    "id": 75,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 24,
    "human_patch": "https://github.com/x-stream/xstream/commit/f38a1da3ae9491930c2067c12cd2506738b21dab",
    "cve_id": "CVE-2019-10173",
    "cwe_id": "CWE-502",
    "filename": "xstream/src/java/com/thoughtworks/xstream/XStream.java",
    "is_vulnerable": 0,
    "class_name": "XStream",
    "subclass_name": null,
    "function_name": "fromXML(InputStream input)",
    "function_body": "{\n        return unmarshal(hierarchicalStreamDriver.createReader(input), null);\n    }"
  },
  {
    "id": 75,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 25,
    "human_patch": "https://github.com/x-stream/xstream/commit/f38a1da3ae9491930c2067c12cd2506738b21dab",
    "cve_id": "CVE-2019-10173",
    "cwe_id": "CWE-502",
    "filename": "xstream/src/java/com/thoughtworks/xstream/XStream.java",
    "is_vulnerable": 0,
    "class_name": "XStream",
    "subclass_name": null,
    "function_name": "fromXML(URL url)",
    "function_body": "{\n        return fromXML(url, null);\n    }"
  },
  {
    "id": 75,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 26,
    "human_patch": "https://github.com/x-stream/xstream/commit/f38a1da3ae9491930c2067c12cd2506738b21dab",
    "cve_id": "CVE-2019-10173",
    "cwe_id": "CWE-502",
    "filename": "xstream/src/java/com/thoughtworks/xstream/XStream.java",
    "is_vulnerable": 0,
    "class_name": "XStream",
    "subclass_name": null,
    "function_name": "fromXML(File file)",
    "function_body": "{\n        return fromXML(file, null);\n    }"
  },
  {
    "id": 75,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 27,
    "human_patch": "https://github.com/x-stream/xstream/commit/f38a1da3ae9491930c2067c12cd2506738b21dab",
    "cve_id": "CVE-2019-10173",
    "cwe_id": "CWE-502",
    "filename": "xstream/src/java/com/thoughtworks/xstream/XStream.java",
    "is_vulnerable": 0,
    "class_name": "XStream",
    "subclass_name": null,
    "function_name": "fromXML(String xml, Object root)",
    "function_body": "{\n        return fromXML(new StringReader(xml), root);\n    }"
  },
  {
    "id": 75,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 28,
    "human_patch": "https://github.com/x-stream/xstream/commit/f38a1da3ae9491930c2067c12cd2506738b21dab",
    "cve_id": "CVE-2019-10173",
    "cwe_id": "CWE-502",
    "filename": "xstream/src/java/com/thoughtworks/xstream/XStream.java",
    "is_vulnerable": 0,
    "class_name": "XStream",
    "subclass_name": null,
    "function_name": "fromXML(Reader xml, Object root)",
    "function_body": "{\n        return unmarshal(hierarchicalStreamDriver.createReader(xml), root);\n    }"
  },
  {
    "id": 75,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 29,
    "human_patch": "https://github.com/x-stream/xstream/commit/f38a1da3ae9491930c2067c12cd2506738b21dab",
    "cve_id": "CVE-2019-10173",
    "cwe_id": "CWE-502",
    "filename": "xstream/src/java/com/thoughtworks/xstream/XStream.java",
    "is_vulnerable": 0,
    "class_name": "XStream",
    "subclass_name": null,
    "function_name": "fromXML(URL url, Object root)",
    "function_body": "{\n        return unmarshal(hierarchicalStreamDriver.createReader(url), root);\n    }"
  },
  {
    "id": 75,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 30,
    "human_patch": "https://github.com/x-stream/xstream/commit/f38a1da3ae9491930c2067c12cd2506738b21dab",
    "cve_id": "CVE-2019-10173",
    "cwe_id": "CWE-502",
    "filename": "xstream/src/java/com/thoughtworks/xstream/XStream.java",
    "is_vulnerable": 0,
    "class_name": "XStream",
    "subclass_name": null,
    "function_name": "fromXML(File file, Object root)",
    "function_body": "{\n        HierarchicalStreamReader reader = hierarchicalStreamDriver.createReader(file);\n        try {\n            return unmarshal(reader, root);\n        } finally {\n            reader.close();\n        }\n    }"
  },
  {
    "id": 75,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 31,
    "human_patch": "https://github.com/x-stream/xstream/commit/f38a1da3ae9491930c2067c12cd2506738b21dab",
    "cve_id": "CVE-2019-10173",
    "cwe_id": "CWE-502",
    "filename": "xstream/src/java/com/thoughtworks/xstream/XStream.java",
    "is_vulnerable": 0,
    "class_name": "XStream",
    "subclass_name": null,
    "function_name": "fromXML(InputStream input, Object root)",
    "function_body": "{\n        return unmarshal(hierarchicalStreamDriver.createReader(input), root);\n    }"
  },
  {
    "id": 75,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 32,
    "human_patch": "https://github.com/x-stream/xstream/commit/f38a1da3ae9491930c2067c12cd2506738b21dab",
    "cve_id": "CVE-2019-10173",
    "cwe_id": "CWE-502",
    "filename": "xstream/src/java/com/thoughtworks/xstream/XStream.java",
    "is_vulnerable": 0,
    "class_name": "XStream",
    "subclass_name": null,
    "function_name": "unmarshal(HierarchicalStreamReader reader)",
    "function_body": "{\n        return unmarshal(reader, null, null);\n    }"
  },
  {
    "id": 75,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 33,
    "human_patch": "https://github.com/x-stream/xstream/commit/f38a1da3ae9491930c2067c12cd2506738b21dab",
    "cve_id": "CVE-2019-10173",
    "cwe_id": "CWE-502",
    "filename": "xstream/src/java/com/thoughtworks/xstream/XStream.java",
    "is_vulnerable": 0,
    "class_name": "XStream",
    "subclass_name": null,
    "function_name": "unmarshal(HierarchicalStreamReader reader, Object root)",
    "function_body": "{\n        return unmarshal(reader, root, null);\n    }"
  },
  {
    "id": 75,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 34,
    "human_patch": "https://github.com/x-stream/xstream/commit/f38a1da3ae9491930c2067c12cd2506738b21dab",
    "cve_id": "CVE-2019-10173",
    "cwe_id": "CWE-502",
    "filename": "xstream/src/java/com/thoughtworks/xstream/XStream.java",
    "is_vulnerable": 1,
    "class_name": "XStream",
    "subclass_name": null,
    "function_name": "unmarshal(HierarchicalStreamReader reader, Object root, DataHolder dataHolder)",
    "function_body": "{\n        try {\n            if (insecureWarning) {\n                insecureWarning = false;\n                System.err.println(\"Security framework of XStream not initialized, XStream is probably vulnerable.\");\n            }\n            return marshallingStrategy.unmarshal(\n                root, reader, dataHolder, converterLookup, mapper);\n\n        } catch (ConversionException e) {\n            Package pkg = getClass().getPackage();\n            String version = pkg != null ? pkg.getImplementationVersion() : null;\n            e.add(\"version\", version != null ? version : \"not available\");\n            throw e;\n        }\n    }"
  },
  {
    "id": 75,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 35,
    "human_patch": "https://github.com/x-stream/xstream/commit/f38a1da3ae9491930c2067c12cd2506738b21dab",
    "cve_id": "CVE-2019-10173",
    "cwe_id": "CWE-502",
    "filename": "xstream/src/java/com/thoughtworks/xstream/XStream.java",
    "is_vulnerable": 0,
    "class_name": "XStream",
    "subclass_name": null,
    "function_name": "alias(String name, Class type)",
    "function_body": "{\n        if (classAliasingMapper == null) {\n            throw new com.thoughtworks.xstream.InitializationException(\"No \"\n                + ClassAliasingMapper.class.getName()\n                + \" available\");\n        }\n        classAliasingMapper.addClassAlias(name, type);\n    }"
  },
  {
    "id": 75,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 36,
    "human_patch": "https://github.com/x-stream/xstream/commit/f38a1da3ae9491930c2067c12cd2506738b21dab",
    "cve_id": "CVE-2019-10173",
    "cwe_id": "CWE-502",
    "filename": "xstream/src/java/com/thoughtworks/xstream/XStream.java",
    "is_vulnerable": 0,
    "class_name": "XStream",
    "subclass_name": null,
    "function_name": "aliasType(String name, Class type)",
    "function_body": "{\n        if (classAliasingMapper == null) {\n            throw new com.thoughtworks.xstream.InitializationException(\"No \"\n                + ClassAliasingMapper.class.getName()\n                + \" available\");\n        }\n        classAliasingMapper.addTypeAlias(name, type);\n    }"
  },
  {
    "id": 75,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 37,
    "human_patch": "https://github.com/x-stream/xstream/commit/f38a1da3ae9491930c2067c12cd2506738b21dab",
    "cve_id": "CVE-2019-10173",
    "cwe_id": "CWE-502",
    "filename": "xstream/src/java/com/thoughtworks/xstream/XStream.java",
    "is_vulnerable": 0,
    "class_name": "XStream",
    "subclass_name": null,
    "function_name": "alias(String name, Class type, Class defaultImplementation)",
    "function_body": "{\n        alias(name, type);\n        addDefaultImplementation(defaultImplementation, type);\n    }"
  },
  {
    "id": 75,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 38,
    "human_patch": "https://github.com/x-stream/xstream/commit/f38a1da3ae9491930c2067c12cd2506738b21dab",
    "cve_id": "CVE-2019-10173",
    "cwe_id": "CWE-502",
    "filename": "xstream/src/java/com/thoughtworks/xstream/XStream.java",
    "is_vulnerable": 0,
    "class_name": "XStream",
    "subclass_name": null,
    "function_name": "aliasPackage(String name, String pkgName)",
    "function_body": "{\n        if (packageAliasingMapper == null) {\n            throw new com.thoughtworks.xstream.InitializationException(\"No \"\n                + PackageAliasingMapper.class.getName()\n                + \" available\");\n        }\n        packageAliasingMapper.addPackageAlias(name, pkgName);\n    }"
  },
  {
    "id": 75,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 39,
    "human_patch": "https://github.com/x-stream/xstream/commit/f38a1da3ae9491930c2067c12cd2506738b21dab",
    "cve_id": "CVE-2019-10173",
    "cwe_id": "CWE-502",
    "filename": "xstream/src/java/com/thoughtworks/xstream/XStream.java",
    "is_vulnerable": 0,
    "class_name": "XStream",
    "subclass_name": null,
    "function_name": "aliasField(String alias, Class definedIn, String fieldName)",
    "function_body": "{\n        if (fieldAliasingMapper == null) {\n            throw new com.thoughtworks.xstream.InitializationException(\"No \"\n                + FieldAliasingMapper.class.getName()\n                + \" available\");\n        }\n        fieldAliasingMapper.addFieldAlias(alias, definedIn, fieldName);\n    }"
  },
  {
    "id": 75,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 40,
    "human_patch": "https://github.com/x-stream/xstream/commit/f38a1da3ae9491930c2067c12cd2506738b21dab",
    "cve_id": "CVE-2019-10173",
    "cwe_id": "CWE-502",
    "filename": "xstream/src/java/com/thoughtworks/xstream/XStream.java",
    "is_vulnerable": 0,
    "class_name": "XStream",
    "subclass_name": null,
    "function_name": "aliasAttribute(String alias, String attributeName)",
    "function_body": "{\n        if (attributeAliasingMapper == null) {\n            throw new com.thoughtworks.xstream.InitializationException(\"No \"\n                + AttributeAliasingMapper.class.getName()\n                + \" available\");\n        }\n        attributeAliasingMapper.addAliasFor(attributeName, alias);\n    }"
  },
  {
    "id": 75,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 41,
    "human_patch": "https://github.com/x-stream/xstream/commit/f38a1da3ae9491930c2067c12cd2506738b21dab",
    "cve_id": "CVE-2019-10173",
    "cwe_id": "CWE-502",
    "filename": "xstream/src/java/com/thoughtworks/xstream/XStream.java",
    "is_vulnerable": 0,
    "class_name": "XStream",
    "subclass_name": null,
    "function_name": "aliasSystemAttribute(String alias, String systemAttributeName)",
    "function_body": "{\n        if (systemAttributeAliasingMapper == null) {\n            throw new com.thoughtworks.xstream.InitializationException(\"No \"\n                + SystemAttributeAliasingMapper.class.getName()\n                + \" available\");\n        }\n        systemAttributeAliasingMapper.addAliasFor(systemAttributeName, alias);\n    }"
  },
  {
    "id": 75,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 42,
    "human_patch": "https://github.com/x-stream/xstream/commit/f38a1da3ae9491930c2067c12cd2506738b21dab",
    "cve_id": "CVE-2019-10173",
    "cwe_id": "CWE-502",
    "filename": "xstream/src/java/com/thoughtworks/xstream/XStream.java",
    "is_vulnerable": 0,
    "class_name": "XStream",
    "subclass_name": null,
    "function_name": "aliasAttribute(Class definedIn, String attributeName, String alias)",
    "function_body": "{\n        aliasField(alias, definedIn, attributeName);\n        useAttributeFor(definedIn, attributeName);\n    }"
  },
  {
    "id": 75,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 43,
    "human_patch": "https://github.com/x-stream/xstream/commit/f38a1da3ae9491930c2067c12cd2506738b21dab",
    "cve_id": "CVE-2019-10173",
    "cwe_id": "CWE-502",
    "filename": "xstream/src/java/com/thoughtworks/xstream/XStream.java",
    "is_vulnerable": 0,
    "class_name": "XStream",
    "subclass_name": null,
    "function_name": "useAttributeFor(String fieldName, Class type)",
    "function_body": "{\n        if (attributeMapper == null) {\n            throw new com.thoughtworks.xstream.InitializationException(\"No \"\n                + AttributeMapper.class.getName()\n                + \" available\");\n        }\n        attributeMapper.addAttributeFor(fieldName, type);\n    }"
  },
  {
    "id": 75,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 44,
    "human_patch": "https://github.com/x-stream/xstream/commit/f38a1da3ae9491930c2067c12cd2506738b21dab",
    "cve_id": "CVE-2019-10173",
    "cwe_id": "CWE-502",
    "filename": "xstream/src/java/com/thoughtworks/xstream/XStream.java",
    "is_vulnerable": 0,
    "class_name": "XStream",
    "subclass_name": null,
    "function_name": "useAttributeFor(Class definedIn, String fieldName)",
    "function_body": "{\n        if (attributeMapper == null) {\n            throw new com.thoughtworks.xstream.InitializationException(\"No \"\n                + AttributeMapper.class.getName()\n                + \" available\");\n        }\n        attributeMapper.addAttributeFor(definedIn, fieldName);\n    }"
  },
  {
    "id": 75,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 45,
    "human_patch": "https://github.com/x-stream/xstream/commit/f38a1da3ae9491930c2067c12cd2506738b21dab",
    "cve_id": "CVE-2019-10173",
    "cwe_id": "CWE-502",
    "filename": "xstream/src/java/com/thoughtworks/xstream/XStream.java",
    "is_vulnerable": 0,
    "class_name": "XStream",
    "subclass_name": null,
    "function_name": "useAttributeFor(Class type)",
    "function_body": "{\n        if (attributeMapper == null) {\n            throw new com.thoughtworks.xstream.InitializationException(\"No \"\n                + AttributeMapper.class.getName()\n                + \" available\");\n        }\n        attributeMapper.addAttributeFor(type);\n    }"
  },
  {
    "id": 75,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 46,
    "human_patch": "https://github.com/x-stream/xstream/commit/f38a1da3ae9491930c2067c12cd2506738b21dab",
    "cve_id": "CVE-2019-10173",
    "cwe_id": "CWE-502",
    "filename": "xstream/src/java/com/thoughtworks/xstream/XStream.java",
    "is_vulnerable": 0,
    "class_name": "XStream",
    "subclass_name": null,
    "function_name": "addDefaultImplementation(Class defaultImplementation, Class ofType)",
    "function_body": "{\n        if (defaultImplementationsMapper == null) {\n            throw new com.thoughtworks.xstream.InitializationException(\"No \"\n                + DefaultImplementationsMapper.class.getName()\n                + \" available\");\n        }\n        defaultImplementationsMapper.addDefaultImplementation(defaultImplementation, ofType);\n    }"
  },
  {
    "id": 75,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 47,
    "human_patch": "https://github.com/x-stream/xstream/commit/f38a1da3ae9491930c2067c12cd2506738b21dab",
    "cve_id": "CVE-2019-10173",
    "cwe_id": "CWE-502",
    "filename": "xstream/src/java/com/thoughtworks/xstream/XStream.java",
    "is_vulnerable": 0,
    "class_name": "XStream",
    "subclass_name": null,
    "function_name": "addImmutableType(Class type)",
    "function_body": "{\n        addImmutableType(type, true);\n    }"
  },
  {
    "id": 75,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 48,
    "human_patch": "https://github.com/x-stream/xstream/commit/f38a1da3ae9491930c2067c12cd2506738b21dab",
    "cve_id": "CVE-2019-10173",
    "cwe_id": "CWE-502",
    "filename": "xstream/src/java/com/thoughtworks/xstream/XStream.java",
    "is_vulnerable": 0,
    "class_name": "XStream",
    "subclass_name": null,
    "function_name": "addImmutableType(final Class type, final boolean isReferenceable)",
    "function_body": "{\n        if (immutableTypesMapper == null) {\n            throw new com.thoughtworks.xstream.InitializationException(\"No \"\n                + ImmutableTypesMapper.class.getName()\n                + \" available\");\n        }\n        immutableTypesMapper.addImmutableType(type, isReferenceable);\n    }"
  },
  {
    "id": 75,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 49,
    "human_patch": "https://github.com/x-stream/xstream/commit/f38a1da3ae9491930c2067c12cd2506738b21dab",
    "cve_id": "CVE-2019-10173",
    "cwe_id": "CWE-502",
    "filename": "xstream/src/java/com/thoughtworks/xstream/XStream.java",
    "is_vulnerable": 0,
    "class_name": "XStream",
    "subclass_name": null,
    "function_name": "registerConverter(Converter converter)",
    "function_body": "{\n        registerConverter(converter, PRIORITY_NORMAL);\n    }"
  },
  {
    "id": 75,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 50,
    "human_patch": "https://github.com/x-stream/xstream/commit/f38a1da3ae9491930c2067c12cd2506738b21dab",
    "cve_id": "CVE-2019-10173",
    "cwe_id": "CWE-502",
    "filename": "xstream/src/java/com/thoughtworks/xstream/XStream.java",
    "is_vulnerable": 1,
    "class_name": "XStream",
    "subclass_name": null,
    "function_name": "registerConverter(Converter converter, int priority)",
    "function_body": "{\n        if (converterRegistry != null) {\n            converterRegistry.registerConverter(converter, priority);\n        }\n    }"
  },
  {
    "id": 75,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 51,
    "human_patch": "https://github.com/x-stream/xstream/commit/f38a1da3ae9491930c2067c12cd2506738b21dab",
    "cve_id": "CVE-2019-10173",
    "cwe_id": "CWE-502",
    "filename": "xstream/src/java/com/thoughtworks/xstream/XStream.java",
    "is_vulnerable": 0,
    "class_name": "XStream",
    "subclass_name": null,
    "function_name": "registerConverter(SingleValueConverter converter)",
    "function_body": "{\n        registerConverter(converter, PRIORITY_NORMAL);\n    }"
  },
  {
    "id": 75,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 52,
    "human_patch": "https://github.com/x-stream/xstream/commit/f38a1da3ae9491930c2067c12cd2506738b21dab",
    "cve_id": "CVE-2019-10173",
    "cwe_id": "CWE-502",
    "filename": "xstream/src/java/com/thoughtworks/xstream/XStream.java",
    "is_vulnerable": 0,
    "class_name": "XStream",
    "subclass_name": null,
    "function_name": "registerConverter(SingleValueConverter converter, int priority)",
    "function_body": "{\n        if (converterRegistry != null) {\n            converterRegistry.registerConverter(\n                new SingleValueConverterWrapper(converter), priority);\n        }\n    }"
  },
  {
    "id": 75,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 53,
    "human_patch": "https://github.com/x-stream/xstream/commit/f38a1da3ae9491930c2067c12cd2506738b21dab",
    "cve_id": "CVE-2019-10173",
    "cwe_id": "CWE-502",
    "filename": "xstream/src/java/com/thoughtworks/xstream/XStream.java",
    "is_vulnerable": 0,
    "class_name": "XStream",
    "subclass_name": null,
    "function_name": "registerLocalConverter(Class definedIn, String fieldName, Converter converter)",
    "function_body": "{\n        if (localConversionMapper == null) {\n            throw new com.thoughtworks.xstream.InitializationException(\"No \"\n                + LocalConversionMapper.class.getName()\n                + \" available\");\n        }\n        localConversionMapper.registerLocalConverter(definedIn, fieldName, converter);\n    }"
  },
  {
    "id": 75,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 54,
    "human_patch": "https://github.com/x-stream/xstream/commit/f38a1da3ae9491930c2067c12cd2506738b21dab",
    "cve_id": "CVE-2019-10173",
    "cwe_id": "CWE-502",
    "filename": "xstream/src/java/com/thoughtworks/xstream/XStream.java",
    "is_vulnerable": 0,
    "class_name": "XStream",
    "subclass_name": null,
    "function_name": "registerLocalConverter(Class definedIn, String fieldName,\n        SingleValueConverter converter)",
    "function_body": "{\n        registerLocalConverter(\n            definedIn, fieldName, (Converter)new SingleValueConverterWrapper(converter));\n    }"
  },
  {
    "id": 75,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 55,
    "human_patch": "https://github.com/x-stream/xstream/commit/f38a1da3ae9491930c2067c12cd2506738b21dab",
    "cve_id": "CVE-2019-10173",
    "cwe_id": "CWE-502",
    "filename": "xstream/src/java/com/thoughtworks/xstream/XStream.java",
    "is_vulnerable": 0,
    "class_name": "XStream",
    "subclass_name": null,
    "function_name": "getMapper()",
    "function_body": "{\n        return mapper;\n    }"
  },
  {
    "id": 75,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 56,
    "human_patch": "https://github.com/x-stream/xstream/commit/f38a1da3ae9491930c2067c12cd2506738b21dab",
    "cve_id": "CVE-2019-10173",
    "cwe_id": "CWE-502",
    "filename": "xstream/src/java/com/thoughtworks/xstream/XStream.java",
    "is_vulnerable": 0,
    "class_name": "XStream",
    "subclass_name": null,
    "function_name": "getReflectionProvider()",
    "function_body": "{\n        return reflectionProvider;\n    }"
  },
  {
    "id": 75,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 57,
    "human_patch": "https://github.com/x-stream/xstream/commit/f38a1da3ae9491930c2067c12cd2506738b21dab",
    "cve_id": "CVE-2019-10173",
    "cwe_id": "CWE-502",
    "filename": "xstream/src/java/com/thoughtworks/xstream/XStream.java",
    "is_vulnerable": 0,
    "class_name": "XStream",
    "subclass_name": null,
    "function_name": "getConverterLookup()",
    "function_body": "{\n        return converterLookup;\n    }"
  },
  {
    "id": 75,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 58,
    "human_patch": "https://github.com/x-stream/xstream/commit/f38a1da3ae9491930c2067c12cd2506738b21dab",
    "cve_id": "CVE-2019-10173",
    "cwe_id": "CWE-502",
    "filename": "xstream/src/java/com/thoughtworks/xstream/XStream.java",
    "is_vulnerable": 0,
    "class_name": "XStream",
    "subclass_name": null,
    "function_name": "setMode(int mode)",
    "function_body": "{\n        switch (mode) {\n        case NO_REFERENCES:\n            setMarshallingStrategy(new TreeMarshallingStrategy());\n            break;\n        case ID_REFERENCES:\n            setMarshallingStrategy(new ReferenceByIdMarshallingStrategy());\n            break;\n        case XPATH_RELATIVE_REFERENCES:\n            setMarshallingStrategy(new ReferenceByXPathMarshallingStrategy(\n                ReferenceByXPathMarshallingStrategy.RELATIVE));\n            break;\n        case XPATH_ABSOLUTE_REFERENCES:\n            setMarshallingStrategy(new ReferenceByXPathMarshallingStrategy(\n                ReferenceByXPathMarshallingStrategy.ABSOLUTE));\n            break;\n        case SINGLE_NODE_XPATH_RELATIVE_REFERENCES:\n            setMarshallingStrategy(new ReferenceByXPathMarshallingStrategy(\n                  ReferenceByXPathMarshallingStrategy.RELATIVE \n                | ReferenceByXPathMarshallingStrategy.SINGLE_NODE));\n            break;\n        case SINGLE_NODE_XPATH_ABSOLUTE_REFERENCES:\n            setMarshallingStrategy(new ReferenceByXPathMarshallingStrategy(\n                  ReferenceByXPathMarshallingStrategy.ABSOLUTE \n                | ReferenceByXPathMarshallingStrategy.SINGLE_NODE));\n            break;\n        default:\n            throw new IllegalArgumentException(\"Unknown mode : \" + mode);\n        }\n    }"
  },
  {
    "id": 75,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 59,
    "human_patch": "https://github.com/x-stream/xstream/commit/f38a1da3ae9491930c2067c12cd2506738b21dab",
    "cve_id": "CVE-2019-10173",
    "cwe_id": "CWE-502",
    "filename": "xstream/src/java/com/thoughtworks/xstream/XStream.java",
    "is_vulnerable": 0,
    "class_name": "XStream",
    "subclass_name": null,
    "function_name": "addImplicitCollection(Class ownerType, String fieldName)",
    "function_body": "{\n        addImplicitCollection(ownerType, fieldName, null, null);\n    }"
  },
  {
    "id": 75,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 60,
    "human_patch": "https://github.com/x-stream/xstream/commit/f38a1da3ae9491930c2067c12cd2506738b21dab",
    "cve_id": "CVE-2019-10173",
    "cwe_id": "CWE-502",
    "filename": "xstream/src/java/com/thoughtworks/xstream/XStream.java",
    "is_vulnerable": 0,
    "class_name": "XStream",
    "subclass_name": null,
    "function_name": "addImplicitCollection(Class ownerType, String fieldName, Class itemType)",
    "function_body": "{\n        addImplicitCollection(ownerType, fieldName, null, itemType);\n    }"
  },
  {
    "id": 75,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 61,
    "human_patch": "https://github.com/x-stream/xstream/commit/f38a1da3ae9491930c2067c12cd2506738b21dab",
    "cve_id": "CVE-2019-10173",
    "cwe_id": "CWE-502",
    "filename": "xstream/src/java/com/thoughtworks/xstream/XStream.java",
    "is_vulnerable": 0,
    "class_name": "XStream",
    "subclass_name": null,
    "function_name": "addImplicitCollection(Class ownerType, String fieldName, String itemFieldName,\n        Class itemType)",
    "function_body": "{\n        addImplicitMap(ownerType, fieldName, itemFieldName, itemType, null);\n    }"
  },
  {
    "id": 75,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 62,
    "human_patch": "https://github.com/x-stream/xstream/commit/f38a1da3ae9491930c2067c12cd2506738b21dab",
    "cve_id": "CVE-2019-10173",
    "cwe_id": "CWE-502",
    "filename": "xstream/src/java/com/thoughtworks/xstream/XStream.java",
    "is_vulnerable": 0,
    "class_name": "XStream",
    "subclass_name": null,
    "function_name": "addImplicitArray(Class ownerType, String fieldName)",
    "function_body": "{\n        addImplicitCollection(ownerType, fieldName);\n    }"
  },
  {
    "id": 75,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 63,
    "human_patch": "https://github.com/x-stream/xstream/commit/f38a1da3ae9491930c2067c12cd2506738b21dab",
    "cve_id": "CVE-2019-10173",
    "cwe_id": "CWE-502",
    "filename": "xstream/src/java/com/thoughtworks/xstream/XStream.java",
    "is_vulnerable": 0,
    "class_name": "XStream",
    "subclass_name": null,
    "function_name": "addImplicitArray(Class ownerType, String fieldName, Class itemType)",
    "function_body": "{\n        addImplicitCollection(ownerType, fieldName, itemType);\n    }"
  },
  {
    "id": 75,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 64,
    "human_patch": "https://github.com/x-stream/xstream/commit/f38a1da3ae9491930c2067c12cd2506738b21dab",
    "cve_id": "CVE-2019-10173",
    "cwe_id": "CWE-502",
    "filename": "xstream/src/java/com/thoughtworks/xstream/XStream.java",
    "is_vulnerable": 0,
    "class_name": "XStream",
    "subclass_name": null,
    "function_name": "addImplicitArray(Class ownerType, String fieldName, String itemName)",
    "function_body": "{\n        addImplicitCollection(ownerType, fieldName, itemName, null);\n    }"
  },
  {
    "id": 75,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 65,
    "human_patch": "https://github.com/x-stream/xstream/commit/f38a1da3ae9491930c2067c12cd2506738b21dab",
    "cve_id": "CVE-2019-10173",
    "cwe_id": "CWE-502",
    "filename": "xstream/src/java/com/thoughtworks/xstream/XStream.java",
    "is_vulnerable": 0,
    "class_name": "XStream",
    "subclass_name": null,
    "function_name": "addImplicitMap(Class ownerType, String fieldName, Class itemType, String keyFieldName)",
    "function_body": "{\n        addImplicitMap(ownerType, fieldName, null, itemType, keyFieldName);\n    }"
  },
  {
    "id": 75,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 66,
    "human_patch": "https://github.com/x-stream/xstream/commit/f38a1da3ae9491930c2067c12cd2506738b21dab",
    "cve_id": "CVE-2019-10173",
    "cwe_id": "CWE-502",
    "filename": "xstream/src/java/com/thoughtworks/xstream/XStream.java",
    "is_vulnerable": 0,
    "class_name": "XStream",
    "subclass_name": null,
    "function_name": "addImplicitMap(Class ownerType, String fieldName, String itemName, \n        Class itemType, String keyFieldName)",
    "function_body": "{\n        if (implicitCollectionMapper == null) {\n            throw new com.thoughtworks.xstream.InitializationException(\"No \"\n                + ImplicitCollectionMapper.class.getName()\n                + \" available\");\n        }\n        implicitCollectionMapper.add(ownerType, fieldName, itemName, itemType, keyFieldName);\n    }"
  },
  {
    "id": 75,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 67,
    "human_patch": "https://github.com/x-stream/xstream/commit/f38a1da3ae9491930c2067c12cd2506738b21dab",
    "cve_id": "CVE-2019-10173",
    "cwe_id": "CWE-502",
    "filename": "xstream/src/java/com/thoughtworks/xstream/XStream.java",
    "is_vulnerable": 0,
    "class_name": "XStream",
    "subclass_name": null,
    "function_name": "newDataHolder()",
    "function_body": "{\n        return new MapBackedDataHolder();\n    }"
  },
  {
    "id": 75,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 68,
    "human_patch": "https://github.com/x-stream/xstream/commit/f38a1da3ae9491930c2067c12cd2506738b21dab",
    "cve_id": "CVE-2019-10173",
    "cwe_id": "CWE-502",
    "filename": "xstream/src/java/com/thoughtworks/xstream/XStream.java",
    "is_vulnerable": 0,
    "class_name": "XStream",
    "subclass_name": null,
    "function_name": "createObjectOutputStream(Writer writer) throws IOException",
    "function_body": "{\n        return createObjectOutputStream(\n            hierarchicalStreamDriver.createWriter(writer), \"object-stream\");\n    }"
  },
  {
    "id": 75,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 69,
    "human_patch": "https://github.com/x-stream/xstream/commit/f38a1da3ae9491930c2067c12cd2506738b21dab",
    "cve_id": "CVE-2019-10173",
    "cwe_id": "CWE-502",
    "filename": "xstream/src/java/com/thoughtworks/xstream/XStream.java",
    "is_vulnerable": 0,
    "class_name": "XStream",
    "subclass_name": null,
    "function_name": "createObjectOutputStream(HierarchicalStreamWriter writer) throws IOException",
    "function_body": "{\n        return createObjectOutputStream(writer, \"object-stream\");\n    }"
  },
  {
    "id": 75,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 70,
    "human_patch": "https://github.com/x-stream/xstream/commit/f38a1da3ae9491930c2067c12cd2506738b21dab",
    "cve_id": "CVE-2019-10173",
    "cwe_id": "CWE-502",
    "filename": "xstream/src/java/com/thoughtworks/xstream/XStream.java",
    "is_vulnerable": 0,
    "class_name": "XStream",
    "subclass_name": null,
    "function_name": "createObjectOutputStream(Writer writer, String rootNodeName) throws IOException",
    "function_body": "{\n        return createObjectOutputStream(\n            hierarchicalStreamDriver.createWriter(writer), rootNodeName);\n    }"
  },
  {
    "id": 75,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 71,
    "human_patch": "https://github.com/x-stream/xstream/commit/f38a1da3ae9491930c2067c12cd2506738b21dab",
    "cve_id": "CVE-2019-10173",
    "cwe_id": "CWE-502",
    "filename": "xstream/src/java/com/thoughtworks/xstream/XStream.java",
    "is_vulnerable": 0,
    "class_name": "XStream",
    "subclass_name": null,
    "function_name": "createObjectOutputStream(OutputStream out) throws IOException",
    "function_body": "{\n        return createObjectOutputStream(\n            hierarchicalStreamDriver.createWriter(out), \"object-stream\");\n    }"
  },
  {
    "id": 75,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 72,
    "human_patch": "https://github.com/x-stream/xstream/commit/f38a1da3ae9491930c2067c12cd2506738b21dab",
    "cve_id": "CVE-2019-10173",
    "cwe_id": "CWE-502",
    "filename": "xstream/src/java/com/thoughtworks/xstream/XStream.java",
    "is_vulnerable": 0,
    "class_name": "XStream",
    "subclass_name": null,
    "function_name": "createObjectOutputStream(OutputStream out, String rootNodeName) throws IOException",
    "function_body": "{\n        return createObjectOutputStream(\n            hierarchicalStreamDriver.createWriter(out), rootNodeName);\n    }"
  },
  {
    "id": 75,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 73,
    "human_patch": "https://github.com/x-stream/xstream/commit/f38a1da3ae9491930c2067c12cd2506738b21dab",
    "cve_id": "CVE-2019-10173",
    "cwe_id": "CWE-502",
    "filename": "xstream/src/java/com/thoughtworks/xstream/XStream.java",
    "is_vulnerable": 0,
    "class_name": "XStream",
    "subclass_name": null,
    "function_name": "createObjectOutputStream(final HierarchicalStreamWriter writer, final String rootNodeName) throws IOException",
    "function_body": "{\n        return createObjectOutputStream(writer, rootNodeName, null);\n    }"
  },
  {
    "id": 75,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 74,
    "human_patch": "https://github.com/x-stream/xstream/commit/f38a1da3ae9491930c2067c12cd2506738b21dab",
    "cve_id": "CVE-2019-10173",
    "cwe_id": "CWE-502",
    "filename": "xstream/src/java/com/thoughtworks/xstream/XStream.java",
    "is_vulnerable": 0,
    "class_name": "XStream",
    "subclass_name": null,
    "function_name": "createObjectOutputStream(final HierarchicalStreamWriter writer, final String rootNodeName,\n            final DataHolder dataHolder) throws IOException",
    "function_body": "{\n        final StatefulWriter statefulWriter = new StatefulWriter(writer);\n        statefulWriter.startNode(rootNodeName, null);\n        return new CustomObjectOutputStream(new CustomObjectOutputStream.StreamCallback() {\n            public void writeToStream(final Object object) {\n                marshal(object, statefulWriter, dataHolder);\n            }\n\n            public void writeFieldsToStream(Map fields) throws NotActiveException {\n                throw new NotActiveException(\"not in call to writeObject\");\n            }\n\n            public void defaultWriteObject() throws NotActiveException {\n                throw new NotActiveException(\"not in call to writeObject\");\n            }\n\n            public void flush() {\n                statefulWriter.flush();\n            }\n\n            public void close() {\n                if (statefulWriter.state() != StatefulWriter.STATE_CLOSED) {\n                    statefulWriter.endNode();\n                    statefulWriter.close();\n                }\n            }\n        });\n    }"
  },
  {
    "id": 75,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 75,
    "human_patch": "https://github.com/x-stream/xstream/commit/f38a1da3ae9491930c2067c12cd2506738b21dab",
    "cve_id": "CVE-2019-10173",
    "cwe_id": "CWE-502",
    "filename": "xstream/src/java/com/thoughtworks/xstream/XStream.java",
    "is_vulnerable": 0,
    "class_name": "XStream",
    "subclass_name": null,
    "function_name": "writeToStream(final Object object)",
    "function_body": "{\n                marshal(object, statefulWriter, dataHolder);\n            }"
  },
  {
    "id": 75,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 76,
    "human_patch": "https://github.com/x-stream/xstream/commit/f38a1da3ae9491930c2067c12cd2506738b21dab",
    "cve_id": "CVE-2019-10173",
    "cwe_id": "CWE-502",
    "filename": "xstream/src/java/com/thoughtworks/xstream/XStream.java",
    "is_vulnerable": 0,
    "class_name": "XStream",
    "subclass_name": null,
    "function_name": "writeFieldsToStream(Map fields) throws NotActiveException",
    "function_body": "{\n                throw new NotActiveException(\"not in call to writeObject\");\n            }"
  },
  {
    "id": 75,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 77,
    "human_patch": "https://github.com/x-stream/xstream/commit/f38a1da3ae9491930c2067c12cd2506738b21dab",
    "cve_id": "CVE-2019-10173",
    "cwe_id": "CWE-502",
    "filename": "xstream/src/java/com/thoughtworks/xstream/XStream.java",
    "is_vulnerable": 0,
    "class_name": "XStream",
    "subclass_name": null,
    "function_name": "defaultWriteObject() throws NotActiveException",
    "function_body": "{\n                throw new NotActiveException(\"not in call to writeObject\");\n            }"
  },
  {
    "id": 75,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 78,
    "human_patch": "https://github.com/x-stream/xstream/commit/f38a1da3ae9491930c2067c12cd2506738b21dab",
    "cve_id": "CVE-2019-10173",
    "cwe_id": "CWE-502",
    "filename": "xstream/src/java/com/thoughtworks/xstream/XStream.java",
    "is_vulnerable": 0,
    "class_name": "XStream",
    "subclass_name": null,
    "function_name": "flush()",
    "function_body": "{\n                statefulWriter.flush();\n            }"
  },
  {
    "id": 75,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 79,
    "human_patch": "https://github.com/x-stream/xstream/commit/f38a1da3ae9491930c2067c12cd2506738b21dab",
    "cve_id": "CVE-2019-10173",
    "cwe_id": "CWE-502",
    "filename": "xstream/src/java/com/thoughtworks/xstream/XStream.java",
    "is_vulnerable": 0,
    "class_name": "XStream",
    "subclass_name": null,
    "function_name": "close()",
    "function_body": "{\n                if (statefulWriter.state() != StatefulWriter.STATE_CLOSED) {\n                    statefulWriter.endNode();\n                    statefulWriter.close();\n                }\n            }"
  },
  {
    "id": 75,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 80,
    "human_patch": "https://github.com/x-stream/xstream/commit/f38a1da3ae9491930c2067c12cd2506738b21dab",
    "cve_id": "CVE-2019-10173",
    "cwe_id": "CWE-502",
    "filename": "xstream/src/java/com/thoughtworks/xstream/XStream.java",
    "is_vulnerable": 0,
    "class_name": "XStream",
    "subclass_name": null,
    "function_name": "createObjectInputStream(Reader xmlReader) throws IOException",
    "function_body": "{\n        return createObjectInputStream(hierarchicalStreamDriver.createReader(xmlReader));\n    }"
  },
  {
    "id": 75,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 81,
    "human_patch": "https://github.com/x-stream/xstream/commit/f38a1da3ae9491930c2067c12cd2506738b21dab",
    "cve_id": "CVE-2019-10173",
    "cwe_id": "CWE-502",
    "filename": "xstream/src/java/com/thoughtworks/xstream/XStream.java",
    "is_vulnerable": 0,
    "class_name": "XStream",
    "subclass_name": null,
    "function_name": "createObjectInputStream(InputStream in) throws IOException",
    "function_body": "{\n        return createObjectInputStream(hierarchicalStreamDriver.createReader(in));\n    }"
  },
  {
    "id": 75,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 82,
    "human_patch": "https://github.com/x-stream/xstream/commit/f38a1da3ae9491930c2067c12cd2506738b21dab",
    "cve_id": "CVE-2019-10173",
    "cwe_id": "CWE-502",
    "filename": "xstream/src/java/com/thoughtworks/xstream/XStream.java",
    "is_vulnerable": 0,
    "class_name": "XStream",
    "subclass_name": null,
    "function_name": "createObjectInputStream(final HierarchicalStreamReader reader) throws IOException",
    "function_body": "{\n        return createObjectInputStream(reader, null);\n    }"
  },
  {
    "id": 75,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 83,
    "human_patch": "https://github.com/x-stream/xstream/commit/f38a1da3ae9491930c2067c12cd2506738b21dab",
    "cve_id": "CVE-2019-10173",
    "cwe_id": "CWE-502",
    "filename": "xstream/src/java/com/thoughtworks/xstream/XStream.java",
    "is_vulnerable": 0,
    "class_name": "XStream",
    "subclass_name": null,
    "function_name": "createObjectInputStream(final HierarchicalStreamReader reader, final DataHolder dataHolder) throws IOException",
    "function_body": "{\n        return new CustomObjectInputStream(new CustomObjectInputStream.StreamCallback() {\n            public Object readFromStream() throws EOFException {\n                if (!reader.hasMoreChildren()) {\n                    throw new EOFException();\n                }\n                reader.moveDown();\n                final Object result = unmarshal(reader, dataHolder);\n                reader.moveUp();\n                return result;\n            }\n\n            public Map readFieldsFromStream() throws IOException {\n                throw new NotActiveException(\"not in call to readObject\");\n            }\n\n            public void defaultReadObject() throws NotActiveException {\n                throw new NotActiveException(\"not in call to readObject\");\n            }\n\n            public void registerValidation(ObjectInputValidation validation, int priority)\n                throws NotActiveException {\n                throw new NotActiveException(\"stream inactive\");\n            }\n\n            public void close() {\n                reader.close();\n            }\n        }, classLoaderReference);\n    }"
  },
  {
    "id": 75,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 84,
    "human_patch": "https://github.com/x-stream/xstream/commit/f38a1da3ae9491930c2067c12cd2506738b21dab",
    "cve_id": "CVE-2019-10173",
    "cwe_id": "CWE-502",
    "filename": "xstream/src/java/com/thoughtworks/xstream/XStream.java",
    "is_vulnerable": 0,
    "class_name": "XStream",
    "subclass_name": null,
    "function_name": "readFromStream() throws EOFException",
    "function_body": "{\n                if (!reader.hasMoreChildren()) {\n                    throw new EOFException();\n                }\n                reader.moveDown();\n                final Object result = unmarshal(reader, dataHolder);\n                reader.moveUp();\n                return result;\n            }"
  },
  {
    "id": 75,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 85,
    "human_patch": "https://github.com/x-stream/xstream/commit/f38a1da3ae9491930c2067c12cd2506738b21dab",
    "cve_id": "CVE-2019-10173",
    "cwe_id": "CWE-502",
    "filename": "xstream/src/java/com/thoughtworks/xstream/XStream.java",
    "is_vulnerable": 0,
    "class_name": "XStream",
    "subclass_name": null,
    "function_name": "readFieldsFromStream() throws IOException",
    "function_body": "{\n                throw new NotActiveException(\"not in call to readObject\");\n            }"
  },
  {
    "id": 75,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 86,
    "human_patch": "https://github.com/x-stream/xstream/commit/f38a1da3ae9491930c2067c12cd2506738b21dab",
    "cve_id": "CVE-2019-10173",
    "cwe_id": "CWE-502",
    "filename": "xstream/src/java/com/thoughtworks/xstream/XStream.java",
    "is_vulnerable": 0,
    "class_name": "XStream",
    "subclass_name": null,
    "function_name": "defaultReadObject() throws NotActiveException",
    "function_body": "{\n                throw new NotActiveException(\"not in call to readObject\");\n            }"
  },
  {
    "id": 75,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 87,
    "human_patch": "https://github.com/x-stream/xstream/commit/f38a1da3ae9491930c2067c12cd2506738b21dab",
    "cve_id": "CVE-2019-10173",
    "cwe_id": "CWE-502",
    "filename": "xstream/src/java/com/thoughtworks/xstream/XStream.java",
    "is_vulnerable": 0,
    "class_name": "XStream",
    "subclass_name": null,
    "function_name": "registerValidation(ObjectInputValidation validation, int priority) throws NotActiveException",
    "function_body": "{\n                throw new NotActiveException(\"stream inactive\");\n            }"
  },
  {
    "id": 75,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 88,
    "human_patch": "https://github.com/x-stream/xstream/commit/f38a1da3ae9491930c2067c12cd2506738b21dab",
    "cve_id": "CVE-2019-10173",
    "cwe_id": "CWE-502",
    "filename": "xstream/src/java/com/thoughtworks/xstream/XStream.java",
    "is_vulnerable": 1,
    "class_name": "XStream",
    "subclass_name": null,
    "function_name": "close()",
    "function_body": "{\n                reader.close();\n            }"
  },
  {
    "id": 75,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 89,
    "human_patch": "https://github.com/x-stream/xstream/commit/f38a1da3ae9491930c2067c12cd2506738b21dab",
    "cve_id": "CVE-2019-10173",
    "cwe_id": "CWE-502",
    "filename": "xstream/src/java/com/thoughtworks/xstream/XStream.java",
    "is_vulnerable": 0,
    "class_name": "XStream",
    "subclass_name": null,
    "function_name": "setClassLoader(ClassLoader classLoader)",
    "function_body": "{\n        classLoaderReference.setReference(classLoader);\n    }"
  },
  {
    "id": 75,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 90,
    "human_patch": "https://github.com/x-stream/xstream/commit/f38a1da3ae9491930c2067c12cd2506738b21dab",
    "cve_id": "CVE-2019-10173",
    "cwe_id": "CWE-502",
    "filename": "xstream/src/java/com/thoughtworks/xstream/XStream.java",
    "is_vulnerable": 0,
    "class_name": "XStream",
    "subclass_name": null,
    "function_name": "getClassLoader()",
    "function_body": "{\n        return classLoaderReference.getReference();\n    }"
  },
  {
    "id": 75,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 91,
    "human_patch": "https://github.com/x-stream/xstream/commit/f38a1da3ae9491930c2067c12cd2506738b21dab",
    "cve_id": "CVE-2019-10173",
    "cwe_id": "CWE-502",
    "filename": "xstream/src/java/com/thoughtworks/xstream/XStream.java",
    "is_vulnerable": 0,
    "class_name": "XStream",
    "subclass_name": null,
    "function_name": "getClassLoaderReference()",
    "function_body": "{\n        return classLoaderReference;\n    }"
  },
  {
    "id": 75,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 92,
    "human_patch": "https://github.com/x-stream/xstream/commit/f38a1da3ae9491930c2067c12cd2506738b21dab",
    "cve_id": "CVE-2019-10173",
    "cwe_id": "CWE-502",
    "filename": "xstream/src/java/com/thoughtworks/xstream/XStream.java",
    "is_vulnerable": 0,
    "class_name": "XStream",
    "subclass_name": null,
    "function_name": "omitField(Class definedIn, String fieldName)",
    "function_body": "{\n        if (elementIgnoringMapper == null) {\n            throw new com.thoughtworks.xstream.InitializationException(\"No \"\n                + ElementIgnoringMapper.class.getName()\n                + \" available\");\n        }\n        elementIgnoringMapper.omitField(definedIn, fieldName);\n    }"
  },
  {
    "id": 75,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 93,
    "human_patch": "https://github.com/x-stream/xstream/commit/f38a1da3ae9491930c2067c12cd2506738b21dab",
    "cve_id": "CVE-2019-10173",
    "cwe_id": "CWE-502",
    "filename": "xstream/src/java/com/thoughtworks/xstream/XStream.java",
    "is_vulnerable": 0,
    "class_name": "XStream",
    "subclass_name": null,
    "function_name": "ignoreUnknownElements()",
    "function_body": "{\n        ignoreUnknownElements(IGNORE_ALL);\n    }"
  },
  {
    "id": 75,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 94,
    "human_patch": "https://github.com/x-stream/xstream/commit/f38a1da3ae9491930c2067c12cd2506738b21dab",
    "cve_id": "CVE-2019-10173",
    "cwe_id": "CWE-502",
    "filename": "xstream/src/java/com/thoughtworks/xstream/XStream.java",
    "is_vulnerable": 0,
    "class_name": "XStream",
    "subclass_name": null,
    "function_name": "ignoreUnknownElements(String pattern)",
    "function_body": "{\n        ignoreUnknownElements(Pattern.compile(pattern));\n    }"
  },
  {
    "id": 75,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 95,
    "human_patch": "https://github.com/x-stream/xstream/commit/f38a1da3ae9491930c2067c12cd2506738b21dab",
    "cve_id": "CVE-2019-10173",
    "cwe_id": "CWE-502",
    "filename": "xstream/src/java/com/thoughtworks/xstream/XStream.java",
    "is_vulnerable": 0,
    "class_name": "XStream",
    "subclass_name": null,
    "function_name": "ignoreUnknownElements(final Pattern pattern)",
    "function_body": "{\n        if (elementIgnoringMapper == null) {\n            throw new com.thoughtworks.xstream.InitializationException(\"No \"\n                + ElementIgnoringMapper.class.getName()\n                + \" available\");\n        }\n        elementIgnoringMapper.addElementsToIgnore(pattern);\n    }"
  },
  {
    "id": 75,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 96,
    "human_patch": "https://github.com/x-stream/xstream/commit/f38a1da3ae9491930c2067c12cd2506738b21dab",
    "cve_id": "CVE-2019-10173",
    "cwe_id": "CWE-502",
    "filename": "xstream/src/java/com/thoughtworks/xstream/XStream.java",
    "is_vulnerable": 0,
    "class_name": "XStream",
    "subclass_name": null,
    "function_name": "processAnnotations(final Class[] types)",
    "function_body": "{\n        if (annotationConfiguration == null) {\n            throw new com.thoughtworks.xstream.InitializationException(\"No \"\n                + ANNOTATION_MAPPER_TYPE\n                + \" available\");\n        }\n        annotationConfiguration.processAnnotations(types);\n    }"
  },
  {
    "id": 75,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 97,
    "human_patch": "https://github.com/x-stream/xstream/commit/f38a1da3ae9491930c2067c12cd2506738b21dab",
    "cve_id": "CVE-2019-10173",
    "cwe_id": "CWE-502",
    "filename": "xstream/src/java/com/thoughtworks/xstream/XStream.java",
    "is_vulnerable": 0,
    "class_name": "XStream",
    "subclass_name": null,
    "function_name": "processAnnotations(final Class type)",
    "function_body": "{\n        processAnnotations(new Class[]{type});\n    }"
  },
  {
    "id": 75,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 98,
    "human_patch": "https://github.com/x-stream/xstream/commit/f38a1da3ae9491930c2067c12cd2506738b21dab",
    "cve_id": "CVE-2019-10173",
    "cwe_id": "CWE-502",
    "filename": "xstream/src/java/com/thoughtworks/xstream/XStream.java",
    "is_vulnerable": 0,
    "class_name": "XStream",
    "subclass_name": null,
    "function_name": "autodetectAnnotations(boolean mode)",
    "function_body": "{\n        if (annotationConfiguration != null) {\n            annotationConfiguration.autodetectAnnotations(mode);\n        }\n    }"
  },
  {
    "id": 75,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 99,
    "human_patch": "https://github.com/x-stream/xstream/commit/f38a1da3ae9491930c2067c12cd2506738b21dab",
    "cve_id": "CVE-2019-10173",
    "cwe_id": "CWE-502",
    "filename": "xstream/src/java/com/thoughtworks/xstream/XStream.java",
    "is_vulnerable": 1,
    "class_name": "XStream",
    "subclass_name": null,
    "function_name": "addPermission(TypePermission permission)",
    "function_body": "{\n        if (securityMapper != null) {\n            insecureWarning &= permission != NoTypePermission.NONE;\n            securityMapper.addPermission(permission);\n        }\n    }"
  },
  {
    "id": 75,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 100,
    "human_patch": "https://github.com/x-stream/xstream/commit/f38a1da3ae9491930c2067c12cd2506738b21dab",
    "cve_id": "CVE-2019-10173",
    "cwe_id": "CWE-502",
    "filename": "xstream/src/java/com/thoughtworks/xstream/XStream.java",
    "is_vulnerable": 0,
    "class_name": "XStream",
    "subclass_name": null,
    "function_name": "allowTypes(String[] names)",
    "function_body": "{\n        addPermission(new ExplicitTypePermission(names));\n    }"
  },
  {
    "id": 75,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 101,
    "human_patch": "https://github.com/x-stream/xstream/commit/f38a1da3ae9491930c2067c12cd2506738b21dab",
    "cve_id": "CVE-2019-10173",
    "cwe_id": "CWE-502",
    "filename": "xstream/src/java/com/thoughtworks/xstream/XStream.java",
    "is_vulnerable": 0,
    "class_name": "XStream",
    "subclass_name": null,
    "function_name": "allowTypes(Class[] types)",
    "function_body": "{\n        addPermission(new ExplicitTypePermission(types));\n    }"
  },
  {
    "id": 75,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 102,
    "human_patch": "https://github.com/x-stream/xstream/commit/f38a1da3ae9491930c2067c12cd2506738b21dab",
    "cve_id": "CVE-2019-10173",
    "cwe_id": "CWE-502",
    "filename": "xstream/src/java/com/thoughtworks/xstream/XStream.java",
    "is_vulnerable": 0,
    "class_name": "XStream",
    "subclass_name": null,
    "function_name": "allowTypeHierarchy(Class type)",
    "function_body": "{\n        addPermission(new TypeHierarchyPermission(type));\n    }"
  },
  {
    "id": 75,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 103,
    "human_patch": "https://github.com/x-stream/xstream/commit/f38a1da3ae9491930c2067c12cd2506738b21dab",
    "cve_id": "CVE-2019-10173",
    "cwe_id": "CWE-502",
    "filename": "xstream/src/java/com/thoughtworks/xstream/XStream.java",
    "is_vulnerable": 0,
    "class_name": "XStream",
    "subclass_name": null,
    "function_name": "allowTypesByRegExp(String[] regexps)",
    "function_body": "{\n        addPermission(new RegExpTypePermission(regexps));\n    }"
  },
  {
    "id": 75,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 104,
    "human_patch": "https://github.com/x-stream/xstream/commit/f38a1da3ae9491930c2067c12cd2506738b21dab",
    "cve_id": "CVE-2019-10173",
    "cwe_id": "CWE-502",
    "filename": "xstream/src/java/com/thoughtworks/xstream/XStream.java",
    "is_vulnerable": 0,
    "class_name": "XStream",
    "subclass_name": null,
    "function_name": "allowTypesByRegExp(Pattern[] regexps)",
    "function_body": "{\n        addPermission(new RegExpTypePermission(regexps));\n    }"
  },
  {
    "id": 75,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 105,
    "human_patch": "https://github.com/x-stream/xstream/commit/f38a1da3ae9491930c2067c12cd2506738b21dab",
    "cve_id": "CVE-2019-10173",
    "cwe_id": "CWE-502",
    "filename": "xstream/src/java/com/thoughtworks/xstream/XStream.java",
    "is_vulnerable": 0,
    "class_name": "XStream",
    "subclass_name": null,
    "function_name": "allowTypesByWildcard(String[] patterns)",
    "function_body": "{\n        addPermission(new WildcardTypePermission(patterns));\n    }"
  },
  {
    "id": 75,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 106,
    "human_patch": "https://github.com/x-stream/xstream/commit/f38a1da3ae9491930c2067c12cd2506738b21dab",
    "cve_id": "CVE-2019-10173",
    "cwe_id": "CWE-502",
    "filename": "xstream/src/java/com/thoughtworks/xstream/XStream.java",
    "is_vulnerable": 0,
    "class_name": "XStream",
    "subclass_name": null,
    "function_name": "denyPermission(TypePermission permission)",
    "function_body": "{\n        addPermission(new NoPermission(permission));\n    }"
  },
  {
    "id": 75,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 107,
    "human_patch": "https://github.com/x-stream/xstream/commit/f38a1da3ae9491930c2067c12cd2506738b21dab",
    "cve_id": "CVE-2019-10173",
    "cwe_id": "CWE-502",
    "filename": "xstream/src/java/com/thoughtworks/xstream/XStream.java",
    "is_vulnerable": 0,
    "class_name": "XStream",
    "subclass_name": null,
    "function_name": "denyTypes(String[] names)",
    "function_body": "{\n        denyPermission(new ExplicitTypePermission(names));\n    }"
  },
  {
    "id": 75,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 108,
    "human_patch": "https://github.com/x-stream/xstream/commit/f38a1da3ae9491930c2067c12cd2506738b21dab",
    "cve_id": "CVE-2019-10173",
    "cwe_id": "CWE-502",
    "filename": "xstream/src/java/com/thoughtworks/xstream/XStream.java",
    "is_vulnerable": 0,
    "class_name": "XStream",
    "subclass_name": null,
    "function_name": "denyTypes(Class[] types)",
    "function_body": "{\n        denyPermission(new ExplicitTypePermission(types));\n    }"
  },
  {
    "id": 75,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 109,
    "human_patch": "https://github.com/x-stream/xstream/commit/f38a1da3ae9491930c2067c12cd2506738b21dab",
    "cve_id": "CVE-2019-10173",
    "cwe_id": "CWE-502",
    "filename": "xstream/src/java/com/thoughtworks/xstream/XStream.java",
    "is_vulnerable": 0,
    "class_name": "XStream",
    "subclass_name": null,
    "function_name": "denyTypeHierarchy(Class type)",
    "function_body": "{\n        denyPermission(new TypeHierarchyPermission(type));\n    }"
  },
  {
    "id": 75,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 110,
    "human_patch": "https://github.com/x-stream/xstream/commit/f38a1da3ae9491930c2067c12cd2506738b21dab",
    "cve_id": "CVE-2019-10173",
    "cwe_id": "CWE-502",
    "filename": "xstream/src/java/com/thoughtworks/xstream/XStream.java",
    "is_vulnerable": 0,
    "class_name": "XStream",
    "subclass_name": null,
    "function_name": "denyTypesByRegExp(String[] regexps)",
    "function_body": "{\n        denyPermission(new RegExpTypePermission(regexps));\n    }"
  },
  {
    "id": 75,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 111,
    "human_patch": "https://github.com/x-stream/xstream/commit/f38a1da3ae9491930c2067c12cd2506738b21dab",
    "cve_id": "CVE-2019-10173",
    "cwe_id": "CWE-502",
    "filename": "xstream/src/java/com/thoughtworks/xstream/XStream.java",
    "is_vulnerable": 0,
    "class_name": "XStream",
    "subclass_name": null,
    "function_name": "denyTypesByRegExp(Pattern[] regexps)",
    "function_body": "{\n        denyPermission(new RegExpTypePermission(regexps));\n    }"
  },
  {
    "id": 75,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 112,
    "human_patch": "https://github.com/x-stream/xstream/commit/f38a1da3ae9491930c2067c12cd2506738b21dab",
    "cve_id": "CVE-2019-10173",
    "cwe_id": "CWE-502",
    "filename": "xstream/src/java/com/thoughtworks/xstream/XStream.java",
    "is_vulnerable": 0,
    "class_name": "XStream",
    "subclass_name": null,
    "function_name": "denyTypesByWildcard(String[] patterns)",
    "function_body": "{\n        denyPermission(new WildcardTypePermission(patterns));\n    }"
  },
  {
    "id": 75,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 113,
    "human_patch": "https://github.com/x-stream/xstream/commit/f38a1da3ae9491930c2067c12cd2506738b21dab",
    "cve_id": "CVE-2019-10173",
    "cwe_id": "CWE-502",
    "filename": "xstream/src/java/com/thoughtworks/xstream/XStream.java",
    "is_vulnerable": 1,
    "class_name": "XStream",
    "subclass_name": "InternalBlackList",
    "function_name": "canConvert(final Class type)",
    "function_body": "{\n            return (type == void.class || type == Void.class)\n                || (insecureWarning\n                    && type != null\n                    && (type.getName().equals(\"java.beans.EventHandler\")\n                        || type.getName().endsWith(\"$LazyIterator\")\n                        || type.getName().startsWith(\"javax.crypto.\")));\n        }"
  },
  {
    "id": 75,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 114,
    "human_patch": "https://github.com/x-stream/xstream/commit/f38a1da3ae9491930c2067c12cd2506738b21dab",
    "cve_id": "CVE-2019-10173",
    "cwe_id": "CWE-502",
    "filename": "xstream/src/java/com/thoughtworks/xstream/XStream.java",
    "is_vulnerable": 0,
    "class_name": "XStream",
    "subclass_name": "InternalBlackList",
    "function_name": "marshal(final Object source, final HierarchicalStreamWriter writer,\n                final MarshallingContext context)",
    "function_body": "{\n            throw new ConversionException(\"Security alert. Marshalling rejected.\");\n        }"
  },
  {
    "id": 75,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 115,
    "human_patch": "https://github.com/x-stream/xstream/commit/f38a1da3ae9491930c2067c12cd2506738b21dab",
    "cve_id": "CVE-2019-10173",
    "cwe_id": "CWE-502",
    "filename": "xstream/src/java/com/thoughtworks/xstream/XStream.java",
    "is_vulnerable": 0,
    "class_name": "XStream",
    "subclass_name": "InternalBlackList",
    "function_name": "unmarshal(final HierarchicalStreamReader reader, final UnmarshallingContext context)",
    "function_body": "{\n            throw new ConversionException(\"Security alert. Unmarshalling rejected.\");\n        }"
  },
  {
    "id": 75,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 0,
    "human_patch": "https://github.com/x-stream/xstream/commit/f38a1da3ae9491930c2067c12cd2506738b21dab",
    "cve_id": "CVE-2019-10173",
    "cwe_id": "CWE-502",
    "filename": "xstream/src/test/com/thoughtworks/acceptance/SecurityVulnerabilityTest.java",
    "is_vulnerable": 0,
    "class_name": "SecurityVulnerabilityTest",
    "subclass_name": null,
    "function_name": "setUp() throws Exception",
    "function_body": "{\n        super.setUp();\n        BUFFER.setLength(0);\n        xstream.alias(\"runnable\", Runnable.class);\n        xstream.allowTypeHierarchy(Runnable.class);\n        xstream.addPermission(ProxyTypePermission.PROXIES);\n    }"
  },
  {
    "id": 75,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 1,
    "human_patch": "https://github.com/x-stream/xstream/commit/f38a1da3ae9491930c2067c12cd2506738b21dab",
    "cve_id": "CVE-2019-10173",
    "cwe_id": "CWE-502",
    "filename": "xstream/src/test/com/thoughtworks/acceptance/SecurityVulnerabilityTest.java",
    "is_vulnerable": 0,
    "class_name": "SecurityVulnerabilityTest",
    "subclass_name": null,
    "function_name": "testCannotInjectEventHandler()",
    "function_body": "{\n        final String xml = \"\"\n                + \"<string class='runnable-array'>\\n\"\n                + \"  <dynamic-proxy>\\n\"\n                + \"    <interface>java.lang.Runnable</interface>\\n\"\n                + \"    <handler class='java.beans.EventHandler'>\\n\"\n                + \"      <target class='com.thoughtworks.acceptance.SecurityVulnerabilityTest$Exec'/>\\n\"\n                + \"      <action>exec</action>\\n\"\n                + \"    </handler>\\n\"\n                + \"  </dynamic-proxy>\\n\"\n                + \"</string>\";\n\n        try {\n            xstream.fromXML(xml);\n            fail(\"Thrown \" + XStreamException.class.getName() + \" expected\");\n        } catch (final XStreamException e) {\n            assertTrue(e.getMessage().indexOf(EventHandler.class.getName()) > 0);\n        }\n        assertEquals(0, BUFFER.length());\n    }"
  },
  {
    "id": 75,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 2,
    "human_patch": "https://github.com/x-stream/xstream/commit/f38a1da3ae9491930c2067c12cd2506738b21dab",
    "cve_id": "CVE-2019-10173",
    "cwe_id": "CWE-502",
    "filename": "xstream/src/test/com/thoughtworks/acceptance/SecurityVulnerabilityTest.java",
    "is_vulnerable": 0,
    "class_name": "SecurityVulnerabilityTest",
    "subclass_name": null,
    "function_name": "testExplicitlyConvertEventHandler()",
    "function_body": "{\n        final String xml = \"\"\n                + \"<string class='runnable-array'>\\n\"\n                + \"  <dynamic-proxy>\\n\"\n                + \"    <interface>java.lang.Runnable</interface>\\n\"\n                + \"    <handler class='java.beans.EventHandler'>\\n\"\n                + \"      <target class='com.thoughtworks.acceptance.SecurityVulnerabilityTest$Exec'/>\\n\"\n                + \"      <action>exec</action>\\n\"\n                + \"    </handler>\\n\"\n                + \"  </dynamic-proxy>\\n\"\n                + \"</string>\";\n\n        xstream.allowTypes(new Class[]{EventHandler.class});\n        xstream.registerConverter(new ReflectionConverter(xstream.getMapper(), xstream\n            .getReflectionProvider(), EventHandler.class));\n\n        final Runnable[] array = (Runnable[])xstream.fromXML(xml);\n        assertEquals(0, BUFFER.length());\n        array[0].run();\n        assertEquals(\"Executed!\", BUFFER.toString());\n    }"
  },
  {
    "id": 75,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 3,
    "human_patch": "https://github.com/x-stream/xstream/commit/f38a1da3ae9491930c2067c12cd2506738b21dab",
    "cve_id": "CVE-2019-10173",
    "cwe_id": "CWE-502",
    "filename": "xstream/src/test/com/thoughtworks/acceptance/SecurityVulnerabilityTest.java",
    "is_vulnerable": 0,
    "class_name": "SecurityVulnerabilityTest",
    "subclass_name": "Exec",
    "function_name": "exec()",
    "function_body": "{\n            BUFFER.append(\"Executed!\");\n        }"
  },
  {
    "id": 75,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 4,
    "human_patch": "https://github.com/x-stream/xstream/commit/f38a1da3ae9491930c2067c12cd2506738b21dab",
    "cve_id": "CVE-2019-10173",
    "cwe_id": "CWE-502",
    "filename": "xstream/src/test/com/thoughtworks/acceptance/SecurityVulnerabilityTest.java",
    "is_vulnerable": 0,
    "class_name": "SecurityVulnerabilityTest",
    "subclass_name": null,
    "function_name": "testDeniedInstanceOfVoid()",
    "function_body": "{\n        try {\n            xstream.fromXML(\"<void/>\");\n            fail(\"Thrown \" + ForbiddenClassException.class.getName() + \" expected\");\n        } catch (final ForbiddenClassException e) {\n            \n        }\n    }"
  },
  {
    "id": 75,
    "sub_id": 1,
    "code_id": 0,
    "function_id": 5,
    "human_patch": "https://github.com/x-stream/xstream/commit/f38a1da3ae9491930c2067c12cd2506738b21dab",
    "cve_id": "CVE-2019-10173",
    "cwe_id": "CWE-502",
    "filename": "xstream/src/test/com/thoughtworks/acceptance/SecurityVulnerabilityTest.java",
    "is_vulnerable": 0,
    "class_name": "SecurityVulnerabilityTest",
    "subclass_name": null,
    "function_name": "testAllowedInstanceOfVoid()",
    "function_body": "{\n        xstream.allowTypes(new Class[] { void.class, Void.class });\n        try {\n            xstream.fromXML(\"<void/>\");\n            fail(\"Thrown \" + ConversionException.class.getName() + \" expected\");\n        } catch (final ConversionException e) {\n            assertEquals(\"void\", e.get(\"required-type\"));\n        }\n    }"
  },
  {
    "id": 76,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 0,
    "human_patch": "https://github.com/zeroturnaround/zt-zip/commit/759b72f33bc8f4d69f84f09fcb7f010ad45d6fff",
    "cve_id": "CVE-2018-1002201",
    "cwe_id": "CWE-22",
    "filename": "src/main/java/org/zeroturnaround/zip/ZipUtil.java",
    "is_vulnerable": 0,
    "class_name": "ZipUtil",
    "subclass_name": null,
    "function_name": "containsEntry(File zip, String name)",
    "function_body": "{\n    ZipFile zf = null;\n    try {\n      zf = new ZipFile(zip);\n      return zf.getEntry(name) != null;\n    }\n    catch (IOException e) {\n      throw ZipExceptionUtil.rethrow(e);\n    }\n    finally {\n      closeQuietly(zf);\n    }\n  }"
  },
  {
    "id": 76,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 1,
    "human_patch": "https://github.com/zeroturnaround/zt-zip/commit/759b72f33bc8f4d69f84f09fcb7f010ad45d6fff",
    "cve_id": "CVE-2018-1002201",
    "cwe_id": "CWE-22",
    "filename": "src/main/java/org/zeroturnaround/zip/ZipUtil.java",
    "is_vulnerable": 0,
    "class_name": "ZipUtil",
    "subclass_name": null,
    "function_name": "getCompressionLevelOfEntry(File zip, String name)",
    "function_body": "{\n    return getCompressionMethodOfEntry(zip, name);\n  }"
  },
  {
    "id": 76,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 2,
    "human_patch": "https://github.com/zeroturnaround/zt-zip/commit/759b72f33bc8f4d69f84f09fcb7f010ad45d6fff",
    "cve_id": "CVE-2018-1002201",
    "cwe_id": "CWE-22",
    "filename": "src/main/java/org/zeroturnaround/zip/ZipUtil.java",
    "is_vulnerable": 0,
    "class_name": "ZipUtil",
    "subclass_name": null,
    "function_name": "getCompressionMethodOfEntry(File zip, String name)",
    "function_body": "{\n    ZipFile zf = null;\n    try {\n      zf = new ZipFile(zip);\n      ZipEntry zipEntry = zf.getEntry(name);\n      if (zipEntry == null) {\n        return -1;\n      }\n      return zipEntry.getMethod();\n    }\n    catch (IOException e) {\n      throw ZipExceptionUtil.rethrow(e);\n    }\n    finally {\n      closeQuietly(zf);\n    }\n  }"
  },
  {
    "id": 76,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 3,
    "human_patch": "https://github.com/zeroturnaround/zt-zip/commit/759b72f33bc8f4d69f84f09fcb7f010ad45d6fff",
    "cve_id": "CVE-2018-1002201",
    "cwe_id": "CWE-22",
    "filename": "src/main/java/org/zeroturnaround/zip/ZipUtil.java",
    "is_vulnerable": 0,
    "class_name": "ZipUtil",
    "subclass_name": null,
    "function_name": "containsAnyEntry(File zip, String[] names)",
    "function_body": "{\n    ZipFile zf = null;\n    try {\n      zf = new ZipFile(zip);\n      for (int i = 0; i < names.length; i++) {\n        if (zf.getEntry(names[i]) != null) {\n          return true;\n        }\n      }\n      return false;\n    }\n    catch (IOException e) {\n      throw ZipExceptionUtil.rethrow(e);\n    }\n    finally {\n      closeQuietly(zf);\n    }\n  }"
  },
  {
    "id": 76,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 4,
    "human_patch": "https://github.com/zeroturnaround/zt-zip/commit/759b72f33bc8f4d69f84f09fcb7f010ad45d6fff",
    "cve_id": "CVE-2018-1002201",
    "cwe_id": "CWE-22",
    "filename": "src/main/java/org/zeroturnaround/zip/ZipUtil.java",
    "is_vulnerable": 0,
    "class_name": "ZipUtil",
    "subclass_name": null,
    "function_name": "unpackEntry(File zip, String name)",
    "function_body": "{\n    ZipFile zf = null;\n    try {\n      zf = new ZipFile(zip);\n      return doUnpackEntry(zf, name);\n    }\n    catch (IOException e) {\n      throw ZipExceptionUtil.rethrow(e);\n    }\n    finally {\n      closeQuietly(zf);\n    }\n  }"
  },
  {
    "id": 76,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 5,
    "human_patch": "https://github.com/zeroturnaround/zt-zip/commit/759b72f33bc8f4d69f84f09fcb7f010ad45d6fff",
    "cve_id": "CVE-2018-1002201",
    "cwe_id": "CWE-22",
    "filename": "src/main/java/org/zeroturnaround/zip/ZipUtil.java",
    "is_vulnerable": 0,
    "class_name": "ZipUtil",
    "subclass_name": null,
    "function_name": "unpackEntry(File zip, String name, Charset charset)",
    "function_body": "{\n    ZipFile zf = null;\n    try {\n      if (charset != null) {\n        zf = new ZipFile(zip, charset);\n      }\n      else {\n        zf = new ZipFile(zip);\n      }\n      return doUnpackEntry(zf, name);\n    }\n    catch (IOException e) {\n      throw ZipExceptionUtil.rethrow(e);\n    }\n    finally {\n      closeQuietly(zf);\n    }\n  }"
  },
  {
    "id": 76,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 6,
    "human_patch": "https://github.com/zeroturnaround/zt-zip/commit/759b72f33bc8f4d69f84f09fcb7f010ad45d6fff",
    "cve_id": "CVE-2018-1002201",
    "cwe_id": "CWE-22",
    "filename": "src/main/java/org/zeroturnaround/zip/ZipUtil.java",
    "is_vulnerable": 0,
    "class_name": "ZipUtil",
    "subclass_name": null,
    "function_name": "unpackEntry(ZipFile zf, String name)",
    "function_body": "{\n    try {\n      return doUnpackEntry(zf, name);\n    }\n    catch (IOException e) {\n      throw ZipExceptionUtil.rethrow(e);\n    }\n  }"
  },
  {
    "id": 76,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 7,
    "human_patch": "https://github.com/zeroturnaround/zt-zip/commit/759b72f33bc8f4d69f84f09fcb7f010ad45d6fff",
    "cve_id": "CVE-2018-1002201",
    "cwe_id": "CWE-22",
    "filename": "src/main/java/org/zeroturnaround/zip/ZipUtil.java",
    "is_vulnerable": 0,
    "class_name": "ZipUtil",
    "subclass_name": null,
    "function_name": "doUnpackEntry(ZipFile zf, String name) throws IOException",
    "function_body": "{\n    ZipEntry ze = zf.getEntry(name);\n    if (ze == null) {\n      return null; \n    }\n\n    InputStream is = zf.getInputStream(ze);\n    try {\n      return IOUtils.toByteArray(is);\n    }\n    finally {\n      IOUtils.closeQuietly(is);\n    }\n  }"
  },
  {
    "id": 76,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 8,
    "human_patch": "https://github.com/zeroturnaround/zt-zip/commit/759b72f33bc8f4d69f84f09fcb7f010ad45d6fff",
    "cve_id": "CVE-2018-1002201",
    "cwe_id": "CWE-22",
    "filename": "src/main/java/org/zeroturnaround/zip/ZipUtil.java",
    "is_vulnerable": 0,
    "class_name": "ZipUtil",
    "subclass_name": null,
    "function_name": "unpackEntry(InputStream is, String name)",
    "function_body": "{\n    ByteArrayUnpacker action = new ByteArrayUnpacker();\n    if (!handle(is, name, action))\n      return null; \n    return action.getBytes();\n  }"
  },
  {
    "id": 76,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 9,
    "human_patch": "https://github.com/zeroturnaround/zt-zip/commit/759b72f33bc8f4d69f84f09fcb7f010ad45d6fff",
    "cve_id": "CVE-2018-1002201",
    "cwe_id": "CWE-22",
    "filename": "src/main/java/org/zeroturnaround/zip/ZipUtil.java",
    "is_vulnerable": 0,
    "class_name": "ZipUtil",
    "subclass_name": "ByteArrayUnpacker",
    "function_name": "process(InputStream in, ZipEntry zipEntry) throws IOException",
    "function_body": "{\n      bytes = IOUtils.toByteArray(in);\n    }"
  },
  {
    "id": 76,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 10,
    "human_patch": "https://github.com/zeroturnaround/zt-zip/commit/759b72f33bc8f4d69f84f09fcb7f010ad45d6fff",
    "cve_id": "CVE-2018-1002201",
    "cwe_id": "CWE-22",
    "filename": "src/main/java/org/zeroturnaround/zip/ZipUtil.java",
    "is_vulnerable": 0,
    "class_name": "ZipUtil",
    "subclass_name": "ByteArrayUnpacker",
    "function_name": "getBytes()",
    "function_body": "{\n      return bytes;\n    }"
  },
  {
    "id": 76,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 11,
    "human_patch": "https://github.com/zeroturnaround/zt-zip/commit/759b72f33bc8f4d69f84f09fcb7f010ad45d6fff",
    "cve_id": "CVE-2018-1002201",
    "cwe_id": "CWE-22",
    "filename": "src/main/java/org/zeroturnaround/zip/ZipUtil.java",
    "is_vulnerable": 0,
    "class_name": "ZipUtil",
    "subclass_name": null,
    "function_name": "unpackEntry(File zip, String name, File file)",
    "function_body": "{\n    return unpackEntry(zip, name, file, null);\n  }"
  },
  {
    "id": 76,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 12,
    "human_patch": "https://github.com/zeroturnaround/zt-zip/commit/759b72f33bc8f4d69f84f09fcb7f010ad45d6fff",
    "cve_id": "CVE-2018-1002201",
    "cwe_id": "CWE-22",
    "filename": "src/main/java/org/zeroturnaround/zip/ZipUtil.java",
    "is_vulnerable": 0,
    "class_name": "ZipUtil",
    "subclass_name": null,
    "function_name": "unpackEntry(File zip, String name, File file, Charset charset)",
    "function_body": "{\n    ZipFile zf = null;\n    try {\n      if (charset != null) {\n        zf = new ZipFile(zip, charset);\n      }\n      else {\n        zf = new ZipFile(zip);\n      }\n      return doUnpackEntry(zf, name, file);\n    }\n    catch (IOException e) {\n      throw ZipExceptionUtil.rethrow(e);\n    }\n    finally {\n      closeQuietly(zf);\n    }\n  }"
  },
  {
    "id": 76,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 13,
    "human_patch": "https://github.com/zeroturnaround/zt-zip/commit/759b72f33bc8f4d69f84f09fcb7f010ad45d6fff",
    "cve_id": "CVE-2018-1002201",
    "cwe_id": "CWE-22",
    "filename": "src/main/java/org/zeroturnaround/zip/ZipUtil.java",
    "is_vulnerable": 0,
    "class_name": "ZipUtil",
    "subclass_name": null,
    "function_name": "unpackEntry(ZipFile zf, String name, File file)",
    "function_body": "{\n    try {\n      return doUnpackEntry(zf, name, file);\n    }\n    catch (IOException e) {\n      throw ZipExceptionUtil.rethrow(e);\n    }\n  }"
  },
  {
    "id": 76,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 14,
    "human_patch": "https://github.com/zeroturnaround/zt-zip/commit/759b72f33bc8f4d69f84f09fcb7f010ad45d6fff",
    "cve_id": "CVE-2018-1002201",
    "cwe_id": "CWE-22",
    "filename": "src/main/java/org/zeroturnaround/zip/ZipUtil.java",
    "is_vulnerable": 0,
    "class_name": "ZipUtil",
    "subclass_name": null,
    "function_name": "doUnpackEntry(ZipFile zf, String name, File file) throws IOException",
    "function_body": "{\n    if (log.isTraceEnabled()) {\n      log.trace(\"Extracting '\" + zf.getName() + \"' entry '\" + name + \"' into '\" + file + \"'.\");\n    }\n\n    ZipEntry ze = zf.getEntry(name);\n    if (ze == null) {\n      return false; \n    }\n\n    if (ze.isDirectory() || zf.getInputStream(ze) == null) {\n      if (file.isDirectory()) {\n        return true;\n      }\n      if (file.exists()) {\n        FileUtils.forceDelete(file);\n      }\n      return file.mkdirs();\n    }\n\n    InputStream in = new BufferedInputStream(zf.getInputStream(ze));\n    try {\n      FileUtils.copy(in, file);\n    }\n    finally {\n      IOUtils.closeQuietly(in);\n    }\n    return true;\n  }"
  },
  {
    "id": 76,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 15,
    "human_patch": "https://github.com/zeroturnaround/zt-zip/commit/759b72f33bc8f4d69f84f09fcb7f010ad45d6fff",
    "cve_id": "CVE-2018-1002201",
    "cwe_id": "CWE-22",
    "filename": "src/main/java/org/zeroturnaround/zip/ZipUtil.java",
    "is_vulnerable": 0,
    "class_name": "ZipUtil",
    "subclass_name": null,
    "function_name": "unpackEntry(InputStream is, String name, File file) throws IOException",
    "function_body": "{\n    return handle(is, name, new FileUnpacker(file));\n  }"
  },
  {
    "id": 76,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 16,
    "human_patch": "https://github.com/zeroturnaround/zt-zip/commit/759b72f33bc8f4d69f84f09fcb7f010ad45d6fff",
    "cve_id": "CVE-2018-1002201",
    "cwe_id": "CWE-22",
    "filename": "src/main/java/org/zeroturnaround/zip/ZipUtil.java",
    "is_vulnerable": 0,
    "class_name": "ZipUtil",
    "subclass_name": "FileUnpacker",
    "function_name": "process(InputStream in, ZipEntry zipEntry) throws IOException",
    "function_body": "{\n      FileUtils.copy(in, file);\n    }"
  },
  {
    "id": 76,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 17,
    "human_patch": "https://github.com/zeroturnaround/zt-zip/commit/759b72f33bc8f4d69f84f09fcb7f010ad45d6fff",
    "cve_id": "CVE-2018-1002201",
    "cwe_id": "CWE-22",
    "filename": "src/main/java/org/zeroturnaround/zip/ZipUtil.java",
    "is_vulnerable": 0,
    "class_name": "ZipUtil",
    "subclass_name": null,
    "function_name": "iterate(File zip, ZipEntryCallback action)",
    "function_body": "{\n    iterate(zip, action, null);\n  }"
  },
  {
    "id": 76,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 18,
    "human_patch": "https://github.com/zeroturnaround/zt-zip/commit/759b72f33bc8f4d69f84f09fcb7f010ad45d6fff",
    "cve_id": "CVE-2018-1002201",
    "cwe_id": "CWE-22",
    "filename": "src/main/java/org/zeroturnaround/zip/ZipUtil.java",
    "is_vulnerable": 0,
    "class_name": "ZipUtil",
    "subclass_name": null,
    "function_name": "iterate(File zip, ZipEntryCallback action, Charset charset)",
    "function_body": "{\n    ZipFile zf = null;\n    try {\n      if (charset == null) {\n        zf = new ZipFile(zip);\n      }\n      else {\n        zf = new ZipFile(zip, charset);\n      }\n\n      Enumeration<? extends ZipEntry> en = zf.entries();\n      while (en.hasMoreElements()) {\n        ZipEntry e = (ZipEntry) en.nextElement();\n\n        InputStream is = zf.getInputStream(e);\n        try {\n          action.process(is, e);\n        }\n        catch (IOException ze) {\n          throw new ZipException(\"Failed to process zip entry '\" + e.getName() + \"' with action \" + action, ze);\n        }\n        catch (ZipBreakException ex) {\n          break;\n        }\n        finally {\n          IOUtils.closeQuietly(is);\n        }\n      }\n    }\n    catch (IOException e) {\n      throw ZipExceptionUtil.rethrow(e);\n    }\n    finally {\n      closeQuietly(zf);\n    }\n  }"
  },
  {
    "id": 76,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 19,
    "human_patch": "https://github.com/zeroturnaround/zt-zip/commit/759b72f33bc8f4d69f84f09fcb7f010ad45d6fff",
    "cve_id": "CVE-2018-1002201",
    "cwe_id": "CWE-22",
    "filename": "src/main/java/org/zeroturnaround/zip/ZipUtil.java",
    "is_vulnerable": 0,
    "class_name": "ZipUtil",
    "subclass_name": null,
    "function_name": "iterate(File zip, String[] entryNames, ZipEntryCallback action)",
    "function_body": "{\n    iterate(zip, entryNames, action, null);\n  }"
  },
  {
    "id": 76,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 20,
    "human_patch": "https://github.com/zeroturnaround/zt-zip/commit/759b72f33bc8f4d69f84f09fcb7f010ad45d6fff",
    "cve_id": "CVE-2018-1002201",
    "cwe_id": "CWE-22",
    "filename": "src/main/java/org/zeroturnaround/zip/ZipUtil.java",
    "is_vulnerable": 0,
    "class_name": "ZipUtil",
    "subclass_name": null,
    "function_name": "iterate(File zip, String[] entryNames, ZipEntryCallback action, Charset charset)",
    "function_body": "{\n    ZipFile zf = null;\n    try {\n      if (charset == null) {\n        zf = new ZipFile(zip);\n      }\n      else {\n        zf = new ZipFile(zip, charset);\n      }\n\n      for (int i = 0; i < entryNames.length; i++) {\n        ZipEntry e = zf.getEntry(entryNames[i]);\n        if (e == null) {\n          continue;\n        }\n        InputStream is = zf.getInputStream(e);\n        try {\n          action.process(is, e);\n        }\n        catch (IOException ze) {\n          throw new ZipException(\"Failed to process zip entry '\" + e.getName() + \" with action \" + action, ze);\n        }\n        catch (ZipBreakException ex) {\n          break;\n        }\n        finally {\n          IOUtils.closeQuietly(is);\n        }\n      }\n    }\n    catch (IOException e) {\n      throw ZipExceptionUtil.rethrow(e);\n    }\n    finally {\n      closeQuietly(zf);\n    }\n  }"
  },
  {
    "id": 76,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 21,
    "human_patch": "https://github.com/zeroturnaround/zt-zip/commit/759b72f33bc8f4d69f84f09fcb7f010ad45d6fff",
    "cve_id": "CVE-2018-1002201",
    "cwe_id": "CWE-22",
    "filename": "src/main/java/org/zeroturnaround/zip/ZipUtil.java",
    "is_vulnerable": 0,
    "class_name": "ZipUtil",
    "subclass_name": null,
    "function_name": "iterate(File zip, ZipInfoCallback action)",
    "function_body": "{\n    ZipFile zf = null;\n    try {\n      zf = new ZipFile(zip);\n\n      Enumeration<? extends ZipEntry> en = zf.entries();\n      while (en.hasMoreElements()) {\n        ZipEntry e = (ZipEntry) en.nextElement();\n        try {\n          action.process(e);\n        }\n        catch (IOException ze) {\n          throw new ZipException(\"Failed to process zip entry '\" + e.getName() + \" with action \" + action, ze);\n        }\n        catch (ZipBreakException ex) {\n          break;\n        }\n      }\n    }\n    catch (IOException e) {\n      throw ZipExceptionUtil.rethrow(e);\n    }\n    finally {\n      closeQuietly(zf);\n    }\n  }"
  },
  {
    "id": 76,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 22,
    "human_patch": "https://github.com/zeroturnaround/zt-zip/commit/759b72f33bc8f4d69f84f09fcb7f010ad45d6fff",
    "cve_id": "CVE-2018-1002201",
    "cwe_id": "CWE-22",
    "filename": "src/main/java/org/zeroturnaround/zip/ZipUtil.java",
    "is_vulnerable": 0,
    "class_name": "ZipUtil",
    "subclass_name": null,
    "function_name": "iterate(File zip, String[] entryNames, ZipInfoCallback action)",
    "function_body": "{\n    ZipFile zf = null;\n    try {\n      zf = new ZipFile(zip);\n\n      for (int i = 0; i < entryNames.length; i++) {\n        ZipEntry e = zf.getEntry(entryNames[i]);\n        if (e == null) {\n          continue;\n        }\n        try {\n          action.process(e);\n        }\n        catch (IOException ze) {\n          throw new ZipException(\"Failed to process zip entry '\" + e.getName() + \" with action \" + action, ze);\n        }\n        catch (ZipBreakException ex) {\n          break;\n        }\n      }\n    }\n    catch (IOException e) {\n      throw ZipExceptionUtil.rethrow(e);\n    }\n    finally {\n      closeQuietly(zf);\n    }\n  }"
  },
  {
    "id": 76,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 23,
    "human_patch": "https://github.com/zeroturnaround/zt-zip/commit/759b72f33bc8f4d69f84f09fcb7f010ad45d6fff",
    "cve_id": "CVE-2018-1002201",
    "cwe_id": "CWE-22",
    "filename": "src/main/java/org/zeroturnaround/zip/ZipUtil.java",
    "is_vulnerable": 0,
    "class_name": "ZipUtil",
    "subclass_name": null,
    "function_name": "iterate(InputStream is, ZipEntryCallback action, Charset charset)",
    "function_body": "{\n    try {\n      ZipInputStream in = null;\n      try {\n        in = newCloseShieldZipInputStream(is, charset);\n        ZipEntry entry;\n        while ((entry = in.getNextEntry()) != null) {\n          try {\n            action.process(in, entry);\n          }\n          catch (IOException ze) {\n            throw new ZipException(\"Failed to process zip entry '\" + entry.getName() + \" with action \" + action, ze);\n          }\n          catch (ZipBreakException ex) {\n            break;\n          }\n        }\n      }\n      finally {\n        if (in != null) {\n          in.close();\n        }\n      }\n    }\n    catch (IOException e) {\n      throw ZipExceptionUtil.rethrow(e);\n    }\n  }"
  },
  {
    "id": 76,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 24,
    "human_patch": "https://github.com/zeroturnaround/zt-zip/commit/759b72f33bc8f4d69f84f09fcb7f010ad45d6fff",
    "cve_id": "CVE-2018-1002201",
    "cwe_id": "CWE-22",
    "filename": "src/main/java/org/zeroturnaround/zip/ZipUtil.java",
    "is_vulnerable": 0,
    "class_name": "ZipUtil",
    "subclass_name": null,
    "function_name": "iterate(InputStream is, ZipEntryCallback action)",
    "function_body": "{\n    iterate(is, action, null);\n  }"
  },
  {
    "id": 76,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 25,
    "human_patch": "https://github.com/zeroturnaround/zt-zip/commit/759b72f33bc8f4d69f84f09fcb7f010ad45d6fff",
    "cve_id": "CVE-2018-1002201",
    "cwe_id": "CWE-22",
    "filename": "src/main/java/org/zeroturnaround/zip/ZipUtil.java",
    "is_vulnerable": 0,
    "class_name": "ZipUtil",
    "subclass_name": null,
    "function_name": "iterate(InputStream is, String[] entryNames, ZipEntryCallback action, Charset charset)",
    "function_body": "{\n    Set<String> namesSet = new HashSet<String>();\n    for (int i = 0; i < entryNames.length; i++) {\n      namesSet.add(entryNames[i]);\n    }\n    try {\n      ZipInputStream in = null;\n      try {\n        in = newCloseShieldZipInputStream(is, charset);\n        ZipEntry entry;\n        while ((entry = in.getNextEntry()) != null) {\n          if (!namesSet.contains(entry.getName())) {\n            \n            continue;\n          }\n          try {\n            action.process(in, entry);\n          }\n          catch (IOException ze) {\n            throw new ZipException(\"Failed to process zip entry '\" + entry.getName() + \" with action \" + action, ze);\n          }\n          catch (ZipBreakException ex) {\n            break;\n          }\n        }\n      }\n      finally {\n        if (in != null) {\n          in.close();\n        }\n      }\n    }\n    catch (IOException e) {\n      throw ZipExceptionUtil.rethrow(e);\n    }\n  }"
  },
  {
    "id": 76,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 26,
    "human_patch": "https://github.com/zeroturnaround/zt-zip/commit/759b72f33bc8f4d69f84f09fcb7f010ad45d6fff",
    "cve_id": "CVE-2018-1002201",
    "cwe_id": "CWE-22",
    "filename": "src/main/java/org/zeroturnaround/zip/ZipUtil.java",
    "is_vulnerable": 0,
    "class_name": "ZipUtil",
    "subclass_name": null,
    "function_name": "iterate(InputStream is, String[] entryNames, ZipEntryCallback action)",
    "function_body": "{\n    iterate(is, entryNames, action, null);\n  }"
  },
  {
    "id": 76,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 27,
    "human_patch": "https://github.com/zeroturnaround/zt-zip/commit/759b72f33bc8f4d69f84f09fcb7f010ad45d6fff",
    "cve_id": "CVE-2018-1002201",
    "cwe_id": "CWE-22",
    "filename": "src/main/java/org/zeroturnaround/zip/ZipUtil.java",
    "is_vulnerable": 0,
    "class_name": "ZipUtil",
    "subclass_name": null,
    "function_name": "newCloseShieldZipInputStream(final InputStream is, Charset charset)",
    "function_body": "{\n    InputStream in = new BufferedInputStream(new CloseShieldInputStream(is));\n    if (charset == null) {\n      return new ZipInputStream(in);\n    }\n    return ZipFileUtil.createZipInputStream(in, charset);\n  }"
  },
  {
    "id": 76,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 28,
    "human_patch": "https://github.com/zeroturnaround/zt-zip/commit/759b72f33bc8f4d69f84f09fcb7f010ad45d6fff",
    "cve_id": "CVE-2018-1002201",
    "cwe_id": "CWE-22",
    "filename": "src/main/java/org/zeroturnaround/zip/ZipUtil.java",
    "is_vulnerable": 0,
    "class_name": "ZipUtil",
    "subclass_name": null,
    "function_name": "handle(File zip, String name, ZipEntryCallback action)",
    "function_body": "{\n    ZipFile zf = null;\n    try {\n      zf = new ZipFile(zip);\n\n      ZipEntry ze = zf.getEntry(name);\n      if (ze == null) {\n        return false; \n      }\n\n      InputStream in = new BufferedInputStream(zf.getInputStream(ze));\n      try {\n        action.process(in, ze);\n      }\n      finally {\n        IOUtils.closeQuietly(in);\n      }\n      return true;\n    }\n    catch (IOException e) {\n      throw ZipExceptionUtil.rethrow(e);\n    }\n    finally {\n      closeQuietly(zf);\n    }\n  }"
  },
  {
    "id": 76,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 29,
    "human_patch": "https://github.com/zeroturnaround/zt-zip/commit/759b72f33bc8f4d69f84f09fcb7f010ad45d6fff",
    "cve_id": "CVE-2018-1002201",
    "cwe_id": "CWE-22",
    "filename": "src/main/java/org/zeroturnaround/zip/ZipUtil.java",
    "is_vulnerable": 0,
    "class_name": "ZipUtil",
    "subclass_name": null,
    "function_name": "handle(InputStream is, String name, ZipEntryCallback action)",
    "function_body": "{\n    SingleZipEntryCallback helper = new SingleZipEntryCallback(name, action);\n    iterate(is, helper);\n    return helper.found();\n  }"
  },
  {
    "id": 76,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 30,
    "human_patch": "https://github.com/zeroturnaround/zt-zip/commit/759b72f33bc8f4d69f84f09fcb7f010ad45d6fff",
    "cve_id": "CVE-2018-1002201",
    "cwe_id": "CWE-22",
    "filename": "src/main/java/org/zeroturnaround/zip/ZipUtil.java",
    "is_vulnerable": 0,
    "class_name": "ZipUtil",
    "subclass_name": "SingleZipEntryCallback",
    "function_name": "process(InputStream in, ZipEntry zipEntry) throws IOException",
    "function_body": "{\n      if (name.equals(zipEntry.getName())) {\n        found = true;\n        action.process(in, zipEntry);\n      }\n    }"
  },
  {
    "id": 76,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 31,
    "human_patch": "https://github.com/zeroturnaround/zt-zip/commit/759b72f33bc8f4d69f84f09fcb7f010ad45d6fff",
    "cve_id": "CVE-2018-1002201",
    "cwe_id": "CWE-22",
    "filename": "src/main/java/org/zeroturnaround/zip/ZipUtil.java",
    "is_vulnerable": 0,
    "class_name": "ZipUtil",
    "subclass_name": "SingleZipEntryCallback",
    "function_name": "found()",
    "function_body": "{\n      return found;\n    }"
  },
  {
    "id": 76,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 32,
    "human_patch": "https://github.com/zeroturnaround/zt-zip/commit/759b72f33bc8f4d69f84f09fcb7f010ad45d6fff",
    "cve_id": "CVE-2018-1002201",
    "cwe_id": "CWE-22",
    "filename": "src/main/java/org/zeroturnaround/zip/ZipUtil.java",
    "is_vulnerable": 0,
    "class_name": "ZipUtil",
    "subclass_name": null,
    "function_name": "unpack(File zip, final File outputDir)",
    "function_body": "{\n    unpack(zip, outputDir, IdentityNameMapper.INSTANCE);\n  }"
  },
  {
    "id": 76,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 33,
    "human_patch": "https://github.com/zeroturnaround/zt-zip/commit/759b72f33bc8f4d69f84f09fcb7f010ad45d6fff",
    "cve_id": "CVE-2018-1002201",
    "cwe_id": "CWE-22",
    "filename": "src/main/java/org/zeroturnaround/zip/ZipUtil.java",
    "is_vulnerable": 0,
    "class_name": "ZipUtil",
    "subclass_name": null,
    "function_name": "unpack(File zip, final File outputDir, Charset charset)",
    "function_body": "{\n    unpack(zip, outputDir, IdentityNameMapper.INSTANCE, charset);\n  }"
  },
  {
    "id": 76,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 34,
    "human_patch": "https://github.com/zeroturnaround/zt-zip/commit/759b72f33bc8f4d69f84f09fcb7f010ad45d6fff",
    "cve_id": "CVE-2018-1002201",
    "cwe_id": "CWE-22",
    "filename": "src/main/java/org/zeroturnaround/zip/ZipUtil.java",
    "is_vulnerable": 0,
    "class_name": "ZipUtil",
    "subclass_name": null,
    "function_name": "unpack(File zip, File outputDir, NameMapper mapper, Charset charset)",
    "function_body": "{\n    log.debug(\"Extracting '{}' into '{}'.\", zip, outputDir);\n    iterate(zip, new Unpacker(outputDir, mapper), charset);\n  }"
  },
  {
    "id": 76,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 35,
    "human_patch": "https://github.com/zeroturnaround/zt-zip/commit/759b72f33bc8f4d69f84f09fcb7f010ad45d6fff",
    "cve_id": "CVE-2018-1002201",
    "cwe_id": "CWE-22",
    "filename": "src/main/java/org/zeroturnaround/zip/ZipUtil.java",
    "is_vulnerable": 0,
    "class_name": "ZipUtil",
    "subclass_name": null,
    "function_name": "unpack(File zip, File outputDir, NameMapper mapper)",
    "function_body": "{\n    log.debug(\"Extracting '{}' into '{}'.\", zip, outputDir);\n    iterate(zip, new Unpacker(outputDir, mapper));\n  }"
  },
  {
    "id": 76,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 36,
    "human_patch": "https://github.com/zeroturnaround/zt-zip/commit/759b72f33bc8f4d69f84f09fcb7f010ad45d6fff",
    "cve_id": "CVE-2018-1002201",
    "cwe_id": "CWE-22",
    "filename": "src/main/java/org/zeroturnaround/zip/ZipUtil.java",
    "is_vulnerable": 0,
    "class_name": "ZipUtil",
    "subclass_name": null,
    "function_name": "unwrap(File zip, final File outputDir)",
    "function_body": "{\n    unwrap(zip, outputDir, IdentityNameMapper.INSTANCE);\n  }"
  },
  {
    "id": 76,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 37,
    "human_patch": "https://github.com/zeroturnaround/zt-zip/commit/759b72f33bc8f4d69f84f09fcb7f010ad45d6fff",
    "cve_id": "CVE-2018-1002201",
    "cwe_id": "CWE-22",
    "filename": "src/main/java/org/zeroturnaround/zip/ZipUtil.java",
    "is_vulnerable": 0,
    "class_name": "ZipUtil",
    "subclass_name": null,
    "function_name": "unwrap(File zip, File outputDir, NameMapper mapper)",
    "function_body": "{\n    log.debug(\"Unwrapping '{}' into '{}'.\", zip, outputDir);\n    iterate(zip, new Unwraper(outputDir, mapper));\n  }"
  },
  {
    "id": 76,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 38,
    "human_patch": "https://github.com/zeroturnaround/zt-zip/commit/759b72f33bc8f4d69f84f09fcb7f010ad45d6fff",
    "cve_id": "CVE-2018-1002201",
    "cwe_id": "CWE-22",
    "filename": "src/main/java/org/zeroturnaround/zip/ZipUtil.java",
    "is_vulnerable": 0,
    "class_name": "ZipUtil",
    "subclass_name": null,
    "function_name": "unpack(InputStream is, File outputDir)",
    "function_body": "{\n    unpack(is, outputDir, IdentityNameMapper.INSTANCE, null);\n  }"
  },
  {
    "id": 76,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 39,
    "human_patch": "https://github.com/zeroturnaround/zt-zip/commit/759b72f33bc8f4d69f84f09fcb7f010ad45d6fff",
    "cve_id": "CVE-2018-1002201",
    "cwe_id": "CWE-22",
    "filename": "src/main/java/org/zeroturnaround/zip/ZipUtil.java",
    "is_vulnerable": 0,
    "class_name": "ZipUtil",
    "subclass_name": null,
    "function_name": "unpack(InputStream is, File outputDir, Charset charset)",
    "function_body": "{\n    unpack(is, outputDir, IdentityNameMapper.INSTANCE, charset);\n  }"
  },
  {
    "id": 76,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 40,
    "human_patch": "https://github.com/zeroturnaround/zt-zip/commit/759b72f33bc8f4d69f84f09fcb7f010ad45d6fff",
    "cve_id": "CVE-2018-1002201",
    "cwe_id": "CWE-22",
    "filename": "src/main/java/org/zeroturnaround/zip/ZipUtil.java",
    "is_vulnerable": 0,
    "class_name": "ZipUtil",
    "subclass_name": null,
    "function_name": "unpack(InputStream is, File outputDir, NameMapper mapper)",
    "function_body": "{\n    unpack(is, outputDir, mapper, null);\n  }"
  },
  {
    "id": 76,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 41,
    "human_patch": "https://github.com/zeroturnaround/zt-zip/commit/759b72f33bc8f4d69f84f09fcb7f010ad45d6fff",
    "cve_id": "CVE-2018-1002201",
    "cwe_id": "CWE-22",
    "filename": "src/main/java/org/zeroturnaround/zip/ZipUtil.java",
    "is_vulnerable": 0,
    "class_name": "ZipUtil",
    "subclass_name": null,
    "function_name": "unpack(InputStream is, File outputDir, NameMapper mapper, Charset charset)",
    "function_body": "{\n    log.debug(\"Extracting {} into '{}'.\", is, outputDir);\n    iterate(is, new Unpacker(outputDir, mapper), charset);\n  }"
  },
  {
    "id": 76,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 42,
    "human_patch": "https://github.com/zeroturnaround/zt-zip/commit/759b72f33bc8f4d69f84f09fcb7f010ad45d6fff",
    "cve_id": "CVE-2018-1002201",
    "cwe_id": "CWE-22",
    "filename": "src/main/java/org/zeroturnaround/zip/ZipUtil.java",
    "is_vulnerable": 0,
    "class_name": "ZipUtil",
    "subclass_name": null,
    "function_name": "unwrap(InputStream is, File outputDir)",
    "function_body": "{\n    unwrap(is, outputDir, IdentityNameMapper.INSTANCE);\n  }"
  },
  {
    "id": 76,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 43,
    "human_patch": "https://github.com/zeroturnaround/zt-zip/commit/759b72f33bc8f4d69f84f09fcb7f010ad45d6fff",
    "cve_id": "CVE-2018-1002201",
    "cwe_id": "CWE-22",
    "filename": "src/main/java/org/zeroturnaround/zip/ZipUtil.java",
    "is_vulnerable": 0,
    "class_name": "ZipUtil",
    "subclass_name": null,
    "function_name": "unwrap(InputStream is, File outputDir, NameMapper mapper)",
    "function_body": "{\n    log.debug(\"Unwrapping {} into '{}'.\", is, outputDir);\n    iterate(is, new Unwraper(outputDir, mapper));\n  }"
  },
  {
    "id": 76,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 44,
    "human_patch": "https://github.com/zeroturnaround/zt-zip/commit/759b72f33bc8f4d69f84f09fcb7f010ad45d6fff",
    "cve_id": "CVE-2018-1002201",
    "cwe_id": "CWE-22",
    "filename": "src/main/java/org/zeroturnaround/zip/ZipUtil.java",
    "is_vulnerable": 1,
    "class_name": "ZipUtil",
    "subclass_name": "Unpacker",
    "function_name": "process(InputStream in, ZipEntry zipEntry) throws IOException",
    "function_body": "{\n      String name = mapper.map(zipEntry.getName());\n      if (name != null) {\n        File file = new File(outputDir, name);\n        if (zipEntry.isDirectory()) {\n          FileUtils.forceMkdir(file);\n        }\n        else {\n          FileUtils.forceMkdir(file.getParentFile());\n\n          if (log.isDebugEnabled() && file.exists()) {\n            log.debug(\"Overwriting file '{}'.\", zipEntry.getName());\n          }\n\n          FileUtils.copy(in, file);\n        }\n\n        ZTFilePermissions permissions = ZipEntryUtil.getZTFilePermissions(zipEntry);\n        if (permissions != null) {\n          ZTFilePermissionsUtil.getDefaultStategy().setPermissions(file, permissions);\n        }\n      }\n    }"
  },
  {
    "id": 76,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 45,
    "human_patch": "https://github.com/zeroturnaround/zt-zip/commit/759b72f33bc8f4d69f84f09fcb7f010ad45d6fff",
    "cve_id": "CVE-2018-1002201",
    "cwe_id": "CWE-22",
    "filename": "src/main/java/org/zeroturnaround/zip/ZipUtil.java",
    "is_vulnerable": 1,
    "class_name": "ZipUtil",
    "subclass_name": "BackslashUnpacker",
    "function_name": "process(InputStream in, ZipEntry zipEntry) throws IOException",
    "function_body": "{\n      String name = mapper.map(zipEntry.getName());\n      if (name != null) {\n        \n        if (name.indexOf('\\\\') != -1) {\n          File parentDirectory = outputDir;\n          String[] dirs = name.split(\"\\\\\\\\\");\n\n          \n          for (int i = 0; i < dirs.length - 1; i++) {\n            File file = new File(parentDirectory, dirs[i]);\n            if (!file.exists()) {\n              FileUtils.forceMkdir(file);\n            }\n            parentDirectory = file;\n          }\n          File destFile = new File(parentDirectory, dirs[dirs.length - 1]);\n          FileUtils.copy(in, destFile);\n        }\n        \n        else {\n          File destFile = new File(outputDir, name);\n          FileUtils.copy(in, destFile);\n        }\n      }\n    }"
  },
  {
    "id": 76,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 46,
    "human_patch": "https://github.com/zeroturnaround/zt-zip/commit/759b72f33bc8f4d69f84f09fcb7f010ad45d6fff",
    "cve_id": "CVE-2018-1002201",
    "cwe_id": "CWE-22",
    "filename": "src/main/java/org/zeroturnaround/zip/ZipUtil.java",
    "is_vulnerable": 1,
    "class_name": "ZipUtil",
    "subclass_name": "Unwraper",
    "function_name": "process(InputStream in, ZipEntry zipEntry) throws IOException",
    "function_body": "{\n      String root = getRootName(zipEntry.getName());\n      if (rootDir == null) {\n        rootDir = root;\n      }\n      else if (!rootDir.equals(root)) {\n        throw new ZipException(\"Unwrapping with multiple roots is not supported, roots: \" + rootDir + \", \" + root);\n      }\n\n      String name = mapper.map(getUnrootedName(root, zipEntry.getName()));\n      if (name != null) {\n        File file = new File(outputDir, name);\n        if (zipEntry.isDirectory()) {\n          FileUtils.forceMkdir(file);\n        }\n        else {\n          FileUtils.forceMkdir(file.getParentFile());\n\n          if (log.isDebugEnabled() && file.exists()) {\n            log.debug(\"Overwriting file '{}'.\", zipEntry.getName());\n          }\n\n          FileUtils.copy(in, file);\n        }\n      }\n    }"
  },
  {
    "id": 76,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 47,
    "human_patch": "https://github.com/zeroturnaround/zt-zip/commit/759b72f33bc8f4d69f84f09fcb7f010ad45d6fff",
    "cve_id": "CVE-2018-1002201",
    "cwe_id": "CWE-22",
    "filename": "src/main/java/org/zeroturnaround/zip/ZipUtil.java",
    "is_vulnerable": 0,
    "class_name": "ZipUtil",
    "subclass_name": "Unwraper",
    "function_name": "getUnrootedName(String root, String name)",
    "function_body": "{\n      return name.substring(root.length());\n    }"
  },
  {
    "id": 76,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 48,
    "human_patch": "https://github.com/zeroturnaround/zt-zip/commit/759b72f33bc8f4d69f84f09fcb7f010ad45d6fff",
    "cve_id": "CVE-2018-1002201",
    "cwe_id": "CWE-22",
    "filename": "src/main/java/org/zeroturnaround/zip/ZipUtil.java",
    "is_vulnerable": 0,
    "class_name": "ZipUtil",
    "subclass_name": "Unwraper",
    "function_name": "getRootName(final String name)",
    "function_body": "{\n      String newName = name.substring(FilenameUtils.getPrefixLength(name));\n      int idx = newName.indexOf(PATH_SEPARATOR);\n      if (idx < 0) {\n        throw new ZipException(\"Entry \" + newName + \" from the root of the zip is not supported\");\n      }\n      return newName.substring(0, newName.indexOf(PATH_SEPARATOR));\n    }"
  },
  {
    "id": 76,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 49,
    "human_patch": "https://github.com/zeroturnaround/zt-zip/commit/759b72f33bc8f4d69f84f09fcb7f010ad45d6fff",
    "cve_id": "CVE-2018-1002201",
    "cwe_id": "CWE-22",
    "filename": "src/main/java/org/zeroturnaround/zip/ZipUtil.java",
    "is_vulnerable": 0,
    "class_name": "ZipUtil",
    "subclass_name": null,
    "function_name": "explode(File zip)",
    "function_body": "{\n    try {\n      \n      File tempFile = FileUtils.getTempFileFor(zip);\n\n      \n      FileUtils.moveFile(zip, tempFile);\n\n      \n      unpack(tempFile, zip);\n\n      \n      if (!tempFile.delete()) {\n        throw new IOException(\"Unable to delete file: \" + tempFile);\n      }\n    }\n    catch (IOException e) {\n      throw ZipExceptionUtil.rethrow(e);\n    }\n  }"
  },
  {
    "id": 76,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 50,
    "human_patch": "https://github.com/zeroturnaround/zt-zip/commit/759b72f33bc8f4d69f84f09fcb7f010ad45d6fff",
    "cve_id": "CVE-2018-1002201",
    "cwe_id": "CWE-22",
    "filename": "src/main/java/org/zeroturnaround/zip/ZipUtil.java",
    "is_vulnerable": 0,
    "class_name": "ZipUtil",
    "subclass_name": null,
    "function_name": "packEntry(File file)",
    "function_body": "{\n    log.trace(\"Compressing '{}' into a ZIP file with single entry.\", file);\n\n    ByteArrayOutputStream result = new ByteArrayOutputStream();\n    try {\n      ZipOutputStream out = new ZipOutputStream(result);\n      ZipEntry entry = ZipEntryUtil.fromFile(file.getName(), file);\n      InputStream in = new BufferedInputStream(new FileInputStream(file));\n      try {\n        ZipEntryUtil.addEntry(entry, in, out);\n      }\n      finally {\n        IOUtils.closeQuietly(in);\n      }\n      out.close();\n    }\n    catch (IOException e) {\n      throw ZipExceptionUtil.rethrow(e);\n    }\n    return result.toByteArray();\n  }"
  },
  {
    "id": 76,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 51,
    "human_patch": "https://github.com/zeroturnaround/zt-zip/commit/759b72f33bc8f4d69f84f09fcb7f010ad45d6fff",
    "cve_id": "CVE-2018-1002201",
    "cwe_id": "CWE-22",
    "filename": "src/main/java/org/zeroturnaround/zip/ZipUtil.java",
    "is_vulnerable": 0,
    "class_name": "ZipUtil",
    "subclass_name": null,
    "function_name": "pack(File rootDir, File zip)",
    "function_body": "{\n    pack(rootDir, zip, DEFAULT_COMPRESSION_LEVEL);\n  }"
  },
  {
    "id": 76,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 52,
    "human_patch": "https://github.com/zeroturnaround/zt-zip/commit/759b72f33bc8f4d69f84f09fcb7f010ad45d6fff",
    "cve_id": "CVE-2018-1002201",
    "cwe_id": "CWE-22",
    "filename": "src/main/java/org/zeroturnaround/zip/ZipUtil.java",
    "is_vulnerable": 0,
    "class_name": "ZipUtil",
    "subclass_name": null,
    "function_name": "pack(File rootDir, File zip, int compressionLevel)",
    "function_body": "{\n    pack(rootDir, zip, IdentityNameMapper.INSTANCE, compressionLevel);\n  }"
  },
  {
    "id": 76,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 53,
    "human_patch": "https://github.com/zeroturnaround/zt-zip/commit/759b72f33bc8f4d69f84f09fcb7f010ad45d6fff",
    "cve_id": "CVE-2018-1002201",
    "cwe_id": "CWE-22",
    "filename": "src/main/java/org/zeroturnaround/zip/ZipUtil.java",
    "is_vulnerable": 0,
    "class_name": "ZipUtil",
    "subclass_name": null,
    "function_name": "pack(final File sourceDir, final File targetZipFile, final boolean preserveRoot)",
    "function_body": "{\n    if (preserveRoot) {\n      final String parentName = sourceDir.getName();\n      pack(sourceDir, targetZipFile, new NameMapper() {\n        public String map(String name) {\n          return parentName + PATH_SEPARATOR + name;\n        }\n      });\n    }\n    else {\n      pack(sourceDir, targetZipFile);\n    }\n  }"
  },
  {
    "id": 76,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 54,
    "human_patch": "https://github.com/zeroturnaround/zt-zip/commit/759b72f33bc8f4d69f84f09fcb7f010ad45d6fff",
    "cve_id": "CVE-2018-1002201",
    "cwe_id": "CWE-22",
    "filename": "src/main/java/org/zeroturnaround/zip/ZipUtil.java",
    "is_vulnerable": 0,
    "class_name": "ZipUtil",
    "subclass_name": null,
    "function_name": "map(String name)",
    "function_body": "{\n          return parentName + PATH_SEPARATOR + name;\n        }"
  },
  {
    "id": 76,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 55,
    "human_patch": "https://github.com/zeroturnaround/zt-zip/commit/759b72f33bc8f4d69f84f09fcb7f010ad45d6fff",
    "cve_id": "CVE-2018-1002201",
    "cwe_id": "CWE-22",
    "filename": "src/main/java/org/zeroturnaround/zip/ZipUtil.java",
    "is_vulnerable": 0,
    "class_name": "ZipUtil",
    "subclass_name": null,
    "function_name": "packEntry(File fileToPack, File destZipFile)",
    "function_body": "{\n    packEntry(fileToPack, destZipFile, IdentityNameMapper.INSTANCE);\n  }"
  },
  {
    "id": 76,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 56,
    "human_patch": "https://github.com/zeroturnaround/zt-zip/commit/759b72f33bc8f4d69f84f09fcb7f010ad45d6fff",
    "cve_id": "CVE-2018-1002201",
    "cwe_id": "CWE-22",
    "filename": "src/main/java/org/zeroturnaround/zip/ZipUtil.java",
    "is_vulnerable": 0,
    "class_name": "ZipUtil",
    "subclass_name": null,
    "function_name": "packEntry(File fileToPack, File destZipFile, final String fileName)",
    "function_body": "{\n    packEntry(fileToPack, destZipFile, new NameMapper() {\n      public String map(String name) {\n        return fileName;\n      }\n    });\n  }"
  },
  {
    "id": 76,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 57,
    "human_patch": "https://github.com/zeroturnaround/zt-zip/commit/759b72f33bc8f4d69f84f09fcb7f010ad45d6fff",
    "cve_id": "CVE-2018-1002201",
    "cwe_id": "CWE-22",
    "filename": "src/main/java/org/zeroturnaround/zip/ZipUtil.java",
    "is_vulnerable": 1,
    "class_name": "ZipUtil",
    "subclass_name": null,
    "function_name": "map(String name)",
    "function_body": "{\n        return fileName;\n      }"
  },
  {
    "id": 76,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 58,
    "human_patch": "https://github.com/zeroturnaround/zt-zip/commit/759b72f33bc8f4d69f84f09fcb7f010ad45d6fff",
    "cve_id": "CVE-2018-1002201",
    "cwe_id": "CWE-22",
    "filename": "src/main/java/org/zeroturnaround/zip/ZipUtil.java",
    "is_vulnerable": 0,
    "class_name": "ZipUtil",
    "subclass_name": null,
    "function_name": "packEntry(File fileToPack, File destZipFile, NameMapper mapper)",
    "function_body": "{\n    packEntries(new File[] { fileToPack }, destZipFile, mapper);\n  }"
  },
  {
    "id": 76,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 59,
    "human_patch": "https://github.com/zeroturnaround/zt-zip/commit/759b72f33bc8f4d69f84f09fcb7f010ad45d6fff",
    "cve_id": "CVE-2018-1002201",
    "cwe_id": "CWE-22",
    "filename": "src/main/java/org/zeroturnaround/zip/ZipUtil.java",
    "is_vulnerable": 0,
    "class_name": "ZipUtil",
    "subclass_name": null,
    "function_name": "packEntries(File[] filesToPack, File destZipFile)",
    "function_body": "{\n    packEntries(filesToPack, destZipFile, IdentityNameMapper.INSTANCE);\n  }"
  },
  {
    "id": 76,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 60,
    "human_patch": "https://github.com/zeroturnaround/zt-zip/commit/759b72f33bc8f4d69f84f09fcb7f010ad45d6fff",
    "cve_id": "CVE-2018-1002201",
    "cwe_id": "CWE-22",
    "filename": "src/main/java/org/zeroturnaround/zip/ZipUtil.java",
    "is_vulnerable": 0,
    "class_name": "ZipUtil",
    "subclass_name": null,
    "function_name": "packEntries(File[] filesToPack, File destZipFile, NameMapper mapper)",
    "function_body": "{\n    packEntries(filesToPack, destZipFile, mapper, DEFAULT_COMPRESSION_LEVEL);\n  }"
  },
  {
    "id": 76,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 61,
    "human_patch": "https://github.com/zeroturnaround/zt-zip/commit/759b72f33bc8f4d69f84f09fcb7f010ad45d6fff",
    "cve_id": "CVE-2018-1002201",
    "cwe_id": "CWE-22",
    "filename": "src/main/java/org/zeroturnaround/zip/ZipUtil.java",
    "is_vulnerable": 0,
    "class_name": "ZipUtil",
    "subclass_name": null,
    "function_name": "packEntries(File[] filesToPack, File destZipFile, int compressionLevel)",
    "function_body": "{\n    packEntries(filesToPack, destZipFile, IdentityNameMapper.INSTANCE, compressionLevel);\n  }"
  },
  {
    "id": 76,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 62,
    "human_patch": "https://github.com/zeroturnaround/zt-zip/commit/759b72f33bc8f4d69f84f09fcb7f010ad45d6fff",
    "cve_id": "CVE-2018-1002201",
    "cwe_id": "CWE-22",
    "filename": "src/main/java/org/zeroturnaround/zip/ZipUtil.java",
    "is_vulnerable": 0,
    "class_name": "ZipUtil",
    "subclass_name": null,
    "function_name": "packEntries(File[] filesToPack, File destZipFile, NameMapper mapper, int compressionLevel)",
    "function_body": "{\n    log.debug(\"Compressing '{}' into '{}'.\", filesToPack, destZipFile);\n\n    ZipOutputStream out = null;\n    FileOutputStream fos = null;\n    try {\n      fos = new FileOutputStream(destZipFile);\n      out = new ZipOutputStream(new BufferedOutputStream(fos));\n      out.setLevel(compressionLevel);\n\n      for (int i = 0; i < filesToPack.length; i++) {\n        File fileToPack = filesToPack[i];\n\n        ZipEntry zipEntry = ZipEntryUtil.fromFile(mapper.map(fileToPack.getName()), fileToPack);\n        out.putNextEntry(zipEntry);\n        FileUtils.copy(fileToPack, out);\n        out.closeEntry();\n      }\n    }\n    catch (IOException e) {\n      throw ZipExceptionUtil.rethrow(e);\n    }\n    finally {\n      IOUtils.closeQuietly(out);\n      IOUtils.closeQuietly(fos);\n    }\n  }"
  },
  {
    "id": 76,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 63,
    "human_patch": "https://github.com/zeroturnaround/zt-zip/commit/759b72f33bc8f4d69f84f09fcb7f010ad45d6fff",
    "cve_id": "CVE-2018-1002201",
    "cwe_id": "CWE-22",
    "filename": "src/main/java/org/zeroturnaround/zip/ZipUtil.java",
    "is_vulnerable": 0,
    "class_name": "ZipUtil",
    "subclass_name": null,
    "function_name": "pack(File sourceDir, File targetZip, NameMapper mapper)",
    "function_body": "{\n    pack(sourceDir, targetZip, mapper, DEFAULT_COMPRESSION_LEVEL);\n  }"
  },
  {
    "id": 76,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 64,
    "human_patch": "https://github.com/zeroturnaround/zt-zip/commit/759b72f33bc8f4d69f84f09fcb7f010ad45d6fff",
    "cve_id": "CVE-2018-1002201",
    "cwe_id": "CWE-22",
    "filename": "src/main/java/org/zeroturnaround/zip/ZipUtil.java",
    "is_vulnerable": 0,
    "class_name": "ZipUtil",
    "subclass_name": null,
    "function_name": "pack(File sourceDir, File targetZip, NameMapper mapper, int compressionLevel)",
    "function_body": "{\n    log.debug(\"Compressing '{}' into '{}'.\", sourceDir, targetZip);\n    if (!sourceDir.exists()) {\n      throw new ZipException(\"Given file '\" + sourceDir + \"' doesn't exist!\");\n    }\n    ZipOutputStream out = null;\n    try {\n      out = new ZipOutputStream(new BufferedOutputStream(new FileOutputStream(targetZip)));\n      out.setLevel(compressionLevel);\n      pack(sourceDir, out, mapper, \"\", true);\n    }\n    catch (IOException e) {\n      throw ZipExceptionUtil.rethrow(e);\n    }\n    finally {\n      IOUtils.closeQuietly(out);\n    }\n  }"
  },
  {
    "id": 76,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 65,
    "human_patch": "https://github.com/zeroturnaround/zt-zip/commit/759b72f33bc8f4d69f84f09fcb7f010ad45d6fff",
    "cve_id": "CVE-2018-1002201",
    "cwe_id": "CWE-22",
    "filename": "src/main/java/org/zeroturnaround/zip/ZipUtil.java",
    "is_vulnerable": 0,
    "class_name": "ZipUtil",
    "subclass_name": null,
    "function_name": "pack(File sourceDir, OutputStream os)",
    "function_body": "{\n    pack(sourceDir, os, IdentityNameMapper.INSTANCE, DEFAULT_COMPRESSION_LEVEL);\n  }"
  },
  {
    "id": 76,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 66,
    "human_patch": "https://github.com/zeroturnaround/zt-zip/commit/759b72f33bc8f4d69f84f09fcb7f010ad45d6fff",
    "cve_id": "CVE-2018-1002201",
    "cwe_id": "CWE-22",
    "filename": "src/main/java/org/zeroturnaround/zip/ZipUtil.java",
    "is_vulnerable": 0,
    "class_name": "ZipUtil",
    "subclass_name": null,
    "function_name": "pack(File sourceDir, OutputStream os, int compressionLevel)",
    "function_body": "{\n    pack(sourceDir, os, IdentityNameMapper.INSTANCE, compressionLevel);\n  }"
  },
  {
    "id": 76,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 67,
    "human_patch": "https://github.com/zeroturnaround/zt-zip/commit/759b72f33bc8f4d69f84f09fcb7f010ad45d6fff",
    "cve_id": "CVE-2018-1002201",
    "cwe_id": "CWE-22",
    "filename": "src/main/java/org/zeroturnaround/zip/ZipUtil.java",
    "is_vulnerable": 0,
    "class_name": "ZipUtil",
    "subclass_name": null,
    "function_name": "pack(File sourceDir, OutputStream os, NameMapper mapper)",
    "function_body": "{\n    pack(sourceDir, os, mapper, DEFAULT_COMPRESSION_LEVEL);\n  }"
  },
  {
    "id": 76,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 68,
    "human_patch": "https://github.com/zeroturnaround/zt-zip/commit/759b72f33bc8f4d69f84f09fcb7f010ad45d6fff",
    "cve_id": "CVE-2018-1002201",
    "cwe_id": "CWE-22",
    "filename": "src/main/java/org/zeroturnaround/zip/ZipUtil.java",
    "is_vulnerable": 0,
    "class_name": "ZipUtil",
    "subclass_name": null,
    "function_name": "pack(File sourceDir, OutputStream os, NameMapper mapper, int compressionLevel)",
    "function_body": "{\n    log.debug(\"Compressing '{}' into a stream.\", sourceDir);\n    if (!sourceDir.exists()) {\n      throw new ZipException(\"Given file '\" + sourceDir + \"' doesn't exist!\");\n    }\n    ZipOutputStream out = null;\n    IOException error = null;\n    try {\n      out = new ZipOutputStream(new BufferedOutputStream(os));\n      out.setLevel(compressionLevel);\n      pack(sourceDir, out, mapper, \"\", true);\n    }\n    catch (IOException e) {\n      error = e;\n    }\n    finally {\n      if (out != null && error == null) {\n        try {\n          out.finish();\n          out.flush();\n        }\n        catch (IOException e) {\n          error = e;\n        }\n      }\n    }\n    if (error != null) {\n      throw ZipExceptionUtil.rethrow(error);\n    }\n  }"
  },
  {
    "id": 76,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 69,
    "human_patch": "https://github.com/zeroturnaround/zt-zip/commit/759b72f33bc8f4d69f84f09fcb7f010ad45d6fff",
    "cve_id": "CVE-2018-1002201",
    "cwe_id": "CWE-22",
    "filename": "src/main/java/org/zeroturnaround/zip/ZipUtil.java",
    "is_vulnerable": 0,
    "class_name": "ZipUtil",
    "subclass_name": null,
    "function_name": "pack(File dir, ZipOutputStream out, NameMapper mapper, String pathPrefix, boolean mustHaveChildren) throws IOException",
    "function_body": "{\n    String[] filenames = dir.list();\n    if (filenames == null) {\n      if (!dir.exists()) {\n        throw new ZipException(\"Given file '\" + dir + \"' doesn't exist!\");\n      }\n      throw new IOException(\"Given file is not a directory '\" + dir + \"'\");\n    }\n\n    if (mustHaveChildren && filenames.length == 0) {\n      throw new ZipException(\"Given directory '\" + dir + \"' doesn't contain any files!\");\n    }\n\n    for (int i = 0; i < filenames.length; i++) {\n      String filename = filenames[i];\n      File file = new File(dir, filename);\n      boolean isDir = file.isDirectory();\n      String path = pathPrefix + file.getName(); \n      if (isDir) {\n        path += PATH_SEPARATOR; \n      }\n\n      \n      String name = mapper.map(path);\n      if (name != null) {\n        ZipEntry zipEntry = ZipEntryUtil.fromFile(name, file);\n\n        out.putNextEntry(zipEntry);\n\n        \n        if (!isDir) {\n          FileUtils.copy(file, out);\n        }\n\n        out.closeEntry();\n      }\n\n      \n      if (isDir) {\n        pack(file, out, mapper, path, false);\n      }\n    }\n  }"
  },
  {
    "id": 76,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 70,
    "human_patch": "https://github.com/zeroturnaround/zt-zip/commit/759b72f33bc8f4d69f84f09fcb7f010ad45d6fff",
    "cve_id": "CVE-2018-1002201",
    "cwe_id": "CWE-22",
    "filename": "src/main/java/org/zeroturnaround/zip/ZipUtil.java",
    "is_vulnerable": 0,
    "class_name": "ZipUtil",
    "subclass_name": null,
    "function_name": "repack(File srcZip, File dstZip, int compressionLevel)",
    "function_body": "{\n\n    log.debug(\"Repacking '{}' into '{}'.\", srcZip, dstZip);\n\n    RepackZipEntryCallback callback = new RepackZipEntryCallback(dstZip, compressionLevel);\n\n    try {\n      iterate(srcZip, callback);\n    }\n    finally {\n      callback.closeStream();\n    }\n  }"
  },
  {
    "id": 76,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 71,
    "human_patch": "https://github.com/zeroturnaround/zt-zip/commit/759b72f33bc8f4d69f84f09fcb7f010ad45d6fff",
    "cve_id": "CVE-2018-1002201",
    "cwe_id": "CWE-22",
    "filename": "src/main/java/org/zeroturnaround/zip/ZipUtil.java",
    "is_vulnerable": 0,
    "class_name": "ZipUtil",
    "subclass_name": null,
    "function_name": "repack(InputStream is, File dstZip, int compressionLevel)",
    "function_body": "{\n\n    log.debug(\"Repacking from input stream into '{}'.\", dstZip);\n\n    RepackZipEntryCallback callback = new RepackZipEntryCallback(dstZip, compressionLevel);\n\n    try {\n      iterate(is, callback);\n    }\n    finally {\n      callback.closeStream();\n    }\n  }"
  },
  {
    "id": 76,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 72,
    "human_patch": "https://github.com/zeroturnaround/zt-zip/commit/759b72f33bc8f4d69f84f09fcb7f010ad45d6fff",
    "cve_id": "CVE-2018-1002201",
    "cwe_id": "CWE-22",
    "filename": "src/main/java/org/zeroturnaround/zip/ZipUtil.java",
    "is_vulnerable": 0,
    "class_name": "ZipUtil",
    "subclass_name": null,
    "function_name": "repack(File zip, int compressionLevel)",
    "function_body": "{\n    try {\n      File tmpZip = FileUtils.getTempFileFor(zip);\n\n      repack(zip, tmpZip, compressionLevel);\n\n      \n      if (!zip.delete()) {\n        throw new IOException(\"Unable to delete the file: \" + zip);\n      }\n\n      \n      FileUtils.moveFile(tmpZip, zip);\n    }\n    catch (IOException e) {\n      throw ZipExceptionUtil.rethrow(e);\n    }\n  }"
  },
  {
    "id": 76,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 73,
    "human_patch": "https://github.com/zeroturnaround/zt-zip/commit/759b72f33bc8f4d69f84f09fcb7f010ad45d6fff",
    "cve_id": "CVE-2018-1002201",
    "cwe_id": "CWE-22",
    "filename": "src/main/java/org/zeroturnaround/zip/ZipUtil.java",
    "is_vulnerable": 0,
    "class_name": "ZipUtil",
    "subclass_name": "RepackZipEntryCallback",
    "function_name": "process(InputStream in, ZipEntry zipEntry) throws IOException",
    "function_body": "{\n      ZipEntryUtil.copyEntry(zipEntry, in, out);\n    }"
  },
  {
    "id": 76,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 74,
    "human_patch": "https://github.com/zeroturnaround/zt-zip/commit/759b72f33bc8f4d69f84f09fcb7f010ad45d6fff",
    "cve_id": "CVE-2018-1002201",
    "cwe_id": "CWE-22",
    "filename": "src/main/java/org/zeroturnaround/zip/ZipUtil.java",
    "is_vulnerable": 0,
    "class_name": "ZipUtil",
    "subclass_name": "RepackZipEntryCallback",
    "function_name": "closeStream()",
    "function_body": "{\n      IOUtils.closeQuietly(out);\n    }"
  },
  {
    "id": 76,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 75,
    "human_patch": "https://github.com/zeroturnaround/zt-zip/commit/759b72f33bc8f4d69f84f09fcb7f010ad45d6fff",
    "cve_id": "CVE-2018-1002201",
    "cwe_id": "CWE-22",
    "filename": "src/main/java/org/zeroturnaround/zip/ZipUtil.java",
    "is_vulnerable": 0,
    "class_name": "ZipUtil",
    "subclass_name": null,
    "function_name": "unexplode(File dir)",
    "function_body": "{\n    unexplode(dir, DEFAULT_COMPRESSION_LEVEL);\n  }"
  },
  {
    "id": 76,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 76,
    "human_patch": "https://github.com/zeroturnaround/zt-zip/commit/759b72f33bc8f4d69f84f09fcb7f010ad45d6fff",
    "cve_id": "CVE-2018-1002201",
    "cwe_id": "CWE-22",
    "filename": "src/main/java/org/zeroturnaround/zip/ZipUtil.java",
    "is_vulnerable": 0,
    "class_name": "ZipUtil",
    "subclass_name": null,
    "function_name": "unexplode(File dir, int compressionLevel)",
    "function_body": "{\n    try {\n      \n      File zip = FileUtils.getTempFileFor(dir);\n\n      \n      pack(dir, zip, compressionLevel);\n\n      \n      FileUtils.deleteDirectory(dir);\n\n      \n      FileUtils.moveFile(zip, dir);\n    }\n    catch (IOException e) {\n      throw ZipExceptionUtil.rethrow(e);\n    }\n  }"
  },
  {
    "id": 76,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 77,
    "human_patch": "https://github.com/zeroturnaround/zt-zip/commit/759b72f33bc8f4d69f84f09fcb7f010ad45d6fff",
    "cve_id": "CVE-2018-1002201",
    "cwe_id": "CWE-22",
    "filename": "src/main/java/org/zeroturnaround/zip/ZipUtil.java",
    "is_vulnerable": 0,
    "class_name": "ZipUtil",
    "subclass_name": null,
    "function_name": "pack(ZipEntrySource[] entries, OutputStream os)",
    "function_body": "{\n    if (log.isDebugEnabled()) {\n      log.debug(\"Creating stream from {}.\", Arrays.asList(entries));\n    }\n    pack(entries, os, false);\n  }"
  },
  {
    "id": 76,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 78,
    "human_patch": "https://github.com/zeroturnaround/zt-zip/commit/759b72f33bc8f4d69f84f09fcb7f010ad45d6fff",
    "cve_id": "CVE-2018-1002201",
    "cwe_id": "CWE-22",
    "filename": "src/main/java/org/zeroturnaround/zip/ZipUtil.java",
    "is_vulnerable": 0,
    "class_name": "ZipUtil",
    "subclass_name": null,
    "function_name": "pack(ZipEntrySource[] entries, OutputStream os, boolean closeStream)",
    "function_body": "{\n    try {\n      ZipOutputStream out = new ZipOutputStream(os);\n      for (int i = 0; i < entries.length; i++) {\n        addEntry(entries[i], out);\n      }\n      out.flush();\n      out.finish();\n      if (closeStream) {\n        out.close();\n      }\n    }\n    catch (IOException e) {\n      throw ZipExceptionUtil.rethrow(e);\n    }\n  }"
  },
  {
    "id": 76,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 79,
    "human_patch": "https://github.com/zeroturnaround/zt-zip/commit/759b72f33bc8f4d69f84f09fcb7f010ad45d6fff",
    "cve_id": "CVE-2018-1002201",
    "cwe_id": "CWE-22",
    "filename": "src/main/java/org/zeroturnaround/zip/ZipUtil.java",
    "is_vulnerable": 0,
    "class_name": "ZipUtil",
    "subclass_name": null,
    "function_name": "pack(ZipEntrySource[] entries, File zip)",
    "function_body": "{\n    if (log.isDebugEnabled()) {\n      log.debug(\"Creating '{}' from {}.\", zip, Arrays.asList(entries));\n    }\n\n    OutputStream out = null;\n    try {\n      out = new BufferedOutputStream(new FileOutputStream(zip));\n      pack(entries, out, true);\n    }\n    catch (IOException e) {\n      throw ZipExceptionUtil.rethrow(e);\n    }\n    finally {\n      IOUtils.closeQuietly(out);\n    }\n  }"
  },
  {
    "id": 76,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 80,
    "human_patch": "https://github.com/zeroturnaround/zt-zip/commit/759b72f33bc8f4d69f84f09fcb7f010ad45d6fff",
    "cve_id": "CVE-2018-1002201",
    "cwe_id": "CWE-22",
    "filename": "src/main/java/org/zeroturnaround/zip/ZipUtil.java",
    "is_vulnerable": 0,
    "class_name": "ZipUtil",
    "subclass_name": null,
    "function_name": "addEntry(File zip, String path, File file, File destZip)",
    "function_body": "{\n    addEntry(zip, new FileSource(path, file), destZip);\n  }"
  },
  {
    "id": 76,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 81,
    "human_patch": "https://github.com/zeroturnaround/zt-zip/commit/759b72f33bc8f4d69f84f09fcb7f010ad45d6fff",
    "cve_id": "CVE-2018-1002201",
    "cwe_id": "CWE-22",
    "filename": "src/main/java/org/zeroturnaround/zip/ZipUtil.java",
    "is_vulnerable": 0,
    "class_name": "ZipUtil",
    "subclass_name": null,
    "function_name": "addEntry(final File zip, final String path, final File file)",
    "function_body": "{\n    operateInPlace(zip, new InPlaceAction() {\n      public boolean act(File tmpFile) {\n        addEntry(zip, path, file, tmpFile);\n        return true;\n      }\n    });\n  }"
  },
  {
    "id": 76,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 82,
    "human_patch": "https://github.com/zeroturnaround/zt-zip/commit/759b72f33bc8f4d69f84f09fcb7f010ad45d6fff",
    "cve_id": "CVE-2018-1002201",
    "cwe_id": "CWE-22",
    "filename": "src/main/java/org/zeroturnaround/zip/ZipUtil.java",
    "is_vulnerable": 0,
    "class_name": "ZipUtil",
    "subclass_name": null,
    "function_name": "act(File tmpFile)",
    "function_body": "{\n        addEntry(zip, path, file, tmpFile);\n        return true;\n      }"
  },
  {
    "id": 76,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 83,
    "human_patch": "https://github.com/zeroturnaround/zt-zip/commit/759b72f33bc8f4d69f84f09fcb7f010ad45d6fff",
    "cve_id": "CVE-2018-1002201",
    "cwe_id": "CWE-22",
    "filename": "src/main/java/org/zeroturnaround/zip/ZipUtil.java",
    "is_vulnerable": 0,
    "class_name": "ZipUtil",
    "subclass_name": null,
    "function_name": "addEntry(File zip, String path, byte[] bytes, File destZip)",
    "function_body": "{\n    addEntry(zip, new ByteSource(path, bytes), destZip);\n  }"
  },
  {
    "id": 76,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 84,
    "human_patch": "https://github.com/zeroturnaround/zt-zip/commit/759b72f33bc8f4d69f84f09fcb7f010ad45d6fff",
    "cve_id": "CVE-2018-1002201",
    "cwe_id": "CWE-22",
    "filename": "src/main/java/org/zeroturnaround/zip/ZipUtil.java",
    "is_vulnerable": 0,
    "class_name": "ZipUtil",
    "subclass_name": null,
    "function_name": "addEntry(File zip, String path, byte[] bytes, File destZip, final int compressionMethod)",
    "function_body": "{\n    addEntry(zip, new ByteSource(path, bytes, compressionMethod), destZip);\n  }"
  },
  {
    "id": 76,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 85,
    "human_patch": "https://github.com/zeroturnaround/zt-zip/commit/759b72f33bc8f4d69f84f09fcb7f010ad45d6fff",
    "cve_id": "CVE-2018-1002201",
    "cwe_id": "CWE-22",
    "filename": "src/main/java/org/zeroturnaround/zip/ZipUtil.java",
    "is_vulnerable": 0,
    "class_name": "ZipUtil",
    "subclass_name": null,
    "function_name": "addEntry(final File zip, final String path, final byte[] bytes)",
    "function_body": "{\n    operateInPlace(zip, new InPlaceAction() {\n      public boolean act(File tmpFile) {\n        addEntry(zip, path, bytes, tmpFile);\n        return true;\n      }\n    });\n  }"
  },
  {
    "id": 76,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 86,
    "human_patch": "https://github.com/zeroturnaround/zt-zip/commit/759b72f33bc8f4d69f84f09fcb7f010ad45d6fff",
    "cve_id": "CVE-2018-1002201",
    "cwe_id": "CWE-22",
    "filename": "src/main/java/org/zeroturnaround/zip/ZipUtil.java",
    "is_vulnerable": 1,
    "class_name": "ZipUtil",
    "subclass_name": null,
    "function_name": "act(File tmpFile)",
    "function_body": "{\n        addEntry(zip, path, bytes, tmpFile);\n        return true;\n      }"
  },
  {
    "id": 76,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 87,
    "human_patch": "https://github.com/zeroturnaround/zt-zip/commit/759b72f33bc8f4d69f84f09fcb7f010ad45d6fff",
    "cve_id": "CVE-2018-1002201",
    "cwe_id": "CWE-22",
    "filename": "src/main/java/org/zeroturnaround/zip/ZipUtil.java",
    "is_vulnerable": 0,
    "class_name": "ZipUtil",
    "subclass_name": null,
    "function_name": "addEntry(final File zip, final String path, final byte[] bytes, final int compressionMethod)",
    "function_body": "{\n    operateInPlace(zip, new InPlaceAction() {\n      public boolean act(File tmpFile) {\n        addEntry(zip, path, bytes, tmpFile, compressionMethod);\n        return true;\n      }\n    });\n  }"
  },
  {
    "id": 76,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 88,
    "human_patch": "https://github.com/zeroturnaround/zt-zip/commit/759b72f33bc8f4d69f84f09fcb7f010ad45d6fff",
    "cve_id": "CVE-2018-1002201",
    "cwe_id": "CWE-22",
    "filename": "src/main/java/org/zeroturnaround/zip/ZipUtil.java",
    "is_vulnerable": 1,
    "class_name": "ZipUtil",
    "subclass_name": null,
    "function_name": "act(File tmpFile)",
    "function_body": "{\n        addEntry(zip, path, bytes, tmpFile, compressionMethod);\n        return true;\n      }"
  },
  {
    "id": 76,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 89,
    "human_patch": "https://github.com/zeroturnaround/zt-zip/commit/759b72f33bc8f4d69f84f09fcb7f010ad45d6fff",
    "cve_id": "CVE-2018-1002201",
    "cwe_id": "CWE-22",
    "filename": "src/main/java/org/zeroturnaround/zip/ZipUtil.java",
    "is_vulnerable": 0,
    "class_name": "ZipUtil",
    "subclass_name": null,
    "function_name": "addEntry(File zip, ZipEntrySource entry, File destZip)",
    "function_body": "{\n    addEntries(zip, new ZipEntrySource[] { entry }, destZip);\n  }"
  },
  {
    "id": 76,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 90,
    "human_patch": "https://github.com/zeroturnaround/zt-zip/commit/759b72f33bc8f4d69f84f09fcb7f010ad45d6fff",
    "cve_id": "CVE-2018-1002201",
    "cwe_id": "CWE-22",
    "filename": "src/main/java/org/zeroturnaround/zip/ZipUtil.java",
    "is_vulnerable": 0,
    "class_name": "ZipUtil",
    "subclass_name": null,
    "function_name": "addEntry(final File zip, final ZipEntrySource entry)",
    "function_body": "{\n    operateInPlace(zip, new InPlaceAction() {\n      public boolean act(File tmpFile) {\n        addEntry(zip, entry, tmpFile);\n        return true;\n      }\n    });\n  }"
  },
  {
    "id": 76,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 91,
    "human_patch": "https://github.com/zeroturnaround/zt-zip/commit/759b72f33bc8f4d69f84f09fcb7f010ad45d6fff",
    "cve_id": "CVE-2018-1002201",
    "cwe_id": "CWE-22",
    "filename": "src/main/java/org/zeroturnaround/zip/ZipUtil.java",
    "is_vulnerable": 1,
    "class_name": "ZipUtil",
    "subclass_name": null,
    "function_name": "act(File tmpFile)",
    "function_body": "{\n        addEntry(zip, entry, tmpFile);\n        return true;\n      }"
  },
  {
    "id": 76,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 92,
    "human_patch": "https://github.com/zeroturnaround/zt-zip/commit/759b72f33bc8f4d69f84f09fcb7f010ad45d6fff",
    "cve_id": "CVE-2018-1002201",
    "cwe_id": "CWE-22",
    "filename": "src/main/java/org/zeroturnaround/zip/ZipUtil.java",
    "is_vulnerable": 0,
    "class_name": "ZipUtil",
    "subclass_name": null,
    "function_name": "addEntries(File zip, ZipEntrySource[] entries, File destZip)",
    "function_body": "{\n    if (log.isDebugEnabled()) {\n      log.debug(\"Copying '\" + zip + \"' to '\" + destZip + \"' and adding \" + Arrays.asList(entries) + \".\");\n    }\n\n    OutputStream destOut = null;\n    try {\n      destOut = new BufferedOutputStream(new FileOutputStream(destZip));\n      addEntries(zip, entries, destOut);\n    }\n    catch (IOException e) {\n      ZipExceptionUtil.rethrow(e);\n    }\n    finally {\n      IOUtils.closeQuietly(destOut);\n    }\n  }"
  },
  {
    "id": 76,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 93,
    "human_patch": "https://github.com/zeroturnaround/zt-zip/commit/759b72f33bc8f4d69f84f09fcb7f010ad45d6fff",
    "cve_id": "CVE-2018-1002201",
    "cwe_id": "CWE-22",
    "filename": "src/main/java/org/zeroturnaround/zip/ZipUtil.java",
    "is_vulnerable": 0,
    "class_name": "ZipUtil",
    "subclass_name": null,
    "function_name": "addEntries(File zip, ZipEntrySource[] entries, OutputStream destOut)",
    "function_body": "{\n    if (log.isDebugEnabled()) {\n      log.debug(\"Copying '\" + zip + \"' to a stream and adding \" + Arrays.asList(entries) + \".\");\n    }\n\n    ZipOutputStream out = null;\n    try {\n      out = new ZipOutputStream(destOut);\n      copyEntries(zip, out);\n      for (int i = 0; i < entries.length; i++) {\n        addEntry(entries[i], out);\n      }\n      out.finish();\n    }\n    catch (IOException e) {\n      ZipExceptionUtil.rethrow(e);\n    }\n  }"
  },
  {
    "id": 76,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 94,
    "human_patch": "https://github.com/zeroturnaround/zt-zip/commit/759b72f33bc8f4d69f84f09fcb7f010ad45d6fff",
    "cve_id": "CVE-2018-1002201",
    "cwe_id": "CWE-22",
    "filename": "src/main/java/org/zeroturnaround/zip/ZipUtil.java",
    "is_vulnerable": 0,
    "class_name": "ZipUtil",
    "subclass_name": null,
    "function_name": "addEntries(InputStream is, ZipEntrySource[] entries, OutputStream destOut)",
    "function_body": "{\n    if (log.isDebugEnabled()) {\n      log.debug(\"Copying input stream to an output stream and adding \" + Arrays.asList(entries) + \".\");\n    }\n\n    ZipOutputStream out = null;\n    try {\n      out = new ZipOutputStream(destOut);\n      copyEntries(is, out);\n      for (int i = 0; i < entries.length; i++) {\n        addEntry(entries[i], out);\n      }\n      out.finish();\n    }\n    catch (IOException e) {\n      ZipExceptionUtil.rethrow(e);\n    }\n  }"
  },
  {
    "id": 76,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 95,
    "human_patch": "https://github.com/zeroturnaround/zt-zip/commit/759b72f33bc8f4d69f84f09fcb7f010ad45d6fff",
    "cve_id": "CVE-2018-1002201",
    "cwe_id": "CWE-22",
    "filename": "src/main/java/org/zeroturnaround/zip/ZipUtil.java",
    "is_vulnerable": 0,
    "class_name": "ZipUtil",
    "subclass_name": null,
    "function_name": "addEntries(final File zip, final ZipEntrySource[] entries)",
    "function_body": "{\n    operateInPlace(zip, new InPlaceAction() {\n      public boolean act(File tmpFile) {\n        addEntries(zip, entries, tmpFile);\n        return true;\n      }\n    });\n  }"
  },
  {
    "id": 76,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 96,
    "human_patch": "https://github.com/zeroturnaround/zt-zip/commit/759b72f33bc8f4d69f84f09fcb7f010ad45d6fff",
    "cve_id": "CVE-2018-1002201",
    "cwe_id": "CWE-22",
    "filename": "src/main/java/org/zeroturnaround/zip/ZipUtil.java",
    "is_vulnerable": 1,
    "class_name": "ZipUtil",
    "subclass_name": null,
    "function_name": "act(File tmpFile)",
    "function_body": "{\n        addEntries(zip, entries, tmpFile);\n        return true;\n      }"
  },
  {
    "id": 76,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 97,
    "human_patch": "https://github.com/zeroturnaround/zt-zip/commit/759b72f33bc8f4d69f84f09fcb7f010ad45d6fff",
    "cve_id": "CVE-2018-1002201",
    "cwe_id": "CWE-22",
    "filename": "src/main/java/org/zeroturnaround/zip/ZipUtil.java",
    "is_vulnerable": 0,
    "class_name": "ZipUtil",
    "subclass_name": null,
    "function_name": "removeEntry(File zip, String path, File destZip)",
    "function_body": "{\n    removeEntries(zip, new String[] { path }, destZip);\n  }"
  },
  {
    "id": 76,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 98,
    "human_patch": "https://github.com/zeroturnaround/zt-zip/commit/759b72f33bc8f4d69f84f09fcb7f010ad45d6fff",
    "cve_id": "CVE-2018-1002201",
    "cwe_id": "CWE-22",
    "filename": "src/main/java/org/zeroturnaround/zip/ZipUtil.java",
    "is_vulnerable": 0,
    "class_name": "ZipUtil",
    "subclass_name": null,
    "function_name": "removeEntry(final File zip, final String path)",
    "function_body": "{\n    operateInPlace(zip, new InPlaceAction() {\n      public boolean act(File tmpFile) {\n        removeEntry(zip, path, tmpFile);\n        return true;\n      }\n    });\n  }"
  },
  {
    "id": 76,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 99,
    "human_patch": "https://github.com/zeroturnaround/zt-zip/commit/759b72f33bc8f4d69f84f09fcb7f010ad45d6fff",
    "cve_id": "CVE-2018-1002201",
    "cwe_id": "CWE-22",
    "filename": "src/main/java/org/zeroturnaround/zip/ZipUtil.java",
    "is_vulnerable": 1,
    "class_name": "ZipUtil",
    "subclass_name": null,
    "function_name": "act(File tmpFile)",
    "function_body": "{\n        removeEntry(zip, path, tmpFile);\n        return true;\n      }"
  },
  {
    "id": 76,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 100,
    "human_patch": "https://github.com/zeroturnaround/zt-zip/commit/759b72f33bc8f4d69f84f09fcb7f010ad45d6fff",
    "cve_id": "CVE-2018-1002201",
    "cwe_id": "CWE-22",
    "filename": "src/main/java/org/zeroturnaround/zip/ZipUtil.java",
    "is_vulnerable": 0,
    "class_name": "ZipUtil",
    "subclass_name": null,
    "function_name": "removeEntries(File zip, String[] paths, File destZip)",
    "function_body": "{\n    if (log.isDebugEnabled()) {\n      log.debug(\"Copying '\" + zip + \"' to '\" + destZip + \"' and removing paths \" + Arrays.asList(paths) + \".\");\n    }\n\n    ZipOutputStream out = null;\n    try {\n      out = new ZipOutputStream(new BufferedOutputStream(new FileOutputStream(destZip)));\n      copyEntries(zip, out, new HashSet<String>(Arrays.asList(paths)));\n    }\n    catch (IOException e) {\n      throw ZipExceptionUtil.rethrow(e);\n    }\n    finally {\n      IOUtils.closeQuietly(out);\n    }\n  }"
  },
  {
    "id": 76,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 101,
    "human_patch": "https://github.com/zeroturnaround/zt-zip/commit/759b72f33bc8f4d69f84f09fcb7f010ad45d6fff",
    "cve_id": "CVE-2018-1002201",
    "cwe_id": "CWE-22",
    "filename": "src/main/java/org/zeroturnaround/zip/ZipUtil.java",
    "is_vulnerable": 0,
    "class_name": "ZipUtil",
    "subclass_name": null,
    "function_name": "removeEntries(final File zip, final String[] paths)",
    "function_body": "{\n    operateInPlace(zip, new InPlaceAction() {\n      public boolean act(File tmpFile) {\n        removeEntries(zip, paths, tmpFile);\n        return true;\n      }\n    });\n  }"
  },
  {
    "id": 76,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 102,
    "human_patch": "https://github.com/zeroturnaround/zt-zip/commit/759b72f33bc8f4d69f84f09fcb7f010ad45d6fff",
    "cve_id": "CVE-2018-1002201",
    "cwe_id": "CWE-22",
    "filename": "src/main/java/org/zeroturnaround/zip/ZipUtil.java",
    "is_vulnerable": 1,
    "class_name": "ZipUtil",
    "subclass_name": null,
    "function_name": "act(File tmpFile)",
    "function_body": "{\n        removeEntries(zip, paths, tmpFile);\n        return true;\n      }"
  },
  {
    "id": 76,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 103,
    "human_patch": "https://github.com/zeroturnaround/zt-zip/commit/759b72f33bc8f4d69f84f09fcb7f010ad45d6fff",
    "cve_id": "CVE-2018-1002201",
    "cwe_id": "CWE-22",
    "filename": "src/main/java/org/zeroturnaround/zip/ZipUtil.java",
    "is_vulnerable": 0,
    "class_name": "ZipUtil",
    "subclass_name": null,
    "function_name": "copyEntries(File zip, final ZipOutputStream out)",
    "function_body": "{\n    \n    final Set<String> names = new HashSet<String>();\n    iterate(zip, new ZipEntryCallback() {\n      public void process(InputStream in, ZipEntry zipEntry) throws IOException {\n        String entryName = zipEntry.getName();\n        if (names.add(entryName)) {\n          ZipEntryUtil.copyEntry(zipEntry, in, out);\n        }\n        else if (log.isDebugEnabled()) {\n          log.debug(\"Duplicate entry: {}\", entryName);\n        }\n      }\n    });\n  }"
  },
  {
    "id": 76,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 104,
    "human_patch": "https://github.com/zeroturnaround/zt-zip/commit/759b72f33bc8f4d69f84f09fcb7f010ad45d6fff",
    "cve_id": "CVE-2018-1002201",
    "cwe_id": "CWE-22",
    "filename": "src/main/java/org/zeroturnaround/zip/ZipUtil.java",
    "is_vulnerable": 0,
    "class_name": "ZipUtil",
    "subclass_name": null,
    "function_name": "process(InputStream in, ZipEntry zipEntry) throws IOException",
    "function_body": "{\n        String entryName = zipEntry.getName();\n        if (names.add(entryName)) {\n          ZipEntryUtil.copyEntry(zipEntry, in, out);\n        }\n        else if (log.isDebugEnabled()) {\n          log.debug(\"Duplicate entry: {}\", entryName);\n        }\n      }"
  },
  {
    "id": 76,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 105,
    "human_patch": "https://github.com/zeroturnaround/zt-zip/commit/759b72f33bc8f4d69f84f09fcb7f010ad45d6fff",
    "cve_id": "CVE-2018-1002201",
    "cwe_id": "CWE-22",
    "filename": "src/main/java/org/zeroturnaround/zip/ZipUtil.java",
    "is_vulnerable": 0,
    "class_name": "ZipUtil",
    "subclass_name": null,
    "function_name": "copyEntries(InputStream is, final ZipOutputStream out)",
    "function_body": "{\n    \n    final Set<String> names = new HashSet<String>();\n    iterate(is, new ZipEntryCallback() {\n      public void process(InputStream in, ZipEntry zipEntry) throws IOException {\n        String entryName = zipEntry.getName();\n        if (names.add(entryName)) {\n          ZipEntryUtil.copyEntry(zipEntry, in, out);\n        }\n        else if (log.isDebugEnabled()) {\n          log.debug(\"Duplicate entry: {}\", entryName);\n        }\n      }\n    });\n  }"
  },
  {
    "id": 76,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 106,
    "human_patch": "https://github.com/zeroturnaround/zt-zip/commit/759b72f33bc8f4d69f84f09fcb7f010ad45d6fff",
    "cve_id": "CVE-2018-1002201",
    "cwe_id": "CWE-22",
    "filename": "src/main/java/org/zeroturnaround/zip/ZipUtil.java",
    "is_vulnerable": 0,
    "class_name": "ZipUtil",
    "subclass_name": null,
    "function_name": "process(InputStream in, ZipEntry zipEntry) throws IOException",
    "function_body": "{\n        String entryName = zipEntry.getName();\n        if (names.add(entryName)) {\n          ZipEntryUtil.copyEntry(zipEntry, in, out);\n        }\n        else if (log.isDebugEnabled()) {\n          log.debug(\"Duplicate entry: {}\", entryName);\n        }\n      }"
  },
  {
    "id": 76,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 107,
    "human_patch": "https://github.com/zeroturnaround/zt-zip/commit/759b72f33bc8f4d69f84f09fcb7f010ad45d6fff",
    "cve_id": "CVE-2018-1002201",
    "cwe_id": "CWE-22",
    "filename": "src/main/java/org/zeroturnaround/zip/ZipUtil.java",
    "is_vulnerable": 0,
    "class_name": "ZipUtil",
    "subclass_name": null,
    "function_name": "copyEntries(File zip, final ZipOutputStream out, final Set<String> ignoredEntries)",
    "function_body": "{\n    final Set<String> names = new HashSet<String>();\n    final Set<String> dirNames = filterDirEntries(zip, ignoredEntries);\n    iterate(zip, new ZipEntryCallback() {\n      public void process(InputStream in, ZipEntry zipEntry) throws IOException {\n        String entryName = zipEntry.getName();\n        if (ignoredEntries.contains(entryName)) {\n          return;\n        }\n\n        for (String dirName : dirNames) {\n          if (entryName.startsWith(dirName)) {\n            return;\n          }\n        }\n\n        if (names.add(entryName)) {\n          ZipEntryUtil.copyEntry(zipEntry, in, out);\n        }\n        else if (log.isDebugEnabled()) {\n          log.debug(\"Duplicate entry: {}\", entryName);\n        }\n      }\n    });\n  }"
  },
  {
    "id": 76,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 108,
    "human_patch": "https://github.com/zeroturnaround/zt-zip/commit/759b72f33bc8f4d69f84f09fcb7f010ad45d6fff",
    "cve_id": "CVE-2018-1002201",
    "cwe_id": "CWE-22",
    "filename": "src/main/java/org/zeroturnaround/zip/ZipUtil.java",
    "is_vulnerable": 1,
    "class_name": "ZipUtil",
    "subclass_name": null,
    "function_name": "process(InputStream in, ZipEntry zipEntry) throws IOException",
    "function_body": "{\n        String entryName = zipEntry.getName();\n        if (ignoredEntries.contains(entryName)) {\n          return;\n        }\n\n        for (String dirName : dirNames) {\n          if (entryName.startsWith(dirName)) {\n            return;\n          }\n        }\n\n        if (names.add(entryName)) {\n          ZipEntryUtil.copyEntry(zipEntry, in, out);\n        }\n        else if (log.isDebugEnabled()) {\n          log.debug(\"Duplicate entry: {}\", entryName);\n        }\n      }"
  },
  {
    "id": 76,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 109,
    "human_patch": "https://github.com/zeroturnaround/zt-zip/commit/759b72f33bc8f4d69f84f09fcb7f010ad45d6fff",
    "cve_id": "CVE-2018-1002201",
    "cwe_id": "CWE-22",
    "filename": "src/main/java/org/zeroturnaround/zip/ZipUtil.java",
    "is_vulnerable": 0,
    "class_name": "ZipUtil",
    "subclass_name": null,
    "function_name": "filterDirEntries(File zip, Collection<String> names)",
    "function_body": "{\n    Set<String> dirs = new HashSet<String>();\n    if (zip == null) {\n      return dirs;\n    }\n    ZipFile zf = null;\n    try {\n      zf = new ZipFile(zip);\n      for (String entryName : names) {\n        ZipEntry entry = zf.getEntry(entryName);\n        if (entry != null) {\n          if (entry.isDirectory()) {\n            dirs.add(entry.getName());\n          }\n          else if (zf.getInputStream(entry) == null) {\n            \n            dirs.add(entry.getName() + PATH_SEPARATOR);\n          }\n        }\n      }\n\n    }\n    catch (IOException e) {\n      ZipExceptionUtil.rethrow(e);\n    }\n    finally {\n      closeQuietly(zf);\n    }\n    return dirs;\n  }"
  },
  {
    "id": 76,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 110,
    "human_patch": "https://github.com/zeroturnaround/zt-zip/commit/759b72f33bc8f4d69f84f09fcb7f010ad45d6fff",
    "cve_id": "CVE-2018-1002201",
    "cwe_id": "CWE-22",
    "filename": "src/main/java/org/zeroturnaround/zip/ZipUtil.java",
    "is_vulnerable": 0,
    "class_name": "ZipUtil",
    "subclass_name": null,
    "function_name": "replaceEntry(File zip, String path, File file, File destZip)",
    "function_body": "{\n    return replaceEntry(zip, new FileSource(path, file), destZip);\n  }"
  },
  {
    "id": 76,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 111,
    "human_patch": "https://github.com/zeroturnaround/zt-zip/commit/759b72f33bc8f4d69f84f09fcb7f010ad45d6fff",
    "cve_id": "CVE-2018-1002201",
    "cwe_id": "CWE-22",
    "filename": "src/main/java/org/zeroturnaround/zip/ZipUtil.java",
    "is_vulnerable": 0,
    "class_name": "ZipUtil",
    "subclass_name": null,
    "function_name": "replaceEntry(final File zip, final String path, final File file)",
    "function_body": "{\n    return operateInPlace(zip, new InPlaceAction() {\n      public boolean act(File tmpFile) {\n        return replaceEntry(zip, new FileSource(path, file), tmpFile);\n      }\n    });\n  }"
  },
  {
    "id": 76,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 112,
    "human_patch": "https://github.com/zeroturnaround/zt-zip/commit/759b72f33bc8f4d69f84f09fcb7f010ad45d6fff",
    "cve_id": "CVE-2018-1002201",
    "cwe_id": "CWE-22",
    "filename": "src/main/java/org/zeroturnaround/zip/ZipUtil.java",
    "is_vulnerable": 1,
    "class_name": "ZipUtil",
    "subclass_name": null,
    "function_name": "act(File tmpFile)",
    "function_body": "{\n        return replaceEntry(zip, new FileSource(path, file), tmpFile);\n      }"
  },
  {
    "id": 76,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 113,
    "human_patch": "https://github.com/zeroturnaround/zt-zip/commit/759b72f33bc8f4d69f84f09fcb7f010ad45d6fff",
    "cve_id": "CVE-2018-1002201",
    "cwe_id": "CWE-22",
    "filename": "src/main/java/org/zeroturnaround/zip/ZipUtil.java",
    "is_vulnerable": 0,
    "class_name": "ZipUtil",
    "subclass_name": null,
    "function_name": "replaceEntry(File zip, String path, byte[] bytes, File destZip)",
    "function_body": "{\n    return replaceEntry(zip, new ByteSource(path, bytes), destZip);\n  }"
  },
  {
    "id": 76,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 114,
    "human_patch": "https://github.com/zeroturnaround/zt-zip/commit/759b72f33bc8f4d69f84f09fcb7f010ad45d6fff",
    "cve_id": "CVE-2018-1002201",
    "cwe_id": "CWE-22",
    "filename": "src/main/java/org/zeroturnaround/zip/ZipUtil.java",
    "is_vulnerable": 0,
    "class_name": "ZipUtil",
    "subclass_name": null,
    "function_name": "replaceEntry(final File zip, final String path, final byte[] bytes)",
    "function_body": "{\n    return operateInPlace(zip, new InPlaceAction() {\n      public boolean act(File tmpFile) {\n        return replaceEntry(zip, new ByteSource(path, bytes), tmpFile);\n      }\n    });\n  }"
  },
  {
    "id": 76,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 115,
    "human_patch": "https://github.com/zeroturnaround/zt-zip/commit/759b72f33bc8f4d69f84f09fcb7f010ad45d6fff",
    "cve_id": "CVE-2018-1002201",
    "cwe_id": "CWE-22",
    "filename": "src/main/java/org/zeroturnaround/zip/ZipUtil.java",
    "is_vulnerable": 1,
    "class_name": "ZipUtil",
    "subclass_name": null,
    "function_name": "act(File tmpFile)",
    "function_body": "{\n        return replaceEntry(zip, new ByteSource(path, bytes), tmpFile);\n      }"
  },
  {
    "id": 76,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 116,
    "human_patch": "https://github.com/zeroturnaround/zt-zip/commit/759b72f33bc8f4d69f84f09fcb7f010ad45d6fff",
    "cve_id": "CVE-2018-1002201",
    "cwe_id": "CWE-22",
    "filename": "src/main/java/org/zeroturnaround/zip/ZipUtil.java",
    "is_vulnerable": 0,
    "class_name": "ZipUtil",
    "subclass_name": null,
    "function_name": "replaceEntry(final File zip, final String path, final byte[] bytes,\n      final int compressionMethod)",
    "function_body": "{\n    return operateInPlace(zip, new InPlaceAction() {\n      public boolean act(File tmpFile) {\n        return replaceEntry(zip, new ByteSource(path, bytes, compressionMethod), tmpFile);\n      }\n    });\n  }"
  },
  {
    "id": 76,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 117,
    "human_patch": "https://github.com/zeroturnaround/zt-zip/commit/759b72f33bc8f4d69f84f09fcb7f010ad45d6fff",
    "cve_id": "CVE-2018-1002201",
    "cwe_id": "CWE-22",
    "filename": "src/main/java/org/zeroturnaround/zip/ZipUtil.java",
    "is_vulnerable": 1,
    "class_name": "ZipUtil",
    "subclass_name": null,
    "function_name": "act(File tmpFile)",
    "function_body": "{\n        return replaceEntry(zip, new ByteSource(path, bytes, compressionMethod), tmpFile);\n      }"
  },
  {
    "id": 76,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 118,
    "human_patch": "https://github.com/zeroturnaround/zt-zip/commit/759b72f33bc8f4d69f84f09fcb7f010ad45d6fff",
    "cve_id": "CVE-2018-1002201",
    "cwe_id": "CWE-22",
    "filename": "src/main/java/org/zeroturnaround/zip/ZipUtil.java",
    "is_vulnerable": 0,
    "class_name": "ZipUtil",
    "subclass_name": null,
    "function_name": "replaceEntry(File zip, ZipEntrySource entry, File destZip)",
    "function_body": "{\n    return replaceEntries(zip, new ZipEntrySource[] { entry }, destZip);\n  }"
  },
  {
    "id": 76,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 119,
    "human_patch": "https://github.com/zeroturnaround/zt-zip/commit/759b72f33bc8f4d69f84f09fcb7f010ad45d6fff",
    "cve_id": "CVE-2018-1002201",
    "cwe_id": "CWE-22",
    "filename": "src/main/java/org/zeroturnaround/zip/ZipUtil.java",
    "is_vulnerable": 0,
    "class_name": "ZipUtil",
    "subclass_name": null,
    "function_name": "replaceEntry(final File zip, final ZipEntrySource entry)",
    "function_body": "{\n    return operateInPlace(zip, new InPlaceAction() {\n      public boolean act(File tmpFile) {\n        return replaceEntry(zip, entry, tmpFile);\n      }\n    });\n  }"
  },
  {
    "id": 76,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 120,
    "human_patch": "https://github.com/zeroturnaround/zt-zip/commit/759b72f33bc8f4d69f84f09fcb7f010ad45d6fff",
    "cve_id": "CVE-2018-1002201",
    "cwe_id": "CWE-22",
    "filename": "src/main/java/org/zeroturnaround/zip/ZipUtil.java",
    "is_vulnerable": 1,
    "class_name": "ZipUtil",
    "subclass_name": null,
    "function_name": "act(File tmpFile)",
    "function_body": "{\n        return replaceEntry(zip, entry, tmpFile);\n      }"
  },
  {
    "id": 76,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 121,
    "human_patch": "https://github.com/zeroturnaround/zt-zip/commit/759b72f33bc8f4d69f84f09fcb7f010ad45d6fff",
    "cve_id": "CVE-2018-1002201",
    "cwe_id": "CWE-22",
    "filename": "src/main/java/org/zeroturnaround/zip/ZipUtil.java",
    "is_vulnerable": 0,
    "class_name": "ZipUtil",
    "subclass_name": null,
    "function_name": "replaceEntries(File zip, ZipEntrySource[] entries, File destZip)",
    "function_body": "{\n    if (log.isDebugEnabled()) {\n      log.debug(\"Copying '\" + zip + \"' to '\" + destZip + \"' and replacing entries \" + Arrays.asList(entries) + \".\");\n    }\n\n    final Map<String, ZipEntrySource> entryByPath = entriesByPath(entries);\n    final int entryCount = entryByPath.size();\n    try {\n      final ZipOutputStream out = new ZipOutputStream(new BufferedOutputStream(new FileOutputStream(destZip)));\n      try {\n        final Set<String> names = new HashSet<String>();\n        iterate(zip, new ZipEntryCallback() {\n          public void process(InputStream in, ZipEntry zipEntry) throws IOException {\n            if (names.add(zipEntry.getName())) {\n              ZipEntrySource entry = (ZipEntrySource) entryByPath.remove(zipEntry.getName());\n              if (entry != null) {\n                addEntry(entry, out);\n              }\n              else {\n                ZipEntryUtil.copyEntry(zipEntry, in, out);\n              }\n            }\n            else if (log.isDebugEnabled()) {\n              log.debug(\"Duplicate entry: {}\", zipEntry.getName());\n            }\n          }\n        });\n      }\n      finally {\n        IOUtils.closeQuietly(out);\n      }\n    }\n    catch (IOException e) {\n      ZipExceptionUtil.rethrow(e);\n    }\n    return entryByPath.size() < entryCount;\n  }"
  },
  {
    "id": 76,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 122,
    "human_patch": "https://github.com/zeroturnaround/zt-zip/commit/759b72f33bc8f4d69f84f09fcb7f010ad45d6fff",
    "cve_id": "CVE-2018-1002201",
    "cwe_id": "CWE-22",
    "filename": "src/main/java/org/zeroturnaround/zip/ZipUtil.java",
    "is_vulnerable": 1,
    "class_name": "ZipUtil",
    "subclass_name": null,
    "function_name": "process(InputStream in, ZipEntry zipEntry) throws IOException",
    "function_body": "{\n            if (names.add(zipEntry.getName())) {\n              ZipEntrySource entry = (ZipEntrySource) entryByPath.remove(zipEntry.getName());\n              if (entry != null) {\n                addEntry(entry, out);\n              }\n              else {\n                ZipEntryUtil.copyEntry(zipEntry, in, out);\n              }\n            }\n            else if (log.isDebugEnabled()) {\n              log.debug(\"Duplicate entry: {}\", zipEntry.getName());\n            }\n          }"
  },
  {
    "id": 76,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 123,
    "human_patch": "https://github.com/zeroturnaround/zt-zip/commit/759b72f33bc8f4d69f84f09fcb7f010ad45d6fff",
    "cve_id": "CVE-2018-1002201",
    "cwe_id": "CWE-22",
    "filename": "src/main/java/org/zeroturnaround/zip/ZipUtil.java",
    "is_vulnerable": 0,
    "class_name": "ZipUtil",
    "subclass_name": null,
    "function_name": "replaceEntries(final File zip, final ZipEntrySource[] entries)",
    "function_body": "{\n    return operateInPlace(zip, new InPlaceAction() {\n      public boolean act(File tmpFile) {\n        return replaceEntries(zip, entries, tmpFile);\n      }\n    });\n  }"
  },
  {
    "id": 76,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 124,
    "human_patch": "https://github.com/zeroturnaround/zt-zip/commit/759b72f33bc8f4d69f84f09fcb7f010ad45d6fff",
    "cve_id": "CVE-2018-1002201",
    "cwe_id": "CWE-22",
    "filename": "src/main/java/org/zeroturnaround/zip/ZipUtil.java",
    "is_vulnerable": 1,
    "class_name": "ZipUtil",
    "subclass_name": null,
    "function_name": "act(File tmpFile)",
    "function_body": "{\n        return replaceEntries(zip, entries, tmpFile);\n      }"
  },
  {
    "id": 76,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 125,
    "human_patch": "https://github.com/zeroturnaround/zt-zip/commit/759b72f33bc8f4d69f84f09fcb7f010ad45d6fff",
    "cve_id": "CVE-2018-1002201",
    "cwe_id": "CWE-22",
    "filename": "src/main/java/org/zeroturnaround/zip/ZipUtil.java",
    "is_vulnerable": 0,
    "class_name": "ZipUtil",
    "subclass_name": null,
    "function_name": "addOrReplaceEntries(File zip, ZipEntrySource[] entries, File destZip)",
    "function_body": "{\n    if (log.isDebugEnabled()) {\n      log.debug(\"Copying '\" + zip + \"' to '\" + destZip + \"' and adding/replacing entries \" + Arrays.asList(entries)\n          + \".\");\n    }\n\n    final Map<String, ZipEntrySource> entryByPath = entriesByPath(entries);\n    try {\n      final ZipOutputStream out = new ZipOutputStream(new BufferedOutputStream(new FileOutputStream(destZip)));\n      try {\n        \n        final Set<String> names = new HashSet<String>();\n        iterate(zip, new ZipEntryCallback() {\n          public void process(InputStream in, ZipEntry zipEntry) throws IOException {\n            if (names.add(zipEntry.getName())) {\n              ZipEntrySource entry = (ZipEntrySource) entryByPath.remove(zipEntry.getName());\n              if (entry != null) {\n                addEntry(entry, out);\n              }\n              else {\n                ZipEntryUtil.copyEntry(zipEntry, in, out);\n              }\n            }\n            else if (log.isDebugEnabled()) {\n              log.debug(\"Duplicate entry: {}\", zipEntry.getName());\n            }\n          }\n        });\n\n        \n        for (ZipEntrySource zipEntrySource : entryByPath.values()) {\n          addEntry(zipEntrySource, out);\n        }\n      }\n      finally {\n        IOUtils.closeQuietly(out);\n      }\n    }\n    catch (IOException e) {\n      ZipExceptionUtil.rethrow(e);\n    }\n  }"
  },
  {
    "id": 76,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 126,
    "human_patch": "https://github.com/zeroturnaround/zt-zip/commit/759b72f33bc8f4d69f84f09fcb7f010ad45d6fff",
    "cve_id": "CVE-2018-1002201",
    "cwe_id": "CWE-22",
    "filename": "src/main/java/org/zeroturnaround/zip/ZipUtil.java",
    "is_vulnerable": 1,
    "class_name": "ZipUtil",
    "subclass_name": null,
    "function_name": "process(InputStream in, ZipEntry zipEntry) throws IOException",
    "function_body": "{\n            if (names.add(zipEntry.getName())) {\n              ZipEntrySource entry = (ZipEntrySource) entryByPath.remove(zipEntry.getName());\n              if (entry != null) {\n                addEntry(entry, out);\n              }\n              else {\n                ZipEntryUtil.copyEntry(zipEntry, in, out);\n              }\n            }\n            else if (log.isDebugEnabled()) {\n              log.debug(\"Duplicate entry: {}\", zipEntry.getName());\n            }\n          }"
  },
  {
    "id": 76,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 127,
    "human_patch": "https://github.com/zeroturnaround/zt-zip/commit/759b72f33bc8f4d69f84f09fcb7f010ad45d6fff",
    "cve_id": "CVE-2018-1002201",
    "cwe_id": "CWE-22",
    "filename": "src/main/java/org/zeroturnaround/zip/ZipUtil.java",
    "is_vulnerable": 0,
    "class_name": "ZipUtil",
    "subclass_name": null,
    "function_name": "addOrReplaceEntries(final File zip, final ZipEntrySource[] entries)",
    "function_body": "{\n    operateInPlace(zip, new InPlaceAction() {\n      public boolean act(File tmpFile) {\n        addOrReplaceEntries(zip, entries, tmpFile);\n        return true;\n      }\n    });\n  }"
  },
  {
    "id": 76,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 128,
    "human_patch": "https://github.com/zeroturnaround/zt-zip/commit/759b72f33bc8f4d69f84f09fcb7f010ad45d6fff",
    "cve_id": "CVE-2018-1002201",
    "cwe_id": "CWE-22",
    "filename": "src/main/java/org/zeroturnaround/zip/ZipUtil.java",
    "is_vulnerable": 1,
    "class_name": "ZipUtil",
    "subclass_name": null,
    "function_name": "act(File tmpFile)",
    "function_body": "{\n        addOrReplaceEntries(zip, entries, tmpFile);\n        return true;\n      }"
  },
  {
    "id": 76,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 129,
    "human_patch": "https://github.com/zeroturnaround/zt-zip/commit/759b72f33bc8f4d69f84f09fcb7f010ad45d6fff",
    "cve_id": "CVE-2018-1002201",
    "cwe_id": "CWE-22",
    "filename": "src/main/java/org/zeroturnaround/zip/ZipUtil.java",
    "is_vulnerable": 0,
    "class_name": "ZipUtil",
    "subclass_name": null,
    "function_name": "entriesByPath(ZipEntrySource... entries)",
    "function_body": "{\n    Map<String, ZipEntrySource> result = new HashMap<String, ZipEntrySource>();\n    for (int i = 0; i < entries.length; i++) {\n      ZipEntrySource source = entries[i];\n      result.put(source.getPath(), source);\n    }\n    return result;\n  }"
  },
  {
    "id": 76,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 130,
    "human_patch": "https://github.com/zeroturnaround/zt-zip/commit/759b72f33bc8f4d69f84f09fcb7f010ad45d6fff",
    "cve_id": "CVE-2018-1002201",
    "cwe_id": "CWE-22",
    "filename": "src/main/java/org/zeroturnaround/zip/ZipUtil.java",
    "is_vulnerable": 0,
    "class_name": "ZipUtil",
    "subclass_name": null,
    "function_name": "transformEntry(File zip, String path, ZipEntryTransformer transformer, File destZip)",
    "function_body": "{\n    if(zip.equals(destZip)){throw new IllegalArgumentException(\"Input (\" +zip.getAbsolutePath()+ \") is the same as the destination!\" +\n            \"Please use the transformEntry method without destination for in-place transformation.\" );}\n    return transformEntry(zip, new ZipEntryTransformerEntry(path, transformer), destZip);\n  }"
  },
  {
    "id": 76,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 131,
    "human_patch": "https://github.com/zeroturnaround/zt-zip/commit/759b72f33bc8f4d69f84f09fcb7f010ad45d6fff",
    "cve_id": "CVE-2018-1002201",
    "cwe_id": "CWE-22",
    "filename": "src/main/java/org/zeroturnaround/zip/ZipUtil.java",
    "is_vulnerable": 0,
    "class_name": "ZipUtil",
    "subclass_name": null,
    "function_name": "transformEntry(final File zip, final String path, final ZipEntryTransformer transformer)",
    "function_body": "{\n    return operateInPlace(zip, new InPlaceAction() {\n      public boolean act(File tmpFile) {\n        return transformEntry(zip, path, transformer, tmpFile);\n      }\n    });\n  }"
  },
  {
    "id": 76,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 132,
    "human_patch": "https://github.com/zeroturnaround/zt-zip/commit/759b72f33bc8f4d69f84f09fcb7f010ad45d6fff",
    "cve_id": "CVE-2018-1002201",
    "cwe_id": "CWE-22",
    "filename": "src/main/java/org/zeroturnaround/zip/ZipUtil.java",
    "is_vulnerable": 1,
    "class_name": "ZipUtil",
    "subclass_name": null,
    "function_name": "act(File tmpFile)",
    "function_body": "{\n        return transformEntry(zip, path, transformer, tmpFile);\n      }"
  },
  {
    "id": 76,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 133,
    "human_patch": "https://github.com/zeroturnaround/zt-zip/commit/759b72f33bc8f4d69f84f09fcb7f010ad45d6fff",
    "cve_id": "CVE-2018-1002201",
    "cwe_id": "CWE-22",
    "filename": "src/main/java/org/zeroturnaround/zip/ZipUtil.java",
    "is_vulnerable": 0,
    "class_name": "ZipUtil",
    "subclass_name": null,
    "function_name": "transformEntry(File zip, ZipEntryTransformerEntry entry, File destZip)",
    "function_body": "{\n    return transformEntries(zip, new ZipEntryTransformerEntry[] { entry }, destZip);\n  }"
  },
  {
    "id": 76,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 134,
    "human_patch": "https://github.com/zeroturnaround/zt-zip/commit/759b72f33bc8f4d69f84f09fcb7f010ad45d6fff",
    "cve_id": "CVE-2018-1002201",
    "cwe_id": "CWE-22",
    "filename": "src/main/java/org/zeroturnaround/zip/ZipUtil.java",
    "is_vulnerable": 0,
    "class_name": "ZipUtil",
    "subclass_name": null,
    "function_name": "transformEntry(final File zip, final ZipEntryTransformerEntry entry)",
    "function_body": "{\n    return operateInPlace(zip, new InPlaceAction() {\n      public boolean act(File tmpFile) {\n        return transformEntry(zip, entry, tmpFile);\n      }\n    });\n  }"
  },
  {
    "id": 76,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 135,
    "human_patch": "https://github.com/zeroturnaround/zt-zip/commit/759b72f33bc8f4d69f84f09fcb7f010ad45d6fff",
    "cve_id": "CVE-2018-1002201",
    "cwe_id": "CWE-22",
    "filename": "src/main/java/org/zeroturnaround/zip/ZipUtil.java",
    "is_vulnerable": 1,
    "class_name": "ZipUtil",
    "subclass_name": null,
    "function_name": "act(File tmpFile)",
    "function_body": "{\n        return transformEntry(zip, entry, tmpFile);\n      }"
  },
  {
    "id": 76,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 136,
    "human_patch": "https://github.com/zeroturnaround/zt-zip/commit/759b72f33bc8f4d69f84f09fcb7f010ad45d6fff",
    "cve_id": "CVE-2018-1002201",
    "cwe_id": "CWE-22",
    "filename": "src/main/java/org/zeroturnaround/zip/ZipUtil.java",
    "is_vulnerable": 0,
    "class_name": "ZipUtil",
    "subclass_name": null,
    "function_name": "transformEntries(File zip, ZipEntryTransformerEntry[] entries, File destZip)",
    "function_body": "{\n    if (log.isDebugEnabled())\n      log.debug(\"Copying '\" + zip + \"' to '\" + destZip + \"' and transforming entries \" + Arrays.asList(entries) + \".\");\n\n    try {\n      ZipOutputStream out = new ZipOutputStream(new BufferedOutputStream(new FileOutputStream(destZip)));\n      try {\n        TransformerZipEntryCallback action = new TransformerZipEntryCallback(Arrays.asList(entries), out);\n        iterate(zip, action);\n        return action.found();\n      }\n      finally {\n        IOUtils.closeQuietly(out);\n      }\n    }\n    catch (IOException e) {\n      throw ZipExceptionUtil.rethrow(e);\n    }\n  }"
  },
  {
    "id": 76,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 137,
    "human_patch": "https://github.com/zeroturnaround/zt-zip/commit/759b72f33bc8f4d69f84f09fcb7f010ad45d6fff",
    "cve_id": "CVE-2018-1002201",
    "cwe_id": "CWE-22",
    "filename": "src/main/java/org/zeroturnaround/zip/ZipUtil.java",
    "is_vulnerable": 0,
    "class_name": "ZipUtil",
    "subclass_name": null,
    "function_name": "transformEntries(final File zip, final ZipEntryTransformerEntry[] entries)",
    "function_body": "{\n    return operateInPlace(zip, new InPlaceAction() {\n      public boolean act(File tmpFile) {\n        return transformEntries(zip, entries, tmpFile);\n      }\n    });\n  }"
  },
  {
    "id": 76,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 138,
    "human_patch": "https://github.com/zeroturnaround/zt-zip/commit/759b72f33bc8f4d69f84f09fcb7f010ad45d6fff",
    "cve_id": "CVE-2018-1002201",
    "cwe_id": "CWE-22",
    "filename": "src/main/java/org/zeroturnaround/zip/ZipUtil.java",
    "is_vulnerable": 1,
    "class_name": "ZipUtil",
    "subclass_name": null,
    "function_name": "act(File tmpFile)",
    "function_body": "{\n        return transformEntries(zip, entries, tmpFile);\n      }"
  },
  {
    "id": 76,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 139,
    "human_patch": "https://github.com/zeroturnaround/zt-zip/commit/759b72f33bc8f4d69f84f09fcb7f010ad45d6fff",
    "cve_id": "CVE-2018-1002201",
    "cwe_id": "CWE-22",
    "filename": "src/main/java/org/zeroturnaround/zip/ZipUtil.java",
    "is_vulnerable": 0,
    "class_name": "ZipUtil",
    "subclass_name": null,
    "function_name": "transformEntry(InputStream is, String path, ZipEntryTransformer transformer, OutputStream os)",
    "function_body": "{\n    return transformEntry(is, new ZipEntryTransformerEntry(path, transformer), os);\n  }"
  },
  {
    "id": 76,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 140,
    "human_patch": "https://github.com/zeroturnaround/zt-zip/commit/759b72f33bc8f4d69f84f09fcb7f010ad45d6fff",
    "cve_id": "CVE-2018-1002201",
    "cwe_id": "CWE-22",
    "filename": "src/main/java/org/zeroturnaround/zip/ZipUtil.java",
    "is_vulnerable": 0,
    "class_name": "ZipUtil",
    "subclass_name": null,
    "function_name": "transformEntry(InputStream is, ZipEntryTransformerEntry entry, OutputStream os)",
    "function_body": "{\n    return transformEntries(is, new ZipEntryTransformerEntry[] { entry }, os);\n  }"
  },
  {
    "id": 76,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 141,
    "human_patch": "https://github.com/zeroturnaround/zt-zip/commit/759b72f33bc8f4d69f84f09fcb7f010ad45d6fff",
    "cve_id": "CVE-2018-1002201",
    "cwe_id": "CWE-22",
    "filename": "src/main/java/org/zeroturnaround/zip/ZipUtil.java",
    "is_vulnerable": 0,
    "class_name": "ZipUtil",
    "subclass_name": null,
    "function_name": "transformEntries(InputStream is, ZipEntryTransformerEntry[] entries, OutputStream os)",
    "function_body": "{\n    if (log.isDebugEnabled())\n      log.debug(\"Copying '\" + is + \"' to '\" + os + \"' and transforming entries \" + Arrays.asList(entries) + \".\");\n\n    try {\n      ZipOutputStream out = new ZipOutputStream(os);\n      TransformerZipEntryCallback action = new TransformerZipEntryCallback(Arrays.asList(entries), out);\n      iterate(is, action);\n      \n      \n      out.finish();\n      return action.found();\n    }\n    catch (IOException e) {\n      throw ZipExceptionUtil.rethrow(e);\n    }\n  }"
  },
  {
    "id": 76,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 142,
    "human_patch": "https://github.com/zeroturnaround/zt-zip/commit/759b72f33bc8f4d69f84f09fcb7f010ad45d6fff",
    "cve_id": "CVE-2018-1002201",
    "cwe_id": "CWE-22",
    "filename": "src/main/java/org/zeroturnaround/zip/ZipUtil.java",
    "is_vulnerable": 0,
    "class_name": "ZipUtil",
    "subclass_name": "TransformerZipEntryCallback",
    "function_name": "process(InputStream in, ZipEntry zipEntry) throws IOException",
    "function_body": "{\n      if (names.add(zipEntry.getName())) {\n        ZipEntryTransformer entry = (ZipEntryTransformer) entryByPath.remove(zipEntry.getName());\n        if (entry != null) {\n          entry.transform(in, zipEntry, out);\n        }\n        else {\n          ZipEntryUtil.copyEntry(zipEntry, in, out);\n        }\n      }\n      else if (log.isDebugEnabled()) {\n        log.debug(\"Duplicate entry: {}\", zipEntry.getName());\n      }\n    }"
  },
  {
    "id": 76,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 143,
    "human_patch": "https://github.com/zeroturnaround/zt-zip/commit/759b72f33bc8f4d69f84f09fcb7f010ad45d6fff",
    "cve_id": "CVE-2018-1002201",
    "cwe_id": "CWE-22",
    "filename": "src/main/java/org/zeroturnaround/zip/ZipUtil.java",
    "is_vulnerable": 0,
    "class_name": "ZipUtil",
    "subclass_name": "TransformerZipEntryCallback",
    "function_name": "found()",
    "function_body": "{\n      return entryByPath.size() < entryCount;\n    }"
  },
  {
    "id": 76,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 144,
    "human_patch": "https://github.com/zeroturnaround/zt-zip/commit/759b72f33bc8f4d69f84f09fcb7f010ad45d6fff",
    "cve_id": "CVE-2018-1002201",
    "cwe_id": "CWE-22",
    "filename": "src/main/java/org/zeroturnaround/zip/ZipUtil.java",
    "is_vulnerable": 0,
    "class_name": "ZipUtil",
    "subclass_name": null,
    "function_name": "transformersByPath(List<ZipEntryTransformerEntry> entries)",
    "function_body": "{\n    Map<String, ZipEntryTransformer> result = new HashMap<String, ZipEntryTransformer>();\n    for (ZipEntryTransformerEntry entry : entries) {\n      result.put(entry.getPath(), entry.getTransformer());\n    }\n    return result;\n  }"
  },
  {
    "id": 76,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 145,
    "human_patch": "https://github.com/zeroturnaround/zt-zip/commit/759b72f33bc8f4d69f84f09fcb7f010ad45d6fff",
    "cve_id": "CVE-2018-1002201",
    "cwe_id": "CWE-22",
    "filename": "src/main/java/org/zeroturnaround/zip/ZipUtil.java",
    "is_vulnerable": 0,
    "class_name": "ZipUtil",
    "subclass_name": null,
    "function_name": "addEntry(ZipEntrySource entry, ZipOutputStream out) throws IOException",
    "function_body": "{\n    out.putNextEntry(entry.getEntry());\n    InputStream in = entry.getInputStream();\n    if (in != null) {\n      try {\n        IOUtils.copy(in, out);\n      }\n      finally {\n        IOUtils.closeQuietly(in);\n      }\n    }\n    out.closeEntry();\n  }"
  },
  {
    "id": 76,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 146,
    "human_patch": "https://github.com/zeroturnaround/zt-zip/commit/759b72f33bc8f4d69f84f09fcb7f010ad45d6fff",
    "cve_id": "CVE-2018-1002201",
    "cwe_id": "CWE-22",
    "filename": "src/main/java/org/zeroturnaround/zip/ZipUtil.java",
    "is_vulnerable": 0,
    "class_name": "ZipUtil",
    "subclass_name": null,
    "function_name": "archiveEquals(File f1, File f2)",
    "function_body": "{\n    try {\n      \n      if (FileUtils.contentEquals(f1, f2)) {\n        return true;\n      }\n\n      log.debug(\"Comparing archives '{}' and '{}'...\", f1, f2);\n\n      long start = System.currentTimeMillis();\n      boolean result = archiveEqualsInternal(f1, f2);\n      long time = System.currentTimeMillis() - start;\n      if (time > 0) {\n        log.debug(\"Archives compared in \" + time + \" ms.\");\n      }\n      return result;\n    }\n    catch (Exception e) {\n      log.debug(\"Could not compare '\" + f1 + \"' and '\" + f2 + \"':\", e);\n      return false;\n    }\n  }"
  },
  {
    "id": 76,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 147,
    "human_patch": "https://github.com/zeroturnaround/zt-zip/commit/759b72f33bc8f4d69f84f09fcb7f010ad45d6fff",
    "cve_id": "CVE-2018-1002201",
    "cwe_id": "CWE-22",
    "filename": "src/main/java/org/zeroturnaround/zip/ZipUtil.java",
    "is_vulnerable": 0,
    "class_name": "ZipUtil",
    "subclass_name": null,
    "function_name": "archiveEqualsInternal(File f1, File f2) throws IOException",
    "function_body": "{\n    ZipFile zf1 = null;\n    ZipFile zf2 = null;\n    try {\n      zf1 = new ZipFile(f1);\n      zf2 = new ZipFile(f2);\n\n      \n      if (zf1.size() != zf2.size()) {\n        log.debug(\"Number of entries changed (\" + zf1.size() + \" vs \" + zf2.size() + \").\");\n        return false;\n      }\n      \n      Enumeration<? extends ZipEntry> en = zf1.entries();\n      while (en.hasMoreElements()) {\n        ZipEntry e1 = (ZipEntry) en.nextElement();\n        String path = e1.getName();\n        ZipEntry e2 = zf2.getEntry(path);\n\n        \n        if (!metaDataEquals(path, e1, e2)) {\n          return false;\n        }\n\n        \n        InputStream is1 = null;\n        InputStream is2 = null;\n        try {\n          is1 = zf1.getInputStream(e1);\n          is2 = zf2.getInputStream(e2);\n\n          if (!IOUtils.contentEquals(is1, is2)) {\n            log.debug(\"Entry '{}' content changed.\", path);\n            return false;\n          }\n        }\n        finally {\n          IOUtils.closeQuietly(is1);\n          IOUtils.closeQuietly(is2);\n        }\n      }\n    }\n    finally {\n      closeQuietly(zf1);\n      closeQuietly(zf2);\n    }\n\n    log.debug(\"Archives are the same.\");\n\n    return true;\n  }"
  },
  {
    "id": 76,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 148,
    "human_patch": "https://github.com/zeroturnaround/zt-zip/commit/759b72f33bc8f4d69f84f09fcb7f010ad45d6fff",
    "cve_id": "CVE-2018-1002201",
    "cwe_id": "CWE-22",
    "filename": "src/main/java/org/zeroturnaround/zip/ZipUtil.java",
    "is_vulnerable": 0,
    "class_name": "ZipUtil",
    "subclass_name": null,
    "function_name": "metaDataEquals(String path, ZipEntry e1, ZipEntry e2) throws IOException",
    "function_body": "{\n    \n    if (e2 == null) {\n      log.debug(\"Entry '{}' removed.\", path);\n      return false;\n    }\n\n    \n    if (e1.isDirectory()) {\n      if (e2.isDirectory()) {\n        return true; \n      }\n      else {\n        log.debug(\"Entry '{}' not a directory any more.\", path);\n        return false;\n      }\n    }\n    else if (e2.isDirectory()) {\n      log.debug(\"Entry '{}' now a directory.\", path);\n      return false;\n    }\n\n    \n    long size1 = e1.getSize();\n    long size2 = e2.getSize();\n    if (size1 != -1 && size2 != -1 && size1 != size2) {\n      log.debug(\"Entry '\" + path + \"' size changed (\" + size1 + \" vs \" + size2 + \").\");\n      return false;\n    }\n\n    \n    long crc1 = e1.getCrc();\n    long crc2 = e2.getCrc();\n    if (crc1 != -1 && crc2 != -1 && crc1 != crc2) {\n      log.debug(\"Entry '\" + path + \"' CRC changed (\" + crc1 + \" vs \" + crc2 + \").\");\n      return false;\n    }\n\n    \n    if (log.isTraceEnabled()) {\n      long time1 = e1.getTime();\n      long time2 = e2.getTime();\n      if (time1 != -1 && time2 != -1 && time1 != time2) {\n        log.trace(\"Entry '\" + path + \"' time changed (\" + new Date(time1) + \" vs \" + new Date(time2) + \").\");\n      }\n    }\n\n    return true;\n  }"
  },
  {
    "id": 76,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 149,
    "human_patch": "https://github.com/zeroturnaround/zt-zip/commit/759b72f33bc8f4d69f84f09fcb7f010ad45d6fff",
    "cve_id": "CVE-2018-1002201",
    "cwe_id": "CWE-22",
    "filename": "src/main/java/org/zeroturnaround/zip/ZipUtil.java",
    "is_vulnerable": 0,
    "class_name": "ZipUtil",
    "subclass_name": null,
    "function_name": "entryEquals(File f1, File f2, String path)",
    "function_body": "{\n    return entryEquals(f1, f2, path, path);\n  }"
  },
  {
    "id": 76,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 150,
    "human_patch": "https://github.com/zeroturnaround/zt-zip/commit/759b72f33bc8f4d69f84f09fcb7f010ad45d6fff",
    "cve_id": "CVE-2018-1002201",
    "cwe_id": "CWE-22",
    "filename": "src/main/java/org/zeroturnaround/zip/ZipUtil.java",
    "is_vulnerable": 0,
    "class_name": "ZipUtil",
    "subclass_name": null,
    "function_name": "entryEquals(File f1, File f2, String path1, String path2)",
    "function_body": "{\n    ZipFile zf1 = null;\n    ZipFile zf2 = null;\n\n    try {\n      zf1 = new ZipFile(f1);\n      zf2 = new ZipFile(f2);\n\n      return doEntryEquals(zf1, zf2, path1, path2);\n    }\n    catch (IOException e) {\n      throw ZipExceptionUtil.rethrow(e);\n    }\n    finally {\n      closeQuietly(zf1);\n      closeQuietly(zf2);\n    }\n  }"
  },
  {
    "id": 76,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 151,
    "human_patch": "https://github.com/zeroturnaround/zt-zip/commit/759b72f33bc8f4d69f84f09fcb7f010ad45d6fff",
    "cve_id": "CVE-2018-1002201",
    "cwe_id": "CWE-22",
    "filename": "src/main/java/org/zeroturnaround/zip/ZipUtil.java",
    "is_vulnerable": 0,
    "class_name": "ZipUtil",
    "subclass_name": null,
    "function_name": "entryEquals(ZipFile zf1, ZipFile zf2, String path1, String path2)",
    "function_body": "{\n    try {\n      return doEntryEquals(zf1, zf2, path1, path2);\n    }\n    catch (IOException e) {\n      throw ZipExceptionUtil.rethrow(e);\n    }\n  }"
  },
  {
    "id": 76,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 152,
    "human_patch": "https://github.com/zeroturnaround/zt-zip/commit/759b72f33bc8f4d69f84f09fcb7f010ad45d6fff",
    "cve_id": "CVE-2018-1002201",
    "cwe_id": "CWE-22",
    "filename": "src/main/java/org/zeroturnaround/zip/ZipUtil.java",
    "is_vulnerable": 0,
    "class_name": "ZipUtil",
    "subclass_name": null,
    "function_name": "doEntryEquals(ZipFile zf1, ZipFile zf2, String path1, String path2) throws IOException",
    "function_body": "{\n    InputStream is1 = null;\n    InputStream is2 = null;\n    try {\n      ZipEntry e1 = zf1.getEntry(path1);\n      ZipEntry e2 = zf2.getEntry(path2);\n\n      if (e1 == null && e2 == null) {\n        return true;\n      }\n\n      if (e1 == null || e2 == null) {\n        return false;\n      }\n\n      is1 = zf1.getInputStream(e1);\n      is2 = zf2.getInputStream(e2);\n      if (is1 == null && is2 == null) {\n        return true;\n      }\n      if (is1 == null || is2 == null) {\n        return false;\n      }\n\n      return IOUtils.contentEquals(is1, is2);\n    }\n    finally {\n      IOUtils.closeQuietly(is1);\n      IOUtils.closeQuietly(is2);\n    }\n  }"
  },
  {
    "id": 76,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 153,
    "human_patch": "https://github.com/zeroturnaround/zt-zip/commit/759b72f33bc8f4d69f84f09fcb7f010ad45d6fff",
    "cve_id": "CVE-2018-1002201",
    "cwe_id": "CWE-22",
    "filename": "src/main/java/org/zeroturnaround/zip/ZipUtil.java",
    "is_vulnerable": 0,
    "class_name": "ZipUtil",
    "subclass_name": null,
    "function_name": "closeQuietly(ZipFile zf)",
    "function_body": "{\n    try {\n      if (zf != null) {\n        zf.close();\n      }\n    }\n    catch (IOException e) {\n    }\n  }"
  },
  {
    "id": 76,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 154,
    "human_patch": "https://github.com/zeroturnaround/zt-zip/commit/759b72f33bc8f4d69f84f09fcb7f010ad45d6fff",
    "cve_id": "CVE-2018-1002201",
    "cwe_id": "CWE-22",
    "filename": "src/main/java/org/zeroturnaround/zip/ZipUtil.java",
    "is_vulnerable": 0,
    "class_name": "ZipUtil",
    "subclass_name": "InPlaceAction",
    "function_name": "act(File tmpFile)",
    "function_body": null
  },
  {
    "id": 76,
    "sub_id": 0,
    "code_id": 0,
    "function_id": 155,
    "human_patch": "https://github.com/zeroturnaround/zt-zip/commit/759b72f33bc8f4d69f84f09fcb7f010ad45d6fff",
    "cve_id": "CVE-2018-1002201",
    "cwe_id": "CWE-22",
    "filename": "src/main/java/org/zeroturnaround/zip/ZipUtil.java",
    "is_vulnerable": 0,
    "class_name": "ZipUtil",
    "subclass_name": null,
    "function_name": "operateInPlace(File src, InPlaceAction action)",
    "function_body": "{\n    File tmp = null;\n    try {\n      tmp = File.createTempFile(\"zt-zip-tmp\", \".zip\");\n      boolean result = action.act(tmp);\n      if (result) { \n        FileUtils.forceDelete(src);\n        FileUtils.moveFile(tmp, src);\n      }\n      return result;\n    }\n    catch (IOException e) {\n      throw ZipExceptionUtil.rethrow(e);\n    }\n    finally {\n      FileUtils.deleteQuietly(tmp);\n    }\n  }"
  }
]